/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 	};
/******/
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"main.bundle": 0
/******/ 	};
/******/
/******/
/******/
/******/ 	// script path function
/******/ 	function jsonpScriptSrc(chunkId) {
/******/ 		return __webpack_require__.p + "js/" + ({}[chunkId]||chunkId) + "-" + {"0":"d97fe04f081c0a8123ae"}[chunkId] + ".js"
/******/ 	}
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var promises = [];
/******/
/******/
/******/ 		// JSONP chunk loading for javascript
/******/
/******/ 		var installedChunkData = installedChunks[chunkId];
/******/ 		if(installedChunkData !== 0) { // 0 means "already installed".
/******/
/******/ 			// a Promise means "currently loading".
/******/ 			if(installedChunkData) {
/******/ 				promises.push(installedChunkData[2]);
/******/ 			} else {
/******/ 				// setup Promise in chunk cache
/******/ 				var promise = new Promise(function(resolve, reject) {
/******/ 					installedChunkData = installedChunks[chunkId] = [resolve, reject];
/******/ 				});
/******/ 				promises.push(installedChunkData[2] = promise);
/******/
/******/ 				// start chunk loading
/******/ 				var script = document.createElement('script');
/******/ 				var onScriptComplete;
/******/
/******/ 				script.charset = 'utf-8';
/******/ 				script.timeout = 120;
/******/ 				if (__webpack_require__.nc) {
/******/ 					script.setAttribute("nonce", __webpack_require__.nc);
/******/ 				}
/******/ 				script.src = jsonpScriptSrc(chunkId);
/******/
/******/ 				// create error before stack unwound to get useful stacktrace later
/******/ 				var error = new Error();
/******/ 				onScriptComplete = function (event) {
/******/ 					// avoid mem leaks in IE.
/******/ 					script.onerror = script.onload = null;
/******/ 					clearTimeout(timeout);
/******/ 					var chunk = installedChunks[chunkId];
/******/ 					if(chunk !== 0) {
/******/ 						if(chunk) {
/******/ 							var errorType = event && (event.type === 'load' ? 'missing' : event.type);
/******/ 							var realSrc = event && event.target && event.target.src;
/******/ 							error.message = 'Loading chunk ' + chunkId + ' failed.\n(' + errorType + ': ' + realSrc + ')';
/******/ 							error.name = 'ChunkLoadError';
/******/ 							error.type = errorType;
/******/ 							error.request = realSrc;
/******/ 							chunk[1](error);
/******/ 						}
/******/ 						installedChunks[chunkId] = undefined;
/******/ 					}
/******/ 				};
/******/ 				var timeout = setTimeout(function(){
/******/ 					onScriptComplete({ type: 'timeout', target: script });
/******/ 				}, 120000);
/******/ 				script.onerror = script.onload = onScriptComplete;
/******/ 				document.head.appendChild(script);
/******/ 			}
/******/ 		}
/******/ 		return Promise.all(promises);
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	var jsonpArray = window["webpackJsonp"] = window["webpackJsonp"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "../../ui-core/basic/base/js/base.js":
/*!***************************************************!*\
  !*** /home/irahhal/ui-core/basic/base/js/base.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

  (function () {
    var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  
    if (iOS) {
      $('body').addClass('iOS');
    }
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/basic/base/js/pageBody.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-core/basic/base/js/pageBody.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    /**
     * @deprecated
     */
    UX.pageBody = {
      init: function init() {
        this.extraControls();
      },
      extraControls: function extraControls() {},
      urlParam: {
        replace: function replace(url, paramName, paramValue) {
          if (paramValue == null) {
            paramValue = '';
          }
  
          var pattern = new RegExp('\\b(' + paramName + '=).*?(&|#|$)');
  
          if (url.search(pattern) >= 0) {
            return url.replace(pattern, '$1' + paramValue + '$2');
          }
  
          url = url.replace(/[?#]$/, '');
          return url + (url.indexOf('?') > 0 ? '&' : '?') + paramName + '=' + paramValue;
        },
        remove: function remove(url, paramName) {
          var pattern = new RegExp('\\b(' + paramName + '=).*?(&|#|$)');
  
          if (url.search(pattern) >= 0) {
            url = url.replace(pattern, '');
            return url.replace(/\&+$/g, '');
          } else {
            return url;
          }
        },
        test: function test(url, paramName, paramValue) {
          var pattern;
  
          if (paramValue !== undefined) {
            pattern = new RegExp('\\b(' + paramName + '=' + paramValue + ').*?(&|#|$)');
          } else {
            pattern = new RegExp('\\b(' + paramName + ').*?(&|#|$)');
          }
  
          return pattern.test(url);
        },
        getParamVal: function getParamVal(url, paramName) {
          var vars = {};
          url.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
            vars[key] = value;
          });
          return vars[paramName];
        }
      }
    }; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/basic/inputs/js/inputs.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-core/basic/inputs/js/inputs.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        isMobile = false;
    var fieldsCtrl = {
      container: null,
      $wrapper: null,
      $toggle: null,
      $form: null,
      $terms: null,
      $markAll: null,
      maxClone: 2,
      init: function init() {
        fieldsCtrl.$toggle = $('.reproducible');
        fieldsCtrl.$wrapper = $('.reproducible__wrapper');
        fieldsCtrl.container = '.reproducible__container'; // Support for the legacy emails and phones used in account page
        //fieldsCtrl.check.terms();
  
        fieldsCtrl.control();
        var $lastTerm = fieldsCtrl.$wrapper.children('.reproducible').length;
        fieldsCtrl.check.lastClone($lastTerm);
        fieldsCtrl.accessibility.init();
        fieldsCtrl.additionalControls();
      },
      accessibility: {
        init: function init() {
          this.radioCheckbox();
  
          if ($('.force--disabled').length == 0) {
            this.selectBox();
          }
  
          this.buttons.init();
          this.range();
        },
        radioCheckbox: function radioCheckbox() {
          var radioCheckboxSelector = '.radio--primary, .radio--secondary, .checkbox--primary, .checkbox--secondary';
          $(document).on('mousedown', radioCheckboxSelector, function (event) {
            var $this = $(this);
            $this.attr({
              tabindex: 0
            });
            $this.focus();
          }).on('mouseup', radioCheckboxSelector, function (event) {
            var $this = $(this);
            $this.removeAttr('tabindex');
  
            if ($this.hasClass('withInput')) {
              $this.find('input[type=email], input[type=text]').focus();
            } else {
              $this.find('input[type=radio], input[type=checkbox]').focus();
            }
          });
        },
        selectBox: function selectBox() {
          // JCF selectbox
          $(document).on('mousedown', '.jcf-select', function (event) {
            var $this = $(this);
            $this.attr({
              tabindex: 0
            });
            $this.siblings('.jcf-hidden').attr('disabled', true);
            $this.focus();
          }).on('mouseup', '.jcf-select', function (event) {
            var $this = $(this);
            $this.removeAttr('tabindex');
            $this.siblings('.jcf-hidden').focus();
            $this.siblings('.jcf-hidden').removeAttr('disabled');
          });
          $(document).on('keydown', 'select.jcf-hidden', function (event) {
            if (event.which === 13) {
              event.preventDefault();
            } else if (event.which === 27 && $(this).siblings('.jcf-drop-active').length > 0) {
              event.which = 13;
              $(this).trigger(event);
            }
          }); // Hide on blur
          // note it doesn't work over document selector, event is not fired
  
          $('select.jcf-hidden').on('blur', function (event) {
            var $this = $(this); // if key was pressed, than we need to operate with related target, not original target
  
            if (event.relatedTarget !== null) {
              event.target = event.relatedTarget;
            }
  
            var instance = jcf.getInstance($this[0]).instance;
            var target = $(event.target),
                focusInsideSelect = target.filter(instance.realElement).length || target.closest(instance.fakeElement).length || target.closest(instance.dropdown).length;
  
            if (!focusInsideSelect) {
              instance.hideDropdown();
            }
          });
        },
        buttons: {
          init: function init() {
            this.prepare(); // Enable Screen reader standard behavior on space and enter for [role=buttons] to be consistent with normal button element
  
            $(document).on('keydown', 'a[role=button]', function (event) {
              if (event.which === 32 || event.which === 13) {
                event.preventDefault();
                $(this).click();
              }
            });
          },
          prepare: function prepare() {
            // Remove HREF=# on a[role=button] as screen-reader would read whole page URL otherwise on focus
            $('a[role=button]').each(function () {
              var $this = $(this);
              var href = $this.attr('href');
              href = href === '#' ? null : href;
              var target = $this.data('target');
              $this.attr({
                'data-target': target || href,
                'tabindex': 0
              });
  
              if (!href) {
                $this.removeAttr('href');
              }
            });
          }
        },
        range: function range() {
          // range slider accessible by keyboard even if it's in slideshow, we want to catch key arrows and stop event propagation
          $('input[type="range"]').on('keydown', function (event) {
            var keyCodes = {
              DOWN: 40,
              END: 35,
              HOME: 36,
              LEFT: 37,
              RIGHT: 39,
              UP: 38
            }; // do nothing for not allowed keys
  
            if (!(Object.values(keyCodes).indexOf(event.keyCode) > -1)) return;
            event.stopPropagation();
          }).on('mousedown', function (event) {
            // and catch dragging
            event.stopPropagation();
          });
        }
      },
      control: function control() {
        $body.on('keypress click', '[class*="-ctrl-field"]', function (e) {
          if (e.which === 13 || e.type === 'click') {
            e.preventDefault();
            fieldsCtrl.$wrapper = $(this).closest('.reproducible__wrapper');
            fieldsCtrl.$toggle = $(this).closest('.reproducible');
            fieldsCtrl.$terms = $(this).closest('.reproducible__wrapper').find('.reproducible'); // LIT-161778 Support for the legacy emails and phones used in account page
  
            if ($(fieldsCtrl.container).length == 0) {
              if ($(this).is('.add-ctrl-field')) {
                if (fieldsCtrl.$terms.length < fieldsCtrl.maxClone + 1) {
                  fieldsCtrl.on.clone($(this));
                }
              } else {
                if (fieldsCtrl.$terms.length > 1) {
                  fieldsCtrl.on.remove($(this));
                }
              }
            }
          }
        });
        $body.on('click', '[name="markall"]', function (e) {
          fieldsCtrl.on.markAll($(this));
        });
      },
      additionalControls: function additionalControls() {},
      on: {
        clone: function clone($this) {
          jcf.destroy($('.reproducible .jcf'));
          fieldsCtrl.$toggle.clone(true, true).find('input').val('').end().appendTo(fieldsCtrl.$wrapper);
          $('.reproducible .jcf').each(function () {
            jcf.replace($(this));
          });
          fieldsCtrl.check.terms($this);
          var $lastTerm = fieldsCtrl.$wrapper.children('.reproducible').length;
          fieldsCtrl.check.lastClone($lastTerm);
        },
        remove: function remove($this) {
          fieldsCtrl.$toggle.remove();
          fieldsCtrl.check.terms($this);
          var $lastTerm = fieldsCtrl.$wrapper.children('.reproducible').length;
          fieldsCtrl.check.lastClone($lastTerm);
        },
        markAll: function markAll($el) {
          fieldsCtrl.$markAll = $el.closest('.markAll');
  
          if ($el.prop('checked')) {
            fieldsCtrl.$markAll.find('[type="checkbox"]').prop('checked', true);
          } else {
            fieldsCtrl.$markAll.find('[type="checkbox"]').prop('checked', false);
          }
        }
      },
      check: {
        terms: function terms($this) {
          var nameInput = $this.closest('.reproducible').find('input').attr('name');
  
          if (nameInput) {
            var before = nameInput.split("[");
            var after = before[1].split("]");
          }
          /*var matches = nameInput.match(/\[(.*?)\]/);
          if (matches) {
              var submatch = matches[1];
          }*/
          // Support for the legacy emails and phones used in account page
  
  
          if ($(fieldsCtrl.container).length == 0) {
            fieldsCtrl.$terms = $('.reproducible');
          } else {
            fieldsCtrl.$terms = $this.parents(fieldsCtrl.container).find('.reproducible');
          }
  
          var copy_from_template = 0;
          fieldsCtrl.$terms.each(function (index) {
            var $el = $(this);
  
            if ($el.parents('.template').length) {
              copy_from_template = 1;
            } else {
              var number = index - copy_from_template;
              $(this).find('input').attr('name', before[0] + "[" + number + "]" + after[1]);
            }
          }); // fieldsCtrl.$terms = $('.reproducible');
          //
          // fieldsCtrl.$terms.each(function (index) {
          //     var number = index;
          //
          //     $(this).find('input').attr('name', before[0] + "[" + index + "]" + after[1]);
          //
          // });
        },
        lastClone: function lastClone($this) {
          if ($this == fieldsCtrl.maxClone) {
            fieldsCtrl.$wrapper.children('.reproducible:last-child').children('.add-ctrl-field').addClass('hidden');
          } else {
            fieldsCtrl.$wrapper.children('.reproducible:last-child').children('.add-ctrl-field').removeClass('hidden');
          }
        }
      }
    };
    UX.fieldsCtrl = fieldsCtrl; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/basic/lists/js/list.js":
  /*!****************************************************!*\
    !*** /home/irahhal/ui-core/basic/lists/js/list.js ***!
    \****************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        $document = $(document);
    var list = {
      expandIcon: 'icon-add_box',
      collapseIcon: 'icon-squared-minus',
      init: function init() {
        list.on.build();
        list.control();
      },
      control: function control() {
        $body.on('click', '.expandable-list__toggle', function (e) {
          e.preventDefault();
          list.on.toggleList($(this));
        });
      },
      on: {
        build: function build() {
          var $wrapper = $('.expandable-list');
          var $toggle = $('.expandable-list__toggle');
          $wrapper.each(function () {
            var $target = $(this).find('.expandable-list__body');
            var $toggle = $(this).find('.expandable-list__toggle');
            $target.hide();
          });
        },
        toggleList: function toggleList(elem) {
          var $toggle = elem,
              $wrapper = $toggle.closest('.expandable-list'),
              $target = $wrapper.children('.expandable-list__body').toggle();
          list.defineToggleIcons($wrapper);
          $wrapper.toggleClass('js--open');
          $toggle.find('i').toggleClass(list.expandIcon + ' ' + list.collapseIcon);
  
          if ($wrapper.hasClass('js--open')) {
            $toggle.attr('aria-expanded', true);
            $target.attr('aria-hidden', false);
          } else {
            $toggle.attr('aria-expanded', false);
            $target.attr('aria-hidden', true);
          }
        },
        closeList: function closeList(elem) {
          var $wrapper = $('.expandable-list');
          list.defineToggleIcons($wrapper);
          $wrapper.removeClass('js--open');
          var $target = $wrapper.children('.expandable-list__body').hide();
          var $toggle = $('.expandable-list__toggle');
          $toggle.attr('aria-expanded', 'false').find('i').addClass(list.expandIcon).removeClass(list.collapseIcon);
          $target.attr('aria-hidden', true);
        }
      },
      defineToggleIcons: function defineToggleIcons($expandableList) {
        if ($expandableList.data('expand-icon') !== undefined && $expandableList.data('expand-icon') !== '') {
          list.expandIcon = $expandableList.data('expand-icon');
        }
  
        if ($expandableList.data('collapse-icon') !== undefined && $expandableList.data('collapse-icon') !== '') {
          list.collapseIcon = $expandableList.data('collapse-icon');
        }
      }
    };
    UX.list = list; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/accordion/js/accordion.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-core/components/accordion/js/accordion.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  (function () {
    var $body = $('body'),
        isMobile = false;
    var accordion = {
      $elements: $('.accordion'),
      $tabbedElements: $('.accordion-tabbed'),
      $controllers: $('.accordion__control'),
      //@todo: remove ambiguous DOM searches for elements that are unused and move other into init function
      $tabbedControllers: $('.accordion-tabbed__control'),
      isMobile: false,
      isStickyBody: false,
      vPort: "screen-sm",
      $responsiveElements: $('[data-accordion-vport]'),
      accVport: [],
      $responsiveTarget: [],
      collapseTabs: false,
      collapseAccordion: true,
      // collapse accordion on open new accordion
      defaultCollapsed: true,
      // collapse accordion on pageload
      hideAllBoolean: true,
      openedAccordion: 0,
      init: function init() {
        accordion.initResponsive();
        accordion.logic($('.accordion-tabbed')); // collapse all accordions on page load
  
        accordion.control();
        accordion.additionalControls();
      },
      additionalControls: function additionalControls() {},
      control: function control() {
        $body.on('click', '.accordion__control', function (e) {
          e.stopImmediatePropagation();
          var attr = $(this).is('[data-slide-target]'); // Check if its external link or if its slide controll and mobile view port
  
          if ($(this).hasClass("external") || _typeof(attr) !== ( true ? "undefined" : undefined) && attr !== false && isMobile) {
            return; // do nothing
          } else {
            e.preventDefault();
            var $this = $(this);
            accordion.on.toggle.single($this);
          }
  
          $(this).trigger('accordion:controlClick');
        });
        $body.on('click', '.accordion-tabbed__control', function (e) {
          var attr = $(this).is('[data-slide-target]'); // Check if its external link or if its slide controll and mobile view port or prevent accordion behavior
  
          if ($(this).hasClass("external") || _typeof(attr) !== ( true ? "undefined" : undefined) && attr !== false && isMobile || accordion.preventAccordionBehavior($(this))) {
            return; // do nothing
          } else {
            e.preventDefault();
            var $this = $(this);
            accordion.on.toggle.tabbed($this);
          }
        });
        $body.on('click', '.expand-all', function (e) {
          e.preventDefault();
          var $this = $(this);
          accordion.on.toggle.all($this);
        });
        $(document).on(accordion.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
        });
        $(document).on(accordion.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
        });
      },
      logic: function logic(elem) {
        if (accordion.hideAllBoolean) {
          accordion.hideAll();
        }
  
        accordion.$tabbedElements = elem;
        var parentAccordion = accordion.$tabbedElements.closest('.accordion');
        if (parentAccordion.parent('[data-default-collapsed]').length) accordion.defaultCollapsed = parentAccordion.parent().data('default-collapsed');
  
        if (accordion.defaultCollapsed) {
          accordion.$tabbedElements.each(function () {
            var $this = $(this);
            $this.find(".accordion-tabbed__tab").each(function (index) {
              var $this = $(this);
  
              if (accordion.preventAccordionBehavior($this)) {
                return;
              }
  
              if (!accordion.collapseTabsByDefault(this) && index == accordion.openedAccordion && !$this.hasClass('accordion__closed')) {
                $this.addClass('js--open');
                $this.find('.accordion-tabbed__control').attr('aria-expanded', 'true');
                $this.find('.accordion-tabbed__content').show();
  
                if ($this.find('.accordion-lazy').length) {
                  accordion.getAccordionContent($this.find('.accordion-lazy'));
                }
              } else {
                $this.removeClass('js--open');
                $this.find('.accordion-tabbed__control').attr('aria-expanded', 'false');
                $this.find('.accordion-tabbed__content').hide();
              }
            });
          });
        } else {
          accordion.$tabbedElements.each(function () {
            var $this = $(this);
            $this.find("[class*='accordion-tabbed__tab']").each(function (index) {
              var $this = $(this);
              $this.addClass('js--open');
              $this.find('.accordion-tabbed__control').attr('aria-expanded', 'true');
              $this.find('.accordion-tabbed__content').show();
            });
          });
        }
      },
      collapseTabsByDefault: function collapseTabsByDefault() {
        return accordion.collapseTabs;
      },
      additionalAjaxSuccess: function additionalAjaxSuccess($elem) {},
      getCustomAjaxUrl: function getCustomAjaxUrl($elem) {},
      buildAjaxUrl: function buildAjaxUrl($elem) {
        var ajaxUrl;
        var hasCustomUrl = typeof $elem.attr('data-custom-url') !== 'undefined' && $elem.attr('data-custom-url') == 'true';
  
        if (hasCustomUrl) {
          ajaxUrl = accordion.getCustomAjaxUrl($elem);
        } else {
          var widgetId = $elem.attr('data-widgetid');
          var dropzoneId = $elem.attr('data-dropzoneid');
          var pbContext = encodeURIComponent($('meta[name=pbContext]').attr("content"));
          ajaxUrl = '/pb/widgets/accordion/loadTab?pbContext=' + pbContext + '&widgetId=' + widgetId + '&dropZoneId=' + dropzoneId;
        }
  
        return ajaxUrl;
      },
      getAccordionContent: function getAccordionContent($elem) {
        var ajaxUrl = accordion.buildAjaxUrl($elem);
        var $parentTab = $elem.parent();
        $.ajax({
          url: ajaxUrl,
          success: function success(data) {
            $elem.closest('.accordion-tabbed__tab').attr('data-ajaxLoaded', 'true');
            $elem.replaceWith(data);
  
            if ($parentTab.find('.accordion-tabbed').length) {
              accordion.logic($parentTab.find('.accordion-tabbed'));
            }
  
            $parentTab.find('.accordion__spinner').remove();
            accordion.additionalAjaxSuccess($parentTab);
          },
          error: function error() {}
        });
      },
      on: {
        toggle: {
          single: function single($this) {
            var $accordionContent = $this.next('.accordion__content');
  
            if (typeof $this.attr('data-content-target') !== 'undefined') {
              var contentTarget = $this.attr('data-content-target');
              $accordionContent = $(contentTarget);
            }
  
            $accordionContent.slideToggle(200, function () {
              if ($this.parent().hasClass('article-accordion')) {
                $('.article-row-left').height('auto');
                accordion.isStickyBody = state;
              }
            });
            $this.toggleClass('js--open');
            var $wrapper = $this.closest(".expandable-accordion");
            var state = !($this.attr('aria-expanded') == 'true');
            $this.attr('aria-expanded', state);
            var accordionExpandedSingle = $.Event("accordion:expandedSingle");
            $(document).trigger(accordionExpandedSingle, [$this, $accordionContent]);
            if ($wrapper.length) accordion.on.checkExpandAll($this, state, $wrapper);
          },
          tabbed: function tabbed($this) {
            var $parent = $this.closest(".accordion-tabbed__tab");
            var $opened = $this.closest('.accordion-tabbed').children('.js--open');
            var state = !($this.attr('aria-expanded') == 'true');
            $this.attr('aria-expanded', state);
            var $wrapper = $this.closest(".expandable-accordion");
            if ($wrapper.length) accordion.on.checkExpandAll($this, state, $wrapper);
  
            if (!$parent.hasClass('js--open')) {
              if (accordion.collapseAccordion || accordion.extraCollapseAccordionCheck($parent)) {
                $opened.children('.accordion-tabbed__content').slideUp(200);
              }
  
              $parent.children('.accordion-tabbed__content').slideDown(200, function () {
                if (accordion.collapseAccordion || accordion.extraCollapseAccordionCheck($parent)) {
                  $opened.removeClass('js--open');
                }
  
                $parent.addClass('js--open');
  
                if ($parent.attr('data-ajaxLoaded') != 'true' && $parent.find('.accordion-lazy').length) {
                  accordion.getAccordionContent($parent.find('.accordion-lazy'));
                }
  
                accordion.on.expanded($this);
                var accordionExpandedTabbed = $.Event("accordion:expandedTabbed");
                $(document).trigger(accordionExpandedTabbed, [$this]);
              });
            } else {
              $parent.children('.accordion-tabbed__content').slideUp(200, function () {
                $this.removeClass('js--open');
                $parent.removeClass('js--open'); // @fixme: work with aria-expanded is missing here, so it doesn't work correct
              });
            }
          },
          all: function all($this) {
            var $wrapper = $this.closest(".expandable-accordion");
            var state = !($this.attr('aria-expanded') == 'true');
            $this.attr('aria-expanded', state);
  
            if (state) {
              $wrapper.find('.accordion-tabbed__tab').addClass('js--open');
              $wrapper.find('.accordion__control, .accordion-tabbed__control').addClass('js--open').attr('aria-expanded', state);
              $wrapper.find('.accordion__content, .accordion-tabbed__content').slideDown(200);
              $this.text('Hide All');
              var $lazy = $wrapper.find('[data-ajaxLoaded]');
              $lazy.each(function () {
                if ($lazy.attr('[data-ajaxLoaded]') != 'true' && $lazy.find('.accordion-lazy').length) {
                  accordion.getAccordionContent($lazy.find('.accordion-lazy'));
                }
              });
            } else {
              $wrapper.find('.accordion-tabbed__tab').removeClass('js--open');
              $wrapper.find('.accordion__control, .accordion-tabbed__control').removeClass('js--open').attr('aria-expanded', state);
              $wrapper.find('.accordion__content, .accordion-tabbed__content').slideUp(200);
              $this.text('Expand All');
            }
          }
        },
        expanded: function expanded($this) {},
        checkExpandAll: function checkExpandAll($this, state, $wrapper) {
          if ($wrapper.length) var $expandElem = $wrapper.find('.expand-all');
  
          if ($expandElem.length && $expandElem.attr('aria-expanded') == 'true') {
            $expandElem.attr('aria-expanded', state);
            if (state) $expandElem.text('Hide All');else $expandElem.text('Expand All');
          }
        }
      },
      hideAll: function hideAll() {
        //Hide accordion content on load (in case of disabled JS, the accordion should be open)
        accordion.$elements.each(function () {
          var $this = $(this);
          $this.find('.accordion__control').attr('aria-expanded', 'false');
  
          if (!$this.find('.accordion__content').hasClass("js--open")) {
            $this.find('.accordion__content').hide();
          } else if ($this.find('.accordion__content').hasClass("js--open")) {
            $this.find('.accordion__control').attr('aria-expanded', 'true');
          } else {
            $this.find('.accordion__content').removeClass("js--open");
          }
        });
      },
      initResponsive: function initResponsive() {
        if (accordion.$responsiveElements.length) {
          accordion.$responsiveElements.each(function (index) {
            accordion.$responsiveTarget[index] = $(this);
            accordion.accVport[index] = $(this).data('accordion-vport');
            accordion.setViewports(index);
          });
        }
      },
      preventAccordionBehavior: function preventAccordionBehavior($this) {
        if ($this.parents('[data-accordion-vport]:not(.accordion-vport--res)').length) return true;
        return false;
      },
      extraCollapseAccordionCheck: function extraCollapseAccordionCheck($parent) {
        if (accordion.collapseAccordion) return true;
        return false;
      },
      setViewports: function setViewports(index) {
        $(document).on(accordion.accVport[index] + '-on', function () {
          var target = accordion.$responsiveTarget[index];
  
          if (target.data('accordion-vport') == accordion.accVport[index]) {
            target.addClass("accordion-vport--res");
  
            if (target.data('accordion-option') == "with-arrow") {
              target.addClass("accordion-with-arrow");
            }
  
            accordion.logic(accordion.$responsiveTarget[index].find('.accordion-tabbed'));
          }
        });
        $(document).on(accordion.accVport[index] + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          var target = accordion.$responsiveTarget[index];
  
          if (target.data('accordion-vport') == accordion.accVport[index]) {
            target.removeClass("accordion-vport--res accordion-with-arrow");
            target.find('.accordion-tabbed__content').show();
          }
        });
      }
    };
    UX.accordion = accordion; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/article-actions-bar/js/article-action-bar.js":
  /*!*************************************************************************************!*\
    !*** /home/irahhal/ui-core/components/article-actions-bar/js/article-action-bar.js ***!
    \*************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var articleActionsbar = {
      init: function init() {
        articleActionsbar.set.variables();
        articleActionsbar.showHideActionBtns();
        articleActionsbar.controls();
      },
      set: {
        variables: function variables() {
          articleActionsbar.form = document.getElementById('frmIssueItems');
          articleActionsbar.checkboxes = document.querySelectorAll('.issue-Item__checkbox');
          articleActionsbar.btns = document.querySelectorAll('.article-actionbar__btn');
          articleActionsbar.btnsContainer = document.querySelector('.article-actionbar__btns');
          articleActionsbar.selectAllBox = document.querySelector('.article-actionbar__check-all input');
          articleActionsbar.hideActionsClass = 'article-actionbar__btns--hide';
        }
      },
      controls: function controls() {
        articleActionsbar.selectAllBox.addEventListener('click', function () {
          var isChecked = this.checked;
          articleActionsbar.checkboxes.forEach(function (item) {
            return item.checked = isChecked;
          });
          articleActionsbar.showHideActionBtns();
        });
        articleActionsbar.checkboxes.forEach(function (elem) {
          elem.addEventListener('click', function () {
            articleActionsbar.selectAllBox.checked = articleActionsbar.allItemsSelected();
            articleActionsbar.showHideActionBtns();
          });
        });
        articleActionsbar.btns.forEach(function (elem) {
          elem.addEventListener('click', function (e) {
            var _this = this;
  
            e.preventDefault();
  
            if (!_this.hasAttribute('data-toggle')) {
              articleActionsbar.form.action = _this.href;
              articleActionsbar.form.submit();
            }
          });
        });
      },
      allItemsSelected: function allItemsSelected() {
        return Array.from(articleActionsbar.checkboxes).every(function (item) {
          return item.checked;
        });
      },
      hasSelectedItems: function hasSelectedItems() {
        return Array.from(articleActionsbar.checkboxes).some(function (item) {
          return item.checked;
        });
      },
      showHideActionBtns: function showHideActionBtns() {
        if (!articleActionsbar.hasSelectedItems()) {
          articleActionsbar.btnsContainer.classList.add(articleActionsbar.hideActionsClass);
        } else {
          articleActionsbar.btnsContainer.classList.remove(articleActionsbar.hideActionsClass);
        }
      }
    };
    UX.articleActionsbar = articleActionsbar;
    document.addEventListener('DOMContentLoaded', function () {
      if (document.querySelector('.article-actionbar')) {
        UX.articleActionsbar.init();
      }
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/autosave-form/js/autosave-form.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/components/autosave-form/js/autosave-form.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var pdAutoSave = {
      /**
       * Minimum period between any two auto-saves
       * The value is in seconds
       */
      period: 3,
  
      /**
       * Current state of the widget
       * Possible values [ init | saving | saved | error ]
       */
      state: null,
  
      /**
       * The auto-save url used in the ajax request
       */
      url: null,
  
      /**
       * Last save time in timestamp format
       */
      lastSaved: null,
  
      /**
       * Form to be auto-saved
       */
      $form: null,
  
      /**
       * label to show the current status
       */
      $status: null,
  
      /**
       * Selector for the fields that you want to detect their changes and autosave
       */
      detectChangesOn: ".autosave-field",
      init: function init() {
        this.$form = $('.autosave-form');
        this.$status = this.$form.find('.autosave-status');
        this.url = this.$form.data('autosave-url');
        this.setStatus('init');
        this.controller();
      },
      controller: function controller() {
        this.$form.on('change', pdAutoSave.detectChangesOn, function () {
          pdAutoSave.check();
        });
        $(document).on('autosave', function () {
          pdAutoSave.check();
        });
        $(document).on('autosave:now', function () {
          pdAutoSave.save();
        });
      },
      check: function check() {
        var now = Date.now();
  
        if (!pdAutoSave.lastSaved || (now - pdAutoSave.lastSaved) / 1000 > this.period) {
          this.save();
        }
      },
      save: function save() {
        this.on.saving();
        pdAutoSave.lastSaved = Date.now();
        $.ajax({
          url: pdAutoSave.url,
          method: 'POST',
          data: pdAutoSave.$form.serialize(),
          success: function success() {
            pdAutoSave.on.saved();
            pdAutoSave.$form.trigger('autosave:saved');
          },
          error: function error() {
            pdAutoSave.on.error();
            pdAutoSave.$form.trigger('autosave:error');
          },
          complete: function complete() {
            pdAutoSave.$form.trigger('autosave:complete');
          }
        });
      },
  
      /**
       * Set current state class to the status element
       */
      setStatus: function setStatus(status) {
        this.state = status;
        pdAutoSave.$status.removeClass("autosave-init");
        pdAutoSave.$status.removeClass("autosave-saving");
        pdAutoSave.$status.removeClass("autosave-saved");
        pdAutoSave.$status.removeClass("autosave-error");
        pdAutoSave.$status.addClass("autosave-" + pdAutoSave.state);
      },
      on: {
        saving: function saving() {
          pdAutoSave.setStatus('saving');
          pdAutoSave.$status.find('span').text('Saving...');
        },
        saved: function saved() {
          pdAutoSave.setStatus('saved');
          pdAutoSave.$status.find('span').text('Last saved at ' + pdAutoSave.getDateTimeFromTimestamp(pdAutoSave.lastSaved));
        },
        error: function error() {
          pdAutoSave.setStatus('error');
          pdAutoSave.$status.find('span').text('Error while saving!');
        }
      },
      getDateTimeFromTimestamp: function getDateTimeFromTimestamp(timestamp) {
        var time = new Date(timestamp);
        var hour = time.getHours();
        var minute = time.getMinutes();
        var second = time.getSeconds();
        var temp = '' + (hour > 12 ? hour - 12 : hour);
        if (hour == 0) temp = '12';
        temp += (minute < 10 ? ':0' : ':') + minute;
        temp += (second < 10 ? ':0' : ':') + second;
        temp += hour >= 12 ? ' PM' : ' AM';
        return temp;
      }
    };
    UX.pdAutoSave = pdAutoSave;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/back-to-top/js/back-to-top.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/components/back-to-top/js/back-to-top.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var backToTop = {
      element: '.back-to-top',
      footerBackToTop: 'footer .back-to-top',
      init: function init() {
        backToTop.controller();
      },
      controller: function controller() {
        $body.on('click', backToTop.element, function (e) {
          e.preventDefault();
          $('html, body').animate({
            scrollTop: 0
          }, 600);
        });
        $window.on("scroll", function () {
          if ($(backToTop.footerBackToTop).length) {
            if ($(this).scrollTop() > $('header').height()) {
              $(backToTop.footerBackToTop).addClass('back-to-top__is-visible');
            } else {
              $(backToTop.footerBackToTop).removeClass('back-to-top__is-visible back-to-top__fade-out');
            }
  
            if ($(this).scrollTop() > 400) {
              $(backToTop.footerBackToTop).addClass('back-to-top__fade-out');
            }
  
            if (backToTop.check.isfooterVisible()) {
              $(backToTop.footerBackToTop).addClass('back-to-top__static');
            } else {
              $(backToTop.footerBackToTop).removeClass('back-to-top__static');
            }
          }
        });
      },
      check: {
        isfooterVisible: function isfooterVisible() {
          var docViewBottom = $(window).scrollTop() + $(window).height();
          var backToTopPos = $('footer').offset().top;
          return backToTopPos <= docViewBottom;
        }
      }
    };
    UX.backToTop = backToTop;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/client-pagination/js/client-pagination.js":
  /*!**********************************************************************************!*\
    !*** /home/irahhal/ui-core/components/client-pagination/js/client-pagination.js ***!
    \**********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var clientPagination = {
      containerName: ".client-pagination",
      showPerPage: null,
      $currentPage: null,
      $pagesdisplyed: null,
      tableRow: ".client-pagination-table .tablerow",
      init: function init() {
        clientPagination.showPerPage = parseInt($(clientPagination.containerName).find('.show_per_page').val(), 0);
        clientPagination.$currentPage = $(clientPagination.containerName).find('.current_page');
        clientPagination.$pagesdisplyed = parseInt($(clientPagination.containerName).find('.pages-displyed').val(), 0);
        clientPagination.buildPagination();
        clientPagination.control();
      },
      set: {
        containerName: function containerName(name) {
          clientPagination.containerName = name;
        },
        tableRowName: function tableRowName(name) {
          clientPagination.tableRow = name;
        }
      },
      control: function control() {
        $body.on('click', clientPagination.containerName + ' .pagination__btn--prev', function (e) {
          e.preventDefault();
          clientPagination.previous();
        });
        $body.on('click', clientPagination.containerName + ' .pagination__btn--next', function (e) {
          e.preventDefault();
          clientPagination.next();
        });
        $body.on('click', clientPagination.containerName + ' .page', function (e) {
          e.preventDefault();
          clientPagination.goToPage($(this).data('page-index'));
        });
      },
      buildPagination: function buildPagination() {
        var number_of_items = $(clientPagination.tableRow).length;
        var number_of_pages = Math.ceil(number_of_items / clientPagination.showPerPage);
        $(clientPagination.containerName).remove('.page');
  
        if (number_of_items > clientPagination.showPerPage) {
          $(clientPagination.tableRow).css('display', 'none');
          $(clientPagination.containerName).removeClass('hidden');
          $(clientPagination.tableRow).slice(0, clientPagination.showPerPage).css('display', 'table-row');
          $(clientPagination.containerName).find('.prev').hide();
          $(clientPagination.containerName).find('.next').show();
          var i = 0;
          $(clientPagination.containerName).find('.pages').empty();
  
          while (i < number_of_pages) {
            if (i >= clientPagination.$pagesdisplyed) {
              $(clientPagination.containerName).find('.pages').append('<a class="page hidden" href="#" title="page ' + (i + 1) + '" data-page-index="' + i + '">' + (i + 1) + '</a>');
            } else {
              $(clientPagination.containerName).find('.pages').append('<a class="page" href="#" title="page ' + (i + 1) + '" data-page-index="' + i + '">' + (i + 1) + '</a>');
            }
  
            i++;
          }
  
          $(clientPagination.containerName).find('[data-page-index="0"]').addClass('selected');
        } else {
          $(clientPagination.containerName).addClass('hidden');
        }
      },
      goToPage: function goToPage(page_num) {
        var number_of_items = $(clientPagination.tableRow).length;
        var number_of_pages = Math.ceil(number_of_items / clientPagination.showPerPage);
        var start_from = page_num * clientPagination.showPerPage;
        var end_on = start_from + clientPagination.showPerPage;
        var $currentPage = $(clientPagination.containerName).find('[data-page-index="' + page_num + '"]');
        $(clientPagination.tableRow).css('display', 'none').slice(start_from, end_on).css('display', 'table-row');
        clientPagination.$currentPage.val(page_num);
        $(clientPagination.containerName).find('.page').removeClass('selected');
        $currentPage.addClass('selected');
        var showpagesBeforeAfter = Math.ceil(clientPagination.$pagesdisplyed / 2);
        $(clientPagination.containerName).find('.page').addClass('hidden');
  
        if (page_num + 1 > showpagesBeforeAfter) {
          for (i = page_num + 1 - showpagesBeforeAfter; i < page_num + showpagesBeforeAfter; i++) {
            if (i <= number_of_pages) $(clientPagination.containerName).find('[data-page-index="' + i + '"]').removeClass('hidden');
          }
        } else {
          for (i = 0; i < clientPagination.$pagesdisplyed; i++) {
            $(clientPagination.containerName).find('[data-page-index="' + i + '"]').removeClass('hidden');
          }
        }
  
        if (page_num == 0) $(clientPagination.containerName).find('.prev').hide();else $(clientPagination.containerName).find('.prev').show();
        if (page_num == number_of_pages - 1) $(clientPagination.containerName).find('.next').hide();else $(clientPagination.containerName).find('.next').show();
      },
      previous: function previous() {
        var new_page = parseInt(clientPagination.$currentPage.val(), 0) - 1;
  
        if (new_page > -1) {
          clientPagination.goToPage(new_page);
        }
      },
      next: function next() {
        var new_page = parseInt(clientPagination.$currentPage.val(), 0) + 1;
        var number_of_items = $(clientPagination.tableRow).length;
        var number_of_pages = Math.ceil(number_of_items / clientPagination.showPerPage);
  
        if (new_page < number_of_pages) {
          clientPagination.goToPage(new_page);
        }
      }
    };
    UX.clientPagination = clientPagination; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/coolbar/js/coolbar.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/components/coolbar/js/coolbar.js ***!
    \**************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var coolbar = {
      sections: null,
      holder: $('.coolBar--sections .coolBar__drop'),
      vPort: "screen-sm",
      isMobile: false,
      coolbarElement: null,
      headerHeight: 0,
      isStickyBar: false,
      lock: true,
      // define lock and set default value, this lock will be used to make sure to run certain functionality and to run on every scroll event
      init: function init() {
        coolbar.coolbarElement = $(".coolBar");
        coolbar.isStickyBar = coolbar.coolbarElement.hasClass("stickybar");
        coolbar.get.sections();
        coolbar.fill.sections();
        coolbar.control();
        coolbar.addtionalControls();
      },
      control: function control() {
        if ($('.journal-home').length) {
          coolbar.vPort = "screen-md";
        }
  
        $(document).on(coolbar.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          $('.coolBar').addClass("coolBar--res"); // class will be used in our scss (to replace media queries)
  
          coolbar.isMobile = true;
  
          if ($(".stickybar.coolBar--res,.coolBar.coolBar--res").length > 0) {
            $(".content>article.container").addClass("article--res");
          }
        });
        $(document).on(coolbar.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          $('.coolBar').removeClass("coolBar--res");
          $(".content article.container").removeClass("article--res");
          $(document).trigger("eventSetContentPadding");
          coolbar.isMobile = false;
  
          if (typeof UX.controller !== 'undefined') {
            UX.controller.check();
          }
        });
      },
      addtionalControls: function addtionalControls() {},
      get: {
        sections: function sections() {
          coolbar.sections = $('.article__content .section__title');
        }
      },
      fill: {
        sections: function sections() {
          if ($('.coolBar--sections').length && coolbar.sections.length > 1) {
            $('.coolBar--sections').removeClass("hidden");
            var ul = $('<ul class="rlist w-slide--list"/>').appendTo(coolbar.holder);
            coolbar.sections.each(function () {
              var $this = $(this);
              var li = $('<li/>').attr('role', 'menuitem').appendTo(ul);
              var link = $('<a class="w-slide__hide"/>').attr('href', "#" + $this.attr('id')).appendTo(li);
              var spaner = $('<span/>').text($(this).text()).appendTo(link);
            });
          } else {
            $('.coolBar--sections').remove();
          }
  
          if ($('.authorArticleInfoCon').length) {
            $(".coolBar--sections .coolBar__drop").append('<li role="menuitem"><a class="w-slide__hide" href="#_ac_authorArticleInfoCon" target="_self"><span>Author and Article Information</span></a></li>');
          }
        }
      }
    };
    UX.coolbar = coolbar; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/counter/js/counter.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/components/counter/js/counter.js ***!
    \**************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var charCounter = {
      $counters: null,
      counter: null,
      counterInput: null,
      counterOutput: null,
      $target: null,
      $targetInput: null,
      $argetOutput: null,
      maxlength: null,
      init: function init() {
        this.counter = ".js-counter";
        this.counterInput = ".js-counter__input";
        this.counterOutput = ".js-counter__output";
        this.$counters = $(this.counterInput);
        charCounter.controller();
      },
      controller: function controller() {
        $.each(this.$counters, function (i, item) {
          $(item).closest(charCounter.counter).find(charCounter.counterOutput).html($(item).attr("data-maxchars") - $(item).val().length);
        });
        charCounter.$counters.on('focus', charCounter.on.focus);
      },
      on: {
        focus: function focus(event) {
          charCounter.$targetInput = $(event.currentTarget);
          charCounter.$targetOutput = charCounter.$targetInput.closest(charCounter.counter).find(charCounter.counterOutput);
          charCounter.$targetInput.on('keyup change', charCounter.on.count);
          charCounter.$targetInput.on('blur', charCounter.on.blur);
          charCounter.maxlength = charCounter.$targetInput.attr("data-maxchars");
          charCounter.on.count();
        },
        blur: function blur() {
          charCounter.$targetInput.off('keyup', charCounter.on.count);
        },
        count: function count() {
          var inputVal = charCounter.$targetInput.val();
          var inputLength = inputVal.length;
          var left = charCounter.maxlength - inputLength;
  
          if (inputLength > charCounter.maxlength) {
            charCounter.$targetInput.val(inputVal.substr(0, charCounter.maxlength));
            left = 0;
          }
  
          charCounter.$targetOutput.text(left);
        }
      }
    };
    UX.charCounter = charCounter; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/datepicker/js/datepicker.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/components/datepicker/js/datepicker.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var datepicker = {
      dateFormat: "yy-mm-dd",
      $datepicker: $(".datepicker"),
      $body: $('body'),
      lastModfied: '',
      vPort: '',
      init: function init() {
        // IF native support is not present, use jQuery datepicker on every type=date input
        if (!UX.test.inputDate()) {
          datepicker.$datepicker = datepicker.$datepicker.add($('[type=date]'));
        }
  
        datepicker.$datepicker.each(function () {
          var $element = $(this);
          var data = $element.data();
  
          if (typeof $element.datepicker !== 'undefined') {
            $element.datepicker({
              dateFormat: data.dateFormat ? data.dateFormat : datepicker.dateFormat // custom date format from data-attr or default one
  
            }); //set the alt field & the alt format if exist
  
            if (data.altFieldName) {
              $element.datepicker("option", "altField", '[name="' + data.altFieldName + '"]');
              $element.datepicker("option", "altFormat", datepicker.dateFormat);
            }
          }
        });
      }
    };
    UX.datepicker = datepicker; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/drop-block/js/drop-block.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/components/drop-block/js/drop-block.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // tabs.js calls UX.dropBlock.init(); on line 260
  // profile-menu.js calls UX.dropBlock.init(); on line 53
  (function () {
    var $window = $(window),
        $body = $('body');
    var dropBlock = {
      $controllers: $("[data-db-target-for]"),
      $targets: null,
      // Holds all targets in Dom
      $controller: null,
      // Current drop down controller
      $target: null,
      // Current target down controller element
      $parents: null,
      // Hodls all parents in Dom
      $parent: null,
      // Current parent element
      escape: 27,
      $container: $(".container"),
      switchVal: null,
      $section: $(".dropBlock__holder"),
      vPort: "screen-sm",
      isMobile: false,
      initialized: false,
      direction: 'left',
      // left , right
      pop: 'down',
      // up , down
      init: function init() {
        dropBlock.control();
      },
      control: function control() {
        if (dropBlock.initialized) {
          return;
        }
  
        dropBlock.initialized = true;
        $(document).on('click', '[data-db-target-for]', function (e) {
          e.preventDefault();
          e.stopPropagation();
          var isOpen = $(this).hasClass("js--open"),
              isDataSlideTarget = $(this).is('[data-slide-target]'),
              disableOnMobile = $(this).data('db-sm-disable') || false;
          dropBlock.$controller = $(this);
          dropBlock.find.target();
  
          if (isOpen) {
            dropBlock.on.hide();
          } else {
            if (dropBlock.isMobile && (isDataSlideTarget !== false || disableOnMobile)) {
              return;
            } else {
              dropBlock.on.show(e);
            }
          }
        });
        $(document).on('click', '.coolBar:not(.loi__banner) [data-db-target-of] a:not([data-slide-target])', function (e) {
          dropBlock.on.hide();
        });
        $window.on('resize', function () {
          if (dropBlock.$parent != null) {
            dropBlock.find.dimensions();
          }
        });
        $(document).on(dropBlock.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          dropBlock.isMobile = true;
        });
        $(document).on(dropBlock.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          dropBlock.isMobile = false;
        });
      },
      on: {
        show: function show(e) {
          // show  target element
          if (!dropBlock.$controller.closest(".dropBlock__holder").length) {
            if (typeof UX.controller != "undefined") {
              UX.controller.check(e);
            }
          }
  
          if (dropBlock.$target) {
            dropBlock.$controller.trigger('dropBlock:open', [dropBlock]);
            dropBlock.$target.addClass("js--open");
            dropBlock.$controller.addClass("js--open");
            $body.attr('data-active', 'dropBlock');
            dropBlock.$target.closest("[class*='sticko']").addClass("js--open");
            dropBlock["switch"].icon(); // Move focus to active inner component, or leave focus on control
  
            dropBlock.$target.find('.active :tabbable').first().focus(); // Accessibility
  
            dropBlock.$controller.attr({
              'aria-expanded': 'true'
            });
            dropBlock.$target.removeAttr('aria-hidden'); // @fixme - this should not be here at all - it should be moved to proper component
  
            var isLoi = dropBlock.$target.find('.loi').length > 0;
  
            if (isLoi) {
              dropBlock.$target.find('.loi__list').each(function () {
                UX.loi.on.recalculate($(this));
              });
            }
  
            dropBlock.$controller.trigger('dropBlock:opened', [dropBlock]);
          }
  
          dropBlock.additionalOnShow();
        },
        hide: function hide() {
          // hide target element
          if (dropBlock.$target) {
            dropBlock.$controller.trigger('dropBlock:close', [dropBlock]); // Close current target
  
            dropBlock.$controller.removeClass("js--open");
            dropBlock.$target.removeClass("js--open"); // Play nicely with others ...
            // For plugins which don't use js--open class but uses .hide .show methods instead, reset them ...
            // For example LOA accordion
  
            if (dropBlock.$target.attr('style')) {
              dropBlock.$target.removeAttr('style');
            } // Explicitly for our accordion working as a drop-block
  
  
            dropBlock.$target.closest("[class*='accordion-tabbed__tab']").removeClass("js--open");
            dropBlock.$target.closest("[class*='sticko']").removeClass("js--open");
            dropBlock["switch"].back(); // Accessibility - Inform screen readers
  
            dropBlock.$controller.attr({
              'aria-expanded': 'false'
            });
            dropBlock.$target.attr({
              'aria-hidden': 'true'
            }); // Nested dropBlocks close handling
  
            if (dropBlock.$parentSection && dropBlock.$parentSection.length) {
              // Nested ones - set parent after closing self - will close parent in second round
              dropBlock.$controller = $('[data-db-target-for="' + dropBlock.$parentSection.attr('data-db-target-of') + '"]');
              dropBlock.find.target();
            } else {
              // If we want to close last drop block, than there is no more active component
              if ($body.attr('data-active') === "dropBlock") {
                $body.removeAttr('data-active');
                $('body, html').removeClass('lock-screen'); // @todo investigate if this is needed for drop Blocks or was copied out of other component
              }
            }
  
            if (dropBlock.$target) {
              dropBlock.$target.find('input:focus').blur();
            }
  
            dropBlock.$controller.trigger('dropBlock:closed', [dropBlock]);
          }
  
          dropBlock.additionalOnHide();
        },
        escape: function escape() {
          // hide target if user clicks escape key
          // @fixme this seems unused and deprecated by controller.js
          if (dropBlock.$target != null) {
            dropBlock.on.hide();
          }
        }
      },
      find: {
        target: function target() {
          // get the target element if existed
          if ($("[data-db-target-of]").length) {
            dropBlock.$targets = $("[data-db-target-of]");
            dropBlock.$target = $("[data-db-target-of=" + dropBlock.$controller.attr("data-db-target-for") + "]");
            dropBlock.$section = dropBlock.$target;
            var $nested = dropBlock.$section.parents('.dropBlock__holder');
  
            if ($nested.length) {
              dropBlock.$parentSection = $nested;
            } else {
              dropBlock.$parentSection = null;
            }
  
            dropBlock.find.parent();
          }
        },
        parent: function parent() {
          // get the parent element if existed
          dropBlock.$parent = null;
          dropBlock.$parents = $("[data-db-parent-of]");
  
          if (dropBlock.$parents.length) {
            dropBlock.$parents.each(function () {
              var current = dropBlock.$controller.attr("data-db-target-for");
              var parentFor = $(this).data("db-parent-of").split(',');
  
              if (parentFor.indexOf(current) !== -1) {
                dropBlock.$parent = $(this);
                return false;
              }
            });
  
            if (dropBlock.$parent != null) {
              dropBlock.find.dimensions();
              dropBlock.find.ifContaind();
            }
          }
        },
        ifContaind: function ifContaind() {
          // check if it parent or target has container element
          if (dropBlock.$parent.find(".container").length && !dropBlock.$target.find(".container").length) {
            dropBlock.$target.wrapInner("<div class='container'></div>");
          }
        },
        dimensions: function dimensions() {
          // count the top and left position of the target element based on teh parent element
          var nHeight = dropBlock.$parent.outerHeight(),
              pOffset = dropBlock.$parent.offset(),
              pLeft = pOffset.left,
              nWidth = dropBlock.$parent.innerWidth(),
              styles = {},
              container_offset = pOffset;
          dropBlock.$container = $(".container");
  
          if (dropBlock.$container.length) {
            container_offset = dropBlock.$container.offset();
          }
  
          var container_left = container_offset.left,
              container_base = container_left + dropBlock.$container.width(),
              parent_base = nWidth + pLeft;
  
          if (dropBlock.$parent.find(".scrollThenFix").length) {
            nHeight = dropBlock.$parent.find(".scrollThenFix").outerHeight();
          }
  
          if (dropBlock.$parent.innerWidth() == dropBlock.$controller.innerWidth()) {
            nWidth = dropBlock.$parent.hasClass('no-auto-width') ? "" : "auto";
  
            if (dropBlock.isMobile) {
              nWidth = dropBlock.$parent.hasClass('no-auto-width') ? "" : "100%";
            }
          }
  
          if (parent_base > container_base) {
            styles = {
              top: nHeight,
              right: "0px",
              width: nWidth
            };
          } else {
            styles = {
              top: nHeight,
              width: nWidth
            };
            var direction = dropBlock.$parent.data('db-direction') || dropBlock.direction;
  
            switch (direction) {
              case 'left':
              case 'right':
                styles[direction] = '0px';
                break;
  
              case 'center':
                var offset = dropBlock.$target.innerWidth() / 2 - dropBlock.$parent.innerWidth();
                styles['left'] = "calc(-50% - ".concat(offset, "px)");
            }
          }
  
          dropBlock.$target.css(styles);
        }
      },
      "switch": {
        icon: function icon() {
          dropBlock.switchVal = dropBlock.$controller.attr("data-db-switch");
  
          switch (dropBlock.switchVal) {
            case "none":
              break;
  
            case "rotate":
              dropBlock.$controller.find("i").addClass("js--rotated");
              break;
  
            default:
              dropBlock.$controller.find("i").addClass(dropBlock.switchVal);
          }
        },
        back: function back() {
          dropBlock.$controllers.each(function () {
            var temp = $(this).attr("data-db-switch");
  
            switch (temp) {
              case "none":
                break;
  
              case "rotate":
                $(this).find("i").removeClass("js--rotated");
                break;
  
              default:
                if (temp !== undefined) $(this).find("i").removeClass(temp);
            }
          });
        }
      },
      additionalOnShow: function additionalOnShow() {},
      additionalOnHide: function additionalOnHide() {}
    };
    UX.dropBlock = dropBlock; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/edit-in-place/js/edit-in-place.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/components/edit-in-place/js/edit-in-place.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var editInPlace = {
      $editables: null,
      editable: null,
      editableInput: null,
      editableText: null,
      target: null,
      targetInput: null,
      targetText: null,
      CLASS_HIDDEN: "__hidden",
      vPort: 'all',
      // the view port to make the edit in place work above
      isMobile: null,
      emptyPlaceholder: "Click to edit",
      init: function init() {
        this.editable = ".js-editable";
        this.editableInput = ".js-editable__input";
        this.editableText = ".js-editable__text";
        this.$editables = $(this.editable);
        $.each(this.$editables, function (i, item) {
          if ($(item).find(editInPlace.editableText).text() == "") {
            $(item).find(editInPlace.editableText).text(editInPlace.emptyPlaceholder);
          }
        });
        editInPlace.controller();
        editInPlace.responsive();
      },
      responsive: function responsive() {
        if (editInPlace.vPort !== "all") {
          $(document).on(editInPlace.vPort + '-off', function () {
            // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
            if (editInPlace.isMobile === null || editInPlace.isMobile === true) {
              editInPlace.controller();
            }
  
            editInPlace.isMobile = false;
          });
          $(document).on(editInPlace.vPort + '-on', function () {
            // Waiting for custom event that will be triggered by controller.js to activate responsive effects
            if (editInPlace.isMobile === null || editInPlace.isMobile === false) {
              editInPlace.disable();
            }
  
            editInPlace.isMobile = true;
          });
        }
      },
      controller: function controller() {
        editInPlace.$editables.on('click', editInPlace.editableText, editInPlace.on.show);
      },
      disable: function disable() {
        editInPlace.$editables.off('click', editInPlace.editableText, editInPlace.on.show);
      },
      on: {
        show: function show(event) {
          event.stopPropagation();
          editInPlace.on.hideAll();
          editInPlace.target = $(event.currentTarget).closest(editInPlace.editable);
          editInPlace.targetText = editInPlace.target.find(editInPlace.editableText);
          editInPlace.targetInputContainer = editInPlace.target.find(editInPlace.editableInput);
          editInPlace.targetInput = editInPlace.targetInputContainer.is("input, textarea") ? editInPlace.targetInputContainer : editInPlace.targetInputContainer.find("input, textarea");
          editInPlace.targetText.addClass(editInPlace.CLASS_HIDDEN);
          editInPlace.target.addClass('js--open'); // auto height for text area
  
          if (editInPlace.targetInput.is("textarea")) {
            editInPlace.targetInput.height(5);
            editInPlace.targetInput.height(editInPlace.targetInput[0].scrollHeight);
          }
  
          editInPlace.targetInput.focus(); // hack to have cursor at the end of text in input
  
          /**
           * WHY THIS HACK! I don't know
           var tmpStr = editInPlace.targetInput.val();
           editInPlace.targetInput.val('');
           editInPlace.targetInput.val(tmpStr);
           **/
          // end of hack
  
          editInPlace.targetInput.on('keyup', function (event) {
            event.stopPropagation();
            var keycode = event.keyCode;
  
            switch (keycode) {
              case 9:
              case 13:
                editInPlace.on.save();
                break;
  
              case 27:
                editInPlace.on.cancel();
                break;
  
              default:
                // auto height for text area
                if (editInPlace.targetInput.is("textarea")) {
                  editInPlace.targetInput.height(5);
                  editInPlace.targetInput.height(editInPlace.targetInput[0].scrollHeight);
                }
  
                return;
            }
          }); //editInPlace.targetInput.on('blur', editInPlace.on.save);
  
          editInPlace.targetInputContainer.on('click', ".btn-save", function (e) {
            e.preventDefault();
            editInPlace.on.save();
          });
          $(document).on('click', editInPlace.on.clickOutside);
        },
        cancel: function cancel() {
          editInPlace.targetInput.val(editInPlace.targetText.text());
          editInPlace.on.hide();
        },
        save: function save() {
          var evt = $.Event('editInPlace:onSave');
          editInPlace.target.trigger(evt);
          if (evt.isDefaultPrevented()) return false;
          editInPlace.targetText.text(editInPlace.targetInput.val());
          editInPlace.targetText.attr("title", editInPlace.targetInput.val());
          editInPlace.on.hide();
        },
        hide: function hide() {
          editInPlace.target.removeClass('js--open');
          editInPlace.targetText.removeClass(editInPlace.CLASS_HIDDEN);
          editInPlace.targetInput.off('blur', editInPlace.on.blur);
          editInPlace.targetInputContainer.off('click');
          $(document).off('click', editInPlace.on.clickOutside);
        },
        clickOutside: function clickOutside(e) {
          if (!$(e.target).closest(editInPlace.editable + ".js--open").length) editInPlace.on.hideAll();
        },
        hideAll: function hideAll() {
          editInPlace.$editables.filter('.js--open').each(function () {
            editInPlace.target = $(this).closest(editInPlace.editable);
            editInPlace.targetText = $(editInPlace.target).find(editInPlace.editableText);
            editInPlace.targetInputContainer = $(editInPlace.target).find(editInPlace.editableInput);
            editInPlace.targetInput = editInPlace.targetInputContainer.is("input, textarea") ? editInPlace.targetInputContainer : editInPlace.targetInputContainer.find("input, textarea");
            editInPlace.on.save();
          });
        }
      }
    };
    UX.editInPlace = editInPlace; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/facet-date-chart/js/facet-date-chart.js":
  /*!********************************************************************************!*\
    !*** /home/irahhal/ui-core/components/facet-date-chart/js/facet-date-chart.js ***!
    \********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  $.widget("ui.slider", $.ui.slider, {
    options: {
      chart: false
    },
    _refreshValue: function _refreshValue() {
      var lastValPercent,
          valPercent,
          value,
          valueMin,
          valueMax,
          oRange = this.options.range,
          oChart = this.options.chart,
          o = this.options,
          that = this,
          animate = !this._animateOff ? o.animate : false,
          _set = {};
  
      if (this._hasMultipleValues()) {
        this.handles.each(function (i) {
          if (oChart) {
            if (i === 0) {
              valPercent = (that.values(i) - that._valueMin()) / (that._valueMax() - that._valueMin() + 1) * 100;
            }
  
            if (i === 1) {
              valPercent = (that.values(i) - that._valueMin() + 1) / (that._valueMax() - that._valueMin() + 1) * 100;
            }
          } else {
            valPercent = (that.values(i) - that._valueMin()) / (that._valueMax() - that._valueMin()) * 100;
          }
  
          _set[that.orientation === "horizontal" ? "left" : "bottom"] = valPercent + "%";
          $(this).stop(1, 1)[animate ? "animate" : "css"](_set, o.animate);
  
          if (that.options.range === true) {
            if (that.orientation === "horizontal") {
              if (i === 0) {
                that.range.stop(1, 1)[animate ? "animate" : "css"]({
                  left: valPercent + "%"
                }, o.animate);
              }
  
              if (i === 1) {
                that.range[animate ? "animate" : "css"]({
                  width: valPercent - lastValPercent + "%"
                }, {
                  queue: false,
                  duration: o.animate
                });
              }
            } else {
              if (i === 0) {
                that.range.stop(1, 1)[animate ? "animate" : "css"]({
                  bottom: valPercent + "%"
                }, o.animate);
              }
  
              if (i === 1) {
                that.range[animate ? "animate" : "css"]({
                  height: valPercent - lastValPercent + "%"
                }, {
                  queue: false,
                  duration: o.animate
                });
              }
            }
          }
  
          lastValPercent = valPercent;
        });
      } else {
        value = this.value();
        valueMin = this._valueMin();
        valueMax = this._valueMax();
        valPercent = valueMax !== valueMin ? (value - valueMin) / (valueMax - valueMin) * 100 : 0;
        _set[this.orientation === "horizontal" ? "left" : "bottom"] = valPercent + "%";
        this.handle.stop(1, 1)[animate ? "animate" : "css"](_set, o.animate);
  
        if (oRange === "min" && this.orientation === "horizontal") {
          this.range.stop(1, 1)[animate ? "animate" : "css"]({
            width: valPercent + "%"
          }, o.animate);
        }
  
        if (oRange === "max" && this.orientation === "horizontal") {
          this.range.stop(1, 1)[animate ? "animate" : "css"]({
            width: 100 - valPercent + "%"
          }, o.animate);
        }
  
        if (oRange === "min" && this.orientation === "vertical") {
          this.range.stop(1, 1)[animate ? "animate" : "css"]({
            height: valPercent + "%"
          }, o.animate);
        }
  
        if (oRange === "max" && this.orientation === "vertical") {
          this.range.stop(1, 1)[animate ? "animate" : "css"]({
            height: 100 - valPercent + "%"
          }, o.animate);
        }
      }
    }
  });
  
  (function () {
    var $body = $('body');
    var $document = $(document);
    var facetDateChart = {
      $element: $('.facetDateChart'),
      rangeStartVal: null,
      rangeEndVal: null,
      yearWeights: null,
      queryID: null,
      height: 200,
      amplifierRatio: null,
      url: location.href,
      init: function init() {
        facetDateChart.rangeStartVal = parseInt(facetDateChart.$element.data('min'));
        facetDateChart.rangeEndVal = parseInt(facetDateChart.$element.data('max'));
        facetDateChart.yearWeights = facetDateChart.$element.data('yearweights');
        facetDateChart.queryID = facetDateChart.$element.data('queryid');
        facetDateChart.amplifierRatio = parseInt(facetDateChart.$element.data('amplifierratio'));
        facetDateChart.chart.init();
        facetDateChart.control();
      },
      control: function control() {
        $(document).on('slide:opened', function (event) {
          $('.ui-slider-handle__indicator, .ui-slider-handle__label').remove();
          facetDateChart.init();
          $(this).off(event);
        });
      },
      getSelectedRange: function getSelectedRange(sliderRange) {
        var baseUrl = facetDateChart.url.split('?')[0];
        var queryString = facetDateChart.url.indexOf('?') !== -1 ? facetDateChart.url.split('?')[1] : '';
        var queryStringObj = {};
  
        if (queryString) {
          queryString.split('&').map(function (value) {
            var keyVal = value.split('=');
            queryStringObj[keyVal[0]] = keyVal[1];
          });
  
          if (queryStringObj.AfterYear && queryStringObj.BeforeYear) {
            return [queryStringObj.AfterYear, queryStringObj.BeforeYear];
          }
        }
  
        return [parseInt(facetDateChart.rangeStartVal), parseInt(facetDateChart.rangeEndVal)];
      },
      updateUrl: function updateUrl(startYear, endYear) {
        facetDateChart.removeParam('AfterYear');
        facetDateChart.removeParam('BeforeYear');
        facetDateChart.removeParam('queryID');
        facetDateChart.url += (facetDateChart.url.indexOf('?') > -1 ? '&' : '?') + 'AfterYear=' + startYear + '&BeforeYear=' + endYear + '&queryID=' + facetDateChart.queryID;
        window.location = facetDateChart.url;
      },
      removeParam: function removeParam(key) {
        var baseUrl = facetDateChart.url.split('?')[0];
        var queryString = facetDateChart.url.indexOf('?') !== -1 ? facetDateChart.url.split('?')[1] : '';
        var queryStringObj = {};
  
        if (queryString) {
          queryString.split('&').map(function (value) {
            var keyVal = value.split('=');
            queryStringObj[keyVal[0]] = keyVal[1];
          });
  
          if (queryStringObj[key]) {
            delete queryStringObj[key];
          }
  
          queryString = Object.keys(queryStringObj).map(function (value) {
            return value + '=' + queryStringObj[value];
          }).join('&');
          facetDateChart.url = baseUrl + (queryString ? '?' + queryString : '');
        }
      },
      chart: {
        //more info https://www.jqueryscript.net/chart-graph/Histogram-Slider-Plugin-jQuery.html
        init: function init() {
          facetDateChart.chart.setOptions();
          var self = facetDateChart.$element,
              dataItems = self.options.data.items,
              bins = new Array(self.options.numberOfBins).fill(0),
              range = self.options.numberOfBins,
              rangePerBin = range / self.options.numberOfBins;
  
          for (i = 0; i < dataItems.length; i++) {
            var index = parseInt(dataItems[i].value / rangePerBin),
                increment = 1;
  
            if (dataItems[i].count) {
              // Handle grouped data structure
              increment = parseInt(dataItems[i].count);
            }
  
            bins[index] += increment;
          }
  
          var chartName = self.attr('name') + "__chart",
              sliderName = self.attr('name') + "__slider";
          var wrapHtml = "<div class='" + chartName + "' style='height:" + self.options.height + "px; overflow: hidden;'></div>" + "<div class='" + sliderName + "'></div>";
          self.html(wrapHtml);
          var heightRatio = facetDateChart.chart.calculateHeightRatio(bins, self.options.height),
              widthPerBin = 100 / self.options.numberOfBins;
  
          for (i = 0; i < bins.length; i++) {
            var binRange = facetDateChart.chart.getBinRange(rangePerBin, i, facetDateChart.$element.options.sliderRange[0]),
                inRangeClass = "bin-color-selected",
                outRangeClass = "bin-color";
  
            if (self.options.optimalRange[0] <= binRange[0] && binRange[0] <= self.options.optimalRange[1]) {
              inRangeClass = "bin-color-optimal-selected";
              outRangeClass = "bin-color-optimal";
            }
  
            var toolTipHtml = self.options.showTooltips ? "<span class='tooltiptext'>" + binRange[0] + "/" + bins[i] + "</span>" : "";
            var scaledValue = parseInt(bins[i] * heightRatio),
                height = facetDateChart.chart.convertToHeight(scaledValue),
                inRangeOffset = parseInt(self.options.height - height),
                outRangeOffset = -parseInt(self.options.height - height * 2);
            var binHtml = "<div class='tooltip' style='float:left!important;width:" + widthPerBin + "%;'>" + toolTipHtml + "<div class='bin in-range " + inRangeClass + "' style='height:" + height + "px;bottom:-" + inRangeOffset + "px;position: relative;'></div>" + "<div class='bin out-of-range " + outRangeClass + "' style='height:" + height + "px;bottom:" + outRangeOffset + "px;position: relative;'></div>" + "</div>";
            $("." + chartName).append(binHtml);
          }
  
          $("." + sliderName).slider({
            range: true,
            min: self.options.sliderRange[0],
            max: self.options.sliderRange[1],
            values: self.options.selectedRange,
            chart: true,
            slide: function slide(event, ui) {
              facetDateChart.chart.update(ui.values, self.options.sliderRange[0], rangePerBin, chartName, sliderName);
            },
            create: function create(event, ui) {
              $(event.target).find('.ui-slider-handle').append('<span class="ui-slider-handle__indicator"></span>').first().addClass('first');
              $(event.target).find('.ui-slider-handle').append('<span class="ui-slider-handle__label"></span>');
              $(event.target).find('.ui-slider-handle__indicator').height(facetDateChart.height + 10);
            },
            stop: function stop(event, ui) {
              facetDateChart.updateUrl(ui.values[0], ui.values[1]);
            }
          });
          facetDateChart.chart.update(self.options.selectedRange, self.options.sliderRange[0], rangePerBin, chartName, sliderName);
        },
        setOptions: function setOptions() {
          var data = {
            "items": []
          };
          $.each(facetDateChart.yearWeights, function (index, value) {
            data.items.push({
              "value": index,
              "count": value * facetDateChart.amplifierRatio
            });
          });
          facetDateChart.chart.setHeight(data);
          var options = {
            data: data,
            sliderRange: [facetDateChart.rangeStartVal, facetDateChart.rangeEndVal],
            optimalRange: [facetDateChart.rangeStartVal, facetDateChart.rangeEndVal],
            selectedRange: facetDateChart.getSelectedRange(),
            numberOfBins: data.items.length,
            height: facetDateChart.height,
            showTooltips: false
          };
          facetDateChart.$element.options = options;
        },
        setHeight: function setHeight(data) {
          facetDateChart.height = Math.max.apply(Math, data.items.map(function (o) {
            return o.count;
          })) * 5 + 20;
  
          if (facetDateChart.height < 150) {
            facetDateChart.height = 150;
          }
        },
        update: function update(selectedRange, sliderMin, rangePerBin, chartName, sliderName) {
          var leftValue = selectedRange[0],
              rightValue = selectedRange[1],
              $minLabelHandler = $("." + sliderName).find('.ui-slider-handle.first .ui-slider-handle__label').html(leftValue),
              $maxLabelHandler = $("." + sliderName).find('.ui-slider-handle:not(.first) .ui-slider-handle__label').html(rightValue); // set opacity per bin based on the slider values
  
          $("." + chartName + " .in-range").each(function (index, bin) {
            var binRange = facetDateChart.chart.getBinRange(rangePerBin, index, sliderMin);
  
            if (binRange[1] < rightValue) {
              // Set opacity based on left (min) slider
              if (leftValue > binRange[1]) {
                facetDateChart.chart.setOpacity(bin, 0);
              } else if (leftValue < binRange[0]) {
                facetDateChart.chart.setOpacity(bin, 1);
              } else {
                //setOpacity(bin, 1);
                facetDateChart.chart.setOpacity(bin, 1 - (leftValue - binRange[0]) / rangePerBin);
              }
            } else if (binRange[0] > leftValue) {
              // Set opacity based on right (max) slider value
              if (rightValue > binRange[1]) {
                facetDateChart.chart.setOpacity(bin, 1);
              } else if (rightValue < binRange[0]) {
                facetDateChart.chart.setOpacity(bin, 0);
              } else {
                facetDateChart.chart.setOpacity(bin, 1 - (rightValue - binRange[0]) / rangePerBin);
              }
            }
          });
          facetDateChart.chart.setLabelHandlersPosition($minLabelHandler, $maxLabelHandler);
          setTimeout(function () {
            facetDateChart.chart.setLabelHandlersPosition($minLabelHandler, $maxLabelHandler);
          }, 500);
        },
        setLabelHandlersPosition: function setLabelHandlersPosition($minLabelHandler, $maxLabelHandler) {
          var minOuterLeft = $minLabelHandler.offset().left,
              minWidth = $minLabelHandler.outerWidth(),
              minOuterRight = minOuterLeft + minWidth,
              maxOuterLeft = $maxLabelHandler.offset().left,
              rangeLabelsPosition = maxOuterLeft - minOuterRight - 2,
              marginValue = (2 - rangeLabelsPosition) / 2;
          $minLabelHandler.css('left', '-=' + marginValue);
          $maxLabelHandler.css('left', '+=' + marginValue);
  
          if (Math.floor(rangeLabelsPosition) > 2) {
            $minLabelHandler.css('left', '0');
            $maxLabelHandler.css('left', '0');
          }
        },
        getBinRange: function getBinRange(rangePerBin, index, sliderMin) {
          var min = rangePerBin * index + sliderMin,
              max = rangePerBin * (index + 1) - 1;
          if (rangePerBin == 1) max = min;
          return [min, max];
        },
        setOpacity: function setOpacity(bin, val) {
          $(bin).css("opacity", val);
        },
        convertToHeight: function convertToHeight(v) {
          return parseInt(5 * v + 1);
        },
        calculateHeightRatio: function calculateHeightRatio(bins, chartHeight) {
          var maxValue = Math.max.apply(null, bins);
          var height = facetDateChart.chart.convertToHeight(maxValue);
  
          if (height > chartHeight) {
            return chartHeight / height;
          }
  
          return 1;
        }
      }
    };
    UX.facetDateChart = facetDateChart; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/facet-date/js/facet-date.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/components/facet-date/js/facet-date.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var $document = $(document);
    var facetDate = {
      sliderRanges: [],
      sliderValues: [],
      $rangeStart: $('.range-slider__start'),
      $rangeEnd: $('.range-slider__end'),
      url: location.href,
      init: function init() {
        facetDate.$rangeStart = $('.range-slider__start');
        facetDate.$rangeEnd = $('.range-slider__end');
        facetDate.initRange();
        facetDate.control();
      },
      initRange: function initRange() {
        $('.range-slider').each(function () {
          var $sliderRange = $(this).find('.range-slider__range');
  
          if (!$sliderRange.hasClass("jcf-hidden")) {
            var frequencies = $sliderRange.data('frequencies');
            var nonLinearSliderSteps = [1, 2, 5, 10];
            var allowedTotalYears = nonLinearSliderSteps.reduce(function (prev, cur) {
              return prev + cur;
            }) * 2;
            var maxVal = parseInt($sliderRange.attr('max'), 10);
            var minVal = parseInt($sliderRange.attr('min'), 10);
            var totalYears = maxVal - minVal;
            var linearSlider = $sliderRange.attr('data-slider-type') === 'linear';
  
            if (totalYears > allowedTotalYears && !linearSlider) {
              // non-linear slider
              var displaySteps = nonLinearSliderSteps.slice().reverse();
              var remaining = totalYears;
              var startYear = minVal;
              var startSlice = 0;
              displaySteps.forEach(function (step, i, all) {
                var oneThird = Math.floor(remaining / 3);
                var twoThirds = Math.floor(2 * oneThird);
                var remainder = twoThirds % step;
  
                if (remainder > 0) {
                  twoThirds = twoThirds - remainder;
                }
  
                remaining = remaining - twoThirds;
  
                if (i == displaySteps.length - 1) {
                  facetDate.sliderRanges.push({
                    'start': startYear,
                    'stop': maxVal,
                    'displayStep': nonLinearSliderSteps[i],
                    'slideStep': step,
                    'freq': frequencies.slice(startSlice, frequencies.length)
                  });
                } else {
                  facetDate.sliderRanges.push({
                    'start': startYear,
                    'stop': startYear + twoThirds,
                    'displayStep': nonLinearSliderSteps[i],
                    'slideStep': step,
                    'freq': frequencies.slice(startSlice, startSlice + twoThirds)
                  });
                }
  
                startSlice = startSlice + twoThirds;
                startYear = startYear + twoThirds;
              });
              facetDate.sliderRanges.forEach(function (range) {
                var sliderVal = range.start;
  
                while (sliderVal <= range.stop) {
                  if (facetDate.sliderValues.indexOf(sliderVal) < 0) {
                    facetDate.sliderValues.push(sliderVal);
                  }
  
                  sliderVal += range.slideStep;
                }
              });
            } else {
              // linear slider
              if (!facetDate.sliderValues.length > 0) {
                for (var i = minVal; i <= maxVal; i++) {
                  facetDate.sliderValues.push(i);
                }
              }
            }
  
            $sliderRange.attr('min', 0);
            $sliderRange.attr('max', facetDate.sliderValues.length - 1);
            var initialValue = facetDate.getSelectedRange($sliderRange);
            facetDate.$rangeStart.val(initialValue[0]);
            facetDate.$rangeEnd.val(initialValue[1]);
            var initialPosition = facetDate.getSelectedRangePosition(initialValue[0], initialValue[1]);
            $sliderRange.attr('value', initialPosition.join(','));
            jcf.replace($sliderRange); // render frequencies
  
            if (frequencies) {
              var $rangeWrapper = $(this).find('.jcf-range-wrapper');
              var $rangeFrequencies = $('<span class="jcf-range-frequencies"></span>');
  
              if (totalYears > allowedTotalYears && !linearSlider) {
                // non-linear slider
                facetDate.sliderRanges.forEach(function (range) {
                  for (var i = 0; i < range.freq.length; i++) {
                    var $rangeSlice = $('<span class="jcf-range-frequencies__slice" style="width: ' + 100 / range.freq.length / facetDate.sliderRanges.length + '%; opacity: ' + range.freq[i] + '"></span>');
                    $rangeFrequencies.append($rangeSlice);
                  }
                });
                $rangeWrapper.prepend($rangeFrequencies);
              } else {
                // linear slider
                var rangeSliceWidth = 100 / frequencies.length;
  
                for (var i = 0; i < frequencies.length; i++) {
                  var $rangeSlice = $('<span class="jcf-range-frequencies__slice" style="width: ' + rangeSliceWidth + '%; opacity: ' + frequencies[i] + '"></span>');
                  $rangeFrequencies.append($rangeSlice);
                }
  
                $rangeWrapper.prepend($rangeFrequencies);
              }
            }
          }
        });
      },
      control: function control() {
        $body.on('click', '.custom-date', function (e) {
          e.preventDefault();
          facetDate.on.toggle($(this));
        });
        $(document).on("UX-attach", function () {
          facetDate.init();
        });
        $(document).on("UX-detach", function () {
          jcf.destroy($(".range-slider__range"));
        });
        $('.range-slider__range').change(function () {
          facetDate.on.setRange($(this));
        });
        facetDate.$rangeStart.on('change', function () {
          facetDate.on.setStart($(this));
        });
        facetDate.$rangeEnd.on('change', function () {
          facetDate.on.setEnd($(this));
        });
        $('.range-slider__range').on('change change:startend', function () {
          facetDate.updateUrl($(this));
        });
      },
      on: {
        toggle: function toggle(elem) {
          var $toggle = elem.closest('.facet');
          var $target = $toggle.find('.custom-date-form').slideToggle();
          elem.toggleClass('js--open');
        },
        setRange: function setRange(elem) {
          var $toggle = elem.closest('.range-slider');
          var $target = $toggle.find('.jcf-active-handle');
          var tmp = $target.attr("class").match(/jcf-index[\w-]*\b/);
          var tmp2 = tmp.toString().split('-')[2];
          $('input.index-' + tmp2).val(facetDate.getValue(elem));
        },
        setStart: function setStart(elem) {
          var $sliderRange = elem.closest('.range-slider').find('.range-slider__range');
          var minVal = parseInt($sliderRange.attr('min'), 10);
          var thisVal = facetDate.getValueFromInput(elem);
          var sliderInstance = jcf.getInstance($sliderRange);
  
          if (thisVal >= minVal && thisVal <= sliderInstance.values[1]) {
            sliderInstance.values[0] = thisVal.toString();
            sliderInstance.refresh();
            $sliderRange.trigger('change:startend');
          }
        },
        setEnd: function setEnd(elem) {
          var $sliderRange = elem.closest('.range-slider').find('.range-slider__range');
          var maxVal = parseInt($sliderRange.attr('max'), 10);
          var thisVal = facetDate.getValueFromInput(elem);
          var sliderInstance = jcf.getInstance($sliderRange);
  
          if (thisVal <= maxVal && thisVal >= sliderInstance.values[0]) {
            sliderInstance.values[1] = thisVal.toString();
            sliderInstance.refresh();
            $sliderRange.trigger('change:startend');
          }
        },
        rangeUpdate: function rangeUpdate(elem, callbackFn) {
          var $sliderRange = $(elem);
          $sliderRange.on('change change:startend', function () {
            callbackFn(facetDate.$rangeStart.val(), facetDate.$rangeEnd.val());
          });
        }
      },
      getValue: function getValue(elem) {
        var $sliderRange = elem.closest('.range-slider').find('.range-slider__range');
        var thisValIndex = parseInt(elem.val(), 10);
        var thisVal = facetDate.sliderValues[thisValIndex];
        return thisVal;
      },
      getValueFromInput: function getValueFromInput(elem) {
        var $sliderRange = elem.closest('.range-slider').find('.range-slider__range');
        var customVal = parseInt(elem.val(), 10);
        var minVal = parseInt($sliderRange.attr('data-min'), 10);
        var maxVal = parseInt($sliderRange.attr('data-max'), 10);
        var thisVal;
  
        if (customVal <= maxVal && customVal >= minVal) {
          if (facetDate.sliderValues.indexOf(customVal) >= 0) {
            thisVal = facetDate.sliderValues.indexOf(customVal);
          } else {
            var closest = facetDate.sliderValues.reduce(function (prev, curr) {
              return Math.abs(curr - customVal) < Math.abs(prev - customVal) ? curr : prev;
            });
            thisVal = facetDate.sliderValues.indexOf(closest);
          }
        }
  
        return thisVal;
      },
      removeParam: function removeParam(key) {
        var baseUrl = facetDate.url.split('?')[0];
        var queryString = facetDate.url.indexOf('?') !== -1 ? facetDate.url.split('?')[1] : '';
        var queryStringObj = {};
  
        if (queryString) {
          queryString.split('&').map(function (value) {
            var keyVal = value.split('=');
            queryStringObj[keyVal[0]] = keyVal[1];
          });
  
          if (queryStringObj[key]) {
            delete queryStringObj[key];
          }
  
          queryString = Object.keys(queryStringObj).map(function (value) {
            return value + '=' + queryStringObj[value];
          }).join('&');
          facetDate.url = baseUrl + (queryString ? '?' + queryString : '');
        }
      },
      getSelectedRange: function getSelectedRange(sliderRange) {
        var baseUrl = facetDate.url.split('?')[0];
        var queryString = facetDate.url.indexOf('?') !== -1 ? facetDate.url.split('?')[1] : '';
        var queryStringObj = {};
  
        if (queryString) {
          queryString.split('&').map(function (value) {
            var keyVal = value.split('=');
            queryStringObj[keyVal[0]] = keyVal[1];
          });
  
          if (queryStringObj.AfterYear && queryStringObj.BeforeYear) {
            return [queryStringObj.AfterYear, queryStringObj.BeforeYear];
          }
        }
  
        return [parseInt(sliderRange.attr('data-min'), 10), parseInt(sliderRange.attr('data-max'), 10)];
      },
      getSelectedRangePosition: function getSelectedRangePosition(start, end) {
        var closestStart;
        var closestEnd;
  
        if (facetDate.sliderValues.indexOf(start) < 0) {
          closestStart = facetDate.sliderValues.reduce(function (prev, curr) {
            return Math.abs(curr - start) < Math.abs(prev - start) ? curr : prev;
          });
        }
  
        if (facetDate.sliderValues.indexOf(end) < 0) {
          closestEnd = facetDate.sliderValues.reduce(function (prev, curr) {
            return Math.abs(curr - end) < Math.abs(prev - end) ? curr : prev;
          });
        }
  
        return [facetDate.sliderValues.indexOf(closestStart || start), facetDate.sliderValues.indexOf(closestEnd || end)];
      },
      updateUrl: function updateUrl(elem) {
        facetDate.removeParam('AfterYear');
        facetDate.removeParam('BeforeYear');
        facetDate.removeParam('queryID');
        facetDate.url += (facetDate.url.indexOf('?') > -1 ? '&' : '?') + 'AfterYear=' + facetDate.$rangeStart.val() + '&BeforeYear=' + facetDate.$rangeEnd.val() + '&queryID=' + $(elem).attr('data-queryID');
        window.location = facetDate.url;
      }
    };
    UX.facetDate = facetDate; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/figure-viewer/js/figure-viewer-script.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/components/figure-viewer/js/figure-viewer-script.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  __webpack_require__.p = '/libraries/ui-core/releasedAssets/';
  
  if (location.href.indexOf('specs') > -1) {
    __webpack_require__.p = "/specs".concat(__webpack_require__.p);
  }
  
  (function () {
    var $section = $('.figure-viewer');
    var $window = $(window);
    var $html = $('html');
    var $document = $(document);
    var $body = $('body');
    var $isHighRes = false;
    var figureViewer = {
      options: {
        /*
        * false|classCombination|className|dataRel
        * */
        filter: false,
        filterClass: 'article__tabFigure'
      },
      $topRegHeight: $('.figure-viewer__reg__top').innerHeight(),
      vPort: "screen-md",
      $figures: null,
      $figuresToShow: null,
      $figureWidth: null,
      $currentIndex: null,
      $focusedElementBeforeOpened: null,
      $section: $section,
      $holder: $section.find('.figure-viewer__hold__fig'),
      $holderElement: $section.find('.figure-viewer__hold__fig').find('figure'),
      $captionHolder: $section.find('.figure-viewer__hold__figcap'),
      $lister: $section.find('.figure-viewer__hold__list'),
      $figureRegionContainer: $section.find('.figure-viewer__reg__center'),
      $captionRegion: $section.find('.figure-viewer__cent__right'),
      $contentRegion: $section.find('.figure-viewer__cent__left'),
      $figureNav: $section.find('.figure-viewer__ctrl__next, .figure-viewer__ctrl__prev'),
      $zoominbtn: $section.find('.zoom-in'),
      $zoomoutbtn: $section.find('.zoom-out'),
      $zoomrange: $section.find('.zoom-range'),
      $zoomreset: $section.find('.reset'),
      $image: $section.find('figure'),
      $browsebtn: $('.figure-viewer__ctrl__browse'),
      $returnbtn: $('.figure-viewer__ctrl__return'),
      isMobile: false,
      islocked: false,
      offsetY: window.pageYOffset,
      $hideList: $('.zoomSlider, .figure-viewer__label__zoom'),
      $browseContainer: $('.figure-viewer__hold__list'),
      onHighRes: function onHighRes() {
        __webpack_require__.e(/*! import() */ 0).then(__webpack_require__.t.bind(null, /*! ./high-res-images */ "../../ui-core/components/figure-viewer/js/high-res-images.js", 7)).then(function () {
          figureViewer.onHighResCallback();
        });
      },
      expand: function expand() {
        // preserve backward compatibility with previous buggy version - it can be removed if filterContexts would become default behavior
        if (figureViewer.options.filter) {
          figureViewer.$figures = $document.find(':not(.figure-viewer__hold__list) > figure:not(.holder), :not(.figure-viewer__hold__list) > .figure:not(.holder)');
        } else {
          figureViewer.$figures = $document.find('figure:not(.holder), .figure:not(.holder)');
        }
  
        figureViewer.$figures.each(function (index) {
          var $this = $(this);
          $this.data('index', index);
  
          if (figureViewer.options.filter) {
            $this.addClass('figure'); // add class to be sure, that correct grid styling will be there
  
            if (figureViewer.options.filter === 'dataRel') {
              // move data-rel to container from child
              var dataRelElement = $this.find('[data-rel]');
  
              if (dataRelElement.length > 0 && dataRelElement.data().rel) {
                $this.attr('data-rel', dataRelElement.data().rel);
              }
            }
          }
        });
        figureViewer.$figuresToShow = figureViewer.$figures;
      },
  
      /*
      * Filter grid view and navigation based on item opened and option provided by figureViewer.options.filter
      * */
      filter: function filter($this) {
        if (figureViewer.options.filter === 'classCombination') {
          var className = $this.attr('class');
          figureViewer.$figuresToShow = figureViewer.$figures.filter('[class="' + className + '"]');
        } else if (figureViewer.options.filter === 'className') {
          figureViewer.$figuresToShow = figureViewer.$figures.filter('.' + figureViewer.options.filterClass);
        } else if (figureViewer.options.filter === 'dataRel') {
          var dataRel = $this.data('rel');
  
          if (dataRel) {
            figureViewer.$figuresToShow = figureViewer.$figures.filter('[data-rel="' + dataRel + '"]');
          } else {
            figureViewer.$figuresToShow = figureViewer.$figures;
          }
        } else {
          figureViewer.$figuresToShow = figureViewer.$figures;
        }
  
        figureViewer.$currentIndex = figureViewer.$figuresToShow.index($this);
      },
      control: function control() {
        $(document).on(figureViewer.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          figureViewer.isMobile = true;
        });
        $(document).on(figureViewer.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          figureViewer.isMobile = false;
        });
        figureViewer.clickHandler();
        var $figureViewer = $body.find('.figure-viewer'),
            $controllerElement = $figureViewer.find('a, button');
        $controllerElement.each(function () {
          var $this = $(this);
          $this.on({
            click: function click(event) {
              event.preventDefault();
              event.stopPropagation();
  
              if ($this.hasClass('figure-viewer__ctrl__close')) {
                // close button
                figureViewer.on.hide();
              } else if ($this.hasClass('figure-viewer__ctrl__next')) {
                // Next button
                figureViewer.next();
              } else if ($this.hasClass('figure-viewer__ctrl__prev')) {
                // Prev Button
                figureViewer.prev();
              } else if ($this.hasClass('figure-viewer__ctrl__caption')) {
                // open / close caption Button
                figureViewer.captionToggle($this);
              } else if ($this.hasClass('figure-viewer__ctrl__browse')) {
                // browse all figures
                figureViewer.browse($(this));
              } else if ($this.hasClass('figure-viewer__ctrl__return')) {
                // browse all figures
                figureViewer["return"]($(this));
              }
            }
          });
        }); // preserve backward compatibility with previous buggy version - it can be removed if filterContexts would become default behavior
  
        if (figureViewer.options.filter) {
          $(".figure a:not(.open-figure-link)").click(function (e) {
            var $img = $(this).find("img"),
                shouldDefault = $(this).hasClass('linkBehavior');
  
            if (!shouldDefault || $img.length !== 0) {
              e.preventDefault();
              $img.trigger("click");
            }
          });
          $(".figure a:not(.open-figure-link) img").click(function (e) {
            e.stopPropagation();
          });
        } else {
          $(".figure a:not('.ppt-figure-link')").click(function (e) {
            var $img = $(this).find("img"),
                shouldDefault = $(this).hasClass('linkBehavior');
  
            if (!shouldDefault || $img.length !== 0) {
              //e.preventDefault();
              $img.trigger("click");
            }
          });
        }
  
        $('body').keydown(function (event) {
          // is figureviewer open? no? than we don't do anything
          if ($body.attr('data-active') !== 'figureViewer') {
            return;
          }
  
          if (event.keyCode === 37) {
            // left
            figureViewer.prev();
          } else if (event.keyCode === 39) {
            // right
            figureViewer.next();
          }
        });
        figureViewer.supplementary.control();
        figureViewer.hideOnClickOutside();
        figureViewer.resize();
        $(window).on('resized', function () {
          figureViewer.resize();
        });
  
        if (figureViewer.$figures.length == 1) {
          figureViewer.$figureNav.hide();
        } // @FIXME this is not working focus trap... - cannot work in most cases and for shift tab
  
  
        $(".figure-viewer__ctrl__caption").focusout(function () {
          $('.figure-viewer__ctrl__close').focus();
        });
      },
      hideOnClickOutside: function hideOnClickOutside() {
        figureViewer.$image.on('click', function (e) {
          var isOutsideClick = !$(e.target).closest('.figure__image').length && !$('.figure__image').is(e.target) && !$('.shortcutsViewHelpTxt').is(e.target) && !$(e.target).closest('.shortcutsViewHelpTxt').length;
  
          if (isOutsideClick) {
            figureViewer.on.hide();
          }
        });
      },
      clickHandler: function clickHandler() {
        $(document).on('click', '.figure__image, .open-figure-link', function (event) {
          event.preventDefault();
          var $self = $(this);
  
          if ($self.parent().hasClass('figure-viewer__thumbnail-item') || $self.is('.figure__audio') || $self.is('.figure__video')) {
            return;
          }
  
          var $this = $self.closest('figure, .figure, .imageTable');
  
          if (!$this.hasClass('ui-disabled') && !$this.closest('.figure-viewer__hold__fig').length) {
            // check if explicitly disabled or the figure is already in the viewer so the event is useless at this state. It also gets in the way of drag and drop functionality in the figure viewer.
            figureViewer.on.show($this, $this.data('index'));
          }
  
          if (!figureViewer.isMobile) {
            $('.shortcutsViewHelpTxt').length ? $(document).find('.figure-viewer__cent__left .shortcutsViewHelpTxt').remove() : UX.highResImg.shortcutsView($this);
          }
        });
      },
      captionToggle: function captionToggle($elem) {
        figureViewer.toggle($elem.closest('.figure-viewer__cent__right'));
        figureViewer.toggle($('.figure-viewer__cent__left'));
        $elem.toggleClass('js-open');
  
        if (figureViewer.$holder.find('.figure__highResImgReplacer').length === 1 && $elem.hasClass('js-open')) {
          figureViewer.$holder.find('.figure__highResImgReplacer').css({
            'width': '97%'
          });
        } else {
          figureViewer.$holder.find('.figure__highResImgReplacer').css({
            'width': '100%'
          });
        }
      },
      next: function next() {
        if (figureViewer.$currentIndex < figureViewer.$figuresToShow.length - 1) {
          if (!figureViewer.$figuresToShow.eq(figureViewer.$currentIndex + 1).closest('.figure-viewer').length) {
            figureViewer.$currentIndex++;
            var $next = figureViewer.$figuresToShow.eq(figureViewer.$currentIndex);
            figureViewer.replace($next);
            $isHighRes && UX.highResImg.shortcutsView($next);
            figureViewer.zoom.reset();
          }
        } else {
          figureViewer.$currentIndex = 0;
  
          var _$next = figureViewer.$figuresToShow.eq(figureViewer.$currentIndex);
  
          figureViewer.replace(_$next);
          $isHighRes && UX.highResImg.shortcutsView(_$next);
          figureViewer.zoom.reset();
        }
      },
      prev: function prev() {
        if (figureViewer.$currentIndex >= 1) {
          if (!figureViewer.$figuresToShow.eq(figureViewer.$currentIndex - 1).closest('.figure-viewer').length) {
            figureViewer.$currentIndex--;
            var $prev = figureViewer.$figuresToShow.eq(figureViewer.$currentIndex);
            figureViewer.replace($prev);
            figureViewer.zoom.reset();
          }
        } else {
          figureViewer.$currentIndex = figureViewer.$figuresToShow.length - 1;
  
          var _$prev = figureViewer.$figuresToShow.eq(figureViewer.$currentIndex);
  
          figureViewer.replace(_$prev);
          figureViewer.zoom.reset();
        }
      },
      replace: function replace(element) {
        var $figure;
        figureViewer.pauseOriginalStream(element);
        $isHighRes = element.find('.figure__image').length && element.find('.figure__highResImgReplacer').length;
        $isHighRes ? $figure = element.find('.figure__highResImgReplacer').clone() : $figure = element.find('.figure__image').clone();
        $figure.each(function () {
          var $this = $(this);
          $this.attr('src', $this.attr('data-lg-src'));
        }); // handle multiple images in one figure
  
        if ($figure.length > 1) {
          // return one to image viewer and create navigation
          $figure = figureViewer.supplementary.show(element, $figure);
        } else {
          figureViewer.supplementary.hide();
        }
  
        figureViewer.streamReset(figureViewer.$holder, element);
  
        if ($isHighRes) {
          UX.highResImg.show(figureViewer.$holder, element);
          figureViewer.$holder.find('.figure__highResImgReplacer').remove();
          figureViewer.$figureWidth = figureViewer.$holder.find('.figure__highResImgReplacer').width();
        }
  
        figureViewer.$holder.find('.figure__image').remove();
        figureViewer.$holder.find('figure').append($figure.get(0).outerHTML);
        figureViewer.$captionHolder.empty();
        figureViewer.showCaptionTitle(element);
        var $caption = figureViewer.additionalBehaviorOnShow(element);
        figureViewer.showCaption($caption);
        figureViewer.removeFigureTitle();
        figureViewer.$figureWidth = figureViewer.$holder.find('.figure__image').width();
        figureViewer.zoom.check();
        figureViewer.headerOptions(element);
      },
      supplementary: {
        nav: null,
  
        /**
         *
         * @param element
         * @param $figure
         * @public
         * @returns {jQuery} current image
         */
        show: function show(element, $figure) {
          // get current index
          var index = this.check(element),
              $thumbnails = $figure.clone(),
              self = this; // create supplementary navigation
  
          if (!this.nav) {
            this.nav = $('<ul class="figure-viewer__hold__supplementary-nav"></ul>');
            this.nav.appendTo(figureViewer.$section);
          } // create navigation items
  
  
          this.nav.empty();
          $thumbnails.each(function (index) {
            var $thumb = $('<li><a href="#" title="Go to figure image ' + (index + 1) + '. of current figure." class="figure-viewer__thumbnail-item"></a></li>');
            $thumb.find('a').append(this);
            $thumb.find('a').on('click', function (event) {
              event.preventDefault();
              self.toIndex(element, index);
            }); // add to nav
  
            self.nav.append($thumb);
          }); // set initial active class
  
          this.nav.find('li').eq(index).addClass('active'); // return current into view
  
          return $figure.eq(index);
        },
  
        /**
         *
         * @public
         */
        hide: function hide() {
          if (this.nav) {
            this.nav.empty();
          }
        },
        save: function save(element, index) {
          element.data('figure-viewer-display', index);
        },
        check: function check(element) {
          return element.data('figure-viewer-display') || 0;
        },
        toIndex: function toIndex(element, index) {
          var $images = element.find('.figure__image');
  
          if ($images.length === 1) {
            // don't do anything for one image
            return;
          } // loop on edges
  
  
          if (index >= $images.length) {
            index = 0;
          }
  
          if (index < 0) {
            index = $images.length - 1;
          } // append index image
  
  
          figureViewer.$holder.find('.figure__image').remove();
          var $image = $images.eq(index).clone(); // get the correct size of the image if it's available
  
          if ($image.data('lg-src')) {
            $image.attr('src', $image.data('lg-src'));
          }
  
          figureViewer.$holderElement.append($image); // toggle active class
  
          this.nav.find('li').removeClass('active');
          this.nav.find('li').eq(index).addClass('active'); // save state
  
          this.save(element, index);
        },
        next: function next(element) {
          var index = this.check(element) + 1;
          this.toIndex(element, index);
        },
        prev: function prev(element) {
          var index = this.check(element) - 1;
          this.toIndex(element, index);
        },
  
        /**
         *
         * @public
         */
        control: function control() {
          $('body').on('keydown keyup', function (event) {
            // is figureviewer open? no? than we don't do anything
            if ($body.attr('data-active') !== 'figureViewer') {
              return;
            } // is there any figure to show?
  
  
            if (figureViewer.$figuresToShow && figureViewer.$figuresToShow.length < 1) {
              return;
            }
  
            var element = figureViewer.$figuresToShow.eq(figureViewer.$currentIndex);
  
            if (event.keyCode === 38) {
              // up
              figureViewer.supplementary.prev(element);
            } else if (event.keyCode === 40) {
              // down
              figureViewer.supplementary.next(element);
            }
          });
        }
      },
      browse: function browse(element) {
        figureViewer.$holder.addClass('is-hidden');
        figureViewer.$figureNav.addClass('is-hidden');
        figureViewer.$browsebtn.addClass('is-hidden');
        figureViewer.$returnbtn.removeClass('is-hidden');
        figureViewer.$captionRegion.removeClass('js-open');
        figureViewer.$contentRegion.removeClass('js-open');
        figureViewer.$figureRegionContainer.addClass('scrollable');
        figureViewer.$captionRegion.addClass('is-hidden');
        figureViewer.$hideList.each(function () {
          $(this).addClass('is-hidden');
        });
        figureViewer.$lister.removeClass('is-hidden');
        figureViewer.supplementary.hide();
        figureViewer.$browseContainer.empty(); // preserve backward compatibility with previous buggy version - it can be removed if filter would become default behavior
  
        if (figureViewer.options.filter) {
          figureViewer.$figuresToShow.each(function () {
            var $fig = $(this).clone(true),
                $figureExtra = $fig.find(".figure-extra");
  
            if ($figureExtra.length) {
              $figureExtra.remove();
            }
  
            figureViewer.$browseContainer.append($fig);
          });
        } else {
          figureViewer.$figures.each(function () {
            if ($(this).hasClass('article__inlineFigure')) {
              var $fig = $(this).clone(true);
              var $figImage = $fig.children('img');
              $figImage.attr('src', $figImage.data('src'));
              var $figureLinks = $fig.find(".figure-links");
  
              if ($figureLinks.length) {
                $figureLinks.remove();
              }
  
              figureViewer.$browseContainer.append($fig);
            }
          });
        }
  
        figureViewer.additionalBrowse();
      },
      additionalBrowse: function additionalBrowse() {},
      "return": function _return() {
        figureViewer.$holder.removeClass('is-hidden');
        figureViewer.$figureNav.removeClass('is-hidden');
        figureViewer.$browsebtn.removeClass('is-hidden');
        figureViewer.$returnbtn.addClass('is-hidden'); //figureViewer.$contentRegion.addClass('js-open');
  
        figureViewer.$captionRegion.removeClass('is-hidden');
        figureViewer.$hideList.each(function () {
          $(this).removeClass('is-hidden');
        });
        figureViewer.$lister.addClass('is-hidden');
        var $figureViewText = $('.figure-viewer__title__text');
        $figureViewText.removeClass('figure-viewer__title__text__allfigures');
        $figureViewText.parent('.figure-viewer__ctrl').removeClass('allfigures__is__displayed');
        $('.figure-viewer__ctrl__caption').parent(".figure-viewer__ctrl").show();
        figureViewer.$browseContainer.empty();
        figureViewer.additionalReturn();
      },
      additionalReturn: function additionalReturn() {},
      height: function height(element) {
        var $windowsHeight = $(window).innerHeight();
        figureViewer.$topRegHeight = $('.figure-viewer__reg__top').innerHeight();
        var $height = $windowsHeight - figureViewer.$topRegHeight - $('.figure-viewer__caption__label').innerHeight();
        $('.figure-viewer__cent__left').find('figure').height($height);
      },
      toggle: function toggle(element) {
        element.toggleClass('js-open');
        figureViewer.figcaptionSize(); //LIT-161818
      },
      displayViewer: function displayViewer() {
        $('.figure-viewer').show();
      },
      additionalShow: function additionalShow() {},
      on: {
        show: function show($this, index) {
          figureViewer.isMobile && $html.addClass('lock-screen');
          figureViewer.headerOptions($this);
          figureViewer.offsetY = $body.data('yoffset') || window.pageYOffset;
          $body.data('yoffset', figureViewer.offsetY);
  
          if (typeof UX.controller !== 'undefined') {
            if ($body.attr('data-active') !== 'slide') {
              // keep drop block open in publication content widget
              UX.controller.check();
            }
          }
  
          $body.attr('data-active', 'figureViewer');
          figureViewer.islocked = true;
          figureViewer.$currentIndex = index;
          figureViewer.replace($this);
          figureViewer.$focusedElementBeforeOpened = document.activeElement;
          figureViewer.displayViewer();
          $body.css('overflow', 'hidden'); // LIT-152707
  
          figureViewer.height();
          figureViewer.zoom.check();
          figureViewer.resize();
          figureViewer.$holder.removeClass('is-hidden');
          figureViewer.$browsebtn.removeClass('is-hidden');
          figureViewer.$returnbtn.addClass('is-hidden');
          figureViewer.$figureNav.removeClass('is-hidden');
          figureViewer.$hideList.each(function () {
            $(this).removeClass('is-hidden');
          });
          figureViewer.$lister.addClass('is-hidden');
          figureViewer.$figureRegionContainer.removeClass('scrollable');
          $('.figure-viewer__ctrl__close').focus();
  
          if (figureViewer.options.filter) {
            figureViewer.filter($this);
          } else {
            figureViewer.setFiguersToShow($this);
          }
  
          figureViewer.additionalShow();
          figureViewer.streamReset(figureViewer.$holder, $this.closest('figure'));
          $isHighRes && UX.highResImg.show(figureViewer.$holder, $this.closest('figure'));
        },
        hide: function hide() {
          figureViewer.isMobile && $html.hasClass('lock-screen') && $html.removeClass('lock-screen');
  
          if (figureViewer.islocked) {
            $body.removeAttr('data-active');
          } else {
            $body.removeClass('lock-screen').removeAttr('data-active');
          }
  
          figureViewer.zoom.reset();
          $('.figure-viewer').hide();
          figureViewer.pauseClonedStream(figureViewer.$holder);
          figureViewer.$focusedElementBeforeOpened.focus();
          $body.css('overflow', ''); // LIT-152707
  
          $(window).scrollTop(figureViewer.offsetY);
          $body.removeData('yoffset');
        }
      },
      setFiguersToShow: function setFiguersToShow($this) {
        if ($this.hasClass('article__tabFigure')) {
          figureViewer.$figuresToShow = figureViewer.$figures.filter('.article__tabFigure');
        } else if ($this.hasClass('article__inlineFigure')) {
          figureViewer.$figuresToShow = figureViewer.$figures.filter('.article__inlineFigure');
        } else {
          figureViewer.$figuresToShow = figureViewer.$figures;
        }
      },
      additionalBehaviorOnShow: function additionalBehaviorOnShow($el) {
        return $el.find('figcaption, .figcaption').clone();
      },
      zoom: {
        /*init: function (element) {
         let figureViewer.$section = $('.figure-viewer');
         },*/
        reset: function reset() {
          $elem = $('.figure-viewer').find('figure');
          $elem.panzoom('reset');
        },
        check: function check() {
          figureViewer.zoom.panzoom.init();
  
          if ($window.width() < 992) {
            figureViewer.zoom.swap();
          }
        },
        panzoom: {
          // zoom in functionality
          init: function init() {
            if (typeof $.fn.panzoom != 'undefined') {
              figureViewer.$image.panzoom({
                $zoomIn: figureViewer.$zoominbtn,
                $zoomOut: figureViewer.$zoomoutbtn,
                $zoomRange: figureViewer.$zoomrange,
                $reset: figureViewer.$zoomreset,
                panOnlyWhenZoomed: true,
                minScale: 1
              });
              figureViewer.$image.on('panzoomchange', function (e) {
                if (figureViewer.$zoomrange.val() === '1') {
                  figureViewer.$image.css('transform', 'matrix(1, 0, 0, 1, 0, 0)');
                  $(this).removeClass('zoomed');
                } else {
                  $(this).addClass('zoomed');
                }
              });
            }
          }
        },
        swap: function swap() {
          // swap functionality for mobile devices
          figureViewer.$section.find('img').swipe({
            //Generic swipe handler for all directions
            swipe: function swipe(event, direction, distance, duration, fingerCount, fingerData) {
              if (direction === 'left' && !figureViewer.$section.find('figure').hasClass('zoomed')) {
                figureViewer.next();
              } else if (direction === 'right' && !figureViewer.$section.find('figure').hasClass('zoomed')) {
                figureViewer.prev();
              }
            }
          });
        }
      },
      slide: function slide() {
        var $target = $body.find('div.ux3-in-slide');
        $body.removeAttr('data-ux3-show');
        setTimeout(function () {
          $target.append($slide.children('div'));
          $target.removeClass('ux3-in-slide');
        }, 250);
      },
      resize: function resize() {
        var wHeight = $window.innerHeight();
        var topHeight = figureViewer.$topRegHeight || 56;
  
        if (figureViewer.isMobile) {
          figureViewer.$figureRegionContainer.css('height', wHeight - topHeight);
        } else {
          figureViewer.$figureRegionContainer.css('height', "calc(100vh - ".concat(topHeight, "px)"));
        }
      },
      figcaptionSize: function figcaptionSize() {
        var $figcaption = $('.figure-viewer__hold__figcap').find('figcaption'),
            figure_area_height = figureViewer.$figureRegionContainer.height(),
            figure_title_height = $('.figure-viewer__title').height() + 30,
            padding = 30;
        $figcaption.css('max-height', figure_area_height - 2 * padding - figure_title_height);
      },
      doubleTap: function doubleTap() {
        // disable double tap zooming functionality on mobile devices
        (function ($) {
          $.fn.nodoubletapzoom = function () {
            $(this).bind('touchstart', function preventZoom(e) {
              var t2 = e.timeStamp,
                  t1 = $(this).data('lastTouch') || t2,
                  dt = t2 - t1,
                  fingers = e.originalEvent.touches.length;
              $(this).data('lastTouch', t2);
  
              if (!dt || dt > 500 || fingers > 1) {
                return; // not double-tap
              }
  
              e.preventDefault(); // double tap - prevent the zoom
              // also synthesize click events we just swallowed up
  
              $(e.target).trigger('click');
            });
          };
        })(jQuery);
      },
      init: function init() {
        figureViewer.expand();
        figureViewer.control();
        figureViewer.doubleTap();
        $('body').nodoubletapzoom();
        $('.figure__highResImgReplacer').length && figureViewer.onHighRes();
      },
      showCaption: function showCaption($caption) {
        if ($caption.length) {
          figureViewer.$captionHolder.append($caption);
          figureViewer.$captionHolder.find('figcaption').removeClass('hidden');
          figureViewer.$captionRegion.removeClass('is-hidden'); // here we check if the caption region has the js-open or not to toggle the $contentRegion again
          // this behavior only happen when you toggle the caption holder then you click on a figure that does not
          // have a caption then again move to a figure with caption
  
          if (figureViewer.$captionRegion.hasClass('js-open')) {
            figureViewer.$contentRegion.addClass('js-open');
          }
        } else if (!figureViewer.$captionHolder.hasClass('is-hidden')) {
          figureViewer.$captionRegion.addClass('is-hidden');
          figureViewer.$contentRegion.removeClass('js-open');
        }
      },
      showCaptionTitle: function showCaptionTitle($element) {
        var $caption = $element.find('.figure__title, .captionLabel').clone();
        $('.figure-viewer__title__text').text($caption.text());
      },
      headerOptions: function headerOptions($this) {
        var $figureExtra = $this.find('.figure-extra'),
            figureExtraContent = $figureExtra.clone();
        $body.find('.figureExtra').length ? $body.find('.figureExtra').remove() : '';
  
        if ($this.find('.figure__image').is('.figure__audio') || $this.find('.figure__image').is('.figure__video')) {
          $body.find('.figure-viewer__top__left').addClass('hidden').after('<div class="figure-viewer__top__left figureExtra">');
          $body.find('.figureExtra').append(figureExtraContent);
          figureExtraContent.appendTo($body.find('.figureExtra'));
          $body.find('.figureExtra').find('.open-figure-link').remove();
        } else if ($body.find('.figure-viewer__top__left').hasClass('hidden')) {
          $body.find('.figure-viewer__top__left').removeClass('hidden');
        }
      },
      streamReset: function streamReset($holder, $originalFigure) {
        setTimeout(function () {
          if ($holder.find('stream').length) {
            $holder.find('stream').html('');
            $.getScript(UX.loader.cloudFlareScript);
            $holder.find('stream').get(0).currentTime = $originalFigure.find('stream').get(0).currentTime;
          } else if ($holder.find('audio').length) {
            $holder.find('audio').get(0).currentTime = $originalFigure.find('audio').get(0).currentTime;
          }
        }, 500);
      },
      pauseOriginalStream: function pauseOriginalStream($element) {
        if ($element.find('stream, audio').length) {
          $element.find('stream, audio').get(0).pause();
        }
      },
      pauseClonedStream: function pauseClonedStream($holder) {
        if ($holder.find('stream, audio').length) {
          $holder.find('stream, audio').get(0).pause();
        }
      },
      removeFigureTitle: function removeFigureTitle() {
        figureViewer.$captionHolder.find('.figure__title').remove();
      },
      onHighResCallback: function onHighResCallback() {}
    };
    UX.figureViewer = figureViewer; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/modal/js/modal.js":
  /*!**********************************************************!*\
    !*** /home/irahhal/ui-core/components/modal/js/modal.js ***!
    \**********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        $window = $(window),
        tabKey = 9,
        shift = 16;
    var modal = {
      $toggle: $('[data-toggle="modal"]'),
      $target: null,
      revers: false,
      lastItem: null,
      items: null,
      $close: null,
      accessibilityEnabled: true,
      init: function init() {
        if (this.accessibilityEnabled) modal.accessibility.init();
        modal.$target = $(modal.$toggle.data('target'));
        modal.control();
      },
      accessibility: {
        init: function init() {
          // Move every modal outside of content in order to be able hide and show page content for screen readers
          // @note: for some reason, it is not working with tab trap correctly, when we append it to body - after(.content) works fine
          var $content = $('main.content');
  
          if ($content.length) {
            $content.after($('.ux-modal-container'));
          } // Text for close buttons
  
  
          $('[data-dismiss="modal"]').append('<span class="sr-only">Close modal</span>');
        },
        show: function show() {
          $('.content, .footer, .header').attr('aria-hidden', true);
        },
        hide: function hide() {
          $('.content, .footer, .header').removeAttr('aria-hidden');
        }
      },
      control: function control() {
        $body.on('click', '[data-toggle="modal"]', function (e) {
          e.preventDefault();
          modal.$toggle = $(this);
          modal.$target = $(modal.$toggle.data('target'));
          modal.$close = modal.$target.find('.close');
          modal.items = modal.$target.find('a, button, input');
          modal.items.each(function (index) {
            if (index === modal.items.length - 1) {
              modal.lastItem = $(this);
            }
          });
          modal.on.show();
        });
        $body.on('click', '.modal', function (e) {
          var target = $(e.target);
  
          if (!target.is('.modal__dialog') && !target.closest('.modal__dialog').length > 0) {
            //e.preventDefault();
            modal.on.hide();
          }
        });
        $body.on('click', '[data-dismiss="modal"]', function (e) {
          modal.on.hide();
        });
        $('.modal').on('keydown', function (e) {
          if (e.keyCode === shift) {
            modal.revers = true;
          }
  
          if ((e.keyCode || e.which) === tabKey) {
            if (!modal.revers) {
              modal.on.tab();
            } else {
              modal.on.tabRevers();
            }
          }
        });
        $window.on('keyup', function (e) {
          if (e.keyCode === shift) {
            modal.revers = false;
          }
        });
      },
      on: {
        show: function show(e) {
          if (typeof UX.controller !== "undefined") {
            UX.controller.check();
          }
  
          setTimeout(function () {
            $body.attr('data-active', 'modal');
            modal.accessibility.show();
            var $autofocus = modal.$target.find('[autofocus]');
            if ($autofocus.length) $autofocus.focus();else modal.$close.focus();
          }, 250);
          modal.$target.closest("[class*='sticko']").addClass("js--open");
          $("#externalEmailDialogForm").addClass("pairing-management-modal");
        },
        hide: function hide() {
          $body.removeAttr('data-active');
          modal.accessibility.hide();
          modal.$target.closest("[class*='sticko']").removeClass("js--open");
        },
        tab: function tab() {
          modal.$close.off('focusout');
          modal.lastItem.off('focusout');
          modal.lastItem.on('focusout', function () {
            modal.$close.focus();
          });
        },
        tabRevers: function tabRevers() {
          modal.lastItem.off('focusout');
          modal.$close.off('focusout');
          modal.$close.on('focusout', function () {
            modal.lastItem.focus();
          });
        }
      }
    };
    UX.modal = modal; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/progress-bar/js/progress-bar.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/components/progress-bar/js/progress-bar.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $document = $(document),
        $body = $('body');
    var progressBar = {
      $barWrapper: $('.progress-bar--wrapper'),
      $bar: $('.progress-bar'),
      scrollPercent: null,
      lock: true,
      init: function init() {
        progressBar.controller();
      },
      controller: function controller() {
        $window.on("scroll load", function () {
          progressBar.scrollPercent = 100 * $window.scrollTop() / ($document.height() - $window.height() - $('footer').outerHeight());
          if (progressBar.scrollPercent > 100 || $window.height() >= $('main').height() + $('header').outerHeight()) progressBar.scrollPercent = 100;
          if (progressBar.lock) progressBar.$bar.stop().animate({
            width: progressBar.scrollPercent + "%"
          }, 50);
        });
      }
    };
    UX.progressBar = progressBar;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/refine-search/js/refine-search.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/components/refine-search/js/refine-search.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var refine = {
      $target: null,
      $targets: $('.refineSearch'),
      $showController: $('.quick-search__ctrl__refine'),
      $hideController: $('.quick-search__ctrl__refine--hide'),
      $elements: $('.refineSearch__row'),
      $wrapper: null,
      escape: 27,
      init: function init() {
        refine.control();
  
        if ($('.quick-search').length) {
          refine.on.hide();
        }
      },
      control: function control() {
        $body.on('click', '.refineSearch__ctrl__remove', function (e) {
          e.preventDefault();
          var $this = $(this);
          refine.$target = $this.closest('.refineSearch');
          refine.$wrapper = refine.$target.find('.refineSearch__texts');
          refine.on.remove($this);
        });
        $body.on('click', '.refineSearch__ctrl__add', function (e) {
          e.preventDefault();
          var $this = $(this);
          refine.$target = $this.closest('.refineSearch');
          refine.$wrapper = refine.$target.find('.refineSearch__texts');
          refine.on.clone($this);
        });
        $body.on('click', '.quick-search__ctrl__refine', function (e) {
          e.preventDefault();
  
          if (refine.$targets.length) {
            refine.on.show();
          }
        });
        $body.on('click', '.quick-search__ctrl__refine--hide', function (e) {
          e.preventDefault();
          refine.on.hide();
        });
        $body.on('click', function (e) {
          if (!refine.$targets.is(e.target) // if the target of the click isn't the container...
          && refine.$targets.has(e.target).length === 0 // ... nor a descendant of the container
          && !refine.$showController.is(e.target) // if the target of the click isn't the controller...
          && refine.$showController.has(e.target).length === 0 // ... nor a descendant of the controller
          && !$(e.target).closest('.jcf-select-drop').length && !refine.$targets.closest('.search-result__refine-search').length && !$(e.target).closest('.refineSearch__ctrl__remove').length) {
            refine.on.hide();
          }
        });
        $(document).on('keydown', function (e) {
          if ((e.keyCode || e.which) === refine.escape) {
            refine.on.hide();
          }
        });
      },
      on: {
        clone: function clone($this) {
          jcf.destroyAll();
          $this.closest('.refineSearch__row').clone(true, true).find('input').attr("name", "text" + ($(".refineSearch__row").length + 1).toString()).val('').end().appendTo(refine.$wrapper);
          $this.addClass('hidden');
          $this.siblings('.refineSearch__ctrl__remove').removeClass('hidden');
          $('.jcf').each(function () {
            jcf.replace($(this));
          });
        },
        remove: function remove($this) {
          $this.closest('.refineSearch__row').remove();
        },
        show: function show() {
          refine.$showController.addClass('hidden');
          refine.$hideController.removeClass('hidden');
          refine.$targets.addClass('js--open');
          refine.$targets.show();
        },
        hide: function hide() {
          refine.$targets.each(function () {
            if ($body.attr('data-active') === 'refine') {
              $body.removeAttr('data-active');
            }
  
            refine.$hideController.addClass('hidden');
            refine.$showController.removeClass('hidden');
            refine.$targets.removeClass('js--open');
            refine.$targets.hide();
          });
        }
      }
    };
    UX.refine = refine; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/tables/js/sortable-table-row.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/components/tables/js/sortable-table-row.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var sortableTableRow = {
      $tableBody: $(".sortable-table tbody"),
      init: function init() {
        if (typeof sortableTableRow.$tableBody.sortable !== 'undefined') {
          sortableTableRow.$tableBody.sortable({
            handle: '.btn--handle',
            items: 'tr.sortable-row',
            stop: sortableTableRow.afterStopSortRow,
            axis: 'y'
          });
        }
      },
      controller: function controller() {},
      afterStopSortRow: function afterStopSortRow(event, ui) {
        if ($(".submission-authors").length > 0) {
          var $authorsRows = ui.item.closest(".authors__table").find(".author__row");
          $authorsRows.each(function (index) {
            $(this).find("input.author__order").val(index);
          });
        }
      }
    };
    UX.sortableTableRow = sortableTableRow; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/tables/js/tables.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-core/components/tables/js/tables.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        $window = $(window),
        $document = $(document),
        isMobile = false; // variable use to determine if responsive mode is on or off
  
    var toggleTable = {
      vPort: "screen-xs",
      init: function init() {
        toggleTable.on.build();
        toggleTable.control();
      },
      control: function control() {
        $body.on('click', '.expandable .table__control__button', function (e) {
          e.preventDefault();
  
          if ($(this).closest('tr').hasClass('js--expanded')) {
            toggleTable.on.hide($(this).closest('tr'));
          } else {
            toggleTable.on.show($(this).closest('tr'));
          }
        });
        $window.on('resize', function () {
          toggleTable.on.build();
        });
        $(document).on(toggleTable.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
          toggleTable.on.build();
        });
        $(document).on(toggleTable.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
        });
      },
      on: {
        build: function build() {
          var $toggle = $('.expandable');
          $toggle.each(function () {
            var $target = $(this).find('tr');
            var to_hide = $target.find('.to_hide');
            $target.removeClass('js--expanded');
  
            if (isMobile) {
              $(to_hide).hide(0);
            } else {
              $(to_hide).show(0);
            }
          });
        },
        show: function show(elem) {
          var $target = elem.find('.to_hide');
          $target.slideDown(200);
          elem.addClass('js--expanded');
        },
        hide: function hide(elem) {
          var $target = elem.find('.to_hide');
          $target.slideUp(200);
          elem.removeClass('js--expanded');
        }
      }
    };
    UX.toggleTable = toggleTable; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/tabs/js/tabs.js":
  /*!********************************************************!*\
    !*** /home/irahhal/ui-core/components/tabs/js/tabs.js ***!
    \********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var tab = {
      $target: null,
      $toggle: null,
      $li: null,
      $spinner: null,
      $ul: $('.tab__nav'),
      $previous: null,
      $content: null,
      isTouched: false,
      extraMargin: 25,
      elementvPort: null,
      $controls: null,
      pointerPosition: 0.0,
      cumulativeShift: 0.0,
      vPort: 'screen-sm',
      // default responsive break point
      isSlide: false,
      isMobile: [],
      // variable use to determine if responsive mode is on or off
      backToAccessibility: true,
      // variable use to determine if we want to add back btn to navigate between content and aside
      swipeDisableClass: 'arrows-slide__single--disabled',
      init: function init() {
        tab.$spinner = $('.tab__spinner');
        tab.preselectTab();
        tab.elementvPort = tab.vPort;
        tab.vPort = [];
        var tabElm = $('.tab:not(.tab .tab)'); // in case hierarchical tabs, which is looping inside nested tabs that have the same main tab behavior ex: loi
  
        tabElm.each(function (index) {
          var _this = $(this);
  
          tab.check.viewPort(index, _this); // get current view port activator break point
  
          tab.responsive(index, _this);
        });
        tab.$controls = '<li class=\'arrows-slide\'><i class=\'icon-arrow_l arrows-slide__single prev\'></i> <i class=\'icon-arrow_r arrows-slide__single next\'></i></li>';
        tab.on.build();
        tab.control();
        $('.tab__nav a').each(function () {
          // go through all tab nav items
          tab.check.empty($(this));
        });
      },
      preselectTab: function preselectTab() {
        // The preselectTab function should be cleanup
        // Its better to use query string in url instead session storage for select active tab
        // We should depend on data-target always instead of href because href may contain url not tab-pane selector
        // selection of active tab should tested on nested tabs and multi tabs on page
        $(".tab").each(function () {
          //the rest of this code doesnt seem to support multiple tabs on the page.. but this does
          var _this = $(this);
  
          if (_this.data('js-preselect') == false) //If you don't need js to select the active tab
            return true;
  
          var $activeTab = _this.find('.tab__nav').find('li.active a');
  
          var activeTab = tab.getPaneTarget($activeTab);
          var sessionActiveTab = null;
  
          if (!activeTab && sessionStorage.activeTab) {
            // check "sessionStorage.activeTab" is solution for LIT-189292
            activeTab = sessionStorage.getItem('activeTab');
            sessionActiveTab = activeTab;
          } // Checking if activeTab contains hash, if not it is not 'tab'
  
  
          var hash = activeTab ? activeTab.match(/#/) : null;
          if (activeTab && (!hash || hash.index != 0)) return;
  
          if (_this.find(activeTab).length == 0) {
            activeTab = null;
          } else if (sessionActiveTab) {
            sessionStorage.setItem('activeTab', '');
          }
  
          if (location.search !== '') {
            var reExp = /activeTab=\b[\w-]+$/g;
  
            if (reExp.test(location.search)) {
              var activeParameter = location.search.match(reExp)[0];
  
              if ($('#' + activeParameter.split('=')[1]).length) {
                activeTab = '#' + activeParameter.split('=')[1];
              }
            }
          }
  
          var $firstItem = _this.find('.tab__nav').find('li:first-of-type a');
  
          if (!activeTab) activeTab = tab.getPaneTarget($firstItem);
          if (activeTab && activeTab.split('#').length < 2 || activeTab == '') return true;
          var triggerTarget = $('[data-target=\'' + activeTab + '\'], [href=\'' + activeTab + '\']');
  
          if (!triggerTarget.closest('.w-slide__btn').length) {
            // @TODO add condition to apply on while on mobile only, think: is the closest() method really best for the job?
            triggerTarget.click();
  
            _this.find(activeTab).addClass('active'); // in some cases to display tab content the .active class has to tiggered. Known case: alerts management in profile, when directed to a specific tab.
  
          }
        });
      },
      control: function control() {
        $body.on('click', '.tab-link', function (e) {
          e.preventDefault();
          $(this).attr('data-scroll-back-to', $(document).scrollTop());
          tab.on.select.external($(this));
        });
        $body.on('click', '[data-mobile-toggle="dropdown"] a, .dropblock--tab a', function (e) {
          tab.on.select.dropdown($(this));
          if ($('.js--open[data-db-target-for]').length) UX.dropBlock.on.hide();
        });
        $body.on('click', '.tab__nav a', function () {
          var _this = $(this);
  
          var tabId = tab.getPaneTarget(_this);
          $(document).trigger('tabs:changeActiveTab', {
            tabId: tabId
          });
  
          var $parent = _this.parents('.tab');
  
          if ($parent.hasClass('tab--lazy-load')) {
            if ($(tabId).attr('data-ajaxloaded') != 'true') {
              tab.getContent($(tabId).find('.tab-lazy'));
            }
          }
        });
        $body.on('click touchend', '.arrows-slide .next', function (e) {
          e.preventDefault();
          var $activeNav = $(this).closest('.tab__nav').find('.active');
          var $activePane = $(this).closest('.tab').find(".tab__content li.active");
  
          if ($activeNav.next().not('.arrows-slide').length > 0) {
            var $newActiveEl = $activeNav.removeClass('active').next().not('.arrows-slide');
            $newActiveEl.addClass('active').show();
            $activePane.removeClass('active').next().addClass('active');
            tab.navToExternal($newActiveEl);
  
            if (!$activeNav.next().not('.arrows-slide').next().not('.arrows-slide').length) {
              $(this).addClass(tab.swipeDisableClass);
            }
  
            $(this).closest('.arrows-slide').find('.prev').removeClass(tab.swipeDisableClass);
          }
        });
        $body.on('click touchend', '.arrows-slide .prev', function (e) {
          e.preventDefault();
          var $activeNav = $(this).closest('.tab__nav').find('.active');
          var $activePane = $(this).closest('.tab').find(".tab__content li.active");
  
          if ($activeNav.prev().not('.arrows-slide').length > 0) {
            var $newActiveEl = $activeNav.removeClass('active').prev().not('.arrows-slide');
            $newActiveEl.addClass('active').show();
            $activePane.removeClass('active').prev().addClass('active');
            tab.navToExternal($newActiveEl);
  
            if (!$activeNav.prev().not('.arrows-slide').prev().not('.arrows-slide').length) {
              $(this).addClass(tab.swipeDisableClass);
            }
  
            $(this).closest('.arrows-slide').find('.next').removeClass(tab.swipeDisableClass);
          }
        }); // Get postback active tab
  
        tab.setPostbackActiveTab(tab.getPostbackActiveTab());
        tab.additionalControl();
      },
      additionalControl: function additionalControl() {},
      navToExternal: function navToExternal($activeNav) {
        var $externalLink = $activeNav.find('.external');
  
        if ($externalLink.length) {
          window.location.href = $externalLink.attr('href');
        }
      },
      responsive: function responsive(index, tabElem) {
        $(document).on(tab.vPort[index] + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          tab.isMobile[index] = true; //$('[data-slide-target]').addClass('w-slide__btn');
          // $('.tab').each(function () {
  
          if (tabElem.data('ctrl-res') == tab.vPort[index]) {
            tabElem.addClass('tab--res'); // class will be used in our scss (to replace media queries)
  
            tab.additionalControl();
            tab.on.rebuild.responsive(tabElem); // rebuild tabs to be responsive
          } // });
          // withArrows.each(function (i, o) {
  
  
          if (tabElem.closest('.swipe-with-arrows').length) {
            var tabNav = tabElem.find('.tab__nav');
  
            if (tabNav.children('li').length > 1) {
              var posIndex = tabNav.children('li.active').index(),
                  length = tabNav.children('li').length,
                  controls = $(tab.$controls);
              tabNav.children('li:not(.active)').hide();
  
              if (posIndex + 1 == length) {
                // decide which arrow to disable
                controls.find('.next').addClass(tab.swipeDisableClass);
              }
  
              if (posIndex == 0) {
                controls.find('.prev').addClass(tab.swipeDisableClass);
              }
  
              tabNav.append(controls);
            }
          } // });
  
        });
        $(document).on(tab.vPort[index] + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          tab.isMobile[index] = false; // $('.tab').each(function () {
  
          if (tabElem.data('ctrl-res') == tab.vPort[index]) {
            tabElem.removeClass("tab--res"); // class will be used in our scss (to replace media queries)
  
            tab.on.rebuild.original($(this)); // return tabs as default
          } // });
  
  
          var withArrows = $('.swipe-with-arrows').find('.tab__nav');
          withArrows.children('li').css("display", "inline-block");
          withArrows.find('.arrows-slide').remove();
        });
      },
      animate: {
        scroll: function scroll($content, $target) {
          if ($target.length) {
            var contentScrollTop = $content.scrollTop();
            var contentTop = $content.position().top;
            var targetTop = $target.position().top;
            $content.animate({
              scrollTop: targetTop - contentTop + contentScrollTop
            }, 600);
          }
        }
      },
      set: {
        target: function target($content, _target, temp) {
          if (!$content.find(_target).length) {
            tab.$target = $content.find('[data-figure-id=\'' + temp + '\']');
          } else {
            tab.$target = $content.find(_target);
          }
        }
      },
      accessibility: {
        /**
         * Accessibility - navigate between content and aside
         * @param elem
         * @param tab
         */
        externalLink: function externalLink(elem, tab) {
          // create focusable option for target
          var tabindex = tab.$target.attr('tabindex');
          tab.$target.attr('tabindex', typeof tabindex === 'undefined' ? -1 : tabindex); // create and append back button to content
  
          var backLink = $('<button class="btn btn--keyboard-accessible">Go back to content</button>');
  
          if (tab.backToAccessibility) {
            if (tab.$target.is('a, ul, ol, img, table') || tab.$target.is(':input')) {
              tab.$target.after(backLink);
            } else {
              tab.$target.append(backLink);
            } // go back to original element if backbutton is activated
  
  
            backLink.on('click', function () {
              elem.focus();
            }).on('focusout', function () {
              $(this).remove();
            });
          } // revert original state on focus out
  
  
          tab.$target.on('focusout.tablink', function (event) {
            var $this = $(this); // revert tabindex to original value
  
            if (typeof tabindex === 'undefined') {
              $this.removeAttr('tabindex');
            } // remove backbutton if user tabbed out of target by some other means than tabbing to backlink
  
  
            if (!$(event.relatedTarget).is(backLink) && !$(event.relatedTarget).parents().filter(tab.$target).length) {
              if (backLink.length) backLink.remove();
              $this.off('focusout.tablink');
            }
          }) // provide ESC support for return to content
          .on('keydown.tablink', function (event) {
            var $this = $(this); // on escape, return to control
  
            if (event.which === 27) {
              $this.off('keydown.tablink');
              elem.focus();
              if (backLink.length) backLink.remove();
            }
          }); // set focus to target
  
          tab.$target.focus();
        }
      },
      on: {
        select: {
          external: function external($elem) {
            var target = $elem.attr('href'); // get target id
  
            target = target.split(" ")[0]; //LIT-162636
  
            tab.$toggle = '#' + $elem.data('tab'); //get target pane
  
            tab.$li = $('.tab__nav [href="' + tab.$toggle + '"]'); // get target tabs nav
  
            var temp = target.split("#")[1];
            var parentTab = $(tab.$toggle).closest('.tab');
  
            var animateScroll = function animateScroll() {
              tab.$content = $(tab.$toggle).parents(".tab__content");
              if (!tab.$content.length && $elem.is('[data-slide-target]') && $elem.hasClass('slide-active')) tab.$content = $('.w-slide__content');
  
              if (parentTab.hasClass('tab--res')) {
                tab.isSlide = parentTab.hasClass("tab--slide");
  
                if (tab.isSlide) {
                  tab.set.target($('.w-slide__content'), target, temp);
  
                  if (tab.$target.length) {
                    tab.animate.scroll($(".w-slide__content"), tab.$target);
                    tab.$target.attr("tab-index", "1");
                    tab.$target.focus();
                  }
                }
              } else {
                tab.set.target(tab.$content, target, temp);
                tab.animate.scroll(tab.$content, tab.$target);
                tab.accessibility.externalLink($elem, tab);
              }
            };
  
            if ($(tab.$toggle).is(':visible')) {
              tab.$li.click(); // open target tab
  
              animateScroll();
            } else {
              if ($(tab.$toggle).hasClass('empty')) {
                $(tab.$toggle).on('content-loaded', function () {
                  animateScroll();
                });
                tab.$li.click(); // open target tab
              } else {
                tab.$li.click(); // open target tab
  
                animateScroll();
              }
            }
          },
          dropdown: function dropdown(elem) {
            var dataAttr = elem.closest('ul').data('mobile-toggle');
  
            if (dataAttr === 'dropdown' || elem.closest('ul').hasClass('dropblock--tab')) {
              var dropdownContainer = elem.closest('.dropBlock');
              dropdownContainer.children('a').find('span').text(elem.text());
            }
          }
        },
        build: function build() {
          //setTimeout(function() {
          tab.$ul.each(function (index) {
            if ($(this).is('.swipe__list')) {
              tab.on.swipeBuild($(this));
            }
  
            if ($(this).is('.dropblock--tab')) {
              tab.on.dropdownBuild($(this), index);
            }
          }); //}, 200);
  
          $('.tab--lazy-load').each(function () {
            tab.getContent($(this).find('.tab__pane.active').find('.tab-lazy'));
          });
        },
        calculate: function calculate(elem) {
          var elemParent = elem.parent();
          var tabNavWidth = tab.extraMargin;
          elem.find('li').each(function (index) {
            tabNavWidth += $(this).innerWidth();
          });
          var elemParentWidth = elemParent.width();
  
          if (elemParentWidth < tabNavWidth) {
            if (!elem.parent().is('.scroll')) {
              tab.on.swipeBuild(elem, tabNavWidth);
            }
          } else {
            tab.on.swipeDestroy(elem);
          }
        },
        swipeBuild: function swipeBuild(elem, tabNavWidth) {
          // rebuild tabs to swipe
          elem.wrap('<div class="swipe__wrapper"><div class="scroll"></div></div>');
  
          if (!tabNavWidth) {
            var tabNavWidth = tab.extraMargin;
            elem.closest(".tab__pane").css("display", "block");
            elem.find('li').each(function (index) {
              tabNavWidth += $(this).innerWidth();
            });
            elem.closest(".tab__pane").css("display", "");
          }
  
          elem.width(tabNavWidth);
        },
        swipeDestroy: function swipeDestroy(elem) {
          // return tabs to default
          elem.removeAttr('style');
          elem.unwrap('.scroll').unwrap('.swipe__wrapper');
        },
        dropdownBuild: function dropdownBuild(elem, index) {
          // rebuild tabs to be as drop down
          if (UX.dropBlock) {
            UX.dropBlock.init();
          }
  
          elem.wrap('<div class="dropBlock" data-db-parent-of="dbTab-' + index + '"></div>');
          var $dropdownContainer = elem.closest('.dropBlock');
          var $activeTab = elem.find('.active a');
          $dropdownContainer.prepend('<a href="#"class="dropBlock__link" data-db-target-for="dbTab-' + index + '"><span>' + $activeTab.text() + '</span><i class="icon-arrow_d_n" aria-hidden="true"></i></a>');
          elem.attr('data-db-target-of', 'dbTab-' + index);
        },
        dropdownDestroy: function dropdownDestroy(elem) {
          // return tabs to default
          var dropdownContainer = elem.closest('.dropBlock');
          dropdownContainer.children('a').remove();
          elem.removeAttr('data-db-target-of').removeClass('js--open').removeAttr('style').unwrap('.dropBlock');
        },
        accordionBuild: function accordionBuild(elem) {
          // rebuild tabs to be as accordion
          var $accourdionElem = elem.next('.tab__content');
          $accourdionElem.addClass('accordion-tabbed').wrap('<div class="accordion"></div>');
          elem.find('a').each(function (index) {
            var $lidiv = $(this);
            var liController = tab.getPaneTarget($lidiv);
            $(liController).addClass('accordion-tabbed__tab') // transform tabs structure to accordion structure
            .removeClass('tab__pane').wrapInner('<div class="accordion-tabbed__content"></div>');
            var accordionContrl = $lidiv.clone().prependTo(liController).addClass('accordion-tabbed__control'); // clone tabs controller as accordion controller
          });
          elem.hide();
          UX.accordion.init();
          $('.tab__content.accordion-tabbed .accordion-tabbed__tab').removeClass('js--open').find('.accordion-tabbed__content').hide();
          $('.tab__content.accordion-tabbed .accordion-tabbed__tab.active').addClass('js--open').find('.accordion-tabbed__content').show();
        },
        accordionDestroy: function accordionDestroy(elem) {
          // return tabs to default
          elem.next('.accordion').find('.tab__content').removeClass('accordion-tabbed').unwrap('.accordion').find('.accordion-tabbed__tab').each(function (index) {
            var $liDiv = $(this);
            $liDiv.addClass('tab__pane').removeClass('accordion-tabbed__tab js--open');
            var content = $liDiv.find('.accordion-tabbed__content').text();
            $liDiv.html(content);
            elem.show();
          });
          var activeTap = elem.next('.tab__content').find('.active').attr('id');
          elem.find('.active').removeClass('active');
          $('[href="#' + activeTap + '"]').closest('li').addClass('active');
        },
        slideDestroy: function slideDestroy(elem) {
          elem.find('[data-slide-target]').removeClass('w-slide__btn slide-active');
        },
        rebuild: {
          original: function original($elem) {
            // return tabs to be as default
            //$('[data-slide-target]').removeClass('w-slide__btn slide-active');
            tab.$ul = $elem.find('.tab__nav');
            tab.$ul.each(function (index) {
              switch ($(this).data('mobile-toggle') || $(this).closest('[data-mobile-toggle]').data('mobile-toggle')) {
                case 'swipe':
                  tab.on.swipeDestroy($(this));
                  break;
  
                case 'dropdown':
                  tab.on.dropdownDestroy($(this));
                  break;
  
                case 'accordion':
                  tab.on.accordionDestroy($(this));
                  break;
  
                case 'slide':
                  tab.on.slideDestroy($(this));
                  break;
  
                default:
                /*if ( $(this).closest('.tab').hasClass('tab--flex') ||  $(this).closest('.tab').hasClass('loi') ||  $(this).hasClass('dropblock--tab') || $(this).closest(".advancedSearch__tabs").length ) {
                    return;
                }else {
                    tab.on.calculate($(this));
                }
                */
  
              }
            });
            $(document).trigger('init.bs.tab');
          },
          responsive: function responsive($elem) {
            // rebuild tabs to be in selected responsive mode
            tab.$ul = $elem.find('.tab__nav');
            $('.tab__nav').find('[data-slide-target]').addClass('w-slide__btn slide-active');
            tab.$ul.each(function (index) {
              switch ($(this).data('mobile-toggle') || $(this).closest('[data-mobile-toggle]').data('mobile-toggle')) {
                case 'swipe':
                  // rebuild tabs to swipe
                  if (!$(this).parent().is('.scroll')) {
                    tab.on.swipeBuild($(this));
                  }
  
                  break;
  
                case 'dropdown':
                  // rebuild tabs be as dropdown
                  if (!$(this).parent().is('.dropBlock')) {
                    tab.on.dropdownBuild($(this), index);
                  }
  
                  break;
  
                case 'accordion':
                  // rebuild tabs be as accordion
                  if (!$(this).next().hasClass('accordion')) {
                    tab.on.accordionBuild($(this));
                  }
  
                  break;
  
                case 'slide':
                  // rebuild tabs be as accordion
                  break;
  
                default: // rebuild tabs to flex
  
                /*if ( $(this).closest('.tab').hasClass('tab--flex') ||  $(this).closest('.tab').hasClass('loi') ||  $(this).hasClass('dropblock--tab') || $(this).closest(".advancedSearch__tabs").length  ) {
                    return;
                }else {
                    tab.on.calculate($(this));
                }*/
  
              }
            });
            $(document).trigger('init.bs.tab');
          }
        }
      },
      check: {
        empty: function empty($tabItem) {
          // check if tab pane is empty and hide it
          var pane = tab.getPaneTarget($tabItem); // get it's related pane
  
          if ($tabItem.is('a:not([href^="#"])') || $tabItem.hasClass('external')) // it is link and has no pane
            return;
  
          if (!$(pane).length) {
            $tabItem.addClass("empty"); // disable tab nav because it has no pane
          }
  
          var $pane = $(pane),
              hasNoContent = !$pane.text().trim().length || $pane.find('.emptyTab').length || $pane.is(':empty');
  
          if ($pane.length && hasNoContent) {
            // if tab nav item is not an external link and check if pane is empty
            $pane.addClass('empty'); // add class to empty pane
  
            $tabItem.addClass('empty'); // add class to empty nav item
  
            return true; // abort
          } else {
            $pane.removeClass('empty'); // add class to empty pane
  
            $tabItem.removeClass('empty'); // add class to empty nav item
  
            return false; // abort
          }
        },
        viewPort: function viewPort(index, $el) {
          if (typeof $el.data('ctrl-res') != 'undefined' || $el.data('ctrl-res') == '') {
            tab.vPort[index] = $el.data('ctrl-res');
          } else {
            $el.data('ctrl-res', tab.elementvPort);
            tab.vPort[index] = tab.elementvPort;
          }
        }
      },
      getPaneTarget: function getPaneTarget($elem) {
        return $elem.data('target') || $elem.attr('href');
      },
      getPostbackActiveTab: function getPostbackActiveTab() {
        var param = 'tabActivePane';
        param = param.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regex = new RegExp("[\\?&]" + param + "=([^&#]*)");
        var results = regex.exec(location.search);
        return results == null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      },
      setPostbackActiveTab: function setPostbackActiveTab(tabID) {
        if (tabID != '') {
          var $activeTabs = $('a[data-simple-tab-id=\'' + tabID + '\']');
  
          if ($activeTabs.length > 0) {
            $activeTabs.each(function () {
              $activeTabs.trigger('click');
            });
          }
        }
      },
      additionalAjaxSuccess: function additionalAjaxSuccess(data) {},
      getContent: function getContent($elem) {
        var tabId = $elem.attr('data-tabId');
        var widgetId = $elem.attr('data-widgetId');
        var pbContext = encodeURIComponent($('meta[name=pbContext]').attr('content'));
        var $tabBody = $elem.parents('.tab__pane');
        $.ajax({
          url: '/pb/widgets/ux3/lazyTabs/loadTab?pbContext=' + pbContext + '&tabId=' + tabId + '&widgetId=' + widgetId,
          success: function success(data) {
            $tabBody.attr('data-ajaxLoaded', 'true');
            $elem.replaceWith(data);
  
            if ($tabBody.find('.tab__pane.active').find('.tab-lazy').length) {
              tab.getContent($tabBody.find('.tab__pane.active').find('.tab-lazy'));
            }
  
            $tabBody.find(tab.$spinner).hide(); // we did not use $(data).find() because the data is not a DOMElement thus,
            // any logic will be added .js-showcase-slideshow within the data not within DOM,
            // we need to get the element from the DOM that's
  
            tab.showcaseSlideshowCheck($tabBody.find('.js-showcase-slideshow'));
            tab.additionalAjaxSuccess(data);
          },
          error: function error() {}
        });
      },
      showcaseSlideshowCheck: function showcaseSlideshowCheck($showCase) {
        if (!$showCase.length || !UX.showcaseSlideshow) {
          return;
        }
  
        UX.showcaseSlideshow.initInstance($showCase, UX.showcaseSlideshow.defaultOptions);
      }
    };
    UX.tab = tab; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/components/teaser/js/teaser.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-core/components/teaser/js/teaser.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  
  
  /***/ }),
  
  /***/ "../../ui-core/components/truncater/js/truncater.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-core/components/truncater/js/truncater.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var truncater = {
      $target: $('.js--truncate'),
      init: function init() {
        truncater.truncate();
      },
      truncate: function truncate() {
        truncater.$target.each(function () {
          $(this).truncate();
        });
      }
    };
    UX.truncater = truncater;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/arrayLikeToArray.js":
  /*!*************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/arrayLikeToArray.js ***!
    \*************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
  
    for (var i = 0, arr2 = new Array(len); i < len; i++) {
      arr2[i] = arr[i];
    }
  
    return arr2;
  }
  
  module.exports = _arrayLikeToArray;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":
  /*!**************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js ***!
    \**************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ "../../ui-core/node_modules/@babel/runtime/helpers/arrayLikeToArray.js");
  
  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return arrayLikeToArray(arr);
  }
  
  module.exports = _arrayWithoutHoles;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js":
  /*!***********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }
  
  module.exports = _classCallCheck;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/createClass.js":
  /*!********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/createClass.js ***!
    \********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }
  
  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    return Constructor;
  }
  
  module.exports = _createClass;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/defineProperty.js":
  /*!***********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/defineProperty.js ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }
  
    return obj;
  }
  
  module.exports = _defineProperty;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/iterableToArray.js":
  /*!************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/iterableToArray.js ***!
    \************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);
  }
  
  module.exports = _iterableToArray;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/nonIterableSpread.js":
  /*!**************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/nonIterableSpread.js ***!
    \**************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  
  module.exports = _nonIterableSpread;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/toConsumableArray.js":
  /*!**************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/toConsumableArray.js ***!
    \**************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayWithoutHoles = __webpack_require__(/*! ./arrayWithoutHoles */ "../../ui-core/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js");
  
  var iterableToArray = __webpack_require__(/*! ./iterableToArray */ "../../ui-core/node_modules/@babel/runtime/helpers/iterableToArray.js");
  
  var unsupportedIterableToArray = __webpack_require__(/*! ./unsupportedIterableToArray */ "../../ui-core/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js");
  
  var nonIterableSpread = __webpack_require__(/*! ./nonIterableSpread */ "../../ui-core/node_modules/@babel/runtime/helpers/nonIterableSpread.js");
  
  function _toConsumableArray(arr) {
    return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();
  }
  
  module.exports = _toConsumableArray;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/typeof.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _typeof(obj) {
    "@babel/helpers - typeof";
  
    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      module.exports = _typeof = function _typeof(obj) {
        return typeof obj;
      };
    } else {
      module.exports = _typeof = function _typeof(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
      };
    }
  
    return _typeof(obj);
  }
  
  module.exports = _typeof;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ "../../ui-core/node_modules/@babel/runtime/helpers/arrayLikeToArray.js");
  
  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);
  }
  
  module.exports = _unsupportedIterableToArray;
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/a-function.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/a-function.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = function (it) {
    if (typeof it != 'function') {
      throw TypeError(String(it) + ' is not a function');
    } return it;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/a-possible-prototype.js":
  /*!************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/a-possible-prototype.js ***!
    \************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var isObject = __webpack_require__(/*! ../internals/is-object */ "../../ui-core/node_modules/core-js/internals/is-object.js");
  
  module.exports = function (it) {
    if (!isObject(it) && it !== null) {
      throw TypeError("Can't set " + String(it) + ' as a prototype');
    } return it;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/an-object.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/an-object.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var isObject = __webpack_require__(/*! ../internals/is-object */ "../../ui-core/node_modules/core-js/internals/is-object.js");
  
  module.exports = function (it) {
    if (!isObject(it)) {
      throw TypeError(String(it) + ' is not an object');
    } return it;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/array-from.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/array-from.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var bind = __webpack_require__(/*! ../internals/function-bind-context */ "../../ui-core/node_modules/core-js/internals/function-bind-context.js");
  var toObject = __webpack_require__(/*! ../internals/to-object */ "../../ui-core/node_modules/core-js/internals/to-object.js");
  var callWithSafeIterationClosing = __webpack_require__(/*! ../internals/call-with-safe-iteration-closing */ "../../ui-core/node_modules/core-js/internals/call-with-safe-iteration-closing.js");
  var isArrayIteratorMethod = __webpack_require__(/*! ../internals/is-array-iterator-method */ "../../ui-core/node_modules/core-js/internals/is-array-iterator-method.js");
  var toLength = __webpack_require__(/*! ../internals/to-length */ "../../ui-core/node_modules/core-js/internals/to-length.js");
  var createProperty = __webpack_require__(/*! ../internals/create-property */ "../../ui-core/node_modules/core-js/internals/create-property.js");
  var getIteratorMethod = __webpack_require__(/*! ../internals/get-iterator-method */ "../../ui-core/node_modules/core-js/internals/get-iterator-method.js");
  
  // `Array.from` method implementation
  // https://tc39.es/ecma262/#sec-array.from
  module.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
    var O = toObject(arrayLike);
    var C = typeof this == 'function' ? this : Array;
    var argumentsLength = arguments.length;
    var mapfn = argumentsLength > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var iteratorMethod = getIteratorMethod(O);
    var index = 0;
    var length, result, step, iterator, next, value;
    if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);
    // if the target is not iterable or it's an array with the default iterator - use a simple case
    if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {
      iterator = iteratorMethod.call(O);
      next = iterator.next;
      result = new C();
      for (;!(step = next.call(iterator)).done; index++) {
        value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;
        createProperty(result, index, value);
      }
    } else {
      length = toLength(O.length);
      result = new C(length);
      for (;length > index; index++) {
        value = mapping ? mapfn(O[index], index) : O[index];
        createProperty(result, index, value);
      }
    }
    result.length = index;
    return result;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/array-includes.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/array-includes.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var toIndexedObject = __webpack_require__(/*! ../internals/to-indexed-object */ "../../ui-core/node_modules/core-js/internals/to-indexed-object.js");
  var toLength = __webpack_require__(/*! ../internals/to-length */ "../../ui-core/node_modules/core-js/internals/to-length.js");
  var toAbsoluteIndex = __webpack_require__(/*! ../internals/to-absolute-index */ "../../ui-core/node_modules/core-js/internals/to-absolute-index.js");
  
  // `Array.prototype.{ indexOf, includes }` methods implementation
  var createMethod = function (IS_INCLUDES) {
    return function ($this, el, fromIndex) {
      var O = toIndexedObject($this);
      var length = toLength(O.length);
      var index = toAbsoluteIndex(fromIndex, length);
      var value;
      // Array#includes uses SameValueZero equality algorithm
      // eslint-disable-next-line no-self-compare
      if (IS_INCLUDES && el != el) while (length > index) {
        value = O[index++];
        // eslint-disable-next-line no-self-compare
        if (value != value) return true;
      // Array#indexOf ignores holes, Array#includes - not
      } else for (;length > index; index++) {
        if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;
      } return !IS_INCLUDES && -1;
    };
  };
  
  module.exports = {
    // `Array.prototype.includes` method
    // https://tc39.es/ecma262/#sec-array.prototype.includes
    includes: createMethod(true),
    // `Array.prototype.indexOf` method
    // https://tc39.es/ecma262/#sec-array.prototype.indexof
    indexOf: createMethod(false)
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/call-with-safe-iteration-closing.js":
  /*!************************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/call-with-safe-iteration-closing.js ***!
    \************************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  var iteratorClose = __webpack_require__(/*! ../internals/iterator-close */ "../../ui-core/node_modules/core-js/internals/iterator-close.js");
  
  // call something on iterator step with safe closing on error
  module.exports = function (iterator, fn, value, ENTRIES) {
    try {
      return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);
    // 7.4.6 IteratorClose(iterator, completion)
    } catch (error) {
      iteratorClose(iterator);
      throw error;
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/check-correctness-of-iteration.js":
  /*!**********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/check-correctness-of-iteration.js ***!
    \**********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  
  var ITERATOR = wellKnownSymbol('iterator');
  var SAFE_CLOSING = false;
  
  try {
    var called = 0;
    var iteratorWithReturn = {
      next: function () {
        return { done: !!called++ };
      },
      'return': function () {
        SAFE_CLOSING = true;
      }
    };
    iteratorWithReturn[ITERATOR] = function () {
      return this;
    };
    // eslint-disable-next-line no-throw-literal
    Array.from(iteratorWithReturn, function () { throw 2; });
  } catch (error) { /* empty */ }
  
  module.exports = function (exec, SKIP_CLOSING) {
    if (!SKIP_CLOSING && !SAFE_CLOSING) return false;
    var ITERATION_SUPPORT = false;
    try {
      var object = {};
      object[ITERATOR] = function () {
        return {
          next: function () {
            return { done: ITERATION_SUPPORT = true };
          }
        };
      };
      exec(object);
    } catch (error) { /* empty */ }
    return ITERATION_SUPPORT;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/classof-raw.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/classof-raw.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var toString = {}.toString;
  
  module.exports = function (it) {
    return toString.call(it).slice(8, -1);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/classof.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/classof.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var TO_STRING_TAG_SUPPORT = __webpack_require__(/*! ../internals/to-string-tag-support */ "../../ui-core/node_modules/core-js/internals/to-string-tag-support.js");
  var classofRaw = __webpack_require__(/*! ../internals/classof-raw */ "../../ui-core/node_modules/core-js/internals/classof-raw.js");
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  
  var TO_STRING_TAG = wellKnownSymbol('toStringTag');
  // ES3 wrong here
  var CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';
  
  // fallback for IE11 Script Access Denied error
  var tryGet = function (it, key) {
    try {
      return it[key];
    } catch (error) { /* empty */ }
  };
  
  // getting tag from ES6+ `Object.prototype.toString`
  module.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {
    var O, tag, result;
    return it === undefined ? 'Undefined' : it === null ? 'Null'
      // @@toStringTag case
      : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag
      // builtinTag case
      : CORRECT_ARGUMENTS ? classofRaw(O)
      // ES3 arguments fallback
      : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/copy-constructor-properties.js":
  /*!*******************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/copy-constructor-properties.js ***!
    \*******************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var ownKeys = __webpack_require__(/*! ../internals/own-keys */ "../../ui-core/node_modules/core-js/internals/own-keys.js");
  var getOwnPropertyDescriptorModule = __webpack_require__(/*! ../internals/object-get-own-property-descriptor */ "../../ui-core/node_modules/core-js/internals/object-get-own-property-descriptor.js");
  var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "../../ui-core/node_modules/core-js/internals/object-define-property.js");
  
  module.exports = function (target, source) {
    var keys = ownKeys(source);
    var defineProperty = definePropertyModule.f;
    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;
    for (var i = 0; i < keys.length; i++) {
      var key = keys[i];
      if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/correct-prototype-getter.js":
  /*!****************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/correct-prototype-getter.js ***!
    \****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  
  module.exports = !fails(function () {
    function F() { /* empty */ }
    F.prototype.constructor = null;
    return Object.getPrototypeOf(new F()) !== F.prototype;
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/create-iterator-constructor.js":
  /*!*******************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/create-iterator-constructor.js ***!
    \*******************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var IteratorPrototype = __webpack_require__(/*! ../internals/iterators-core */ "../../ui-core/node_modules/core-js/internals/iterators-core.js").IteratorPrototype;
  var create = __webpack_require__(/*! ../internals/object-create */ "../../ui-core/node_modules/core-js/internals/object-create.js");
  var createPropertyDescriptor = __webpack_require__(/*! ../internals/create-property-descriptor */ "../../ui-core/node_modules/core-js/internals/create-property-descriptor.js");
  var setToStringTag = __webpack_require__(/*! ../internals/set-to-string-tag */ "../../ui-core/node_modules/core-js/internals/set-to-string-tag.js");
  var Iterators = __webpack_require__(/*! ../internals/iterators */ "../../ui-core/node_modules/core-js/internals/iterators.js");
  
  var returnThis = function () { return this; };
  
  module.exports = function (IteratorConstructor, NAME, next) {
    var TO_STRING_TAG = NAME + ' Iterator';
    IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(1, next) });
    setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);
    Iterators[TO_STRING_TAG] = returnThis;
    return IteratorConstructor;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js":
  /*!**********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/create-non-enumerable-property.js ***!
    \**********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "../../ui-core/node_modules/core-js/internals/object-define-property.js");
  var createPropertyDescriptor = __webpack_require__(/*! ../internals/create-property-descriptor */ "../../ui-core/node_modules/core-js/internals/create-property-descriptor.js");
  
  module.exports = DESCRIPTORS ? function (object, key, value) {
    return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));
  } : function (object, key, value) {
    object[key] = value;
    return object;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/create-property-descriptor.js":
  /*!******************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/create-property-descriptor.js ***!
    \******************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = function (bitmap, value) {
    return {
      enumerable: !(bitmap & 1),
      configurable: !(bitmap & 2),
      writable: !(bitmap & 4),
      value: value
    };
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/create-property.js":
  /*!*******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/create-property.js ***!
    \*******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var toPrimitive = __webpack_require__(/*! ../internals/to-primitive */ "../../ui-core/node_modules/core-js/internals/to-primitive.js");
  var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "../../ui-core/node_modules/core-js/internals/object-define-property.js");
  var createPropertyDescriptor = __webpack_require__(/*! ../internals/create-property-descriptor */ "../../ui-core/node_modules/core-js/internals/create-property-descriptor.js");
  
  module.exports = function (object, key, value) {
    var propertyKey = toPrimitive(key);
    if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));
    else object[propertyKey] = value;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/define-iterator.js":
  /*!*******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/define-iterator.js ***!
    \*******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var $ = __webpack_require__(/*! ../internals/export */ "../../ui-core/node_modules/core-js/internals/export.js");
  var createIteratorConstructor = __webpack_require__(/*! ../internals/create-iterator-constructor */ "../../ui-core/node_modules/core-js/internals/create-iterator-constructor.js");
  var getPrototypeOf = __webpack_require__(/*! ../internals/object-get-prototype-of */ "../../ui-core/node_modules/core-js/internals/object-get-prototype-of.js");
  var setPrototypeOf = __webpack_require__(/*! ../internals/object-set-prototype-of */ "../../ui-core/node_modules/core-js/internals/object-set-prototype-of.js");
  var setToStringTag = __webpack_require__(/*! ../internals/set-to-string-tag */ "../../ui-core/node_modules/core-js/internals/set-to-string-tag.js");
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  var redefine = __webpack_require__(/*! ../internals/redefine */ "../../ui-core/node_modules/core-js/internals/redefine.js");
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  var IS_PURE = __webpack_require__(/*! ../internals/is-pure */ "../../ui-core/node_modules/core-js/internals/is-pure.js");
  var Iterators = __webpack_require__(/*! ../internals/iterators */ "../../ui-core/node_modules/core-js/internals/iterators.js");
  var IteratorsCore = __webpack_require__(/*! ../internals/iterators-core */ "../../ui-core/node_modules/core-js/internals/iterators-core.js");
  
  var IteratorPrototype = IteratorsCore.IteratorPrototype;
  var BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;
  var ITERATOR = wellKnownSymbol('iterator');
  var KEYS = 'keys';
  var VALUES = 'values';
  var ENTRIES = 'entries';
  
  var returnThis = function () { return this; };
  
  module.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {
    createIteratorConstructor(IteratorConstructor, NAME, next);
  
    var getIterationMethod = function (KIND) {
      if (KIND === DEFAULT && defaultIterator) return defaultIterator;
      if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];
      switch (KIND) {
        case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };
        case VALUES: return function values() { return new IteratorConstructor(this, KIND); };
        case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };
      } return function () { return new IteratorConstructor(this); };
    };
  
    var TO_STRING_TAG = NAME + ' Iterator';
    var INCORRECT_VALUES_NAME = false;
    var IterablePrototype = Iterable.prototype;
    var nativeIterator = IterablePrototype[ITERATOR]
      || IterablePrototype['@@iterator']
      || DEFAULT && IterablePrototype[DEFAULT];
    var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);
    var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;
    var CurrentIteratorPrototype, methods, KEY;
  
    // fix native
    if (anyNativeIterator) {
      CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));
      if (IteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {
        if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {
          if (setPrototypeOf) {
            setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);
          } else if (typeof CurrentIteratorPrototype[ITERATOR] != 'function') {
            createNonEnumerableProperty(CurrentIteratorPrototype, ITERATOR, returnThis);
          }
        }
        // Set @@toStringTag to native iterators
        setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);
        if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;
      }
    }
  
    // fix Array#{values, @@iterator}.name in V8 / FF
    if (DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {
      INCORRECT_VALUES_NAME = true;
      defaultIterator = function values() { return nativeIterator.call(this); };
    }
  
    // define iterator
    if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {
      createNonEnumerableProperty(IterablePrototype, ITERATOR, defaultIterator);
    }
    Iterators[NAME] = defaultIterator;
  
    // export additional methods
    if (DEFAULT) {
      methods = {
        values: getIterationMethod(VALUES),
        keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),
        entries: getIterationMethod(ENTRIES)
      };
      if (FORCED) for (KEY in methods) {
        if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {
          redefine(IterablePrototype, KEY, methods[KEY]);
        }
      } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);
    }
  
    return methods;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/descriptors.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/descriptors.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  
  // Detect IE8's incomplete defineProperty implementation
  module.exports = !fails(function () {
    return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/document-create-element.js":
  /*!***************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/document-create-element.js ***!
    \***************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var isObject = __webpack_require__(/*! ../internals/is-object */ "../../ui-core/node_modules/core-js/internals/is-object.js");
  
  var document = global.document;
  // typeof document.createElement is 'object' in old IE
  var EXISTS = isObject(document) && isObject(document.createElement);
  
  module.exports = function (it) {
    return EXISTS ? document.createElement(it) : {};
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/enum-bug-keys.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/enum-bug-keys.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // IE8- don't enum bug keys
  module.exports = [
    'constructor',
    'hasOwnProperty',
    'isPrototypeOf',
    'propertyIsEnumerable',
    'toLocaleString',
    'toString',
    'valueOf'
  ];
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/export.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/export.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var getOwnPropertyDescriptor = __webpack_require__(/*! ../internals/object-get-own-property-descriptor */ "../../ui-core/node_modules/core-js/internals/object-get-own-property-descriptor.js").f;
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  var redefine = __webpack_require__(/*! ../internals/redefine */ "../../ui-core/node_modules/core-js/internals/redefine.js");
  var setGlobal = __webpack_require__(/*! ../internals/set-global */ "../../ui-core/node_modules/core-js/internals/set-global.js");
  var copyConstructorProperties = __webpack_require__(/*! ../internals/copy-constructor-properties */ "../../ui-core/node_modules/core-js/internals/copy-constructor-properties.js");
  var isForced = __webpack_require__(/*! ../internals/is-forced */ "../../ui-core/node_modules/core-js/internals/is-forced.js");
  
  /*
    options.target      - name of the target object
    options.global      - target is the global object
    options.stat        - export as static methods of target
    options.proto       - export as prototype methods of target
    options.real        - real prototype method for the `pure` version
    options.forced      - export even if the native feature is available
    options.bind        - bind methods to the target, required for the `pure` version
    options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version
    options.unsafe      - use the simple assignment of property instead of delete + defineProperty
    options.sham        - add a flag to not completely full polyfills
    options.enumerable  - export as enumerable property
    options.noTargetGet - prevent calling a getter on target
  */
  module.exports = function (options, source) {
    var TARGET = options.target;
    var GLOBAL = options.global;
    var STATIC = options.stat;
    var FORCED, target, key, targetProperty, sourceProperty, descriptor;
    if (GLOBAL) {
      target = global;
    } else if (STATIC) {
      target = global[TARGET] || setGlobal(TARGET, {});
    } else {
      target = (global[TARGET] || {}).prototype;
    }
    if (target) for (key in source) {
      sourceProperty = source[key];
      if (options.noTargetGet) {
        descriptor = getOwnPropertyDescriptor(target, key);
        targetProperty = descriptor && descriptor.value;
      } else targetProperty = target[key];
      FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);
      // contained in target
      if (!FORCED && targetProperty !== undefined) {
        if (typeof sourceProperty === typeof targetProperty) continue;
        copyConstructorProperties(sourceProperty, targetProperty);
      }
      // add a flag to not completely full polyfills
      if (options.sham || (targetProperty && targetProperty.sham)) {
        createNonEnumerableProperty(sourceProperty, 'sham', true);
      }
      // extend global
      redefine(target, key, sourceProperty, options);
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/fails.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/fails.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = function (exec) {
    try {
      return !!exec();
    } catch (error) {
      return true;
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/function-bind-context.js":
  /*!*************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/function-bind-context.js ***!
    \*************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var aFunction = __webpack_require__(/*! ../internals/a-function */ "../../ui-core/node_modules/core-js/internals/a-function.js");
  
  // optional / simple context binding
  module.exports = function (fn, that, length) {
    aFunction(fn);
    if (that === undefined) return fn;
    switch (length) {
      case 0: return function () {
        return fn.call(that);
      };
      case 1: return function (a) {
        return fn.call(that, a);
      };
      case 2: return function (a, b) {
        return fn.call(that, a, b);
      };
      case 3: return function (a, b, c) {
        return fn.call(that, a, b, c);
      };
    }
    return function (/* ...args */) {
      return fn.apply(that, arguments);
    };
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/get-built-in.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/get-built-in.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var path = __webpack_require__(/*! ../internals/path */ "../../ui-core/node_modules/core-js/internals/path.js");
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  
  var aFunction = function (variable) {
    return typeof variable == 'function' ? variable : undefined;
  };
  
  module.exports = function (namespace, method) {
    return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])
      : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/get-iterator-method.js":
  /*!***********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/get-iterator-method.js ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var classof = __webpack_require__(/*! ../internals/classof */ "../../ui-core/node_modules/core-js/internals/classof.js");
  var Iterators = __webpack_require__(/*! ../internals/iterators */ "../../ui-core/node_modules/core-js/internals/iterators.js");
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  
  var ITERATOR = wellKnownSymbol('iterator');
  
  module.exports = function (it) {
    if (it != undefined) return it[ITERATOR]
      || it['@@iterator']
      || Iterators[classof(it)];
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/global.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/global.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global) {var check = function (it) {
    return it && it.Math == Math && it;
  };
  
  // https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
  module.exports =
    // eslint-disable-next-line no-undef
    check(typeof globalThis == 'object' && globalThis) ||
    check(typeof window == 'object' && window) ||
    check(typeof self == 'object' && self) ||
    check(typeof global == 'object' && global) ||
    // eslint-disable-next-line no-new-func
    (function () { return this; })() || Function('return this')();
  
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/has.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/has.js ***!
    \*******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var hasOwnProperty = {}.hasOwnProperty;
  
  module.exports = function (it, key) {
    return hasOwnProperty.call(it, key);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/hidden-keys.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/hidden-keys.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = {};
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/html.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/html.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var getBuiltIn = __webpack_require__(/*! ../internals/get-built-in */ "../../ui-core/node_modules/core-js/internals/get-built-in.js");
  
  module.exports = getBuiltIn('document', 'documentElement');
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/ie8-dom-define.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/ie8-dom-define.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  var createElement = __webpack_require__(/*! ../internals/document-create-element */ "../../ui-core/node_modules/core-js/internals/document-create-element.js");
  
  // Thank's IE8 for his funny defineProperty
  module.exports = !DESCRIPTORS && !fails(function () {
    return Object.defineProperty(createElement('div'), 'a', {
      get: function () { return 7; }
    }).a != 7;
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/indexed-object.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/indexed-object.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  var classof = __webpack_require__(/*! ../internals/classof-raw */ "../../ui-core/node_modules/core-js/internals/classof-raw.js");
  
  var split = ''.split;
  
  // fallback for non-array-like ES3 and non-enumerable old V8 strings
  module.exports = fails(function () {
    // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346
    // eslint-disable-next-line no-prototype-builtins
    return !Object('z').propertyIsEnumerable(0);
  }) ? function (it) {
    return classof(it) == 'String' ? split.call(it, '') : Object(it);
  } : Object;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/inspect-source.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/inspect-source.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var store = __webpack_require__(/*! ../internals/shared-store */ "../../ui-core/node_modules/core-js/internals/shared-store.js");
  
  var functionToString = Function.toString;
  
  // this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper
  if (typeof store.inspectSource != 'function') {
    store.inspectSource = function (it) {
      return functionToString.call(it);
    };
  }
  
  module.exports = store.inspectSource;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/internal-state.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/internal-state.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var NATIVE_WEAK_MAP = __webpack_require__(/*! ../internals/native-weak-map */ "../../ui-core/node_modules/core-js/internals/native-weak-map.js");
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var isObject = __webpack_require__(/*! ../internals/is-object */ "../../ui-core/node_modules/core-js/internals/is-object.js");
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  var objectHas = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var shared = __webpack_require__(/*! ../internals/shared-store */ "../../ui-core/node_modules/core-js/internals/shared-store.js");
  var sharedKey = __webpack_require__(/*! ../internals/shared-key */ "../../ui-core/node_modules/core-js/internals/shared-key.js");
  var hiddenKeys = __webpack_require__(/*! ../internals/hidden-keys */ "../../ui-core/node_modules/core-js/internals/hidden-keys.js");
  
  var WeakMap = global.WeakMap;
  var set, get, has;
  
  var enforce = function (it) {
    return has(it) ? get(it) : set(it, {});
  };
  
  var getterFor = function (TYPE) {
    return function (it) {
      var state;
      if (!isObject(it) || (state = get(it)).type !== TYPE) {
        throw TypeError('Incompatible receiver, ' + TYPE + ' required');
      } return state;
    };
  };
  
  if (NATIVE_WEAK_MAP) {
    var store = shared.state || (shared.state = new WeakMap());
    var wmget = store.get;
    var wmhas = store.has;
    var wmset = store.set;
    set = function (it, metadata) {
      metadata.facade = it;
      wmset.call(store, it, metadata);
      return metadata;
    };
    get = function (it) {
      return wmget.call(store, it) || {};
    };
    has = function (it) {
      return wmhas.call(store, it);
    };
  } else {
    var STATE = sharedKey('state');
    hiddenKeys[STATE] = true;
    set = function (it, metadata) {
      metadata.facade = it;
      createNonEnumerableProperty(it, STATE, metadata);
      return metadata;
    };
    get = function (it) {
      return objectHas(it, STATE) ? it[STATE] : {};
    };
    has = function (it) {
      return objectHas(it, STATE);
    };
  }
  
  module.exports = {
    set: set,
    get: get,
    has: has,
    enforce: enforce,
    getterFor: getterFor
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/is-array-iterator-method.js":
  /*!****************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/is-array-iterator-method.js ***!
    \****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  var Iterators = __webpack_require__(/*! ../internals/iterators */ "../../ui-core/node_modules/core-js/internals/iterators.js");
  
  var ITERATOR = wellKnownSymbol('iterator');
  var ArrayPrototype = Array.prototype;
  
  // check on default Array iterator
  module.exports = function (it) {
    return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/is-forced.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/is-forced.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  
  var replacement = /#|\.prototype\./;
  
  var isForced = function (feature, detection) {
    var value = data[normalize(feature)];
    return value == POLYFILL ? true
      : value == NATIVE ? false
      : typeof detection == 'function' ? fails(detection)
      : !!detection;
  };
  
  var normalize = isForced.normalize = function (string) {
    return String(string).replace(replacement, '.').toLowerCase();
  };
  
  var data = isForced.data = {};
  var NATIVE = isForced.NATIVE = 'N';
  var POLYFILL = isForced.POLYFILL = 'P';
  
  module.exports = isForced;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/is-object.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/is-object.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = function (it) {
    return typeof it === 'object' ? it !== null : typeof it === 'function';
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/is-pure.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/is-pure.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = false;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/iterator-close.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/iterator-close.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  
  module.exports = function (iterator) {
    var returnMethod = iterator['return'];
    if (returnMethod !== undefined) {
      return anObject(returnMethod.call(iterator)).value;
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/iterators-core.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/iterators-core.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  var getPrototypeOf = __webpack_require__(/*! ../internals/object-get-prototype-of */ "../../ui-core/node_modules/core-js/internals/object-get-prototype-of.js");
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  var IS_PURE = __webpack_require__(/*! ../internals/is-pure */ "../../ui-core/node_modules/core-js/internals/is-pure.js");
  
  var ITERATOR = wellKnownSymbol('iterator');
  var BUGGY_SAFARI_ITERATORS = false;
  
  var returnThis = function () { return this; };
  
  // `%IteratorPrototype%` object
  // https://tc39.es/ecma262/#sec-%iteratorprototype%-object
  var IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;
  
  if ([].keys) {
    arrayIterator = [].keys();
    // Safari 8 has buggy iterators w/o `next`
    if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;
    else {
      PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));
      if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;
    }
  }
  
  var NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {
    var test = {};
    // FF44- legacy iterators case
    return IteratorPrototype[ITERATOR].call(test) !== test;
  });
  
  if (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};
  
  // 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
  if ((!IS_PURE || NEW_ITERATOR_PROTOTYPE) && !has(IteratorPrototype, ITERATOR)) {
    createNonEnumerableProperty(IteratorPrototype, ITERATOR, returnThis);
  }
  
  module.exports = {
    IteratorPrototype: IteratorPrototype,
    BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/iterators.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/iterators.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = {};
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/native-symbol.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/native-symbol.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  
  module.exports = !!Object.getOwnPropertySymbols && !fails(function () {
    // Chrome 38 Symbol has incorrect toString conversion
    // eslint-disable-next-line no-undef
    return !String(Symbol());
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/native-weak-map.js":
  /*!*******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/native-weak-map.js ***!
    \*******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var inspectSource = __webpack_require__(/*! ../internals/inspect-source */ "../../ui-core/node_modules/core-js/internals/inspect-source.js");
  
  var WeakMap = global.WeakMap;
  
  module.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-assign.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-assign.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var fails = __webpack_require__(/*! ../internals/fails */ "../../ui-core/node_modules/core-js/internals/fails.js");
  var objectKeys = __webpack_require__(/*! ../internals/object-keys */ "../../ui-core/node_modules/core-js/internals/object-keys.js");
  var getOwnPropertySymbolsModule = __webpack_require__(/*! ../internals/object-get-own-property-symbols */ "../../ui-core/node_modules/core-js/internals/object-get-own-property-symbols.js");
  var propertyIsEnumerableModule = __webpack_require__(/*! ../internals/object-property-is-enumerable */ "../../ui-core/node_modules/core-js/internals/object-property-is-enumerable.js");
  var toObject = __webpack_require__(/*! ../internals/to-object */ "../../ui-core/node_modules/core-js/internals/to-object.js");
  var IndexedObject = __webpack_require__(/*! ../internals/indexed-object */ "../../ui-core/node_modules/core-js/internals/indexed-object.js");
  
  var nativeAssign = Object.assign;
  var defineProperty = Object.defineProperty;
  
  // `Object.assign` method
  // https://tc39.es/ecma262/#sec-object.assign
  module.exports = !nativeAssign || fails(function () {
    // should have correct order of operations (Edge bug)
    if (DESCRIPTORS && nativeAssign({ b: 1 }, nativeAssign(defineProperty({}, 'a', {
      enumerable: true,
      get: function () {
        defineProperty(this, 'b', {
          value: 3,
          enumerable: false
        });
      }
    }), { b: 2 })).b !== 1) return true;
    // should work with symbols and should have deterministic property order (V8 bug)
    var A = {};
    var B = {};
    // eslint-disable-next-line no-undef
    var symbol = Symbol();
    var alphabet = 'abcdefghijklmnopqrst';
    A[symbol] = 7;
    alphabet.split('').forEach(function (chr) { B[chr] = chr; });
    return nativeAssign({}, A)[symbol] != 7 || objectKeys(nativeAssign({}, B)).join('') != alphabet;
  }) ? function assign(target, source) { // eslint-disable-line no-unused-vars
    var T = toObject(target);
    var argumentsLength = arguments.length;
    var index = 1;
    var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;
    var propertyIsEnumerable = propertyIsEnumerableModule.f;
    while (argumentsLength > index) {
      var S = IndexedObject(arguments[index++]);
      var keys = getOwnPropertySymbols ? objectKeys(S).concat(getOwnPropertySymbols(S)) : objectKeys(S);
      var length = keys.length;
      var j = 0;
      var key;
      while (length > j) {
        key = keys[j++];
        if (!DESCRIPTORS || propertyIsEnumerable.call(S, key)) T[key] = S[key];
      }
    } return T;
  } : nativeAssign;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-create.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-create.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  var defineProperties = __webpack_require__(/*! ../internals/object-define-properties */ "../../ui-core/node_modules/core-js/internals/object-define-properties.js");
  var enumBugKeys = __webpack_require__(/*! ../internals/enum-bug-keys */ "../../ui-core/node_modules/core-js/internals/enum-bug-keys.js");
  var hiddenKeys = __webpack_require__(/*! ../internals/hidden-keys */ "../../ui-core/node_modules/core-js/internals/hidden-keys.js");
  var html = __webpack_require__(/*! ../internals/html */ "../../ui-core/node_modules/core-js/internals/html.js");
  var documentCreateElement = __webpack_require__(/*! ../internals/document-create-element */ "../../ui-core/node_modules/core-js/internals/document-create-element.js");
  var sharedKey = __webpack_require__(/*! ../internals/shared-key */ "../../ui-core/node_modules/core-js/internals/shared-key.js");
  
  var GT = '>';
  var LT = '<';
  var PROTOTYPE = 'prototype';
  var SCRIPT = 'script';
  var IE_PROTO = sharedKey('IE_PROTO');
  
  var EmptyConstructor = function () { /* empty */ };
  
  var scriptTag = function (content) {
    return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;
  };
  
  // Create object with fake `null` prototype: use ActiveX Object with cleared prototype
  var NullProtoObjectViaActiveX = function (activeXDocument) {
    activeXDocument.write(scriptTag(''));
    activeXDocument.close();
    var temp = activeXDocument.parentWindow.Object;
    activeXDocument = null; // avoid memory leak
    return temp;
  };
  
  // Create object with fake `null` prototype: use iframe Object with cleared prototype
  var NullProtoObjectViaIFrame = function () {
    // Thrash, waste and sodomy: IE GC bug
    var iframe = documentCreateElement('iframe');
    var JS = 'java' + SCRIPT + ':';
    var iframeDocument;
    iframe.style.display = 'none';
    html.appendChild(iframe);
    // https://github.com/zloirock/core-js/issues/475
    iframe.src = String(JS);
    iframeDocument = iframe.contentWindow.document;
    iframeDocument.open();
    iframeDocument.write(scriptTag('document.F=Object'));
    iframeDocument.close();
    return iframeDocument.F;
  };
  
  // Check for document.domain and active x support
  // No need to use active x approach when document.domain is not set
  // see https://github.com/es-shims/es5-shim/issues/150
  // variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346
  // avoid IE GC bug
  var activeXDocument;
  var NullProtoObject = function () {
    try {
      /* global ActiveXObject */
      activeXDocument = document.domain && new ActiveXObject('htmlfile');
    } catch (error) { /* ignore */ }
    NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();
    var length = enumBugKeys.length;
    while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];
    return NullProtoObject();
  };
  
  hiddenKeys[IE_PROTO] = true;
  
  // `Object.create` method
  // https://tc39.es/ecma262/#sec-object.create
  module.exports = Object.create || function create(O, Properties) {
    var result;
    if (O !== null) {
      EmptyConstructor[PROTOTYPE] = anObject(O);
      result = new EmptyConstructor();
      EmptyConstructor[PROTOTYPE] = null;
      // add "__proto__" for Object.getPrototypeOf polyfill
      result[IE_PROTO] = O;
    } else result = NullProtoObject();
    return Properties === undefined ? result : defineProperties(result, Properties);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-define-properties.js":
  /*!****************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-define-properties.js ***!
    \****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "../../ui-core/node_modules/core-js/internals/object-define-property.js");
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  var objectKeys = __webpack_require__(/*! ../internals/object-keys */ "../../ui-core/node_modules/core-js/internals/object-keys.js");
  
  // `Object.defineProperties` method
  // https://tc39.es/ecma262/#sec-object.defineproperties
  module.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {
    anObject(O);
    var keys = objectKeys(Properties);
    var length = keys.length;
    var index = 0;
    var key;
    while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);
    return O;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-define-property.js":
  /*!**************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-define-property.js ***!
    \**************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var IE8_DOM_DEFINE = __webpack_require__(/*! ../internals/ie8-dom-define */ "../../ui-core/node_modules/core-js/internals/ie8-dom-define.js");
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  var toPrimitive = __webpack_require__(/*! ../internals/to-primitive */ "../../ui-core/node_modules/core-js/internals/to-primitive.js");
  
  var nativeDefineProperty = Object.defineProperty;
  
  // `Object.defineProperty` method
  // https://tc39.es/ecma262/#sec-object.defineproperty
  exports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {
    anObject(O);
    P = toPrimitive(P, true);
    anObject(Attributes);
    if (IE8_DOM_DEFINE) try {
      return nativeDefineProperty(O, P, Attributes);
    } catch (error) { /* empty */ }
    if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');
    if ('value' in Attributes) O[P] = Attributes.value;
    return O;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-get-own-property-descriptor.js":
  /*!**************************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-get-own-property-descriptor.js ***!
    \**************************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "../../ui-core/node_modules/core-js/internals/descriptors.js");
  var propertyIsEnumerableModule = __webpack_require__(/*! ../internals/object-property-is-enumerable */ "../../ui-core/node_modules/core-js/internals/object-property-is-enumerable.js");
  var createPropertyDescriptor = __webpack_require__(/*! ../internals/create-property-descriptor */ "../../ui-core/node_modules/core-js/internals/create-property-descriptor.js");
  var toIndexedObject = __webpack_require__(/*! ../internals/to-indexed-object */ "../../ui-core/node_modules/core-js/internals/to-indexed-object.js");
  var toPrimitive = __webpack_require__(/*! ../internals/to-primitive */ "../../ui-core/node_modules/core-js/internals/to-primitive.js");
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var IE8_DOM_DEFINE = __webpack_require__(/*! ../internals/ie8-dom-define */ "../../ui-core/node_modules/core-js/internals/ie8-dom-define.js");
  
  var nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
  
  // `Object.getOwnPropertyDescriptor` method
  // https://tc39.es/ecma262/#sec-object.getownpropertydescriptor
  exports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {
    O = toIndexedObject(O);
    P = toPrimitive(P, true);
    if (IE8_DOM_DEFINE) try {
      return nativeGetOwnPropertyDescriptor(O, P);
    } catch (error) { /* empty */ }
    if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-get-own-property-names.js":
  /*!*********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-get-own-property-names.js ***!
    \*********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var internalObjectKeys = __webpack_require__(/*! ../internals/object-keys-internal */ "../../ui-core/node_modules/core-js/internals/object-keys-internal.js");
  var enumBugKeys = __webpack_require__(/*! ../internals/enum-bug-keys */ "../../ui-core/node_modules/core-js/internals/enum-bug-keys.js");
  
  var hiddenKeys = enumBugKeys.concat('length', 'prototype');
  
  // `Object.getOwnPropertyNames` method
  // https://tc39.es/ecma262/#sec-object.getownpropertynames
  exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
    return internalObjectKeys(O, hiddenKeys);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-get-own-property-symbols.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-get-own-property-symbols.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  exports.f = Object.getOwnPropertySymbols;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-get-prototype-of.js":
  /*!***************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-get-prototype-of.js ***!
    \***************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var toObject = __webpack_require__(/*! ../internals/to-object */ "../../ui-core/node_modules/core-js/internals/to-object.js");
  var sharedKey = __webpack_require__(/*! ../internals/shared-key */ "../../ui-core/node_modules/core-js/internals/shared-key.js");
  var CORRECT_PROTOTYPE_GETTER = __webpack_require__(/*! ../internals/correct-prototype-getter */ "../../ui-core/node_modules/core-js/internals/correct-prototype-getter.js");
  
  var IE_PROTO = sharedKey('IE_PROTO');
  var ObjectPrototype = Object.prototype;
  
  // `Object.getPrototypeOf` method
  // https://tc39.es/ecma262/#sec-object.getprototypeof
  module.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {
    O = toObject(O);
    if (has(O, IE_PROTO)) return O[IE_PROTO];
    if (typeof O.constructor == 'function' && O instanceof O.constructor) {
      return O.constructor.prototype;
    } return O instanceof Object ? ObjectPrototype : null;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-keys-internal.js":
  /*!************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-keys-internal.js ***!
    \************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var toIndexedObject = __webpack_require__(/*! ../internals/to-indexed-object */ "../../ui-core/node_modules/core-js/internals/to-indexed-object.js");
  var indexOf = __webpack_require__(/*! ../internals/array-includes */ "../../ui-core/node_modules/core-js/internals/array-includes.js").indexOf;
  var hiddenKeys = __webpack_require__(/*! ../internals/hidden-keys */ "../../ui-core/node_modules/core-js/internals/hidden-keys.js");
  
  module.exports = function (object, names) {
    var O = toIndexedObject(object);
    var i = 0;
    var result = [];
    var key;
    for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);
    // Don't enum bug & hidden keys
    while (names.length > i) if (has(O, key = names[i++])) {
      ~indexOf(result, key) || result.push(key);
    }
    return result;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-keys.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-keys.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var internalObjectKeys = __webpack_require__(/*! ../internals/object-keys-internal */ "../../ui-core/node_modules/core-js/internals/object-keys-internal.js");
  var enumBugKeys = __webpack_require__(/*! ../internals/enum-bug-keys */ "../../ui-core/node_modules/core-js/internals/enum-bug-keys.js");
  
  // `Object.keys` method
  // https://tc39.es/ecma262/#sec-object.keys
  module.exports = Object.keys || function keys(O) {
    return internalObjectKeys(O, enumBugKeys);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-property-is-enumerable.js":
  /*!*********************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-property-is-enumerable.js ***!
    \*********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var nativePropertyIsEnumerable = {}.propertyIsEnumerable;
  var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
  
  // Nashorn ~ JDK8 bug
  var NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);
  
  // `Object.prototype.propertyIsEnumerable` method implementation
  // https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable
  exports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {
    var descriptor = getOwnPropertyDescriptor(this, V);
    return !!descriptor && descriptor.enumerable;
  } : nativePropertyIsEnumerable;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/object-set-prototype-of.js":
  /*!***************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/object-set-prototype-of.js ***!
    \***************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  var aPossiblePrototype = __webpack_require__(/*! ../internals/a-possible-prototype */ "../../ui-core/node_modules/core-js/internals/a-possible-prototype.js");
  
  // `Object.setPrototypeOf` method
  // https://tc39.es/ecma262/#sec-object.setprototypeof
  // Works with __proto__ only. Old v8 can't work with null proto objects.
  /* eslint-disable no-proto */
  module.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {
    var CORRECT_SETTER = false;
    var test = {};
    var setter;
    try {
      setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;
      setter.call(test, []);
      CORRECT_SETTER = test instanceof Array;
    } catch (error) { /* empty */ }
    return function setPrototypeOf(O, proto) {
      anObject(O);
      aPossiblePrototype(proto);
      if (CORRECT_SETTER) setter.call(O, proto);
      else O.__proto__ = proto;
      return O;
    };
  }() : undefined);
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/own-keys.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/own-keys.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var getBuiltIn = __webpack_require__(/*! ../internals/get-built-in */ "../../ui-core/node_modules/core-js/internals/get-built-in.js");
  var getOwnPropertyNamesModule = __webpack_require__(/*! ../internals/object-get-own-property-names */ "../../ui-core/node_modules/core-js/internals/object-get-own-property-names.js");
  var getOwnPropertySymbolsModule = __webpack_require__(/*! ../internals/object-get-own-property-symbols */ "../../ui-core/node_modules/core-js/internals/object-get-own-property-symbols.js");
  var anObject = __webpack_require__(/*! ../internals/an-object */ "../../ui-core/node_modules/core-js/internals/an-object.js");
  
  // all object keys, includes non-enumerable and symbols
  module.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {
    var keys = getOwnPropertyNamesModule.f(anObject(it));
    var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;
    return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/path.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/path.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  
  module.exports = global;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/redefine.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/redefine.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var setGlobal = __webpack_require__(/*! ../internals/set-global */ "../../ui-core/node_modules/core-js/internals/set-global.js");
  var inspectSource = __webpack_require__(/*! ../internals/inspect-source */ "../../ui-core/node_modules/core-js/internals/inspect-source.js");
  var InternalStateModule = __webpack_require__(/*! ../internals/internal-state */ "../../ui-core/node_modules/core-js/internals/internal-state.js");
  
  var getInternalState = InternalStateModule.get;
  var enforceInternalState = InternalStateModule.enforce;
  var TEMPLATE = String(String).split('String');
  
  (module.exports = function (O, key, value, options) {
    var unsafe = options ? !!options.unsafe : false;
    var simple = options ? !!options.enumerable : false;
    var noTargetGet = options ? !!options.noTargetGet : false;
    var state;
    if (typeof value == 'function') {
      if (typeof key == 'string' && !has(value, 'name')) {
        createNonEnumerableProperty(value, 'name', key);
      }
      state = enforceInternalState(value);
      if (!state.source) {
        state.source = TEMPLATE.join(typeof key == 'string' ? key : '');
      }
    }
    if (O === global) {
      if (simple) O[key] = value;
      else setGlobal(key, value);
      return;
    } else if (!unsafe) {
      delete O[key];
    } else if (!noTargetGet && O[key]) {
      simple = true;
    }
    if (simple) O[key] = value;
    else createNonEnumerableProperty(O, key, value);
  // add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
  })(Function.prototype, 'toString', function toString() {
    return typeof this == 'function' && getInternalState(this).source || inspectSource(this);
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/require-object-coercible.js":
  /*!****************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/require-object-coercible.js ***!
    \****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // `RequireObjectCoercible` abstract operation
  // https://tc39.es/ecma262/#sec-requireobjectcoercible
  module.exports = function (it) {
    if (it == undefined) throw TypeError("Can't call method on " + it);
    return it;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/set-global.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/set-global.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var createNonEnumerableProperty = __webpack_require__(/*! ../internals/create-non-enumerable-property */ "../../ui-core/node_modules/core-js/internals/create-non-enumerable-property.js");
  
  module.exports = function (key, value) {
    try {
      createNonEnumerableProperty(global, key, value);
    } catch (error) {
      global[key] = value;
    } return value;
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/set-to-string-tag.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/set-to-string-tag.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var defineProperty = __webpack_require__(/*! ../internals/object-define-property */ "../../ui-core/node_modules/core-js/internals/object-define-property.js").f;
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  
  var TO_STRING_TAG = wellKnownSymbol('toStringTag');
  
  module.exports = function (it, TAG, STATIC) {
    if (it && !has(it = STATIC ? it : it.prototype, TO_STRING_TAG)) {
      defineProperty(it, TO_STRING_TAG, { configurable: true, value: TAG });
    }
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/shared-key.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/shared-key.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var shared = __webpack_require__(/*! ../internals/shared */ "../../ui-core/node_modules/core-js/internals/shared.js");
  var uid = __webpack_require__(/*! ../internals/uid */ "../../ui-core/node_modules/core-js/internals/uid.js");
  
  var keys = shared('keys');
  
  module.exports = function (key) {
    return keys[key] || (keys[key] = uid(key));
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/shared-store.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/shared-store.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var setGlobal = __webpack_require__(/*! ../internals/set-global */ "../../ui-core/node_modules/core-js/internals/set-global.js");
  
  var SHARED = '__core-js_shared__';
  var store = global[SHARED] || setGlobal(SHARED, {});
  
  module.exports = store;
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/shared.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/shared.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var IS_PURE = __webpack_require__(/*! ../internals/is-pure */ "../../ui-core/node_modules/core-js/internals/is-pure.js");
  var store = __webpack_require__(/*! ../internals/shared-store */ "../../ui-core/node_modules/core-js/internals/shared-store.js");
  
  (module.exports = function (key, value) {
    return store[key] || (store[key] = value !== undefined ? value : {});
  })('versions', []).push({
    version: '3.8.3',
    mode: IS_PURE ? 'pure' : 'global',
    copyright: ' 2021 Denis Pushkarev (zloirock.ru)'
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/string-multibyte.js":
  /*!********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/string-multibyte.js ***!
    \********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var toInteger = __webpack_require__(/*! ../internals/to-integer */ "../../ui-core/node_modules/core-js/internals/to-integer.js");
  var requireObjectCoercible = __webpack_require__(/*! ../internals/require-object-coercible */ "../../ui-core/node_modules/core-js/internals/require-object-coercible.js");
  
  // `String.prototype.{ codePointAt, at }` methods implementation
  var createMethod = function (CONVERT_TO_STRING) {
    return function ($this, pos) {
      var S = String(requireObjectCoercible($this));
      var position = toInteger(pos);
      var size = S.length;
      var first, second;
      if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;
      first = S.charCodeAt(position);
      return first < 0xD800 || first > 0xDBFF || position + 1 === size
        || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF
          ? CONVERT_TO_STRING ? S.charAt(position) : first
          : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;
    };
  };
  
  module.exports = {
    // `String.prototype.codePointAt` method
    // https://tc39.es/ecma262/#sec-string.prototype.codepointat
    codeAt: createMethod(false),
    // `String.prototype.at` method
    // https://github.com/mathiasbynens/String.prototype.at
    charAt: createMethod(true)
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-absolute-index.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-absolute-index.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var toInteger = __webpack_require__(/*! ../internals/to-integer */ "../../ui-core/node_modules/core-js/internals/to-integer.js");
  
  var max = Math.max;
  var min = Math.min;
  
  // Helper for a popular repeating case of the spec:
  // Let integer be ? ToInteger(index).
  // If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).
  module.exports = function (index, length) {
    var integer = toInteger(index);
    return integer < 0 ? max(integer + length, 0) : min(integer, length);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-indexed-object.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-indexed-object.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  // toObject with fallback for non-array-like ES3 strings
  var IndexedObject = __webpack_require__(/*! ../internals/indexed-object */ "../../ui-core/node_modules/core-js/internals/indexed-object.js");
  var requireObjectCoercible = __webpack_require__(/*! ../internals/require-object-coercible */ "../../ui-core/node_modules/core-js/internals/require-object-coercible.js");
  
  module.exports = function (it) {
    return IndexedObject(requireObjectCoercible(it));
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-integer.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-integer.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var ceil = Math.ceil;
  var floor = Math.floor;
  
  // `ToInteger` abstract operation
  // https://tc39.es/ecma262/#sec-tointeger
  module.exports = function (argument) {
    return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-length.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-length.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var toInteger = __webpack_require__(/*! ../internals/to-integer */ "../../ui-core/node_modules/core-js/internals/to-integer.js");
  
  var min = Math.min;
  
  // `ToLength` abstract operation
  // https://tc39.es/ecma262/#sec-tolength
  module.exports = function (argument) {
    return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-object.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-object.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var requireObjectCoercible = __webpack_require__(/*! ../internals/require-object-coercible */ "../../ui-core/node_modules/core-js/internals/require-object-coercible.js");
  
  // `ToObject` abstract operation
  // https://tc39.es/ecma262/#sec-toobject
  module.exports = function (argument) {
    return Object(requireObjectCoercible(argument));
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-primitive.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-primitive.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var isObject = __webpack_require__(/*! ../internals/is-object */ "../../ui-core/node_modules/core-js/internals/is-object.js");
  
  // `ToPrimitive` abstract operation
  // https://tc39.es/ecma262/#sec-toprimitive
  // instead of the ES6 spec version, we didn't implement @@toPrimitive case
  // and the second argument - flag - preferred type is a string
  module.exports = function (input, PREFERRED_STRING) {
    if (!isObject(input)) return input;
    var fn, val;
    if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;
    if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;
    if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;
    throw TypeError("Can't convert object to primitive value");
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/to-string-tag-support.js":
  /*!*************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/to-string-tag-support.js ***!
    \*************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js");
  
  var TO_STRING_TAG = wellKnownSymbol('toStringTag');
  var test = {};
  
  test[TO_STRING_TAG] = 'z';
  
  module.exports = String(test) === '[object z]';
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/uid.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/uid.js ***!
    \*******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var id = 0;
  var postfix = Math.random();
  
  module.exports = function (key) {
    return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/use-symbol-as-uid.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/use-symbol-as-uid.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var NATIVE_SYMBOL = __webpack_require__(/*! ../internals/native-symbol */ "../../ui-core/node_modules/core-js/internals/native-symbol.js");
  
  module.exports = NATIVE_SYMBOL
    // eslint-disable-next-line no-undef
    && !Symbol.sham
    // eslint-disable-next-line no-undef
    && typeof Symbol.iterator == 'symbol';
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/internals/well-known-symbol.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/internals/well-known-symbol.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var global = __webpack_require__(/*! ../internals/global */ "../../ui-core/node_modules/core-js/internals/global.js");
  var shared = __webpack_require__(/*! ../internals/shared */ "../../ui-core/node_modules/core-js/internals/shared.js");
  var has = __webpack_require__(/*! ../internals/has */ "../../ui-core/node_modules/core-js/internals/has.js");
  var uid = __webpack_require__(/*! ../internals/uid */ "../../ui-core/node_modules/core-js/internals/uid.js");
  var NATIVE_SYMBOL = __webpack_require__(/*! ../internals/native-symbol */ "../../ui-core/node_modules/core-js/internals/native-symbol.js");
  var USE_SYMBOL_AS_UID = __webpack_require__(/*! ../internals/use-symbol-as-uid */ "../../ui-core/node_modules/core-js/internals/use-symbol-as-uid.js");
  
  var WellKnownSymbolsStore = shared('wks');
  var Symbol = global.Symbol;
  var createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;
  
  module.exports = function (name) {
    if (!has(WellKnownSymbolsStore, name)) {
      if (NATIVE_SYMBOL && has(Symbol, name)) WellKnownSymbolsStore[name] = Symbol[name];
      else WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);
    } return WellKnownSymbolsStore[name];
  };
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/modules/es.array.from.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/modules/es.array.from.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var $ = __webpack_require__(/*! ../internals/export */ "../../ui-core/node_modules/core-js/internals/export.js");
  var from = __webpack_require__(/*! ../internals/array-from */ "../../ui-core/node_modules/core-js/internals/array-from.js");
  var checkCorrectnessOfIteration = __webpack_require__(/*! ../internals/check-correctness-of-iteration */ "../../ui-core/node_modules/core-js/internals/check-correctness-of-iteration.js");
  
  var INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {
    Array.from(iterable);
  });
  
  // `Array.from` method
  // https://tc39.es/ecma262/#sec-array.from
  $({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {
    from: from
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/modules/es.object.assign.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/modules/es.object.assign.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var $ = __webpack_require__(/*! ../internals/export */ "../../ui-core/node_modules/core-js/internals/export.js");
  var assign = __webpack_require__(/*! ../internals/object-assign */ "../../ui-core/node_modules/core-js/internals/object-assign.js");
  
  // `Object.assign` method
  // https://tc39.es/ecma262/#sec-object.assign
  $({ target: 'Object', stat: true, forced: Object.assign !== assign }, {
    assign: assign
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/core-js/modules/es.string.iterator.js":
  /*!********************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/core-js/modules/es.string.iterator.js ***!
    \********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  "use strict";
  
  var charAt = __webpack_require__(/*! ../internals/string-multibyte */ "../../ui-core/node_modules/core-js/internals/string-multibyte.js").charAt;
  var InternalStateModule = __webpack_require__(/*! ../internals/internal-state */ "../../ui-core/node_modules/core-js/internals/internal-state.js");
  var defineIterator = __webpack_require__(/*! ../internals/define-iterator */ "../../ui-core/node_modules/core-js/internals/define-iterator.js");
  
  var STRING_ITERATOR = 'String Iterator';
  var setInternalState = InternalStateModule.set;
  var getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);
  
  // `String.prototype[@@iterator]` method
  // https://tc39.es/ecma262/#sec-string.prototype-@@iterator
  defineIterator(String, 'String', function (iterated) {
    setInternalState(this, {
      type: STRING_ITERATOR,
      string: String(iterated),
      index: 0
    });
  // `%StringIteratorPrototype%.next` method
  // https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next
  }, function next() {
    var state = getInternalState(this);
    var string = state.string;
    var index = state.index;
    var point;
    if (index >= string.length) return { value: undefined, done: true };
    point = charAt(string, index);
    state.index += point.length;
    return { value: point, done: false };
  });
  
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/element-closest-polyfill/index.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/element-closest-polyfill/index.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
  }
  
  if (!Element.prototype.closest) {
    Element.prototype.closest = function (s) {
      var el = this;
  
      do {
        if (el.matches(s)) return el;
        el = el.parentElement || el.parentNode;
      } while (el !== null && el.nodeType === 1);
  
      return null;
    };
  }
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/fontfaceobserver/fontfaceobserver.standalone.js":
  /*!******************************************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/fontfaceobserver/fontfaceobserver.standalone.js ***!
    \******************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(module) {var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /* Font Face Observer v2.1.0 -  Bram Stein. License: BSD-3-Clause */
  (function () {
    function l(a, b) {
      document.addEventListener ? a.addEventListener("scroll", b, !1) : a.attachEvent("scroll", b);
    }
  
    function m(a) {
      document.body ? a() : document.addEventListener ? document.addEventListener("DOMContentLoaded", function c() {
        document.removeEventListener("DOMContentLoaded", c);
        a();
      }) : document.attachEvent("onreadystatechange", function k() {
        if ("interactive" == document.readyState || "complete" == document.readyState) document.detachEvent("onreadystatechange", k), a();
      });
    }
  
    ;
  
    function t(a) {
      this.a = document.createElement("div");
      this.a.setAttribute("aria-hidden", "true");
      this.a.appendChild(document.createTextNode(a));
      this.b = document.createElement("span");
      this.c = document.createElement("span");
      this.h = document.createElement("span");
      this.f = document.createElement("span");
      this.g = -1;
      this.b.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
      this.c.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
      this.f.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
      this.h.style.cssText = "display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";
      this.b.appendChild(this.h);
      this.c.appendChild(this.f);
      this.a.appendChild(this.b);
      this.a.appendChild(this.c);
    }
  
    function u(a, b) {
      a.a.style.cssText = "max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:" + b + ";";
    }
  
    function z(a) {
      var b = a.a.offsetWidth,
          c = b + 100;
      a.f.style.width = c + "px";
      a.c.scrollLeft = c;
      a.b.scrollLeft = a.b.scrollWidth + 100;
      return a.g !== b ? (a.g = b, !0) : !1;
    }
  
    function A(a, b) {
      function c() {
        var a = k;
        z(a) && a.a.parentNode && b(a.g);
      }
  
      var k = a;
      l(a.b, c);
      l(a.c, c);
      z(a);
    }
  
    ;
  
    function B(a, b) {
      var c = b || {};
      this.family = a;
      this.style = c.style || "normal";
      this.weight = c.weight || "normal";
      this.stretch = c.stretch || "normal";
    }
  
    var C = null,
        D = null,
        E = null,
        F = null;
  
    function G() {
      if (null === D) if (J() && /Apple/.test(window.navigator.vendor)) {
        var a = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);
        D = !!a && 603 > parseInt(a[1], 10);
      } else D = !1;
      return D;
    }
  
    function J() {
      null === F && (F = !!document.fonts);
      return F;
    }
  
    function K() {
      if (null === E) {
        var a = document.createElement("div");
  
        try {
          a.style.font = "condensed 100px sans-serif";
        } catch (b) {}
  
        E = "" !== a.style.font;
      }
  
      return E;
    }
  
    function L(a, b) {
      return [a.style, a.weight, K() ? a.stretch : "", "100px", b].join(" ");
    }
  
    B.prototype.load = function (a, b) {
      var c = this,
          k = a || "BESbswy",
          r = 0,
          n = b || 3E3,
          H = new Date().getTime();
      return new Promise(function (a, b) {
        if (J() && !G()) {
          var M = new Promise(function (a, b) {
            function e() {
              new Date().getTime() - H >= n ? b(Error("" + n + "ms timeout exceeded")) : document.fonts.load(L(c, '"' + c.family + '"'), k).then(function (c) {
                1 <= c.length ? a() : setTimeout(e, 25);
              }, b);
            }
  
            e();
          }),
              N = new Promise(function (a, c) {
            r = setTimeout(function () {
              c(Error("" + n + "ms timeout exceeded"));
            }, n);
          });
          Promise.race([N, M]).then(function () {
            clearTimeout(r);
            a(c);
          }, b);
        } else m(function () {
          function v() {
            var b;
            if (b = -1 != f && -1 != g || -1 != f && -1 != h || -1 != g && -1 != h) (b = f != g && f != h && g != h) || (null === C && (b = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent), C = !!b && (536 > parseInt(b[1], 10) || 536 === parseInt(b[1], 10) && 11 >= parseInt(b[2], 10))), b = C && (f == w && g == w && h == w || f == x && g == x && h == x || f == y && g == y && h == y)), b = !b;
            b && (d.parentNode && d.parentNode.removeChild(d), clearTimeout(r), a(c));
          }
  
          function I() {
            if (new Date().getTime() - H >= n) d.parentNode && d.parentNode.removeChild(d), b(Error("" + n + "ms timeout exceeded"));else {
              var a = document.hidden;
              if (!0 === a || void 0 === a) f = e.a.offsetWidth, g = p.a.offsetWidth, h = q.a.offsetWidth, v();
              r = setTimeout(I, 50);
            }
          }
  
          var e = new t(k),
              p = new t(k),
              q = new t(k),
              f = -1,
              g = -1,
              h = -1,
              w = -1,
              x = -1,
              y = -1,
              d = document.createElement("div");
          d.dir = "ltr";
          u(e, L(c, "sans-serif"));
          u(p, L(c, "serif"));
          u(q, L(c, "monospace"));
          d.appendChild(e.a);
          d.appendChild(p.a);
          d.appendChild(q.a);
          document.body.appendChild(d);
          w = e.a.offsetWidth;
          x = p.a.offsetWidth;
          y = q.a.offsetWidth;
          I();
          A(e, function (a) {
            f = a;
            v();
          });
          u(e, L(c, '"' + c.family + '",sans-serif'));
          A(p, function (a) {
            g = a;
            v();
          });
          u(p, L(c, '"' + c.family + '",serif'));
          A(q, function (a) {
            h = a;
            v();
          });
          u(q, L(c, '"' + c.family + '",monospace'));
        });
      });
    };
  
    "object" === ( false ? undefined : _typeof(module)) ? module.exports = B : (window.FontFaceObserver = B, window.FontFaceObserver.prototype.load = B.prototype.load);
  })();
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../ui-products/sbn/node_modules/webpack/buildin/module.js */ "./node_modules/webpack/buildin/module.js")(module)))
  
  /***/ }),
  
  /***/ "../../ui-core/node_modules/unfetch/polyfill/index.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/node_modules/unfetch/polyfill/index.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  self.fetch || (self.fetch = function (e, n) {
    return n = n || {}, new Promise(function (t, s) {
      var r = new XMLHttpRequest(),
          o = [],
          u = [],
          i = {},
          a = function a() {
        return {
          ok: 2 == (r.status / 100 | 0),
          statusText: r.statusText,
          status: r.status,
          url: r.responseURL,
          text: function text() {
            return Promise.resolve(r.responseText);
          },
          json: function json() {
            return Promise.resolve(r.responseText).then(JSON.parse);
          },
          blob: function blob() {
            return Promise.resolve(new Blob([r.response]));
          },
          clone: a,
          headers: {
            keys: function keys() {
              return o;
            },
            entries: function entries() {
              return u;
            },
            get: function get(e) {
              return i[e.toLowerCase()];
            },
            has: function has(e) {
              return e.toLowerCase() in i;
            }
          }
        };
      };
  
      for (var c in r.open(n.method || "get", e, !0), r.onload = function () {
        r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm, function (e, n, t) {
          o.push(n = n.toLowerCase()), u.push([n, t]), i[n] = i[n] ? i[n] + "," + t : t;
        }), t(a());
      }, r.onerror = s, r.withCredentials = "include" == n.credentials, n.headers) {
        r.setRequestHeader(c, n.headers[c]);
      }
  
      r.send(n.body || null);
    });
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/AjaxUploader/Uploader.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/AjaxUploader/Uploader.js ***!
    \**************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  /* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _lib_polyfills__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/polyfills */ "../../ui-core/plugins/AjaxUploader/lib/polyfills.js");
  /* harmony import */ var _lib_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/utils */ "../../ui-core/plugins/AjaxUploader/lib/utils.js");
  /* harmony import */ var _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/ValidationException */ "../../ui-core/plugins/AjaxUploader/lib/ValidationException.js");
  /* harmony import */ var _lib_UploaderFile__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/UploaderFile */ "../../ui-core/plugins/AjaxUploader/lib/UploaderFile.js");
  
  
  
  
  
  /**
   * Default plugin options
   * @type {object}
   */
  
  var defaultOptions = {
    input: 'input[type=file]',
    multiple: false,
    allowed: false,
    skipMtypeCheck: [],
    maxFiles: 1,
    maxSize: false,
    dropzone: '.uploader__dropzone',
    previousFilesCount: 0,
    handlers: {},
    strings: {
      fileTypeError: "File type is not supported. Please cancel and try again.",
      uploadError: "Error uploading file. Please cancel and try again.",
      uploadLimitError: "No more than {0} can be uploaded.",
      fileSizeError: "File size exceeds {0} limit. Please cancel and try again."
    }
  };
  /**
   * Prefix for console errors in this plugins
   * @type {string}
   */
  
  var errorsPrefix = "AjaxUploader Error: ";
  /**
   * Helper function to log errors with prefix
   * @param {string} msg
   */
  
  function die(msg) {
    console.error(errorsPrefix + msg);
  }
  /**
   * workaround for exceptions
   */
  
  
  var BreakException = {};
  /**
   *
   * @param {Element|string|jQuery} element
   * @param {object} [options]
   * @constructor
   */
  
  function AjaxUploader(element, options) {
    if (!element) return die('No element is provided');
    this.element = this.parseElement(element);
    if (!this.element) return die('No element is provided'); // Build plugin options
  
    if (!this.buildOptions(options)) return;
    this.uploadedFiles = [];
    this.initialize();
  }
  
  AjaxUploader.prototype = {
    constructor: AjaxUploader,
  
    /**
     * Get DOM Element from css selector or jQuery or DOM element
     * @param {Element|string|jQuery} element
     * @returns {Element}
     * @private
     */
    parseElement: function parseElement(element) {
      if (!element) return false;
      if (element instanceof Element) // Element is provided
        return element;else if (element instanceof jQuery) // jQuery object is provided
        return element[0];else if (typeof element === "string") // Selector provided
        return this.element.querySelector(element);
      return false;
    },
  
    /**
     * Build Plugin attributes
     * @param options
     * @returns {void|boolean}
     * @private
     */
    buildOptions: function buildOptions(options) {
      options = Object.assign(defaultOptions, options); // Make sure input is provided
  
      if (this.getInputFromOptions(options) !== true) return false; // Make sure ajax url is provided
  
      if (this.getAjaxUrlFromOptions(options) !== true) return false; // Get drop zone
  
      this.getDropAreaFromOptions(options);
      var dataset = this.input.dataset;
      this.multiple = this.input.multiple || options.multiple;
      this.maxFiles = dataset.maxFiles || options.maxFiles ? parseInt(dataset.maxFiles || options.maxFiles) : false;
      this.maxSize = dataset.maxSize || options.maxSize ? parseInt(dataset.maxSize || options.maxSize) : false;
      this.filesCount = parseInt(dataset.previousFilesCount || options.previousFilesCount);
      var allowed = dataset.allowed || options.allowed;
      if (typeof allowed === "string") this.allowedTypes = allowed.split(',');else if (Array.isArray(allowed)) this.allowedTypes = allowed;
      /**
       * Skip mime type checks
       * An array of file types to be validated by extension only, without mime type check
       */
  
      var skipMtypeCheck = dataset.skipMtypeCheck || options.skipMtypeCheck;
      if (typeof skipMtypeCheck === "string") this.skipMtypeCheck = skipMtypeCheck.split(',');else if (Array.isArray(skipMtypeCheck)) this.skipMtypeCheck = skipMtypeCheck; // set handlers
  
      this.handlers = options.handlers;
      this.strings = options.strings;
      return true;
    },
  
    /**
     *
     * @param options
     * @returns {void|boolean}
     * @private
     */
    getInputFromOptions: function getInputFromOptions(options) {
      this.input = this.parseElement(options.input); // if still cannot find the input then plugin breaks
  
      if (!this.input || !this.input.matches("input[type=file]")) return die('Invalid input provided');
      return true;
    },
  
    /**
     *
     * @param options
     * @returns {void|boolean}
     * @private
     */
    getAjaxUrlFromOptions: function getAjaxUrlFromOptions(options) {
      if (!this.input.dataset.ajaxUrl && !options.ajax) return die('Ajax url is not provided');
      this.ajax = {};
  
      if (this.input.dataset.ajaxUrl) {
        this.ajax.url = this.input.dataset.ajaxUrl;
      } else if (typeof options.ajax === "string") {
        this.ajax.url = options.ajax;
      } else if (_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(options.ajax) === "object") {
        if (!options.ajax.url) return die('Ajax url is not provided');
        this.ajax = options.ajax;
      }
  
      if (this.input.dataset.ajaxData) {
        this.ajax.data = JSON.parse(this.input.dataset.ajaxData);
      }
  
      return true;
    },
  
    /**
     *
     * @param options
     * @private
     */
    getDropAreaFromOptions: function getDropAreaFromOptions(options) {
      this.dropArea = this.parseElement(options.dropzone);
  
      if (!this.dropArea) {
        this.dropArea = this.element;
      }
    },
  
    /**
     * Initialize uploader events
     * @protected
     */
    initialize: function initialize() {
      var _this = this; // automatically submit the uploader on file select
  
  
      this.input.addEventListener('change', function (e) {
        _this.processFiles(e.target.files);
      });
  
      if (this.dropArea) {
        // drag&drop files if the feature is available
        ['drag', 'dragstart', 'dragend', 'dragover', 'dragenter', 'dragleave', 'drop'].forEach(function (event) {
          _this.dropArea.addEventListener(event, function (e) {
            // preventing the unwanted behaviours
            e.preventDefault();
            e.stopPropagation();
          });
        });
        ['dragover', 'dragenter'].forEach(function (event) {
          _this.dropArea.addEventListener(event, function () {
            _this.dropArea.classList.add('is-dragover');
          });
        });
        ['dragleave', 'dragend', 'drop'].forEach(function (event) {
          _this.dropArea.addEventListener(event, function () {
            _this.dropArea.classList.remove('is-dragover');
          });
        });
        this.dropArea.addEventListener('drop', function (e) {
          _this.processFiles(e.dataTransfer.files);
        });
      }
    },
  
    /**
     * On selecting/dropping files
     * @param {FileList} files
     * @protected
     */
    processFiles: function processFiles(files) {
      var _this = this;
  
      if (typeof this.handlers.start === "function") this.handlers.start(this);
      this.currentQueueLength = 0;
      var startIndexWith = _this.filesCount;
  
      try {
        // Check for files limit first
        this.currentQueueLength = files.length;
        Array.prototype.forEach.call(files, function (file, index) {
          _this.validateNumberOfFiles(); // Create object for the file
  
  
          var item = new _lib_UploaderFile__WEBPACK_IMPORTED_MODULE_4__["default"](file, startIndexWith + index);
          if (typeof _this.handlers.beforeUpload === "function") _this.handlers.beforeUpload(_this, item); // Validate the file
  
          try {
            _this.validateFile(item);
  
            _this.filesCount++; // increment files count if file is validated
          } catch (ex) {
            if (typeof _this.handlers.validationError === "function") _this.handlers.validationError(_this, ex, item);
            if (typeof _this.handlers.complete === "function") _this.handlers.complete(_this, item);
            return;
          } // Upload the file
  
  
          _this.uploadFile(item);
  
          _this.currentQueueLength--;
        });
      } catch (ex) {
        if (ex instanceof _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__["default"]) {
          if (typeof _this.handlers.validationError === "function") _this.handlers.validationError(_this, ex);
        } else if (ex !== BreakException) throw ex;
      }
    },
  
    /**
     * Validate if the dropped files are less than maximum allowed
     * @protected
     */
    validateNumberOfFiles: function validateNumberOfFiles() {
      if (this.maxFiles && this.filesCount + 1 > this.maxFiles) {
        var str;
        if (this.maxFiles === 1) str = this.maxFiles + " file";else str = this.maxFiles + " files";
        throw new _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__["default"](this.strings.uploadLimitError.format(str), _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.GLOBAL_ERR);
      }
    },
  
    /**
     * Validate File before queueing it
     * @param {UploaderFile} item
     * @throws ValidationException
     * @protected
     */
    validateFile: function validateFile(item) {
      // check upload limit (again)
      if (this.maxFiles > 0 && this.filesCount >= this.maxFiles) {
        var str;
        if (this.maxFiles === 1) str = this.maxFiles + " file";else str = this.maxFiles + " files";
        item.setState('upload-error');
        throw new _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__["default"](this.strings.uploadLimitError.format(str), _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.GLOBAL_ERR);
      } // check file type
  
  
      this.validateType(item); // check file size
  
      this.validateSize(item);
      return true;
    },
  
    /**
     * @param {UploaderFile} item
     * @throws ValidationException
     * @protected
     */
    validateType: function validateType(item) {
      // if exist in skip mime type check then return
      var extension = item.fileExtension();
      if (this.skipMtypeCheck.length && this.skipMtypeCheck.indexOf(extension) !== -1) return; // check mime type
  
      var type = item.getType();
  
      if (this.allowedTypes && this.allowedTypes.indexOf(type) === -1) {
        item.setState('files-error');
        var allowed = this.allowedTypes.join(', ');
        var errType = this.multiple ? _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.FILES_ERR : _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.GLOBAL_ERR;
        throw new _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__["default"](this.strings.fileTypeError.format(allowed), errType);
      }
    },
  
    /**
     * @param {UploaderFile} item
     * @throws ValidationException
     * @protected
     */
    validateSize: function validateSize(item) {
      var fileSize = item.fileSize();
  
      if (this.maxSize && fileSize > this.maxSize) {
        var maxSizeHuman = _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].methods.fileSizeHuman(this.maxSize);
        item.setState('files-error');
        var errType = this.multiple ? _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.FILES_ERR : _lib_utils__WEBPACK_IMPORTED_MODULE_2__["default"].constants.GLOBAL_ERR;
        throw new _lib_ValidationException__WEBPACK_IMPORTED_MODULE_3__["default"](this.strings.fileSizeError.format(maxSizeHuman), errType);
      }
    },
  
    /**
     * Upload File
     * @param {UploaderFile} item
     * @protected
     */
    uploadFile: function uploadFile(item) {
      var _this = this; // create XHR object
  
  
      var request = new window.XMLHttpRequest(); // add progress events
  
      request.upload.addEventListener("progress", function (evt) {
        _this.onXhrProgress(evt, item);
      }, false);
      request.addEventListener("progress", function (evt) {
        _this.onXhrProgress(evt, item);
      }, false); // open connection
  
      request.open('POST', _this.ajax.url, true); // set request headers
  
      request.setRequestHeader("Accept", "application/json");
      request.setRequestHeader("X-Requested-With", "XMLHttpRequest"); // deal with response
  
      request.onload = function () {
        if (request.status >= 200 && request.status < 400) {
          // Success!
          var data = JSON.parse(request.responseText);
  
          _this.uploadSuccess(data, item);
        } else {
          // Crap!
          _this.uploadError(item);
        }
  
        if (typeof _this.handlers.complete === "function") _this.handlers.complete(_this, item);
      };
  
      request.onerror = function () {
        // Crap again!
        _this.uploadError(item);
      };
  
      item.setRequest(request); // gathering the form data
  
      var ajaxData = this.generateFormData(item); // send it
  
      request.send(ajaxData);
    },
  
    /**
     * Gather Form data to be sent in the AJAX request
     * @param {UploaderFile} item
     * @protected
     */
    generateFormData: function generateFormData(item) {
      var ajaxData = new FormData();
  
      if (this.ajax.data) {
        for (var key in this.ajax.data) {
          ajaxData.append(key, this.ajax.data[key]);
        }
      }
  
      ajaxData.append("files", item.getFile());
      return ajaxData;
    },
  
    /**
     *
     * @param evt
     * @param item
     * @protected
     */
    onXhrProgress: function onXhrProgress(evt, item) {
      if (evt.lengthComputable) {
        var percentage = evt.loaded / evt.total * 100;
        if (typeof this.handlers.progress === "function") this.handlers.progress(this, percentage, item);
      }
    },
  
    /**
     * Callback for XHR Success status
     * @param {object} data
     * @param {object} item
     * @protected
     */
    uploadSuccess: function uploadSuccess(data, item) {
      // check result from backend
      if (data.success === true) {
        // File is uploaded
        item.setState("success");
        this.uploadedFiles.push(item);
        if (typeof this.handlers.success === "function") this.handlers.success(this, item, data);
        this.fire("success:uploader", {
          item: item,
          instance: this
        });
      } else {
        // File is refused
        item.setState("files-error");
        if (typeof this.handlers.error === "function") this.handlers.error(this, item, data.message);
      }
    },
  
    /**
     * Callback for XHR Fail status
     * @param {UploaderFile} item
     * @protected
     */
    uploadError: function uploadError(item) {
      item.setState("upload-error");
      this.filesCount--; // if the file couldn't be uploaded then decrease files count
  
      if (typeof this.handlers.error === "function") this.handlers.error(this, item, this.strings.uploadError);
    },
  
    /**
     * Reset uploader
     * @public
     */
    reset: function reset() {
      this.uploadedFiles = [];
      this.filesCount = 0;
      this.input.value = "";
      if (typeof this.handlers.reset === "function") this.handlers.reset(this);
    },
  
    /**
     * remove file from uploaded files
     * @param index
     * @public
     */
    removeFile: function removeFile(index) {
      this.uploadedFiles = this.uploadedFiles.filter(function (item) {
        if (item.index === index) {
          item.abort();
          return false;
        }
  
        return true;
      });
      this.filesCount--; // decrement files count
    },
  
    /**
     * abort uploading the file
     * @param {UploaderFile} item
     */
    abortFile: function abortFile(item) {
      item.abort();
      this.filesCount--; // decrement files count
    },
  
    /**
     * Fill Uploaded Files array with the saved files
     * @param {array} files
     */
    refreshPreviousUploadedFiles: function refreshPreviousUploadedFiles(files) {
      var that = this;
      this.uploadedFiles = [];
      files.forEach(function (file, i) {
        var item = new _lib_UploaderFile__WEBPACK_IMPORTED_MODULE_4__["default"](file, i);
        that.uploadedFiles.push(item);
      });
      this.filesCount = this.uploadedFiles.length;
    },
  
    /**
     * Fire custom js event
     * @param {string} name
     * @param {object} data
     * @private
     */
    fire: function fire(name, data) {
      var event = new CustomEvent(name, {
        detail: data
      });
      this.element.dispatchEvent(event);
    }
  };
  /* harmony default export */ __webpack_exports__["default"] = (AjaxUploader);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/AjaxUploader/lib/UploaderFile.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/AjaxUploader/lib/UploaderFile.js ***!
    \**********************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "../../ui-core/plugins/AjaxUploader/lib/utils.js");
  
  /**
   * Uploader File Item
   * @param {File|string} file
   * @param {number} index
   * @constructor
   */
  
  function UploaderFile(file, index) {
    /**
     * Unique identifier for this file
     * @type {number}
     */
    this.index = index;
    /**
     * File Object to be uploaded
     * @type {File|string}
     */
  
    this.file = file;
    /**
     * Current state
     * @type {string}
     */
  
    this.state = 'uploading';
    /**
     *
     * @type {XMLHttpRequest|null}
     */
  
    this.request = null;
  }
  
  UploaderFile.prototype = {
    constructor: UploaderFile,
  
    /**
     * Get index of the file
     * @returns {number}
     */
    getIndex: function getIndex() {
      return this.index;
    },
  
    /**
     * Get the file object itself
     * @returns {File}
     */
    getFile: function getFile() {
      return this.file;
    },
  
    /**
     * get the file size
     * @returns {number}
     */
    fileSize: function fileSize() {
      return this.file.size;
    },
  
    /**
     * get file size in human readable format
     * @returns {*}
     */
    fileSizeHuman: function fileSizeHuman() {
      return _utils__WEBPACK_IMPORTED_MODULE_0__["default"].methods.fileSizeHuman(this.file.size);
    },
  
    /**
     * get the file name
     * @returns {string}
     */
    fileName: function fileName() {
      if (typeof this.file === "string") return this.file;
      return this.file.name;
    },
  
    /**
     *
     * @param {int} [numberOfChar]
     * @returns {string}
     */
    fileNameTruncated: function fileNameTruncated(numberOfChar) {
      return _utils__WEBPACK_IMPORTED_MODULE_0__["default"].methods.truncate(this.file.name, numberOfChar || 53);
    },
  
    /**
     * Get the extension of the file
     * @returns {string}
     */
    fileExtension: function fileExtension() {
      return _utils__WEBPACK_IMPORTED_MODULE_0__["default"].methods.fileExtension(this.file.name);
    },
    getType: function getType() {
      return this.file.type;
    },
  
    /**
     * Set upload AJAX request
     * @param {XMLHttpRequest} xhr
     */
    setRequest: function setRequest(xhr) {
      this.request = xhr;
    },
  
    /**
     * Get upload AJAX request
     * @returns {XMLHttpRequest}
     */
    getRequest: function getRequest() {
      return this.request;
    },
  
    /**
     * Stop uploading operation, cancels the HTTP request
     */
    abort: function abort() {
      if (this.request) this.request.abort();
    },
  
    /**
     * Update the current state of the uploading file
     * @param {string} newState
     */
    setState: function setState(newState) {
      this.state = newState;
    },
  
    /**
     * Get the current state of the uploading file
     * @returns {string}
     */
    getState: function getState() {
      return this.state;
    }
  };
  /* harmony default export */ __webpack_exports__["default"] = (UploaderFile);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/AjaxUploader/lib/ValidationException.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/AjaxUploader/lib/ValidationException.js ***!
    \*****************************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return ValidationException; });
  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "../../ui-core/plugins/AjaxUploader/lib/utils.js");
  
  /**
   * Uploaded File Validation Exception
   *
   * @param message
   * @param type
   * @param item
   * @constructor
   */
  
  function ValidationException(message, type, item) {
    this.message = message;
    this.type = type;
    this.item = item;
  }
  
  ValidationException.prototype.isGlobalError = function () {
    return this.type === _utils__WEBPACK_IMPORTED_MODULE_0__["constants"].GLOBAL_ERR;
  };
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/AjaxUploader/lib/polyfills.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/AjaxUploader/lib/polyfills.js ***!
    \*******************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _polyfills_js_Element_closest__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../polyfills/js/Element/closest */ "../../ui-core/plugins/polyfills/js/Element/closest.js");
  /* harmony import */ var _polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../polyfills/js/Element/remove */ "../../ui-core/plugins/polyfills/js/Element/remove.js");
  /* harmony import */ var _polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _polyfills_js_String_format__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../polyfills/js/String/format */ "../../ui-core/plugins/polyfills/js/String/format.js");
  /* harmony import */ var _polyfills_js_String_format__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_polyfills_js_String_format__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _polyfills_js_Object_assign__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../polyfills/js/Object.assign */ "../../ui-core/plugins/polyfills/js/Object.assign.js");
  /* harmony import */ var _polyfills_js_Object_assign__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_polyfills_js_Object_assign__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _polyfills_js_CustomEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../polyfills/js/CustomEvent */ "../../ui-core/plugins/polyfills/js/CustomEvent.js");
  /* harmony import */ var _polyfills_js_CustomEvent__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_polyfills_js_CustomEvent__WEBPACK_IMPORTED_MODULE_4__);
  //
  // Polyfills
  //
  
  
  
  
  
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/AjaxUploader/lib/utils.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/AjaxUploader/lib/utils.js ***!
    \***************************************************************/
  /*! exports provided: constants, methods, default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "constants", function() { return constants; });
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "methods", function() { return methods; });
  var constants = {
    GLOBAL_ERR: 0,
    FILES_ERR: 1,
    UPLOAD_ERR: 2
  };
  var methods = {
    trigger: function trigger(element, event) {
      var theEvent;
  
      if (typeof event === "string") {
        theEvent = document.createEvent("Event");
        theEvent.initEvent(event, false, true);
      } else if (event instanceof Event) {
        theEvent = event;
      } else return;
  
      element.dispatchEvent(theEvent);
    },
    fadeOut: function fadeOut(el, callback) {
      el.style.opacity = 1;
      var last = +new Date();
  
      var tick = function tick() {
        el.style.opacity = +el.style.opacity - (new Date() - last) / 400;
        last = +new Date();
  
        if (+el.style.opacity > 0) {
          window.requestAnimationFrame && requestAnimationFrame(tick) || setTimeout(tick, 16);
        } else {
          callback();
        }
      };
  
      tick();
    },
    truncate: function truncate(fullStr, strLen, separator) {
      if (fullStr.length <= strLen) return fullStr;
      separator = separator || '...';
      var sepLen = separator.length,
          charsToShow = strLen - sepLen,
          frontChars = charsToShow - 7,
          backChars = 7;
      return fullStr.substr(0, frontChars) + separator + fullStr.substr(fullStr.length - backChars);
    },
    fileExtension: function fileExtension(filename) {
      var parts = filename.split('.');
      return parts[parts.length - 1];
    },
    fileNameTruncated: function fileNameTruncated(filename) {
      return methods.truncate(this.file.name, 53);
    },
    fileSizeHuman: function fileSizeHuman(size) {
      var e = Math.log(size) / Math.log(1e3) | 0;
      return +(size / Math.pow(1024, e)).toFixed(1) + ' ' + ('kMGTPEZY'[e - 1] || '') + 'B';
    },
    delay: function delay() {
      var start = Date.now();
  
      while (Date.now() < start + 5000) {}
    }
  };
  /* harmony default export */ __webpack_exports__["default"] = ({
    constants: constants,
    methods: methods
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/accordion/js/accordion.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/accordion/js/accordion.js ***!
    \***************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.from */ "../../ui-core/node_modules/core-js/modules/es.array.from.js");
  /* harmony import */ var core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var core_js_modules_es_object_assign__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.object.assign */ "../../ui-core/node_modules/core-js/modules/es.object.assign.js");
  /* harmony import */ var core_js_modules_es_object_assign__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_object_assign__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.iterator */ "../../ui-core/node_modules/core-js/modules/es.string.iterator.js");
  /* harmony import */ var core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "../../ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js");
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "../../ui-core/node_modules/@babel/runtime/helpers/createClass.js");
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__);
  
  
  
  
  
  
  var Accordion = /*#__PURE__*/function () {
    function Accordion(el, options) {
      var _this = this;
  
      _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, Accordion);
  
      var container = typeof el === 'string' ? document.querySelector(el) : el;
  
      if (container == null) {
        return;
      }
  
      var defaults = {
        headerClass: 'js-accordion__trigger',
        panelClass: 'js-accordion__panel',
        initializedClass: 'js-accordion--initialized',
        usingAnchorTagAsTrigger: false,
        openMultiplePanels: false,
        openHeadersOnLoad: [],
        addListenersOnInit: true,
        cssStatesClasses: {
          OPENED: 'opened'
        },
        openPrefixCallback: function openPrefixCallback() {}
      };
      this.toggling = false;
      this.container = container;
      this.settings = Object.assign({}, defaults, options);
      var children = Array.from(this.container.children);
      var headersParents = children.filter(function (header) {
        return !header.classList.contains(_this.settings.panelClass);
      });
      this.headers = headersParents.reduce(function (acc, header) {
        var a = Array.from(header.children).filter(function (child) {
          return child.classList.contains(_this.settings.headerClass);
        });
        return acc.concat(a);
      }, []);
      this.panels = children.filter(function (panel) {
        return panel.classList.contains(_this.settings.panelClass);
      });
      this.states = this.headers.map(function () {
        return {
          state: 'closed'
        };
      });
  
      if (this.container) {
        this.init();
      } else {
        console.log('Something is wrong with you markup...');
      }
    }
  
    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default()(Accordion, [{
      key: "init",
      value: function init() {
        this._initialState();
  
        this._addListeners();
  
        this._finishInitialization();
      }
    }, {
      key: "_initialState",
      value: function _initialState() {
        var headersToOpen = this.settings.openHeadersOnLoad;
  
        if (headersToOpen.length) {
          this._openHeadersOnLoad(headersToOpen);
        }
  
        this._renderDom();
      }
    }, {
      key: "_finishInitialization",
      value: function _finishInitialization() {
        this.container.classList.add(this.settings.initializedClass);
      }
    }, {
      key: "_addListeners",
      value: function _addListeners() {
        var _this2 = this;
  
        if (!this.settings.addListenersOnInit) return;
        this.container.addEventListener('keydown', function (e) {
          return _this2.handleKeyDown(e);
        });
        this.headers.forEach(function (header, index) {
          header.addEventListener('click', function (e) {
            e.preventDefault();
  
            _this2.handleClick(header, index);
          });
        });
      }
      /**
       * @param {KeyboardEvent} event
       */
  
    }, {
      key: "handleKeyDown",
      value: function handleKeyDown(event) {
        var target = event.target;
        var key = event.which.toString(); // 33 = Page Up, 34 = Page Down
  
        var ctrlModifier = event.ctrlKey && key.match(/33|34/); // Is this coming from an accordion header?
  
        if (target.classList.contains(this.settings.headerClass)) {
          // Up/ Down arrow and Control + Page Up/ Page Down keyboard operations
          // 38 = Up, 40 = Down
          if (key.match(/38|40/) || ctrlModifier) {
            var index = this.headers.indexOf(target);
            var direction = key.match(/34|40/) ? 1 : -1;
            var length = this.headers.length;
            var newIndex = (index + length + direction) % length;
            this.headers[newIndex].focus();
            event.preventDefault();
          } else if (key.match(/35|36/)) {
            // 35 = End, 36 = Home keyboard operations
            switch (key) {
              // Go to first accordion
              case '36':
                this.headers[0].focus();
                break;
              // Go to last accordion
  
              case '35':
                this.headers[this.headers.length - 1].focus();
                break;
            }
  
            event.preventDefault();
          } else if (this.settings.usingAnchorTagAsTrigger && key.match(/32/)) {
            // 32 = Space
            event.preventDefault();
  
            var _index = this.headers.indexOf(target);
  
            this.handleClick(target, _index);
          }
        }
      }
      /**
       *  @param {object} targetHeader
       * @param {number} headerIndex
       */
  
    }, {
      key: "handleClick",
      value: function handleClick(targetHeader, headerIndex) {
        var targetHeaderClass = this.settings.headerClass;
  
        if (targetHeader.classList.contains(targetHeaderClass) && !this.toggling) {
          // this.container.dispatchEvent(this.settings.events.toggleStarted);
          this.setState(headerIndex);
  
          this._renderDom();
        }
      }
      /**
       *  @param {object} targetHeaderId
       */
  
    }, {
      key: "setState",
      value: function setState(targetHeaderId) {
        var states = this.getState();
  
        if (!this.settings.openMultiplePanels) {
          states.forEach(function (state, index) {
            if (index !== targetHeaderId) {
              state.state = 'closed';
            }
          });
        }
  
        var targetState = states.filter(function (state, index) {
          return index === targetHeaderId;
        })[0];
        targetState.state = this.toggleState(targetState.state);
      }
    }, {
      key: "_renderDom",
      value: function _renderDom() {
        var _this3 = this;
  
        this.states.forEach(function (state, index) {
          if (state.state === 'open') {
            _this3.open(index, false);
          } else if (state.state === 'closed') {
            _this3.close(index, false);
          }
        });
      }
      /**
       *  @param {number} headerIndex
       * @param setState
       */
  
    }, {
      key: "open",
      value: function open(headerIndex) {
        var setState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  
        if (setState) {
          this.setState(headerIndex);
        }
  
        this.togglePanel('open', headerIndex);
      }
      /**
       *  @param {number} headerIndex
       * @param {boolean} setState
       */
  
    }, {
      key: "close",
      value: function close(headerIndex) {
        var setState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  
        if (setState) {
          this.setState(headerIndex);
        }
  
        this.togglePanel('closed', headerIndex);
      }
    }, {
      key: "openAll",
      value: function openAll() {
        var _this4 = this;
  
        this.headers.forEach(function (header, headerIndex) {
          _this4.togglePanel('open', headerIndex);
        });
      }
    }, {
      key: "closeAll",
      value: function closeAll() {
        var _this5 = this;
  
        this.headers.forEach(function (header, headerIndex) {
          _this5.togglePanel('closed', headerIndex);
        });
      }
      /**
       *  @param {string} action
       *  @param {number} headerIndex
       */
  
    }, {
      key: "togglePanel",
      value: function togglePanel(action, headerIndex) {
        if (action !== undefined && headerIndex !== undefined) {
          if (action === 'closed') {
            var header = this.headers[headerIndex];
            var panelToClose = this.panels[headerIndex];
            this.closeAction(header, panelToClose);
          } else if (action === 'open') {
            var _header = this.headers[headerIndex];
            var panelToOpen = this.panels[headerIndex];
            this.openAction(_header, panelToOpen);
          }
        }
      }
      /**
       *  @param {HTMLElement} header
       *  @param {HTMLElement} panel
       */
  
    }, {
      key: "closeAction",
      value: function closeAction(header, panel) {
        if (panel.getAttribute('aria-hidden') === 'true') return;
        header.setAttribute('aria-expanded', false);
        panel.setAttribute('aria-hidden', true);
        panel.classList.remove(this.settings.cssStatesClasses.OPENED);
      }
      /**
       *  @param {HTMLElement} header
       *  @param {HTMLElement} panel
       */
  
    }, {
      key: "openAction",
      value: function openAction(header, panel) {
        var _this6 = this;
  
        if (typeof this.settings.openPrefixCallback === 'function') {
          this.settings.openPrefixCallback(this.container, header, panel);
        }
  
        header.setAttribute('aria-expanded', true);
        panel.setAttribute('aria-hidden', false);
        panel.addEventListener('transitionend', function () {
          return panel.classList.add(_this6.settings.cssStatesClasses.OPENED);
        }, {
          once: true
        });
      }
      /**
       *  @param {array} headersIndices - Array of indices of the headers
       */
  
    }, {
      key: "getState",
      value: function getState() {
        var _this7 = this;
  
        var headersIndices = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  
        if (headersIndices.length && Array.isArray(headersIndices)) {
          return headersIndices.map(function (header) {
            return _this7.states[header];
          });
        } else {
          return this.states;
        }
      }
      /**
       *  @param {string} currentState
       */
  
    }, {
      key: "toggleState",
      value: function toggleState(currentState) {
        if (currentState !== undefined) {
          return currentState === 'closed' ? 'open' : 'closed';
        }
      }
      /**
       *  @param {array} headersToOpen - Array of indices of the headers
       */
  
    }, {
      key: "_openHeadersOnLoad",
      value: function _openHeadersOnLoad() {
        var _this8 = this;
  
        var headersToOpen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  
        // TODO: filter-out the non-numeric values then check.
        if (headersToOpen.length && Array.isArray(headersToOpen)) {
          var headers = headersToOpen.filter(function (header) {
            return header !== undefined;
          });
          headers.forEach(function (header) {
            _this8.setState(header);
          });
        }
      }
    }]);
  
    return Accordion;
  }();
  
  /* harmony default export */ __webpack_exports__["default"] = (Accordion);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/controller/js/controller.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/controller/js/controller.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var controller = {
      $body: $('body'),
      active: null,
      escape: 27,
      enabled: false,
      $activeComponent: null,
      $container: null,
      $target: null,
      init: function init() {
        controller.control();
        controller.extra();
        controller.check();
        controller.extra();
      },
      control: function control() {
        $(document).on('keydown', function (e) {
          // hide / close when esc key is pressed
          if ((e.keyCode || e.which) === controller.escape) {
            controller.check(e);
          }
        });
      },
      check: function check(e) {
        // check if there is open / active component
        controller.active = controller.$body.attr('data-active');
  
        if (controller.active != null) {
          controller.disable(e);
        }
      },
      disable: function disable(e) {
        // hide / close active component
        // return focus to controller if component was closed by check()
        if (typeof UX[controller.active].$controller !== 'undefined') {
          UX[controller.active].$controller.focus();
        }
  
        UX[controller.active].on.hide(e);
      },
      extra: function extra() {
        controller.$body.on("click focusout", function (e) {
          // hide / close opened components when click out side it
          // @todo: this can be still improved for nested compoentns, when click is outside of all of them, close all, not only current one - but it is a feature
          // if key was pressed, than we need to operate with related target, not original target
          if (e.type === 'focusout' && e.target !== e.relatedTarget) {
            if (e.relatedTarget !== null) {
              e.target = e.relatedTarget;
            }
          }
  
          controller.active = controller.$body.attr('data-active');
          controller.$activeComponent = typeof UX[controller.active] !== "undefined" ? UX[controller.active] : "undefined";
  
          if (typeof controller.$activeComponent !== "undefined" && typeof controller.$activeComponent.$section !== "undefined" && typeof controller.$activeComponent.$controller !== "undefined") {
            controller.$container = controller.$activeComponent.$section;
            controller.$target = controller.$activeComponent.$controller;
            controller.checkToHide(e);
          }
        });
      },
      checkToHide: function checkToHide(e) {
        if (!controller.$container.is(e.target) // if the target of the click isn't the container...
        && controller.$container.has(e.target).length === 0 && !controller.$target.is(e.target) // if the target of the click isn't the controller...
        && controller.$target.has(e.target).length === 0 // ... nor a descendant of the controller
        && !$(e.target).closest(".ui-autocomplete").length) {
          controller.$activeComponent.on.hide(e);
        }
      }
    };
    UX.controller = controller; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/cookies/js/cookies.js":
  /*!***********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/cookies/js/cookies.js ***!
    \***********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    /*\
    |*|
    |*|  :: cookies.js ::
    |*|
    |*|  A complete cookies reader/writer framework with full unicode support.
    |*|
    |*|  Revision #1 - September 4, 2014
    |*|
    |*|  https://developer.mozilla.org/en-US/docs/Web/API/document.cookie
    |*|  https://developer.mozilla.org/User:fusionchess
    |*|  https://github.com/madmurphy/cookies.js
    |*|
    |*|  This framework is released under the GNU Public License, version 3 or later.
    |*|  http://www.gnu.org/licenses/gpl-3.0-standalone.html
    |*|
    |*|  Syntaxes:
    |*|
    |*|  * docCookies.setItem(name, value[, end[, path[, domain[, secure]]]])
    |*|  * docCookies.getItem(name)
    |*|  * docCookies.removeItem(name[, path[, domain]])
    |*|  * docCookies.hasItem(name)
    |*|  * docCookies.keys()
    |*|
    \*/
    var cookies = {
      getItem: function getItem(sKey) {
        if (!sKey) {
          return null;
        }
  
        return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
      },
      setItem: function setItem(sKey, sValue, vEnd, sPath, sDomain, bSecure) {
        if (!sKey || /^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)) {
          return false;
        }
  
        var sExpires = "";
  
        if (vEnd) {
          switch (vEnd.constructor) {
            case Number:
              sExpires = vEnd === Infinity ? "; expires=Fri, 31 Dec 9999 23:59:59 GMT" : "; max-age=" + vEnd;
              break;
  
            case String:
              sExpires = "; expires=" + vEnd;
              break;
  
            case Date:
              sExpires = "; expires=" + vEnd.toUTCString();
              break;
          }
        }
  
        document.cookie = encodeURIComponent(sKey) + "=" + encodeURIComponent(sValue) + sExpires + (sDomain ? "; domain=" + sDomain : "") + (sPath ? "; path=" + sPath : "") + (bSecure ? "; secure" : "");
        return true;
      },
      removeItem: function removeItem(sKey, sPath, sDomain) {
        if (!this.hasItem(sKey)) {
          return false;
        }
  
        document.cookie = encodeURIComponent(sKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT" + (sDomain ? "; domain=" + sDomain : "") + (sPath ? "; path=" + sPath : "");
        return true;
      },
      hasItem: function hasItem(sKey) {
        if (!sKey) {
          return false;
        }
  
        return new RegExp("(?:^|;\\s*)" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=").test(document.cookie);
      },
      keys: function keys() {
        var aKeys = document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g, "").split(/\s*(?:\=[^;]*)?;\s*/);
  
        for (var nLen = aKeys.length, nIdx = 0; nIdx < nLen; nIdx++) {
          aKeys[nIdx] = decodeURIComponent(aKeys[nIdx]);
        }
  
        return aKeys;
      }
    };
    UX.cookies = cookies;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/copy-text/js/copy-text.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/copy-text/js/copy-text.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var copyText = {
      $target: null,
      $toggle: null,
      init: function init() {
        copyText.$toggle = $('.copy__btn');
        copyText.$target = $('.copy__text');
        copyText.control();
      },
      control: function control() {
        $(document).on('click touchstart', '.copy__btn', function () {
          copyText.$toggle = $(this);
          copyText.$toggle.off("focusout");
          copyText.copyLink();
        });
      },
      copyLink: function copyLink() {
        var $wrapper = copyText.$toggle.closest('.copy__text-wrapper');
  
        if ($wrapper.length) {
          copyText.$target = $wrapper.find('.copy__text');
  
          if (copyText.$target.is('.csl-response') && $wrapper.find('.csl-right-inline').length) {
            copyText.$target = $wrapper.find('.csl-right-inline');
          }
        }
  
        var textarea = document.createElement('textarea');
        textarea.id = 'temp_element';
        textarea.style.height = 0;
        textarea.value = copyText.$target.html();
  
        if (/<\/?[a-z][\s\S]*>/i.test(copyText.$target.text())) {
          textarea.value = copyText.$target.text();
        }
  
        document.body.appendChild(textarea);
        var selector = document.querySelector('#temp_element');
  
        if (navigator.userAgent.match(/ipad|ipod|iphone/i)) {
          selector.setAttribute('readonly', '');
          range = document.createRange();
          range.selectNodeContents(selector);
          selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
          selector.setSelectionRange(0, 999999);
          selector.removeAttribute('readonly');
        } else {
          selector.select();
        }
  
        document.execCommand('copy');
        document.body.removeChild(textarea);
        copyText.$toggle.focus();
      }
    };
    UX.copyText = copyText; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/custom-form/js/jcf.js":
  /*!***********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/custom-form/js/jcf.js ***!
    \***********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /*!
   * JavaScript Custom Forms
   *
   * Copyright 2014-2015 PSD2HTML - http://psd2html.com/jcf
   * Released under the MIT license (LICENSE.txt)
   *
   * Version: 1.2.3
   */
  ;
  
  (function (root, factory) {
    'use strict';
    /*if (typeof define === 'function' && define.amd) {
      define(['jquery'], factory);
    } else if (typeof exports === 'object') {
      module.exports = factory(require('jquery'));
    } else {
      root.jcf = factory(jQuery);
    }*/
  
    root.jcf = factory(jQuery);
  })(this, function ($) {
    'use strict'; // define version
  
    var version = '1.2.3'; // private variables
  
    var customInstances = []; // default global options
  
    var commonOptions = {
      optionsKey: 'jcf',
      dataKey: 'jcf-instance',
      rtlClass: 'jcf-rtl',
      focusClass: 'jcf-focus',
      pressedClass: 'jcf-pressed',
      disabledClass: 'jcf-disabled',
      hiddenClass: 'jcf-hidden',
      resetAppearanceClass: 'jcf-reset-appearance',
      unselectableClass: 'jcf-unselectable'
    }; // detect device type
  
    var isTouchDevice = 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch,
        isWinPhoneDevice = /Windows Phone/.test(navigator.userAgent);
    commonOptions.isMobileDevice = !!(isTouchDevice || isWinPhoneDevice); // create global stylesheet if custom forms are used
  
    var createStyleSheet = function createStyleSheet() {
      var styleTag = $('<style>').appendTo('head'),
          styleSheet = styleTag.prop('sheet') || styleTag.prop('styleSheet'); // crossbrowser style handling
  
      var addCSSRule = function addCSSRule(selector, rules, index) {
        index = index || 0;
  
        if (styleSheet.insertRule) {
          styleSheet.insertRule(selector + '{' + rules + '}', index);
        } else {
          styleSheet.addRule(selector, rules, index);
        }
      }; // add special rules
  
  
      addCSSRule('.' + commonOptions.hiddenClass, 'position:absolute !important;left:-9999px !important;height:1px !important;width:1px !important;margin:0 !important;border-width:0 !important;-webkit-appearance:none;-moz-appearance:none;appearance:none');
      addCSSRule('.' + commonOptions.rtlClass + ' .' + commonOptions.hiddenClass, 'right:-9999px !important; left: auto !important');
      addCSSRule('.' + commonOptions.unselectableClass, '-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-tap-highlight-color: rgba(0,0,0,0);');
      addCSSRule('.' + commonOptions.resetAppearanceClass, 'background: none; border: none; -webkit-appearance: none; appearance: none; opacity: 0; filter: alpha(opacity=0);'); // detect rtl pages
  
      var html = $('html'),
          body = $('body');
  
      if (html.css('direction') === 'rtl' || body.css('direction') === 'rtl') {
        html.addClass(commonOptions.rtlClass);
      } // handle form reset event
  
  
      html.on('reset', function () {
        setTimeout(function () {
          api.refreshAll();
        }, 0);
      }); // mark stylesheet as created
  
      commonOptions.styleSheetCreated = true;
    }; // simplified pointer events handler
  
  
    (function () {
      var pointerEventsSupported = navigator.pointerEnabled || navigator.msPointerEnabled,
          touchEventsSupported = 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch,
          eventList,
          eventMap = {},
          eventPrefix = 'jcf-'; // detect events to attach
  
      if (pointerEventsSupported) {
        eventList = {
          pointerover: navigator.pointerEnabled ? 'pointerover' : 'MSPointerOver',
          pointerdown: navigator.pointerEnabled ? 'pointerdown' : 'MSPointerDown',
          pointermove: navigator.pointerEnabled ? 'pointermove' : 'MSPointerMove',
          pointerup: navigator.pointerEnabled ? 'pointerup' : 'MSPointerUp'
        };
      } else {
        eventList = {
          pointerover: 'mouseover',
          pointerdown: 'mousedown' + (touchEventsSupported ? ' touchstart' : ''),
          pointermove: 'mousemove' + (touchEventsSupported ? ' touchmove' : ''),
          pointerup: 'mouseup' + (touchEventsSupported ? ' touchend' : '')
        };
      } // create event map
  
  
      $.each(eventList, function (targetEventName, fakeEventList) {
        $.each(fakeEventList.split(' '), function (index, fakeEventName) {
          eventMap[fakeEventName] = targetEventName;
        });
      }); // jQuery event hooks
  
      $.each(eventList, function (eventName, eventHandlers) {
        eventHandlers = eventHandlers.split(' ');
        $.event.special[eventPrefix + eventName] = {
          setup: function setup() {
            var self = this;
            $.each(eventHandlers, function (index, fallbackEvent) {
              if (self.addEventListener) self.addEventListener(fallbackEvent, fixEvent, false);else self['on' + fallbackEvent] = fixEvent;
            });
          },
          teardown: function teardown() {
            var self = this;
            $.each(eventHandlers, function (index, fallbackEvent) {
              if (self.addEventListener) self.removeEventListener(fallbackEvent, fixEvent, false);else self['on' + fallbackEvent] = null;
            });
          }
        };
      }); // check that mouse event are not simulated by mobile browsers
  
      var lastTouch = null;
  
      var mouseEventSimulated = function mouseEventSimulated(e) {
        var dx = Math.abs(e.pageX - lastTouch.x),
            dy = Math.abs(e.pageY - lastTouch.y),
            rangeDistance = 25;
  
        if (dx <= rangeDistance && dy <= rangeDistance) {
          return true;
        }
      }; // normalize event
  
  
      var fixEvent = function fixEvent(e) {
        var origEvent = e || window.event,
            touchEventData = null,
            targetEventName = eventMap[origEvent.type];
        e = $.event.fix(origEvent);
        e.type = eventPrefix + targetEventName;
  
        if (origEvent.pointerType) {
          switch (origEvent.pointerType) {
            case 2:
              e.pointerType = 'touch';
              break;
  
            case 3:
              e.pointerType = 'pen';
              break;
  
            case 4:
              e.pointerType = 'mouse';
              break;
  
            default:
              e.pointerType = origEvent.pointerType;
          }
        } else {
          e.pointerType = origEvent.type.substr(0, 5); // "mouse" or "touch" word length
        }
  
        if (!e.pageX && !e.pageY) {
          touchEventData = origEvent.changedTouches ? origEvent.changedTouches[0] : origEvent;
          e.pageX = touchEventData.pageX;
          e.pageY = touchEventData.pageY;
        }
  
        if (origEvent.type === 'touchend') {
          lastTouch = {
            x: e.pageX,
            y: e.pageY
          };
        }
  
        if (e.pointerType === 'mouse' && lastTouch && mouseEventSimulated(e)) {
          return;
        } else {
          return ($.event.dispatch || $.event.handle).call(this, e);
        }
      };
    })(); // custom mousewheel/trackpad handler
  
  
    (function () {
      var wheelEvents = ('onwheel' in document || document.documentMode >= 9 ? 'wheel' : 'mousewheel DOMMouseScroll').split(' '),
          shimEventName = 'jcf-mousewheel';
      $.event.special[shimEventName] = {
        setup: function setup() {
          var self = this;
          $.each(wheelEvents, function (index, fallbackEvent) {
            if (self.addEventListener) self.addEventListener(fallbackEvent, fixEvent, false);else self['on' + fallbackEvent] = fixEvent;
          });
        },
        teardown: function teardown() {
          var self = this;
          $.each(wheelEvents, function (index, fallbackEvent) {
            if (self.addEventListener) self.removeEventListener(fallbackEvent, fixEvent, false);else self['on' + fallbackEvent] = null;
          });
        }
      };
  
      var fixEvent = function fixEvent(e) {
        var origEvent = e || window.event;
        e = $.event.fix(origEvent);
        e.type = shimEventName; // old wheel events handler
  
        if ('detail' in origEvent) {
          e.deltaY = -origEvent.detail;
        }
  
        if ('wheelDelta' in origEvent) {
          e.deltaY = -origEvent.wheelDelta;
        }
  
        if ('wheelDeltaY' in origEvent) {
          e.deltaY = -origEvent.wheelDeltaY;
        }
  
        if ('wheelDeltaX' in origEvent) {
          e.deltaX = -origEvent.wheelDeltaX;
        } // modern wheel event handler
  
  
        if ('deltaY' in origEvent) {
          e.deltaY = origEvent.deltaY;
        }
  
        if ('deltaX' in origEvent) {
          e.deltaX = origEvent.deltaX;
        } // handle deltaMode for mouse wheel
  
  
        e.delta = e.deltaY || e.deltaX;
  
        if (origEvent.deltaMode === 1) {
          var lineHeight = 16;
          e.delta *= lineHeight;
          e.deltaY *= lineHeight;
          e.deltaX *= lineHeight;
        }
  
        return ($.event.dispatch || $.event.handle).call(this, e);
      };
    })(); // extra module methods
  
  
    var moduleMixin = {
      // provide function for firing native events
      fireNativeEvent: function fireNativeEvent(elements, eventName) {
        $(elements).each(function () {
          var element = this,
              eventObject;
  
          if (element.dispatchEvent) {
            eventObject = document.createEvent('HTMLEvents');
            eventObject.initEvent(eventName, true, true);
            element.dispatchEvent(eventObject);
          } else if (document.createEventObject) {
            eventObject = document.createEventObject();
            eventObject.target = element;
            element.fireEvent('on' + eventName, eventObject);
          }
        });
      },
      // bind event handlers for module instance (functions beggining with "on")
      bindHandlers: function bindHandlers() {
        var self = this;
        $.each(self, function (propName, propValue) {
          if (propName.indexOf('on') === 0 && $.isFunction(propValue)) {
            // dont use $.proxy here because it doesn't create unique handler
            self[propName] = function () {
              return propValue.apply(self, arguments);
            };
          }
        });
      }
    }; // public API
  
    var api = {
      version: version,
      modules: {},
      getOptions: function getOptions() {
        return $.extend({}, commonOptions);
      },
      setOptions: function setOptions(moduleName, moduleOptions) {
        if (arguments.length > 1) {
          // set module options
          if (this.modules[moduleName]) {
            $.extend(this.modules[moduleName].prototype.options, moduleOptions);
          }
        } else {
          // set common options
          $.extend(commonOptions, moduleName);
        }
      },
      addModule: function addModule(proto) {
        // proto is factory function
        if ($.isFunction(proto)) {
          proto = proto($, window);
        } // add module to list
  
  
        var Module = function Module(options) {
          // save instance to collection
          if (!options.element.data(commonOptions.dataKey)) {
            options.element.data(commonOptions.dataKey, this);
          }
  
          customInstances.push(this); // save options
  
          this.options = $.extend({}, commonOptions, this.options, getInlineOptions(options.element), options); // bind event handlers to instance
  
          this.bindHandlers(); // call constructor
  
          this.init.apply(this, arguments);
        }; // parse options from HTML attribute
  
  
        var getInlineOptions = function getInlineOptions(element) {
          var dataOptions = element.data(commonOptions.optionsKey),
              attrOptions = element.attr(commonOptions.optionsKey);
  
          if (dataOptions) {
            return dataOptions;
          } else if (attrOptions) {
            try {
              return $.parseJSON(attrOptions);
            } catch (e) {// ignore invalid attributes
            }
          }
        }; // set proto as prototype for new module
  
  
        Module.prototype = proto; // add mixin methods to module proto
  
        $.extend(proto, moduleMixin);
  
        if (proto.plugins) {
          $.each(proto.plugins, function (pluginName, plugin) {
            $.extend(plugin.prototype, moduleMixin);
          });
        } // override destroy method
  
  
        var originalDestroy = Module.prototype.destroy;
  
        Module.prototype.destroy = function () {
          this.options.element.removeData(this.options.dataKey);
  
          for (var i = customInstances.length - 1; i >= 0; i--) {
            if (customInstances[i] === this) {
              customInstances.splice(i, 1);
              break;
            }
          }
  
          if (originalDestroy) {
            originalDestroy.apply(this, arguments);
          }
        }; // save module to list
  
  
        this.modules[proto.name] = Module;
      },
      getInstance: function getInstance(element) {
        return $(element).data(commonOptions.dataKey);
      },
      replace: function replace(elements, moduleName, customOptions) {
        var self = this,
            instance;
  
        if (!commonOptions.styleSheetCreated) {
          createStyleSheet();
        }
  
        $(elements).each(function () {
          var moduleOptions,
              element = $(this);
          instance = element.data(commonOptions.dataKey);
  
          if (instance) {
            instance.refresh();
          } else {
            if (!moduleName) {
              $.each(self.modules, function (currentModuleName, module) {
                if (module.prototype.matchElement.call(module.prototype, element)) {
                  moduleName = currentModuleName;
                  return false;
                }
              });
            }
  
            if (moduleName) {
              moduleOptions = $.extend({
                element: element
              }, customOptions);
              instance = new self.modules[moduleName](moduleOptions);
            }
          }
        });
        return instance;
      },
      refresh: function refresh(elements) {
        $(elements).each(function () {
          var instance = $(this).data(commonOptions.dataKey);
  
          if (instance) {
            instance.refresh();
          }
        });
      },
      destroy: function destroy(elements) {
        $(elements).each(function () {
          var instance = $(this).data(commonOptions.dataKey);
  
          if (instance) {
            instance.destroy();
          }
        });
      },
      replaceAll: function replaceAll(context) {
        var self = this;
        $.each(this.modules, function (moduleName, module) {
          $(module.prototype.selector, context).each(function () {
            if (this.className.indexOf('jcf-ignore') < 0) {
              self.replace(this, moduleName);
            }
          });
        });
      },
      refreshAll: function refreshAll(context) {
        if (context) {
          $.each(this.modules, function (moduleName, module) {
            $(module.prototype.selector, context).each(function () {
              var instance = $(this).data(commonOptions.dataKey);
  
              if (instance) {
                instance.refresh();
              }
            });
          });
        } else {
          for (var i = customInstances.length - 1; i >= 0; i--) {
            customInstances[i].refresh();
          }
        }
      },
      destroyAll: function destroyAll(context) {
        if (context) {
          $.each(this.modules, function (moduleName, module) {
            $(module.prototype.selector, context).each(function (index, element) {
              var instance = $(element).data(commonOptions.dataKey);
  
              if (instance) {
                instance.destroy();
              }
            });
          });
        } else {
          while (customInstances.length) {
            customInstances[0].destroy();
          }
        }
      }
    }; // we need to make JCF available globally if we're in AMD environment
  
    if (true) {
      window.jcf = api;
    }
  
    return api;
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/custom-form/js/jcf.range.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/custom-form/js/jcf.range.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /*!
   * JavaScript Custom Forms : Range Module
   *
   * Copyright 2014-2015 PSD2HTML - http://psd2html.com/jcf
   * Released under the MIT license (LICENSE.txt)
   *
   * Version: 1.2.3
   */
  (function (jcf) {
    jcf.addModule(function ($) {
      'use strict';
  
      return {
        name: 'Range',
        selector: 'input[type="range"]',
        options: {
          realElementClass: 'jcf-real-element',
          fakeStructure: '<span class="jcf-range"><span class="jcf-range-wrapper"><span class="jcf-range-track"><span class="jcf-range-handle"></span></span></span></span>',
          dataListMark: '<span class="jcf-range-mark"></span>',
          rangeDisplayWrapper: '<span class="jcf-range-display-wrapper"></span>',
          rangeDisplay: '<span class="jcf-range-display"></span>',
          handleSelector: '.jcf-range-handle',
          trackSelector: '.jcf-range-track',
          activeHandleClass: 'jcf-active-handle',
          verticalClass: 'jcf-vertical',
          orientation: 'horizontal',
          range: false,
          // or "min", "max", "all"
          dragHandleCenter: true,
          snapToMarks: true,
          snapRadius: 5,
          minRange: 0
        },
        matchElement: function matchElement(element) {
          return element.is(this.selector);
        },
        init: function init() {
          this.initStructure();
          this.attachEvents();
          this.refresh();
        },
        initStructure: function initStructure() {
          this.page = $('html');
          this.realElement = $(this.options.element).addClass(this.options.hiddenClass);
          this.fakeElement = $(this.options.fakeStructure).insertBefore(this.realElement).prepend(this.realElement);
          this.track = this.fakeElement.find(this.options.trackSelector);
          this.trackHolder = this.track.parent();
          this.handle = this.fakeElement.find(this.options.handleSelector);
          this.createdHandleCount = 0;
          this.activeDragHandleIndex = 0;
          this.isMultiple = this.realElement.prop('multiple') || typeof this.realElement.attr('multiple') === 'string';
          this.values = this.isMultiple ? this.realElement.attr('value').split(',') : [this.realElement.val()];
          this.handleCount = this.isMultiple ? this.values.length : 1; // create range display
  
          this.rangeDisplayWrapper = $(this.options.rangeDisplayWrapper).insertBefore(this.track);
  
          if (this.options.range === 'min' || this.options.range === 'all') {
            this.rangeMin = $(this.options.rangeDisplay).addClass('jcf-range-min').prependTo(this.rangeDisplayWrapper);
          }
  
          if (this.options.range === 'max' || this.options.range === 'all') {
            this.rangeMax = $(this.options.rangeDisplay).addClass('jcf-range-max').prependTo(this.rangeDisplayWrapper);
          } // clone handles if needed
  
  
          while (this.createdHandleCount < this.handleCount) {
            this.createdHandleCount++;
            this.handle.clone().addClass('jcf-index-' + this.createdHandleCount).insertBefore(this.handle); // create mid ranges
  
            if (this.createdHandleCount > 1) {
              if (!this.rangeMid) {
                this.rangeMid = $();
              }
  
              this.rangeMid = this.rangeMid.add($(this.options.rangeDisplay).addClass('jcf-range-mid').prependTo(this.rangeDisplayWrapper));
            }
          } // grab all handles
  
  
          this.handle.detach();
          this.handle = null;
          this.handles = this.fakeElement.find(this.options.handleSelector);
          this.handles.eq(0).addClass(this.options.activeHandleClass); // handle orientation
  
          this.isVertical = this.options.orientation === 'vertical';
          this.directionProperty = this.isVertical ? 'top' : 'left';
          this.offsetProperty = this.isVertical ? 'bottom' : 'left';
          this.eventProperty = this.isVertical ? 'pageY' : 'pageX';
          this.sizeProperty = this.isVertical ? 'height' : 'width';
          this.sizeMethod = this.isVertical ? 'innerHeight' : 'innerWidth';
          this.fakeElement.css('touchAction', this.isVertical ? 'pan-x' : 'pan-y');
  
          if (this.isVertical) {
            this.fakeElement.addClass(this.options.verticalClass);
          } // set initial values
  
  
          this.minValue = parseFloat(this.realElement.attr('min'));
          this.maxValue = parseFloat(this.realElement.attr('max'));
          this.stepValue = parseFloat(this.realElement.attr('step')) || 1; // check attribute values
  
          this.minValue = isNaN(this.minValue) ? 0 : this.minValue;
          this.maxValue = isNaN(this.maxValue) ? 100 : this.maxValue; // handle range
  
          if (this.stepValue !== 1) {
            this.maxValue -= (this.maxValue - this.minValue) % this.stepValue;
          }
  
          this.stepsCount = (this.maxValue - this.minValue) / this.stepValue;
          this.createDataList();
        },
        attachEvents: function attachEvents() {
          this.realElement.on({
            focus: this.onFocus
          });
          this.trackHolder.on('jcf-pointerdown', this.onTrackPress);
          this.handles.on('jcf-pointerdown', this.onHandlePress);
        },
        createDataList: function createDataList() {
          var self = this,
              dataValues = [],
              dataListId = this.realElement.attr('list');
  
          if (dataListId) {
            $('#' + dataListId).find('option').each(function () {
              var itemValue = parseFloat(this.value || this.innerHTML),
                  mark,
                  markOffset;
  
              if (!isNaN(itemValue)) {
                markOffset = self.valueToOffset(itemValue);
                dataValues.push({
                  value: itemValue,
                  offset: markOffset
                });
                mark = $(self.options.dataListMark).text(itemValue).attr({
                  'data-mark-value': itemValue
                }).css(self.offsetProperty, markOffset + '%').appendTo(self.track);
              }
            });
  
            if (dataValues.length) {
              self.dataValues = dataValues;
            }
          }
        },
        getDragHandleRange: function getDragHandleRange(handleIndex) {
          // calculate range for slider with multiple handles
          var minStep = -Infinity,
              maxStep = Infinity;
  
          if (handleIndex > 0) {
            minStep = this.valueToStepIndex(parseFloat(this.values[handleIndex - 1]) + this.options.minRange);
          }
  
          if (handleIndex < this.handleCount - 1) {
            maxStep = this.valueToStepIndex(parseFloat(this.values[handleIndex + 1]) - this.options.minRange);
          }
  
          return {
            minStepIndex: minStep,
            maxStepIndex: maxStep
          };
        },
        getNearestHandle: function getNearestHandle(percent) {
          // handle vertical sliders
          if (this.isVertical) {
            percent = 1 - percent;
          } // detect closest handle when track is pressed
  
  
          var closestHandle = this.handles.eq(0),
              closestDistance = Infinity,
              self = this;
  
          if (this.handleCount > 1) {
            this.handles.each(function () {
              var handleOffset = parseFloat(this.style[self.offsetProperty]) / 100,
                  handleDistance = Math.abs(handleOffset - percent);
  
              if (handleDistance < closestDistance) {
                closestDistance = handleDistance;
                closestHandle = $(this);
              }
            });
          }
  
          return closestHandle;
        },
        onTrackPress: function onTrackPress(e) {
          var trackSize, trackOffset, innerOffset;
          e.preventDefault();
  
          if (!this.realElement.is(':disabled') && !this.activeDragHandle) {
            trackSize = this.track[this.sizeMethod]();
            trackOffset = this.track.offset()[this.directionProperty];
            this.activeDragHandle = this.getNearestHandle((e[this.eventProperty] - trackOffset) / this.trackHolder[this.sizeMethod]());
            this.activeDragHandleIndex = this.handles.index(this.activeDragHandle);
            this.handles.removeClass(this.options.activeHandleClass).eq(this.activeDragHandleIndex).addClass(this.options.activeHandleClass);
            innerOffset = this.activeDragHandle[this.sizeMethod]() / 2;
            this.dragData = {
              trackSize: trackSize,
              innerOffset: innerOffset,
              trackOffset: trackOffset,
              min: trackOffset,
              max: trackOffset + trackSize
            };
            this.page.on({
              'jcf-pointermove': this.onHandleMove,
              'jcf-pointerup': this.onHandleRelease
            });
  
            if (e.pointerType === 'mouse') {
              this.realElement.focus();
            }
  
            this.onHandleMove(e);
          }
        },
        onHandlePress: function onHandlePress(e) {
          var trackSize, trackOffset, innerOffset;
          e.preventDefault();
  
          if (!this.realElement.is(':disabled') && !this.activeDragHandle) {
            this.activeDragHandle = $(e.currentTarget);
            this.activeDragHandleIndex = this.handles.index(this.activeDragHandle);
            this.handles.removeClass(this.options.activeHandleClass).eq(this.activeDragHandleIndex).addClass(this.options.activeHandleClass);
            trackSize = this.track[this.sizeMethod]();
            trackOffset = this.track.offset()[this.directionProperty];
            innerOffset = this.options.dragHandleCenter ? this.activeDragHandle[this.sizeMethod]() / 2 : e[this.eventProperty] - this.handle.offset()[this.directionProperty];
            this.dragData = {
              trackSize: trackSize,
              innerOffset: innerOffset,
              trackOffset: trackOffset,
              min: trackOffset,
              max: trackOffset + trackSize
            };
            this.page.on({
              'jcf-pointermove': this.onHandleMove,
              'jcf-pointerup': this.onHandleRelease
            });
  
            if (e.pointerType === 'mouse') {
              this.realElement.focus();
            }
          }
        },
        onHandleMove: function onHandleMove(e) {
          var self = this,
              newOffset,
              dragPercent,
              stepIndex,
              valuePercent,
              handleDragRange; // calculate offset
  
          if (this.isVertical) {
            newOffset = this.dragData.max + (this.dragData.min - e[this.eventProperty]) - this.dragData.innerOffset;
          } else {
            newOffset = e[this.eventProperty] - this.dragData.innerOffset;
          } // fit in range
  
  
          if (newOffset < this.dragData.min) {
            newOffset = this.dragData.min;
          } else if (newOffset > this.dragData.max) {
            newOffset = this.dragData.max;
          }
  
          e.preventDefault();
  
          if (this.options.snapToMarks && this.dataValues) {
            // snap handle to marks
            var dragOffset = newOffset - this.dragData.trackOffset;
            dragPercent = (newOffset - this.dragData.trackOffset) / this.dragData.trackSize * 100;
            $.each(this.dataValues, function (index, item) {
              var markOffset = item.offset / 100 * self.dragData.trackSize,
                  markMin = markOffset - self.options.snapRadius,
                  markMax = markOffset + self.options.snapRadius;
  
              if (dragOffset >= markMin && dragOffset <= markMax) {
                dragPercent = item.offset;
                return false;
              }
            });
          } else {
            // snap handle to steps
            dragPercent = (newOffset - this.dragData.trackOffset) / this.dragData.trackSize * 100;
          } // move handle only in range
  
  
          stepIndex = Math.round(dragPercent * this.stepsCount / 100);
  
          if (this.handleCount > 1) {
            handleDragRange = this.getDragHandleRange(this.activeDragHandleIndex);
  
            if (stepIndex < handleDragRange.minStepIndex) {
              stepIndex = Math.max(handleDragRange.minStepIndex, stepIndex);
            } else if (stepIndex > handleDragRange.maxStepIndex) {
              stepIndex = Math.min(handleDragRange.maxStepIndex, stepIndex);
            }
          }
  
          valuePercent = stepIndex * (100 / this.stepsCount);
  
          if (this.dragData.stepIndex !== stepIndex) {
            this.dragData.stepIndex = stepIndex;
            this.dragData.offset = valuePercent;
            this.activeDragHandle.css(this.offsetProperty, this.dragData.offset + '%'); // update value(s) and trigger "input" event
  
            this.values[this.activeDragHandleIndex] = '' + this.stepIndexToValue(stepIndex);
            this.updateValues();
            this.realElement.trigger('input');
          }
        },
        onHandleRelease: function onHandleRelease() {
          var newValue;
  
          if (typeof this.dragData.offset === 'number') {
            newValue = this.stepIndexToValue(this.dragData.stepIndex);
            this.realElement.val(newValue).trigger('change');
          }
  
          this.page.off({
            'jcf-pointermove': this.onHandleMove,
            'jcf-pointerup': this.onHandleRelease
          });
          delete this.activeDragHandle;
          delete this.dragData;
        },
        onFocus: function onFocus() {
          if (!this.fakeElement.hasClass(this.options.focusClass)) {
            this.fakeElement.addClass(this.options.focusClass);
            this.realElement.on({
              blur: this.onBlur,
              keydown: this.onKeyPress
            });
          }
        },
        onBlur: function onBlur() {
          this.fakeElement.removeClass(this.options.focusClass);
          this.realElement.off({
            blur: this.onBlur,
            keydown: this.onKeyPress
          });
        },
        onKeyPress: function onKeyPress(e) {
          var incValue = e.which === 38 || e.which === 39,
              decValue = e.which === 37 || e.which === 40; // handle TAB key in slider with multiple handles
  
          if (e.which === 9 && this.handleCount > 1) {
            if (e.shiftKey && this.activeDragHandleIndex > 0) {
              this.activeDragHandleIndex--;
            } else if (!e.shiftKey && this.activeDragHandleIndex < this.handleCount - 1) {
              this.activeDragHandleIndex++;
            } else {
              return;
            }
  
            e.preventDefault();
            this.handles.removeClass(this.options.activeHandleClass).eq(this.activeDragHandleIndex).addClass(this.options.activeHandleClass);
          } // handle cursor keys
  
  
          if (decValue || incValue) {
            e.preventDefault();
            this.step(incValue ? this.stepValue : -this.stepValue);
          }
        },
        updateValues: function updateValues() {
          var value = this.values.join(',');
  
          if (this.values.length > 1) {
            this.realElement.prop('valueLow', this.values[0]);
            this.realElement.prop('valueHigh', this.values[this.values.length - 1]);
            this.realElement.val(value); // if browser does not accept multiple values set only one
  
            if (this.realElement.val() !== value) {
              this.realElement.val(this.values[this.values.length - 1]);
            }
          } else {
            this.realElement.val(value);
          }
  
          this.updateRanges();
        },
        updateRanges: function updateRanges() {
          // update display ranges
          var self = this,
              handle;
  
          if (this.rangeMin) {
            handle = this.handles[0];
            this.rangeMin.css(this.offsetProperty, 0).css(this.sizeProperty, handle.style[this.offsetProperty]);
          }
  
          if (this.rangeMax) {
            handle = this.handles[this.handles.length - 1];
            this.rangeMax.css(this.offsetProperty, handle.style[this.offsetProperty]).css(this.sizeProperty, 100 - parseFloat(handle.style[this.offsetProperty]) + '%');
          }
  
          if (this.rangeMid) {
            this.handles.each(function (index, curHandle) {
              var prevHandle, midBox;
  
              if (index > 0) {
                prevHandle = self.handles[index - 1];
                midBox = self.rangeMid[index - 1];
                midBox.style[self.offsetProperty] = prevHandle.style[self.offsetProperty];
                midBox.style[self.sizeProperty] = parseFloat(curHandle.style[self.offsetProperty]) - parseFloat(prevHandle.style[self.offsetProperty]) + '%';
              }
            });
          }
        },
        step: function step(changeValue) {
          var originalValue = parseFloat(this.values[this.activeDragHandleIndex || 0]),
              newValue = originalValue,
              minValue = this.minValue,
              maxValue = this.maxValue;
  
          if (isNaN(originalValue)) {
            newValue = 0;
          }
  
          newValue += changeValue;
  
          if (this.handleCount > 1) {
            if (this.activeDragHandleIndex > 0) {
              minValue = parseFloat(this.values[this.activeDragHandleIndex - 1]) + this.options.minRange;
            }
  
            if (this.activeDragHandleIndex < this.handleCount - 1) {
              maxValue = parseFloat(this.values[this.activeDragHandleIndex + 1]) - this.options.minRange;
            }
          }
  
          if (newValue > maxValue) {
            newValue = maxValue;
          } else if (newValue < minValue) {
            newValue = minValue;
          }
  
          if (newValue !== originalValue) {
            this.values[this.activeDragHandleIndex || 0] = '' + newValue;
            this.updateValues();
            this.realElement.trigger('input').trigger('change');
            this.setSliderValue(this.values);
          }
        },
        valueToStepIndex: function valueToStepIndex(value) {
          return (value - this.minValue) / this.stepValue;
        },
        stepIndexToValue: function stepIndexToValue(stepIndex) {
          return this.minValue + this.stepValue * stepIndex;
        },
        valueToOffset: function valueToOffset(value) {
          var range = this.maxValue - this.minValue,
              percent = (value - this.minValue) / range;
          return percent * 100;
        },
        getSliderValue: function getSliderValue() {
          return $.map(this.values, function (value) {
            return parseFloat(value) || 0;
          });
        },
        setSliderValue: function setSliderValue(values) {
          // set handle position accordion according to value
          var self = this;
          this.handles.each(function (index, handle) {
            handle.style[self.offsetProperty] = self.valueToOffset(values[index]) + '%';
          });
        },
        refresh: function refresh() {
          // handle disabled state
          var isDisabled = this.realElement.is(':disabled');
          this.fakeElement.toggleClass(this.options.disabledClass, isDisabled); // refresh handle position according to current value
  
          this.setSliderValue(this.getSliderValue());
          this.updateRanges();
        },
        destroy: function destroy() {
          this.realElement.removeClass(this.options.hiddenClass).insertBefore(this.fakeElement);
          this.fakeElement.remove();
          this.realElement.off({
            keydown: this.onKeyPress,
            focus: this.onFocus,
            blur: this.onBlur
          });
        }
      };
    });
  })(jcf);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/drawer/js/drawer.js":
  /*!*********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/drawer/js/drawer.js ***!
    \*********************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _menu_accessability_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./menu-accessability.js */ "../../ui-core/plugins/drawer/js/menu-accessability.js");
  /* harmony import */ var _menu_accessability_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_menu_accessability_js__WEBPACK_IMPORTED_MODULE_0__);
  
  
  (function () {
    //document.activeElement
    var $body = $('body'),
        $window = $(window),
        tabKey = 9,
        shift = 16,
        escKey = 27,
        nestedMenu;
    var menu = {
      $toggle: $('[data-toggle="nav"]'),
      $target: null,
      revers: false,
      lastItem: null,
      items: null,
      vPort: ["screen-sm"],
      isMobile: false,
      // variable use to determine if responsive mode is on or off
      menuHeaderMainTitle: '',
      redirectPath: false,
      displayedNestedItems: false,
      init: function init() {
        var menu1 = new menubar('menubar', false);
        $('.main-nav').each(function (index) {
          menu.$target = $(this);
          var $header = menu.$target.find('.menu-header');
          menu.menuHeaderMainTitle = $header.text();
          menu.redirectPath = $header.data('redirect-to');
          menu.check.viewPort(index);
          menu.responsive(index);
        });
        menu.items = $('.main-nav').find('a, button, input'); //$(".header__nav a, .header__nav button, .header__nav input");
  
        menu.control();
        menu.additionalControl();
      },
      responsive: function responsive(index) {
        $(document).on(menu.vPort[index] + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          menu.isMobile = true;
          $('.main-nav').each(function () {
            if ($(this).find('.drawer__nav').data('ctrl-res') == menu.vPort[index]) {
              $(this).addClass("menu--res"); // class will be used in our scss (to replace media queries)
  
              $('.main-nav__toggle__controller').addClass("main-nav__toggle__controller__res"); // class will be used in our scss (to replace media queries)
  
              menu.on.rebuild.responsive(); // rebuild menu to be responsive - drawer
            }
          });
        });
        $(document).on(menu.vPort[index] + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          menu.isMobile = false;
          $('.main-nav').each(function () {
            if ($(this).find('.drawer__nav').data('ctrl-res') == menu.vPort[index]) {
              $(this).removeClass("menu--res"); // class will be used in our scss (to replace media queries)
  
              $('.main-nav__toggle__controller').removeClass("main-nav__toggle__controller__res"); // class will be used in our scss (to replace media queries)
  
              menu.on.rebuild.original(); // return menu as default
            }
          });
        });
      },
      control: function control() {
        $body.on('click', '[data-toggle="nav"]', function (e) {
          e.preventDefault();
          menu.$toggle = $(this);
          menu.$target = $('#' + menu.$toggle.data('target'));
          menu.items = menu.$target.find('a, button, input'); //$(".header__nav a, .header__nav button, .header__nav input");
  
          menu.items.each(function (index) {
            if (index === menu.items.length - 1) {
              menu.lastItem = $(this);
            }
          });
          menu.on.show(e);
        });
        $body.on('click', '.js--open[data-toggle="nav"]', function (e) {
          e.preventDefault();
          menu.on.hide(e);
        });
        $body.on('click', function (e) {
          if (!$(e.target).closest('.dropdown__toggle').length) {
            $("a.dropdown__toggle.hover").removeClass("hover");
          }
  
          if (!$(e.target).hasClass("icon-arrow_r") && !$(e.target).parents(".main-nav__toggle__controller") && !$(e.target).parents('.main-nav.menu--res').length && $('.lock-screen[data-active="menu"]').length) {
            menu.on.hide(e);
          }
        });
        $body.on('click', '.main-nav a', function (e) {
          if ($(this).attr('href') == "#") {
            e.preventDefault();
          }
        });
        $body.on('click', '[data-toggle="dropdown"]', function (e) {
          e.preventDefault();
          nestedMenu = $(this);
          menu.on.nested(e);
        });
        $body.on('click', '.menu-header', function (e) {
          e.preventDefault();
  
          if (menu.isMobile) {
            menu.on.hideNested(true);
          }
  
          e.stopPropagation(); // prevent closing menu when getting back from nested menu
        });
        $body.on('keydown', '.drawer__nav, [data-toggle="nav"]', function (e) {
          if (menu.isMobile) {
            if ((e.keyCode || e.which) === tabKey) {
              if (!menu.revers) {
                menu.on.tab();
              } else {
                menu.on.tabRevers();
              }
            }
          }
        });
        $window.on('keyup', function (e) {
          menu.revers = false;
  
          if (e.shiftKey && e.keyCode === tabKey) {
            menu.revers = true;
          }
  
          if (!menu.isMobile) {
            if ((e.keyCode || e.which) === tabKey) {
              if (!menu.revers) {
                menu.on.tabDesktop(e);
              } else {
                menu.on.tabReversDesktop(e);
              }
            }
  
            if ((e.keyCode || e.which) === escKey) {
              menu.on.escDesktop(e);
            }
          }
        });
      },
      additionalControl: function additionalControl() {},
      on: {
        show: function show() {
          if (typeof UX.controller != "undefined") {
            UX.controller.check();
          }
  
          $body.addClass('lock-screen').attr('data-active', 'menu');
          menu.$toggle.addClass('js--open');
          menu.$target.closest('.main-nav').css('top', $window.scrollTop());
          $('.coolBar--res').removeClass('trans').css('top', $window.scrollTop() + $('header').height());
          $('.loi__banner.loi--res').css('top', $window.scrollTop() + $('header').height());
          menu.$target.attr("style", "display: block !important");
          menu.$toggle.focus();
          menu.on.showAdditional();
        },
        showAdditional: function showAdditional() {},
        showNested: function showNested() {
          nestedMenu.next('.dropdown__menu').toggleClass('sub-menu__opened');
          nestedMenu.parent().toggleClass('menu-parent__opened');
          nestedMenu.find('i').toggleClass('opposite-arrow');
          nestedMenu.parent().siblings('li').toggleClass('prev-items');
          nestedMenu.toggleClass('prev-items');
          $("[data-toggle='nav']").addClass("js--nested-open"); // replace Close button with back button after nested menu get opened
  
          var $menuTitle = nestedMenu.html();
  
          if ($('.menu-header').length) {
            $('.menu-header').html($menuTitle);
          }
  
          menu.displayedNestedItems = true;
          menu.on.showNestedExtra();
        },
        showNestedExtra: function showNestedExtra() {},
        hideNested: function hideNested() {
          var shouldNavigate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
          var $menuHeader = $('.menu-header');
          var $parenNestedMenu;
  
          if (typeof nestedMenu != 'undefined') {
            $parenNestedMenu = nestedMenu.parent().parent(); // first parent list
  
            nestedMenu = $parenNestedMenu.parent().find('.dropdown__toggle'); // first parent dropdown toggle link
  
            $parenNestedMenu.find('.sub-menu__opened').removeClass('sub-menu__opened');
            $parenNestedMenu.find('.menu-parent__opened').removeClass('menu-parent__opened');
            $parenNestedMenu.find('.prev-items').removeClass('prev-items');
            $("[data-toggle='nav']").removeClass("js--nested-open");
  
            if ($parenNestedMenu.hasClass('sub-menu__opened')) {
              $menuHeader.find('span').html(nestedMenu.find('span').html());
            } else {
              if (menu.redirectPath && shouldNavigate && !menu.displayedNestedItems) {
                document.location = menu.redirectPath;
              } else {
                $menuHeader.html(menu.menuHeaderMainTitle);
                menu.displayedNestedItems = false;
              }
            }
          } else {
            nestedMenu = $menuHeader;
          }
  
          menu.on.hideNestedExtra();
        },
        hideNestedExtra: function hideNestedExtra() {},
        hide: function hide() {
          if (menu.isMobile) {
            // hide nested menu before closing
            menu.on.hideNested();
          }
  
          menu.$toggle.removeClass('js--open');
          $('.main-nav, header').css('top', 0);
          $('.coolBar--res').addClass('trans').css('top', $('header').height()); // The magic number contains 1px of border and
  
          $('.loi__banner.loi--res').css('top', $('header').height());
          $body.removeAttr('data-active').removeClass('lock-screen');
        },
        escape: function escape() {
          menu.on.hide();
          menu.$toggle.focus();
        },
        tab: function tab() {
          menu.$toggle.off();
          menu.lastItem.off().on('focusout', function () {
            menu.$toggle.focus();
          });
        },
        tabRevers: function tabRevers() {
          menu.lastItem.off();
          menu.$toggle.off().on('focusout', function () {
            menu.lastItem.focus();
          });
        },
        tabDesktop: function tabDesktop(e) {
          if ($(e.target).hasClass("dropdown__toggle")) {
            if ($(e.target).closest(".hover").length == 0) {
              $('.dropdown__toggle').removeClass('hover');
              $('.dropdown').removeClass('js--open');
            }
  
            $(e.target).closest("a").addClass("hover");
          } else {
            $(e.target).closest("ul").find('.hover').each(function () {
              $(this).removeClass('hover');
            });
          }
        },
        tabReversDesktop: function tabReversDesktop(e) {
          if ($(e.target).hasClass("dropdown__toggle")) {
            if ($(e.target).closest(".hover").length == 0) {
              $('.dropdown__toggle').removeClass('hover');
            }
  
            $(e.target).closest("a").addClass("hover");
          } else if ($(e.target).closest(".hubpage-menu").length == 0 && $(e.target).closest(".main-nav").length == 0) {
            $('.dropdown__toggle').removeClass('hover');
          }
        },
        escDesktop: function escDesktop(e) {
          $(e.target).closest(".dropdown__toggle").removeClass("hover");
        },
        rebuild: {
          responsive: function responsive() {
            menu.on.hide();
          },
          original: function original() {
            menu.on.hide();
            menu.$target.show();
          }
        },
        nested: function nested(e) {
          //e.preventDefault();
          if (menu.isMobile) {
            menu.on.showNested();
          }
        }
      },
      check: {
        viewPort: function viewPort(index) {
          if (menu.$target.find('.drawer__nav').attr('data-ctrl-res')) {
            menu.vPort[index] = menu.$target.find('.drawer__nav').attr('data-ctrl-res');
          }
  
          ;
        }
      }
    };
    UX.menu = menu; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/drawer/js/menu-accessability.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/drawer/js/menu-accessability.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function menubar(e, t) {
    this.$id = $("#" + e), this.$rootItems = this.$id.children("li"), this.$items = this.$id.find(".menu-item"), this.$parents = this.$id.find(".menu-parent"), this.$allItems = this.$parents.add(this.$items), this.$activeItem = null, this.vmenu = t, this.bChildOpen = !1, this.keys = {
      tab: 9,
      enter: 13,
      esc: 27,
      space: 32,
      left: 37,
      up: 38,
      right: 39,
      down: 40
    }, this.bindHandlers();
  }
  
  menubar.prototype.bindHandlers = function () {
    var e = this;
    this.$allItems.keydown(function (t) {
      return e.handleKeyDown($(this), t);
    }), this.$allItems.keypress(function (t) {
      return e.handleKeyPress($(this), t);
    }), this.$allItems.focus(function (t) {
      return e.handleFocus($(this), t);
    }), $(document).click(function (t) {
      return e.handleDocumentClick(t);
    });
  };
  
  menubar.prototype.handleFocus = function (e, t) {
    if (null == this.$activeItem) this.$activeItem = e;else if (e[0] != this.$activeItem[0]) return !0;
    var i = this.$activeItem.parentsUntil("div").filter("li");
    if (this.$allItems.removeClass("menu-focus menu-focus-checked"), this.$activeItem.is(".checked") ? this.$activeItem.addClass("menu-focus-checked") : this.$activeItem.addClass("menu-focus"), i.addClass("menu-focus"), 1 == this.vmenu) if (1 == this.bChildOpen) {
      var s = e.parent();
      s.is("#menubar") && "true" == e.attr("aria-haspopup") && e.addClass('hover').children("ul").attr("aria-hidden", "false");
    } else this.vmenu = !1;
    return !0;
  };
  
  menubar.prototype.handleKeyDown = function (e, t) {
    if (t.altKey || t.ctrlKey) return !0;
  
    switch (t.keyCode) {
      case this.keys.tab:
        this.$id.find("ul").attr("aria-hidden", "true"), this.$allItems.removeClass("menu-focus hover"), this.$activeItem = null, 0 == this.bChildOpen;
        break;
  
      case this.keys.esc:
        if (UX.menu.$toggle.length > 0) {
          //if (e.keyCode  === escKey) {
          //e.preventDefault();
          UX.menu.on.hide();
          UX.menu.$toggle.focus(); //}
        } else {
          var i = e.parent();
          return i.is("#menubar") ? (e.removeClass('hover').children("ul").first().attr("aria-hidden", "true"), e.focus()) : (this.$activeItem = i.parent(), e.removeClass('hover'), this.bChildOpen = !1, this.$activeItem.focus(), i.attr("aria-hidden", "true")), t.stopPropagation(), !1;
        }
  
      case this.keys.enter:
      case this.keys.space:
        var s = e.parent();
        return s.is("#menubar") ? (e.addClass('hover').children("ul").first().attr("aria-hidden", "false"), this.bChildOpen = !0, this.processMenuChoice(e), e.find("ul > li:first").find("a").focus()) : (this.processMenuChoice(e), this.$allItems.removeClass("menu-hover menu-hover-checked hover"), this.$allItems.removeClass("menu-focus menu-focus-checked hover"), this.$id.find("ul").not("#menubar").attr("aria-hidden", "true"), this.$activeItem = null), t.stopPropagation(), !1;
  
      case this.keys.left:
        return 1 == this.vmenu && i.is("#menubar") ? this.$activeItem = this.moveUp(e) : this.$activeItem = this.moveToPrevious(e), this.$activeItem.focus(), t.stopPropagation(), !1;
  
      case this.keys.right:
        return 1 == this.vmenu && i.is("#menubar") ? this.$activeItem = this.moveDown(e) : this.$activeItem = this.moveToNext(e), this.$activeItem.focus(), t.stopPropagation(), !1;
  
      case this.keys.up:
        return 1 == this.vmenu && i.is("#menubar") ? this.$activeItem = this.moveToPrevious(e) : this.$activeItem = this.moveUp(e), this.$activeItem.focus(), t.stopPropagation(), !1;
  
      case this.keys.down:
        return 1 == this.vmenu && i.is("#menubar") ? this.$activeItem = this.moveToNext(e) : this.$activeItem = this.moveDown(e), this.$activeItem.focus(), t.stopPropagation(), !1;
    }
  
    return !0;
  };
  
  menubar.prototype.moveToNext = function (e) {
    var t = e.parent(),
        i = t.children("li"),
        s = i.length,
        r = i.index(e),
        n = null;
  
    if (t.is("#menubar")) {
      if (n = s - 1 > r ? e.next() : i.first(), "true" == e.attr("aria-haspopup")) {
        e.removeClass('hover');
        var a = e.children("ul").first();
        "false" == a.attr("aria-hidden") && (a.attr("aria-hidden", "true"), this.bChildOpen = !0);
      }
  
      if (e.removeClass("menu-focus"), "true" == n.attr("aria-haspopup") && 1 == this.bChildOpen) {
        n.addClass('hover');
        var a = n.children("ul").first();
        a.attr("aria-hidden", "false");
      }
    } else if ("true" == e.attr("aria-haspopup")) {
      e.addClass('hover');
      var a = e.children("ul").first();
      n = a.children("li").first(), a.attr("aria-hidden", "false"), this.bChildOpen = !0;
    } else {
      if (1 == this.vmenu) return e;
      var h = null,
          o = null;
  
      if (h = e.parentsUntil("div").filter("ul").not("#menubar"), h.attr("aria-hidden", "true"), h.find("li").removeClass("menu-focus hover"), h.last().parent().removeClass("menu-focus hover"), o = h.last().parent(), r = this.$rootItems.index(o), n = r < this.$rootItems.length - 1 ? o.next() : this.$rootItems.first(), "true" == n.attr("aria-haspopup") && n.children("ul").length > 0) {
        n.addClass('hover');
        var a = n.children("ul").first();
        n = a.children("li").first(), a.attr("aria-hidden", "false"), this.bChildOpen = !0;
      }
    }
  
    return n;
  };
  
  menubar.prototype.moveToPrevious = function (e) {
    var t = e.parent(),
        i = t.children("li"),
        s = (i.length, i.index(e)),
        r = null;
  
    if (t.is("#menubar")) {
      if (r = s > 0 ? e.prev() : i.last(), "true" == e.attr("aria-haspopup")) {
        var n = e.removeClass('hover').children("ul").first();
        "false" == n.attr("aria-hidden") && (n.attr("aria-hidden", "true"), this.bChildOpen = !0);
      }
  
      if (e.removeClass("menu-focus hover"), "true" == r.attr("aria-haspopup") && 1 == this.bChildOpen) {
        r.addClass('hover');
        var n = r.children("ul").first();
        n.attr("aria-hidden", "false");
      }
    } else {
      var a = t.parent(),
          h = a.parent();
  
      if (1 != this.vmenu && h.is("#menubar")) {
        if (t.attr("aria-hidden", "true"), e.removeClass("menu-focus hover"), a.removeClass("menu-focus hover"), s = this.$rootItems.index(a), r = s > 0 ? a.prev() : this.$rootItems.last(), r.addClass("menu-focus hover"), "true" == r.attr("aria-haspopup")) {
          var n = null;
          r.children("ul").length > 0 && (n = r.addClass('hover').children("ul").first(), n.attr("aria-hidden", "false"), this.bChildOpen = !0, r = n.children("li").first());
        }
      } else r = t.parent(), t.attr("aria-hidden", "true"), e.removeClass("menu-focus hover"), r.removeClass("hover"), 1 == this.vmenu && (this.bChildOpen = !1);
    }
  
    return r;
  };
  
  menubar.prototype.moveDown = function (e, t) {
    var i = e.parent(),
        s = i.children("li").not(".separator"),
        r = s.length,
        n = s.index(e),
        a = null,
        h = null;
    if (i.is("#menubar")) return "true" != e.attr("aria-haspopup") ? e : (h = e.addClass('hover').children("ul").first(), a = h.children("li").first(), h.attr("aria-hidden", "false"), this.bChildOpen = !0, a);
  
    if (t) {
      var o = !1,
          u = n + 1;
  
      for (u == r && (u = 0); u != n;) {
        var l = s.eq(u).html().charAt(0);
  
        if (l.toLowerCase() == t) {
          o = !0;
          break;
        }
  
        u += 1, u == r && (u = 0);
      }
  
      return 1 == o ? (a = s.eq(u), e.removeClass("menu-focus menu-focus-checked"), a) : e;
    }
  
    return a = r - 1 > n ? s.eq(n + 1) : s.first(), e.removeClass("menu-focus menu-focus-checked"), a;
  };
  
  menubar.prototype.moveUp = function (e) {
    var t = e.parent(),
        i = t.children("li").not(".separator"),
        s = (i.length, i.index(e)),
        r = null;
    return t.is("#menubar") ? e : (r = s > 0 ? i.eq(s - 1) : i.last(), e.removeClass("menu-focus menu-focus-checked"), r);
  };
  
  menubar.prototype.handleKeyPress = function (e, t) {
    if (t.altKey || t.ctrlKey || t.shiftKey) return !0;
  
    switch (t.keyCode) {
      case this.keys.tab:
        return !0;
  
      case this.keys.esc:
      case this.keys.enter:
      case this.keys.space:
      case this.keys.up:
      case this.keys.down:
      case this.keys.left:
      case this.keys.right:
        return t.stopPropagation(), !1;
  
      default:
        var i = String.fromCharCode(t.which);
        return this.$activeItem = this.moveDown(e, i), this.$activeItem.focus(), t.stopPropagation(), !1;
    }
  
    return !0;
  };
  
  menubar.prototype.handleDocumentClick = function (e) {
    var t = this.$id.find("ul").not("#menubar");
    return t.attr("aria-hidden", "true"), this.$allItems.removeClass("menu-focus menu-focus-checked hover"), this.$activeItem = null, !0;
  };
  
  menubar.prototype.processMenuChoice = function (e) {
    var t = (e.parent().attr("id"), e.attr("id"), e.data("href"));
    if (null != t) if (t.toLowerCase().indexOf("legacy.") > 0) {
      var i = window.open(t, "_blank");
      i.focus();
    } else window.location.href = t;
    var s = e.find("a");
    null != s && (window.location.href = s[0].href);
  };
  
  window.menubar = menubar;
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/enquireJs/js/enquire.js":
  /*!*************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/enquireJs/js/enquire.js ***!
    \*************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /*!
   * enquire.js v2.1.2 - Awesome Media Queries in JavaScript
   * Copyright (c) 2014 Nick Williams - http://wicky.nillia.ms/enquire.js
   * License: MIT (http://www.opensource.org/licenses/mit-license.php)
   */
  ;
  
  (function (name, context, factory) {
    var matchMedia = window.matchMedia;
    /*if (typeof module !== 'undefined' && module.exports) {
      module.exports = factory(matchMedia);
    }
    else if (typeof define === 'function' && define.amd) {
      define(function() {
        return (context[name] = factory(matchMedia));
      });
    }
    else {
      context[name] = factory(matchMedia);
    }*/
  
    context[name] = factory(matchMedia);
  })('enquire', window, function (matchMedia) {
    'use strict';
    /*jshint unused:false */
  
    /**
     * Helper function for iterating over a collection
     *
     * @param collection
     * @param fn
     */
  
    function each(collection, fn) {
      var i = 0,
          length = collection.length,
          cont;
  
      for (i; i < length; i++) {
        cont = fn(collection[i], i);
  
        if (cont === false) {
          break; //allow early exit
        }
      }
    }
    /**
     * Helper function for determining whether target object is an array
     *
     * @param target the object under test
     * @return {Boolean} true if array, false otherwise
     */
  
  
    function isArray(target) {
      return Object.prototype.toString.apply(target) === '[object Array]';
    }
    /**
     * Helper function for determining whether target object is a function
     *
     * @param target the object under test
     * @return {Boolean} true if function, false otherwise
     */
  
  
    function isFunction(target) {
      return typeof target === 'function';
    }
    /**
     * Delegate to handle a media query being matched and unmatched.
     *
     * @param {object} options
     * @param {function} options.match callback for when the media query is matched
     * @param {function} [options.unmatch] callback for when the media query is unmatched
     * @param {function} [options.setup] one-time callback triggered the first time a query is matched
     * @param {boolean} [options.deferSetup=false] should the setup callback be run immediately, rather than first time query is matched?
     * @constructor
     */
  
  
    function QueryHandler(options) {
      this.options = options;
      !options.deferSetup && this.setup();
    }
  
    QueryHandler.prototype = {
      /**
       * coordinates setup of the handler
       *
       * @function
       */
      setup: function setup() {
        if (this.options.setup) {
          this.options.setup();
        }
  
        this.initialised = true;
      },
  
      /**
       * coordinates setup and triggering of the handler
       *
       * @function
       */
      on: function on() {
        !this.initialised && this.setup();
        this.options.match && this.options.match();
      },
  
      /**
       * coordinates the unmatch event for the handler
       *
       * @function
       */
      off: function off() {
        this.options.unmatch && this.options.unmatch();
      },
  
      /**
       * called when a handler is to be destroyed.
       * delegates to the destroy or unmatch callbacks, depending on availability.
       *
       * @function
       */
      destroy: function destroy() {
        this.options.destroy ? this.options.destroy() : this.off();
      },
  
      /**
       * determines equality by reference.
       * if object is supplied compare options, if function, compare match callback
       *
       * @function
       * @param {object || function} [target] the target for comparison
       */
      equals: function equals(target) {
        return this.options === target || this.options.match === target;
      }
    };
    /**
     * Represents a single media query, manages it's state and registered handlers for this query
     *
     * @constructor
     * @param {string} query the media query string
     * @param {boolean} [isUnconditional=false] whether the media query should run regardless of whether the conditions are met. Primarily for helping older browsers deal with mobile-first design
     */
  
    function MediaQuery(query, isUnconditional) {
      this.query = query;
      this.isUnconditional = isUnconditional;
      this.handlers = [];
      this.mql = matchMedia(query);
      var self = this;
  
      this.listener = function (mql) {
        self.mql = mql;
        self.assess();
      };
  
      this.mql.addListener(this.listener);
    }
  
    MediaQuery.prototype = {
      /**
       * add a handler for this query, triggering if already active
       *
       * @param {object} handler
       * @param {function} handler.match callback for when query is activated
       * @param {function} [handler.unmatch] callback for when query is deactivated
       * @param {function} [handler.setup] callback for immediate execution when a query handler is registered
       * @param {boolean} [handler.deferSetup=false] should the setup callback be deferred until the first time the handler is matched?
       */
      addHandler: function addHandler(handler) {
        var qh = new QueryHandler(handler);
        this.handlers.push(qh);
        this.matches() && qh.on();
      },
  
      /**
       * removes the given handler from the collection, and calls it's destroy methods
       * 
       * @param {object || function} handler the handler to remove
       */
      removeHandler: function removeHandler(handler) {
        var handlers = this.handlers;
        each(handlers, function (h, i) {
          if (h.equals(handler)) {
            h.destroy();
            return !handlers.splice(i, 1); //remove from array and exit each early
          }
        });
      },
  
      /**
       * Determine whether the media query should be considered a match
       * 
       * @return {Boolean} true if media query can be considered a match, false otherwise
       */
      matches: function matches() {
        return this.mql.matches || this.isUnconditional;
      },
  
      /**
       * Clears all handlers and unbinds events
       */
      clear: function clear() {
        each(this.handlers, function (handler) {
          handler.destroy();
        });
        this.mql.removeListener(this.listener);
        this.handlers.length = 0; //clear array
      },
  
      /*
       * Assesses the query, turning on all handlers if it matches, turning them off if it doesn't match
       */
      assess: function assess() {
        var action = this.matches() ? 'on' : 'off';
        each(this.handlers, function (handler) {
          handler[action]();
        });
      }
    };
    /**
     * Allows for registration of query handlers.
     * Manages the query handler's state and is responsible for wiring up browser events
     *
     * @constructor
     */
  
    function MediaQueryDispatch() {
      if (!matchMedia) {
        throw new Error('matchMedia not present, legacy browsers require a polyfill');
      }
  
      this.queries = {};
      this.browserIsIncapable = !matchMedia('only all').matches;
    }
  
    MediaQueryDispatch.prototype = {
      /**
       * Registers a handler for the given media query
       *
       * @param {string} q the media query
       * @param {object || Array || Function} options either a single query handler object, a function, or an array of query handlers
       * @param {function} options.match fired when query matched
       * @param {function} [options.unmatch] fired when a query is no longer matched
       * @param {function} [options.setup] fired when handler first triggered
       * @param {boolean} [options.deferSetup=false] whether setup should be run immediately or deferred until query is first matched
       * @param {boolean} [shouldDegrade=false] whether this particular media query should always run on incapable browsers
       */
      register: function register(q, options, shouldDegrade) {
        var queries = this.queries,
            isUnconditional = shouldDegrade && this.browserIsIncapable;
  
        if (!queries[q]) {
          queries[q] = new MediaQuery(q, isUnconditional);
        } //normalise to object in an array
  
  
        if (isFunction(options)) {
          options = {
            match: options
          };
        }
  
        if (!isArray(options)) {
          options = [options];
        }
  
        each(options, function (handler) {
          if (isFunction(handler)) {
            handler = {
              match: handler
            };
          }
  
          queries[q].addHandler(handler);
        });
        return this;
      },
  
      /**
       * unregisters a query and all it's handlers, or a specific handler for a query
       *
       * @param {string} q the media query to target
       * @param {object || function} [handler] specific handler to unregister
       */
      unregister: function unregister(q, handler) {
        var query = this.queries[q];
  
        if (query) {
          if (handler) {
            query.removeHandler(handler);
          } else {
            query.clear();
            delete this.queries[q];
          }
        }
  
        return this;
      }
    };
    return new MediaQueryDispatch();
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/jquery-ui/jquery-ui.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/jquery-ui/jquery-ui.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /*! jQuery UI - v1.12.1 - 2018-04-24
  * http://jqueryui.com
  * Includes: widget.js, data.js, jquery-1-7.js, keycode.js, scroll-parent.js, widgets/sortable.js, widgets/datepicker.js, widgets/mouse.js, widgets/slider.js
  * Copyright jQuery Foundation and other contributors; Licensed MIT */
  (function (factory) {
    // if ( typeof define === "function" && define.amd ) {
    //
    // 	// AMD. Register as an anonymous module.
    // 	define([ "jquery" ], factory );
    // } else {
    // Browser globals
    factory(jQuery); //}
  })(function ($) {
    $.ui = $.ui || {};
    var version = $.ui.version = "1.12.1";
    /*!
     * jQuery UI Widget 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Widget
    //>>group: Core
    //>>description: Provides a factory for creating stateful widgets with a common API.
    //>>docs: http://api.jqueryui.com/jQuery.widget/
    //>>demos: http://jqueryui.com/widget/
  
    var widgetUuid = 0;
    var widgetSlice = Array.prototype.slice;
  
    $.cleanData = function (orig) {
      return function (elems) {
        var events, elem, i;
  
        for (i = 0; (elem = elems[i]) != null; i++) {
          try {
            // Only trigger remove when necessary to save time
            events = $._data(elem, "events");
  
            if (events && events.remove) {
              $(elem).triggerHandler("remove");
            } // Http://bugs.jquery.com/ticket/8235
  
          } catch (e) {}
        }
  
        orig(elems);
      };
    }($.cleanData);
  
    $.widget = function (name, base, prototype) {
      var existingConstructor, constructor, basePrototype; // ProxiedPrototype allows the provided prototype to remain unmodified
      // so that it can be used as a mixin for multiple widgets (#8876)
  
      var proxiedPrototype = {};
      var namespace = name.split(".")[0];
      name = name.split(".")[1];
      var fullName = namespace + "-" + name;
  
      if (!prototype) {
        prototype = base;
        base = $.Widget;
      }
  
      if ($.isArray(prototype)) {
        prototype = $.extend.apply(null, [{}].concat(prototype));
      } // Create selector for plugin
  
  
      $.expr[":"][fullName.toLowerCase()] = function (elem) {
        return !!$.data(elem, fullName);
      };
  
      $[namespace] = $[namespace] || {};
      existingConstructor = $[namespace][name];
  
      constructor = $[namespace][name] = function (options, element) {
        // Allow instantiation without "new" keyword
        if (!this._createWidget) {
          return new constructor(options, element);
        } // Allow instantiation without initializing for simple inheritance
        // must use "new" keyword (the code above always passes args)
  
  
        if (arguments.length) {
          this._createWidget(options, element);
        }
      }; // Extend with the existing constructor to carry over any static properties
  
  
      $.extend(constructor, existingConstructor, {
        version: prototype.version,
        // Copy the object used to create the prototype in case we need to
        // redefine the widget later
        _proto: $.extend({}, prototype),
        // Track widgets that inherit from this widget in case this widget is
        // redefined after a widget inherits from it
        _childConstructors: []
      });
      basePrototype = new base(); // We need to make the options hash a property directly on the new instance
      // otherwise we'll modify the options hash on the prototype that we're
      // inheriting from
  
      basePrototype.options = $.widget.extend({}, basePrototype.options);
      $.each(prototype, function (prop, value) {
        if (!$.isFunction(value)) {
          proxiedPrototype[prop] = value;
          return;
        }
  
        proxiedPrototype[prop] = function () {
          function _super() {
            return base.prototype[prop].apply(this, arguments);
          }
  
          function _superApply(args) {
            return base.prototype[prop].apply(this, args);
          }
  
          return function () {
            var __super = this._super;
            var __superApply = this._superApply;
            var returnValue;
            this._super = _super;
            this._superApply = _superApply;
            returnValue = value.apply(this, arguments);
            this._super = __super;
            this._superApply = __superApply;
            return returnValue;
          };
        }();
      });
      constructor.prototype = $.widget.extend(basePrototype, {
        // TODO: remove support for widgetEventPrefix
        // always use the name + a colon as the prefix, e.g., draggable:start
        // don't prefix for widgets that aren't DOM-based
        widgetEventPrefix: existingConstructor ? basePrototype.widgetEventPrefix || name : name
      }, proxiedPrototype, {
        constructor: constructor,
        namespace: namespace,
        widgetName: name,
        widgetFullName: fullName
      }); // If this widget is being redefined then we need to find all widgets that
      // are inheriting from it and redefine all of them so that they inherit from
      // the new version of this widget. We're essentially trying to replace one
      // level in the prototype chain.
  
      if (existingConstructor) {
        $.each(existingConstructor._childConstructors, function (i, child) {
          var childPrototype = child.prototype; // Redefine the child widget using the same prototype that was
          // originally used, but inherit from the new version of the base
  
          $.widget(childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto);
        }); // Remove the list of existing child constructors from the old constructor
        // so the old child constructors can be garbage collected
  
        delete existingConstructor._childConstructors;
      } else {
        base._childConstructors.push(constructor);
      }
  
      $.widget.bridge(name, constructor);
      return constructor;
    };
  
    $.widget.extend = function (target) {
      var input = widgetSlice.call(arguments, 1);
      var inputIndex = 0;
      var inputLength = input.length;
      var key;
      var value;
  
      for (; inputIndex < inputLength; inputIndex++) {
        for (key in input[inputIndex]) {
          value = input[inputIndex][key];
  
          if (input[inputIndex].hasOwnProperty(key) && value !== undefined) {
            // Clone objects
            if ($.isPlainObject(value)) {
              target[key] = $.isPlainObject(target[key]) ? $.widget.extend({}, target[key], value) : // Don't extend strings, arrays, etc. with objects
              $.widget.extend({}, value); // Copy everything else by reference
            } else {
              target[key] = value;
            }
          }
        }
      }
  
      return target;
    };
  
    $.widget.bridge = function (name, object) {
      var fullName = object.prototype.widgetFullName || name;
  
      $.fn[name] = function (options) {
        var isMethodCall = typeof options === "string";
        var args = widgetSlice.call(arguments, 1);
        var returnValue = this;
  
        if (isMethodCall) {
          // If this is an empty collection, we need to have the instance method
          // return undefined instead of the jQuery instance
          if (!this.length && options === "instance") {
            returnValue = undefined;
          } else {
            this.each(function () {
              var methodValue;
              var instance = $.data(this, fullName);
  
              if (options === "instance") {
                returnValue = instance;
                return false;
              }
  
              if (!instance) {
                return $.error("cannot call methods on " + name + " prior to initialization; " + "attempted to call method '" + options + "'");
              }
  
              if (!$.isFunction(instance[options]) || options.charAt(0) === "_") {
                return $.error("no such method '" + options + "' for " + name + " widget instance");
              }
  
              methodValue = instance[options].apply(instance, args);
  
              if (methodValue !== instance && methodValue !== undefined) {
                returnValue = methodValue && methodValue.jquery ? returnValue.pushStack(methodValue.get()) : methodValue;
                return false;
              }
            });
          }
        } else {
          // Allow multiple hashes to be passed on init
          if (args.length) {
            options = $.widget.extend.apply(null, [options].concat(args));
          }
  
          this.each(function () {
            var instance = $.data(this, fullName);
  
            if (instance) {
              instance.option(options || {});
  
              if (instance._init) {
                instance._init();
              }
            } else {
              $.data(this, fullName, new object(options, this));
            }
          });
        }
  
        return returnValue;
      };
    };
  
    $.Widget = function ()
    /* options, element */
    {};
  
    $.Widget._childConstructors = [];
    $.Widget.prototype = {
      widgetName: "widget",
      widgetEventPrefix: "",
      defaultElement: "<div>",
      options: {
        classes: {},
        disabled: false,
        // Callbacks
        create: null
      },
      _createWidget: function _createWidget(options, element) {
        element = $(element || this.defaultElement || this)[0];
        this.element = $(element);
        this.uuid = widgetUuid++;
        this.eventNamespace = "." + this.widgetName + this.uuid;
        this.bindings = $();
        this.hoverable = $();
        this.focusable = $();
        this.classesElementLookup = {};
  
        if (element !== this) {
          $.data(element, this.widgetFullName, this);
  
          this._on(true, this.element, {
            remove: function remove(event) {
              if (event.target === element) {
                this.destroy();
              }
            }
          });
  
          this.document = $(element.style ? // Element within the document
          element.ownerDocument : // Element is window or document
          element.document || element);
          this.window = $(this.document[0].defaultView || this.document[0].parentWindow);
        }
  
        this.options = $.widget.extend({}, this.options, this._getCreateOptions(), options);
  
        this._create();
  
        if (this.options.disabled) {
          this._setOptionDisabled(this.options.disabled);
        }
  
        this._trigger("create", null, this._getCreateEventData());
  
        this._init();
      },
      _getCreateOptions: function _getCreateOptions() {
        return {};
      },
      _getCreateEventData: $.noop,
      _create: $.noop,
      _init: $.noop,
      destroy: function destroy() {
        var that = this;
  
        this._destroy();
  
        $.each(this.classesElementLookup, function (key, value) {
          that._removeClass(value, key);
        }); // We can probably remove the unbind calls in 2.0
        // all event bindings should go through this._on()
  
        this.element.off(this.eventNamespace).removeData(this.widgetFullName);
        this.widget().off(this.eventNamespace).removeAttr("aria-disabled"); // Clean up events and states
  
        this.bindings.off(this.eventNamespace);
      },
      _destroy: $.noop,
      widget: function widget() {
        return this.element;
      },
      option: function option(key, value) {
        var options = key;
        var parts;
        var curOption;
        var i;
  
        if (arguments.length === 0) {
          // Don't return a reference to the internal hash
          return $.widget.extend({}, this.options);
        }
  
        if (typeof key === "string") {
          // Handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
          options = {};
          parts = key.split(".");
          key = parts.shift();
  
          if (parts.length) {
            curOption = options[key] = $.widget.extend({}, this.options[key]);
  
            for (i = 0; i < parts.length - 1; i++) {
              curOption[parts[i]] = curOption[parts[i]] || {};
              curOption = curOption[parts[i]];
            }
  
            key = parts.pop();
  
            if (arguments.length === 1) {
              return curOption[key] === undefined ? null : curOption[key];
            }
  
            curOption[key] = value;
          } else {
            if (arguments.length === 1) {
              return this.options[key] === undefined ? null : this.options[key];
            }
  
            options[key] = value;
          }
        }
  
        this._setOptions(options);
  
        return this;
      },
      _setOptions: function _setOptions(options) {
        var key;
  
        for (key in options) {
          this._setOption(key, options[key]);
        }
  
        return this;
      },
      _setOption: function _setOption(key, value) {
        if (key === "classes") {
          this._setOptionClasses(value);
        }
  
        this.options[key] = value;
  
        if (key === "disabled") {
          this._setOptionDisabled(value);
        }
  
        return this;
      },
      _setOptionClasses: function _setOptionClasses(value) {
        var classKey, elements, currentElements;
  
        for (classKey in value) {
          currentElements = this.classesElementLookup[classKey];
  
          if (value[classKey] === this.options.classes[classKey] || !currentElements || !currentElements.length) {
            continue;
          } // We are doing this to create a new jQuery object because the _removeClass() call
          // on the next line is going to destroy the reference to the current elements being
          // tracked. We need to save a copy of this collection so that we can add the new classes
          // below.
  
  
          elements = $(currentElements.get());
  
          this._removeClass(currentElements, classKey); // We don't use _addClass() here, because that uses this.options.classes
          // for generating the string of classes. We want to use the value passed in from
          // _setOption(), this is the new value of the classes option which was passed to
          // _setOption(). We pass this value directly to _classes().
  
  
          elements.addClass(this._classes({
            element: elements,
            keys: classKey,
            classes: value,
            add: true
          }));
        }
      },
      _setOptionDisabled: function _setOptionDisabled(value) {
        this._toggleClass(this.widget(), this.widgetFullName + "-disabled", null, !!value); // If the widget is becoming disabled, then nothing is interactive
  
  
        if (value) {
          this._removeClass(this.hoverable, null, "ui-state-hover");
  
          this._removeClass(this.focusable, null, "ui-state-focus");
        }
      },
      enable: function enable() {
        return this._setOptions({
          disabled: false
        });
      },
      disable: function disable() {
        return this._setOptions({
          disabled: true
        });
      },
      _classes: function _classes(options) {
        var full = [];
        var that = this;
        options = $.extend({
          element: this.element,
          classes: this.options.classes || {}
        }, options);
  
        function processClassString(classes, checkOption) {
          var current, i;
  
          for (i = 0; i < classes.length; i++) {
            current = that.classesElementLookup[classes[i]] || $();
  
            if (options.add) {
              current = $($.unique(current.get().concat(options.element.get())));
            } else {
              current = $(current.not(options.element).get());
            }
  
            that.classesElementLookup[classes[i]] = current;
            full.push(classes[i]);
  
            if (checkOption && options.classes[classes[i]]) {
              full.push(options.classes[classes[i]]);
            }
          }
        }
  
        this._on(options.element, {
          "remove": "_untrackClassesElement"
        });
  
        if (options.keys) {
          processClassString(options.keys.match(/\S+/g) || [], true);
        }
  
        if (options.extra) {
          processClassString(options.extra.match(/\S+/g) || []);
        }
  
        return full.join(" ");
      },
      _untrackClassesElement: function _untrackClassesElement(event) {
        var that = this;
        $.each(that.classesElementLookup, function (key, value) {
          if ($.inArray(event.target, value) !== -1) {
            that.classesElementLookup[key] = $(value.not(event.target).get());
          }
        });
      },
      _removeClass: function _removeClass(element, keys, extra) {
        return this._toggleClass(element, keys, extra, false);
      },
      _addClass: function _addClass(element, keys, extra) {
        return this._toggleClass(element, keys, extra, true);
      },
      _toggleClass: function _toggleClass(element, keys, extra, add) {
        add = typeof add === "boolean" ? add : extra;
        var shift = typeof element === "string" || element === null,
            options = {
          extra: shift ? keys : extra,
          keys: shift ? element : keys,
          element: shift ? this.element : element,
          add: add
        };
        options.element.toggleClass(this._classes(options), add);
        return this;
      },
      _on: function _on(suppressDisabledCheck, element, handlers) {
        var delegateElement;
        var instance = this; // No suppressDisabledCheck flag, shuffle arguments
  
        if (typeof suppressDisabledCheck !== "boolean") {
          handlers = element;
          element = suppressDisabledCheck;
          suppressDisabledCheck = false;
        } // No element argument, shuffle and use this.element
  
  
        if (!handlers) {
          handlers = element;
          element = this.element;
          delegateElement = this.widget();
        } else {
          element = delegateElement = $(element);
          this.bindings = this.bindings.add(element);
        }
  
        $.each(handlers, function (event, handler) {
          function handlerProxy() {
            // Allow widgets to customize the disabled handling
            // - disabled as an array instead of boolean
            // - disabled class as method for disabling individual parts
            if (!suppressDisabledCheck && (instance.options.disabled === true || $(this).hasClass("ui-state-disabled"))) {
              return;
            }
  
            return (typeof handler === "string" ? instance[handler] : handler).apply(instance, arguments);
          } // Copy the guid so direct unbinding works
  
  
          if (typeof handler !== "string") {
            handlerProxy.guid = handler.guid = handler.guid || handlerProxy.guid || $.guid++;
          }
  
          var match = event.match(/^([\w:-]*)\s*(.*)$/);
          var eventName = match[1] + instance.eventNamespace;
          var selector = match[2];
  
          if (selector) {
            delegateElement.on(eventName, selector, handlerProxy);
          } else {
            element.on(eventName, handlerProxy);
          }
        });
      },
      _off: function _off(element, eventName) {
        eventName = (eventName || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace;
        element.off(eventName).off(eventName); // Clear the stack to avoid memory leaks (#10056)
  
        this.bindings = $(this.bindings.not(element).get());
        this.focusable = $(this.focusable.not(element).get());
        this.hoverable = $(this.hoverable.not(element).get());
      },
      _delay: function _delay(handler, delay) {
        function handlerProxy() {
          return (typeof handler === "string" ? instance[handler] : handler).apply(instance, arguments);
        }
  
        var instance = this;
        return setTimeout(handlerProxy, delay || 0);
      },
      _hoverable: function _hoverable(element) {
        this.hoverable = this.hoverable.add(element);
  
        this._on(element, {
          mouseenter: function mouseenter(event) {
            this._addClass($(event.currentTarget), null, "ui-state-hover");
          },
          mouseleave: function mouseleave(event) {
            this._removeClass($(event.currentTarget), null, "ui-state-hover");
          }
        });
      },
      _focusable: function _focusable(element) {
        this.focusable = this.focusable.add(element);
  
        this._on(element, {
          focusin: function focusin(event) {
            this._addClass($(event.currentTarget), null, "ui-state-focus");
          },
          focusout: function focusout(event) {
            this._removeClass($(event.currentTarget), null, "ui-state-focus");
          }
        });
      },
      _trigger: function _trigger(type, event, data) {
        var prop, orig;
        var callback = this.options[type];
        data = data || {};
        event = $.Event(event);
        event.type = (type === this.widgetEventPrefix ? type : this.widgetEventPrefix + type).toLowerCase(); // The original event may come from any element
        // so we need to reset the target on the new event
  
        event.target = this.element[0]; // Copy original event properties over to the new event
  
        orig = event.originalEvent;
  
        if (orig) {
          for (prop in orig) {
            if (!(prop in event)) {
              event[prop] = orig[prop];
            }
          }
        }
  
        this.element.trigger(event, data);
        return !($.isFunction(callback) && callback.apply(this.element[0], [event].concat(data)) === false || event.isDefaultPrevented());
      }
    };
    $.each({
      show: "fadeIn",
      hide: "fadeOut"
    }, function (method, defaultEffect) {
      $.Widget.prototype["_" + method] = function (element, options, callback) {
        if (typeof options === "string") {
          options = {
            effect: options
          };
        }
  
        var hasOptions;
        var effectName = !options ? method : options === true || typeof options === "number" ? defaultEffect : options.effect || defaultEffect;
        options = options || {};
  
        if (typeof options === "number") {
          options = {
            duration: options
          };
        }
  
        hasOptions = !$.isEmptyObject(options);
        options.complete = callback;
  
        if (options.delay) {
          element.delay(options.delay);
        }
  
        if (hasOptions && $.effects && $.effects.effect[effectName]) {
          element[method](options);
        } else if (effectName !== method && element[effectName]) {
          element[effectName](options.duration, options.easing, callback);
        } else {
          element.queue(function (next) {
            $(this)[method]();
  
            if (callback) {
              callback.call(element[0]);
            }
  
            next();
          });
        }
      };
    });
    var widget = $.widget;
    /*!
     * jQuery UI :data 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: :data Selector
    //>>group: Core
    //>>description: Selects elements which have data stored under the specified key.
    //>>docs: http://api.jqueryui.com/data-selector/
  
    var data = $.extend($.expr[":"], {
      data: $.expr.createPseudo ? $.expr.createPseudo(function (dataName) {
        return function (elem) {
          return !!$.data(elem, dataName);
        };
      }) : // Support: jQuery <1.8
      function (elem, i, match) {
        return !!$.data(elem, match[3]);
      }
    });
    /*!
     * jQuery UI Support for jQuery core 1.7.x 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     *
     */
    //>>label: jQuery 1.7 Support
    //>>group: Core
    //>>description: Support version 1.7.x of jQuery core
    // Support: jQuery 1.7 only
    // Not a great way to check versions, but since we only support 1.7+ and only
    // need to detect <1.8, this is a simple check that should suffice. Checking
    // for "1.7." would be a bit safer, but the version string is 1.7, not 1.7.0
    // and we'll never reach 1.70.0 (if we do, we certainly won't be supporting
    // 1.7 anymore). See #11197 for why we're not using feature detection.
  
    if ($.fn.jquery.substring(0, 3) === "1.7") {
      // Setters for .innerWidth(), .innerHeight(), .outerWidth(), .outerHeight()
      // Unlike jQuery Core 1.8+, these only support numeric values to set the
      // dimensions in pixels
      $.each(["Width", "Height"], function (i, name) {
        var side = name === "Width" ? ["Left", "Right"] : ["Top", "Bottom"],
            type = name.toLowerCase(),
            orig = {
          innerWidth: $.fn.innerWidth,
          innerHeight: $.fn.innerHeight,
          outerWidth: $.fn.outerWidth,
          outerHeight: $.fn.outerHeight
        };
  
        function reduce(elem, size, border, margin) {
          $.each(side, function () {
            size -= parseFloat($.css(elem, "padding" + this)) || 0;
  
            if (border) {
              size -= parseFloat($.css(elem, "border" + this + "Width")) || 0;
            }
  
            if (margin) {
              size -= parseFloat($.css(elem, "margin" + this)) || 0;
            }
          });
          return size;
        }
  
        $.fn["inner" + name] = function (size) {
          if (size === undefined) {
            return orig["inner" + name].call(this);
          }
  
          return this.each(function () {
            $(this).css(type, reduce(this, size) + "px");
          });
        };
  
        $.fn["outer" + name] = function (size, margin) {
          if (typeof size !== "number") {
            return orig["outer" + name].call(this, size);
          }
  
          return this.each(function () {
            $(this).css(type, reduce(this, size, true, margin) + "px");
          });
        };
      });
  
      $.fn.addBack = function (selector) {
        return this.add(selector == null ? this.prevObject : this.prevObject.filter(selector));
      };
    }
  
    ;
    /*!
     * jQuery UI Keycode 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Keycode
    //>>group: Core
    //>>description: Provide keycodes as keynames
    //>>docs: http://api.jqueryui.com/jQuery.ui.keyCode/
  
    var keycode = $.ui.keyCode = {
      BACKSPACE: 8,
      COMMA: 188,
      DELETE: 46,
      DOWN: 40,
      END: 35,
      ENTER: 13,
      ESCAPE: 27,
      HOME: 36,
      LEFT: 37,
      PAGE_DOWN: 34,
      PAGE_UP: 33,
      PERIOD: 190,
      RIGHT: 39,
      SPACE: 32,
      TAB: 9,
      UP: 38
    };
    /*!
     * jQuery UI Scroll Parent 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: scrollParent
    //>>group: Core
    //>>description: Get the closest ancestor element that is scrollable.
    //>>docs: http://api.jqueryui.com/scrollParent/
  
    var scrollParent = $.fn.scrollParent = function (includeHidden) {
      var position = this.css("position"),
          excludeStaticParent = position === "absolute",
          overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
          scrollParent = this.parents().filter(function () {
        var parent = $(this);
  
        if (excludeStaticParent && parent.css("position") === "static") {
          return false;
        }
  
        return overflowRegex.test(parent.css("overflow") + parent.css("overflow-y") + parent.css("overflow-x"));
      }).eq(0);
      return position === "fixed" || !scrollParent.length ? $(this[0].ownerDocument || document) : scrollParent;
    }; // This file is deprecated
  
  
    var ie = $.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());
    /*!
     * jQuery UI Mouse 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Mouse
    //>>group: Widgets
    //>>description: Abstracts mouse-based interactions to assist in creating certain widgets.
    //>>docs: http://api.jqueryui.com/mouse/
  
    var mouseHandled = false;
    $(document).on("mouseup", function () {
      mouseHandled = false;
    });
    var widgetsMouse = $.widget("ui.mouse", {
      version: "1.12.1",
      options: {
        cancel: "input, textarea, button, select, option",
        distance: 1,
        delay: 0
      },
      _mouseInit: function _mouseInit() {
        var that = this;
        this.element.on("mousedown." + this.widgetName, function (event) {
          return that._mouseDown(event);
        }).on("click." + this.widgetName, function (event) {
          if (true === $.data(event.target, that.widgetName + ".preventClickEvent")) {
            $.removeData(event.target, that.widgetName + ".preventClickEvent");
            event.stopImmediatePropagation();
            return false;
          }
        });
        this.started = false;
      },
      // TODO: make sure destroying one instance of mouse doesn't mess with
      // other instances of mouse
      _mouseDestroy: function _mouseDestroy() {
        this.element.off("." + this.widgetName);
  
        if (this._mouseMoveDelegate) {
          this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate);
        }
      },
      _mouseDown: function _mouseDown(event) {
        // don't let more than one widget handle mouseStart
        if (mouseHandled) {
          return;
        }
  
        this._mouseMoved = false; // We may have missed mouseup (out of window)
  
        this._mouseStarted && this._mouseUp(event);
        this._mouseDownEvent = event;
        var that = this,
            btnIsLeft = event.which === 1,
            // event.target.nodeName works around a bug in IE 8 with
        // disabled inputs (#7620)
        elIsCancel = typeof this.options.cancel === "string" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false;
  
        if (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {
          return true;
        }
  
        this.mouseDelayMet = !this.options.delay;
  
        if (!this.mouseDelayMet) {
          this._mouseDelayTimer = setTimeout(function () {
            that.mouseDelayMet = true;
          }, this.options.delay);
        }
  
        if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
          this._mouseStarted = this._mouseStart(event) !== false;
  
          if (!this._mouseStarted) {
            event.preventDefault();
            return true;
          }
        } // Click event may never have fired (Gecko & Opera)
  
  
        if (true === $.data(event.target, this.widgetName + ".preventClickEvent")) {
          $.removeData(event.target, this.widgetName + ".preventClickEvent");
        } // These delegates are required to keep context
  
  
        this._mouseMoveDelegate = function (event) {
          return that._mouseMove(event);
        };
  
        this._mouseUpDelegate = function (event) {
          return that._mouseUp(event);
        };
  
        this.document.on("mousemove." + this.widgetName, this._mouseMoveDelegate).on("mouseup." + this.widgetName, this._mouseUpDelegate);
        event.preventDefault();
        mouseHandled = true;
        return true;
      },
      _mouseMove: function _mouseMove(event) {
        // Only check for mouseups outside the document if you've moved inside the document
        // at least once. This prevents the firing of mouseup in the case of IE<9, which will
        // fire a mousemove event if content is placed under the cursor. See #7778
        // Support: IE <9
        if (this._mouseMoved) {
          // IE mouseup check - mouseup happened when mouse was out of window
          if ($.ui.ie && (!document.documentMode || document.documentMode < 9) && !event.button) {
            return this._mouseUp(event); // Iframe mouseup check - mouseup occurred in another document
          } else if (!event.which) {
            // Support: Safari <=8 - 9
            // Safari sets which to 0 if you press any of the following keys
            // during a drag (#14461)
            if (event.originalEvent.altKey || event.originalEvent.ctrlKey || event.originalEvent.metaKey || event.originalEvent.shiftKey) {
              this.ignoreMissingWhich = true;
            } else if (!this.ignoreMissingWhich) {
              return this._mouseUp(event);
            }
          }
        }
  
        if (event.which || event.button) {
          this._mouseMoved = true;
        }
  
        if (this._mouseStarted) {
          this._mouseDrag(event);
  
          return event.preventDefault();
        }
  
        if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
          this._mouseStarted = this._mouseStart(this._mouseDownEvent, event) !== false;
          this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event);
        }
  
        return !this._mouseStarted;
      },
      _mouseUp: function _mouseUp(event) {
        this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate);
  
        if (this._mouseStarted) {
          this._mouseStarted = false;
  
          if (event.target === this._mouseDownEvent.target) {
            $.data(event.target, this.widgetName + ".preventClickEvent", true);
          }
  
          this._mouseStop(event);
        }
  
        if (this._mouseDelayTimer) {
          clearTimeout(this._mouseDelayTimer);
          delete this._mouseDelayTimer;
        }
  
        this.ignoreMissingWhich = false;
        mouseHandled = false;
        event.preventDefault();
      },
      _mouseDistanceMet: function _mouseDistanceMet(event) {
        return Math.max(Math.abs(this._mouseDownEvent.pageX - event.pageX), Math.abs(this._mouseDownEvent.pageY - event.pageY)) >= this.options.distance;
      },
      _mouseDelayMet: function _mouseDelayMet()
      /* event */
      {
        return this.mouseDelayMet;
      },
      // These are placeholder methods, to be overriden by extending plugin
      _mouseStart: function _mouseStart()
      /* event */
      {},
      _mouseDrag: function _mouseDrag()
      /* event */
      {},
      _mouseStop: function _mouseStop()
      /* event */
      {},
      _mouseCapture: function _mouseCapture()
      /* event */
      {
        return true;
      }
    });
    /*!
     * jQuery UI Sortable 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Sortable
    //>>group: Interactions
    //>>description: Enables items in a list to be sorted using the mouse.
    //>>docs: http://api.jqueryui.com/sortable/
    //>>demos: http://jqueryui.com/sortable/
    //>>css.structure: ../../themes/base/sortable.css
  
    var widgetsSortable = $.widget("ui.sortable", $.ui.mouse, {
      version: "1.12.1",
      widgetEventPrefix: "sort",
      ready: false,
      options: {
        appendTo: "parent",
        axis: false,
        connectWith: false,
        containment: false,
        cursor: "auto",
        cursorAt: false,
        dropOnEmpty: true,
        forcePlaceholderSize: false,
        forceHelperSize: false,
        grid: false,
        handle: false,
        helper: "original",
        items: "> *",
        opacity: false,
        placeholder: false,
        revert: false,
        scroll: true,
        scrollSensitivity: 20,
        scrollSpeed: 20,
        scope: "default",
        tolerance: "intersect",
        zIndex: 1000,
        // Callbacks
        activate: null,
        beforeStop: null,
        change: null,
        deactivate: null,
        out: null,
        over: null,
        receive: null,
        remove: null,
        sort: null,
        start: null,
        stop: null,
        update: null
      },
      _isOverAxis: function _isOverAxis(x, reference, size) {
        return x >= reference && x < reference + size;
      },
      _isFloating: function _isFloating(item) {
        return /left|right/.test(item.css("float")) || /inline|table-cell/.test(item.css("display"));
      },
      _create: function _create() {
        this.containerCache = {};
  
        this._addClass("ui-sortable"); //Get the items
  
  
        this.refresh(); //Let's determine the parent's offset
  
        this.offset = this.element.offset(); //Initialize mouse events for interaction
  
        this._mouseInit();
  
        this._setHandleClassName(); //We're ready to go
  
  
        this.ready = true;
      },
      _setOption: function _setOption(key, value) {
        this._super(key, value);
  
        if (key === "handle") {
          this._setHandleClassName();
        }
      },
      _setHandleClassName: function _setHandleClassName() {
        var that = this;
  
        this._removeClass(this.element.find(".ui-sortable-handle"), "ui-sortable-handle");
  
        $.each(this.items, function () {
          that._addClass(this.instance.options.handle ? this.item.find(this.instance.options.handle) : this.item, "ui-sortable-handle");
        });
      },
      _destroy: function _destroy() {
        this._mouseDestroy();
  
        for (var i = this.items.length - 1; i >= 0; i--) {
          this.items[i].item.removeData(this.widgetName + "-item");
        }
  
        return this;
      },
      _mouseCapture: function _mouseCapture(event, overrideHandle) {
        var currentItem = null,
            validHandle = false,
            that = this;
  
        if (this.reverting) {
          return false;
        }
  
        if (this.options.disabled || this.options.type === "static") {
          return false;
        } //We have to refresh the items data once first
  
  
        this._refreshItems(event); //Find out if the clicked node (or one of its parents) is a actual item in this.items
  
  
        $(event.target).parents().each(function () {
          if ($.data(this, that.widgetName + "-item") === that) {
            currentItem = $(this);
            return false;
          }
        });
  
        if ($.data(event.target, that.widgetName + "-item") === that) {
          currentItem = $(event.target);
        }
  
        if (!currentItem) {
          return false;
        }
  
        if (this.options.handle && !overrideHandle) {
          $(this.options.handle, currentItem).find("*").addBack().each(function () {
            if (this === event.target) {
              validHandle = true;
            }
          });
  
          if (!validHandle) {
            return false;
          }
        }
  
        this.currentItem = currentItem;
  
        this._removeCurrentsFromItems();
  
        return true;
      },
      _mouseStart: function _mouseStart(event, overrideHandle, noActivation) {
        var i,
            body,
            o = this.options;
        this.currentContainer = this; //We only need to call refreshPositions, because the refreshItems call has been moved to
        // mouseCapture
  
        this.refreshPositions(); //Create and append the visible helper
  
        this.helper = this._createHelper(event); //Cache the helper size
  
        this._cacheHelperProportions();
        /*
         * - Position generation -
         * This block generates everything position related - it's the core of draggables.
         */
        //Cache the margins of the original element
  
  
        this._cacheMargins(); //Get the next scrolling parent
  
  
        this.scrollParent = this.helper.scrollParent(); //The element's absolute position on the page minus margins
  
        this.offset = this.currentItem.offset();
        this.offset = {
          top: this.offset.top - this.margins.top,
          left: this.offset.left - this.margins.left
        };
        $.extend(this.offset, {
          click: {
            //Where the click happened, relative to the element
            left: event.pageX - this.offset.left,
            top: event.pageY - this.offset.top
          },
          parent: this._getParentOffset(),
          // This is a relative to absolute position minus the actual position calculation -
          // only used for relative positioned helper
          relative: this._getRelativeOffset()
        }); // Only after we got the offset, we can change the helper's position to absolute
        // TODO: Still need to figure out a way to make relative sorting possible
  
        this.helper.css("position", "absolute");
        this.cssPosition = this.helper.css("position"); //Generate the original position
  
        this.originalPosition = this._generatePosition(event);
        this.originalPageX = event.pageX;
        this.originalPageY = event.pageY; //Adjust the mouse offset relative to the helper if "cursorAt" is supplied
  
        o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt); //Cache the former DOM position
  
        this.domPosition = {
          prev: this.currentItem.prev()[0],
          parent: this.currentItem.parent()[0]
        }; // If the helper is not the original, hide the original so it's not playing any role during
        // the drag, won't cause anything bad this way
  
        if (this.helper[0] !== this.currentItem[0]) {
          this.currentItem.hide();
        } //Create the placeholder
  
  
        this._createPlaceholder(); //Set a containment if given in the options
  
  
        if (o.containment) {
          this._setContainment();
        }
  
        if (o.cursor && o.cursor !== "auto") {
          // cursor option
          body = this.document.find("body"); // Support: IE
  
          this.storedCursor = body.css("cursor");
          body.css("cursor", o.cursor);
          this.storedStylesheet = $("<style>*{ cursor: " + o.cursor + " !important; }</style>").appendTo(body);
        }
  
        if (o.opacity) {
          // opacity option
          if (this.helper.css("opacity")) {
            this._storedOpacity = this.helper.css("opacity");
          }
  
          this.helper.css("opacity", o.opacity);
        }
  
        if (o.zIndex) {
          // zIndex option
          if (this.helper.css("zIndex")) {
            this._storedZIndex = this.helper.css("zIndex");
          }
  
          this.helper.css("zIndex", o.zIndex);
        } //Prepare scrolling
  
  
        if (this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {
          this.overflowOffset = this.scrollParent.offset();
        } //Call callbacks
  
  
        this._trigger("start", event, this._uiHash()); //Recache the helper size
  
  
        if (!this._preserveHelperProportions) {
          this._cacheHelperProportions();
        } //Post "activate" events to possible containers
  
  
        if (!noActivation) {
          for (i = this.containers.length - 1; i >= 0; i--) {
            this.containers[i]._trigger("activate", event, this._uiHash(this));
          }
        } //Prepare possible droppables
  
  
        if ($.ui.ddmanager) {
          $.ui.ddmanager.current = this;
        }
  
        if ($.ui.ddmanager && !o.dropBehaviour) {
          $.ui.ddmanager.prepareOffsets(this, event);
        }
  
        this.dragging = true;
  
        this._addClass(this.helper, "ui-sortable-helper"); // Execute the drag once - this causes the helper not to be visiblebefore getting its
        // correct position
  
  
        this._mouseDrag(event);
  
        return true;
      },
      _mouseDrag: function _mouseDrag(event) {
        var i,
            item,
            itemElement,
            intersection,
            o = this.options,
            scrolled = false; //Compute the helpers position
  
        this.position = this._generatePosition(event);
        this.positionAbs = this._convertPositionTo("absolute");
  
        if (!this.lastPositionAbs) {
          this.lastPositionAbs = this.positionAbs;
        } //Do scrolling
  
  
        if (this.options.scroll) {
          if (this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {
            if (this.overflowOffset.top + this.scrollParent[0].offsetHeight - event.pageY < o.scrollSensitivity) {
              this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;
            } else if (event.pageY - this.overflowOffset.top < o.scrollSensitivity) {
              this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;
            }
  
            if (this.overflowOffset.left + this.scrollParent[0].offsetWidth - event.pageX < o.scrollSensitivity) {
              this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;
            } else if (event.pageX - this.overflowOffset.left < o.scrollSensitivity) {
              this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;
            }
          } else {
            if (event.pageY - this.document.scrollTop() < o.scrollSensitivity) {
              scrolled = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed);
            } else if (this.window.height() - (event.pageY - this.document.scrollTop()) < o.scrollSensitivity) {
              scrolled = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed);
            }
  
            if (event.pageX - this.document.scrollLeft() < o.scrollSensitivity) {
              scrolled = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed);
            } else if (this.window.width() - (event.pageX - this.document.scrollLeft()) < o.scrollSensitivity) {
              scrolled = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed);
            }
          }
  
          if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
            $.ui.ddmanager.prepareOffsets(this, event);
          }
        } //Regenerate the absolute position used for position checks
  
  
        this.positionAbs = this._convertPositionTo("absolute"); //Set the helper position
  
        if (!this.options.axis || this.options.axis !== "y") {
          this.helper[0].style.left = this.position.left + "px";
        }
  
        if (!this.options.axis || this.options.axis !== "x") {
          this.helper[0].style.top = this.position.top + "px";
        } //Rearrange
  
  
        for (i = this.items.length - 1; i >= 0; i--) {
          //Cache variables and intersection, continue if no intersection
          item = this.items[i];
          itemElement = item.item[0];
          intersection = this._intersectsWithPointer(item);
  
          if (!intersection) {
            continue;
          } // Only put the placeholder inside the current Container, skip all
          // items from other containers. This works because when moving
          // an item from one container to another the
          // currentContainer is switched before the placeholder is moved.
          //
          // Without this, moving items in "sub-sortables" can cause
          // the placeholder to jitter between the outer and inner container.
  
  
          if (item.instance !== this.currentContainer) {
            continue;
          } // Cannot intersect with itself
          // no useless actions that have been done before
          // no action if the item moved is the parent of the item checked
  
  
          if (itemElement !== this.currentItem[0] && this.placeholder[intersection === 1 ? "next" : "prev"]()[0] !== itemElement && !$.contains(this.placeholder[0], itemElement) && (this.options.type === "semi-dynamic" ? !$.contains(this.element[0], itemElement) : true)) {
            this.direction = intersection === 1 ? "down" : "up";
  
            if (this.options.tolerance === "pointer" || this._intersectsWithSides(item)) {
              this._rearrange(event, item);
            } else {
              break;
            }
  
            this._trigger("change", event, this._uiHash());
  
            break;
          }
        } //Post events to containers
  
  
        this._contactContainers(event); //Interconnect with droppables
  
  
        if ($.ui.ddmanager) {
          $.ui.ddmanager.drag(this, event);
        } //Call callbacks
  
  
        this._trigger("sort", event, this._uiHash());
  
        this.lastPositionAbs = this.positionAbs;
        return false;
      },
      _mouseStop: function _mouseStop(event, noPropagation) {
        if (!event) {
          return;
        } //If we are using droppables, inform the manager about the drop
  
  
        if ($.ui.ddmanager && !this.options.dropBehaviour) {
          $.ui.ddmanager.drop(this, event);
        }
  
        if (this.options.revert) {
          var that = this,
              cur = this.placeholder.offset(),
              axis = this.options.axis,
              animation = {};
  
          if (!axis || axis === "x") {
            animation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft);
          }
  
          if (!axis || axis === "y") {
            animation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop);
          }
  
          this.reverting = true;
          $(this.helper).animate(animation, parseInt(this.options.revert, 10) || 500, function () {
            that._clear(event);
          });
        } else {
          this._clear(event, noPropagation);
        }
  
        return false;
      },
      cancel: function cancel() {
        if (this.dragging) {
          this._mouseUp(new $.Event("mouseup", {
            target: null
          }));
  
          if (this.options.helper === "original") {
            this.currentItem.css(this._storedCSS);
  
            this._removeClass(this.currentItem, "ui-sortable-helper");
          } else {
            this.currentItem.show();
          } //Post deactivating events to containers
  
  
          for (var i = this.containers.length - 1; i >= 0; i--) {
            this.containers[i]._trigger("deactivate", null, this._uiHash(this));
  
            if (this.containers[i].containerCache.over) {
              this.containers[i]._trigger("out", null, this._uiHash(this));
  
              this.containers[i].containerCache.over = 0;
            }
          }
        }
  
        if (this.placeholder) {
          //$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately,
          // it unbinds ALL events from the original node!
          if (this.placeholder[0].parentNode) {
            this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
          }
  
          if (this.options.helper !== "original" && this.helper && this.helper[0].parentNode) {
            this.helper.remove();
          }
  
          $.extend(this, {
            helper: null,
            dragging: false,
            reverting: false,
            _noFinalSort: null
          });
  
          if (this.domPosition.prev) {
            $(this.domPosition.prev).after(this.currentItem);
          } else {
            $(this.domPosition.parent).prepend(this.currentItem);
          }
        }
  
        return this;
      },
      serialize: function serialize(o) {
        var items = this._getItemsAsjQuery(o && o.connected),
            str = [];
  
        o = o || {};
        $(items).each(function () {
          var res = ($(o.item || this).attr(o.attribute || "id") || "").match(o.expression || /(.+)[\-=_](.+)/);
  
          if (res) {
            str.push((o.key || res[1] + "[]") + "=" + (o.key && o.expression ? res[1] : res[2]));
          }
        });
  
        if (!str.length && o.key) {
          str.push(o.key + "=");
        }
  
        return str.join("&");
      },
      toArray: function toArray(o) {
        var items = this._getItemsAsjQuery(o && o.connected),
            ret = [];
  
        o = o || {};
        items.each(function () {
          ret.push($(o.item || this).attr(o.attribute || "id") || "");
        });
        return ret;
      },
  
      /* Be careful with the following core functions */
      _intersectsWith: function _intersectsWith(item) {
        var x1 = this.positionAbs.left,
            x2 = x1 + this.helperProportions.width,
            y1 = this.positionAbs.top,
            y2 = y1 + this.helperProportions.height,
            l = item.left,
            r = l + item.width,
            t = item.top,
            b = t + item.height,
            dyClick = this.offset.click.top,
            dxClick = this.offset.click.left,
            isOverElementHeight = this.options.axis === "x" || y1 + dyClick > t && y1 + dyClick < b,
            isOverElementWidth = this.options.axis === "y" || x1 + dxClick > l && x1 + dxClick < r,
            isOverElement = isOverElementHeight && isOverElementWidth;
  
        if (this.options.tolerance === "pointer" || this.options.forcePointerForContainers || this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > item[this.floating ? "width" : "height"]) {
          return isOverElement;
        } else {
          return l < x1 + this.helperProportions.width / 2 && // Right Half
          x2 - this.helperProportions.width / 2 < r && // Left Half
          t < y1 + this.helperProportions.height / 2 && // Bottom Half
          y2 - this.helperProportions.height / 2 < b; // Top Half
        }
      },
      _intersectsWithPointer: function _intersectsWithPointer(item) {
        var verticalDirection,
            horizontalDirection,
            isOverElementHeight = this.options.axis === "x" || this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),
            isOverElementWidth = this.options.axis === "y" || this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),
            isOverElement = isOverElementHeight && isOverElementWidth;
  
        if (!isOverElement) {
          return false;
        }
  
        verticalDirection = this._getDragVerticalDirection();
        horizontalDirection = this._getDragHorizontalDirection();
        return this.floating ? horizontalDirection === "right" || verticalDirection === "down" ? 2 : 1 : verticalDirection && (verticalDirection === "down" ? 2 : 1);
      },
      _intersectsWithSides: function _intersectsWithSides(item) {
        var isOverBottomHalf = this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + item.height / 2, item.height),
            isOverRightHalf = this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + item.width / 2, item.width),
            verticalDirection = this._getDragVerticalDirection(),
            horizontalDirection = this._getDragHorizontalDirection();
  
        if (this.floating && horizontalDirection) {
          return horizontalDirection === "right" && isOverRightHalf || horizontalDirection === "left" && !isOverRightHalf;
        } else {
          return verticalDirection && (verticalDirection === "down" && isOverBottomHalf || verticalDirection === "up" && !isOverBottomHalf);
        }
      },
      _getDragVerticalDirection: function _getDragVerticalDirection() {
        var delta = this.positionAbs.top - this.lastPositionAbs.top;
        return delta !== 0 && (delta > 0 ? "down" : "up");
      },
      _getDragHorizontalDirection: function _getDragHorizontalDirection() {
        var delta = this.positionAbs.left - this.lastPositionAbs.left;
        return delta !== 0 && (delta > 0 ? "right" : "left");
      },
      refresh: function refresh(event) {
        this._refreshItems(event);
  
        this._setHandleClassName();
  
        this.refreshPositions();
        return this;
      },
      _connectWith: function _connectWith() {
        var options = this.options;
        return options.connectWith.constructor === String ? [options.connectWith] : options.connectWith;
      },
      _getItemsAsjQuery: function _getItemsAsjQuery(connected) {
        var i,
            j,
            cur,
            inst,
            items = [],
            queries = [],
            connectWith = this._connectWith();
  
        if (connectWith && connected) {
          for (i = connectWith.length - 1; i >= 0; i--) {
            cur = $(connectWith[i], this.document[0]);
  
            for (j = cur.length - 1; j >= 0; j--) {
              inst = $.data(cur[j], this.widgetFullName);
  
              if (inst && inst !== this && !inst.options.disabled) {
                queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), inst]);
              }
            }
          }
        }
  
        queries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
          options: this.options,
          item: this.currentItem
        }) : $(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
  
        function addItems() {
          items.push(this);
        }
  
        for (i = queries.length - 1; i >= 0; i--) {
          queries[i][0].each(addItems);
        }
  
        return $(items);
      },
      _removeCurrentsFromItems: function _removeCurrentsFromItems() {
        var list = this.currentItem.find(":data(" + this.widgetName + "-item)");
        this.items = $.grep(this.items, function (item) {
          for (var j = 0; j < list.length; j++) {
            if (list[j] === item.item[0]) {
              return false;
            }
          }
  
          return true;
        });
      },
      _refreshItems: function _refreshItems(event) {
        this.items = [];
        this.containers = [this];
  
        var i,
            j,
            cur,
            inst,
            targetData,
            _queries,
            item,
            queriesLength,
            items = this.items,
            queries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, {
          item: this.currentItem
        }) : $(this.options.items, this.element), this]],
            connectWith = this._connectWith(); //Shouldn't be run the first time through due to massive slow-down
  
  
        if (connectWith && this.ready) {
          for (i = connectWith.length - 1; i >= 0; i--) {
            cur = $(connectWith[i], this.document[0]);
  
            for (j = cur.length - 1; j >= 0; j--) {
              inst = $.data(cur[j], this.widgetFullName);
  
              if (inst && inst !== this && !inst.options.disabled) {
                queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, {
                  item: this.currentItem
                }) : $(inst.options.items, inst.element), inst]);
                this.containers.push(inst);
              }
            }
          }
        }
  
        for (i = queries.length - 1; i >= 0; i--) {
          targetData = queries[i][1];
          _queries = queries[i][0];
  
          for (j = 0, queriesLength = _queries.length; j < queriesLength; j++) {
            item = $(_queries[j]); // Data for target checking (mouse manager)
  
            item.data(this.widgetName + "-item", targetData);
            items.push({
              item: item,
              instance: targetData,
              width: 0,
              height: 0,
              left: 0,
              top: 0
            });
          }
        }
      },
      refreshPositions: function refreshPositions(fast) {
        // Determine whether items are being displayed horizontally
        this.floating = this.items.length ? this.options.axis === "x" || this._isFloating(this.items[0].item) : false; //This has to be redone because due to the item being moved out/into the offsetParent,
        // the offsetParent's position will change
  
        if (this.offsetParent && this.helper) {
          this.offset.parent = this._getParentOffset();
        }
  
        var i, item, t, p;
  
        for (i = this.items.length - 1; i >= 0; i--) {
          item = this.items[i]; //We ignore calculating positions of all connected containers when we're not over them
  
          if (item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0]) {
            continue;
          }
  
          t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;
  
          if (!fast) {
            item.width = t.outerWidth();
            item.height = t.outerHeight();
          }
  
          p = t.offset();
          item.left = p.left;
          item.top = p.top;
        }
  
        if (this.options.custom && this.options.custom.refreshContainers) {
          this.options.custom.refreshContainers.call(this);
        } else {
          for (i = this.containers.length - 1; i >= 0; i--) {
            p = this.containers[i].element.offset();
            this.containers[i].containerCache.left = p.left;
            this.containers[i].containerCache.top = p.top;
            this.containers[i].containerCache.width = this.containers[i].element.outerWidth();
            this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
          }
        }
  
        return this;
      },
      _createPlaceholder: function _createPlaceholder(that) {
        that = that || this;
        var className,
            o = that.options;
  
        if (!o.placeholder || o.placeholder.constructor === String) {
          className = o.placeholder;
          o.placeholder = {
            element: function element() {
              var nodeName = that.currentItem[0].nodeName.toLowerCase(),
                  element = $("<" + nodeName + ">", that.document[0]);
  
              that._addClass(element, "ui-sortable-placeholder", className || that.currentItem[0].className)._removeClass(element, "ui-sortable-helper");
  
              if (nodeName === "tbody") {
                that._createTrPlaceholder(that.currentItem.find("tr").eq(0), $("<tr>", that.document[0]).appendTo(element));
              } else if (nodeName === "tr") {
                that._createTrPlaceholder(that.currentItem, element);
              } else if (nodeName === "img") {
                element.attr("src", that.currentItem.attr("src"));
              }
  
              if (!className) {
                element.css("visibility", "hidden");
              }
  
              return element;
            },
            update: function update(container, p) {
              // 1. If a className is set as 'placeholder option, we don't force sizes -
              // the class is responsible for that
              // 2. The option 'forcePlaceholderSize can be enabled to force it even if a
              // class name is specified
              if (className && !o.forcePlaceholderSize) {
                return;
              } //If the element doesn't have a actual height by itself (without styles coming
              // from a stylesheet), it receives the inline height from the dragged item
  
  
              if (!p.height()) {
                p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css("paddingTop") || 0, 10) - parseInt(that.currentItem.css("paddingBottom") || 0, 10));
              }
  
              if (!p.width()) {
                p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css("paddingLeft") || 0, 10) - parseInt(that.currentItem.css("paddingRight") || 0, 10));
              }
            }
          };
        } //Create the placeholder
  
  
        that.placeholder = $(o.placeholder.element.call(that.element, that.currentItem)); //Append it after the actual current item
  
        that.currentItem.after(that.placeholder); //Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)
  
        o.placeholder.update(that, that.placeholder);
      },
      _createTrPlaceholder: function _createTrPlaceholder(sourceTr, targetTr) {
        var that = this;
        sourceTr.children().each(function () {
          $("<td>&#160;</td>", that.document[0]).attr("colspan", $(this).attr("colspan") || 1).appendTo(targetTr);
        });
      },
      _contactContainers: function _contactContainers(event) {
        var i,
            j,
            dist,
            itemWithLeastDistance,
            posProperty,
            sizeProperty,
            cur,
            nearBottom,
            floating,
            axis,
            innermostContainer = null,
            innermostIndex = null; // Get innermost container that intersects with item
  
        for (i = this.containers.length - 1; i >= 0; i--) {
          // Never consider a container that's located within the item itself
          if ($.contains(this.currentItem[0], this.containers[i].element[0])) {
            continue;
          }
  
          if (this._intersectsWith(this.containers[i].containerCache)) {
            // If we've already found a container and it's more "inner" than this, then continue
            if (innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0])) {
              continue;
            }
  
            innermostContainer = this.containers[i];
            innermostIndex = i;
          } else {
            // container doesn't intersect. trigger "out" event if necessary
            if (this.containers[i].containerCache.over) {
              this.containers[i]._trigger("out", event, this._uiHash(this));
  
              this.containers[i].containerCache.over = 0;
            }
          }
        } // If no intersecting containers found, return
  
  
        if (!innermostContainer) {
          return;
        } // Move the item into the container if it's not there already
  
  
        if (this.containers.length === 1) {
          if (!this.containers[innermostIndex].containerCache.over) {
            this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
  
            this.containers[innermostIndex].containerCache.over = 1;
          }
        } else {
          // When entering a new container, we will find the item with the least distance and
          // append our item near it
          dist = 10000;
          itemWithLeastDistance = null;
          floating = innermostContainer.floating || this._isFloating(this.currentItem);
          posProperty = floating ? "left" : "top";
          sizeProperty = floating ? "width" : "height";
          axis = floating ? "pageX" : "pageY";
  
          for (j = this.items.length - 1; j >= 0; j--) {
            if (!$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) {
              continue;
            }
  
            if (this.items[j].item[0] === this.currentItem[0]) {
              continue;
            }
  
            cur = this.items[j].item.offset()[posProperty];
            nearBottom = false;
  
            if (event[axis] - cur > this.items[j][sizeProperty] / 2) {
              nearBottom = true;
            }
  
            if (Math.abs(event[axis] - cur) < dist) {
              dist = Math.abs(event[axis] - cur);
              itemWithLeastDistance = this.items[j];
              this.direction = nearBottom ? "up" : "down";
            }
          } //Check if dropOnEmpty is enabled
  
  
          if (!itemWithLeastDistance && !this.options.dropOnEmpty) {
            return;
          }
  
          if (this.currentContainer === this.containers[innermostIndex]) {
            if (!this.currentContainer.containerCache.over) {
              this.containers[innermostIndex]._trigger("over", event, this._uiHash());
  
              this.currentContainer.containerCache.over = 1;
            }
  
            return;
          }
  
          itemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);
  
          this._trigger("change", event, this._uiHash());
  
          this.containers[innermostIndex]._trigger("change", event, this._uiHash(this));
  
          this.currentContainer = this.containers[innermostIndex]; //Update the placeholder
  
          this.options.placeholder.update(this.currentContainer, this.placeholder);
  
          this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
  
          this.containers[innermostIndex].containerCache.over = 1;
        }
      },
      _createHelper: function _createHelper(event) {
        var o = this.options,
            helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : o.helper === "clone" ? this.currentItem.clone() : this.currentItem; //Add the helper to the DOM if that didn't happen already
  
        if (!helper.parents("body").length) {
          $(o.appendTo !== "parent" ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);
        }
  
        if (helper[0] === this.currentItem[0]) {
          this._storedCSS = {
            width: this.currentItem[0].style.width,
            height: this.currentItem[0].style.height,
            position: this.currentItem.css("position"),
            top: this.currentItem.css("top"),
            left: this.currentItem.css("left")
          };
        }
  
        if (!helper[0].style.width || o.forceHelperSize) {
          helper.width(this.currentItem.width());
        }
  
        if (!helper[0].style.height || o.forceHelperSize) {
          helper.height(this.currentItem.height());
        }
  
        return helper;
      },
      _adjustOffsetFromHelper: function _adjustOffsetFromHelper(obj) {
        if (typeof obj === "string") {
          obj = obj.split(" ");
        }
  
        if ($.isArray(obj)) {
          obj = {
            left: +obj[0],
            top: +obj[1] || 0
          };
        }
  
        if ("left" in obj) {
          this.offset.click.left = obj.left + this.margins.left;
        }
  
        if ("right" in obj) {
          this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
        }
  
        if ("top" in obj) {
          this.offset.click.top = obj.top + this.margins.top;
        }
  
        if ("bottom" in obj) {
          this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
        }
      },
      _getParentOffset: function _getParentOffset() {
        //Get the offsetParent and cache its position
        this.offsetParent = this.helper.offsetParent();
        var po = this.offsetParent.offset(); // This is a special case where we need to modify a offset calculated on start, since the
        // following happened:
        // 1. The position of the helper is absolute, so it's position is calculated based on the
        // next positioned parent
        // 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't
        // the document, which means that the scroll is included in the initial calculation of the
        // offset of the parent, and never recalculated upon drag
  
        if (this.cssPosition === "absolute" && this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) {
          po.left += this.scrollParent.scrollLeft();
          po.top += this.scrollParent.scrollTop();
        } // This needs to be actually done for all browsers, since pageX/pageY includes this
        // information with an ugly IE fix
  
  
        if (this.offsetParent[0] === this.document[0].body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && $.ui.ie) {
          po = {
            top: 0,
            left: 0
          };
        }
  
        return {
          top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
          left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
        };
      },
      _getRelativeOffset: function _getRelativeOffset() {
        if (this.cssPosition === "relative") {
          var p = this.currentItem.position();
          return {
            top: p.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
            left: p.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
          };
        } else {
          return {
            top: 0,
            left: 0
          };
        }
      },
      _cacheMargins: function _cacheMargins() {
        this.margins = {
          left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
          top: parseInt(this.currentItem.css("marginTop"), 10) || 0
        };
      },
      _cacheHelperProportions: function _cacheHelperProportions() {
        this.helperProportions = {
          width: this.helper.outerWidth(),
          height: this.helper.outerHeight()
        };
      },
      _setContainment: function _setContainment() {
        var ce,
            co,
            over,
            o = this.options;
  
        if (o.containment === "parent") {
          o.containment = this.helper[0].parentNode;
        }
  
        if (o.containment === "document" || o.containment === "window") {
          this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, o.containment === "document" ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left, (o.containment === "document" ? this.document.height() || document.body.parentNode.scrollHeight : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
        }
  
        if (!/^(document|window|parent)$/.test(o.containment)) {
          ce = $(o.containment)[0];
          co = $(o.containment).offset();
          over = $(ce).css("overflow") !== "hidden";
          this.containment = [co.left + (parseInt($(ce).css("borderLeftWidth"), 10) || 0) + (parseInt($(ce).css("paddingLeft"), 10) || 0) - this.margins.left, co.top + (parseInt($(ce).css("borderTopWidth"), 10) || 0) + (parseInt($(ce).css("paddingTop"), 10) || 0) - this.margins.top, co.left + (over ? Math.max(ce.scrollWidth, ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"), 10) || 0) - (parseInt($(ce).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, co.top + (over ? Math.max(ce.scrollHeight, ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"), 10) || 0) - (parseInt($(ce).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top];
        }
      },
      _convertPositionTo: function _convertPositionTo(d, pos) {
        if (!pos) {
          pos = this.position;
        }
  
        var mod = d === "absolute" ? 1 : -1,
            scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,
            scrollIsRootNode = /(html|body)/i.test(scroll[0].tagName);
        return {
          top: // The absolute mouse position
          pos.top + // Only for relative positioned nodes: Relative offset from element to offset parent
          this.offset.relative.top * mod + // The offsetParent's offset without borders (offset + border)
          this.offset.parent.top * mod - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : scrollIsRootNode ? 0 : scroll.scrollTop()) * mod,
          left: // The absolute mouse position
          pos.left + // Only for relative positioned nodes: Relative offset from element to offset parent
          this.offset.relative.left * mod + // The offsetParent's offset without borders (offset + border)
          this.offset.parent.left * mod - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft()) * mod
        };
      },
      _generatePosition: function _generatePosition(event) {
        var top,
            left,
            o = this.options,
            pageX = event.pageX,
            pageY = event.pageY,
            scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,
            scrollIsRootNode = /(html|body)/i.test(scroll[0].tagName); // This is another very weird special case that only happens for relative elements:
        // 1. If the css position is relative
        // 2. and the scroll parent is the document or similar to the offset parent
        // we have to refresh the relative offset during the scroll so there are no jumps
  
        if (this.cssPosition === "relative" && !(this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0])) {
          this.offset.relative = this._getRelativeOffset();
        }
        /*
         * - Position constraining -
         * Constrain the position to a mix of grid, containment.
         */
  
  
        if (this.originalPosition) {
          //If we are not dragging yet, we won't check for options
          if (this.containment) {
            if (event.pageX - this.offset.click.left < this.containment[0]) {
              pageX = this.containment[0] + this.offset.click.left;
            }
  
            if (event.pageY - this.offset.click.top < this.containment[1]) {
              pageY = this.containment[1] + this.offset.click.top;
            }
  
            if (event.pageX - this.offset.click.left > this.containment[2]) {
              pageX = this.containment[2] + this.offset.click.left;
            }
  
            if (event.pageY - this.offset.click.top > this.containment[3]) {
              pageY = this.containment[3] + this.offset.click.top;
            }
          }
  
          if (o.grid) {
            top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];
            pageY = this.containment ? top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3] ? top : top - this.offset.click.top >= this.containment[1] ? top - o.grid[1] : top + o.grid[1] : top;
            left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];
            pageX = this.containment ? left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2] ? left : left - this.offset.click.left >= this.containment[0] ? left - o.grid[0] : left + o.grid[0] : left;
          }
        }
  
        return {
          top: // The absolute mouse position
          pageY - // Click offset (relative to the element)
          this.offset.click.top - // Only for relative positioned nodes: Relative offset from element to offset parent
          this.offset.relative.top - // The offsetParent's offset without borders (offset + border)
          this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : scrollIsRootNode ? 0 : scroll.scrollTop()),
          left: // The absolute mouse position
          pageX - // Click offset (relative to the element)
          this.offset.click.left - // Only for relative positioned nodes: Relative offset from element to offset parent
          this.offset.relative.left - // The offsetParent's offset without borders (offset + border)
          this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft())
        };
      },
      _rearrange: function _rearrange(event, i, a, hardRefresh) {
        a ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], this.direction === "down" ? i.item[0] : i.item[0].nextSibling); //Various things done here to improve the performance:
        // 1. we create a setTimeout, that calls refreshPositions
        // 2. on the instance, we have a counter variable, that get's higher after every append
        // 3. on the local scope, we copy the counter variable, and check in the timeout,
        // if it's still the same
        // 4. this lets only the last addition to the timeout stack through
  
        this.counter = this.counter ? ++this.counter : 1;
        var counter = this.counter;
  
        this._delay(function () {
          if (counter === this.counter) {
            //Precompute after each DOM insertion, NOT on mousemove
            this.refreshPositions(!hardRefresh);
          }
        });
      },
      _clear: function _clear(event, noPropagation) {
        this.reverting = false; // We delay all events that have to be triggered to after the point where the placeholder
        // has been removed and everything else normalized again
  
        var i,
            delayedTriggers = []; // We first have to update the dom position of the actual currentItem
        // Note: don't do it if the current item is already removed (by a user), or it gets
        // reappended (see #4088)
  
        if (!this._noFinalSort && this.currentItem.parent().length) {
          this.placeholder.before(this.currentItem);
        }
  
        this._noFinalSort = null;
  
        if (this.helper[0] === this.currentItem[0]) {
          for (i in this._storedCSS) {
            if (this._storedCSS[i] === "auto" || this._storedCSS[i] === "static") {
              this._storedCSS[i] = "";
            }
          }
  
          this.currentItem.css(this._storedCSS);
  
          this._removeClass(this.currentItem, "ui-sortable-helper");
        } else {
          this.currentItem.show();
        }
  
        if (this.fromOutside && !noPropagation) {
          delayedTriggers.push(function (event) {
            this._trigger("receive", event, this._uiHash(this.fromOutside));
          });
        }
  
        if ((this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !noPropagation) {
          // Trigger update callback if the DOM position has changed
          delayedTriggers.push(function (event) {
            this._trigger("update", event, this._uiHash());
          });
        } // Check if the items Container has Changed and trigger appropriate
        // events.
  
  
        if (this !== this.currentContainer) {
          if (!noPropagation) {
            delayedTriggers.push(function (event) {
              this._trigger("remove", event, this._uiHash());
            });
            delayedTriggers.push(function (c) {
              return function (event) {
                c._trigger("receive", event, this._uiHash(this));
              };
            }.call(this, this.currentContainer));
            delayedTriggers.push(function (c) {
              return function (event) {
                c._trigger("update", event, this._uiHash(this));
              };
            }.call(this, this.currentContainer));
          }
        } //Post events to containers
  
  
        function delayEvent(type, instance, container) {
          return function (event) {
            container._trigger(type, event, instance._uiHash(instance));
          };
        }
  
        for (i = this.containers.length - 1; i >= 0; i--) {
          if (!noPropagation) {
            delayedTriggers.push(delayEvent("deactivate", this, this.containers[i]));
          }
  
          if (this.containers[i].containerCache.over) {
            delayedTriggers.push(delayEvent("out", this, this.containers[i]));
            this.containers[i].containerCache.over = 0;
          }
        } //Do what was originally in plugins
  
  
        if (this.storedCursor) {
          this.document.find("body").css("cursor", this.storedCursor);
          this.storedStylesheet.remove();
        }
  
        if (this._storedOpacity) {
          this.helper.css("opacity", this._storedOpacity);
        }
  
        if (this._storedZIndex) {
          this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex);
        }
  
        this.dragging = false;
  
        if (!noPropagation) {
          this._trigger("beforeStop", event, this._uiHash());
        } //$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately,
        // it unbinds ALL events from the original node!
  
  
        this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
  
        if (!this.cancelHelperRemoval) {
          if (this.helper[0] !== this.currentItem[0]) {
            this.helper.remove();
          }
  
          this.helper = null;
        }
  
        if (!noPropagation) {
          for (i = 0; i < delayedTriggers.length; i++) {
            // Trigger all delayed events
            delayedTriggers[i].call(this, event);
          }
  
          this._trigger("stop", event, this._uiHash());
        }
  
        this.fromOutside = false;
        return !this.cancelHelperRemoval;
      },
      _trigger: function _trigger() {
        if ($.Widget.prototype._trigger.apply(this, arguments) === false) {
          this.cancel();
        }
      },
      _uiHash: function _uiHash(_inst) {
        var inst = _inst || this;
        return {
          helper: inst.helper,
          placeholder: inst.placeholder || $([]),
          position: inst.position,
          originalPosition: inst.originalPosition,
          offset: inst.positionAbs,
          item: inst.currentItem,
          sender: _inst ? _inst.element : null
        };
      }
    }); // jscs:disable maximumLineLength
  
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
  
    /*!
     * jQuery UI Datepicker 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Datepicker
    //>>group: Widgets
    //>>description: Displays a calendar from an input or inline for selecting dates.
    //>>docs: http://api.jqueryui.com/datepicker/
    //>>demos: http://jqueryui.com/datepicker/
    //>>css.structure: ../../themes/base/core.css
    //>>css.structure: ../../themes/base/datepicker.css
    //>>css.theme: ../../themes/base/theme.css
  
    $.extend($.ui, {
      datepicker: {
        version: "1.12.1"
      }
    });
    var datepicker_instActive;
  
    function datepicker_getZindex(elem) {
      var position, value;
  
      while (elem.length && elem[0] !== document) {
        // Ignore z-index if position is set to a value where z-index is ignored by the browser
        // This makes behavior of this function consistent across browsers
        // WebKit always returns auto if the element is positioned
        position = elem.css("position");
  
        if (position === "absolute" || position === "relative" || position === "fixed") {
          // IE returns 0 when zIndex is not specified
          // other browsers return a string
          // we ignore the case of nested elements with an explicit value of 0
          // <div style="z-index: -10;"><div style="z-index: 0;"></div></div>
          value = parseInt(elem.css("zIndex"), 10);
  
          if (!isNaN(value) && value !== 0) {
            return value;
          }
        }
  
        elem = elem.parent();
      }
  
      return 0;
    }
    /* Date picker manager.
       Use the singleton instance of this class, $.datepicker, to interact with the date picker.
       Settings for (groups of) date pickers are maintained in an instance object,
       allowing multiple different settings on the same page. */
  
  
    function Datepicker() {
      this._curInst = null; // The current instance in use
  
      this._keyEvent = false; // If the last event was a key event
  
      this._disabledInputs = []; // List of date picker inputs that have been disabled
  
      this._datepickerShowing = false; // True if the popup picker is showing , false if not
  
      this._inDialog = false; // True if showing within a "dialog", false if not
  
      this._mainDivId = "ui-datepicker-div"; // The ID of the main datepicker division
  
      this._inlineClass = "ui-datepicker-inline"; // The name of the inline marker class
  
      this._appendClass = "ui-datepicker-append"; // The name of the append marker class
  
      this._triggerClass = "ui-datepicker-trigger"; // The name of the trigger marker class
  
      this._dialogClass = "ui-datepicker-dialog"; // The name of the dialog marker class
  
      this._disableClass = "ui-datepicker-disabled"; // The name of the disabled covering marker class
  
      this._unselectableClass = "ui-datepicker-unselectable"; // The name of the unselectable cell marker class
  
      this._currentClass = "ui-datepicker-current-day"; // The name of the current day marker class
  
      this._dayOverClass = "ui-datepicker-days-cell-over"; // The name of the day hover marker class
  
      this.regional = []; // Available regional settings, indexed by language code
  
      this.regional[""] = {
        // Default regional settings
        closeText: "Done",
        // Display text for close link
        prevText: "Prev",
        // Display text for previous month link
        nextText: "Next",
        // Display text for next month link
        currentText: "Today",
        // Display text for current month link
        monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        // Names of months for drop-down and formatting
        monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
        // For formatting
        dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
        // For formatting
        dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
        // For formatting
        dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
        // Column headings for days starting at Sunday
        weekHeader: "Wk",
        // Column header for week of the year
        dateFormat: "mm/dd/yy",
        // See format options on parseDate
        firstDay: 0,
        // The first day of the week, Sun = 0, Mon = 1, ...
        isRTL: false,
        // True if right-to-left language, false if left-to-right
        showMonthAfterYear: false,
        // True if the year select precedes month, false for month then year
        yearSuffix: "" // Additional text to append to the year in the month headers
  
      };
      this._defaults = {
        // Global defaults for all the date picker instances
        showOn: "focus",
        // "focus" for popup on focus,
        // "button" for trigger button, or "both" for either
        showAnim: "fadeIn",
        // Name of jQuery animation for popup
        showOptions: {},
        // Options for enhanced animations
        defaultDate: null,
        // Used when field is blank: actual date,
        // +/-number for offset from today, null for today
        appendText: "",
        // Display text following the input box, e.g. showing the format
        buttonText: "...",
        // Text for trigger button
        buttonImage: "",
        // URL for trigger button image
        buttonImageOnly: false,
        // True if the image appears alone, false if it appears on a button
        hideIfNoPrevNext: false,
        // True to hide next/previous month links
        // if not applicable, false to just disable them
        navigationAsDateFormat: false,
        // True if date formatting applied to prev/today/next links
        gotoCurrent: false,
        // True if today link goes back to current selection instead
        changeMonth: false,
        // True if month can be selected directly, false if only prev/next
        changeYear: false,
        // True if year can be selected directly, false if only prev/next
        yearRange: "c-10:c+10",
        // Range of years to display in drop-down,
        // either relative to today's year (-nn:+nn), relative to currently displayed year
        // (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)
        showOtherMonths: false,
        // True to show dates in other months, false to leave blank
        selectOtherMonths: false,
        // True to allow selection of dates in other months, false for unselectable
        showWeek: false,
        // True to show week of the year, false to not show it
        calculateWeek: this.iso8601Week,
        // How to calculate the week of the year,
        // takes a Date and returns the number of the week for it
        shortYearCutoff: "+10",
        // Short year values < this are in the current century,
        // > this are in the previous century,
        // string value starting with "+" for current year + value
        minDate: null,
        // The earliest selectable date, or null for no limit
        maxDate: null,
        // The latest selectable date, or null for no limit
        duration: "fast",
        // Duration of display/closure
        beforeShowDay: null,
        // Function that takes a date and returns an array with
        // [0] = true if selectable, false if not, [1] = custom CSS class name(s) or "",
        // [2] = cell title (optional), e.g. $.datepicker.noWeekends
        beforeShow: null,
        // Function that takes an input field and
        // returns a set of custom settings for the date picker
        onSelect: null,
        // Define a callback function when a date is selected
        onChangeMonthYear: null,
        // Define a callback function when the month or year is changed
        onClose: null,
        // Define a callback function when the datepicker is closed
        numberOfMonths: 1,
        // Number of months to show at a time
        showCurrentAtPos: 0,
        // The position in multipe months at which to show the current month (starting at 0)
        stepMonths: 1,
        // Number of months to step back/forward
        stepBigMonths: 12,
        // Number of months to step back/forward for the big links
        altField: "",
        // Selector for an alternate field to store selected dates into
        altFormat: "",
        // The date format to use for the alternate field
        constrainInput: true,
        // The input is constrained by the current date format
        showButtonPanel: false,
        // True to show button panel, false to not show it
        autoSize: false,
        // True to size the input for the date format, false to leave as is
        disabled: false // The initial disabled state
  
      };
      $.extend(this._defaults, this.regional[""]);
      this.regional.en = $.extend(true, {}, this.regional[""]);
      this.regional["en-US"] = $.extend(true, {}, this.regional.en);
      this.dpDiv = datepicker_bindHover($("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));
    }
  
    $.extend(Datepicker.prototype, {
      /* Class name added to elements to indicate already configured with a date picker. */
      markerClassName: "hasDatepicker",
      //Keep track of the maximum number of rows displayed (see #7043)
      maxRows: 4,
      // TODO rename to "widget" when switching to widget factory
      _widgetDatepicker: function _widgetDatepicker() {
        return this.dpDiv;
      },
  
      /* Override the default settings for all instances of the date picker.
       * @param  settings  object - the new settings to use as defaults (anonymous object)
       * @return the manager object
       */
      setDefaults: function setDefaults(settings) {
        datepicker_extendRemove(this._defaults, settings || {});
        return this;
      },
  
      /* Attach the date picker to a jQuery selection.
       * @param  target	element - the target input field or division or span
       * @param  settings  object - the new settings to use for this date picker instance (anonymous)
       */
      _attachDatepicker: function _attachDatepicker(target, settings) {
        var nodeName, inline, inst;
        nodeName = target.nodeName.toLowerCase();
        inline = nodeName === "div" || nodeName === "span";
  
        if (!target.id) {
          this.uuid += 1;
          target.id = "dp" + this.uuid;
        }
  
        inst = this._newInst($(target), inline);
        inst.settings = $.extend({}, settings || {});
  
        if (nodeName === "input") {
          this._connectDatepicker(target, inst);
        } else if (inline) {
          this._inlineDatepicker(target, inst);
        }
      },
  
      /* Create a new instance object. */
      _newInst: function _newInst(target, inline) {
        var id = target[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1"); // escape jQuery meta chars
  
        return {
          id: id,
          input: target,
          // associated target
          selectedDay: 0,
          selectedMonth: 0,
          selectedYear: 0,
          // current selection
          drawMonth: 0,
          drawYear: 0,
          // month being drawn
          inline: inline,
          // is datepicker inline or not
          dpDiv: !inline ? this.dpDiv : // presentation div
          datepicker_bindHover($("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
        };
      },
  
      /* Attach the date picker to an input field. */
      _connectDatepicker: function _connectDatepicker(target, inst) {
        var input = $(target);
        inst.append = $([]);
        inst.trigger = $([]);
  
        if (input.hasClass(this.markerClassName)) {
          return;
        }
  
        this._attachments(input, inst);
  
        input.addClass(this.markerClassName).on("keydown", this._doKeyDown).on("keypress", this._doKeyPress).on("keyup", this._doKeyUp);
  
        this._autoSize(inst);
  
        $.data(target, "datepicker", inst); //If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)
  
        if (inst.settings.disabled) {
          this._disableDatepicker(target);
        }
      },
  
      /* Make attachments based on settings. */
      _attachments: function _attachments(input, inst) {
        var showOn,
            buttonText,
            buttonImage,
            appendText = this._get(inst, "appendText"),
            isRTL = this._get(inst, "isRTL");
  
        if (inst.append) {
          inst.append.remove();
        }
  
        if (appendText) {
          inst.append = $("<span class='" + this._appendClass + "'>" + appendText + "</span>");
          input[isRTL ? "before" : "after"](inst.append);
        }
  
        input.off("focus", this._showDatepicker);
  
        if (inst.trigger) {
          inst.trigger.remove();
        }
  
        showOn = this._get(inst, "showOn");
  
        if (showOn === "focus" || showOn === "both") {
          // pop-up date picker when in the marked field
          input.on("focus", this._showDatepicker);
        }
  
        if (showOn === "button" || showOn === "both") {
          // pop-up date picker when button clicked
          buttonText = this._get(inst, "buttonText");
          buttonImage = this._get(inst, "buttonImage");
          inst.trigger = $(this._get(inst, "buttonImageOnly") ? $("<img/>").addClass(this._triggerClass).attr({
            src: buttonImage,
            alt: buttonText,
            title: buttonText
          }) : $("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage ? buttonText : $("<img/>").attr({
            src: buttonImage,
            alt: buttonText,
            title: buttonText
          })));
          input[isRTL ? "before" : "after"](inst.trigger);
          inst.trigger.on("click", function () {
            if ($.datepicker._datepickerShowing && $.datepicker._lastInput === input[0]) {
              $.datepicker._hideDatepicker();
            } else if ($.datepicker._datepickerShowing && $.datepicker._lastInput !== input[0]) {
              $.datepicker._hideDatepicker();
  
              $.datepicker._showDatepicker(input[0]);
            } else {
              $.datepicker._showDatepicker(input[0]);
            }
  
            return false;
          });
        }
      },
  
      /* Apply the maximum length for the date format. */
      _autoSize: function _autoSize(inst) {
        if (this._get(inst, "autoSize") && !inst.inline) {
          var findMax,
              max,
              maxI,
              i,
              date = new Date(2009, 12 - 1, 20),
              // Ensure double digits
          dateFormat = this._get(inst, "dateFormat");
  
          if (dateFormat.match(/[DM]/)) {
            findMax = function findMax(names) {
              max = 0;
              maxI = 0;
  
              for (i = 0; i < names.length; i++) {
                if (names[i].length > max) {
                  max = names[i].length;
                  maxI = i;
                }
              }
  
              return maxI;
            };
  
            date.setMonth(findMax(this._get(inst, dateFormat.match(/MM/) ? "monthNames" : "monthNamesShort")));
            date.setDate(findMax(this._get(inst, dateFormat.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - date.getDay());
          }
  
          inst.input.attr("size", this._formatDate(inst, date).length);
        }
      },
  
      /* Attach an inline date picker to a div. */
      _inlineDatepicker: function _inlineDatepicker(target, inst) {
        var divSpan = $(target);
  
        if (divSpan.hasClass(this.markerClassName)) {
          return;
        }
  
        divSpan.addClass(this.markerClassName).append(inst.dpDiv);
        $.data(target, "datepicker", inst);
  
        this._setDate(inst, this._getDefaultDate(inst), true);
  
        this._updateDatepicker(inst);
  
        this._updateAlternate(inst); //If disabled option is true, disable the datepicker before showing it (see ticket #5665)
  
  
        if (inst.settings.disabled) {
          this._disableDatepicker(target);
        } // Set display:block in place of inst.dpDiv.show() which won't work on disconnected elements
        // http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height
  
  
        inst.dpDiv.css("display", "block");
      },
  
      /* Pop-up the date picker in a "dialog" box.
       * @param  input element - ignored
       * @param  date	string or Date - the initial date to display
       * @param  onSelect  function - the function to call when a date is selected
       * @param  settings  object - update the dialog date picker instance's settings (anonymous object)
       * @param  pos int[2] - coordinates for the dialog's position within the screen or
       *					event - with x/y coordinates or
       *					leave empty for default (screen centre)
       * @return the manager object
       */
      _dialogDatepicker: function _dialogDatepicker(input, date, onSelect, settings, pos) {
        var id,
            browserWidth,
            browserHeight,
            scrollX,
            scrollY,
            inst = this._dialogInst; // internal instance
  
        if (!inst) {
          this.uuid += 1;
          id = "dp" + this.uuid;
          this._dialogInput = $("<input type='text' id='" + id + "' style='position: absolute; top: -100px; width: 0px;'/>");
  
          this._dialogInput.on("keydown", this._doKeyDown);
  
          $("body").append(this._dialogInput);
          inst = this._dialogInst = this._newInst(this._dialogInput, false);
          inst.settings = {};
          $.data(this._dialogInput[0], "datepicker", inst);
        }
  
        datepicker_extendRemove(inst.settings, settings || {});
        date = date && date.constructor === Date ? this._formatDate(inst, date) : date;
  
        this._dialogInput.val(date);
  
        this._pos = pos ? pos.length ? pos : [pos.pageX, pos.pageY] : null;
  
        if (!this._pos) {
          browserWidth = document.documentElement.clientWidth;
          browserHeight = document.documentElement.clientHeight;
          scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
          scrollY = document.documentElement.scrollTop || document.body.scrollTop;
          this._pos = // should use actual width/height below
          [browserWidth / 2 - 100 + scrollX, browserHeight / 2 - 150 + scrollY];
        } // Move input on screen for focus, but hidden behind dialog
  
  
        this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px");
  
        inst.settings.onSelect = onSelect;
        this._inDialog = true;
        this.dpDiv.addClass(this._dialogClass);
  
        this._showDatepicker(this._dialogInput[0]);
  
        if ($.blockUI) {
          $.blockUI(this.dpDiv);
        }
  
        $.data(this._dialogInput[0], "datepicker", inst);
        return this;
      },
  
      /* Detach a datepicker from its control.
       * @param  target	element - the target input field or division or span
       */
      _destroyDatepicker: function _destroyDatepicker(target) {
        var nodeName,
            $target = $(target),
            inst = $.data(target, "datepicker");
  
        if (!$target.hasClass(this.markerClassName)) {
          return;
        }
  
        nodeName = target.nodeName.toLowerCase();
        $.removeData(target, "datepicker");
  
        if (nodeName === "input") {
          inst.append.remove();
          inst.trigger.remove();
          $target.removeClass(this.markerClassName).off("focus", this._showDatepicker).off("keydown", this._doKeyDown).off("keypress", this._doKeyPress).off("keyup", this._doKeyUp);
        } else if (nodeName === "div" || nodeName === "span") {
          $target.removeClass(this.markerClassName).empty();
        }
  
        if (datepicker_instActive === inst) {
          datepicker_instActive = null;
        }
      },
  
      /* Enable the date picker to a jQuery selection.
       * @param  target	element - the target input field or division or span
       */
      _enableDatepicker: function _enableDatepicker(target) {
        var nodeName,
            inline,
            $target = $(target),
            inst = $.data(target, "datepicker");
  
        if (!$target.hasClass(this.markerClassName)) {
          return;
        }
  
        nodeName = target.nodeName.toLowerCase();
  
        if (nodeName === "input") {
          target.disabled = false;
          inst.trigger.filter("button").each(function () {
            this.disabled = false;
          }).end().filter("img").css({
            opacity: "1.0",
            cursor: ""
          });
        } else if (nodeName === "div" || nodeName === "span") {
          inline = $target.children("." + this._inlineClass);
          inline.children().removeClass("ui-state-disabled");
          inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", false);
        }
  
        this._disabledInputs = $.map(this._disabledInputs, function (value) {
          return value === target ? null : value;
        }); // delete entry
      },
  
      /* Disable the date picker to a jQuery selection.
       * @param  target	element - the target input field or division or span
       */
      _disableDatepicker: function _disableDatepicker(target) {
        var nodeName,
            inline,
            $target = $(target),
            inst = $.data(target, "datepicker");
  
        if (!$target.hasClass(this.markerClassName)) {
          return;
        }
  
        nodeName = target.nodeName.toLowerCase();
  
        if (nodeName === "input") {
          target.disabled = true;
          inst.trigger.filter("button").each(function () {
            this.disabled = true;
          }).end().filter("img").css({
            opacity: "0.5",
            cursor: "default"
          });
        } else if (nodeName === "div" || nodeName === "span") {
          inline = $target.children("." + this._inlineClass);
          inline.children().addClass("ui-state-disabled");
          inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", true);
        }
  
        this._disabledInputs = $.map(this._disabledInputs, function (value) {
          return value === target ? null : value;
        }); // delete entry
  
        this._disabledInputs[this._disabledInputs.length] = target;
      },
  
      /* Is the first field in a jQuery collection disabled as a datepicker?
       * @param  target	element - the target input field or division or span
       * @return boolean - true if disabled, false if enabled
       */
      _isDisabledDatepicker: function _isDisabledDatepicker(target) {
        if (!target) {
          return false;
        }
  
        for (var i = 0; i < this._disabledInputs.length; i++) {
          if (this._disabledInputs[i] === target) {
            return true;
          }
        }
  
        return false;
      },
  
      /* Retrieve the instance data for the target control.
       * @param  target  element - the target input field or division or span
       * @return  object - the associated instance data
       * @throws  error if a jQuery problem getting data
       */
      _getInst: function _getInst(target) {
        try {
          return $.data(target, "datepicker");
        } catch (err) {
          throw "Missing instance data for this datepicker";
        }
      },
  
      /* Update or retrieve the settings for a date picker attached to an input field or division.
       * @param  target  element - the target input field or division or span
       * @param  name	object - the new settings to update or
       *				string - the name of the setting to change or retrieve,
       *				when retrieving also "all" for all instance settings or
       *				"defaults" for all global defaults
       * @param  value   any - the new value for the setting
       *				(omit if above is an object or to retrieve a value)
       */
      _optionDatepicker: function _optionDatepicker(target, name, value) {
        var settings,
            date,
            minDate,
            maxDate,
            inst = this._getInst(target);
  
        if (arguments.length === 2 && typeof name === "string") {
          return name === "defaults" ? $.extend({}, $.datepicker._defaults) : inst ? name === "all" ? $.extend({}, inst.settings) : this._get(inst, name) : null;
        }
  
        settings = name || {};
  
        if (typeof name === "string") {
          settings = {};
          settings[name] = value;
        }
  
        if (inst) {
          if (this._curInst === inst) {
            this._hideDatepicker();
          }
  
          date = this._getDateDatepicker(target, true);
          minDate = this._getMinMaxDate(inst, "min");
          maxDate = this._getMinMaxDate(inst, "max");
          datepicker_extendRemove(inst.settings, settings); // reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn't provided
  
          if (minDate !== null && settings.dateFormat !== undefined && settings.minDate === undefined) {
            inst.settings.minDate = this._formatDate(inst, minDate);
          }
  
          if (maxDate !== null && settings.dateFormat !== undefined && settings.maxDate === undefined) {
            inst.settings.maxDate = this._formatDate(inst, maxDate);
          }
  
          if ("disabled" in settings) {
            if (settings.disabled) {
              this._disableDatepicker(target);
            } else {
              this._enableDatepicker(target);
            }
          }
  
          this._attachments($(target), inst);
  
          this._autoSize(inst);
  
          this._setDate(inst, date);
  
          this._updateAlternate(inst);
  
          this._updateDatepicker(inst);
        }
      },
      // Change method deprecated
      _changeDatepicker: function _changeDatepicker(target, name, value) {
        this._optionDatepicker(target, name, value);
      },
  
      /* Redraw the date picker attached to an input field or division.
       * @param  target  element - the target input field or division or span
       */
      _refreshDatepicker: function _refreshDatepicker(target) {
        var inst = this._getInst(target);
  
        if (inst) {
          this._updateDatepicker(inst);
        }
      },
  
      /* Set the dates for a jQuery selection.
       * @param  target element - the target input field or division or span
       * @param  date	Date - the new date
       */
      _setDateDatepicker: function _setDateDatepicker(target, date) {
        var inst = this._getInst(target);
  
        if (inst) {
          this._setDate(inst, date);
  
          this._updateDatepicker(inst);
  
          this._updateAlternate(inst);
        }
      },
  
      /* Get the date(s) for the first entry in a jQuery selection.
       * @param  target element - the target input field or division or span
       * @param  noDefault boolean - true if no default date is to be used
       * @return Date - the current date
       */
      _getDateDatepicker: function _getDateDatepicker(target, noDefault) {
        var inst = this._getInst(target);
  
        if (inst && !inst.inline) {
          this._setDateFromField(inst, noDefault);
        }
  
        return inst ? this._getDate(inst) : null;
      },
  
      /* Handle keystrokes. */
      _doKeyDown: function _doKeyDown(event) {
        var onSelect,
            dateStr,
            sel,
            inst = $.datepicker._getInst(event.target),
            handled = true,
            isRTL = inst.dpDiv.is(".ui-datepicker-rtl");
  
        inst._keyEvent = true;
  
        if ($.datepicker._datepickerShowing) {
          switch (event.keyCode) {
            case 9:
              $.datepicker._hideDatepicker();
  
              handled = false;
              break;
            // hide on tab out
  
            case 13:
              sel = $("td." + $.datepicker._dayOverClass + ":not(." + $.datepicker._currentClass + ")", inst.dpDiv);
  
              if (sel[0]) {
                $.datepicker._selectDay(event.target, inst.selectedMonth, inst.selectedYear, sel[0]);
              }
  
              onSelect = $.datepicker._get(inst, "onSelect");
  
              if (onSelect) {
                dateStr = $.datepicker._formatDate(inst); // Trigger custom callback
  
                onSelect.apply(inst.input ? inst.input[0] : null, [dateStr, inst]);
              } else {
                $.datepicker._hideDatepicker();
              }
  
              return false;
            // don't submit the form
  
            case 27:
              $.datepicker._hideDatepicker();
  
              break;
            // hide on escape
  
            case 33:
              $.datepicker._adjustDate(event.target, event.ctrlKey ? -$.datepicker._get(inst, "stepBigMonths") : -$.datepicker._get(inst, "stepMonths"), "M");
  
              break;
            // previous month/year on page up/+ ctrl
  
            case 34:
              $.datepicker._adjustDate(event.target, event.ctrlKey ? +$.datepicker._get(inst, "stepBigMonths") : +$.datepicker._get(inst, "stepMonths"), "M");
  
              break;
            // next month/year on page down/+ ctrl
  
            case 35:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._clearDate(event.target);
              }
  
              handled = event.ctrlKey || event.metaKey;
              break;
            // clear on ctrl or command +end
  
            case 36:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._gotoToday(event.target);
              }
  
              handled = event.ctrlKey || event.metaKey;
              break;
            // current on ctrl or command +home
  
            case 37:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._adjustDate(event.target, isRTL ? +1 : -1, "D");
              }
  
              handled = event.ctrlKey || event.metaKey; // -1 day on ctrl or command +left
  
              if (event.originalEvent.altKey) {
                $.datepicker._adjustDate(event.target, event.ctrlKey ? -$.datepicker._get(inst, "stepBigMonths") : -$.datepicker._get(inst, "stepMonths"), "M");
              } // next month/year on alt +left on Mac
  
  
              break;
  
            case 38:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._adjustDate(event.target, -7, "D");
              }
  
              handled = event.ctrlKey || event.metaKey;
              break;
            // -1 week on ctrl or command +up
  
            case 39:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._adjustDate(event.target, isRTL ? -1 : +1, "D");
              }
  
              handled = event.ctrlKey || event.metaKey; // +1 day on ctrl or command +right
  
              if (event.originalEvent.altKey) {
                $.datepicker._adjustDate(event.target, event.ctrlKey ? +$.datepicker._get(inst, "stepBigMonths") : +$.datepicker._get(inst, "stepMonths"), "M");
              } // next month/year on alt +right
  
  
              break;
  
            case 40:
              if (event.ctrlKey || event.metaKey) {
                $.datepicker._adjustDate(event.target, +7, "D");
              }
  
              handled = event.ctrlKey || event.metaKey;
              break;
            // +1 week on ctrl or command +down
  
            default:
              handled = false;
          }
        } else if (event.keyCode === 36 && event.ctrlKey) {
          // display the date picker on ctrl+home
          $.datepicker._showDatepicker(this);
        } else {
          handled = false;
        }
  
        if (handled) {
          event.preventDefault();
          event.stopPropagation();
        }
      },
  
      /* Filter entered characters - based on date format. */
      _doKeyPress: function _doKeyPress(event) {
        var chars,
            chr,
            inst = $.datepicker._getInst(event.target);
  
        if ($.datepicker._get(inst, "constrainInput")) {
          chars = $.datepicker._possibleChars($.datepicker._get(inst, "dateFormat"));
          chr = String.fromCharCode(event.charCode == null ? event.keyCode : event.charCode);
          return event.ctrlKey || event.metaKey || chr < " " || !chars || chars.indexOf(chr) > -1;
        }
      },
  
      /* Synchronise manual entry and field/alternate field. */
      _doKeyUp: function _doKeyUp(event) {
        var date,
            inst = $.datepicker._getInst(event.target);
  
        if (inst.input.val() !== inst.lastVal) {
          try {
            date = $.datepicker.parseDate($.datepicker._get(inst, "dateFormat"), inst.input ? inst.input.val() : null, $.datepicker._getFormatConfig(inst));
  
            if (date) {
              // only if valid
              $.datepicker._setDateFromField(inst);
  
              $.datepicker._updateAlternate(inst);
  
              $.datepicker._updateDatepicker(inst);
            }
          } catch (err) {}
        }
  
        return true;
      },
  
      /* Pop-up the date picker for a given input field.
       * If false returned from beforeShow event handler do not show.
       * @param  input  element - the input field attached to the date picker or
       *					event - if triggered by focus
       */
      _showDatepicker: function _showDatepicker(input) {
        input = input.target || input;
  
        if (input.nodeName.toLowerCase() !== "input") {
          // find from button/image trigger
          input = $("input", input.parentNode)[0];
        }
  
        if ($.datepicker._isDisabledDatepicker(input) || $.datepicker._lastInput === input) {
          // already here
          return;
        }
  
        var inst, beforeShow, beforeShowSettings, isFixed, offset, showAnim, duration;
        inst = $.datepicker._getInst(input);
  
        if ($.datepicker._curInst && $.datepicker._curInst !== inst) {
          $.datepicker._curInst.dpDiv.stop(true, true);
  
          if (inst && $.datepicker._datepickerShowing) {
            $.datepicker._hideDatepicker($.datepicker._curInst.input[0]);
          }
        }
  
        beforeShow = $.datepicker._get(inst, "beforeShow");
        beforeShowSettings = beforeShow ? beforeShow.apply(input, [input, inst]) : {};
  
        if (beforeShowSettings === false) {
          return;
        }
  
        datepicker_extendRemove(inst.settings, beforeShowSettings);
        inst.lastVal = null;
        $.datepicker._lastInput = input;
  
        $.datepicker._setDateFromField(inst);
  
        if ($.datepicker._inDialog) {
          // hide cursor
          input.value = "";
        }
  
        if (!$.datepicker._pos) {
          // position below input
          $.datepicker._pos = $.datepicker._findPos(input);
          $.datepicker._pos[1] += input.offsetHeight; // add the height
        }
  
        isFixed = false;
        $(input).parents().each(function () {
          isFixed |= $(this).css("position") === "fixed";
          return !isFixed;
        });
        offset = {
          left: $.datepicker._pos[0],
          top: $.datepicker._pos[1]
        };
        $.datepicker._pos = null; //to avoid flashes on Firefox
  
        inst.dpDiv.empty(); // determine sizing offscreen
  
        inst.dpDiv.css({
          position: "absolute",
          display: "block",
          top: "-1000px"
        });
  
        $.datepicker._updateDatepicker(inst); // fix width for dynamic number of date pickers
        // and adjust position before showing
  
  
        offset = $.datepicker._checkOffset(inst, offset, isFixed);
        inst.dpDiv.css({
          position: $.datepicker._inDialog && $.blockUI ? "static" : isFixed ? "fixed" : "absolute",
          display: "none",
          left: offset.left + "px",
          top: offset.top + "px"
        });
  
        if (!inst.inline) {
          showAnim = $.datepicker._get(inst, "showAnim");
          duration = $.datepicker._get(inst, "duration");
          inst.dpDiv.css("z-index", datepicker_getZindex($(input)) + 1);
          $.datepicker._datepickerShowing = true;
  
          if ($.effects && $.effects.effect[showAnim]) {
            inst.dpDiv.show(showAnim, $.datepicker._get(inst, "showOptions"), duration);
          } else {
            inst.dpDiv[showAnim || "show"](showAnim ? duration : null);
          }
  
          if ($.datepicker._shouldFocusInput(inst)) {
            inst.input.trigger("focus");
          }
  
          $.datepicker._curInst = inst;
        }
      },
  
      /* Generate the date picker content. */
      _updateDatepicker: function _updateDatepicker(inst) {
        this.maxRows = 4; //Reset the max number of rows being displayed (see #7043)
  
        datepicker_instActive = inst; // for delegate hover events
  
        inst.dpDiv.empty().append(this._generateHTML(inst));
  
        this._attachHandlers(inst);
  
        var origyearshtml,
            numMonths = this._getNumberOfMonths(inst),
            cols = numMonths[1],
            width = 17,
            activeCell = inst.dpDiv.find("." + this._dayOverClass + " a");
  
        if (activeCell.length > 0) {
          datepicker_handleMouseover.apply(activeCell.get(0));
        }
  
        inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");
  
        if (cols > 1) {
          inst.dpDiv.addClass("ui-datepicker-multi-" + cols).css("width", width * cols + "em");
        }
  
        inst.dpDiv[(numMonths[0] !== 1 || numMonths[1] !== 1 ? "add" : "remove") + "Class"]("ui-datepicker-multi");
        inst.dpDiv[(this._get(inst, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl");
  
        if (inst === $.datepicker._curInst && $.datepicker._datepickerShowing && $.datepicker._shouldFocusInput(inst)) {
          inst.input.trigger("focus");
        } // Deffered render of the years select (to avoid flashes on Firefox)
  
  
        if (inst.yearshtml) {
          origyearshtml = inst.yearshtml;
          setTimeout(function () {
            //assure that inst.yearshtml didn't change.
            if (origyearshtml === inst.yearshtml && inst.yearshtml) {
              inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);
            }
  
            origyearshtml = inst.yearshtml = null;
          }, 0);
        }
      },
      // #6694 - don't focus the input if it's already focused
      // this breaks the change event in IE
      // Support: IE and jQuery <1.9
      _shouldFocusInput: function _shouldFocusInput(inst) {
        return inst.input && inst.input.is(":visible") && !inst.input.is(":disabled") && !inst.input.is(":focus");
      },
  
      /* Check positioning to remain on screen. */
      _checkOffset: function _checkOffset(inst, offset, isFixed) {
        var dpWidth = inst.dpDiv.outerWidth(),
            dpHeight = inst.dpDiv.outerHeight(),
            inputWidth = inst.input ? inst.input.outerWidth() : 0,
            inputHeight = inst.input ? inst.input.outerHeight() : 0,
            viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft()),
            viewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());
        offset.left -= this._get(inst, "isRTL") ? dpWidth - inputWidth : 0;
        offset.left -= isFixed && offset.left === inst.input.offset().left ? $(document).scrollLeft() : 0;
        offset.top -= isFixed && offset.top === inst.input.offset().top + inputHeight ? $(document).scrollTop() : 0; // Now check if datepicker is showing outside window viewport - move to a better place if so.
  
        offset.left -= Math.min(offset.left, offset.left + dpWidth > viewWidth && viewWidth > dpWidth ? Math.abs(offset.left + dpWidth - viewWidth) : 0);
        offset.top -= Math.min(offset.top, offset.top + dpHeight > viewHeight && viewHeight > dpHeight ? Math.abs(dpHeight + inputHeight) : 0);
        return offset;
      },
  
      /* Find an object's position on the screen. */
      _findPos: function _findPos(obj) {
        var position,
            inst = this._getInst(obj),
            isRTL = this._get(inst, "isRTL");
  
        while (obj && (obj.type === "hidden" || obj.nodeType !== 1 || $.expr.filters.hidden(obj))) {
          obj = obj[isRTL ? "previousSibling" : "nextSibling"];
        }
  
        position = $(obj).offset();
        return [position.left, position.top];
      },
  
      /* Hide the date picker from view.
       * @param  input  element - the input field attached to the date picker
       */
      _hideDatepicker: function _hideDatepicker(input) {
        var showAnim,
            duration,
            postProcess,
            onClose,
            inst = this._curInst;
  
        if (!inst || input && inst !== $.data(input, "datepicker")) {
          return;
        }
  
        if (this._datepickerShowing) {
          showAnim = this._get(inst, "showAnim");
          duration = this._get(inst, "duration");
  
          postProcess = function postProcess() {
            $.datepicker._tidyDialog(inst);
          }; // DEPRECATED: after BC for 1.8.x $.effects[ showAnim ] is not needed
  
  
          if ($.effects && ($.effects.effect[showAnim] || $.effects[showAnim])) {
            inst.dpDiv.hide(showAnim, $.datepicker._get(inst, "showOptions"), duration, postProcess);
          } else {
            inst.dpDiv[showAnim === "slideDown" ? "slideUp" : showAnim === "fadeIn" ? "fadeOut" : "hide"](showAnim ? duration : null, postProcess);
          }
  
          if (!showAnim) {
            postProcess();
          }
  
          this._datepickerShowing = false;
          onClose = this._get(inst, "onClose");
  
          if (onClose) {
            onClose.apply(inst.input ? inst.input[0] : null, [inst.input ? inst.input.val() : "", inst]);
          }
  
          this._lastInput = null;
  
          if (this._inDialog) {
            this._dialogInput.css({
              position: "absolute",
              left: "0",
              top: "-100px"
            });
  
            if ($.blockUI) {
              $.unblockUI();
              $("body").append(this.dpDiv);
            }
          }
  
          this._inDialog = false;
        }
      },
  
      /* Tidy up after a dialog display. */
      _tidyDialog: function _tidyDialog(inst) {
        inst.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar");
      },
  
      /* Close date picker if clicked elsewhere. */
      _checkExternalClick: function _checkExternalClick(event) {
        if (!$.datepicker._curInst) {
          return;
        }
  
        var $target = $(event.target),
            inst = $.datepicker._getInst($target[0]);
  
        if ($target[0].id !== $.datepicker._mainDivId && $target.parents("#" + $.datepicker._mainDivId).length === 0 && !$target.hasClass($.datepicker.markerClassName) && !$target.closest("." + $.datepicker._triggerClass).length && $.datepicker._datepickerShowing && !($.datepicker._inDialog && $.blockUI) || $target.hasClass($.datepicker.markerClassName) && $.datepicker._curInst !== inst) {
          $.datepicker._hideDatepicker();
        }
      },
  
      /* Adjust one of the date sub-fields. */
      _adjustDate: function _adjustDate(id, offset, period) {
        var target = $(id),
            inst = this._getInst(target[0]);
  
        if (this._isDisabledDatepicker(target[0])) {
          return;
        }
  
        this._adjustInstDate(inst, offset + (period === "M" ? this._get(inst, "showCurrentAtPos") : 0), // undo positioning
        period);
  
        this._updateDatepicker(inst);
      },
  
      /* Action for current link. */
      _gotoToday: function _gotoToday(id) {
        var date,
            target = $(id),
            inst = this._getInst(target[0]);
  
        if (this._get(inst, "gotoCurrent") && inst.currentDay) {
          inst.selectedDay = inst.currentDay;
          inst.drawMonth = inst.selectedMonth = inst.currentMonth;
          inst.drawYear = inst.selectedYear = inst.currentYear;
        } else {
          date = new Date();
          inst.selectedDay = date.getDate();
          inst.drawMonth = inst.selectedMonth = date.getMonth();
          inst.drawYear = inst.selectedYear = date.getFullYear();
        }
  
        this._notifyChange(inst);
  
        this._adjustDate(target);
      },
  
      /* Action for selecting a new month/year. */
      _selectMonthYear: function _selectMonthYear(id, select, period) {
        var target = $(id),
            inst = this._getInst(target[0]);
  
        inst["selected" + (period === "M" ? "Month" : "Year")] = inst["draw" + (period === "M" ? "Month" : "Year")] = parseInt(select.options[select.selectedIndex].value, 10);
  
        this._notifyChange(inst);
  
        this._adjustDate(target);
      },
  
      /* Action for selecting a day. */
      _selectDay: function _selectDay(id, month, year, td) {
        var inst,
            target = $(id);
  
        if ($(td).hasClass(this._unselectableClass) || this._isDisabledDatepicker(target[0])) {
          return;
        }
  
        inst = this._getInst(target[0]);
        inst.selectedDay = inst.currentDay = $("a", td).html();
        inst.selectedMonth = inst.currentMonth = month;
        inst.selectedYear = inst.currentYear = year;
  
        this._selectDate(id, this._formatDate(inst, inst.currentDay, inst.currentMonth, inst.currentYear));
      },
  
      /* Erase the input field and hide the date picker. */
      _clearDate: function _clearDate(id) {
        var target = $(id);
  
        this._selectDate(target, "");
      },
  
      /* Update the input field with the selected date. */
      _selectDate: function _selectDate(id, dateStr) {
        var onSelect,
            target = $(id),
            inst = this._getInst(target[0]);
  
        dateStr = dateStr != null ? dateStr : this._formatDate(inst);
  
        if (inst.input) {
          inst.input.val(dateStr);
        }
  
        this._updateAlternate(inst);
  
        onSelect = this._get(inst, "onSelect");
  
        if (onSelect) {
          onSelect.apply(inst.input ? inst.input[0] : null, [dateStr, inst]); // trigger custom callback
        } else if (inst.input) {
          inst.input.trigger("change"); // fire the change event
        }
  
        if (inst.inline) {
          this._updateDatepicker(inst);
        } else {
          this._hideDatepicker();
  
          this._lastInput = inst.input[0];
  
          if (_typeof(inst.input[0]) !== "object") {
            inst.input.trigger("focus"); // restore focus
          }
  
          this._lastInput = null;
        }
      },
  
      /* Update any alternate field to synchronise with the main field. */
      _updateAlternate: function _updateAlternate(inst) {
        var altFormat,
            date,
            dateStr,
            altField = this._get(inst, "altField");
  
        if (altField) {
          // update alternate field too
          altFormat = this._get(inst, "altFormat") || this._get(inst, "dateFormat");
          date = this._getDate(inst);
          dateStr = this.formatDate(altFormat, date, this._getFormatConfig(inst));
          $(altField).val(dateStr);
        }
      },
  
      /* Set as beforeShowDay function to prevent selection of weekends.
       * @param  date  Date - the date to customise
       * @return [boolean, string] - is this date selectable?, what is its CSS class?
       */
      noWeekends: function noWeekends(date) {
        var day = date.getDay();
        return [day > 0 && day < 6, ""];
      },
  
      /* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.
       * @param  date  Date - the date to get the week for
       * @return  number - the number of the week within the year that contains this date
       */
      iso8601Week: function iso8601Week(date) {
        var time,
            checkDate = new Date(date.getTime()); // Find Thursday of this week starting on Monday
  
        checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));
        time = checkDate.getTime();
        checkDate.setMonth(0); // Compare with Jan 1
  
        checkDate.setDate(1);
        return Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;
      },
  
      /* Parse a string value into a date object.
       * See formatDate below for the possible formats.
       *
       * @param  format string - the expected format of the date
       * @param  value string - the date in the above format
       * @param  settings Object - attributes include:
       *					shortYearCutoff  number - the cutoff year for determining the century (optional)
       *					dayNamesShort	string[7] - abbreviated names of the days from Sunday (optional)
       *					dayNames		string[7] - names of the days from Sunday (optional)
       *					monthNamesShort string[12] - abbreviated names of the months (optional)
       *					monthNames		string[12] - names of the months (optional)
       * @return  Date - the extracted date value or null if value is blank
       */
      parseDate: function parseDate(format, value, settings) {
        if (format == null || value == null) {
          throw "Invalid arguments";
        }
  
        value = _typeof(value) === "object" ? value.toString() : value + "";
  
        if (value === "") {
          return null;
        }
  
        var iFormat,
            dim,
            extra,
            iValue = 0,
            shortYearCutoffTemp = (settings ? settings.shortYearCutoff : null) || this._defaults.shortYearCutoff,
            shortYearCutoff = typeof shortYearCutoffTemp !== "string" ? shortYearCutoffTemp : new Date().getFullYear() % 100 + parseInt(shortYearCutoffTemp, 10),
            dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,
            dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,
            monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,
            monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,
            year = -1,
            month = -1,
            day = -1,
            doy = -1,
            literal = false,
            date,
            // Check whether a format character is doubled
        lookAhead = function lookAhead(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
  
          if (matches) {
            iFormat++;
          }
  
          return matches;
        },
            // Extract a number from the string value
        getNumber = function getNumber(match) {
          var isDoubled = lookAhead(match),
              size = match === "@" ? 14 : match === "!" ? 20 : match === "y" && isDoubled ? 4 : match === "o" ? 3 : 2,
              minSize = match === "y" ? size : 1,
              digits = new RegExp("^\\d{" + minSize + "," + size + "}"),
              num = value.substring(iValue).match(digits);
  
          if (!num) {
            throw "Missing number at position " + iValue;
          }
  
          iValue += num[0].length;
          return parseInt(num[0], 10);
        },
            // Extract a name from the string value and convert to an index
        getName = function getName(match, shortNames, longNames) {
          var index = -1,
              names = $.map(lookAhead(match) ? longNames : shortNames, function (v, k) {
            return [[k, v]];
          }).sort(function (a, b) {
            return -(a[1].length - b[1].length);
          });
          $.each(names, function (i, pair) {
            var name = pair[1];
  
            if (value.substr(iValue, name.length).toLowerCase() === name.toLowerCase()) {
              index = pair[0];
              iValue += name.length;
              return false;
            }
          });
  
          if (index !== -1) {
            return index + 1;
          } else {
            throw "Unknown name at position " + iValue;
          }
        },
            // Confirm that a literal character matches the string value
        checkLiteral = function checkLiteral() {
          if (value.charAt(iValue) !== format.charAt(iFormat)) {
            throw "Unexpected literal at position " + iValue;
          }
  
          iValue++;
        };
  
        for (iFormat = 0; iFormat < format.length; iFormat++) {
          if (literal) {
            if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
              literal = false;
            } else {
              checkLiteral();
            }
          } else {
            switch (format.charAt(iFormat)) {
              case "d":
                day = getNumber("d");
                break;
  
              case "D":
                getName("D", dayNamesShort, dayNames);
                break;
  
              case "o":
                doy = getNumber("o");
                break;
  
              case "m":
                month = getNumber("m");
                break;
  
              case "M":
                month = getName("M", monthNamesShort, monthNames);
                break;
  
              case "y":
                year = getNumber("y");
                break;
  
              case "@":
                date = new Date(getNumber("@"));
                year = date.getFullYear();
                month = date.getMonth() + 1;
                day = date.getDate();
                break;
  
              case "!":
                date = new Date((getNumber("!") - this._ticksTo1970) / 10000);
                year = date.getFullYear();
                month = date.getMonth() + 1;
                day = date.getDate();
                break;
  
              case "'":
                if (lookAhead("'")) {
                  checkLiteral();
                } else {
                  literal = true;
                }
  
                break;
  
              default:
                checkLiteral();
            }
          }
        }
  
        if (iValue < value.length) {
          extra = value.substr(iValue);
  
          if (!/^\s+/.test(extra)) {
            throw "Extra/unparsed characters found in date: " + extra;
          }
        }
  
        if (year === -1) {
          year = new Date().getFullYear();
        } else if (year < 100) {
          year += new Date().getFullYear() - new Date().getFullYear() % 100 + (year <= shortYearCutoff ? 0 : -100);
        }
  
        if (doy > -1) {
          month = 1;
          day = doy;
  
          do {
            dim = this._getDaysInMonth(year, month - 1);
  
            if (day <= dim) {
              break;
            }
  
            month++;
            day -= dim;
          } while (true);
        }
  
        date = this._daylightSavingAdjust(new Date(year, month - 1, day));
  
        if (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) {
          throw "Invalid date"; // E.g. 31/02/00
        }
  
        return date;
      },
  
      /* Standard date formats. */
      ATOM: "yy-mm-dd",
      // RFC 3339 (ISO 8601)
      COOKIE: "D, dd M yy",
      ISO_8601: "yy-mm-dd",
      RFC_822: "D, d M y",
      RFC_850: "DD, dd-M-y",
      RFC_1036: "D, d M y",
      RFC_1123: "D, d M yy",
      RFC_2822: "D, d M yy",
      RSS: "D, d M y",
      // RFC 822
      TICKS: "!",
      TIMESTAMP: "@",
      W3C: "yy-mm-dd",
      // ISO 8601
      _ticksTo1970: ((1970 - 1) * 365 + Math.floor(1970 / 4) - Math.floor(1970 / 100) + Math.floor(1970 / 400)) * 24 * 60 * 60 * 10000000,
  
      /* Format a date object into a string value.
       * The format can be combinations of the following:
       * d  - day of month (no leading zero)
       * dd - day of month (two digit)
       * o  - day of year (no leading zeros)
       * oo - day of year (three digit)
       * D  - day name short
       * DD - day name long
       * m  - month of year (no leading zero)
       * mm - month of year (two digit)
       * M  - month name short
       * MM - month name long
       * y  - year (two digit)
       * yy - year (four digit)
       * @ - Unix timestamp (ms since 01/01/1970)
       * ! - Windows ticks (100ns since 01/01/0001)
       * "..." - literal text
       * '' - single quote
       *
       * @param  format string - the desired format of the date
       * @param  date Date - the date value to format
       * @param  settings Object - attributes include:
       *					dayNamesShort	string[7] - abbreviated names of the days from Sunday (optional)
       *					dayNames		string[7] - names of the days from Sunday (optional)
       *					monthNamesShort string[12] - abbreviated names of the months (optional)
       *					monthNames		string[12] - names of the months (optional)
       * @return  string - the date in the above format
       */
      formatDate: function formatDate(format, date, settings) {
        if (!date) {
          return "";
        }
  
        var iFormat,
            dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,
            dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,
            monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,
            monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,
            // Check whether a format character is doubled
        lookAhead = function lookAhead(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
  
          if (matches) {
            iFormat++;
          }
  
          return matches;
        },
            // Format a number, with leading zero if necessary
        formatNumber = function formatNumber(match, value, len) {
          var num = "" + value;
  
          if (lookAhead(match)) {
            while (num.length < len) {
              num = "0" + num;
            }
          }
  
          return num;
        },
            // Format a name, short or long as requested
        formatName = function formatName(match, value, shortNames, longNames) {
          return lookAhead(match) ? longNames[value] : shortNames[value];
        },
            output = "",
            literal = false;
  
        if (date) {
          for (iFormat = 0; iFormat < format.length; iFormat++) {
            if (literal) {
              if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
                literal = false;
              } else {
                output += format.charAt(iFormat);
              }
            } else {
              switch (format.charAt(iFormat)) {
                case "d":
                  output += formatNumber("d", date.getDate(), 2);
                  break;
  
                case "D":
                  output += formatName("D", date.getDay(), dayNamesShort, dayNames);
                  break;
  
                case "o":
                  output += formatNumber("o", Math.round((new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / 86400000), 3);
                  break;
  
                case "m":
                  output += formatNumber("m", date.getMonth() + 1, 2);
                  break;
  
                case "M":
                  output += formatName("M", date.getMonth(), monthNamesShort, monthNames);
                  break;
  
                case "y":
                  output += lookAhead("y") ? date.getFullYear() : (date.getFullYear() % 100 < 10 ? "0" : "") + date.getFullYear() % 100;
                  break;
  
                case "@":
                  output += date.getTime();
                  break;
  
                case "!":
                  output += date.getTime() * 10000 + this._ticksTo1970;
                  break;
  
                case "'":
                  if (lookAhead("'")) {
                    output += "'";
                  } else {
                    literal = true;
                  }
  
                  break;
  
                default:
                  output += format.charAt(iFormat);
              }
            }
          }
        }
  
        return output;
      },
  
      /* Extract all possible characters from the date format. */
      _possibleChars: function _possibleChars(format) {
        var iFormat,
            chars = "",
            literal = false,
            // Check whether a format character is doubled
        lookAhead = function lookAhead(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
  
          if (matches) {
            iFormat++;
          }
  
          return matches;
        };
  
        for (iFormat = 0; iFormat < format.length; iFormat++) {
          if (literal) {
            if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
              literal = false;
            } else {
              chars += format.charAt(iFormat);
            }
          } else {
            switch (format.charAt(iFormat)) {
              case "d":
              case "m":
              case "y":
              case "@":
                chars += "0123456789";
                break;
  
              case "D":
              case "M":
                return null;
              // Accept anything
  
              case "'":
                if (lookAhead("'")) {
                  chars += "'";
                } else {
                  literal = true;
                }
  
                break;
  
              default:
                chars += format.charAt(iFormat);
            }
          }
        }
  
        return chars;
      },
  
      /* Get a setting value, defaulting if necessary. */
      _get: function _get(inst, name) {
        return inst.settings[name] !== undefined ? inst.settings[name] : this._defaults[name];
      },
  
      /* Parse existing date and initialise date picker. */
      _setDateFromField: function _setDateFromField(inst, noDefault) {
        if (inst.input.val() === inst.lastVal) {
          return;
        }
  
        var dateFormat = this._get(inst, "dateFormat"),
            dates = inst.lastVal = inst.input ? inst.input.val() : null,
            defaultDate = this._getDefaultDate(inst),
            date = defaultDate,
            settings = this._getFormatConfig(inst);
  
        try {
          date = this.parseDate(dateFormat, dates, settings) || defaultDate;
        } catch (event) {
          dates = noDefault ? "" : dates;
        }
  
        inst.selectedDay = date.getDate();
        inst.drawMonth = inst.selectedMonth = date.getMonth();
        inst.drawYear = inst.selectedYear = date.getFullYear();
        inst.currentDay = dates ? date.getDate() : 0;
        inst.currentMonth = dates ? date.getMonth() : 0;
        inst.currentYear = dates ? date.getFullYear() : 0;
  
        this._adjustInstDate(inst);
      },
  
      /* Retrieve the default date shown on opening. */
      _getDefaultDate: function _getDefaultDate(inst) {
        return this._restrictMinMax(inst, this._determineDate(inst, this._get(inst, "defaultDate"), new Date()));
      },
  
      /* A date may be specified as an exact value or a relative one. */
      _determineDate: function _determineDate(inst, date, defaultDate) {
        var offsetNumeric = function offsetNumeric(offset) {
          var date = new Date();
          date.setDate(date.getDate() + offset);
          return date;
        },
            offsetString = function offsetString(offset) {
          try {
            return $.datepicker.parseDate($.datepicker._get(inst, "dateFormat"), offset, $.datepicker._getFormatConfig(inst));
          } catch (e) {// Ignore
          }
  
          var date = (offset.toLowerCase().match(/^c/) ? $.datepicker._getDate(inst) : null) || new Date(),
              year = date.getFullYear(),
              month = date.getMonth(),
              day = date.getDate(),
              pattern = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,
              matches = pattern.exec(offset);
  
          while (matches) {
            switch (matches[2] || "d") {
              case "d":
              case "D":
                day += parseInt(matches[1], 10);
                break;
  
              case "w":
              case "W":
                day += parseInt(matches[1], 10) * 7;
                break;
  
              case "m":
              case "M":
                month += parseInt(matches[1], 10);
                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
                break;
  
              case "y":
              case "Y":
                year += parseInt(matches[1], 10);
                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
                break;
            }
  
            matches = pattern.exec(offset);
          }
  
          return new Date(year, month, day);
        },
            newDate = date == null || date === "" ? defaultDate : typeof date === "string" ? offsetString(date) : typeof date === "number" ? isNaN(date) ? defaultDate : offsetNumeric(date) : new Date(date.getTime());
  
        newDate = newDate && newDate.toString() === "Invalid Date" ? defaultDate : newDate;
  
        if (newDate) {
          newDate.setHours(0);
          newDate.setMinutes(0);
          newDate.setSeconds(0);
          newDate.setMilliseconds(0);
        }
  
        return this._daylightSavingAdjust(newDate);
      },
  
      /* Handle switch to/from daylight saving.
       * Hours may be non-zero on daylight saving cut-over:
       * > 12 when midnight changeover, but then cannot generate
       * midnight datetime, so jump to 1AM, otherwise reset.
       * @param  date  (Date) the date to check
       * @return  (Date) the corrected date
       */
      _daylightSavingAdjust: function _daylightSavingAdjust(date) {
        if (!date) {
          return null;
        }
  
        date.setHours(date.getHours() > 12 ? date.getHours() + 2 : 0);
        return date;
      },
  
      /* Set the date(s) directly. */
      _setDate: function _setDate(inst, date, noChange) {
        var clear = !date,
            origMonth = inst.selectedMonth,
            origYear = inst.selectedYear,
            newDate = this._restrictMinMax(inst, this._determineDate(inst, date, new Date()));
  
        inst.selectedDay = inst.currentDay = newDate.getDate();
        inst.drawMonth = inst.selectedMonth = inst.currentMonth = newDate.getMonth();
        inst.drawYear = inst.selectedYear = inst.currentYear = newDate.getFullYear();
  
        if ((origMonth !== inst.selectedMonth || origYear !== inst.selectedYear) && !noChange) {
          this._notifyChange(inst);
        }
  
        this._adjustInstDate(inst);
  
        if (inst.input) {
          inst.input.val(clear ? "" : this._formatDate(inst));
        }
      },
  
      /* Retrieve the date(s) directly. */
      _getDate: function _getDate(inst) {
        var startDate = !inst.currentYear || inst.input && inst.input.val() === "" ? null : this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay));
        return startDate;
      },
  
      /* Attach the onxxx handlers.  These are declared statically so
       * they work with static code transformers like Caja.
       */
      _attachHandlers: function _attachHandlers(inst) {
        var stepMonths = this._get(inst, "stepMonths"),
            id = "#" + inst.id.replace(/\\\\/g, "\\");
  
        inst.dpDiv.find("[data-handler]").map(function () {
          var handler = {
            prev: function prev() {
              $.datepicker._adjustDate(id, -stepMonths, "M");
            },
            next: function next() {
              $.datepicker._adjustDate(id, +stepMonths, "M");
            },
            hide: function hide() {
              $.datepicker._hideDatepicker();
            },
            today: function today() {
              $.datepicker._gotoToday(id);
            },
            selectDay: function selectDay() {
              $.datepicker._selectDay(id, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this);
  
              return false;
            },
            selectMonth: function selectMonth() {
              $.datepicker._selectMonthYear(id, this, "M");
  
              return false;
            },
            selectYear: function selectYear() {
              $.datepicker._selectMonthYear(id, this, "Y");
  
              return false;
            }
          };
          $(this).on(this.getAttribute("data-event"), handler[this.getAttribute("data-handler")]);
        });
      },
  
      /* Generate the HTML for the current state of the date picker. */
      _generateHTML: function _generateHTML(inst) {
        var maxDraw,
            prevText,
            prev,
            nextText,
            next,
            currentText,
            gotoDate,
            controls,
            buttonPanel,
            firstDay,
            showWeek,
            dayNames,
            dayNamesMin,
            monthNames,
            monthNamesShort,
            beforeShowDay,
            showOtherMonths,
            selectOtherMonths,
            defaultDate,
            html,
            dow,
            row,
            group,
            col,
            selectedDate,
            cornerClass,
            calender,
            thead,
            day,
            daysInMonth,
            leadDays,
            curRows,
            numRows,
            printDate,
            dRow,
            tbody,
            daySettings,
            otherMonth,
            unselectable,
            tempDate = new Date(),
            today = this._daylightSavingAdjust(new Date(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate())),
            // clear time
        isRTL = this._get(inst, "isRTL"),
            showButtonPanel = this._get(inst, "showButtonPanel"),
            hideIfNoPrevNext = this._get(inst, "hideIfNoPrevNext"),
            navigationAsDateFormat = this._get(inst, "navigationAsDateFormat"),
            numMonths = this._getNumberOfMonths(inst),
            showCurrentAtPos = this._get(inst, "showCurrentAtPos"),
            stepMonths = this._get(inst, "stepMonths"),
            isMultiMonth = numMonths[0] !== 1 || numMonths[1] !== 1,
            currentDate = this._daylightSavingAdjust(!inst.currentDay ? new Date(9999, 9, 9) : new Date(inst.currentYear, inst.currentMonth, inst.currentDay)),
            minDate = this._getMinMaxDate(inst, "min"),
            maxDate = this._getMinMaxDate(inst, "max"),
            drawMonth = inst.drawMonth - showCurrentAtPos,
            drawYear = inst.drawYear;
  
        if (drawMonth < 0) {
          drawMonth += 12;
          drawYear--;
        }
  
        if (maxDate) {
          maxDraw = this._daylightSavingAdjust(new Date(maxDate.getFullYear(), maxDate.getMonth() - numMonths[0] * numMonths[1] + 1, maxDate.getDate()));
          maxDraw = minDate && maxDraw < minDate ? minDate : maxDraw;
  
          while (this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1)) > maxDraw) {
            drawMonth--;
  
            if (drawMonth < 0) {
              drawMonth = 11;
              drawYear--;
            }
          }
        }
  
        inst.drawMonth = drawMonth;
        inst.drawYear = drawYear;
        prevText = this._get(inst, "prevText");
        prevText = !navigationAsDateFormat ? prevText : this.formatDate(prevText, this._daylightSavingAdjust(new Date(drawYear, drawMonth - stepMonths, 1)), this._getFormatConfig(inst));
        prev = this._canAdjustMonth(inst, -1, drawYear, drawMonth) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'" + " title='" + prevText + "'><span class='ui-icon ui-icon-circle-triangle-" + (isRTL ? "e" : "w") + "'>" + prevText + "</span></a>" : hideIfNoPrevNext ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + prevText + "'><span class='ui-icon ui-icon-circle-triangle-" + (isRTL ? "e" : "w") + "'>" + prevText + "</span></a>";
        nextText = this._get(inst, "nextText");
        nextText = !navigationAsDateFormat ? nextText : this.formatDate(nextText, this._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)), this._getFormatConfig(inst));
        next = this._canAdjustMonth(inst, +1, drawYear, drawMonth) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'" + " title='" + nextText + "'><span class='ui-icon ui-icon-circle-triangle-" + (isRTL ? "w" : "e") + "'>" + nextText + "</span></a>" : hideIfNoPrevNext ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + nextText + "'><span class='ui-icon ui-icon-circle-triangle-" + (isRTL ? "w" : "e") + "'>" + nextText + "</span></a>";
        currentText = this._get(inst, "currentText");
        gotoDate = this._get(inst, "gotoCurrent") && inst.currentDay ? currentDate : today;
        currentText = !navigationAsDateFormat ? currentText : this.formatDate(currentText, gotoDate, this._getFormatConfig(inst));
        controls = !inst.inline ? "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(inst, "closeText") + "</button>" : "";
        buttonPanel = showButtonPanel ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (isRTL ? controls : "") + (this._isInRange(inst, gotoDate) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'" + ">" + currentText + "</button>" : "") + (isRTL ? "" : controls) + "</div>" : "";
        firstDay = parseInt(this._get(inst, "firstDay"), 10);
        firstDay = isNaN(firstDay) ? 0 : firstDay;
        showWeek = this._get(inst, "showWeek");
        dayNames = this._get(inst, "dayNames");
        dayNamesMin = this._get(inst, "dayNamesMin");
        monthNames = this._get(inst, "monthNames");
        monthNamesShort = this._get(inst, "monthNamesShort");
        beforeShowDay = this._get(inst, "beforeShowDay");
        showOtherMonths = this._get(inst, "showOtherMonths");
        selectOtherMonths = this._get(inst, "selectOtherMonths");
        defaultDate = this._getDefaultDate(inst);
        html = "";
  
        for (row = 0; row < numMonths[0]; row++) {
          group = "";
          this.maxRows = 4;
  
          for (col = 0; col < numMonths[1]; col++) {
            selectedDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, inst.selectedDay));
            cornerClass = " ui-corner-all";
            calender = "";
  
            if (isMultiMonth) {
              calender += "<div class='ui-datepicker-group";
  
              if (numMonths[1] > 1) {
                switch (col) {
                  case 0:
                    calender += " ui-datepicker-group-first";
                    cornerClass = " ui-corner-" + (isRTL ? "right" : "left");
                    break;
  
                  case numMonths[1] - 1:
                    calender += " ui-datepicker-group-last";
                    cornerClass = " ui-corner-" + (isRTL ? "left" : "right");
                    break;
  
                  default:
                    calender += " ui-datepicker-group-middle";
                    cornerClass = "";
                    break;
                }
              }
  
              calender += "'>";
            }
  
            calender += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + cornerClass + "'>" + (/all|left/.test(cornerClass) && row === 0 ? isRTL ? next : prev : "") + (/all|right/.test(cornerClass) && row === 0 ? isRTL ? prev : next : "") + this._generateMonthYearHeader(inst, drawMonth, drawYear, minDate, maxDate, row > 0 || col > 0, monthNames, monthNamesShort) + // draw month headers
            "</div><table class='ui-datepicker-calendar'><thead>" + "<tr>";
            thead = showWeek ? "<th class='ui-datepicker-week-col'>" + this._get(inst, "weekHeader") + "</th>" : "";
  
            for (dow = 0; dow < 7; dow++) {
              // days of the week
              day = (dow + firstDay) % 7;
              thead += "<th scope='col'" + ((dow + firstDay + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + ">" + "<span title='" + dayNames[day] + "'>" + dayNamesMin[day] + "</span></th>";
            }
  
            calender += thead + "</tr></thead><tbody>";
            daysInMonth = this._getDaysInMonth(drawYear, drawMonth);
  
            if (drawYear === inst.selectedYear && drawMonth === inst.selectedMonth) {
              inst.selectedDay = Math.min(inst.selectedDay, daysInMonth);
            }
  
            leadDays = (this._getFirstDayOfMonth(drawYear, drawMonth) - firstDay + 7) % 7;
            curRows = Math.ceil((leadDays + daysInMonth) / 7); // calculate the number of rows to generate
  
            numRows = isMultiMonth ? this.maxRows > curRows ? this.maxRows : curRows : curRows; //If multiple months, use the higher number of rows (see #7043)
  
            this.maxRows = numRows;
            printDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1 - leadDays));
  
            for (dRow = 0; dRow < numRows; dRow++) {
              // create date picker rows
              calender += "<tr>";
              tbody = !showWeek ? "" : "<td class='ui-datepicker-week-col'>" + this._get(inst, "calculateWeek")(printDate) + "</td>";
  
              for (dow = 0; dow < 7; dow++) {
                // create date picker days
                daySettings = beforeShowDay ? beforeShowDay.apply(inst.input ? inst.input[0] : null, [printDate]) : [true, ""];
                otherMonth = printDate.getMonth() !== drawMonth;
                unselectable = otherMonth && !selectOtherMonths || !daySettings[0] || minDate && printDate < minDate || maxDate && printDate > maxDate;
                tbody += "<td class='" + ((dow + firstDay + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + ( // highlight weekends
                otherMonth ? " ui-datepicker-other-month" : "") + ( // highlight days from other months
                printDate.getTime() === selectedDate.getTime() && drawMonth === inst.selectedMonth && inst._keyEvent || // user pressed key
                defaultDate.getTime() === printDate.getTime() && defaultDate.getTime() === selectedDate.getTime() ? // or defaultDate is current printedDate and defaultDate is selectedDate
                " " + this._dayOverClass : "") + ( // highlight selected day
                unselectable ? " " + this._unselectableClass + " ui-state-disabled" : "") + ( // highlight unselectable days
                otherMonth && !showOtherMonths ? "" : " " + daySettings[1] + ( // highlight custom dates
                printDate.getTime() === currentDate.getTime() ? " " + this._currentClass : "") + ( // highlight selected day
                printDate.getTime() === today.getTime() ? " ui-datepicker-today" : "")) + "'" + ( // highlight today (if different)
                (!otherMonth || showOtherMonths) && daySettings[2] ? " title='" + daySettings[2].replace(/'/g, "&#39;") + "'" : "") + ( // cell title
                unselectable ? "" : " data-handler='selectDay' data-event='click' data-month='" + printDate.getMonth() + "' data-year='" + printDate.getFullYear() + "'") + ">" + ( // actions
                otherMonth && !showOtherMonths ? "&#xa0;" : // display for other months
                unselectable ? "<span class='ui-state-default'>" + printDate.getDate() + "</span>" : "<a class='ui-state-default" + (printDate.getTime() === today.getTime() ? " ui-state-highlight" : "") + (printDate.getTime() === currentDate.getTime() ? " ui-state-active" : "") + ( // highlight selected day
                otherMonth ? " ui-priority-secondary" : "") + // distinguish dates from other months
                "' href='#'>" + printDate.getDate() + "</a>") + "</td>"; // display selectable date
  
                printDate.setDate(printDate.getDate() + 1);
                printDate = this._daylightSavingAdjust(printDate);
              }
  
              calender += tbody + "</tr>";
            }
  
            drawMonth++;
  
            if (drawMonth > 11) {
              drawMonth = 0;
              drawYear++;
            }
  
            calender += "</tbody></table>" + (isMultiMonth ? "</div>" + (numMonths[0] > 0 && col === numMonths[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : "");
            group += calender;
          }
  
          html += group;
        }
  
        html += buttonPanel;
        inst._keyEvent = false;
        return html;
      },
  
      /* Generate the month and year header. */
      _generateMonthYearHeader: function _generateMonthYearHeader(inst, drawMonth, drawYear, minDate, maxDate, secondary, monthNames, monthNamesShort) {
        var inMinYear,
            inMaxYear,
            month,
            years,
            thisYear,
            determineYear,
            year,
            endYear,
            changeMonth = this._get(inst, "changeMonth"),
            changeYear = this._get(inst, "changeYear"),
            showMonthAfterYear = this._get(inst, "showMonthAfterYear"),
            html = "<div class='ui-datepicker-title'>",
            monthHtml = ""; // Month selection
  
  
        if (secondary || !changeMonth) {
          monthHtml += "<span class='ui-datepicker-month'>" + monthNames[drawMonth] + "</span>";
        } else {
          inMinYear = minDate && minDate.getFullYear() === drawYear;
          inMaxYear = maxDate && maxDate.getFullYear() === drawYear;
          monthHtml += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";
  
          for (month = 0; month < 12; month++) {
            if ((!inMinYear || month >= minDate.getMonth()) && (!inMaxYear || month <= maxDate.getMonth())) {
              monthHtml += "<option value='" + month + "'" + (month === drawMonth ? " selected='selected'" : "") + ">" + monthNamesShort[month] + "</option>";
            }
          }
  
          monthHtml += "</select>";
        }
  
        if (!showMonthAfterYear) {
          html += monthHtml + (secondary || !(changeMonth && changeYear) ? "&#xa0;" : "");
        } // Year selection
  
  
        if (!inst.yearshtml) {
          inst.yearshtml = "";
  
          if (secondary || !changeYear) {
            html += "<span class='ui-datepicker-year'>" + drawYear + "</span>";
          } else {
            // determine range of years to display
            years = this._get(inst, "yearRange").split(":");
            thisYear = new Date().getFullYear();
  
            determineYear = function determineYear(value) {
              var year = value.match(/c[+\-].*/) ? drawYear + parseInt(value.substring(1), 10) : value.match(/[+\-].*/) ? thisYear + parseInt(value, 10) : parseInt(value, 10);
              return isNaN(year) ? thisYear : year;
            };
  
            year = determineYear(years[0]);
            endYear = Math.max(year, determineYear(years[1] || ""));
            year = minDate ? Math.max(year, minDate.getFullYear()) : year;
            endYear = maxDate ? Math.min(endYear, maxDate.getFullYear()) : endYear;
            inst.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";
  
            for (; year <= endYear; year++) {
              inst.yearshtml += "<option value='" + year + "'" + (year === drawYear ? " selected='selected'" : "") + ">" + year + "</option>";
            }
  
            inst.yearshtml += "</select>";
            html += inst.yearshtml;
            inst.yearshtml = null;
          }
        }
  
        html += this._get(inst, "yearSuffix");
  
        if (showMonthAfterYear) {
          html += (secondary || !(changeMonth && changeYear) ? "&#xa0;" : "") + monthHtml;
        }
  
        html += "</div>"; // Close datepicker_header
  
        return html;
      },
  
      /* Adjust one of the date sub-fields. */
      _adjustInstDate: function _adjustInstDate(inst, offset, period) {
        var year = inst.selectedYear + (period === "Y" ? offset : 0),
            month = inst.selectedMonth + (period === "M" ? offset : 0),
            day = Math.min(inst.selectedDay, this._getDaysInMonth(year, month)) + (period === "D" ? offset : 0),
            date = this._restrictMinMax(inst, this._daylightSavingAdjust(new Date(year, month, day)));
  
        inst.selectedDay = date.getDate();
        inst.drawMonth = inst.selectedMonth = date.getMonth();
        inst.drawYear = inst.selectedYear = date.getFullYear();
  
        if (period === "M" || period === "Y") {
          this._notifyChange(inst);
        }
      },
  
      /* Ensure a date is within any min/max bounds. */
      _restrictMinMax: function _restrictMinMax(inst, date) {
        var minDate = this._getMinMaxDate(inst, "min"),
            maxDate = this._getMinMaxDate(inst, "max"),
            newDate = minDate && date < minDate ? minDate : date;
  
        return maxDate && newDate > maxDate ? maxDate : newDate;
      },
  
      /* Notify change of month/year. */
      _notifyChange: function _notifyChange(inst) {
        var onChange = this._get(inst, "onChangeMonthYear");
  
        if (onChange) {
          onChange.apply(inst.input ? inst.input[0] : null, [inst.selectedYear, inst.selectedMonth + 1, inst]);
        }
      },
  
      /* Determine the number of months to show. */
      _getNumberOfMonths: function _getNumberOfMonths(inst) {
        var numMonths = this._get(inst, "numberOfMonths");
  
        return numMonths == null ? [1, 1] : typeof numMonths === "number" ? [1, numMonths] : numMonths;
      },
  
      /* Determine the current maximum date - ensure no time components are set. */
      _getMinMaxDate: function _getMinMaxDate(inst, minMax) {
        return this._determineDate(inst, this._get(inst, minMax + "Date"), null);
      },
  
      /* Find the number of days in a given month. */
      _getDaysInMonth: function _getDaysInMonth(year, month) {
        return 32 - this._daylightSavingAdjust(new Date(year, month, 32)).getDate();
      },
  
      /* Find the day of the week of the first of a month. */
      _getFirstDayOfMonth: function _getFirstDayOfMonth(year, month) {
        return new Date(year, month, 1).getDay();
      },
  
      /* Determines if we should allow a "next/prev" month display change. */
      _canAdjustMonth: function _canAdjustMonth(inst, offset, curYear, curMonth) {
        var numMonths = this._getNumberOfMonths(inst),
            date = this._daylightSavingAdjust(new Date(curYear, curMonth + (offset < 0 ? offset : numMonths[0] * numMonths[1]), 1));
  
        if (offset < 0) {
          date.setDate(this._getDaysInMonth(date.getFullYear(), date.getMonth()));
        }
  
        return this._isInRange(inst, date);
      },
  
      /* Is the given date in the accepted range? */
      _isInRange: function _isInRange(inst, date) {
        var yearSplit,
            currentYear,
            minDate = this._getMinMaxDate(inst, "min"),
            maxDate = this._getMinMaxDate(inst, "max"),
            minYear = null,
            maxYear = null,
            years = this._get(inst, "yearRange");
  
        if (years) {
          yearSplit = years.split(":");
          currentYear = new Date().getFullYear();
          minYear = parseInt(yearSplit[0], 10);
          maxYear = parseInt(yearSplit[1], 10);
  
          if (yearSplit[0].match(/[+\-].*/)) {
            minYear += currentYear;
          }
  
          if (yearSplit[1].match(/[+\-].*/)) {
            maxYear += currentYear;
          }
        }
  
        return (!minDate || date.getTime() >= minDate.getTime()) && (!maxDate || date.getTime() <= maxDate.getTime()) && (!minYear || date.getFullYear() >= minYear) && (!maxYear || date.getFullYear() <= maxYear);
      },
  
      /* Provide the configuration settings for formatting/parsing. */
      _getFormatConfig: function _getFormatConfig(inst) {
        var shortYearCutoff = this._get(inst, "shortYearCutoff");
  
        shortYearCutoff = typeof shortYearCutoff !== "string" ? shortYearCutoff : new Date().getFullYear() % 100 + parseInt(shortYearCutoff, 10);
        return {
          shortYearCutoff: shortYearCutoff,
          dayNamesShort: this._get(inst, "dayNamesShort"),
          dayNames: this._get(inst, "dayNames"),
          monthNamesShort: this._get(inst, "monthNamesShort"),
          monthNames: this._get(inst, "monthNames")
        };
      },
  
      /* Format the given date for display. */
      _formatDate: function _formatDate(inst, day, month, year) {
        if (!day) {
          inst.currentDay = inst.selectedDay;
          inst.currentMonth = inst.selectedMonth;
          inst.currentYear = inst.selectedYear;
        }
  
        var date = day ? _typeof(day) === "object" ? day : this._daylightSavingAdjust(new Date(year, month, day)) : this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay));
        return this.formatDate(this._get(inst, "dateFormat"), date, this._getFormatConfig(inst));
      }
    });
    /*
     * Bind hover events for datepicker elements.
     * Done via delegate so the binding only occurs once in the lifetime of the parent div.
     * Global datepicker_instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.
     */
  
    function datepicker_bindHover(dpDiv) {
      var selector = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
      return dpDiv.on("mouseout", selector, function () {
        $(this).removeClass("ui-state-hover");
  
        if (this.className.indexOf("ui-datepicker-prev") !== -1) {
          $(this).removeClass("ui-datepicker-prev-hover");
        }
  
        if (this.className.indexOf("ui-datepicker-next") !== -1) {
          $(this).removeClass("ui-datepicker-next-hover");
        }
      }).on("mouseover", selector, datepicker_handleMouseover);
    }
  
    function datepicker_handleMouseover() {
      if (!$.datepicker._isDisabledDatepicker(datepicker_instActive.inline ? datepicker_instActive.dpDiv.parent()[0] : datepicker_instActive.input[0])) {
        $(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");
        $(this).addClass("ui-state-hover");
  
        if (this.className.indexOf("ui-datepicker-prev") !== -1) {
          $(this).addClass("ui-datepicker-prev-hover");
        }
  
        if (this.className.indexOf("ui-datepicker-next") !== -1) {
          $(this).addClass("ui-datepicker-next-hover");
        }
      }
    }
    /* jQuery extend now ignores nulls! */
  
  
    function datepicker_extendRemove(target, props) {
      $.extend(target, props);
  
      for (var name in props) {
        if (props[name] == null) {
          target[name] = props[name];
        }
      }
  
      return target;
    }
    /* Invoke the datepicker functionality.
       @param  options  string - a command, optionally followed by additional parameters or
              Object - settings for attaching new datepicker functionality
       @return  jQuery object */
  
  
    $.fn.datepicker = function (options) {
      /* Verify an empty collection wasn't passed - Fixes #6976 */
      if (!this.length) {
        return this;
      }
      /* Initialise the date picker. */
  
  
      if (!$.datepicker.initialized) {
        $(document).on("mousedown", $.datepicker._checkExternalClick);
        $.datepicker.initialized = true;
      }
      /* Append datepicker main container to body if not exist. */
  
  
      if ($("#" + $.datepicker._mainDivId).length === 0) {
        $("body").append($.datepicker.dpDiv);
      }
  
      var otherArgs = Array.prototype.slice.call(arguments, 1);
  
      if (typeof options === "string" && (options === "isDisabled" || options === "getDate" || options === "widget")) {
        return $.datepicker["_" + options + "Datepicker"].apply($.datepicker, [this[0]].concat(otherArgs));
      }
  
      if (options === "option" && arguments.length === 2 && typeof arguments[1] === "string") {
        return $.datepicker["_" + options + "Datepicker"].apply($.datepicker, [this[0]].concat(otherArgs));
      }
  
      return this.each(function () {
        typeof options === "string" ? $.datepicker["_" + options + "Datepicker"].apply($.datepicker, [this].concat(otherArgs)) : $.datepicker._attachDatepicker(this, options);
      });
    };
  
    $.datepicker = new Datepicker(); // singleton instance
  
    $.datepicker.initialized = false;
    $.datepicker.uuid = new Date().getTime();
    $.datepicker.version = "1.12.1";
    var widgetsDatepicker = $.datepicker;
    /*!
     * jQuery UI Slider 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     */
    //>>label: Slider
    //>>group: Widgets
    //>>description: Displays a flexible slider with ranges and accessibility via keyboard.
    //>>docs: http://api.jqueryui.com/slider/
    //>>demos: http://jqueryui.com/slider/
    //>>css.structure: ../../themes/base/core.css
    //>>css.structure: ../../themes/base/slider.css
    //>>css.theme: ../../themes/base/theme.css
  
    var widgetsSlider = $.widget("ui.slider", $.ui.mouse, {
      version: "1.12.1",
      widgetEventPrefix: "slide",
      options: {
        animate: false,
        classes: {
          "ui-slider": "ui-corner-all",
          "ui-slider-handle": "ui-corner-all",
          // Note: ui-widget-header isn't the most fittingly semantic framework class for this
          // element, but worked best visually with a variety of themes
          "ui-slider-range": "ui-corner-all ui-widget-header"
        },
        distance: 0,
        max: 100,
        min: 0,
        orientation: "horizontal",
        range: false,
        step: 1,
        value: 0,
        values: null,
        // Callbacks
        change: null,
        slide: null,
        start: null,
        stop: null
      },
      // Number of pages in a slider
      // (how many times can you page up/down to go through the whole range)
      numPages: 5,
      _create: function _create() {
        this._keySliding = false;
        this._mouseSliding = false;
        this._animateOff = true;
        this._handleIndex = null;
  
        this._detectOrientation();
  
        this._mouseInit();
  
        this._calculateNewMax();
  
        this._addClass("ui-slider ui-slider-" + this.orientation, "ui-widget ui-widget-content");
  
        this._refresh();
  
        this._animateOff = false;
      },
      _refresh: function _refresh() {
        this._createRange();
  
        this._createHandles();
  
        this._setupEvents();
  
        this._refreshValue();
      },
      _createHandles: function _createHandles() {
        var i,
            handleCount,
            options = this.options,
            existingHandles = this.element.find(".ui-slider-handle"),
            handle = "<span tabindex='0'></span>",
            handles = [];
        handleCount = options.values && options.values.length || 1;
  
        if (existingHandles.length > handleCount) {
          existingHandles.slice(handleCount).remove();
          existingHandles = existingHandles.slice(0, handleCount);
        }
  
        for (i = existingHandles.length; i < handleCount; i++) {
          handles.push(handle);
        }
  
        this.handles = existingHandles.add($(handles.join("")).appendTo(this.element));
  
        this._addClass(this.handles, "ui-slider-handle", "ui-state-default");
  
        this.handle = this.handles.eq(0);
        this.handles.each(function (i) {
          $(this).data("ui-slider-handle-index", i).attr("tabIndex", 0);
        });
      },
      _createRange: function _createRange() {
        var options = this.options;
  
        if (options.range) {
          if (options.range === true) {
            if (!options.values) {
              options.values = [this._valueMin(), this._valueMin()];
            } else if (options.values.length && options.values.length !== 2) {
              options.values = [options.values[0], options.values[0]];
            } else if ($.isArray(options.values)) {
              options.values = options.values.slice(0);
            }
          }
  
          if (!this.range || !this.range.length) {
            this.range = $("<div>").appendTo(this.element);
  
            this._addClass(this.range, "ui-slider-range");
          } else {
            this._removeClass(this.range, "ui-slider-range-min ui-slider-range-max"); // Handle range switching from true to min/max
  
  
            this.range.css({
              "left": "",
              "bottom": ""
            });
          }
  
          if (options.range === "min" || options.range === "max") {
            this._addClass(this.range, "ui-slider-range-" + options.range);
          }
        } else {
          if (this.range) {
            this.range.remove();
          }
  
          this.range = null;
        }
      },
      _setupEvents: function _setupEvents() {
        this._off(this.handles);
  
        this._on(this.handles, this._handleEvents);
  
        this._hoverable(this.handles);
  
        this._focusable(this.handles);
      },
      _destroy: function _destroy() {
        this.handles.remove();
  
        if (this.range) {
          this.range.remove();
        }
  
        this._mouseDestroy();
      },
      _mouseCapture: function _mouseCapture(event) {
        var position,
            normValue,
            distance,
            closestHandle,
            index,
            allowed,
            offset,
            mouseOverHandle,
            that = this,
            o = this.options;
  
        if (o.disabled) {
          return false;
        }
  
        this.elementSize = {
          width: this.element.outerWidth(),
          height: this.element.outerHeight()
        };
        this.elementOffset = this.element.offset();
        position = {
          x: event.pageX,
          y: event.pageY
        };
        normValue = this._normValueFromMouse(position);
        distance = this._valueMax() - this._valueMin() + 1;
        this.handles.each(function (i) {
          var thisDistance = Math.abs(normValue - that.values(i));
  
          if (distance > thisDistance || distance === thisDistance && (i === that._lastChangedValue || that.values(i) === o.min)) {
            distance = thisDistance;
            closestHandle = $(this);
            index = i;
          }
        });
        allowed = this._start(event, index);
  
        if (allowed === false) {
          return false;
        }
  
        this._mouseSliding = true;
        this._handleIndex = index;
  
        this._addClass(closestHandle, null, "ui-state-active");
  
        closestHandle.trigger("focus");
        offset = closestHandle.offset();
        mouseOverHandle = !$(event.target).parents().addBack().is(".ui-slider-handle");
        this._clickOffset = mouseOverHandle ? {
          left: 0,
          top: 0
        } : {
          left: event.pageX - offset.left - closestHandle.width() / 2,
          top: event.pageY - offset.top - closestHandle.height() / 2 - (parseInt(closestHandle.css("borderTopWidth"), 10) || 0) - (parseInt(closestHandle.css("borderBottomWidth"), 10) || 0) + (parseInt(closestHandle.css("marginTop"), 10) || 0)
        };
  
        if (!this.handles.hasClass("ui-state-hover")) {
          this._slide(event, index, normValue);
        }
  
        this._animateOff = true;
        return true;
      },
      _mouseStart: function _mouseStart() {
        return true;
      },
      _mouseDrag: function _mouseDrag(event) {
        var position = {
          x: event.pageX,
          y: event.pageY
        },
            normValue = this._normValueFromMouse(position);
  
        this._slide(event, this._handleIndex, normValue);
  
        return false;
      },
      _mouseStop: function _mouseStop(event) {
        this._removeClass(this.handles, null, "ui-state-active");
  
        this._mouseSliding = false;
  
        this._stop(event, this._handleIndex);
  
        this._change(event, this._handleIndex);
  
        this._handleIndex = null;
        this._clickOffset = null;
        this._animateOff = false;
        return false;
      },
      _detectOrientation: function _detectOrientation() {
        this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal";
      },
      _normValueFromMouse: function _normValueFromMouse(position) {
        var pixelTotal, pixelMouse, percentMouse, valueTotal, valueMouse;
  
        if (this.orientation === "horizontal") {
          pixelTotal = this.elementSize.width;
          pixelMouse = position.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0);
        } else {
          pixelTotal = this.elementSize.height;
          pixelMouse = position.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0);
        }
  
        percentMouse = pixelMouse / pixelTotal;
  
        if (percentMouse > 1) {
          percentMouse = 1;
        }
  
        if (percentMouse < 0) {
          percentMouse = 0;
        }
  
        if (this.orientation === "vertical") {
          percentMouse = 1 - percentMouse;
        }
  
        valueTotal = this._valueMax() - this._valueMin();
        valueMouse = this._valueMin() + percentMouse * valueTotal;
        return this._trimAlignValue(valueMouse);
      },
      _uiHash: function _uiHash(index, value, values) {
        var uiHash = {
          handle: this.handles[index],
          handleIndex: index,
          value: value !== undefined ? value : this.value()
        };
  
        if (this._hasMultipleValues()) {
          uiHash.value = value !== undefined ? value : this.values(index);
          uiHash.values = values || this.values();
        }
  
        return uiHash;
      },
      _hasMultipleValues: function _hasMultipleValues() {
        return this.options.values && this.options.values.length;
      },
      _start: function _start(event, index) {
        return this._trigger("start", event, this._uiHash(index));
      },
      _slide: function _slide(event, index, newVal) {
        var allowed,
            otherVal,
            currentValue = this.value(),
            newValues = this.values();
  
        if (this._hasMultipleValues()) {
          otherVal = this.values(index ? 0 : 1);
          currentValue = this.values(index);
  
          if (this.options.values.length === 2 && this.options.range === true) {
            newVal = index === 0 ? Math.min(otherVal, newVal) : Math.max(otherVal, newVal);
          }
  
          newValues[index] = newVal;
        }
  
        if (newVal === currentValue) {
          return;
        }
  
        allowed = this._trigger("slide", event, this._uiHash(index, newVal, newValues)); // A slide can be canceled by returning false from the slide callback
  
        if (allowed === false) {
          return;
        }
  
        if (this._hasMultipleValues()) {
          this.values(index, newVal);
        } else {
          this.value(newVal);
        }
      },
      _stop: function _stop(event, index) {
        this._trigger("stop", event, this._uiHash(index));
      },
      _change: function _change(event, index) {
        if (!this._keySliding && !this._mouseSliding) {
          //store the last changed value index for reference when handles overlap
          this._lastChangedValue = index;
  
          this._trigger("change", event, this._uiHash(index));
        }
      },
      value: function value(newValue) {
        if (arguments.length) {
          this.options.value = this._trimAlignValue(newValue);
  
          this._refreshValue();
  
          this._change(null, 0);
  
          return;
        }
  
        return this._value();
      },
      values: function values(index, newValue) {
        var vals, newValues, i;
  
        if (arguments.length > 1) {
          this.options.values[index] = this._trimAlignValue(newValue);
  
          this._refreshValue();
  
          this._change(null, index);
  
          return;
        }
  
        if (arguments.length) {
          if ($.isArray(arguments[0])) {
            vals = this.options.values;
            newValues = arguments[0];
  
            for (i = 0; i < vals.length; i += 1) {
              vals[i] = this._trimAlignValue(newValues[i]);
  
              this._change(null, i);
            }
  
            this._refreshValue();
          } else {
            if (this._hasMultipleValues()) {
              return this._values(index);
            } else {
              return this.value();
            }
          }
        } else {
          return this._values();
        }
      },
      _setOption: function _setOption(key, value) {
        var i,
            valsLength = 0;
  
        if (key === "range" && this.options.range === true) {
          if (value === "min") {
            this.options.value = this._values(0);
            this.options.values = null;
          } else if (value === "max") {
            this.options.value = this._values(this.options.values.length - 1);
            this.options.values = null;
          }
        }
  
        if ($.isArray(this.options.values)) {
          valsLength = this.options.values.length;
        }
  
        this._super(key, value);
  
        switch (key) {
          case "orientation":
            this._detectOrientation();
  
            this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-" + this.orientation);
  
            this._refreshValue();
  
            if (this.options.range) {
              this._refreshRange(value);
            } // Reset positioning from previous orientation
  
  
            this.handles.css(value === "horizontal" ? "bottom" : "left", "");
            break;
  
          case "value":
            this._animateOff = true;
  
            this._refreshValue();
  
            this._change(null, 0);
  
            this._animateOff = false;
            break;
  
          case "values":
            this._animateOff = true;
  
            this._refreshValue(); // Start from the last handle to prevent unreachable handles (#9046)
  
  
            for (i = valsLength - 1; i >= 0; i--) {
              this._change(null, i);
            }
  
            this._animateOff = false;
            break;
  
          case "step":
          case "min":
          case "max":
            this._animateOff = true;
  
            this._calculateNewMax();
  
            this._refreshValue();
  
            this._animateOff = false;
            break;
  
          case "range":
            this._animateOff = true;
  
            this._refresh();
  
            this._animateOff = false;
            break;
        }
      },
      _setOptionDisabled: function _setOptionDisabled(value) {
        this._super(value);
  
        this._toggleClass(null, "ui-state-disabled", !!value);
      },
      //internal value getter
      // _value() returns value trimmed by min and max, aligned by step
      _value: function _value() {
        var val = this.options.value;
        val = this._trimAlignValue(val);
        return val;
      },
      //internal values getter
      // _values() returns array of values trimmed by min and max, aligned by step
      // _values( index ) returns single value trimmed by min and max, aligned by step
      _values: function _values(index) {
        var val, vals, i;
  
        if (arguments.length) {
          val = this.options.values[index];
          val = this._trimAlignValue(val);
          return val;
        } else if (this._hasMultipleValues()) {
          // .slice() creates a copy of the array
          // this copy gets trimmed by min and max and then returned
          vals = this.options.values.slice();
  
          for (i = 0; i < vals.length; i += 1) {
            vals[i] = this._trimAlignValue(vals[i]);
          }
  
          return vals;
        } else {
          return [];
        }
      },
      // Returns the step-aligned value that val is closest to, between (inclusive) min and max
      _trimAlignValue: function _trimAlignValue(val) {
        if (val <= this._valueMin()) {
          return this._valueMin();
        }
  
        if (val >= this._valueMax()) {
          return this._valueMax();
        }
  
        var step = this.options.step > 0 ? this.options.step : 1,
            valModStep = (val - this._valueMin()) % step,
            alignValue = val - valModStep;
  
        if (Math.abs(valModStep) * 2 >= step) {
          alignValue += valModStep > 0 ? step : -step;
        } // Since JavaScript has problems with large floats, round
        // the final value to 5 digits after the decimal point (see #4124)
  
  
        return parseFloat(alignValue.toFixed(5));
      },
      _calculateNewMax: function _calculateNewMax() {
        var max = this.options.max,
            min = this._valueMin(),
            step = this.options.step,
            aboveMin = Math.round((max - min) / step) * step;
  
        max = aboveMin + min;
  
        if (max > this.options.max) {
          //If max is not divisible by step, rounding off may increase its value
          max -= step;
        }
  
        this.max = parseFloat(max.toFixed(this._precision()));
      },
      _precision: function _precision() {
        var precision = this._precisionOf(this.options.step);
  
        if (this.options.min !== null) {
          precision = Math.max(precision, this._precisionOf(this.options.min));
        }
  
        return precision;
      },
      _precisionOf: function _precisionOf(num) {
        var str = num.toString(),
            decimal = str.indexOf(".");
        return decimal === -1 ? 0 : str.length - decimal - 1;
      },
      _valueMin: function _valueMin() {
        return this.options.min;
      },
      _valueMax: function _valueMax() {
        return this.max;
      },
      _refreshRange: function _refreshRange(orientation) {
        if (orientation === "vertical") {
          this.range.css({
            "width": "",
            "left": ""
          });
        }
  
        if (orientation === "horizontal") {
          this.range.css({
            "height": "",
            "bottom": ""
          });
        }
      },
      _refreshValue: function _refreshValue() {
        var lastValPercent,
            valPercent,
            value,
            valueMin,
            valueMax,
            oRange = this.options.range,
            o = this.options,
            that = this,
            animate = !this._animateOff ? o.animate : false,
            _set = {};
  
        if (this._hasMultipleValues()) {
          this.handles.each(function (i) {
            valPercent = (that.values(i) - that._valueMin()) / (that._valueMax() - that._valueMin()) * 100;
            _set[that.orientation === "horizontal" ? "left" : "bottom"] = valPercent + "%";
            $(this).stop(1, 1)[animate ? "animate" : "css"](_set, o.animate);
  
            if (that.options.range === true) {
              if (that.orientation === "horizontal") {
                if (i === 0) {
                  that.range.stop(1, 1)[animate ? "animate" : "css"]({
                    left: valPercent + "%"
                  }, o.animate);
                }
  
                if (i === 1) {
                  that.range[animate ? "animate" : "css"]({
                    width: valPercent - lastValPercent + "%"
                  }, {
                    queue: false,
                    duration: o.animate
                  });
                }
              } else {
                if (i === 0) {
                  that.range.stop(1, 1)[animate ? "animate" : "css"]({
                    bottom: valPercent + "%"
                  }, o.animate);
                }
  
                if (i === 1) {
                  that.range[animate ? "animate" : "css"]({
                    height: valPercent - lastValPercent + "%"
                  }, {
                    queue: false,
                    duration: o.animate
                  });
                }
              }
            }
  
            lastValPercent = valPercent;
          });
        } else {
          value = this.value();
          valueMin = this._valueMin();
          valueMax = this._valueMax();
          valPercent = valueMax !== valueMin ? (value - valueMin) / (valueMax - valueMin) * 100 : 0;
          _set[this.orientation === "horizontal" ? "left" : "bottom"] = valPercent + "%";
          this.handle.stop(1, 1)[animate ? "animate" : "css"](_set, o.animate);
  
          if (oRange === "min" && this.orientation === "horizontal") {
            this.range.stop(1, 1)[animate ? "animate" : "css"]({
              width: valPercent + "%"
            }, o.animate);
          }
  
          if (oRange === "max" && this.orientation === "horizontal") {
            this.range.stop(1, 1)[animate ? "animate" : "css"]({
              width: 100 - valPercent + "%"
            }, o.animate);
          }
  
          if (oRange === "min" && this.orientation === "vertical") {
            this.range.stop(1, 1)[animate ? "animate" : "css"]({
              height: valPercent + "%"
            }, o.animate);
          }
  
          if (oRange === "max" && this.orientation === "vertical") {
            this.range.stop(1, 1)[animate ? "animate" : "css"]({
              height: 100 - valPercent + "%"
            }, o.animate);
          }
        }
      },
      _handleEvents: {
        keydown: function keydown(event) {
          var allowed,
              curVal,
              newVal,
              step,
              index = $(event.target).data("ui-slider-handle-index");
  
          switch (event.keyCode) {
            case $.ui.keyCode.HOME:
            case $.ui.keyCode.END:
            case $.ui.keyCode.PAGE_UP:
            case $.ui.keyCode.PAGE_DOWN:
            case $.ui.keyCode.UP:
            case $.ui.keyCode.RIGHT:
            case $.ui.keyCode.DOWN:
            case $.ui.keyCode.LEFT:
              event.preventDefault();
  
              if (!this._keySliding) {
                this._keySliding = true;
  
                this._addClass($(event.target), null, "ui-state-active");
  
                allowed = this._start(event, index);
  
                if (allowed === false) {
                  return;
                }
              }
  
              break;
          }
  
          step = this.options.step;
  
          if (this._hasMultipleValues()) {
            curVal = newVal = this.values(index);
          } else {
            curVal = newVal = this.value();
          }
  
          switch (event.keyCode) {
            case $.ui.keyCode.HOME:
              newVal = this._valueMin();
              break;
  
            case $.ui.keyCode.END:
              newVal = this._valueMax();
              break;
  
            case $.ui.keyCode.PAGE_UP:
              newVal = this._trimAlignValue(curVal + (this._valueMax() - this._valueMin()) / this.numPages);
              break;
  
            case $.ui.keyCode.PAGE_DOWN:
              newVal = this._trimAlignValue(curVal - (this._valueMax() - this._valueMin()) / this.numPages);
              break;
  
            case $.ui.keyCode.UP:
            case $.ui.keyCode.RIGHT:
              if (curVal === this._valueMax()) {
                return;
              }
  
              newVal = this._trimAlignValue(curVal + step);
              break;
  
            case $.ui.keyCode.DOWN:
            case $.ui.keyCode.LEFT:
              if (curVal === this._valueMin()) {
                return;
              }
  
              newVal = this._trimAlignValue(curVal - step);
              break;
          }
  
          this._slide(event, index, newVal);
        },
        keyup: function keyup(event) {
          var index = $(event.target).data("ui-slider-handle-index");
  
          if (this._keySliding) {
            this._keySliding = false;
  
            this._stop(event, index);
  
            this._change(event, index);
  
            this._removeClass($(event.target), null, "ui-state-active");
          }
        }
      }
    });
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/jquery-ui/jquery.ui.touch-punch.min.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/jquery-ui/jquery.ui.touch-punch.min.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /*!
   * jQuery UI Touch Punch 0.2.3
   *
   * Copyright 20112014, Dave Furfero
   * Dual licensed under the MIT or GPL Version 2 licenses.
   *
   * Depends:
   *  jquery.ui.widget.js
   *  jquery.ui.mouse.js
   */
  !function (a) {
    function f(a, b) {
      if (!(a.originalEvent.touches.length > 1)) {
        a.preventDefault();
        var c = a.originalEvent.changedTouches[0],
            d = document.createEvent("MouseEvents");
        d.initMouseEvent(b, !0, !0, window, 1, c.screenX, c.screenY, c.clientX, c.clientY, !1, !1, !1, !1, 0, null), a.target.dispatchEvent(d);
      }
    }
  
    if (a.support.touch = "ontouchend" in document, a.support.touch) {
      var e,
          b = a.ui.mouse.prototype,
          c = b._mouseInit,
          d = b._mouseDestroy;
      b._touchStart = function (a) {
        var b = this;
        !e && b._mouseCapture(a.originalEvent.changedTouches[0]) && (e = !0, b._touchMoved = !1, f(a, "mouseover"), f(a, "mousemove"), f(a, "mousedown"));
      }, b._touchMove = function (a) {
        e && (this._touchMoved = !0, f(a, "mousemove"));
      }, b._touchEnd = function (a) {
        e && (f(a, "mouseup"), f(a, "mouseout"), this._touchMoved || f(a, "click"), e = !1);
      }, b._mouseInit = function () {
        var b = this;
        b.element.bind({
          touchstart: a.proxy(b, "_touchStart"),
          touchmove: a.proxy(b, "_touchMove"),
          touchend: a.proxy(b, "_touchEnd")
        }), c.call(b);
      }, b._mouseDestroy = function () {
        var b = this;
        b.element.unbind({
          touchstart: a.proxy(b, "_touchStart"),
          touchmove: a.proxy(b, "_touchMove"),
          touchend: a.proxy(b, "_touchEnd")
        }), d.call(b);
      };
    }
  }(jQuery);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/jquery/jquery-migrate.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/jquery/jquery-migrate.js ***!
    \**************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /*! jQuery Migrate v3.0.0 | (c) jQuery Foundation and other contributors | jquery.org/license */
  "undefined" == typeof jQuery.migrateMute && (jQuery.migrateMute = !0), function (a, b) {
    "use strict";
  
    function c(c) {
      var d = b.console;
      e[c] || (e[c] = !0, a.migrateWarnings.push(c), d && d.warn && !a.migrateMute && (d.warn("JQMIGRATE: " + c), a.migrateTrace && d.trace && d.trace()));
    }
  
    function d(a, b, d, e) {
      Object.defineProperty(a, b, {
        configurable: !0,
        enumerable: !0,
        get: function get() {
          return c(e), d;
        }
      });
    }
  
    a.migrateVersion = "3.0.0", function () {
      var c = b.console && b.console.log && function () {
        b.console.log.apply(b.console, arguments);
      },
          d = /^[12]\./;
  
      c && (a && !d.test(a.fn.jquery) || c("JQMIGRATE: jQuery 3.0.0+ REQUIRED"), a.migrateWarnings && c("JQMIGRATE: Migrate plugin loaded multiple times"), c("JQMIGRATE: Migrate is installed" + (a.migrateMute ? "" : " with logging active") + ", version " + a.migrateVersion));
    }();
    var e = {};
    a.migrateWarnings = [], void 0 === a.migrateTrace && (a.migrateTrace = !0), a.migrateReset = function () {
      e = {}, a.migrateWarnings.length = 0;
    }, "BackCompat" === document.compatMode && c("jQuery is not compatible with Quirks Mode");
    var f = a.fn.init,
        g = a.isNumeric,
        h = a.find,
        i = /\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,
        j = /\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g;
    a.fn.init = function (a) {
      var b = Array.prototype.slice.call(arguments);
      return "string" == typeof a && "#" === a && (c("jQuery( '#' ) is not a valid selector"), b[0] = []), f.apply(this, b);
    }, a.fn.init.prototype = a.fn, a.find = function (a) {
      var b = Array.prototype.slice.call(arguments);
      if ("string" == typeof a && i.test(a)) try {
        document.querySelector(a);
      } catch (d) {
        a = a.replace(j, function (a, b, c, d) {
          return "[" + b + c + '"' + d + '"]';
        });
  
        try {
          document.querySelector(a), c("Attribute selector with '#' must be quoted: " + b[0]), b[0] = a;
        } catch (e) {
          c("Attribute selector with '#' was not fixed: " + b[0]);
        }
      }
      return h.apply(this, b);
    };
    var k;
  
    for (k in h) {
      Object.prototype.hasOwnProperty.call(h, k) && (a.find[k] = h[k]);
    }
  
    a.fn.size = function () {
      return c("jQuery.fn.size() is deprecated; use the .length property"), this.length;
    }, a.parseJSON = function () {
      return c("jQuery.parseJSON is deprecated; use JSON.parse"), JSON.parse.apply(null, arguments);
    }, a.isNumeric = function (b) {
      function d(b) {
        var c = b && b.toString();
        return !a.isArray(b) && c - parseFloat(c) + 1 >= 0;
      }
  
      var e = g(b),
          f = d(b);
      return e !== f && c("jQuery.isNumeric() should not be called on constructed objects"), f;
    }, d(a, "unique", a.uniqueSort, "jQuery.unique is deprecated, use jQuery.uniqueSort"), d(a.expr, "filters", a.expr.pseudos, "jQuery.expr.filters is now jQuery.expr.pseudos"), d(a.expr, ":", a.expr.pseudos, 'jQuery.expr[":"] is now jQuery.expr.pseudos');
    var l = a.ajax;
  
    a.ajax = function () {
      var a = l.apply(this, arguments);
      return a.promise && (d(a, "success", a.done, "jQXHR.success is deprecated and removed"), d(a, "error", a.fail, "jQXHR.error is deprecated and removed"), d(a, "complete", a.always, "jQXHR.complete is deprecated and removed")), a;
    };
  
    var m = a.fn.removeAttr,
        n = a.fn.toggleClass,
        o = /\S+/g;
    a.fn.removeAttr = function (b) {
      var d = this;
      return a.each(b.match(o), function (b, e) {
        a.expr.match.bool.test(e) && (c("jQuery.fn.removeAttr no longer sets boolean properties: " + e), d.prop(e, !1));
      }), m.apply(this, arguments);
    }, a.fn.toggleClass = function (b) {
      return void 0 !== b && "boolean" != typeof b ? n.apply(this, arguments) : (c("jQuery.fn.toggleClass( boolean ) is deprecated"), this.each(function () {
        var c = this.getAttribute && this.getAttribute("class") || "";
        c && a.data(this, "__className__", c), this.setAttribute && this.setAttribute("class", c || b === !1 ? "" : a.data(this, "__className__") || "");
      }));
    };
    var p = !1;
    a.swap && a.each(["height", "width", "reliableMarginRight"], function (b, c) {
      var d = a.cssHooks[c] && a.cssHooks[c].get;
      d && (a.cssHooks[c].get = function () {
        var a;
        return p = !0, a = d.apply(this, arguments), p = !1, a;
      });
    }), a.swap = function (a, b, d, e) {
      var f,
          g,
          h = {};
      p || c("jQuery.swap() is undocumented and deprecated");
  
      for (g in b) {
        h[g] = a.style[g], a.style[g] = b[g];
      }
  
      f = d.apply(a, e || []);
  
      for (g in b) {
        a.style[g] = h[g];
      }
  
      return f;
    };
    var q = a.data;
  
    a.data = function (b, d, e) {
      var f;
      return d && d !== a.camelCase(d) && (f = a.hasData(b) && q.call(this, b), f && d in f) ? (c("jQuery.data() always sets/gets camelCased names: " + d), arguments.length > 2 && (f[d] = e), f[d]) : q.apply(this, arguments);
    };
  
    var r = a.Tween.prototype.run;
  
    a.Tween.prototype.run = function (b) {
      a.easing[this.easing].length > 1 && (c('easing function "jQuery.easing.' + this.easing.toString() + '" should use only first argument'), a.easing[this.easing] = a.easing[this.easing].bind(a.easing, b, this.options.duration * b, 0, 1, this.options.duration)), r.apply(this, arguments);
    };
  
    var s = a.fn.load,
        t = a.event.fix;
    a.event.props = [], a.event.fixHooks = {}, a.event.fix = function (b) {
      var d,
          e = b.type,
          f = this.fixHooks[e],
          g = a.event.props;
      if (g.length) for (c("jQuery.event.props are deprecated and removed: " + g.join()); g.length;) {
        a.event.addProp(g.pop());
      }
      if (f && !f._migrated_ && (f._migrated_ = !0, c("jQuery.event.fixHooks are deprecated and removed: " + e), (g = f.props) && g.length)) for (; g.length;) {
        a.event.addProp(g.pop());
      }
      return d = t.call(this, b), f && f.filter ? f.filter(d, b) : d;
    }, a.each(["load", "unload", "error"], function (b, d) {
      a.fn[d] = function () {
        var a = Array.prototype.slice.call(arguments, 0);
        return "load" === d && "string" == typeof a[0] ? s.apply(this, a) : (c("jQuery.fn." + d + "() is deprecated"), a.splice(0, 0, d), arguments.length ? this.on.apply(this, a) : (this.triggerHandler.apply(this, a), this));
      };
    }), a(function () {
      a(document).triggerHandler("ready");
    }), a.event.special.ready = {
      setup: function setup() {
        this === document && c("'ready' event is deprecated");
      }
    }, a.fn.extend({
      bind: function bind(a, b, d) {
        return c("jQuery.fn.bind() is deprecated"), this.on(a, null, b, d);
      },
      unbind: function unbind(a, b) {
        return c("jQuery.fn.unbind() is deprecated"), this.off(a, null, b);
      },
      delegate: function delegate(a, b, d, e) {
        return c("jQuery.fn.delegate() is deprecated"), this.on(b, a, d, e);
      },
      undelegate: function undelegate(a, b, d) {
        return c("jQuery.fn.undelegate() is deprecated"), 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", d);
      }
    });
    var u = a.fn.offset;
  
    a.fn.offset = function () {
      var b,
          d = this[0],
          e = {
        top: 0,
        left: 0
      };
      return d && d.nodeType ? (b = (d.ownerDocument || document).documentElement, a.contains(b, d) ? u.apply(this, arguments) : (c("jQuery.fn.offset() requires an element connected to a document"), e)) : (c("jQuery.fn.offset() requires a valid DOM element"), e);
    };
  
    var v = a.param;
  
    a.param = function (b, d) {
      var e = a.ajaxSettings && a.ajaxSettings.traditional;
      return void 0 === d && e && (c("jQuery.param() no longer uses jQuery.ajaxSettings.traditional"), d = e), v.call(this, b, d);
    };
  
    var w = a.fn.andSelf || a.fn.addBack;
  
    a.fn.andSelf = function () {
      return c("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"), w.apply(this, arguments);
    };
  
    var x = a.Deferred,
        y = [["resolve", "done", a.Callbacks("once memory"), a.Callbacks("once memory"), "resolved"], ["reject", "fail", a.Callbacks("once memory"), a.Callbacks("once memory"), "rejected"], ["notify", "progress", a.Callbacks("memory"), a.Callbacks("memory")]];
  
    a.Deferred = function (b) {
      var d = x(),
          e = d.promise();
      return d.pipe = e.pipe = function () {
        var b = arguments;
        return c("deferred.pipe() is deprecated"), a.Deferred(function (c) {
          a.each(y, function (f, g) {
            var h = a.isFunction(b[f]) && b[f];
            d[g[1]](function () {
              var b = h && h.apply(this, arguments);
              b && a.isFunction(b.promise) ? b.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[g[0] + "With"](this === e ? c.promise() : this, h ? [b] : arguments);
            });
          }), b = null;
        }).promise();
      }, b && b.call(d, d), d;
    };
  }(jQuery, window);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/lazyload/js/jquery.lazyload.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/lazyload/js/jquery.lazyload.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /*!
   * Lazy Load - jQuery plugin for lazy loading images
   *
   * Copyright (c) 2007-2015 Mika Tuupola
   *
   * Licensed under the MIT license:
   *   http://www.opensource.org/licenses/mit-license.php
   *
   * Project home:
   *   http://www.appelsiini.net/projects/lazyload
   *
   * Version:  1.9.7
   *
   */
  (function ($, window, document, undefined) {
    var $window = $(window);
  
    $.fn.lazyload = function (options) {
      var elements = this;
      var $container;
      var settings = {
        threshold: 0,
        failure_limit: 0,
        event: "scroll",
        effect: "show",
        container: window,
        data_attribute: "original",
        skip_invisible: false,
        appear: null,
        load: null,
        placeholder: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"
      };
  
      function update() {
        var counter = 0;
        elements.each(function () {
          var $this = $(this);
  
          if (settings.skip_invisible && !$this.is(":visible")) {
            return;
          }
  
          if ($.abovethetop(this, settings) || $.leftofbegin(this, settings)) {
            /* Nothing. */
          } else if (!$.belowthefold(this, settings) && !$.rightoffold(this, settings)) {
            $this.trigger("appear");
            /* if we found an image we'll load, reset the counter */
  
            counter = 0;
          } else {
            if (++counter > settings.failure_limit) {
              return false;
            }
          }
        });
      }
  
      if (options) {
        /* Maintain BC for a couple of versions. */
        if (undefined !== options.failurelimit) {
          options.failure_limit = options.failurelimit;
          delete options.failurelimit;
        }
  
        if (undefined !== options.effectspeed) {
          options.effect_speed = options.effectspeed;
          delete options.effectspeed;
        }
  
        $.extend(settings, options);
      }
      /* Cache container as jQuery as object. */
  
  
      $container = settings.container === undefined || settings.container === window ? $window : $(settings.container);
      /* Fire one scroll event per scroll. Not one scroll event per image. */
  
      if (0 === settings.event.indexOf("scroll")) {
        $container.bind(settings.event, function () {
          return update();
        });
      }
  
      this.each(function () {
        var self = this;
        var $self = $(self);
        self.loaded = false;
        /* If no src attribute given use data:uri. */
  
        if ($self.attr("src") === undefined || $self.attr("src") === false) {
          if ($self.is("img")) {
            $self.attr("src", settings.placeholder);
          }
        }
        /* When appear is triggered load original image. */
  
  
        $self.one("appear", function () {
          if (!this.loaded) {
            if (settings.appear) {
              var elements_left = elements.length;
              settings.appear.call(self, elements_left, settings);
            }
  
            $("<img />").bind("load", function () {
              var original = $self.attr("data-" + settings.data_attribute);
              $self.hide();
  
              if ($self.is("img")) {
                $self.attr("src", original);
              } else {
                $self.css("background-image", "url('" + original + "')");
              }
  
              $self[settings.effect](settings.effect_speed);
              self.loaded = true;
              /* Remove image from array so it is not looped next time. */
  
              var temp = $.grep(elements, function (element) {
                return !element.loaded;
              });
              elements = $(temp);
  
              if (settings.load) {
                var elements_left = elements.length;
                settings.load.call(self, elements_left, settings);
              }
            }).attr("src", $self.attr("data-" + settings.data_attribute));
          }
        });
        /* When wanted event is triggered load original image */
  
        /* by triggering appear.                              */
  
        if (0 !== settings.event.indexOf("scroll")) {
          $self.bind(settings.event, function () {
            if (!self.loaded) {
              $self.trigger("appear");
            }
          });
        }
      });
      /* Check if something appears when window is resized. */
  
      $window.bind("resize", function () {
        update();
      });
      /* With IOS5 force loading images when navigating with back button. */
  
      /* Non optimal workaround. */
  
      if (/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)) {
        $window.bind("pageshow", function (event) {
          if (event.originalEvent && event.originalEvent.persisted) {
            elements.each(function () {
              $(this).trigger("appear");
            });
          }
        });
      }
      /* Force initial check if images should appear. */
  
  
      $(document).ready(function () {
        update();
      });
      return this;
    };
    /* Convenience methods in jQuery namespace.           */
  
    /* Use as  $.belowthefold(element, {threshold : 100, container : window}) */
  
  
    $.belowthefold = function (element, settings) {
      var fold;
  
      if (settings.container === undefined || settings.container === window) {
        fold = (window.innerHeight ? window.innerHeight : $window.height()) + $window.scrollTop();
      } else {
        fold = $(settings.container).offset().top + $(settings.container).height();
      }
  
      return fold <= $(element).offset().top - settings.threshold;
    };
  
    $.rightoffold = function (element, settings) {
      var fold;
  
      if (settings.container === undefined || settings.container === window) {
        fold = $window.width() + $window.scrollLeft();
      } else {
        fold = $(settings.container).offset().left + $(settings.container).width();
      }
  
      return fold <= $(element).offset().left - settings.threshold;
    };
  
    $.abovethetop = function (element, settings) {
      var fold;
  
      if (settings.container === undefined || settings.container === window) {
        fold = $window.scrollTop();
      } else {
        fold = $(settings.container).offset().top;
      }
  
      return fold >= $(element).offset().top + settings.threshold + $(element).height();
    };
  
    $.leftofbegin = function (element, settings) {
      var fold;
  
      if (settings.container === undefined || settings.container === window) {
        fold = $window.scrollLeft();
      } else {
        fold = $(settings.container).offset().left;
      }
  
      return fold >= $(element).offset().left + settings.threshold + $(element).width();
    };
  
    $.inviewport = function (element, settings) {
      return !$.rightoffold(element, settings) && !$.leftofbegin(element, settings) && !$.belowthefold(element, settings) && !$.abovethetop(element, settings);
    };
    /* Custom selectors for your convenience.   */
  
    /* Use as $("img:below-the-fold").something() or */
  
    /* $("img").filter(":below-the-fold").something() which is faster */
  
  
    $.extend($.expr[":"], {
      "below-the-fold": function belowTheFold(a) {
        return $.belowthefold(a, {
          threshold: 0
        });
      },
      "above-the-top": function aboveTheTop(a) {
        return !$.belowthefold(a, {
          threshold: 0
        });
      },
      "right-of-screen": function rightOfScreen(a) {
        return $.rightoffold(a, {
          threshold: 0
        });
      },
      "left-of-screen": function leftOfScreen(a) {
        return !$.rightoffold(a, {
          threshold: 0
        });
      },
      "in-viewport": function inViewport(a) {
        return $.inviewport(a, {
          threshold: 0
        });
      },
  
      /* Maintain BC for couple of versions. */
      "above-the-fold": function aboveTheFold(a) {
        return !$.belowthefold(a, {
          threshold: 0
        });
      },
      "right-of-fold": function rightOfFold(a) {
        return $.rightoffold(a, {
          threshold: 0
        });
      },
      "left-of-fold": function leftOfFold(a) {
        return !$.rightoffold(a, {
          threshold: 0
        });
      }
    });
  })(jQuery, window, document);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/events.js":
  /*!*********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/events.js ***!
    \*********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //const circle = require('./literatum.js');
  literatum.events = function () {
    var instance = {};
    var listenersMap = {};
  
    instance.register = function (eventName, callback) {
      var listeners = listenersMap[eventName];
  
      if (!listeners) {
        listenersMap[eventName] = listeners = [];
      }
  
      listeners.push(callback);
    };
  
    instance.deregisterAll = function () {
      listenersMap = {};
    };
  
    instance.notify = function (eventName, data) {
      //console.log("Event '" + eventName + "' triggered.")
      var listeners = listenersMap[eventName];
  
      if (listeners) {
        listeners.forEach(function (listener) {
          listener(data);
        });
      }
    };
  
    return instance;
  }();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/imports.js":
  /*!**********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/imports.js ***!
    \**********************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _literatum__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./literatum */ "../../ui-core/plugins/literatum/literatum.js");
  /* harmony import */ var _literatum__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_literatum__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _widget__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./widget */ "../../ui-core/plugins/literatum/widget.js");
  /* harmony import */ var _widget__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_widget__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _widgets__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./widgets */ "../../ui-core/plugins/literatum/widgets.js");
  /* harmony import */ var _widgets__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_widgets__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./events */ "../../ui-core/plugins/literatum/events.js");
  /* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_events__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _loading_loading_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./loading/loading.js */ "../../ui-core/plugins/literatum/loading/loading.js");
  /* harmony import */ var _loading_loading_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_loading_loading_js__WEBPACK_IMPORTED_MODULE_4__);
  /* harmony import */ var _loading_fullPageLoading_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./loading/fullPageLoading.js */ "../../ui-core/plugins/literatum/loading/fullPageLoading.js");
  /* harmony import */ var _loading_fullPageLoading_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_loading_fullPageLoading_js__WEBPACK_IMPORTED_MODULE_5__);
  
  
  
  
  
  
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/literatum.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/literatum.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  window.literatum = {};
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/loading/fullPageLoading.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/loading/fullPageLoading.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //const circle = require('../literatum.js');
  literatum.FullPageLoading = function () {
    this.message = '';
  };
  
  literatum.FullPageLoading.prototype = new literatum.Loading();
  
  literatum.FullPageLoading.prototype.start = function () {
    $("body").append('<div class="loading-overlay"><div class="loading-container"><div class="loading"></div><div class="loading-message">' + this.message + '</div></div></div></div>');
    $(".loading-overlay").fadeIn(200);
    return this;
  };
  
  literatum.FullPageLoading.prototype.done = function () {
    var $overlay = $(".loading-overlay");
    $overlay.fadeOut(200);
    $overlay.remove();
  };
  
  literatum.FullPageLoading.prototype.setMessage = function (message) {
    this.message = message;
  };
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/loading/loading.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/loading/loading.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //const circle = require('../literatum.js');
  literatum.Loading = function (deferred) {
    this.start();
    this.deferred = deferred;
    $.when(deferred).then(this.done);
  };
  
  literatum.Loading.prototype.start = function () {};
  
  literatum.Loading.prototype.done = function () {};
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/widget.js":
  /*!*********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/widget.js ***!
    \*********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //const circle = require('./literatum.js');
  literatum.Widget = function (widgetDef, element) {
    this.state = -1;
    this.$element = $(element);
    this.widgetDef = widgetDef;
  
    if (widgetDef) {
      this.registerListeners();
    }
  };
  
  literatum.Widget.prototype.get = function () {
    return this.$element;
  };
  
  literatum.Widget.prototype.resize = function (e) {};
  
  literatum.Widget.prototype.render = function (model, params, callback, renderer) {
    if (this.widgetDef.action) {
      return literatum.widgets.getWidget(this, model, params, callback, renderer);
    }
  };
  
  literatum.Widget.prototype.lostFocus = function () {// nothing
  };
  
  literatum.Widget.prototype.updateView = function (view, model) {
    var $this = this.get();
    var $html = $(view.trim());
  
    if ($html.length > 0) {
      $this.replaceWith($html);
      this.$element = $("*[widget-id='" + $html.attr('widget-id') + "']");
  
      if (this.$element.length == 0) {
        this.$element = $("#" + $html.attr('id'));
      }
    } else {
      this.$element.html("");
    }
  
    this.registerListeners();
    this.triggerInfoHandlers(this, model);
  };
  
  literatum.Widget.prototype.triggerInfoHandlers = function (widget, model) {
    var infoHandlers = widget.widgetDef.infoHandlers;
  
    if (model && model.attributes && infoHandlers) {
      Object.keys(model.attributes).forEach(function (key) {
        var infoHandler = infoHandlers[key];
  
        if (infoHandler) {
          infoHandler(model.attributes[key], widget, model);
        }
      });
    }
  };
  
  literatum.Widget.prototype.registerListeners = function () {
    try {
      this.unbind();
    } catch (e) {
      console.log(e);
    }
  
    try {
      //console.log("Binding events to candidate elements");
      this.bind();
    } catch (e) {
      console.log("Failed to bind events, rolling back...");
      this.unbind();
    }
  };
  
  literatum.Widget.prototype.update = function (model) {
    var result;
    console.log("Updating " + this.widgetDef.id + "...");
  
    if (!literatum.utils.hasErrors(model.attributes)) {
      result = this.render(model, {});
      console.log("Updating " + this.widgetDef.id + "... Content");
    } else {
      this.triggerInfoHandlers(this, model);
      this.loaded();
      console.log("Updating " + this.widgetDef.id + "... Info");
      result = $.Deferred().resolve();
    }
  
    return result;
  };
  
  literatum.Widget.prototype.bind = function () {
    var thisWidget = this;
    if (!thisWidget.widgetDef.binders) return;
    this.find("*[data-bind]").each(function () {
      var binderName = $(this).data("bind");
      var binder = thisWidget.widgetDef.binders[binderName];
  
      if (binder) {
        $(this).on('click', function (e) {
          //literatum.events.notify('user-action');
          binder.call(this, e, thisWidget);
        });
      }
    });
    this.find("*[data-bind-change]").each(function () {
      var binderName = $(this).data("bind");
      var binder = thisWidget.widgetDef.binders[binderName];
  
      if (binder) {
        $(this).on('change', function (e) {
          literatum.events.notify('user-action');
          binder.call(this, e, thisWidget);
        });
      }
    });
  };
  
  literatum.Widget.prototype.unbind = function () {
    this.find("*[data-bind]").each(function () {
      $(this).off();
    });
  };
  
  literatum.Widget.prototype.find = function (selector) {
    return this.get().find(selector);
  };
  
  literatum.Widget.prototype.collectForms = function () {
    var $elements = this.find("form");
    var forms = {};
    $elements.each(function () {
      var $this = $(this);
      var name = $(this).attr('name');
  
      if (name) {
        var form = {};
        forms[name] = form;
        $this.find("input[type!='checkbox'], textarea").each(function () {
          form[$(this).attr('name')] = $(this).val();
        });
        $this.find("input[type='checkbox']").each(function () {
          if ($(this).is(":checked")) {
            form[$(this).attr('name')] = $(this).val();
          }
        });
        $this.find("select").each(function () {
          form[$(this).attr('name')] = $(this).find('option:selected').val();
        });
      }
    });
    this.find("*[data-form]").each(function () {
      var name = $(this).data('form');
  
      if (name) {
        var form = {};
        forms[name] = form;
        $(this).find("*[data-field]").each(function () {
          var $this = $(this);
          var value = $this.data('value');
  
          if (!value) {
            value = $this.text().trim();
          }
  
          form[$this.data('field')] = value;
        });
      }
    });
    return forms;
  };
  
  literatum.Widget.prototype.updateForm = function (formName, sourceForm, merge) {
    var forms = this.find("form[name='" + formName + "']");
  
    if (forms) {
      var form = forms[0];
  
      if (form) {
        var $form = $(form);
        $form.find("input").each(function () {
          var $this = $(this);
  
          if ($this.attr("type") == 'submit') {
            return;
          }
  
          var value = sourceForm[$this.attr('name')];
  
          if ($this.attr("type") == 'checkbox') {
            $this.prop('checked', true);
          }
  
          if (merge && !value) return;
          $this.val(value);
        });
        var $select = $form.find("select");
        $select.each(function () {
          var $this = $(this);
          var value = sourceForm[$this.attr('name')];
          if (merge && !value) return;
  
          if (value) {
            $this.closest(".input-group").show();
          }
  
          $this.find('option').prop('selected', false);
          $this.find("option[value='" + value + "']").prop('selected', true);
        });
      }
    }
  };
  
  literatum.Widget.prototype.initialize = function () {
    this.registerListeners();
  };
  
  literatum.Widget.prototype.loading = function () {
    $("body").addClass("widget-loading");
  };
  
  literatum.Widget.prototype.error = function () {//$("body").addClass("widget-error");
  };
  
  literatum.Widget.prototype.loaded = function () {//$("body").removeClass("widget-loading");
  };
  
  literatum.Widget.prototype.reset = function () {
    this.getNotifications().forEach(function (item) {
      item.reset();
    });
  };
  
  literatum.Widget.prototype.getNotifications = function () {
    var result = [];
    this.find("*[data-notification]").each(function () {
      if (this.literatumNotification) {
        result.push(this.literatumNotification);
      }
    });
    return result;
  };
  
  literatum.Widget.prototype.getNotification = function (name) {
    if (!this.widgetDef.notifications) return null;
    var thisWidget = this;
    var notification = null;
    this.find("*[data-notification='" + name + "']").each(function () {
      var notificationType = thisWidget.widgetDef.notifications[name];
  
      if (!this.literatumNotification) {
        this.literatumNotification = new notificationType(this);
      }
  
      notification = this.literatumNotification;
    });
    return notification;
  };
  
  literatum.Widget.prototype.register = function (service) {
    var thisWidget = this;
    commerce.cart.register(service, function (model) {
      return thisWidget.update(model);
    });
  };
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/literatum/widgets.js":
  /*!**********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/literatum/widgets.js ***!
    \**********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //const circle = require('./literatum.js');
  literatum.widgets = function () {
    var instance = {};
    var widgetDefs = [];
    var widgets = [];
  
    function render(template, model) {
      Object.keys(model).forEach(function (key) {
        var re = new RegExp('\\{{' + key + '\\}}', 'g');
        template = template.replace(re, model[key]);
      });
      template = template.replace(/{{.+?}}/g, '');
      return template;
    }
  
    $(window).on('resize', function (e) {
      widgets.forEach(function (widget) {
        widget.resize(e);
      });
    });
  
    instance.render = function (widget, model, params, callback, renderer) {
      // FIXME: clean me
      return widget.render(model, params, callback, renderer);
    };
  
    instance.getWidget = function (widget, model, params, callback, renderer) {
      return widget.get().pbAjax({
        type: 'GET',
        url: widget.widgetDef.action,
        dataType: 'html',
        data: params,
        async: true,
        success: function success(html) {
          var result = render(html, model);
  
          if (renderer) {
            renderer(html, model);
          } else {
            widget.updateView(result, model);
          } //widget.get().fadeIn(400).fadeOut(400).fadeIn(400).fadeOut(400).fadeIn(400); // For debugging
  
  
          widget.loaded(); // This is not needed, confirm and remove
  
          if (callback) {
            callback();
          }
        },
        error: function error(data) {
          widget.error();
        }
      });
    };
  
    instance.get = function (id) {
      var result = [];
      widgets.forEach(function (item) {
        if (item.widgetDef.id == id) result.push(item);
      });
      return result;
    };
  
    instance.all = function () {
      return widgets.slice(0);
    };
  
    instance.collapse = function () {
      widgets.forEach(function (widget) {
        widget.hide();
      });
    };
  
    instance.register = function (widgetDef) {
      widgetDefs.push(widgetDef);
    };
  
    instance.initialize = function () {
      widgetDefs.forEach(function (WidgetDef) {
        WidgetDef.find().each(function () {
          var instance = Object.create(WidgetDef.prototype);
          WidgetDef.call(instance, WidgetDef, this);
          widgets.push(instance);
        });
      });
    };
  
    return instance;
  }();
  
  $(document).ready(function () {
    literatum.widgets.initialize();
  });
  console.log("Widgets initialized!");
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/magicSearch/js/magicsuggest.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/magicSearch/js/magicsuggest.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /**
   * Multiple Selection Component for Bootstrap
   * Check nicolasbize.github.io/magicsuggest/ for latest updates.
   *
   * Author:       Nicolas Bize
   * Created:      Feb 8th 2013
   * Last Updated: Oct 16th 2014
   * Version:      2.1.4
   * Licence:      MagicSuggest is licenced under MIT licence (http://opensource.org/licenses/MIT)
   */
  (function ($) {
    "use strict";
  
    var MagicSuggest = function MagicSuggest(element, options) {
      var ms = this;
      /**
       * Initializes the MagicSuggest component
       */
  
      var defaults = {
        /**********  CONFIGURATION PROPERTIES ************/
  
        /**
         * Restricts or allows the user to validate typed entries.
         * Defaults to true.
         */
        allowFreeEntries: true,
  
        /**
         * Restricts or allows the user to add the same entry more than once
         * Defaults to false.
         */
        allowDuplicates: false,
  
        /**
         * Additional config object passed to each $.ajax call
         */
        ajaxConfig: {},
  
        /**
         * If a single suggestion comes out, it is preselected.
         */
        autoSelect: true,
  
        /**
         * Auto select the first matching item with multiple items shown
         */
        selectFirst: false,
  
        /**
         * Allow customization of query parameter
         */
        queryParam: 'query',
  
        /**
         * A function triggered just before the ajax request is sent, similar to jQuery
         */
        beforeSend: function beforeSend() {},
  
        /**
         * A custom CSS class to apply to the field's underlying element.
         */
        cls: '',
  
        /**
         * JSON Data source used to populate the combo box. 3 options are available here:
         * No Data Source (default)
         *    When left null, the combo box will not suggest anything. It can still enable the user to enter
         *    multiple entries if allowFreeEntries is * set to true (default).
         * Static Source
         *    You can pass an array of JSON objects, an array of strings or even a single CSV string as the
         *    data source.For ex. data: [* {id:0,name:"Paris"}, {id: 1, name: "New York"}]
         *    You can also pass any json object with the results property containing the json array.
         * Url
         *     You can pass the url from which the component will fetch its JSON data.Data will be fetched
         *     using a POST ajax request that will * include the entered text as 'query' parameter. The results
         *     fetched from the server can be:
         *     - an array of JSON objects (ex: [{id:...,name:...},{...}])
         *     - a string containing an array of JSON objects ready to be parsed (ex: "[{id:...,name:...},{...}]")
         *     - a JSON object whose data will be contained in the results property
         *      (ex: {results: [{id:...,name:...},{...}]
         * Function
         *     You can pass a function which returns an array of JSON objects  (ex: [{id:...,name:...},{...}])
         *     The function can return the JSON data or it can use the first argument as function to handle the data.
         *     Only one (callback function or return value) is needed for the function to succeed.
         *     See the following example:
         *     function (response) { var myjson = [{name: 'test', id: 1}]; response(myjson); return myjson; }
         */
        data: null,
  
        /**
         * Additional parameters to the ajax call
         */
        dataUrlParams: {},
  
        /**
         * Start the component in a disabled state.
         */
        disabled: false,
  
        /**
         * Name of JSON object property that defines the disabled behaviour
         */
        disabledField: null,
  
        /**
         * Name of JSON object property displayed in the combo list
         */
        displayField: 'name',
  
        /**
         * Set to false if you only want mouse interaction. In that case the combo will
         * automatically expand on focus.
         */
        editable: true,
  
        /**
         * Set starting state for combo.
         */
        expanded: false,
  
        /**
         * Automatically expands combo on focus.
         */
        expandOnFocus: false,
  
        /**
         * JSON property by which the list should be grouped
         */
        groupBy: null,
  
        /**
         * Set to true to hide the trigger on the right
         */
        hideTrigger: false,
  
        /**
         * Set to true to highlight search input within displayed suggestions
         */
        highlight: true,
  
        /**
         * A custom ID for this component
         */
        id: null,
  
        /**
         * A class that is added to the info message appearing on the top-right part of the component
         */
        infoMsgCls: '',
  
        /**
         * Additional parameters passed out to the INPUT tag. Enables usage of AngularJS's custom tags for ex.
         */
        inputCfg: {},
  
        /**
         * The class that is applied to show that the field is invalid
         */
        invalidCls: 'ms-inv',
  
        /**
         * Set to true to filter data results according to case. Useless if the data is fetched remotely
         */
        matchCase: false,
  
        /**
         * Once expanded, the combo's height will take as much room as the # of available results.
         *    In case there are too many results displayed, this will fix the drop down height.
         */
        maxDropHeight: 290,
  
        /**
         * Defines how long the user free entry can be. Set to null for no limit.
         */
        maxEntryLength: null,
  
        /**
         * A function that defines the helper text when the max entry length has been surpassed.
         */
        maxEntryRenderer: function maxEntryRenderer(v) {
          return 'Please reduce your entry by ' + v + ' character' + (v > 1 ? 's' : '');
        },
  
        /**
         * The maximum number of results displayed in the combo drop down at once.
         */
        maxSuggestions: null,
  
        /**
         * The maximum number of items the user can select if multiple selection is allowed.
         *    Set to null to remove the limit.
         */
        maxSelection: 10,
  
        /**
         * A function that defines the helper text when the max selection amount has been reached. The function has a single
         *    parameter which is the number of selected elements.
         */
        maxSelectionRenderer: function maxSelectionRenderer(v) {
          return 'You cannot choose more than ' + v + ' item' + (v > 1 ? 's' : '');
        },
  
        /**
         * The method used by the ajax request.
         */
        method: 'POST',
  
        /**
         * The minimum number of characters the user must type before the combo expands and offers suggestions.
         */
        minChars: 0,
  
        /**
         * A function that defines the helper text when not enough letters are set. The function has a single
         *    parameter which is the difference between the required amount of letters and the current one.
         */
        minCharsRenderer: function minCharsRenderer(v) {
          return 'Please type ' + v + ' more character' + (v > 1 ? 's' : '');
        },
  
        /**
         * Whether or not sorting / filtering should be done remotely or locally.
         * Use either 'local' or 'remote'
         */
        mode: 'local',
  
        /**
         * The name used as a form element.
         */
        name: null,
  
        /**
         * The text displayed when there are no suggestions.
         */
        noSuggestionText: 'No suggestions',
  
        /**
         * The default placeholder text when nothing has been entered
         */
        placeholder: 'Type or click here',
  
        /**
         * A function used to define how the items will be presented in the combo
         */
        renderer: null,
  
        /**
         * Whether or not this field should be required
         */
        required: false,
  
        /**
         * Set to true to render selection as a delimited string
         */
        resultAsString: false,
  
        /**
         * Text delimiter to use in a delimited string.
         */
        resultAsStringDelimiter: ',',
  
        /**
         * Name of JSON object property that represents the list of suggested objects
         */
        resultsField: 'results',
  
        /**
         * A custom CSS class to add to a selected item
         */
        selectionCls: '',
  
        /**
         * An optional element replacement in which the selection is rendered
         */
        selectionContainer: null,
  
        /**
         * Where the selected items will be displayed. Only 'right', 'bottom' and 'inner' are valid values
         */
        selectionPosition: 'inner',
  
        /**
         * A function used to define how the items will be presented in the tag list
         */
        selectionRenderer: null,
  
        /**
         * Set to true to stack the selectioned items when positioned on the bottom
         *    Requires the selectionPosition to be set to 'bottom'
         */
        selectionStacked: false,
  
        /**
         * Direction used for sorting. Only 'asc' and 'desc' are valid values
         */
        sortDir: 'asc',
  
        /**
         * name of JSON object property for local result sorting.
         *    Leave null if you do not wish the results to be ordered or if they are already ordered remotely.
         */
        sortOrder: null,
  
        /**
         * If set to true, suggestions will have to start by user input (and not simply contain it as a substring)
         */
        strictSuggest: false,
  
        /**
         * Custom style added to the component container.
         */
        style: '',
  
        /**
         * If set to true, the combo will expand / collapse when clicked upon
         */
        toggleOnClick: false,
  
        /**
         * Amount (in ms) between keyboard registers.
         */
        typeDelay: 400,
  
        /**
         * If set to true, tab won't blur the component but will be registered as the ENTER key
         */
        useTabKey: false,
  
        /**
         * If set to true, using comma will validate the user's choice
         */
        useCommaKey: true,
  
        /**
         * Determines whether or not the results will be displayed with a zebra table style
         */
        useZebraStyle: false,
  
        /**
         * initial value for the field
         */
        value: null,
  
        /**
         * name of JSON object property that represents its underlying value
         */
        valueField: 'id',
  
        /**
         * regular expression to validate the values against
         */
        vregex: null,
  
        /**
         * type to validate against
         */
        vtype: null
      };
      var conf = $.extend({}, options);
      var cfg = $.extend(true, {}, defaults, conf);
      /**********  PUBLIC METHODS ************/
  
      /**
       * Add one or multiple json items to the current selection
       * @param items - json object or array of json objects
       * @param isSilent - (optional) set to true to suppress 'selectionchange' event from being triggered
       */
  
      this.addToSelection = function (items, isSilent) {
        if (!cfg.maxSelection || _selection.length < cfg.maxSelection) {
          if (!$.isArray(items)) {
            items = [items];
          }
  
          var valuechanged = false;
          $.each(items, function (index, json) {
            if (cfg.allowDuplicates || $.inArray(json[cfg.valueField], ms.getValue()) === -1) {
              _selection.push(json);
  
              valuechanged = true;
            }
          });
  
          if (valuechanged === true) {
            self._renderSelection();
  
            this.empty();
  
            if (isSilent !== true) {
              $(this).trigger('selectionchange', [this, this.getSelection()]);
            }
          }
        }
  
        this.input.attr('placeholder', cfg.selectionPosition === 'inner' && this.getValue().length > 0 ? '' : cfg.placeholder);
      };
      /**
       * Clears the current selection
       * @param isSilent - (optional) set to true to suppress 'selectionchange' event from being triggered
       */
  
  
      this.clear = function (isSilent) {
        this.removeFromSelection(_selection.slice(0), isSilent); // clone array to avoid concurrency issues
      };
      /**
       * Collapse the drop down part of the combo
       */
  
  
      this.collapse = function () {
        if (cfg.expanded === true) {
          this.combobox.detach();
          cfg.expanded = false;
          $(this).trigger('collapse', [this]);
        }
      };
      /**
       * Set the component in a disabled state.
       */
  
  
      this.disable = function () {
        this.container.addClass('ms-ctn-disabled');
        cfg.disabled = true;
        ms.input.attr('disabled', true);
      };
      /**
       * Empties out the combo user text
       */
  
  
      this.empty = function () {
        this.input.val('');
      };
      /**
       * Set the component in a enable state.
       */
  
  
      this.enable = function () {
        this.container.removeClass('ms-ctn-disabled');
        cfg.disabled = false;
        ms.input.attr('disabled', false);
      };
      /**
       * Expand the drop drown part of the combo.
       */
  
  
      this.expand = function () {
        if (!cfg.expanded && (this.input.val().length >= cfg.minChars || this.combobox.children().size() > 0)) {
          this.combobox.appendTo(this.container);
  
          self._processSuggestions();
  
          cfg.expanded = true;
          $(this).trigger('expand', [this]);
        }
      };
      /**
       * Retrieve component enabled status
       */
  
  
      this.isDisabled = function () {
        return cfg.disabled;
      };
      /**
       * Checks whether the field is valid or not
       * @return {boolean}
       */
  
  
      this.isValid = function () {
        var valid = cfg.required === false || _selection.length > 0;
  
        if (cfg.vtype || cfg.vregex) {
          $.each(_selection, function (index, item) {
            valid = valid && self._validateSingleItem(item[cfg.valueField]);
          });
        }
  
        return valid;
      };
      /**
       * Gets the data params for current ajax request
       */
  
  
      this.getDataUrlParams = function () {
        return cfg.dataUrlParams;
      };
      /**
       * Gets the name given to the form input
       */
  
  
      this.getName = function () {
        return cfg.name;
      };
      /**
       * Retrieve an array of selected json objects
       * @return {Array}
       */
  
  
      this.getSelection = function () {
        return _selection;
      };
      /**
       * Retrieve the current text entered by the user
       */
  
  
      this.getRawValue = function () {
        return ms.input.val();
      };
      /**
       * Retrieve an array of selected values
       */
  
  
      this.getValue = function () {
        return $.map(_selection, function (o) {
          return o[cfg.valueField];
        });
      };
      /**
       * Remove one or multiples json items from the current selection
       * @param items - json object or array of json objects
       * @param isSilent - (optional) set to true to suppress 'selectionchange' event from being triggered
       */
  
  
      this.removeFromSelection = function (items, isSilent) {
        if (!$.isArray(items)) {
          items = [items];
        }
  
        var valuechanged = false;
        $.each(items, function (index, json) {
          var i = $.inArray(json[cfg.valueField], ms.getValue());
  
          if (i > -1) {
            _selection.splice(i, 1);
  
            valuechanged = true;
          }
        });
  
        if (valuechanged === true) {
          self._renderSelection();
  
          if (isSilent !== true) {
            $(this).trigger('selectionchange', [this, this.getSelection()]);
          }
  
          if (cfg.expandOnFocus) {
            ms.expand();
          }
  
          if (cfg.expanded) {
            self._processSuggestions();
          }
        }
  
        this.input.attr('placeholder', cfg.selectionPosition === 'inner' && this.getValue().length > 0 ? '' : cfg.placeholder);
      };
      /**
       * Get current data
       */
  
  
      this.getData = function () {
        return _cbData;
      };
      /**
       * Set up some combo data after it has been rendered
       * @param data
       */
  
  
      this.setData = function (data) {
        cfg.data = data;
  
        self._processSuggestions();
      };
      /**
       * Sets the name for the input field so it can be fetched in the form
       * @param name
       */
  
  
      this.setName = function (name) {
        cfg.name = name;
  
        if (name) {
          cfg.name += name.indexOf('[]') > 0 ? '' : '[]';
        }
  
        if (ms._valueContainer) {
          $.each(ms._valueContainer.children(), function (i, el) {
            el.name = cfg.name;
          });
        }
      };
      /**
       * Sets the current selection with the JSON items provided
       * @param items
       */
  
  
      this.setSelection = function (items) {
        this.clear();
        this.addToSelection(items);
      };
      /**
       * Sets a value for the combo box. Value must be an array of values with data type matching valueField one.
       * @param data
       */
  
  
      this.setValue = function (values) {
        var items = [];
        $.each(values, function (index, value) {
          // first try to see if we have the full objects from our data set
          var found = false;
          $.each(_cbData, function (i, item) {
            if (item[cfg.valueField] == value) {
              items.push(item);
              found = true;
              return false;
            }
          });
  
          if (!found) {
            if (_typeof(value) === 'object') {
              items.push(value);
            } else {
              var json = {};
              json[cfg.valueField] = value;
              json[cfg.displayField] = value;
              items.push(json);
            }
          }
        });
  
        if (items.length > 0) {
          this.addToSelection(items);
        }
      };
      /**
       * Sets data params for subsequent ajax requests
       * @param params
       */
  
  
      this.setDataUrlParams = function (params) {
        cfg.dataUrlParams = $.extend({}, params);
      };
      /**********  PRIVATE ************/
  
  
      var _selection = [],
          // selected objects
      _comboItemHeight = 0,
          // height for each combo item.
      _timer,
          _hasFocus = false,
          _groups = null,
          _cbData = [],
          _ctrlDown = false,
          KEYCODES = {
        BACKSPACE: 8,
        TAB: 9,
        ENTER: 13,
        CTRL: 17,
        ESC: 27,
        SPACE: 32,
        UPARROW: 38,
        DOWNARROW: 40,
        COMMA: 188
      };
  
      var self = {
        /**
         * Empties the result container and refills it with the array of json results in input
         * @private
         */
        _displaySuggestions: function _displaySuggestions(data) {
          ms.combobox.show();
          ms.combobox.empty();
          var resHeight = 0,
              // total height taken by displayed results.
          nbGroups = 0;
  
          if (_groups === null) {
            self._renderComboItems(data);
  
            resHeight = _comboItemHeight * data.length;
          } else {
            for (var grpName in _groups) {
              nbGroups += 1;
              $('<div/>', {
                'class': 'ms-res-group',
                html: grpName
              }).appendTo(ms.combobox);
  
              self._renderComboItems(_groups[grpName].items, true);
            }
  
            var _groupItemHeight = ms.combobox.find('.ms-res-group').outerHeight();
  
            if (_groupItemHeight !== null) {
              var tmpResHeight = nbGroups * _groupItemHeight;
              resHeight = _comboItemHeight * data.length + tmpResHeight;
            } else {
              resHeight = _comboItemHeight * (data.length + nbGroups);
            }
          }
  
          if (resHeight < ms.combobox.height() || resHeight <= cfg.maxDropHeight) {
            ms.combobox.height(resHeight);
          } else if (resHeight >= ms.combobox.height() && resHeight > cfg.maxDropHeight) {
            ms.combobox.height(cfg.maxDropHeight);
          }
  
          if (data.length === 1 && cfg.autoSelect === true) {
            ms.combobox.children().filter(':not(.ms-res-item-disabled):last').addClass('ms-res-item-active');
          }
  
          if (cfg.selectFirst === true) {
            ms.combobox.children().filter(':not(.ms-res-item-disabled):first').addClass('ms-res-item-active');
          }
  
          if (data.length === 0 && ms.getRawValue() !== "") {
            var noSuggestionText = cfg.noSuggestionText.replace(/\{\{.*\}\}/, ms.input.val());
  
            self._updateHelper(noSuggestionText);
  
            ms.collapse();
          } // When free entry is off, add invalid class to input if no data matches
  
  
          if (cfg.allowFreeEntries === false) {
            if (data.length === 0) {
              $(ms.input).addClass(cfg.invalidCls);
              ms.combobox.hide();
            } else {
              $(ms.input).removeClass(cfg.invalidCls);
            }
          }
        },
  
        /**
         * Returns an array of json objects from an array of strings.
         * @private
         */
        _getEntriesFromStringArray: function _getEntriesFromStringArray(data) {
          var json = [];
          $.each(data, function (index, s) {
            var entry = {};
            entry[cfg.displayField] = entry[cfg.valueField] = $.trim(s);
            json.push(entry);
          });
          return json;
        },
  
        /**
         * Replaces html with highlighted html according to case
         * @param html
         * @private
         */
        _highlightSuggestion: function _highlightSuggestion(html) {
          var q = ms.input.val(); //escape special regex characters
  
          var specialCharacters = ['^', '$', '*', '+', '?', '.', '(', ')', ':', '!', '|', '{', '}', '[', ']'];
          $.each(specialCharacters, function (index, value) {
            q = q.replace(value, "\\" + value);
          });
  
          if (q.length === 0) {
            return html; // nothing entered as input
          }
  
          var glob = cfg.matchCase === true ? 'g' : 'gi';
          return html.replace(new RegExp('(' + q + ')(?!([^<]+)?>)', glob), '<em>$1</em>');
        },
  
        /**
         * Moves the selected cursor amongst the list item
         * @param dir - 'up' or 'down'
         * @private
         */
        _moveSelectedRow: function _moveSelectedRow(dir) {
          if (!cfg.expanded) {
            ms.expand();
          }
  
          var list, start, active, scrollPos;
          list = ms.combobox.find(".ms-res-item:not(.ms-res-item-disabled)");
  
          if (dir === 'down') {
            start = list.eq(0);
          } else {
            start = list.filter(':last');
          }
  
          active = ms.combobox.find('.ms-res-item-active:not(.ms-res-item-disabled):first');
  
          if (active.length > 0) {
            if (dir === 'down') {
              start = active.nextAll('.ms-res-item:not(.ms-res-item-disabled)').first();
  
              if (start.length === 0) {
                start = list.eq(0);
              }
  
              scrollPos = ms.combobox.scrollTop();
              ms.combobox.scrollTop(0);
  
              if (start[0].offsetTop + start.outerHeight() > ms.combobox.height()) {
                ms.combobox.scrollTop(scrollPos + _comboItemHeight);
              }
            } else {
              start = active.prevAll('.ms-res-item:not(.ms-res-item-disabled)').first();
  
              if (start.length === 0) {
                start = list.filter(':last');
                ms.combobox.scrollTop(_comboItemHeight * list.length);
              }
  
              if (start[0].offsetTop < ms.combobox.scrollTop()) {
                ms.combobox.scrollTop(ms.combobox.scrollTop() - _comboItemHeight);
              }
            }
          }
  
          list.removeClass("ms-res-item-active");
          start.addClass("ms-res-item-active");
        },
  
        /**
         * According to given data and query, sort and add suggestions in their container
         * @private
         */
        _processSuggestions: function _processSuggestions(source) {
          var json = null,
              data = source || cfg.data;
  
          if (data !== null) {
            if (typeof data === 'function') {
              data = data.call(ms, ms.getRawValue());
            }
  
            if (typeof data === 'string') {
              // get results from ajax
              $(ms).trigger('beforeload', [ms]);
              var queryParams = {};
              queryParams[cfg.queryParam] = ms.input.val();
              var params = $.extend(queryParams, cfg.dataUrlParams);
              $.ajax($.extend({
                type: cfg.method,
                url: data,
                data: params,
                beforeSend: cfg.beforeSend,
                success: function success(asyncData) {
                  json = typeof asyncData === 'string' ? JSON.parse(asyncData) : asyncData;
  
                  self._processSuggestions(json);
  
                  $(ms).trigger('load', [ms, json]);
  
                  if (self._asyncValues) {
                    ms.setValue(typeof self._asyncValues === 'string' ? JSON.parse(self._asyncValues) : self._asyncValues);
  
                    self._renderSelection();
  
                    delete self._asyncValues;
                  }
                },
                error: function error() {
                  throw "Could not reach server";
                }
              }, cfg.ajaxConfig));
              return;
            } else {
              // results from local array
              if (data.length > 0 && typeof data[0] === 'string') {
                // results from array of strings
                _cbData = self._getEntriesFromStringArray(data);
              } else {
                // regular json array or json object with results property
                _cbData = data[cfg.resultsField] || data;
              }
            }
  
            var sortedData = cfg.mode === 'remote' ? _cbData : self._sortAndTrim(_cbData);
  
            self._displaySuggestions(self._group(sortedData));
          }
        },
  
        /**
         * Render the component to the given input DOM element
         * @private
         */
        _render: function _render(el) {
          ms.setName(cfg.name); // make sure the form name is correct
          // holds the main div, will relay the focus events to the contained input element.
  
          ms.container = $('<div/>', {
            'class': 'ms-ctn form-control ' + (cfg.resultAsString ? 'ms-as-string ' : '') + cfg.cls + ($(el).hasClass('input-lg') ? ' input-lg' : '') + ($(el).hasClass('input-sm') ? ' input-sm' : '') + (cfg.disabled === true ? ' ms-ctn-disabled' : '') + (cfg.editable === true ? '' : ' ms-ctn-readonly') + (cfg.hideTrigger === false ? '' : ' ms-no-trigger'),
            style: cfg.style,
            id: cfg.id
          });
          ms.container.focus($.proxy(handlers._onFocus, this));
          ms.container.blur($.proxy(handlers._onBlur, this));
          ms.container.keydown($.proxy(handlers._onKeyDown, this));
          ms.container.keyup($.proxy(handlers._onKeyUp, this)); // holds the input field
  
          ms.input = $('<input/>', $.extend({
            type: 'text',
            'class': cfg.editable === true ? '' : ' ms-input-readonly',
            readonly: !cfg.editable,
            placeholder: cfg.placeholder,
            disabled: cfg.disabled
          }, cfg.inputCfg));
          ms.input.focus($.proxy(handlers._onInputFocus, this));
          ms.input.click($.proxy(handlers._onInputClick, this)); // holds the suggestions. will always be placed on focus
  
          ms.combobox = $('<div/>', {
            'class': 'ms-res-ctn dropdown-menu'
          }).height(cfg.maxDropHeight); // bind the onclick and mouseover using delegated events (needs jQuery >= 1.7)
  
          ms.combobox.on('click', 'div.ms-res-item', $.proxy(handlers._onComboItemSelected, this));
          ms.combobox.on('mouseover', 'div.ms-res-item', $.proxy(handlers._onComboItemMouseOver, this));
  
          if (cfg.selectionContainer) {
            ms.selectionContainer = cfg.selectionContainer;
            $(ms.selectionContainer).addClass('ms-sel-ctn');
          } else {
            ms.selectionContainer = $('<div/>', {
              'class': 'ms-sel-ctn'
            });
          }
  
          ms.selectionContainer.click($.proxy(handlers._onFocus, this));
  
          if (cfg.selectionPosition === 'inner' && !cfg.selectionContainer) {
            ms.selectionContainer.append(ms.input);
          } else {
            ms.container.append(ms.input);
          }
  
          ms.helper = $('<span/>', {
            'class': 'ms-helper ' + cfg.infoMsgCls
          });
  
          self._updateHelper();
  
          ms.container.append(ms.helper); // Render the whole thing
  
          $(el).replaceWith(ms.container);
  
          if (!cfg.selectionContainer) {
            switch (cfg.selectionPosition) {
              case 'bottom':
                ms.selectionContainer.insertAfter(ms.container);
  
                if (cfg.selectionStacked === true) {
                  ms.selectionContainer.width(ms.container.width());
                  ms.selectionContainer.addClass('ms-stacked');
                }
  
                break;
  
              case 'right':
                ms.selectionContainer.insertAfter(ms.container);
                ms.container.css('float', 'left');
                break;
  
              default:
                ms.container.append(ms.selectionContainer);
                break;
            }
          } // holds the trigger on the right side
  
  
          if (cfg.hideTrigger === false) {
            ms.trigger = $('<div/>', {
              'class': 'ms-trigger',
              html: '<div class="ms-trigger-ico"></div>'
            });
            ms.trigger.click($.proxy(handlers._onTriggerClick, this));
            ms.container.append(ms.trigger);
          }
  
          $(window).resize($.proxy(handlers._onWindowResized, this)); // do not perform an initial call if we are using ajax unless we have initial values
  
          if (cfg.value !== null || cfg.data !== null) {
            if (typeof cfg.data === 'string') {
              self._asyncValues = cfg.value;
  
              self._processSuggestions();
            } else {
              self._processSuggestions();
  
              if (cfg.value !== null) {
                ms.setValue(cfg.value);
  
                self._renderSelection();
              }
            }
          }
  
          $("body").click(function (e) {
            if (ms.container.hasClass('ms-ctn-focus') && ms.container.has(e.target).length === 0 && e.target.className.indexOf('ms-res-item') < 0 && e.target.className.indexOf('ms-close-btn') < 0 && ms.container[0] !== e.target) {
              handlers._onBlur();
            }
          });
  
          if (cfg.expanded === true) {
            cfg.expanded = false;
            ms.expand();
          }
        },
  
        /**
         * Renders each element within the combo box
         * @private
         */
        _renderComboItems: function _renderComboItems(items, isGrouped) {
          var ref = this,
              html = '';
          $.each(items, function (index, value) {
            var displayed = cfg.renderer !== null ? cfg.renderer.call(ref, value) : value[cfg.displayField];
            var disabled = cfg.disabledField !== null && value[cfg.disabledField] === true;
            var resultItemEl = $('<div/>', {
              'class': 'ms-res-item ' + (isGrouped ? 'ms-res-item-grouped ' : '') + (disabled ? 'ms-res-item-disabled ' : '') + (index % 2 === 1 && cfg.useZebraStyle === true ? 'ms-res-odd' : ''),
              html: cfg.highlight === true ? self._highlightSuggestion(displayed) : displayed,
              'data-json': JSON.stringify(value)
            });
            html += $('<div/>').append(resultItemEl).html();
          });
          ms.combobox.append(html);
          _comboItemHeight = ms.combobox.find('.ms-res-item:first').outerHeight();
        },
  
        /**
         * Renders the selected items into their container.
         * @private
         */
        _renderSelection: function _renderSelection() {
          var ref = this,
              w = 0,
              inputOffset = 0,
              items = [],
              asText = cfg.resultAsString === true && !_hasFocus;
          ms.selectionContainer.find('.ms-sel-item').remove();
  
          if (ms._valueContainer !== undefined) {
            ms._valueContainer.remove();
          }
  
          $.each(_selection, function (index, value) {
            var selectedItemEl,
                delItemEl,
                selectedItemHtml = cfg.selectionRenderer !== null ? cfg.selectionRenderer.call(ref, value) : value[cfg.displayField];
            var validCls = self._validateSingleItem(value[cfg.displayField]) ? '' : ' ms-sel-invalid'; // tag representing selected value
  
            if (asText === true) {
              selectedItemEl = $('<div/>', {
                'class': 'ms-sel-item ms-sel-text ' + cfg.selectionCls + validCls,
                html: selectedItemHtml + (index === _selection.length - 1 ? '' : cfg.resultAsStringDelimiter)
              }).data('json', value);
            } else {
              selectedItemEl = $('<div/>', {
                'class': 'ms-sel-item ' + cfg.selectionCls + validCls,
                html: selectedItemHtml
              }).data('json', value);
  
              if (cfg.disabled === false) {
                // small cross img
                delItemEl = $('<span/>', {
                  'class': 'ms-close-btn'
                }).data('json', value).appendTo(selectedItemEl);
                delItemEl.click($.proxy(handlers._onTagTriggerClick, ref));
              }
            }
  
            items.push(selectedItemEl);
          });
          ms.selectionContainer.prepend(items); // store the values, behaviour of multiple select
  
          ms._valueContainer = $('<div/>', {
            style: 'display: none;'
          });
          $.each(ms.getValue(), function (i, val) {
            var el = $('<input/>', {
              type: 'hidden',
              name: cfg.name,
              value: val
            });
            el.appendTo(ms._valueContainer);
          });
  
          ms._valueContainer.appendTo(ms.selectionContainer);
  
          if (cfg.selectionPosition === 'inner' && !cfg.selectionContainer) {
            ms.input.width(0);
            inputOffset = ms.input.offset().left - ms.selectionContainer.offset().left;
            w = ms.container.width() - inputOffset - 42;
            ms.input.width(w);
          }
  
          if (_selection.length === cfg.maxSelection) {
            self._updateHelper(cfg.maxSelectionRenderer.call(this, _selection.length));
          } else {
            ms.helper.hide();
          }
        },
  
        /**
         * Select an item either through keyboard or mouse
         * @param item
         * @private
         */
        _selectItem: function _selectItem(item) {
          if (cfg.maxSelection === 1) {
            _selection = [];
          }
  
          ms.addToSelection(item.data('json'));
          item.removeClass('ms-res-item-active');
  
          if (cfg.expandOnFocus === false || _selection.length === cfg.maxSelection) {
            ms.collapse();
          }
  
          if (!_hasFocus) {
            ms.input.focus();
          } else if (_hasFocus && (cfg.expandOnFocus || _ctrlDown)) {
            self._processSuggestions();
  
            if (_ctrlDown) {
              ms.expand();
            }
          }
        },
  
        /**
         * Sorts the results and cut them down to max # of displayed results at once
         * @private
         */
        _sortAndTrim: function _sortAndTrim(data) {
          var q = ms.getRawValue(),
              filtered = [],
              newSuggestions = [],
              selectedValues = ms.getValue(); // filter the data according to given input
  
          if (q.length > 0) {
            $.each(data, function (index, obj) {
              var name = obj[cfg.displayField];
  
              if (cfg.matchCase === true && name.indexOf(q) > -1 || cfg.matchCase === false && name.toLowerCase().indexOf(q.toLowerCase()) > -1) {
                if (cfg.strictSuggest === false || name.toLowerCase().indexOf(q.toLowerCase()) === 0) {
                  filtered.push(obj);
                }
              }
            });
          } else {
            filtered = data;
          } // take out the ones that have already been selected
  
  
          $.each(filtered, function (index, obj) {
            if (cfg.allowDuplicates || $.inArray(obj[cfg.valueField], selectedValues) === -1) {
              newSuggestions.push(obj);
            }
          }); // sort the data
  
          if (cfg.sortOrder !== null) {
            newSuggestions.sort(function (a, b) {
              if (a[cfg.sortOrder] < b[cfg.sortOrder]) {
                return cfg.sortDir === 'asc' ? -1 : 1;
              }
  
              if (a[cfg.sortOrder] > b[cfg.sortOrder]) {
                return cfg.sortDir === 'asc' ? 1 : -1;
              }
  
              return 0;
            });
          } // trim it down
  
  
          if (cfg.maxSuggestions && cfg.maxSuggestions > 0) {
            newSuggestions = newSuggestions.slice(0, cfg.maxSuggestions);
          }
  
          return newSuggestions;
        },
        _group: function _group(data) {
          // build groups
          if (cfg.groupBy !== null) {
            _groups = {};
            $.each(data, function (index, value) {
              var props = cfg.groupBy.indexOf('.') > -1 ? cfg.groupBy.split('.') : cfg.groupBy;
              var prop = value[cfg.groupBy];
  
              if (typeof props != 'string') {
                prop = value;
  
                while (props.length > 0) {
                  prop = prop[props.shift()];
                }
              }
  
              if (_groups[prop] === undefined) {
                _groups[prop] = {
                  title: prop,
                  items: [value]
                };
              } else {
                _groups[prop].items.push(value);
              }
            });
          }
  
          return data;
        },
  
        /**
         * Update the helper text
         * @private
         */
        _updateHelper: function _updateHelper(html) {
          ms.helper.html(html);
  
          if (!ms.helper.is(":visible")) {
            ms.helper.fadeIn();
          }
        },
  
        /**
         * Validate an item against vtype or vregex
         * @private
         */
        _validateSingleItem: function _validateSingleItem(value) {
          if (cfg.vregex !== null && cfg.vregex instanceof RegExp) {
            return cfg.vregex.test(value);
          } else if (cfg.vtype !== null) {
            switch (cfg.vtype) {
              case 'alpha':
                return /^[a-zA-Z_]+$/.test(value);
  
              case 'alphanum':
                return /^[a-zA-Z0-9_]+$/.test(value);
  
              case 'email':
                return /^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/.test(value);
  
              case 'url':
                return /(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i.test(value);
  
              case 'ipaddress':
                return /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(value);
            }
          }
  
          return true;
        }
      };
      var handlers = {
        /**
         * Triggered when blurring out of the component
         * @private
         */
        _onBlur: function _onBlur() {
          ms.container.removeClass('ms-ctn-focus');
          ms.collapse();
          _hasFocus = false;
  
          if (ms.getRawValue() !== '' && cfg.allowFreeEntries === true) {
            var obj = {};
            obj[cfg.displayField] = obj[cfg.valueField] = ms.getRawValue().trim();
            ms.addToSelection(obj);
          }
  
          self._renderSelection();
  
          if (ms.isValid() === false) {
            ms.container.addClass(cfg.invalidCls);
          } else if (ms.input.val() !== '' && cfg.allowFreeEntries === false) {
            ms.empty();
  
            self._updateHelper('');
          }
  
          $(ms).trigger('blur', [ms]);
        },
  
        /**
         * Triggered when hovering an element in the combo
         * @param e
         * @private
         */
        _onComboItemMouseOver: function _onComboItemMouseOver(e) {
          var target = $(e.currentTarget);
  
          if (!target.hasClass('ms-res-item-disabled')) {
            ms.combobox.children().removeClass('ms-res-item-active');
            target.addClass('ms-res-item-active');
          }
        },
  
        /**
         * Triggered when an item is chosen from the list
         * @param e
         * @private
         */
        _onComboItemSelected: function _onComboItemSelected(e) {
          var target = $(e.currentTarget);
  
          if (!target.hasClass('ms-res-item-disabled')) {
            self._selectItem($(e.currentTarget));
          }
        },
  
        /**
         * Triggered when focusing on the container div. Will focus on the input field instead.
         * @private
         */
        _onFocus: function _onFocus() {
          ms.input.focus();
        },
  
        /**
         * Triggered when clicking on the input text field
         * @private
         */
        _onInputClick: function _onInputClick() {
          if (ms.isDisabled() === false && _hasFocus) {
            if (cfg.toggleOnClick === true) {
              if (cfg.expanded) {
                ms.collapse();
              } else {
                ms.expand();
              }
            }
          }
        },
  
        /**
         * Triggered when focusing on the input text field.
         * @private
         */
        _onInputFocus: function _onInputFocus() {
          if (ms.isDisabled() === false && !_hasFocus) {
            _hasFocus = true;
            ms.container.addClass('ms-ctn-focus');
            ms.container.removeClass(cfg.invalidCls);
            var curLength = ms.getRawValue().length;
  
            if (cfg.expandOnFocus === true) {
              ms.expand();
            }
  
            if (_selection.length === cfg.maxSelection) {
              self._updateHelper(cfg.maxSelectionRenderer.call(this, _selection.length));
            } else if (curLength < cfg.minChars) {
              self._updateHelper(cfg.minCharsRenderer.call(this, cfg.minChars - curLength));
            }
  
            self._renderSelection();
  
            $(ms).trigger('focus', [ms]);
          }
        },
  
        /**
         * Triggered when the user presses a key while the component has focus
         * This is where we want to handle all keys that don't require the user input field
         * since it hasn't registered the key hit yet
         * @param e keyEvent
         * @private
         */
        _onKeyDown: function _onKeyDown(e) {
          // check how tab should be handled
          var active = ms.combobox.find('.ms-res-item-active:not(.ms-res-item-disabled):first'),
              freeInput = ms.input.val();
          $(ms).trigger('keydown', [ms, e]);
  
          if (e.keyCode === KEYCODES.TAB && (cfg.useTabKey === false || cfg.useTabKey === true && active.length === 0 && ms.input.val().length === 0)) {
            handlers._onBlur();
  
            return;
          }
  
          switch (e.keyCode) {
            case KEYCODES.BACKSPACE:
              if (freeInput.length === 0 && ms.getSelection().length > 0 && cfg.selectionPosition === 'inner') {
                _selection.pop();
  
                self._renderSelection();
  
                $(ms).trigger('selectionchange', [ms, ms.getSelection()]);
                ms.input.attr('placeholder', cfg.selectionPosition === 'inner' && ms.getValue().length > 0 ? '' : cfg.placeholder);
                ms.input.focus();
                e.preventDefault();
              }
  
              break;
  
            case KEYCODES.TAB:
            case KEYCODES.ESC:
              e.preventDefault();
              break;
  
            case KEYCODES.ENTER:
              if (freeInput !== '' || cfg.expanded) {
                e.preventDefault();
              }
  
              break;
  
            case KEYCODES.COMMA:
              if (cfg.useCommaKey === true) {
                e.preventDefault();
              }
  
              break;
  
            case KEYCODES.CTRL:
              _ctrlDown = true;
              break;
  
            case KEYCODES.DOWNARROW:
              e.preventDefault();
  
              self._moveSelectedRow("down");
  
              break;
  
            case KEYCODES.UPARROW:
              e.preventDefault();
  
              self._moveSelectedRow("up");
  
              break;
  
            default:
              if (_selection.length === cfg.maxSelection) {
                e.preventDefault();
              }
  
              break;
          }
        },
  
        /**
         * Triggered when a key is released while the component has focus
         * @param e
         * @private
         */
        _onKeyUp: function _onKeyUp(e) {
          var freeInput = ms.getRawValue(),
              inputValid = $.trim(ms.input.val()).length > 0 && (!cfg.maxEntryLength || $.trim(ms.input.val()).length <= cfg.maxEntryLength),
              selected,
              obj = {};
  
          if (/(^\s$)|(\s\s+)/g.test(freeInput)) {
            return;
          }
  
          $(ms).trigger('keyup', [ms, e]);
          clearTimeout(_timer); // collapse if escape, but keep focus.
  
          if (e.keyCode === KEYCODES.ESC && cfg.expanded) {
            ms.combobox.hide();
          } // ignore a bunch of keys
  
  
          if (e.keyCode === KEYCODES.TAB && cfg.useTabKey === false || e.keyCode > KEYCODES.ENTER && e.keyCode < KEYCODES.SPACE) {
            if (e.keyCode === KEYCODES.CTRL) {
              _ctrlDown = false;
            }
  
            return;
          }
  
          switch (e.keyCode) {
            case KEYCODES.UPARROW:
            case KEYCODES.DOWNARROW:
              e.preventDefault();
              break;
  
            case KEYCODES.ENTER:
            case KEYCODES.TAB:
            case KEYCODES.COMMA:
              if (e.keyCode !== KEYCODES.COMMA || cfg.useCommaKey === true) {
                e.preventDefault();
  
                if (cfg.expanded === true) {
                  // if a selection is performed, select it and reset field
                  selected = ms.combobox.find('.ms-res-item-active:not(.ms-res-item-disabled):first');
  
                  if (selected.length > 0) {
                    self._selectItem(selected);
  
                    return;
                  }
                } // if no selection or if freetext entered and free entries allowed, add new obj to selection
  
  
                if (inputValid === true && cfg.allowFreeEntries === true) {
                  obj[cfg.displayField] = obj[cfg.valueField] = freeInput.trim();
                  ms.addToSelection(obj);
                  ms.collapse(); // reset combo suggestions
  
                  ms.input.focus();
                }
  
                break;
              }
  
            default:
              if (_selection.length === cfg.maxSelection) {
                self._updateHelper(cfg.maxSelectionRenderer.call(this, _selection.length));
              } else {
                if (freeInput.length < cfg.minChars) {
                  self._updateHelper(cfg.minCharsRenderer.call(this, cfg.minChars - freeInput.length));
  
                  if (cfg.expanded === true) {
                    ms.collapse();
                  }
                } else if (cfg.maxEntryLength && freeInput.length > cfg.maxEntryLength) {
                  self._updateHelper(cfg.maxEntryRenderer.call(this, freeInput.length - cfg.maxEntryLength));
  
                  if (cfg.expanded === true) {
                    ms.collapse();
                  }
                } else {
                  ms.helper.hide();
  
                  if (cfg.minChars <= freeInput.length) {
                    _timer = setTimeout(function () {
                      if (cfg.expanded === true) {
                        self._processSuggestions();
                      } else {
                        ms.expand();
                      }
                    }, cfg.typeDelay);
                  }
                }
              }
  
              break;
          }
        },
  
        /**
         * Triggered when clicking upon cross for deletion
         * @param e
         * @private
         */
        _onTagTriggerClick: function _onTagTriggerClick(e) {
          ms.removeFromSelection($(e.currentTarget).data('json'));
        },
  
        /**
         * Triggered when clicking on the small trigger in the right
         * @private
         */
        _onTriggerClick: function _onTriggerClick() {
          if (ms.isDisabled() === false && !(cfg.expandOnFocus === true && _selection.length === cfg.maxSelection)) {
            $(ms).trigger('triggerclick', [ms]);
  
            if (cfg.expanded === true) {
              ms.collapse();
            } else {
              var curLength = ms.getRawValue().length;
  
              if (curLength >= cfg.minChars) {
                ms.input.focus();
                ms.expand();
              } else {
                self._updateHelper(cfg.minCharsRenderer.call(this, cfg.minChars - curLength));
              }
            }
          }
        },
  
        /**
         * Triggered when the browser window is resized
         * @private
         */
        _onWindowResized: function _onWindowResized() {
          self._renderSelection();
        }
      }; // startup point
  
      if (element !== null) {
        self._render(element);
      }
    };
  
    $.fn.magicSuggest = function (options) {
      var obj = $(this);
  
      if (obj.size() === 1 && obj.data('magicSuggest')) {
        return obj.data('magicSuggest');
      }
  
      obj.each(function (i) {
        // assume $(this) is an element
        var cntr = $(this); // Return early if this element already has a plugin instance
  
        if (cntr.data('magicSuggest')) {
          return;
        }
  
        if (this.nodeName.toLowerCase() === 'select') {
          // rendering from select
          options.data = [];
          options.value = [];
          $.each(this.children, function (index, child) {
            if (child.nodeName && child.nodeName.toLowerCase() === 'option') {
              options.data.push({
                id: child.value,
                name: child.text
              });
  
              if ($(child).attr('selected')) {
                options.value.push(child.value);
              }
            }
          });
        }
  
        var def = {}; // set values from DOM container element
  
        $.each(this.attributes, function (i, att) {
          def[att.name] = att.name === 'value' && att.value !== '' ? JSON.parse(att.value) : att.value;
        });
        var field = new MagicSuggest(this, $.extend([], $.fn.magicSuggest.defaults, options, def));
        cntr.data('magicSuggest', field);
        field.container.data('magicSuggest', field);
      });
  
      if (obj.size() === 1) {
        return obj.data('magicSuggest');
      }
  
      return obj;
    };
  
    $.fn.magicSuggest.defaults = {};
  })(jQuery);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/modal/js/modal.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-core/plugins/modal/js/modal.js ***!
    \*******************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  /* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "../../ui-core/node_modules/@babel/runtime/helpers/defineProperty.js");
  /* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "../../ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js");
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "../../ui-core/node_modules/@babel/runtime/helpers/createClass.js");
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js-exposed");
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
  /* harmony import */ var _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utility/js/bootstrap-utils */ "../../ui-core/utility/js/bootstrap-utils.js");
  
  
  
  
  
  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }
  
  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }
  
  /**
   * --------------------------------------------------------------------------
   * Bootstrap (v4.4.1): modal.js
   * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
   * --------------------------------------------------------------------------
   */
  
  
  /**
   * ------------------------------------------------------------------------
   * Constants
   * ------------------------------------------------------------------------
   */
  
  var NAME = 'modal';
  var VERSION = '4.4.1';
  var DATA_KEY = 'bs.modal';
  var EVENT_KEY = ".".concat(DATA_KEY);
  var DATA_API_KEY = '.data-api';
  var JQUERY_NO_CONFLICT = jquery__WEBPACK_IMPORTED_MODULE_4___default.a.fn[NAME];
  var ESCAPE_KEYCODE = 27; // KeyboardEvent.which value for Escape (Esc) key
  
  var Default = {
    backdrop: true,
    keyboard: true,
    focus: true,
    show: true
  };
  var DefaultType = {
    backdrop: '(boolean|string)',
    keyboard: 'boolean',
    focus: 'boolean',
    show: 'boolean'
  };
  var Event = {
    HIDE: "hide".concat(EVENT_KEY),
    HIDE_PREVENTED: "hidePrevented".concat(EVENT_KEY),
    HIDDEN: "hidden".concat(EVENT_KEY),
    SHOW: "show".concat(EVENT_KEY),
    SHOWN: "shown".concat(EVENT_KEY),
    FOCUSIN: "focusin".concat(EVENT_KEY),
    RESIZE: "resize".concat(EVENT_KEY),
    CLICK_DISMISS: "click.dismiss".concat(EVENT_KEY),
    KEYDOWN_DISMISS: "keydown.dismiss".concat(EVENT_KEY),
    MOUSEUP_DISMISS: "mouseup.dismiss".concat(EVENT_KEY),
    MOUSEDOWN_DISMISS: "mousedown.dismiss".concat(EVENT_KEY),
    CLICK_DATA_API: "click".concat(EVENT_KEY).concat(DATA_API_KEY)
  };
  var ClassName = {
    SCROLLABLE: 'modal-dialog-scrollable',
    SCROLLBAR_MEASURER: 'modal-scrollbar-measure',
    BACKDROP: 'modal-backdrop',
    OPEN: 'modal-open',
    FADE: 'fade',
    SHOW: 'in',
    STATIC: 'modal-static'
  };
  var Selector = {
    DIALOG: '.modal-dialog',
    MODAL_BODY: '.modal-body',
    DATA_TOGGLE: '[data-toggle="modal"]',
    DATA_DISMISS: '[data-dismiss="modal"]',
    FIXED_CONTENT: '.fixed-top, .fixed-bottom, .is-fixed, .sticky-top',
    STICKY_CONTENT: '.sticky-top'
  };
  /**
   * ------------------------------------------------------------------------
   * Class Definition
   * ------------------------------------------------------------------------
   */
  
  var Modal = /*#__PURE__*/function () {
    function Modal(element, config) {
      _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this, Modal);
  
      this._config = this._getConfig(config);
      this._element = element;
      this._dialog = element.querySelector(Selector.DIALOG);
      this._backdrop = null;
      this._isShown = false;
      this._isBodyOverflowing = false;
      this._ignoreBackdropClick = false;
      this._isTransitioning = false;
      this._scrollbarWidth = 0;
    } // Getters
  
  
    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(Modal, [{
      key: "toggle",
      // Public
      value: function toggle(relatedTarget) {
        return this._isShown ? this.hide() : this.show(relatedTarget);
      }
    }, {
      key: "show",
      value: function show(relatedTarget) {
        var _this = this;
  
        if (this._isShown || this._isTransitioning) {
          return;
        }
  
        if (jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).hasClass(ClassName.FADE)) {
          this._isTransitioning = true;
        }
  
        var showEvent = jquery__WEBPACK_IMPORTED_MODULE_4___default.a.Event(Event.SHOW, {
          relatedTarget: relatedTarget
        });
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).trigger(showEvent);
  
        if (this._isShown || showEvent.isDefaultPrevented()) {
          return;
        }
  
        this._isShown = true;
  
        this._checkScrollbar();
  
        this._setScrollbar();
  
        this._adjustDialog();
  
        this._setEscapeEvent();
  
        this._setResizeEvent();
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).on(Event.CLICK_DISMISS, Selector.DATA_DISMISS, function (event) {
          return _this.hide(event);
        });
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._dialog).on(Event.MOUSEDOWN_DISMISS, function () {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(_this._element).one(Event.MOUSEUP_DISMISS, function (event) {
            if (jquery__WEBPACK_IMPORTED_MODULE_4___default()(event.target).is(_this._element)) {
              _this._ignoreBackdropClick = true;
            }
          });
        });
  
        this._showBackdrop(function () {
          return _this._showElement(relatedTarget);
        });
      }
    }, {
      key: "hide",
      value: function hide(event) {
        var _this2 = this;
  
        if (event) {
          event.preventDefault();
        }
  
        if (!this._isShown || this._isTransitioning) {
          return;
        }
  
        var hideEvent = jquery__WEBPACK_IMPORTED_MODULE_4___default.a.Event(Event.HIDE);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).trigger(hideEvent);
  
        if (!this._isShown || hideEvent.isDefaultPrevented()) {
          return;
        }
  
        this._isShown = false;
        var transition = jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).hasClass(ClassName.FADE);
  
        if (transition) {
          this._isTransitioning = true;
        }
  
        this._setEscapeEvent();
  
        this._setResizeEvent();
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(document).off(Event.FOCUSIN);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).removeClass(ClassName.SHOW);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).off(Event.CLICK_DISMISS);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._dialog).off(Event.MOUSEDOWN_DISMISS);
  
        if (transition) {
          var transitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getTransitionDurationFromElement(this._element);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].TRANSITION_END, function (event) {
            return _this2._hideModal(event);
          }).emulateTransitionEnd(transitionDuration);
        } else {
          this._hideModal();
        }
      }
    }, {
      key: "dispose",
      value: function dispose() {
        [window, this._element, this._dialog].forEach(function (htmlElement) {
          return jquery__WEBPACK_IMPORTED_MODULE_4___default()(htmlElement).off(EVENT_KEY);
        });
        /**
         * `document` has 2 events `Event.FOCUSIN` and `Event.CLICK_DATA_API`
         * Do not move `document` in `htmlElements` array
         * It will remove `Event.CLICK_DATA_API` event that should remain
         */
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(document).off(Event.FOCUSIN);
        jquery__WEBPACK_IMPORTED_MODULE_4___default.a.removeData(this._element, DATA_KEY);
        this._config = null;
        this._element = null;
        this._dialog = null;
        this._backdrop = null;
        this._isShown = null;
        this._isBodyOverflowing = null;
        this._ignoreBackdropClick = null;
        this._isTransitioning = null;
        this._scrollbarWidth = null;
      }
    }, {
      key: "handleUpdate",
      value: function handleUpdate() {
        this._adjustDialog();
      } // Private
  
    }, {
      key: "_getConfig",
      value: function _getConfig(config) {
        config = _objectSpread(_objectSpread({}, Default), config);
        _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].typeCheckConfig(NAME, config, DefaultType);
        return config;
      }
    }, {
      key: "_triggerBackdropTransition",
      value: function _triggerBackdropTransition() {
        var _this3 = this;
  
        if (this._config.backdrop === 'static') {
          var hideEventPrevented = jquery__WEBPACK_IMPORTED_MODULE_4___default.a.Event(Event.HIDE_PREVENTED);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).trigger(hideEventPrevented);
  
          if (hideEventPrevented.defaultPrevented) {
            return;
          }
  
          this._element.classList.add(ClassName.STATIC);
  
          var modalTransitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getTransitionDurationFromElement(this._element);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].TRANSITION_END, function () {
            _this3._element.classList.remove(ClassName.STATIC);
          }).emulateTransitionEnd(modalTransitionDuration);
  
          this._element.focus();
        } else {
          this.hide();
        }
      }
    }, {
      key: "_showElement",
      value: function _showElement(relatedTarget) {
        var _this4 = this;
  
        var transition = jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).hasClass(ClassName.FADE);
        var modalBody = this._dialog ? this._dialog.querySelector(Selector.MODAL_BODY) : null;
  
        if (!this._element.parentNode || this._element.parentNode.nodeType !== Node.ELEMENT_NODE) {
          // Don't move modal's DOM position
          document.body.appendChild(this._element);
        }
  
        this._element.style.display = 'block';
  
        this._element.removeAttribute('aria-hidden');
  
        this._element.setAttribute('aria-modal', true);
  
        if (jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._dialog).hasClass(ClassName.SCROLLABLE) && modalBody) {
          modalBody.scrollTop = 0;
        } else {
          this._element.scrollTop = 0;
        }
  
        if (transition) {
          _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].reflow(this._element);
        }
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).addClass(ClassName.SHOW);
  
        if (this._config.focus) {
          this._enforceFocus();
        }
  
        var shownEvent = jquery__WEBPACK_IMPORTED_MODULE_4___default.a.Event(Event.SHOWN, {
          relatedTarget: relatedTarget
        });
  
        var transitionComplete = function transitionComplete() {
          if (_this4._config.focus) {
            _this4._element.focus();
          }
  
          _this4._isTransitioning = false;
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(_this4._element).trigger(shownEvent);
        };
  
        if (transition) {
          var transitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getTransitionDurationFromElement(this._dialog);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._dialog).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].TRANSITION_END, transitionComplete).emulateTransitionEnd(transitionDuration);
        } else {
          transitionComplete();
        }
      }
    }, {
      key: "_enforceFocus",
      value: function _enforceFocus() {
        var _this5 = this;
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(document).off(Event.FOCUSIN) // Guard against infinite focus loop
        .on(Event.FOCUSIN, function (event) {
          if (document !== event.target && _this5._element !== event.target && jquery__WEBPACK_IMPORTED_MODULE_4___default()(_this5._element).has(event.target).length === 0) {
            _this5._element.focus();
          }
        });
      }
    }, {
      key: "_setEscapeEvent",
      value: function _setEscapeEvent() {
        var _this6 = this;
  
        if (this._isShown && this._config.keyboard) {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).on(Event.KEYDOWN_DISMISS, function (event) {
            if (event.which === ESCAPE_KEYCODE) {
              _this6._triggerBackdropTransition();
            }
          });
        } else if (!this._isShown) {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).off(Event.KEYDOWN_DISMISS);
        }
      }
    }, {
      key: "_setResizeEvent",
      value: function _setResizeEvent() {
        var _this7 = this;
  
        if (this._isShown) {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(window).on(Event.RESIZE, function (event) {
            return _this7.handleUpdate(event);
          });
        } else {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(window).off(Event.RESIZE);
        }
      }
    }, {
      key: "_hideModal",
      value: function _hideModal() {
        var _this8 = this;
  
        this._element.style.display = 'none';
  
        this._element.setAttribute('aria-hidden', true);
  
        this._element.removeAttribute('aria-modal');
  
        this._isTransitioning = false;
  
        this._showBackdrop(function () {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).removeClass(ClassName.OPEN);
  
          _this8._resetAdjustments();
  
          _this8._resetScrollbar();
  
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(_this8._element).trigger(Event.HIDDEN);
        });
      }
    }, {
      key: "_removeBackdrop",
      value: function _removeBackdrop() {
        if (this._backdrop) {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).remove();
          this._backdrop = null;
        }
      }
    }, {
      key: "_showBackdrop",
      value: function _showBackdrop(callback) {
        var _this9 = this;
  
        var animate = jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).hasClass(ClassName.FADE) ? ClassName.FADE : '';
  
        if (this._isShown && this._config.backdrop) {
          this._backdrop = document.createElement('div');
          this._backdrop.className = ClassName.BACKDROP;
  
          if (animate) {
            this._backdrop.classList.add(animate);
          }
  
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).appendTo(document.body);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).on(Event.CLICK_DISMISS, function (event) {
            if (_this9._ignoreBackdropClick) {
              _this9._ignoreBackdropClick = false;
              return;
            }
  
            if (event.target !== event.currentTarget) {
              return;
            }
  
            _this9._triggerBackdropTransition();
          });
  
          if (animate) {
            _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].reflow(this._backdrop);
          }
  
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).addClass(ClassName.SHOW);
  
          if (!callback) {
            return;
          }
  
          if (!animate) {
            callback();
            return;
          }
  
          var backdropTransitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getTransitionDurationFromElement(this._backdrop);
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].TRANSITION_END, callback).emulateTransitionEnd(backdropTransitionDuration);
        } else if (!this._isShown && this._backdrop) {
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).removeClass(ClassName.SHOW);
  
          var callbackRemove = function callbackRemove() {
            _this9._removeBackdrop();
  
            if (callback) {
              callback();
            }
          };
  
          if (jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._element).hasClass(ClassName.FADE)) {
            var _backdropTransitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getTransitionDurationFromElement(this._backdrop);
  
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(this._backdrop).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].TRANSITION_END, callbackRemove).emulateTransitionEnd(_backdropTransitionDuration);
          } else {
            callbackRemove();
          }
        } else if (callback) {
          callback();
        }
      } // ----------------------------------------------------------------------
      // the following methods are used to handle overflowing modals
      // todo (fat): these should probably be refactored out of modal.js
      // ----------------------------------------------------------------------
  
    }, {
      key: "_adjustDialog",
      value: function _adjustDialog() {
        var isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight;
  
        if (!this._isBodyOverflowing && isModalOverflowing) {
          this._element.style.paddingLeft = "".concat(this._scrollbarWidth, "px");
        }
  
        if (this._isBodyOverflowing && !isModalOverflowing) {
          this._element.style.paddingRight = "".concat(this._scrollbarWidth, "px");
        }
      }
    }, {
      key: "_resetAdjustments",
      value: function _resetAdjustments() {
        this._element.style.paddingLeft = '';
        this._element.style.paddingRight = '';
      }
    }, {
      key: "_checkScrollbar",
      value: function _checkScrollbar() {
        var rect = document.body.getBoundingClientRect();
        this._isBodyOverflowing = rect.left + rect.right < window.innerWidth;
        this._scrollbarWidth = this._getScrollbarWidth();
      }
    }, {
      key: "_setScrollbar",
      value: function _setScrollbar() {
        var _this10 = this;
  
        if (this._isBodyOverflowing) {
          // Note: DOMNode.style.paddingRight returns the actual value or '' if not set
          //   while $(DOMNode).css('padding-right') returns the calculated value or 0 if not set
          var fixedContent = [].slice.call(document.querySelectorAll(Selector.FIXED_CONTENT));
          var stickyContent = [].slice.call(document.querySelectorAll(Selector.STICKY_CONTENT)); // Adjust fixed content padding
  
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(fixedContent).each(function (index, element) {
            var actualPadding = element.style.paddingRight;
            var calculatedPadding = jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).css('padding-right');
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).data('padding-right', actualPadding).css('padding-right', "".concat(parseFloat(calculatedPadding) + _this10._scrollbarWidth, "px"));
          }); // Adjust sticky content margin
  
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(stickyContent).each(function (index, element) {
            var actualMargin = element.style.marginRight;
            var calculatedMargin = jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).css('margin-right');
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).data('margin-right', actualMargin).css('margin-right', "".concat(parseFloat(calculatedMargin) - _this10._scrollbarWidth, "px"));
          }); // Adjust body padding
  
          var actualPadding = document.body.style.paddingRight;
          var calculatedPadding = jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).css('padding-right');
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).data('padding-right', actualPadding).css('padding-right', "".concat(parseFloat(calculatedPadding) + this._scrollbarWidth, "px"));
        }
  
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).addClass(ClassName.OPEN);
      }
    }, {
      key: "_resetScrollbar",
      value: function _resetScrollbar() {
        // Restore fixed content padding
        var fixedContent = [].slice.call(document.querySelectorAll(Selector.FIXED_CONTENT));
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(fixedContent).each(function (index, element) {
          var padding = jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).data('padding-right');
          jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).removeData('padding-right');
          element.style.paddingRight = padding ? padding : '';
        }); // Restore sticky content
  
        var elements = [].slice.call(document.querySelectorAll("".concat(Selector.STICKY_CONTENT)));
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(elements).each(function (index, element) {
          var margin = jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).data('margin-right');
  
          if (typeof margin !== 'undefined') {
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(element).css('margin-right', margin).removeData('margin-right');
          }
        }); // Restore body padding
  
        var padding = jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).data('padding-right');
        jquery__WEBPACK_IMPORTED_MODULE_4___default()(document.body).removeData('padding-right');
        document.body.style.paddingRight = padding ? padding : '';
      }
    }, {
      key: "_getScrollbarWidth",
      value: function _getScrollbarWidth() {
        // thx d.walsh
        var scrollDiv = document.createElement('div');
        scrollDiv.className = ClassName.SCROLLBAR_MEASURER;
        document.body.appendChild(scrollDiv);
        var scrollbarWidth = scrollDiv.getBoundingClientRect().width - scrollDiv.clientWidth;
        document.body.removeChild(scrollDiv);
        return scrollbarWidth;
      } // Static
  
    }], [{
      key: "_jQueryInterface",
      value: function _jQueryInterface(config, relatedTarget) {
        return this.each(function () {
          var data = jquery__WEBPACK_IMPORTED_MODULE_4___default()(this).data(DATA_KEY);
  
          var _config = _objectSpread(_objectSpread(_objectSpread({}, Default), jquery__WEBPACK_IMPORTED_MODULE_4___default()(this).data()), _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(config) === 'object' && config ? config : {});
  
          if (!data) {
            data = new Modal(this, _config);
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(this).data(DATA_KEY, data);
          }
  
          if (typeof config === 'string') {
            if (typeof data[config] === 'undefined') {
              throw new TypeError("No method named \"".concat(config, "\""));
            }
  
            data[config](relatedTarget);
          } else if (_config.show) {
            data.show(relatedTarget);
          }
        });
      }
    }, {
      key: "VERSION",
      get: function get() {
        return VERSION;
      }
    }, {
      key: "Default",
      get: function get() {
        return Default;
      }
    }]);
  
    return Modal;
  }();
  /**
   * ------------------------------------------------------------------------
   * Data Api implementation
   * ------------------------------------------------------------------------
   */
  
  
  jquery__WEBPACK_IMPORTED_MODULE_4___default()(document).on(Event.CLICK_DATA_API, Selector.DATA_TOGGLE, function (event) {
    var _this11 = this;
  
    var target;
    var selector = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getSelectorFromElement(this);
  
    if (selector) {
      target = document.querySelector(selector);
    }
  
    var config = jquery__WEBPACK_IMPORTED_MODULE_4___default()(target).data(DATA_KEY) ? 'toggle' : _objectSpread(_objectSpread({}, jquery__WEBPACK_IMPORTED_MODULE_4___default()(target).data()), jquery__WEBPACK_IMPORTED_MODULE_4___default()(this).data());
  
    if (this.tagName === 'A' || this.tagName === 'AREA') {
      event.preventDefault();
    }
  
    var $target = jquery__WEBPACK_IMPORTED_MODULE_4___default()(target).one(Event.SHOW, function (showEvent) {
      if (showEvent.isDefaultPrevented()) {
        // Only register focus restorer if modal will actually get shown
        return;
      }
  
      $target.one(Event.HIDDEN, function () {
        if (jquery__WEBPACK_IMPORTED_MODULE_4___default()(_this11).is(':visible')) {
          _this11.focus();
        }
      });
    });
  
    Modal._jQueryInterface.call(jquery__WEBPACK_IMPORTED_MODULE_4___default()(target), config, this);
  });
  /**
   * ------------------------------------------------------------------------
   * jQuery
   * ------------------------------------------------------------------------
   */
  
  jquery__WEBPACK_IMPORTED_MODULE_4___default.a.fn[NAME] = Modal._jQueryInterface;
  jquery__WEBPACK_IMPORTED_MODULE_4___default.a.fn[NAME].Constructor = Modal;
  
  jquery__WEBPACK_IMPORTED_MODULE_4___default.a.fn[NAME].noConflict = function () {
    jquery__WEBPACK_IMPORTED_MODULE_4___default.a.fn[NAME] = JQUERY_NO_CONFLICT;
    return Modal._jQueryInterface;
  };
  
  /* harmony default export */ __webpack_exports__["default"] = (Modal);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/owl-carousel/js/owl.carousel.min.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/owl-carousel/js/owl.carousel.min.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /**
   * Owl Carousel v2.3.4
   * Copyright 2013-2018 David Deutsch
   * Licensed under: SEE LICENSE IN https://github.com/OwlCarousel2/OwlCarousel2/blob/master/LICENSE
   */
  !function (a, b, c, d) {
    function e(b, c) {
      this.settings = null, this.options = a.extend({}, e.Defaults, c), this.$element = a(b), this._handlers = {}, this._plugins = {}, this._supress = {}, this._current = null, this._speed = null, this._coordinates = [], this._breakpoint = null, this._width = null, this._items = [], this._clones = [], this._mergers = [], this._widths = [], this._invalidated = {}, this._pipe = [], this._drag = {
        time: null,
        target: null,
        pointer: null,
        stage: {
          start: null,
          current: null
        },
        direction: null
      }, this._states = {
        current: {},
        tags: {
          initializing: ["busy"],
          animating: ["busy"],
          dragging: ["interacting"]
        }
      }, a.each(["onResize", "onThrottledResize"], a.proxy(function (b, c) {
        this._handlers[c] = a.proxy(this[c], this);
      }, this)), a.each(e.Plugins, a.proxy(function (a, b) {
        this._plugins[a.charAt(0).toLowerCase() + a.slice(1)] = new b(this);
      }, this)), a.each(e.Workers, a.proxy(function (b, c) {
        this._pipe.push({
          filter: c.filter,
          run: a.proxy(c.run, this)
        });
      }, this)), this.setup(), this.initialize();
    }
  
    e.Defaults = {
      items: 3,
      loop: !1,
      center: !1,
      rewind: !1,
      checkVisibility: !0,
      mouseDrag: !0,
      touchDrag: !0,
      pullDrag: !0,
      freeDrag: !1,
      margin: 0,
      stagePadding: 0,
      merge: !1,
      mergeFit: !0,
      autoWidth: !1,
      startPosition: 0,
      rtl: !1,
      smartSpeed: 250,
      fluidSpeed: !1,
      dragEndSpeed: !1,
      responsive: {},
      responsiveRefreshRate: 200,
      responsiveBaseElement: b,
      fallbackEasing: "swing",
      slideTransition: "",
      info: !1,
      nestedItemSelector: !1,
      itemElement: "div",
      stageElement: "div",
      refreshClass: "owl-refresh",
      loadedClass: "owl-loaded",
      loadingClass: "owl-loading",
      rtlClass: "owl-rtl",
      responsiveClass: "owl-responsive",
      dragClass: "owl-drag",
      itemClass: "owl-item",
      stageClass: "owl-stage",
      stageOuterClass: "owl-stage-outer",
      grabClass: "owl-grab"
    }, e.Width = {
      Default: "default",
      Inner: "inner",
      Outer: "outer"
    }, e.Type = {
      Event: "event",
      State: "state"
    }, e.Plugins = {}, e.Workers = [{
      filter: ["width", "settings"],
      run: function run() {
        this._width = this.$element.width();
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run(a) {
        a.current = this._items && this._items[this.relative(this._current)];
      }
    }, {
      filter: ["items", "settings"],
      run: function run() {
        this.$stage.children(".cloned").remove();
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run(a) {
        var b = this.settings.margin || "",
            c = !this.settings.autoWidth,
            d = this.settings.rtl,
            e = {
          width: "auto",
          "margin-left": d ? b : "",
          "margin-right": d ? "" : b
        };
        !c && this.$stage.children().css(e), a.css = e;
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run(a) {
        var b = (this.width() / this.settings.items).toFixed(3) - this.settings.margin,
            c = null,
            d = this._items.length,
            e = !this.settings.autoWidth,
            f = [];
  
        for (a.items = {
          merge: !1,
          width: b
        }; d--;) {
          c = this._mergers[d], c = this.settings.mergeFit && Math.min(c, this.settings.items) || c, a.items.merge = c > 1 || a.items.merge, f[d] = e ? b * c : this._items[d].width();
        }
  
        this._widths = f;
      }
    }, {
      filter: ["items", "settings"],
      run: function run() {
        var b = [],
            c = this._items,
            d = this.settings,
            e = Math.max(2 * d.items, 4),
            f = 2 * Math.ceil(c.length / 2),
            g = d.loop && c.length ? d.rewind ? e : Math.max(e, f) : 0,
            h = "",
            i = "";
  
        for (g /= 2; g > 0;) {
          b.push(this.normalize(b.length / 2, !0)), h += c[b[b.length - 1]][0].outerHTML, b.push(this.normalize(c.length - 1 - (b.length - 1) / 2, !0)), i = c[b[b.length - 1]][0].outerHTML + i, g -= 1;
        }
  
        this._clones = b, a(h).addClass("cloned").appendTo(this.$stage), a(i).addClass("cloned").prependTo(this.$stage);
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run() {
        for (var a = this.settings.rtl ? 1 : -1, b = this._clones.length + this._items.length, c = -1, d = 0, e = 0, f = []; ++c < b;) {
          d = f[c - 1] || 0, e = this._widths[this.relative(c)] + this.settings.margin, f.push(d + e * a);
        }
  
        this._coordinates = f;
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run() {
        var a = this.settings.stagePadding,
            b = this._coordinates,
            c = {
          width: Math.ceil(Math.abs(b[b.length - 1])) + 2 * a,
          "padding-left": a || "",
          "padding-right": a || ""
        };
        this.$stage.css(c);
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run(a) {
        var b = this._coordinates.length,
            c = !this.settings.autoWidth,
            d = this.$stage.children();
        if (c && a.items.merge) for (; b--;) {
          a.css.width = this._widths[this.relative(b)], d.eq(b).css(a.css);
        } else c && (a.css.width = a.items.width, d.css(a.css));
      }
    }, {
      filter: ["items"],
      run: function run() {
        this._coordinates.length < 1 && this.$stage.removeAttr("style");
      }
    }, {
      filter: ["width", "items", "settings"],
      run: function run(a) {
        a.current = a.current ? this.$stage.children().index(a.current) : 0, a.current = Math.max(this.minimum(), Math.min(this.maximum(), a.current)), this.reset(a.current);
      }
    }, {
      filter: ["position"],
      run: function run() {
        this.animate(this.coordinates(this._current));
      }
    }, {
      filter: ["width", "position", "items", "settings"],
      run: function run() {
        var a,
            b,
            c,
            d,
            e = this.settings.rtl ? 1 : -1,
            f = 2 * this.settings.stagePadding,
            g = this.coordinates(this.current()) + f,
            h = g + this.width() * e,
            i = [];
  
        for (c = 0, d = this._coordinates.length; c < d; c++) {
          a = this._coordinates[c - 1] || 0, b = Math.abs(this._coordinates[c]) + f * e, (this.op(a, "<=", g) && this.op(a, ">", h) || this.op(b, "<", g) && this.op(b, ">", h)) && i.push(c);
        }
  
        this.$stage.children(".active").removeClass("active"), this.$stage.children(":eq(" + i.join("), :eq(") + ")").addClass("active"), this.$stage.children(".center").removeClass("center"), this.settings.center && this.$stage.children().eq(this.current()).addClass("center");
      }
    }], e.prototype.initializeStage = function () {
      this.$stage = this.$element.find("." + this.settings.stageClass), this.$stage.length || (this.$element.addClass(this.options.loadingClass), this.$stage = a("<" + this.settings.stageElement + ">", {
        "class": this.settings.stageClass
      }).wrap(a("<div/>", {
        "class": this.settings.stageOuterClass
      })), this.$element.append(this.$stage.parent()));
    }, e.prototype.initializeItems = function () {
      var b = this.$element.find(".owl-item");
      if (b.length) return this._items = b.get().map(function (b) {
        return a(b);
      }), this._mergers = this._items.map(function () {
        return 1;
      }), void this.refresh();
      this.replace(this.$element.children().not(this.$stage.parent())), this.isVisible() ? this.refresh() : this.invalidate("width"), this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass);
    }, e.prototype.initialize = function () {
      if (this.enter("initializing"), this.trigger("initialize"), this.$element.toggleClass(this.settings.rtlClass, this.settings.rtl), this.settings.autoWidth && !this.is("pre-loading")) {
        var a, b, c;
        a = this.$element.find("img"), b = this.settings.nestedItemSelector ? "." + this.settings.nestedItemSelector : d, c = this.$element.children(b).width(), a.length && c <= 0 && this.preloadAutoWidthImages(a);
      }
  
      this.initializeStage(), this.initializeItems(), this.registerEventHandlers(), this.leave("initializing"), this.trigger("initialized");
    }, e.prototype.isVisible = function () {
      return !this.settings.checkVisibility || this.$element.is(":visible");
    }, e.prototype.setup = function () {
      var b = this.viewport(),
          c = this.options.responsive,
          d = -1,
          e = null;
      c ? (a.each(c, function (a) {
        a <= b && a > d && (d = Number(a));
      }), e = a.extend({}, this.options, c[d]), "function" == typeof e.stagePadding && (e.stagePadding = e.stagePadding()), delete e.responsive, e.responsiveClass && this.$element.attr("class", this.$element.attr("class").replace(new RegExp("(" + this.options.responsiveClass + "-)\\S+\\s", "g"), "$1" + d))) : e = a.extend({}, this.options), this.trigger("change", {
        property: {
          name: "settings",
          value: e
        }
      }), this._breakpoint = d, this.settings = e, this.invalidate("settings"), this.trigger("changed", {
        property: {
          name: "settings",
          value: this.settings
        }
      });
    }, e.prototype.optionsLogic = function () {
      this.settings.autoWidth && (this.settings.stagePadding = !1, this.settings.merge = !1);
    }, e.prototype.prepare = function (b) {
      var c = this.trigger("prepare", {
        content: b
      });
      return c.data || (c.data = a("<" + this.settings.itemElement + "/>").addClass(this.options.itemClass).append(b)), this.trigger("prepared", {
        content: c.data
      }), c.data;
    }, e.prototype.update = function () {
      for (var b = 0, c = this._pipe.length, d = a.proxy(function (a) {
        return this[a];
      }, this._invalidated), e = {}; b < c;) {
        (this._invalidated.all || a.grep(this._pipe[b].filter, d).length > 0) && this._pipe[b].run(e), b++;
      }
  
      this._invalidated = {}, !this.is("valid") && this.enter("valid");
    }, e.prototype.width = function (a) {
      switch (a = a || e.Width.Default) {
        case e.Width.Inner:
        case e.Width.Outer:
          return this._width;
  
        default:
          return this._width - 2 * this.settings.stagePadding + this.settings.margin;
      }
    }, e.prototype.refresh = function () {
      this.enter("refreshing"), this.trigger("refresh"), this.setup(), this.optionsLogic(), this.$element.addClass(this.options.refreshClass), this.update(), this.$element.removeClass(this.options.refreshClass), this.leave("refreshing"), this.trigger("refreshed");
    }, e.prototype.onThrottledResize = function () {
      b.clearTimeout(this.resizeTimer), this.resizeTimer = b.setTimeout(this._handlers.onResize, this.settings.responsiveRefreshRate);
    }, e.prototype.onResize = function () {
      return !!this._items.length && this._width !== this.$element.width() && !!this.isVisible() && (this.enter("resizing"), this.trigger("resize").isDefaultPrevented() ? (this.leave("resizing"), !1) : (this.invalidate("width"), this.refresh(), this.leave("resizing"), void this.trigger("resized")));
    }, e.prototype.registerEventHandlers = function () {
      a.support.transition && this.$stage.on(a.support.transition.end + ".owl.core", a.proxy(this.onTransitionEnd, this)), !1 !== this.settings.responsive && this.on(b, "resize", this._handlers.onThrottledResize), this.settings.mouseDrag && (this.$element.addClass(this.options.dragClass), this.$stage.on("mousedown.owl.core", a.proxy(this.onDragStart, this)), this.$stage.on("dragstart.owl.core selectstart.owl.core", function () {
        return !1;
      })), this.settings.touchDrag && (this.$stage.on("touchstart.owl.core", a.proxy(this.onDragStart, this)), this.$stage.on("touchcancel.owl.core", a.proxy(this.onDragEnd, this)));
    }, e.prototype.onDragStart = function (b) {
      var d = null;
      3 !== b.which && (a.support.transform ? (d = this.$stage.css("transform").replace(/.*\(|\)| /g, "").split(","), d = {
        x: d[16 === d.length ? 12 : 4],
        y: d[16 === d.length ? 13 : 5]
      }) : (d = this.$stage.position(), d = {
        x: this.settings.rtl ? d.left + this.$stage.width() - this.width() + this.settings.margin : d.left,
        y: d.top
      }), this.is("animating") && (a.support.transform ? this.animate(d.x) : this.$stage.stop(), this.invalidate("position")), this.$element.toggleClass(this.options.grabClass, "mousedown" === b.type), this.speed(0), this._drag.time = new Date().getTime(), this._drag.target = a(b.target), this._drag.stage.start = d, this._drag.stage.current = d, this._drag.pointer = this.pointer(b), a(c).on("mouseup.owl.core touchend.owl.core", a.proxy(this.onDragEnd, this)), a(c).one("mousemove.owl.core touchmove.owl.core", a.proxy(function (b) {
        var d = this.difference(this._drag.pointer, this.pointer(b));
        a(c).on("mousemove.owl.core touchmove.owl.core", a.proxy(this.onDragMove, this)), Math.abs(d.x) < Math.abs(d.y) && this.is("valid") || (b.preventDefault(), this.enter("dragging"), this.trigger("drag"));
      }, this)));
    }, e.prototype.onDragMove = function (a) {
      var b = null,
          c = null,
          d = null,
          e = this.difference(this._drag.pointer, this.pointer(a)),
          f = this.difference(this._drag.stage.start, e);
      this.is("dragging") && (a.preventDefault(), this.settings.loop ? (b = this.coordinates(this.minimum()), c = this.coordinates(this.maximum() + 1) - b, f.x = ((f.x - b) % c + c) % c + b) : (b = this.settings.rtl ? this.coordinates(this.maximum()) : this.coordinates(this.minimum()), c = this.settings.rtl ? this.coordinates(this.minimum()) : this.coordinates(this.maximum()), d = this.settings.pullDrag ? -1 * e.x / 5 : 0, f.x = Math.max(Math.min(f.x, b + d), c + d)), this._drag.stage.current = f, this.animate(f.x));
    }, e.prototype.onDragEnd = function (b) {
      var d = this.difference(this._drag.pointer, this.pointer(b)),
          e = this._drag.stage.current,
          f = d.x > 0 ^ this.settings.rtl ? "left" : "right";
      a(c).off(".owl.core"), this.$element.removeClass(this.options.grabClass), (0 !== d.x && this.is("dragging") || !this.is("valid")) && (this.speed(this.settings.dragEndSpeed || this.settings.smartSpeed), this.current(this.closest(e.x, 0 !== d.x ? f : this._drag.direction)), this.invalidate("position"), this.update(), this._drag.direction = f, (Math.abs(d.x) > 3 || new Date().getTime() - this._drag.time > 300) && this._drag.target.one("click.owl.core", function () {
        return !1;
      })), this.is("dragging") && (this.leave("dragging"), this.trigger("dragged"));
    }, e.prototype.closest = function (b, c) {
      var e = -1,
          f = 30,
          g = this.width(),
          h = this.coordinates();
      return this.settings.freeDrag || a.each(h, a.proxy(function (a, i) {
        return "left" === c && b > i - f && b < i + f ? e = a : "right" === c && b > i - g - f && b < i - g + f ? e = a + 1 : this.op(b, "<", i) && this.op(b, ">", h[a + 1] !== d ? h[a + 1] : i - g) && (e = "left" === c ? a + 1 : a), -1 === e;
      }, this)), this.settings.loop || (this.op(b, ">", h[this.minimum()]) ? e = b = this.minimum() : this.op(b, "<", h[this.maximum()]) && (e = b = this.maximum())), e;
    }, e.prototype.animate = function (b) {
      var c = this.speed() > 0;
      this.is("animating") && this.onTransitionEnd(), c && (this.enter("animating"), this.trigger("translate")), a.support.transform3d && a.support.transition ? this.$stage.css({
        transform: "translate3d(" + b + "px,0px,0px)",
        transition: this.speed() / 1e3 + "s" + (this.settings.slideTransition ? " " + this.settings.slideTransition : "")
      }) : c ? this.$stage.animate({
        left: b + "px"
      }, this.speed(), this.settings.fallbackEasing, a.proxy(this.onTransitionEnd, this)) : this.$stage.css({
        left: b + "px"
      });
    }, e.prototype.is = function (a) {
      return this._states.current[a] && this._states.current[a] > 0;
    }, e.prototype.current = function (a) {
      if (a === d) return this._current;
      if (0 === this._items.length) return d;
  
      if (a = this.normalize(a), this._current !== a) {
        var b = this.trigger("change", {
          property: {
            name: "position",
            value: a
          }
        });
        b.data !== d && (a = this.normalize(b.data)), this._current = a, this.invalidate("position"), this.trigger("changed", {
          property: {
            name: "position",
            value: this._current
          }
        });
      }
  
      return this._current;
    }, e.prototype.invalidate = function (b) {
      return "string" === a.type(b) && (this._invalidated[b] = !0, this.is("valid") && this.leave("valid")), a.map(this._invalidated, function (a, b) {
        return b;
      });
    }, e.prototype.reset = function (a) {
      (a = this.normalize(a)) !== d && (this._speed = 0, this._current = a, this.suppress(["translate", "translated"]), this.animate(this.coordinates(a)), this.release(["translate", "translated"]));
    }, e.prototype.normalize = function (a, b) {
      var c = this._items.length,
          e = b ? 0 : this._clones.length;
      return !this.isNumeric(a) || c < 1 ? a = d : (a < 0 || a >= c + e) && (a = ((a - e / 2) % c + c) % c + e / 2), a;
    }, e.prototype.relative = function (a) {
      return a -= this._clones.length / 2, this.normalize(a, !0);
    }, e.prototype.maximum = function (a) {
      var b,
          c,
          d,
          e = this.settings,
          f = this._coordinates.length;
      if (e.loop) f = this._clones.length / 2 + this._items.length - 1;else if (e.autoWidth || e.merge) {
        if (b = this._items.length) for (c = this._items[--b].width(), d = this.$element.width(); b-- && !((c += this._items[b].width() + this.settings.margin) > d);) {
          ;
        }
        f = b + 1;
      } else f = e.center ? this._items.length - 1 : this._items.length - e.items;
      return a && (f -= this._clones.length / 2), Math.max(f, 0);
    }, e.prototype.minimum = function (a) {
      return a ? 0 : this._clones.length / 2;
    }, e.prototype.items = function (a) {
      return a === d ? this._items.slice() : (a = this.normalize(a, !0), this._items[a]);
    }, e.prototype.mergers = function (a) {
      return a === d ? this._mergers.slice() : (a = this.normalize(a, !0), this._mergers[a]);
    }, e.prototype.clones = function (b) {
      var c = this._clones.length / 2,
          e = c + this._items.length,
          f = function f(a) {
        return a % 2 == 0 ? e + a / 2 : c - (a + 1) / 2;
      };
  
      return b === d ? a.map(this._clones, function (a, b) {
        return f(b);
      }) : a.map(this._clones, function (a, c) {
        return a === b ? f(c) : null;
      });
    }, e.prototype.speed = function (a) {
      return a !== d && (this._speed = a), this._speed;
    }, e.prototype.coordinates = function (b) {
      var c,
          e = 1,
          f = b - 1;
      return b === d ? a.map(this._coordinates, a.proxy(function (a, b) {
        return this.coordinates(b);
      }, this)) : (this.settings.center ? (this.settings.rtl && (e = -1, f = b + 1), c = this._coordinates[b], c += (this.width() - c + (this._coordinates[f] || 0)) / 2 * e) : c = this._coordinates[f] || 0, c = Math.ceil(c));
    }, e.prototype.duration = function (a, b, c) {
      return 0 === c ? 0 : Math.min(Math.max(Math.abs(b - a), 1), 6) * Math.abs(c || this.settings.smartSpeed);
    }, e.prototype.to = function (a, b) {
      var c = this.current(),
          d = null,
          e = a - this.relative(c),
          f = (e > 0) - (e < 0),
          g = this._items.length,
          h = this.minimum(),
          i = this.maximum();
      this.settings.loop ? (!this.settings.rewind && Math.abs(e) > g / 2 && (e += -1 * f * g), a = c + e, (d = ((a - h) % g + g) % g + h) !== a && d - e <= i && d - e > 0 && (c = d - e, a = d, this.reset(c))) : this.settings.rewind ? (i += 1, a = (a % i + i) % i) : a = Math.max(h, Math.min(i, a)), this.speed(this.duration(c, a, b)), this.current(a), this.isVisible() && this.update();
    }, e.prototype.next = function (a) {
      a = a || !1, this.to(this.relative(this.current()) + 1, a);
    }, e.prototype.prev = function (a) {
      a = a || !1, this.to(this.relative(this.current()) - 1, a);
    }, e.prototype.onTransitionEnd = function (a) {
      if (a !== d && (a.stopPropagation(), (a.target || a.srcElement || a.originalTarget) !== this.$stage.get(0))) return !1;
      this.leave("animating"), this.trigger("translated");
    }, e.prototype.viewport = function () {
      var d;
      return this.options.responsiveBaseElement !== b ? d = a(this.options.responsiveBaseElement).width() : b.innerWidth ? d = b.innerWidth : c.documentElement && c.documentElement.clientWidth ? d = c.documentElement.clientWidth : console.warn("Can not detect viewport width."), d;
    }, e.prototype.replace = function (b) {
      this.$stage.empty(), this._items = [], b && (b = b instanceof jQuery ? b : a(b)), this.settings.nestedItemSelector && (b = b.find("." + this.settings.nestedItemSelector)), b.filter(function () {
        return 1 === this.nodeType;
      }).each(a.proxy(function (a, b) {
        b = this.prepare(b), this.$stage.append(b), this._items.push(b), this._mergers.push(1 * b.find("[data-merge]").addBack("[data-merge]").attr("data-merge") || 1);
      }, this)), this.reset(this.isNumeric(this.settings.startPosition) ? this.settings.startPosition : 0), this.invalidate("items");
    }, e.prototype.add = function (b, c) {
      var e = this.relative(this._current);
      c = c === d ? this._items.length : this.normalize(c, !0), b = b instanceof jQuery ? b : a(b), this.trigger("add", {
        content: b,
        position: c
      }), b = this.prepare(b), 0 === this._items.length || c === this._items.length ? (0 === this._items.length && this.$stage.append(b), 0 !== this._items.length && this._items[c - 1].after(b), this._items.push(b), this._mergers.push(1 * b.find("[data-merge]").addBack("[data-merge]").attr("data-merge") || 1)) : (this._items[c].before(b), this._items.splice(c, 0, b), this._mergers.splice(c, 0, 1 * b.find("[data-merge]").addBack("[data-merge]").attr("data-merge") || 1)), this._items[e] && this.reset(this._items[e].index()), this.invalidate("items"), this.trigger("added", {
        content: b,
        position: c
      });
    }, e.prototype.remove = function (a) {
      (a = this.normalize(a, !0)) !== d && (this.trigger("remove", {
        content: this._items[a],
        position: a
      }), this._items[a].remove(), this._items.splice(a, 1), this._mergers.splice(a, 1), this.invalidate("items"), this.trigger("removed", {
        content: null,
        position: a
      }));
    }, e.prototype.preloadAutoWidthImages = function (b) {
      b.each(a.proxy(function (b, c) {
        this.enter("pre-loading"), c = a(c), a(new Image()).one("load", a.proxy(function (a) {
          c.attr("src", a.target.src), c.css("opacity", 1), this.leave("pre-loading"), !this.is("pre-loading") && !this.is("initializing") && this.refresh();
        }, this)).attr("src", c.attr("src") || c.attr("data-src") || c.attr("data-src-retina"));
      }, this));
    }, e.prototype.destroy = function () {
      this.$element.off(".owl.core"), this.$stage.off(".owl.core"), a(c).off(".owl.core"), !1 !== this.settings.responsive && (b.clearTimeout(this.resizeTimer), this.off(b, "resize", this._handlers.onThrottledResize));
  
      for (var d in this._plugins) {
        this._plugins[d].destroy();
      }
  
      this.$stage.children(".cloned").remove(), this.$stage.unwrap(), this.$stage.children().contents().unwrap(), this.$stage.children().unwrap(), this.$stage.remove(), this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class", this.$element.attr("class").replace(new RegExp(this.options.responsiveClass + "-\\S+\\s", "g"), "")).removeData("owl.carousel");
    }, e.prototype.op = function (a, b, c) {
      var d = this.settings.rtl;
  
      switch (b) {
        case "<":
          return d ? a > c : a < c;
  
        case ">":
          return d ? a < c : a > c;
  
        case ">=":
          return d ? a <= c : a >= c;
  
        case "<=":
          return d ? a >= c : a <= c;
      }
    }, e.prototype.on = function (a, b, c, d) {
      a.addEventListener ? a.addEventListener(b, c, d) : a.attachEvent && a.attachEvent("on" + b, c);
    }, e.prototype.off = function (a, b, c, d) {
      a.removeEventListener ? a.removeEventListener(b, c, d) : a.detachEvent && a.detachEvent("on" + b, c);
    }, e.prototype.trigger = function (b, c, d, f, g) {
      var h = {
        item: {
          count: this._items.length,
          index: this.current()
        }
      },
          i = a.camelCase(a.grep(["on", b, d], function (a) {
        return a;
      }).join("-").toLowerCase()),
          j = a.Event([b, "owl", d || "carousel"].join(".").toLowerCase(), a.extend({
        relatedTarget: this
      }, h, c));
      return this._supress[b] || (a.each(this._plugins, function (a, b) {
        b.onTrigger && b.onTrigger(j);
      }), this.register({
        type: e.Type.Event,
        name: b
      }), this.$element.trigger(j), this.settings && "function" == typeof this.settings[i] && this.settings[i].call(this, j)), j;
    }, e.prototype.enter = function (b) {
      a.each([b].concat(this._states.tags[b] || []), a.proxy(function (a, b) {
        this._states.current[b] === d && (this._states.current[b] = 0), this._states.current[b]++;
      }, this));
    }, e.prototype.leave = function (b) {
      a.each([b].concat(this._states.tags[b] || []), a.proxy(function (a, b) {
        this._states.current[b]--;
      }, this));
    }, e.prototype.register = function (b) {
      if (b.type === e.Type.Event) {
        if (a.event.special[b.name] || (a.event.special[b.name] = {}), !a.event.special[b.name].owl) {
          var c = a.event.special[b.name]._default;
          a.event.special[b.name]._default = function (a) {
            return !c || !c.apply || a.namespace && -1 !== a.namespace.indexOf("owl") ? a.namespace && a.namespace.indexOf("owl") > -1 : c.apply(this, arguments);
          }, a.event.special[b.name].owl = !0;
        }
      } else b.type === e.Type.State && (this._states.tags[b.name] ? this._states.tags[b.name] = this._states.tags[b.name].concat(b.tags) : this._states.tags[b.name] = b.tags, this._states.tags[b.name] = a.grep(this._states.tags[b.name], a.proxy(function (c, d) {
        return a.inArray(c, this._states.tags[b.name]) === d;
      }, this)));
    }, e.prototype.suppress = function (b) {
      a.each(b, a.proxy(function (a, b) {
        this._supress[b] = !0;
      }, this));
    }, e.prototype.release = function (b) {
      a.each(b, a.proxy(function (a, b) {
        delete this._supress[b];
      }, this));
    }, e.prototype.pointer = function (a) {
      var c = {
        x: null,
        y: null
      };
      return a = a.originalEvent || a || b.event, a = a.touches && a.touches.length ? a.touches[0] : a.changedTouches && a.changedTouches.length ? a.changedTouches[0] : a, a.pageX ? (c.x = a.pageX, c.y = a.pageY) : (c.x = a.clientX, c.y = a.clientY), c;
    }, e.prototype.isNumeric = function (a) {
      return !isNaN(parseFloat(a));
    }, e.prototype.difference = function (a, b) {
      return {
        x: a.x - b.x,
        y: a.y - b.y
      };
    }, a.fn.owlCarousel = function (b) {
      var c = Array.prototype.slice.call(arguments, 1);
      return this.each(function () {
        var d = a(this),
            f = d.data("owl.carousel");
        f || (f = new e(this, "object" == _typeof(b) && b), d.data("owl.carousel", f), a.each(["next", "prev", "to", "destroy", "refresh", "replace", "add", "remove"], function (b, c) {
          f.register({
            type: e.Type.Event,
            name: c
          }), f.$element.on(c + ".owl.carousel.core", a.proxy(function (a) {
            a.namespace && a.relatedTarget !== this && (this.suppress([c]), f[c].apply(this, [].slice.call(arguments, 1)), this.release([c]));
          }, f));
        })), "string" == typeof b && "_" !== b.charAt(0) && f[b].apply(f, c);
      });
    }, a.fn.owlCarousel.Constructor = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(b) {
      this._core = b, this._interval = null, this._visible = null, this._handlers = {
        "initialized.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.autoRefresh && this.watch();
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this._core.$element.on(this._handlers);
    };
  
    e.Defaults = {
      autoRefresh: !0,
      autoRefreshInterval: 500
    }, e.prototype.watch = function () {
      this._interval || (this._visible = this._core.isVisible(), this._interval = b.setInterval(a.proxy(this.refresh, this), this._core.settings.autoRefreshInterval));
    }, e.prototype.refresh = function () {
      this._core.isVisible() !== this._visible && (this._visible = !this._visible, this._core.$element.toggleClass("owl-hidden", !this._visible), this._visible && this._core.invalidate("width") && this._core.refresh());
    }, e.prototype.destroy = function () {
      var a, c;
      b.clearInterval(this._interval);
  
      for (a in this._handlers) {
        this._core.$element.off(a, this._handlers[a]);
      }
  
      for (c in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[c] && (this[c] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.AutoRefresh = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(b) {
      this._core = b, this._loaded = [], this._handlers = {
        "initialized.owl.carousel change.owl.carousel resized.owl.carousel": a.proxy(function (b) {
          if (b.namespace && this._core.settings && this._core.settings.lazyLoad && (b.property && "position" == b.property.name || "initialized" == b.type)) {
            var c = this._core.settings,
                e = c.center && Math.ceil(c.items / 2) || c.items,
                f = c.center && -1 * e || 0,
                g = (b.property && b.property.value !== d ? b.property.value : this._core.current()) + f,
                h = this._core.clones().length,
                i = a.proxy(function (a, b) {
              this.load(b);
            }, this);
  
            for (c.lazyLoadEager > 0 && (e += c.lazyLoadEager, c.loop && (g -= c.lazyLoadEager, e++)); f++ < e;) {
              this.load(h / 2 + this._core.relative(g)), h && a.each(this._core.clones(this._core.relative(g)), i), g++;
            }
          }
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this._core.$element.on(this._handlers);
    };
  
    e.Defaults = {
      lazyLoad: !1,
      lazyLoadEager: 0
    }, e.prototype.load = function (c) {
      var d = this._core.$stage.children().eq(c),
          e = d && d.find(".owl-lazy");
  
      !e || a.inArray(d.get(0), this._loaded) > -1 || (e.each(a.proxy(function (c, d) {
        var e,
            f = a(d),
            g = b.devicePixelRatio > 1 && f.attr("data-src-retina") || f.attr("data-src") || f.attr("data-srcset");
        this._core.trigger("load", {
          element: f,
          url: g
        }, "lazy"), f.is("img") ? f.one("load.owl.lazy", a.proxy(function () {
          f.css("opacity", 1), this._core.trigger("loaded", {
            element: f,
            url: g
          }, "lazy");
        }, this)).attr("src", g) : f.is("source") ? f.one("load.owl.lazy", a.proxy(function () {
          this._core.trigger("loaded", {
            element: f,
            url: g
          }, "lazy");
        }, this)).attr("srcset", g) : (e = new Image(), e.onload = a.proxy(function () {
          f.css({
            "background-image": 'url("' + g + '")',
            opacity: "1"
          }), this._core.trigger("loaded", {
            element: f,
            url: g
          }, "lazy");
        }, this), e.src = g);
      }, this)), this._loaded.push(d.get(0)));
    }, e.prototype.destroy = function () {
      var a, b;
  
      for (a in this.handlers) {
        this._core.$element.off(a, this.handlers[a]);
      }
  
      for (b in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[b] && (this[b] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.Lazy = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(c) {
      this._core = c, this._previousHeight = null, this._handlers = {
        "initialized.owl.carousel refreshed.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.autoHeight && this.update();
        }, this),
        "changed.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.autoHeight && "position" === a.property.name && this.update();
        }, this),
        "loaded.owl.lazy": a.proxy(function (a) {
          a.namespace && this._core.settings.autoHeight && a.element.closest("." + this._core.settings.itemClass).index() === this._core.current() && this.update();
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this._core.$element.on(this._handlers), this._intervalId = null;
      var d = this;
      a(b).on("load", function () {
        d._core.settings.autoHeight && d.update();
      }), a(b).resize(function () {
        d._core.settings.autoHeight && (null != d._intervalId && clearTimeout(d._intervalId), d._intervalId = setTimeout(function () {
          d.update();
        }, 250));
      });
    };
  
    e.Defaults = {
      autoHeight: !1,
      autoHeightClass: "owl-height"
    }, e.prototype.update = function () {
      var b = this._core._current,
          c = b + this._core.settings.items,
          d = this._core.settings.lazyLoad,
          e = this._core.$stage.children().toArray().slice(b, c),
          f = [],
          g = 0;
  
      a.each(e, function (b, c) {
        f.push(a(c).height());
      }), g = Math.max.apply(null, f), g <= 1 && d && this._previousHeight && (g = this._previousHeight), this._previousHeight = g, this._core.$stage.parent().height(g).addClass(this._core.settings.autoHeightClass);
    }, e.prototype.destroy = function () {
      var a, b;
  
      for (a in this._handlers) {
        this._core.$element.off(a, this._handlers[a]);
      }
  
      for (b in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[b] && (this[b] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.AutoHeight = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(b) {
      this._core = b, this._videos = {}, this._playing = null, this._handlers = {
        "initialized.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.register({
            type: "state",
            name: "playing",
            tags: ["interacting"]
          });
        }, this),
        "resize.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.video && this.isInFullScreen() && a.preventDefault();
        }, this),
        "refreshed.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.is("resizing") && this._core.$stage.find(".cloned .owl-video-frame").remove();
        }, this),
        "changed.owl.carousel": a.proxy(function (a) {
          a.namespace && "position" === a.property.name && this._playing && this.stop();
        }, this),
        "prepared.owl.carousel": a.proxy(function (b) {
          if (b.namespace) {
            var c = a(b.content).find(".owl-video");
            c.length && (c.css("display", "none"), this.fetch(c, a(b.content)));
          }
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this._core.$element.on(this._handlers), this._core.$element.on("click.owl.video", ".owl-video-play-icon", a.proxy(function (a) {
        this.play(a);
      }, this));
    };
  
    e.Defaults = {
      video: !1,
      videoHeight: !1,
      videoWidth: !1
    }, e.prototype.fetch = function (a, b) {
      var c = function () {
        return a.attr("data-vimeo-id") ? "vimeo" : a.attr("data-vzaar-id") ? "vzaar" : "youtube";
      }(),
          d = a.attr("data-vimeo-id") || a.attr("data-youtube-id") || a.attr("data-vzaar-id"),
          e = a.attr("data-width") || this._core.settings.videoWidth,
          f = a.attr("data-height") || this._core.settings.videoHeight,
          g = a.attr("href");
  
      if (!g) throw new Error("Missing video URL.");
      if (d = g.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/), d[3].indexOf("youtu") > -1) c = "youtube";else if (d[3].indexOf("vimeo") > -1) c = "vimeo";else {
        if (!(d[3].indexOf("vzaar") > -1)) throw new Error("Video URL not supported.");
        c = "vzaar";
      }
      d = d[6], this._videos[g] = {
        type: c,
        id: d,
        width: e,
        height: f
      }, b.attr("data-video", g), this.thumbnail(a, this._videos[g]);
    }, e.prototype.thumbnail = function (b, c) {
      var d,
          e,
          f,
          g = c.width && c.height ? "width:" + c.width + "px;height:" + c.height + "px;" : "",
          h = b.find("img"),
          i = "src",
          j = "",
          k = this._core.settings,
          l = function l(c) {
        e = '<div class="owl-video-play-icon"></div>', d = k.lazyLoad ? a("<div/>", {
          "class": "owl-video-tn " + j,
          srcType: c
        }) : a("<div/>", {
          "class": "owl-video-tn",
          style: "opacity:1;background-image:url(" + c + ")"
        }), b.after(d), b.after(e);
      };
  
      if (b.wrap(a("<div/>", {
        "class": "owl-video-wrapper",
        style: g
      })), this._core.settings.lazyLoad && (i = "data-src", j = "owl-lazy"), h.length) return l(h.attr(i)), h.remove(), !1;
      "youtube" === c.type ? (f = "//img.youtube.com/vi/" + c.id + "/hqdefault.jpg", l(f)) : "vimeo" === c.type ? a.ajax({
        type: "GET",
        url: "//vimeo.com/api/v2/video/" + c.id + ".json",
        jsonp: "callback",
        dataType: "jsonp",
        success: function success(a) {
          f = a[0].thumbnail_large, l(f);
        }
      }) : "vzaar" === c.type && a.ajax({
        type: "GET",
        url: "//vzaar.com/api/videos/" + c.id + ".json",
        jsonp: "callback",
        dataType: "jsonp",
        success: function success(a) {
          f = a.framegrab_url, l(f);
        }
      });
    }, e.prototype.stop = function () {
      this._core.trigger("stop", null, "video"), this._playing.find(".owl-video-frame").remove(), this._playing.removeClass("owl-video-playing"), this._playing = null, this._core.leave("playing"), this._core.trigger("stopped", null, "video");
    }, e.prototype.play = function (b) {
      var c,
          d = a(b.target),
          e = d.closest("." + this._core.settings.itemClass),
          f = this._videos[e.attr("data-video")],
          g = f.width || "100%",
          h = f.height || this._core.$stage.height();
  
      this._playing || (this._core.enter("playing"), this._core.trigger("play", null, "video"), e = this._core.items(this._core.relative(e.index())), this._core.reset(e.index()), c = a('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>'), c.attr("height", h), c.attr("width", g), "youtube" === f.type ? c.attr("src", "//www.youtube.com/embed/" + f.id + "?autoplay=1&rel=0&v=" + f.id) : "vimeo" === f.type ? c.attr("src", "//player.vimeo.com/video/" + f.id + "?autoplay=1") : "vzaar" === f.type && c.attr("src", "//view.vzaar.com/" + f.id + "/player?autoplay=true"), a(c).wrap('<div class="owl-video-frame" />').insertAfter(e.find(".owl-video")), this._playing = e.addClass("owl-video-playing"));
    }, e.prototype.isInFullScreen = function () {
      var b = c.fullscreenElement || c.mozFullScreenElement || c.webkitFullscreenElement;
      return b && a(b).parent().hasClass("owl-video-frame");
    }, e.prototype.destroy = function () {
      var a, b;
  
      this._core.$element.off("click.owl.video");
  
      for (a in this._handlers) {
        this._core.$element.off(a, this._handlers[a]);
      }
  
      for (b in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[b] && (this[b] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.Video = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(b) {
      this.core = b, this.core.options = a.extend({}, e.Defaults, this.core.options), this.swapping = !0, this.previous = d, this.next = d, this.handlers = {
        "change.owl.carousel": a.proxy(function (a) {
          a.namespace && "position" == a.property.name && (this.previous = this.core.current(), this.next = a.property.value);
        }, this),
        "drag.owl.carousel dragged.owl.carousel translated.owl.carousel": a.proxy(function (a) {
          a.namespace && (this.swapping = "translated" == a.type);
        }, this),
        "translate.owl.carousel": a.proxy(function (a) {
          a.namespace && this.swapping && (this.core.options.animateOut || this.core.options.animateIn) && this.swap();
        }, this)
      }, this.core.$element.on(this.handlers);
    };
  
    e.Defaults = {
      animateOut: !1,
      animateIn: !1
    }, e.prototype.swap = function () {
      if (1 === this.core.settings.items && a.support.animation && a.support.transition) {
        this.core.speed(0);
        var b,
            c = a.proxy(this.clear, this),
            d = this.core.$stage.children().eq(this.previous),
            e = this.core.$stage.children().eq(this.next),
            f = this.core.settings.animateIn,
            g = this.core.settings.animateOut;
        this.core.current() !== this.previous && (g && (b = this.core.coordinates(this.previous) - this.core.coordinates(this.next), d.one(a.support.animation.end, c).css({
          left: b + "px"
        }).addClass("animated owl-animated-out").addClass(g)), f && e.one(a.support.animation.end, c).addClass("animated owl-animated-in").addClass(f));
      }
    }, e.prototype.clear = function (b) {
      a(b.target).css({
        left: ""
      }).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut), this.core.onTransitionEnd();
    }, e.prototype.destroy = function () {
      var a, b;
  
      for (a in this.handlers) {
        this.core.$element.off(a, this.handlers[a]);
      }
  
      for (b in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[b] && (this[b] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.Animate = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    var e = function e(b) {
      this._core = b, this._call = null, this._time = 0, this._timeout = 0, this._paused = !0, this._handlers = {
        "changed.owl.carousel": a.proxy(function (a) {
          a.namespace && "settings" === a.property.name ? this._core.settings.autoplay ? this.play() : this.stop() : a.namespace && "position" === a.property.name && this._paused && (this._time = 0);
        }, this),
        "initialized.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.autoplay && this.play();
        }, this),
        "play.owl.autoplay": a.proxy(function (a, b, c) {
          a.namespace && this.play(b, c);
        }, this),
        "stop.owl.autoplay": a.proxy(function (a) {
          a.namespace && this.stop();
        }, this),
        "mouseover.owl.autoplay": a.proxy(function () {
          this._core.settings.autoplayHoverPause && this._core.is("rotating") && this.pause();
        }, this),
        "mouseleave.owl.autoplay": a.proxy(function () {
          this._core.settings.autoplayHoverPause && this._core.is("rotating") && this.play();
        }, this),
        "touchstart.owl.core": a.proxy(function () {
          this._core.settings.autoplayHoverPause && this._core.is("rotating") && this.pause();
        }, this),
        "touchend.owl.core": a.proxy(function () {
          this._core.settings.autoplayHoverPause && this.play();
        }, this)
      }, this._core.$element.on(this._handlers), this._core.options = a.extend({}, e.Defaults, this._core.options);
    };
  
    e.Defaults = {
      autoplay: !1,
      autoplayTimeout: 5e3,
      autoplayHoverPause: !1,
      autoplaySpeed: !1
    }, e.prototype._next = function (d) {
      this._call = b.setTimeout(a.proxy(this._next, this, d), this._timeout * (Math.round(this.read() / this._timeout) + 1) - this.read()), this._core.is("interacting") || c.hidden || this._core.next(d || this._core.settings.autoplaySpeed);
    }, e.prototype.read = function () {
      return new Date().getTime() - this._time;
    }, e.prototype.play = function (c, d) {
      var e;
      this._core.is("rotating") || this._core.enter("rotating"), c = c || this._core.settings.autoplayTimeout, e = Math.min(this._time % (this._timeout || c), c), this._paused ? (this._time = this.read(), this._paused = !1) : b.clearTimeout(this._call), this._time += this.read() % c - e, this._timeout = c, this._call = b.setTimeout(a.proxy(this._next, this, d), c - e);
    }, e.prototype.stop = function () {
      this._core.is("rotating") && (this._time = 0, this._paused = !0, b.clearTimeout(this._call), this._core.leave("rotating"));
    }, e.prototype.pause = function () {
      this._core.is("rotating") && !this._paused && (this._time = this.read(), this._paused = !0, b.clearTimeout(this._call));
    }, e.prototype.destroy = function () {
      var a, b;
      this.stop();
  
      for (a in this._handlers) {
        this._core.$element.off(a, this._handlers[a]);
      }
  
      for (b in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[b] && (this[b] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.autoplay = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    "use strict";
  
    var e = function e(b) {
      this._core = b, this._initialized = !1, this._pages = [], this._controls = {}, this._templates = [], this.$element = this._core.$element, this._overrides = {
        next: this._core.next,
        prev: this._core.prev,
        to: this._core.to
      }, this._handlers = {
        "prepared.owl.carousel": a.proxy(function (b) {
          b.namespace && this._core.settings.dotsData && this._templates.push('<div class="' + this._core.settings.dotClass + '">' + a(b.content).find("[data-dot]").addBack("[data-dot]").attr("data-dot") + "</div>");
        }, this),
        "added.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.dotsData && this._templates.splice(a.position, 0, this._templates.pop());
        }, this),
        "remove.owl.carousel": a.proxy(function (a) {
          a.namespace && this._core.settings.dotsData && this._templates.splice(a.position, 1);
        }, this),
        "changed.owl.carousel": a.proxy(function (a) {
          a.namespace && "position" == a.property.name && this.draw();
        }, this),
        "initialized.owl.carousel": a.proxy(function (a) {
          a.namespace && !this._initialized && (this._core.trigger("initialize", null, "navigation"), this.initialize(), this.update(), this.draw(), this._initialized = !0, this._core.trigger("initialized", null, "navigation"));
        }, this),
        "refreshed.owl.carousel": a.proxy(function (a) {
          a.namespace && this._initialized && (this._core.trigger("refresh", null, "navigation"), this.update(), this.draw(), this._core.trigger("refreshed", null, "navigation"));
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this.$element.on(this._handlers);
    };
  
    e.Defaults = {
      nav: !1,
      navText: ['<span aria-label="Previous">&#x2039;</span>', '<span aria-label="Next">&#x203a;</span>'],
      navSpeed: !1,
      navElement: 'button type="button" role="presentation"',
      navContainer: !1,
      navContainerClass: "owl-nav",
      navClass: ["owl-prev", "owl-next"],
      slideBy: 1,
      dotClass: "owl-dot",
      dotsClass: "owl-dots",
      dots: !0,
      dotsEach: !1,
      dotsData: !1,
      dotsSpeed: !1,
      dotsContainer: !1
    }, e.prototype.initialize = function () {
      var b,
          c = this._core.settings;
      this._controls.$relative = (c.navContainer ? a(c.navContainer) : a("<div>").addClass(c.navContainerClass).appendTo(this.$element)).addClass("disabled"), this._controls.$previous = a("<" + c.navElement + ">").addClass(c.navClass[0]).html(c.navText[0]).prependTo(this._controls.$relative).on("click", a.proxy(function (a) {
        this.prev(c.navSpeed);
      }, this)), this._controls.$next = a("<" + c.navElement + ">").addClass(c.navClass[1]).html(c.navText[1]).appendTo(this._controls.$relative).on("click", a.proxy(function (a) {
        this.next(c.navSpeed);
      }, this)), c.dotsData || (this._templates = [a('<button role="button">').addClass(c.dotClass).append(a("<span>")).prop("outerHTML")]), this._controls.$absolute = (c.dotsContainer ? a(c.dotsContainer) : a("<div>").addClass(c.dotsClass).appendTo(this.$element)).addClass("disabled"), this._controls.$absolute.on("click", "button", a.proxy(function (b) {
        var d = a(b.target).parent().is(this._controls.$absolute) ? a(b.target).index() : a(b.target).parent().index();
        b.preventDefault(), this.to(d, c.dotsSpeed);
      }, this));
  
      for (b in this._overrides) {
        this._core[b] = a.proxy(this[b], this);
      }
    }, e.prototype.destroy = function () {
      var a, b, c, d, e;
      e = this._core.settings;
  
      for (a in this._handlers) {
        this.$element.off(a, this._handlers[a]);
      }
  
      for (b in this._controls) {
        "$relative" === b && e.navContainer ? this._controls[b].html("") : this._controls[b].remove();
      }
  
      for (d in this.overides) {
        this._core[d] = this._overrides[d];
      }
  
      for (c in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[c] && (this[c] = null);
      }
    }, e.prototype.update = function () {
      var a,
          b,
          c,
          d = this._core.clones().length / 2,
          e = d + this._core.items().length,
          f = this._core.maximum(!0),
          g = this._core.settings,
          h = g.center || g.autoWidth || g.dotsData ? 1 : g.dotsEach || g.items;
  
      if ("page" !== g.slideBy && (g.slideBy = Math.min(g.slideBy, g.items)), g.dots || "page" == g.slideBy) for (this._pages = [], a = d, b = 0, c = 0; a < e; a++) {
        if (b >= h || 0 === b) {
          if (this._pages.push({
            start: Math.min(f, a - d),
            end: a - d + h - 1
          }), Math.min(f, a - d) === f) break;
          b = 0, ++c;
        }
  
        b += this._core.mergers(this._core.relative(a));
      }
    }, e.prototype.draw = function () {
      var b,
          c = this._core.settings,
          d = this._core.items().length <= c.items,
          e = this._core.relative(this._core.current()),
          f = c.loop || c.rewind;
  
      this._controls.$relative.toggleClass("disabled", !c.nav || d), c.nav && (this._controls.$previous.toggleClass("disabled", !f && e <= this._core.minimum(!0)), this._controls.$next.toggleClass("disabled", !f && e >= this._core.maximum(!0))), this._controls.$absolute.toggleClass("disabled", !c.dots || d), c.dots && (b = this._pages.length - this._controls.$absolute.children().length, c.dotsData && 0 !== b ? this._controls.$absolute.html(this._templates.join("")) : b > 0 ? this._controls.$absolute.append(new Array(b + 1).join(this._templates[0])) : b < 0 && this._controls.$absolute.children().slice(b).remove(), this._controls.$absolute.find(".active").removeClass("active"), this._controls.$absolute.children().eq(a.inArray(this.current(), this._pages)).addClass("active"));
    }, e.prototype.onTrigger = function (b) {
      var c = this._core.settings;
      b.page = {
        index: a.inArray(this.current(), this._pages),
        count: this._pages.length,
        size: c && (c.center || c.autoWidth || c.dotsData ? 1 : c.dotsEach || c.items)
      };
    }, e.prototype.current = function () {
      var b = this._core.relative(this._core.current());
  
      return a.grep(this._pages, a.proxy(function (a, c) {
        return a.start <= b && a.end >= b;
      }, this)).pop();
    }, e.prototype.getPosition = function (b) {
      var c,
          d,
          e = this._core.settings;
      return "page" == e.slideBy ? (c = a.inArray(this.current(), this._pages), d = this._pages.length, b ? ++c : --c, c = this._pages[(c % d + d) % d].start) : (c = this._core.relative(this._core.current()), d = this._core.items().length, b ? c += e.slideBy : c -= e.slideBy), c;
    }, e.prototype.next = function (b) {
      a.proxy(this._overrides.to, this._core)(this.getPosition(!0), b);
    }, e.prototype.prev = function (b) {
      a.proxy(this._overrides.to, this._core)(this.getPosition(!1), b);
    }, e.prototype.to = function (b, c, d) {
      var e;
      !d && this._pages.length ? (e = this._pages.length, a.proxy(this._overrides.to, this._core)(this._pages[(b % e + e) % e].start, c)) : a.proxy(this._overrides.to, this._core)(b, c);
    }, a.fn.owlCarousel.Constructor.Plugins.Navigation = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    "use strict";
  
    var e = function e(c) {
      this._core = c, this._hashes = {}, this.$element = this._core.$element, this._handlers = {
        "initialized.owl.carousel": a.proxy(function (c) {
          c.namespace && "URLHash" === this._core.settings.startPosition && a(b).trigger("hashchange.owl.navigation");
        }, this),
        "prepared.owl.carousel": a.proxy(function (b) {
          if (b.namespace) {
            var c = a(b.content).find("[data-hash]").addBack("[data-hash]").attr("data-hash");
            if (!c) return;
            this._hashes[c] = b.content;
          }
        }, this),
        "changed.owl.carousel": a.proxy(function (c) {
          if (c.namespace && "position" === c.property.name) {
            var d = this._core.items(this._core.relative(this._core.current())),
                e = a.map(this._hashes, function (a, b) {
              return a === d ? b : null;
            }).join();
  
            if (!e || b.location.hash.slice(1) === e) return;
            b.location.hash = e;
          }
        }, this)
      }, this._core.options = a.extend({}, e.Defaults, this._core.options), this.$element.on(this._handlers), a(b).on("hashchange.owl.navigation", a.proxy(function (a) {
        var c = b.location.hash.substring(1),
            e = this._core.$stage.children(),
            f = this._hashes[c] && e.index(this._hashes[c]);
  
        f !== d && f !== this._core.current() && this._core.to(this._core.relative(f), !1, !0);
      }, this));
    };
  
    e.Defaults = {
      URLhashListener: !1
    }, e.prototype.destroy = function () {
      var c, d;
      a(b).off("hashchange.owl.navigation");
  
      for (c in this._handlers) {
        this._core.$element.off(c, this._handlers[c]);
      }
  
      for (d in Object.getOwnPropertyNames(this)) {
        "function" != typeof this[d] && (this[d] = null);
      }
    }, a.fn.owlCarousel.Constructor.Plugins.Hash = e;
  }(window.Zepto || window.jQuery, window, document), function (a, b, c, d) {
    function e(b, c) {
      var e = !1,
          f = b.charAt(0).toUpperCase() + b.slice(1);
      return a.each((b + " " + h.join(f + " ") + f).split(" "), function (a, b) {
        if (g[b] !== d) return e = !c || b, !1;
      }), e;
    }
  
    function f(a) {
      return e(a, !0);
    }
  
    var g = a("<support>").get(0).style,
        h = "Webkit Moz O ms".split(" "),
        i = {
      transition: {
        end: {
          WebkitTransition: "webkitTransitionEnd",
          MozTransition: "transitionend",
          OTransition: "oTransitionEnd",
          transition: "transitionend"
        }
      },
      animation: {
        end: {
          WebkitAnimation: "webkitAnimationEnd",
          MozAnimation: "animationend",
          OAnimation: "oAnimationEnd",
          animation: "animationend"
        }
      }
    },
        j = {
      csstransforms: function csstransforms() {
        return !!e("transform");
      },
      csstransforms3d: function csstransforms3d() {
        return !!e("perspective");
      },
      csstransitions: function csstransitions() {
        return !!e("transition");
      },
      cssanimations: function cssanimations() {
        return !!e("animation");
      }
    };
    j.csstransitions() && (a.support.transition = new String(f("transition")), a.support.transition.end = i.transition.end[a.support.transition]), j.cssanimations() && (a.support.animation = new String(f("animation")), a.support.animation.end = i.animation.end[a.support.animation]), j.csstransforms() && (a.support.transform = new String(f("transform")), a.support.transform3d = j.csstransforms3d());
  }(window.Zepto || window.jQuery, window, document);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/panzoom/jquery.panzoom.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/panzoom/jquery.panzoom.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /**
   * @license jquery.panzoom.js v3.2.2
   * Updated: Sat Aug 27 2016
   * Add pan and zoom functionality to any element
   * Copyright (c) timmy willison
   * Released under the MIT license
   * https://github.com/timmywil/jquery.panzoom/blob/master/MIT-License.txt
   */
  (function (global, factory) {
    // AMD
    // if (typeof define === 'function' && define.amd) {
    //     define([ 'jquery' ], function(jQuery) {
    //         return factory(global, jQuery);
    //     });
    //     // CommonJS/Browserify
    // } else if (typeof exports === 'object') {
    //     factory(global, require('jquery'));
    //     // Global
    // } else {
    //     factory(global, global.jQuery);
    // }
    factory(global, global.jQuery);
  })(typeof window !== 'undefined' ? window : this, function (window, $) {
    'use strict';
  
    var document = window.document;
    var datakey = '__pz__';
    var slice = Array.prototype.slice;
    var rIE11 = /trident\/7./i;
  
    var supportsInputEvent = function () {
      // IE11 returns a false positive
      if (rIE11.test(navigator.userAgent)) {
        return false;
      }
  
      var input = document.createElement('input');
      input.setAttribute('oninput', 'return');
      return typeof input.oninput === 'function';
    }(); // Regex
  
  
    var rupper = /([A-Z])/g;
    var rsvg = /^http:[\w\.\/]+svg$/;
    var floating = '(\\-?\\d[\\d\\.e-]*)';
    var commaSpace = '\\,?\\s*';
    var rmatrix = new RegExp('^matrix\\(' + floating + commaSpace + floating + commaSpace + floating + commaSpace + floating + commaSpace + floating + commaSpace + floating + '\\)$');
    /**
     * Utility for determining transform matrix equality
     * Checks backwards to test translation first
     * @param {Array} first
     * @param {Array} second
     */
  
    function matrixEquals(first, second) {
      var i = first.length;
  
      while (--i) {
        if (Math.round(+first[i]) !== Math.round(+second[i])) {
          return false;
        }
      }
  
      return true;
    }
    /**
     * Creates the options object for reset functions
     * @param {Boolean|Object} opts See reset methods
     * @returns {Object} Returns the newly-created options object
     */
  
  
    function createResetOptions(opts) {
      var options = {
        range: true,
        animate: true
      };
  
      if (typeof opts === 'boolean') {
        options.animate = opts;
      } else {
        $.extend(options, opts);
      }
  
      return options;
    }
    /**
     * Represent a transformation matrix with a 3x3 matrix for calculations
     * Matrix functions adapted from Louis Remi's jQuery.transform (https://github.com/louisremi/jquery.transform.js)
     * @param {Array|Number} a An array of six values representing a 2d transformation matrix
     */
  
  
    function Matrix(a, b, c, d, e, f, g, h, i) {
      if ($.type(a) === 'array') {
        this.elements = [+a[0], +a[2], +a[4], +a[1], +a[3], +a[5], 0, 0, 1];
      } else {
        this.elements = [a, b, c, d, e, f, g || 0, h || 0, i || 1];
      }
    }
  
    Matrix.prototype = {
      /**
       * Multiply a 3x3 matrix by a similar matrix or a vector
       * @param {Matrix|Vector} matrix
       * @return {Matrix|Vector} Returns a vector if multiplying by a vector
       */
      x: function x(matrix) {
        var isVector = matrix instanceof Vector;
        var a = this.elements,
            b = matrix.elements;
  
        if (isVector && b.length === 3) {
          // b is actually a vector
          return new Vector(a[0] * b[0] + a[1] * b[1] + a[2] * b[2], a[3] * b[0] + a[4] * b[1] + a[5] * b[2], a[6] * b[0] + a[7] * b[1] + a[8] * b[2]);
        } else if (b.length === a.length) {
          // b is a 3x3 matrix
          return new Matrix(a[0] * b[0] + a[1] * b[3] + a[2] * b[6], a[0] * b[1] + a[1] * b[4] + a[2] * b[7], a[0] * b[2] + a[1] * b[5] + a[2] * b[8], a[3] * b[0] + a[4] * b[3] + a[5] * b[6], a[3] * b[1] + a[4] * b[4] + a[5] * b[7], a[3] * b[2] + a[4] * b[5] + a[5] * b[8], a[6] * b[0] + a[7] * b[3] + a[8] * b[6], a[6] * b[1] + a[7] * b[4] + a[8] * b[7], a[6] * b[2] + a[7] * b[5] + a[8] * b[8]);
        }
  
        return false; // fail
      },
  
      /**
       * Generates an inverse of the current matrix
       * @returns {Matrix}
       */
      inverse: function inverse() {
        var d = 1 / this.determinant(),
            a = this.elements;
        return new Matrix(d * (a[8] * a[4] - a[7] * a[5]), d * -(a[8] * a[1] - a[7] * a[2]), d * (a[5] * a[1] - a[4] * a[2]), d * -(a[8] * a[3] - a[6] * a[5]), d * (a[8] * a[0] - a[6] * a[2]), d * -(a[5] * a[0] - a[3] * a[2]), d * (a[7] * a[3] - a[6] * a[4]), d * -(a[7] * a[0] - a[6] * a[1]), d * (a[4] * a[0] - a[3] * a[1]));
      },
  
      /**
       * Calculates the determinant of the current matrix
       * @returns {Number}
       */
      determinant: function determinant() {
        var a = this.elements;
        return a[0] * (a[8] * a[4] - a[7] * a[5]) - a[3] * (a[8] * a[1] - a[7] * a[2]) + a[6] * (a[5] * a[1] - a[4] * a[2]);
      }
    };
    /**
     * Create a vector containing three values
     */
  
    function Vector(x, y, z) {
      this.elements = [x, y, z];
    }
    /**
     * Get the element at zero-indexed index i
     * @param {Number} i
     */
  
  
    Vector.prototype.e = Matrix.prototype.e = function (i) {
      return this.elements[i];
    };
    /**
     * Create a Panzoom object for a given element
     * @constructor
     * @param {Element} elem - Element to use pan and zoom
     * @param {Object} [options] - An object literal containing options to override default options
     *  (See Panzoom.defaults for ones not listed below)
     * @param {jQuery} [options.$zoomIn] - zoom in buttons/links collection (you can also bind these yourself
     *  e.g. $button.on('click', function(e) { e.preventDefault(); $elem.panzoom('zoomIn'); });)
     * @param {jQuery} [options.$zoomOut] - zoom out buttons/links collection on which to bind zoomOut
     * @param {jQuery} [options.$zoomRange] - zoom in/out with this range control
     * @param {jQuery} [options.$reset] - Reset buttons/links collection on which to bind the reset method
     * @param {Function} [options.on[Start|Change|Zoom|Pan|End|Reset] - Optional callbacks for panzoom events
     */
  
  
    function Panzoom(elem, options) {
      // Allow instantiation without `new` keyword
      if (!(this instanceof Panzoom)) {
        return new Panzoom(elem, options);
      } // Sanity checks
  
  
      if (elem.nodeType !== 1) {
        $.error('Panzoom called on non-Element node');
      }
  
      if (!$.contains(document, elem)) {
        $.error('Panzoom element must be attached to the document');
      } // Don't remake
  
  
      var d = $.data(elem, datakey);
  
      if (d) {
        return d;
      } // Extend default with given object literal
      // Each instance gets its own options
  
  
      this.options = options = $.extend({}, Panzoom.defaults, options);
      this.elem = elem;
      var $elem = this.$elem = $(elem);
      this.$set = options.$set && options.$set.length ? options.$set : $elem;
      this.$doc = $(elem.ownerDocument || document);
      this.$parent = $elem.parent();
      this.parent = this.$parent[0]; // This is SVG if the namespace is SVG
      // However, while <svg> elements are SVG, we want to treat those like other elements
  
      this.isSVG = rsvg.test(elem.namespaceURI) && elem.nodeName.toLowerCase() !== 'svg';
      this.panning = false; // Save the original transform value
      // Save the prefixed transform style key
      // Set the starting transform
  
      this._buildTransform(); // Build the appropriately-prefixed transform style property name
      // De-camelcase
  
  
      this._transform = $.cssProps.transform ? $.cssProps.transform.replace(rupper, '-$1').toLowerCase() : 'transform'; // Build the transition value
  
      this._buildTransition(); // Build containment dimensions
  
  
      this.resetDimensions(); // Add zoom and reset buttons to `this`
  
      var $empty = $();
      var self = this;
      $.each(['$zoomIn', '$zoomOut', '$zoomRange', '$reset'], function (i, name) {
        self[name] = options[name] || $empty;
      });
      this.enable();
      this.scale = this.getMatrix()[0];
  
      this._checkPanWhenZoomed(); // Save the instance
  
  
      $.data(elem, datakey, this);
    } // Attach regex for possible use (immutable)
  
  
    Panzoom.rmatrix = rmatrix;
    Panzoom.defaults = {
      // Should always be non-empty
      // Used to bind jQuery events without collisions
      // A guid is not added here as different instantiations/versions of panzoom
      // on the same element is not supported, so don't do it.
      eventNamespace: '.panzoom',
      // Whether or not to transition the scale
      transition: true,
      // Default cursor style for the element
      cursor: 'move',
      // There may be some use cases for zooming without panning or vice versa
      disablePan: false,
      disableZoom: false,
      // Pan only on the X or Y axes
      disableXAxis: false,
      disableYAxis: false,
      // Set whether you'd like to pan on left (1), middle (2), or right click (3)
      which: 1,
      // The increment at which to zoom
      // adds/subtracts to the scale each time zoomIn/Out is called
      increment: 0.3,
      // Turns on exponential zooming
      // If false, zooming will be incremented linearly
      exponential: true,
      // Pan only when the scale is greater than minScale
      panOnlyWhenZoomed: false,
      // min and max zoom scales
      minScale: 0.3,
      maxScale: 6,
      // The default step for the range input
      // Precendence: default < HTML attribute < option setting
      rangeStep: 0.05,
      // Animation duration (ms)
      duration: 200,
      // CSS easing used for scale transition
      easing: 'ease-in-out',
      // Indicate that the element should be contained within it's parent when panning
      // Note: this does not affect zooming outside of the parent
      // Set this value to 'invert' to only allow panning outside of the parent element (basically the opposite of the normal use of contain)
      // 'invert' is useful for a large panzoom element where you don't want to show anything behind it
      contain: false
    };
    Panzoom.prototype = {
      constructor: Panzoom,
  
      /**
       * @returns {Panzoom} Returns the instance
       */
      instance: function instance() {
        return this;
      },
  
      /**
       * Enable or re-enable the panzoom instance
       */
      enable: function enable() {
        // Unbind first
        this._initStyle();
  
        this._bind();
  
        this.disabled = false;
      },
  
      /**
       * Disable panzoom
       */
      disable: function disable() {
        this.disabled = true;
  
        this._resetStyle();
  
        this._unbind();
      },
  
      /**
       * @returns {Boolean} Returns whether the current panzoom instance is disabled
       */
      isDisabled: function isDisabled() {
        return this.disabled;
      },
  
      /**
       * Destroy the panzoom instance
       */
      destroy: function destroy() {
        this.disable();
        $.removeData(this.elem, datakey);
      },
  
      /**
       * Builds the restricing dimensions from the containment element
       * Also used with focal points
       * Call this method whenever the dimensions of the element or parent are changed
       */
      resetDimensions: function resetDimensions() {
        // Reset container properties
        this.container = this.parent.getBoundingClientRect(); // Set element properties
  
        var elem = this.elem; // getBoundingClientRect() works with SVG, offsetWidth does not
  
        var dims = elem.getBoundingClientRect();
        var absScale = Math.abs(this.scale);
        this.dimensions = {
          width: dims.width,
          height: dims.height,
          left: $.css(elem, 'left', true) || 0,
          top: $.css(elem, 'top', true) || 0,
          // Borders and margins are scaled
          border: {
            top: $.css(elem, 'borderTopWidth', true) * absScale || 0,
            bottom: $.css(elem, 'borderBottomWidth', true) * absScale || 0,
            left: $.css(elem, 'borderLeftWidth', true) * absScale || 0,
            right: $.css(elem, 'borderRightWidth', true) * absScale || 0
          },
          margin: {
            top: $.css(elem, 'marginTop', true) * absScale || 0,
            left: $.css(elem, 'marginLeft', true) * absScale || 0
          }
        };
      },
  
      /**
       * Return the element to it's original transform matrix
       * @param {Boolean} [options] If a boolean is passed, animate the reset (default: true). If an options object is passed, simply pass that along to setMatrix.
       * @param {Boolean} [options.silent] Silence the reset event
       */
      reset: function reset(options) {
        options = createResetOptions(options); // Reset the transform to its original value
  
        var matrix = this.setMatrix(this._origTransform, options);
  
        if (!options.silent) {
          this._trigger('reset', matrix);
        }
      },
  
      /**
       * Only resets zoom level
       * @param {Boolean|Object} [options] Whether to animate the reset (default: true) or an object of options to pass to zoom()
       */
      resetZoom: function resetZoom(options) {
        options = createResetOptions(options);
        var origMatrix = this.getMatrix(this._origTransform);
        options.dValue = origMatrix[3];
        this.zoom(origMatrix[0], options);
      },
  
      /**
       * Only reset panning
       * @param {Boolean|Object} [options] Whether to animate the reset (default: true) or an object of options to pass to pan()
       */
      resetPan: function resetPan(options) {
        var origMatrix = this.getMatrix(this._origTransform);
        this.pan(origMatrix[4], origMatrix[5], createResetOptions(options));
      },
  
      /**
       * Sets a transform on the $set
       * For SVG, the style attribute takes precedence
       * and allows us to animate
       * @param {String} transform
       */
      setTransform: function setTransform(transform) {
        var $set = this.$set;
        var i = $set.length;
  
        while (i--) {
          $.style($set[i], 'transform', transform); // Support IE9-11, Edge 13-14+
          // Set attribute alongside style attribute
          // since IE and Edge do not respect style settings on SVG
          // See https://css-tricks.com/transforms-on-svg-elements/
  
          if (this.isSVG) {
            $set[i].setAttribute('transform', transform);
          }
        }
      },
  
      /**
       * Retrieving the transform is different for SVG
       *  (unless a style transform is already present)
       * Uses the $set collection for retrieving the transform
       * @param {String} [transform] Pass in an transform value (like 'scale(1.1)')
       *  to have it formatted into matrix format for use by Panzoom
       * @returns {String} Returns the current transform value of the element
       */
      getTransform: function getTransform(transform) {
        var $set = this.$set;
        var transformElem = $set[0];
  
        if (transform) {
          this.setTransform(transform);
        } else {
          // IE and Edge still set the transform style properly
          // They just don't render it on SVG
          // So we get a correct value here
          transform = $.style(transformElem, 'transform');
  
          if (this.isSVG && (!transform || transform === 'none')) {
            transform = $.attr(transformElem, 'transform') || 'none';
          }
        } // Convert any transforms set by the user to matrix format
        // by setting to computed
  
  
        if (transform !== 'none' && !rmatrix.test(transform)) {
          // Get computed and set for next time
          this.setTransform(transform = $.css(transformElem, 'transform'));
        }
  
        return transform || 'none';
      },
  
      /**
       * Retrieve the current transform matrix for $elem (or turn a transform into it's array values)
       * @param {String} [transform] matrix-formatted transform value
       * @returns {Array} Returns the current transform matrix split up into it's parts, or a default matrix
       */
      getMatrix: function getMatrix(transform) {
        var matrix = rmatrix.exec(transform || this.getTransform());
  
        if (matrix) {
          matrix.shift();
        }
  
        return matrix || [1, 0, 0, 1, 0, 0];
      },
  
      /**
       * Given a matrix object, quickly set the current matrix of the element
       * @param {Array|String} matrix
       * @param {Object} [options]
       * @param {Boolean|String} [options.animate] Whether to animate the transform change, or 'skip' indicating that it is unnecessary to set
       * @param {Boolean} [options.contain] Override the global contain option
       * @param {Boolean} [options.range] If true, $zoomRange's value will be updated.
       * @param {Boolean} [options.silent] If true, the change event will not be triggered
       * @returns {Array} Returns the newly-set matrix
       */
      setMatrix: function setMatrix(matrix, options) {
        if (this.disabled) {
          return;
        }
  
        if (!options) {
          options = {};
        } // Convert to array
  
  
        if (typeof matrix === 'string') {
          matrix = this.getMatrix(matrix);
        }
  
        var scale = +matrix[0];
        var contain = typeof options.contain !== 'undefined' ? options.contain : this.options.contain; // Apply containment
  
        if (contain) {
          var dims = options.dims;
  
          if (!dims) {
            this.resetDimensions();
            dims = this.dimensions;
          }
  
          var spaceWLeft, spaceWRight, scaleDiff;
          var container = this.container;
          var width = dims.width;
          var height = dims.height;
          var conWidth = container.width;
          var conHeight = container.height;
          var zoomAspectW = conWidth / width;
          var zoomAspectH = conHeight / height; // If the element is not naturally centered,
          // assume full space right
  
          if (this.$parent.css('textAlign') !== 'center' || $.css(this.elem, 'display') !== 'inline') {
            // offsetWidth gets us the width without the transform
            scaleDiff = (width - this.elem.offsetWidth) / 2;
            spaceWLeft = scaleDiff - dims.border.left;
            spaceWRight = width - conWidth - scaleDiff + dims.border.right;
          } else {
            spaceWLeft = spaceWRight = (width - conWidth) / 2;
          }
  
          var spaceHTop = (height - conHeight) / 2 + dims.border.top;
          var spaceHBottom = (height - conHeight) / 2 - dims.border.top - dims.border.bottom;
  
          if (contain === 'invert' || contain === 'automatic' && zoomAspectW < 1.01) {
            matrix[4] = Math.max(Math.min(matrix[4], spaceWLeft - dims.border.left), -spaceWRight);
          } else {
            matrix[4] = Math.min(Math.max(matrix[4], spaceWLeft), -spaceWRight);
          }
  
          if (contain === 'invert' || contain === 'automatic' && zoomAspectH < 1.01) {
            matrix[5] = Math.max(Math.min(matrix[5], spaceHTop - dims.border.top), -spaceHBottom);
          } else {
            matrix[5] = Math.min(Math.max(matrix[5], spaceHTop), -spaceHBottom);
          }
        } // Animate
  
  
        if (options.animate !== 'skip') {
          // Set transition
          this.transition(!options.animate);
        } // Update range element
  
  
        if (options.range) {
          this.$zoomRange.val(scale);
        } // Set the matrix on this.$set
  
  
        if (this.options.disableXAxis || this.options.disableYAxis) {
          var originalMatrix = this.getMatrix();
  
          if (this.options.disableXAxis) {
            matrix[4] = originalMatrix[4];
          }
  
          if (this.options.disableYAxis) {
            matrix[5] = originalMatrix[5];
          }
        }
  
        this.setTransform('matrix(' + matrix.join(',') + ')');
        this.scale = scale; // Disable/enable panning if zooming is at minimum and panOnlyWhenZoomed is true
  
        this._checkPanWhenZoomed(scale);
  
        if (!options.silent) {
          this._trigger('change', matrix);
        }
  
        return matrix;
      },
  
      /**
       * @returns {Boolean} Returns whether the panzoom element is currently being dragged
       */
      isPanning: function isPanning() {
        return this.panning;
      },
  
      /**
       * Apply the current transition to the element, if allowed
       * @param {Boolean} [off] Indicates that the transition should be turned off
       */
      transition: function transition(off) {
        if (!this._transition) {
          return;
        }
  
        var transition = off || !this.options.transition ? 'none' : this._transition;
        var $set = this.$set;
        var i = $set.length;
  
        while (i--) {
          // Avoid reflows when zooming
          if ($.style($set[i], 'transition') !== transition) {
            $.style($set[i], 'transition', transition);
          }
        }
      },
  
      /**
       * Pan the element to the specified translation X and Y
       * Note: this is not the same as setting jQuery#offset() or jQuery#position()
       * @param {Number} x
       * @param {Number} y
       * @param {Object} [options] These options are passed along to setMatrix
       * @param {Array} [options.matrix] The matrix being manipulated (if already known so it doesn't have to be retrieved again)
       * @param {Boolean} [options.silent] Silence the pan event. Note that this will also silence the setMatrix change event.
       * @param {Boolean} [options.relative] Make the x and y values relative to the existing matrix
       */
      pan: function pan(x, y, options) {
        if (this.options.disablePan) {
          return;
        }
  
        if (!options) {
          options = {};
        }
  
        var matrix = options.matrix;
  
        if (!matrix) {
          matrix = this.getMatrix();
        } // Cast existing matrix values to numbers
  
  
        if (options.relative) {
          x += +matrix[4];
          y += +matrix[5];
        }
  
        matrix[4] = x;
        matrix[5] = y;
        this.setMatrix(matrix, options);
  
        if (!options.silent) {
          this._trigger('pan', matrix[4], matrix[5]);
        }
      },
  
      /**
       * Zoom in/out the element using the scale properties of a transform matrix
       * @param {Number|Boolean} [scale] The scale to which to zoom or a boolean indicating to transition a zoom out
       * @param {Object} [opts] All global options can be overwritten by this options object. For example, override the default increment.
       * @param {Boolean} [opts.noSetRange] Specify that the method should not set the $zoomRange value (as is the case when $zoomRange is calling zoom on change)
       * @param {jQuery.Event|Object} [opts.focal] A focal point on the panzoom element on which to zoom.
       *  If an object, set the clientX and clientY properties to the position relative to the parent
       * @param {Boolean} [opts.animate] Whether to animate the zoom (defaults to true if scale is not a number, false otherwise)
       * @param {Boolean} [opts.silent] Silence the zoom event
       * @param {Array} [opts.matrix] Optionally pass the current matrix so it doesn't need to be retrieved
       * @param {Number} [opts.dValue] Think of a transform matrix as four values a, b, c, d
       *  where a/d are the horizontal/vertical scale values and b/c are the skew values
       *  (5 and 6 of matrix array are the tx/ty transform values).
       *  Normally, the scale is set to both the a and d values of the matrix.
       *  This option allows you to specify a different d value for the zoom.
       *  For instance, to flip vertically, you could set -1 as the dValue.
       */
      zoom: function zoom(scale, opts) {
        // Shuffle arguments
        if (_typeof(scale) === 'object') {
          opts = scale;
          scale = null;
        } else if (!opts) {
          opts = {};
        }
  
        var options = $.extend({}, this.options, opts); // Check if disabled
  
        if (options.disableZoom) {
          return;
        }
  
        var animate = false;
        var matrix = options.matrix || this.getMatrix();
        var startScale = +matrix[0]; // Calculate zoom based on increment
  
        if (typeof scale !== 'number') {
          // Just use a number a little greater than 1
          // Below 1 can use normal increments
          if (options.exponential && startScale - options.increment >= 1) {
            scale = Math[scale ? 'sqrt' : 'pow'](startScale, 2);
          } else {
            scale = startScale + options.increment * (scale ? -1 : 1);
          }
  
          animate = true;
        } // Constrain scale
  
  
        if (scale > options.maxScale) {
          scale = options.maxScale;
        } else if (scale < options.minScale) {
          scale = options.minScale;
        } // Calculate focal point based on scale
  
  
        var focal = options.focal;
  
        if (focal && !options.disablePan) {
          // Adapted from code by Florian Gnther
          // https://github.com/florianguenther/zui53
          this.resetDimensions();
          var dims = options.dims = this.dimensions;
          var clientX = focal.clientX;
          var clientY = focal.clientY; // Adjust the focal point for transform-origin 50% 50%
          // SVG elements have a transform origin of 0 0
  
          if (!this.isSVG) {
            clientX -= dims.width / startScale / 2;
            clientY -= dims.height / startScale / 2;
          }
  
          var clientV = new Vector(clientX, clientY, 1);
          var surfaceM = new Matrix(matrix); // Supply an offset manually if necessary
  
          var o = this.parentOffset || this.$parent.offset();
          var offsetM = new Matrix(1, 0, o.left - this.$doc.scrollLeft(), 0, 1, o.top - this.$doc.scrollTop());
          var surfaceV = surfaceM.inverse().x(offsetM.inverse().x(clientV));
          var scaleBy = scale / matrix[0];
          surfaceM = surfaceM.x(new Matrix([scaleBy, 0, 0, scaleBy, 0, 0]));
          clientV = offsetM.x(surfaceM.x(surfaceV));
          matrix[4] = +matrix[4] + (clientX - clientV.e(0));
          matrix[5] = +matrix[5] + (clientY - clientV.e(1));
        } // Set the scale
  
  
        matrix[0] = scale;
        matrix[3] = typeof options.dValue === 'number' ? options.dValue : scale; // Calling zoom may still pan the element
  
        this.setMatrix(matrix, {
          animate: typeof options.animate !== 'undefined' ? options.animate : animate,
          // Set the zoomRange value
          range: !options.noSetRange
        }); // Trigger zoom event
  
        if (!options.silent) {
          this._trigger('zoom', matrix[0], options);
        }
      },
  
      /**
       * Get/set option on an existing instance
       * @returns {Array|undefined} If getting, returns an array of all values
       *   on each instance for a given key. If setting, continue chaining by returning undefined.
       */
      option: function option(key, value) {
        var options;
  
        if (!key) {
          // Avoids returning direct reference
          return $.extend({}, this.options);
        }
  
        if (typeof key === 'string') {
          if (arguments.length === 1) {
            return this.options[key] !== undefined ? this.options[key] : null;
          }
  
          options = {};
          options[key] = value;
        } else {
          options = key;
        }
  
        this._setOptions(options);
      },
  
      /**
       * Internally sets options
       * @param {Object} options - An object literal of options to set
       * @private
       */
      _setOptions: function _setOptions(options) {
        $.each(options, $.proxy(function (key, value) {
          switch (key) {
            case 'disablePan':
              this._resetStyle();
  
            /* falls through */
  
            case '$zoomIn':
            case '$zoomOut':
            case '$zoomRange':
            case '$reset':
            case 'disableZoom':
            case 'onStart':
            case 'onChange':
            case 'onZoom':
            case 'onPan':
            case 'onEnd':
            case 'onReset':
            case 'eventNamespace':
              this._unbind();
  
          }
  
          this.options[key] = value;
  
          switch (key) {
            case 'disablePan':
              this._initStyle();
  
            /* falls through */
  
            case '$zoomIn':
            case '$zoomOut':
            case '$zoomRange':
            case '$reset':
              // Set these on the instance
              this[key] = value;
  
            /* falls through */
  
            case 'disableZoom':
            case 'onStart':
            case 'onChange':
            case 'onZoom':
            case 'onPan':
            case 'onEnd':
            case 'onReset':
            case 'eventNamespace':
              this._bind();
  
              break;
  
            case 'cursor':
              $.style(this.elem, 'cursor', value);
              break;
  
            case 'minScale':
              this.$zoomRange.attr('min', value);
              break;
  
            case 'maxScale':
              this.$zoomRange.attr('max', value);
              break;
  
            case 'rangeStep':
              this.$zoomRange.attr('step', value);
              break;
  
            case 'startTransform':
              this._buildTransform();
  
              break;
  
            case 'duration':
            case 'easing':
              this._buildTransition();
  
            /* falls through */
  
            case 'transition':
              this.transition();
              break;
  
            case 'panOnlyWhenZoomed':
              this._checkPanWhenZoomed();
  
              break;
  
            case '$set':
              if (value instanceof $ && value.length) {
                this.$set = value; // Reset styles
  
                this._initStyle();
  
                this._buildTransform();
              }
  
          }
        }, this));
      },
  
      /**
       * Disable/enable panning depending on whether the current scale
       * matches the minimum
       * @param {Number} [scale]
       * @private
       */
      _checkPanWhenZoomed: function _checkPanWhenZoomed(scale) {
        var options = this.options;
  
        if (options.panOnlyWhenZoomed) {
          if (!scale) {
            scale = this.getMatrix()[0];
          }
  
          var toDisable = scale <= options.minScale;
  
          if (options.disablePan !== toDisable) {
            this.option('disablePan', toDisable);
          }
        }
      },
  
      /**
       * Initialize base styles for the element and its parent
       * @private
       */
      _initStyle: function _initStyle() {
        var styles = {
          // Set the same default whether SVG or HTML
          // transform-origin cannot be changed to 50% 50% in IE9-11 or Edge 13-14+
          'transform-origin': this.isSVG ? '0 0' : '50% 50%'
        }; // Set elem styles
  
        if (!this.options.disablePan) {
          styles.cursor = this.options.cursor;
        }
  
        this.$set.css(styles); // Set parent to relative if set to static
  
        var $parent = this.$parent; // No need to add styles to the body
  
        if ($parent.length && !$.nodeName(this.parent, 'body')) {
          styles = {
            overflow: 'hidden'
          };
  
          if ($parent.css('position') === 'static') {
            styles.position = 'relative';
          }
  
          $parent.css(styles);
        }
      },
  
      /**
       * Undo any styles attached in this plugin
       * @private
       */
      _resetStyle: function _resetStyle() {
        this.$elem.css({
          'cursor': '',
          'transition': ''
        });
        this.$parent.css({
          'overflow': '',
          'position': ''
        });
      },
  
      /**
       * Binds all necessary events
       * @private
       */
      _bind: function _bind() {
        var self = this;
        var options = this.options;
        var ns = options.eventNamespace;
        var str_down = 'mousedown' + ns + ' pointerdown' + ns + ' MSPointerDown' + ns;
        var str_start = 'touchstart' + ns + ' ' + str_down;
        var str_click = 'touchend' + ns + ' click' + ns + ' pointerup' + ns + ' MSPointerUp' + ns;
        var events = {};
        var $reset = this.$reset;
        var $zoomRange = this.$zoomRange; // Bind panzoom events from options
  
        $.each(['Start', 'Change', 'Zoom', 'Pan', 'End', 'Reset'], function () {
          var m = options['on' + this];
  
          if ($.isFunction(m)) {
            events['panzoom' + this.toLowerCase() + ns] = m;
          }
        }); // Bind $elem drag and click/touchdown events
        // Bind touchstart if either panning or zooming is enabled
  
        if (!options.disablePan || !options.disableZoom) {
          events[str_start] = function (e) {
            var touches;
  
            if (e.type === 'touchstart' ? // Touch
            (touches = e.touches || e.originalEvent.touches) && (touches.length === 1 && !options.disablePan || touches.length === 2) : // Mouse/Pointer: Ignore unexpected click types
            // Support: IE10 only
            // IE10 does not support e.button for MSPointerDown, but does have e.which
            !options.disablePan && (e.which || e.originalEvent.which) === options.which) {
              e.preventDefault();
              e.stopPropagation();
  
              self._startMove(e, touches);
            }
          }; // Prevent the contextmenu event
          // if we're binding to right-click
  
  
          if (options.which === 3) {
            events.contextmenu = false;
          }
        }
  
        this.$elem.on(events); // Bind reset
  
        if ($reset.length) {
          $reset.on(str_click, function (e) {
            e.preventDefault();
            self.reset();
          });
        } // Set default attributes for the range input
  
  
        if ($zoomRange.length) {
          $zoomRange.attr({
            // Only set the range step if explicit or
            // set the default if there is no attribute present
            step: options.rangeStep === Panzoom.defaults.rangeStep && $zoomRange.attr('step') || options.rangeStep,
            min: options.minScale,
            max: options.maxScale
          }).prop({
            value: this.getMatrix()[0]
          });
        } // No bindings if zooming is disabled
  
  
        if (options.disableZoom) {
          return;
        }
  
        var $zoomIn = this.$zoomIn;
        var $zoomOut = this.$zoomOut; // Bind zoom in/out
        // Don't bind one without the other
  
        if ($zoomIn.length && $zoomOut.length) {
          // preventDefault cancels future mouse events on touch events
          $zoomIn.on(str_click, function (e) {
            e.preventDefault();
            self.zoom();
          });
          $zoomOut.on(str_click, function (e) {
            e.preventDefault();
            self.zoom(true);
          });
        }
  
        if ($zoomRange.length) {
          events = {}; // Cannot prevent default action here
  
          events[str_down] = function () {
            self.transition(true);
          }; // Zoom on input events if available and change events
          // See https://github.com/timmywil/jquery.panzoom/issues/90
  
  
          events[(supportsInputEvent ? 'input' : 'change') + ns] = function () {
            self.zoom(+this.value, {
              noSetRange: true
            });
          };
  
          $zoomRange.on(events);
        }
      },
  
      /**
       * Unbind all events
       * @private
       */
      _unbind: function _unbind() {
        this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace);
      },
  
      /**
       * Builds the original transform value
       * @private
       */
      _buildTransform: function _buildTransform() {
        // Save the original transform
        // Retrieving this also adds the correct prefixed style name
        // to jQuery's internal $.cssProps
        return this._origTransform = this.getTransform(this.options.startTransform);
      },
  
      /**
       * Set transition property for later use when zooming
       * @private
       */
      _buildTransition: function _buildTransition() {
        if (this._transform) {
          var options = this.options;
          this._transition = this._transform + ' ' + options.duration + 'ms ' + options.easing;
        }
      },
  
      /**
       * Calculates the distance between two touch points
       * Remember pythagorean?
       * @param {Array} touches
       * @returns {Number} Returns the distance
       * @private
       */
      _getDistance: function _getDistance(touches) {
        var touch1 = touches[0];
        var touch2 = touches[1];
        return Math.sqrt(Math.pow(Math.abs(touch2.clientX - touch1.clientX), 2) + Math.pow(Math.abs(touch2.clientY - touch1.clientY), 2));
      },
  
      /**
       * Constructs an approximated point in the middle of two touch points
       * @returns {Object} Returns an object containing pageX and pageY
       * @private
       */
      _getMiddle: function _getMiddle(touches) {
        var touch1 = touches[0];
        var touch2 = touches[1];
        return {
          clientX: (touch2.clientX - touch1.clientX) / 2 + touch1.clientX,
          clientY: (touch2.clientY - touch1.clientY) / 2 + touch1.clientY
        };
      },
  
      /**
       * Trigger a panzoom event on our element
       * The event is passed the Panzoom instance
       * @param {String|jQuery.Event} event
       * @param {Mixed} arg1[, arg2, arg3, ...] Arguments to append to the trigger
       * @private
       */
      _trigger: function _trigger(event) {
        if (typeof event === 'string') {
          event = 'panzoom' + event;
        }
  
        this.$elem.triggerHandler(event, [this].concat(slice.call(arguments, 1)));
      },
  
      /**
       * Starts the pan
       * This is bound to mouse/touchmove on the element
       * @param {jQuery.Event} event An event with pageX, pageY, and possibly the touches list
       * @param {TouchList} [touches] The touches list if present
       * @private
       */
      _startMove: function _startMove(event, touches) {
        if (this.panning) {
          return;
        }
  
        var moveEvent, endEvent, startDistance, startScale, startMiddle, startPageX, startPageY, touch;
        var self = this;
        var options = this.options;
        var ns = options.eventNamespace;
        var matrix = this.getMatrix();
        var original = matrix.slice(0);
        var origPageX = +original[4];
        var origPageY = +original[5];
        var panOptions = {
          matrix: matrix,
          animate: 'skip'
        };
        var type = event.type; // Use proper events
  
        if (type === 'pointerdown') {
          moveEvent = 'pointermove';
          endEvent = 'pointerup';
        } else if (type === 'touchstart') {
          moveEvent = 'touchmove';
          endEvent = 'touchend';
        } else if (type === 'MSPointerDown') {
          moveEvent = 'MSPointerMove';
          endEvent = 'MSPointerUp';
        } else {
          moveEvent = 'mousemove';
          endEvent = 'mouseup';
        } // Add namespace
  
  
        moveEvent += ns;
        endEvent += ns; // Remove any transitions happening
  
        this.transition(true); // Indicate that we are currently panning
  
        this.panning = true; // Trigger start event
  
        this._trigger('start', event, touches);
  
        var setStart = function setStart(event, touches) {
          if (touches) {
            if (touches.length === 2) {
              if (startDistance != null) {
                return;
              }
  
              startDistance = self._getDistance(touches);
              startScale = self.getScale(matrix);
              startMiddle = self._getMiddle(touches);
              return;
            }
  
            if (startPageX != null) {
              return;
            }
  
            if (touch = touches[0]) {
              startPageX = touch.pageX;
              startPageY = touch.pageY;
            }
          }
  
          if (startPageX != null) {
            return;
          }
  
          startPageX = event.pageX;
          startPageY = event.pageY;
        };
  
        setStart(event, touches);
  
        var move = function move(e) {
          var coords;
          e.preventDefault();
          touches = e.touches || e.originalEvent.touches;
          setStart(e, touches);
  
          if (touches) {
            if (touches.length === 2) {
              // Calculate move on middle point
              var middle = self._getMiddle(touches);
  
              var diff = self._getDistance(touches) - startDistance; // Set zoom
  
              self.zoom(diff * (options.increment / 100) + startScale, {
                focal: middle,
                matrix: matrix,
                animate: 'skip'
              }); // Set pan
  
              self.pan(+matrix[4] + middle.clientX - startMiddle.clientX, +matrix[5] + middle.clientY - startMiddle.clientY, panOptions);
              startMiddle = middle;
              return;
            }
  
            coords = touches[0] || {
              pageX: 0,
              pageY: 0
            };
          }
  
          if (!coords) {
            coords = e;
          }
  
          self.pan(origPageX + coords.pageX - startPageX, origPageY + coords.pageY - startPageY, panOptions);
        }; // Bind the handlers
  
  
        $(document).off(ns).on(moveEvent, move).on(endEvent, function (e) {
          e.preventDefault(); // Unbind all document events
  
          $(this).off(ns);
          self.panning = false; // Trigger our end event
          // Simply set the type to "panzoomend" to pass through all end properties
          // jQuery's `not` is used here to compare Array equality
  
          e.type = 'panzoomend';
  
          self._trigger(e, matrix, !matrixEquals(matrix, original));
        });
      }
    }; // Add Panzoom as a static property
  
    $.Panzoom = Panzoom;
    /**
     * Extend jQuery
     * @param {Object|String} options - The name of a method to call on the prototype
     *  or an object literal of options
     * @returns {jQuery|Mixed} jQuery instance for regular chaining or the return value(s) of a panzoom method call
     */
  
    $.fn.panzoom = function (options) {
      var instance, args, m, ret; // Call methods widget-style
  
      if (typeof options === 'string') {
        ret = [];
        args = slice.call(arguments, 1);
        this.each(function () {
          instance = $.data(this, datakey);
  
          if (!instance) {
            ret.push(undefined); // Ignore methods beginning with `_`
          } else if (options.charAt(0) !== '_' && typeof (m = instance[options]) === 'function' && // If nothing is returned, do not add to return values
          (m = m.apply(instance, args)) !== undefined) {
            ret.push(m);
          }
        }); // Return an array of values for the jQuery instances
        // Or the value itself if there is only one
        // Or keep chaining
  
        return ret.length ? ret.length === 1 ? ret[0] : ret : this;
      }
  
      return this.each(function () {
        new Panzoom(this, options);
      });
    };
  
    return Panzoom;
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/CustomEvent.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/CustomEvent.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill}
   */
  (function () {
    if (typeof window.CustomEvent === "function") return false; //If not IE
  
    function CustomEvent(event, params) {
      params = params || {
        bubbles: false,
        cancelable: false,
        detail: undefined
      };
      var evt = document.createEvent('CustomEvent');
      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);
      return evt;
    }
  
    CustomEvent.prototype = window.Event.prototype;
    window.CustomEvent = CustomEvent;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Element/closest.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Element/closest.js ***!
    \*********************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _matches__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./matches */ "../../ui-core/plugins/polyfills/js/Element/matches.js");
  /* harmony import */ var _matches__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_matches__WEBPACK_IMPORTED_MODULE_0__);
  /**
   * Polyfill for Element.closest()
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill}
   */
  
  if (!Element.prototype.closest) Element.prototype.closest = function (s) {
    var el = this;
    if (!document.documentElement.contains(el)) return null;
  
    do {
      if (el.matches(s)) return el;
      el = el.parentElement || el.parentNode;
    } while (el !== null && el.nodeType === 1);
  
    return null;
  };
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Element/matches.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Element/matches.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * Polyfill to support matches on IE9+
   *
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill}
   */
  if (!Element.prototype.matches) Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Element/remove.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Element/remove.js ***!
    \********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/remove#Polyfill}
   */
  (function (arr) {
    arr.forEach(function (item) {
      if (item.hasOwnProperty('remove')) {
        return;
      }
  
      Object.defineProperty(item, 'remove', {
        configurable: true,
        enumerable: true,
        writable: true,
        value: function remove() {
          if (this.parentNode !== null) this.parentNode.removeChild(this);
        }
      });
    });
  })([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/NodeList/forEach.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/NodeList/forEach.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * Polyfill to add support to NodeList forEach in IE
   *
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach#Polyfill}
   */
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Object.assign.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Object.assign.js ***!
    \*******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill}
   */
  if (typeof Object.assign != 'function') {
    // Must be writable: true, enumerable: false, configurable: true
    Object.defineProperty(Object, "assign", {
      value: function assign(target, varArgs) {
        // .length of function is 2
        'use strict';
  
        if (target == null) {
          // TypeError if undefined or null
          throw new TypeError('Cannot convert undefined or null to object');
        }
  
        var to = Object(target);
  
        for (var index = 1; index < arguments.length; index++) {
          var nextSource = arguments[index];
  
          if (nextSource != null) {
            // Skip over if undefined or null
            for (var nextKey in nextSource) {
              // Avoid bugs when hasOwnProperty is shadowed
              if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                to[nextKey] = nextSource[nextKey];
              }
            }
          }
        }
  
        return to;
      },
      writable: true,
      configurable: true
    });
  }
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Promise/es6-promise.auto.min.js":
  /*!**********************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Promise/es6-promise.auto.min.js ***!
    \**********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(process, global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  !function (t, e) {
    "object" == ( false ? undefined : _typeof(exports)) && "undefined" != typeof module ? module.exports = e() :  true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (e),
          __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
          (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
          __WEBPACK_AMD_DEFINE_FACTORY__),
          __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : undefined;
  }(this, function () {
    "use strict";
  
    function t(t) {
      var e = _typeof(t);
  
      return null !== t && ("object" === e || "function" === e);
    }
  
    function e(t) {
      return "function" == typeof t;
    }
  
    function n(t) {
      B = t;
    }
  
    function r(t) {
      G = t;
    }
  
    function o() {
      return function () {
        return process.nextTick(a);
      };
    }
  
    function i() {
      return "undefined" != typeof z ? function () {
        z(a);
      } : c();
    }
  
    function s() {
      var t = 0,
          e = new J(a),
          n = document.createTextNode("");
      return e.observe(n, {
        characterData: !0
      }), function () {
        n.data = t = ++t % 2;
      };
    }
  
    function u() {
      var t = new MessageChannel();
      return t.port1.onmessage = a, function () {
        return t.port2.postMessage(0);
      };
    }
  
    function c() {
      var t = setTimeout;
      return function () {
        return t(a, 1);
      };
    }
  
    function a() {
      for (var t = 0; t < W; t += 2) {
        var e = V[t],
            n = V[t + 1];
        e(n), V[t] = void 0, V[t + 1] = void 0;
      }
  
      W = 0;
    }
  
    function f() {
      try {
        var t = Function("return this")().require("vertx");
  
        return z = t.runOnLoop || t.runOnContext, i();
      } catch (e) {
        return c();
      }
    }
  
    function l(t, e) {
      var n = this,
          r = new this.constructor(p);
      void 0 === r[Z] && O(r);
      var o = n._state;
  
      if (o) {
        var i = arguments[o - 1];
        G(function () {
          return P(o, r, i, n._result);
        });
      } else E(n, r, t, e);
  
      return r;
    }
  
    function h(t) {
      var e = this;
      if (t && "object" == _typeof(t) && t.constructor === e) return t;
      var n = new e(p);
      return g(n, t), n;
    }
  
    function p() {}
  
    function v() {
      return new TypeError("You cannot resolve a promise with itself");
    }
  
    function d() {
      return new TypeError("A promises callback cannot return that same promise.");
    }
  
    function _(t) {
      try {
        return t.then;
      } catch (e) {
        return nt.error = e, nt;
      }
    }
  
    function y(t, e, n, r) {
      try {
        t.call(e, n, r);
      } catch (o) {
        return o;
      }
    }
  
    function m(t, e, n) {
      G(function (t) {
        var r = !1,
            o = y(n, e, function (n) {
          r || (r = !0, e !== n ? g(t, n) : S(t, n));
        }, function (e) {
          r || (r = !0, j(t, e));
        }, "Settle: " + (t._label || " unknown promise"));
        !r && o && (r = !0, j(t, o));
      }, t);
    }
  
    function b(t, e) {
      e._state === tt ? S(t, e._result) : e._state === et ? j(t, e._result) : E(e, void 0, function (e) {
        return g(t, e);
      }, function (e) {
        return j(t, e);
      });
    }
  
    function w(t, n, r) {
      n.constructor === t.constructor && r === l && n.constructor.resolve === h ? b(t, n) : r === nt ? (j(t, nt.error), nt.error = null) : void 0 === r ? S(t, n) : e(r) ? m(t, n, r) : S(t, n);
    }
  
    function g(e, n) {
      e === n ? j(e, v()) : t(n) ? w(e, n, _(n)) : S(e, n);
    }
  
    function A(t) {
      t._onerror && t._onerror(t._result), T(t);
    }
  
    function S(t, e) {
      t._state === $ && (t._result = e, t._state = tt, 0 !== t._subscribers.length && G(T, t));
    }
  
    function j(t, e) {
      t._state === $ && (t._state = et, t._result = e, G(A, t));
    }
  
    function E(t, e, n, r) {
      var o = t._subscribers,
          i = o.length;
      t._onerror = null, o[i] = e, o[i + tt] = n, o[i + et] = r, 0 === i && t._state && G(T, t);
    }
  
    function T(t) {
      var e = t._subscribers,
          n = t._state;
  
      if (0 !== e.length) {
        for (var r = void 0, o = void 0, i = t._result, s = 0; s < e.length; s += 3) {
          r = e[s], o = e[s + n], r ? P(n, r, o, i) : o(i);
        }
  
        t._subscribers.length = 0;
      }
    }
  
    function M(t, e) {
      try {
        return t(e);
      } catch (n) {
        return nt.error = n, nt;
      }
    }
  
    function P(t, n, r, o) {
      var i = e(r),
          s = void 0,
          u = void 0,
          c = void 0,
          a = void 0;
  
      if (i) {
        if (s = M(r, o), s === nt ? (a = !0, u = s.error, s.error = null) : c = !0, n === s) return void j(n, d());
      } else s = o, c = !0;
  
      n._state !== $ || (i && c ? g(n, s) : a ? j(n, u) : t === tt ? S(n, s) : t === et && j(n, s));
    }
  
    function x(t, e) {
      try {
        e(function (e) {
          g(t, e);
        }, function (e) {
          j(t, e);
        });
      } catch (n) {
        j(t, n);
      }
    }
  
    function C() {
      return rt++;
    }
  
    function O(t) {
      t[Z] = rt++, t._state = void 0, t._result = void 0, t._subscribers = [];
    }
  
    function k() {
      return new Error("Array Methods must be provided an Array");
    }
  
    function F(t) {
      return new ot(this, t).promise;
    }
  
    function Y(t) {
      var e = this;
      return new e(U(t) ? function (n, r) {
        for (var o = t.length, i = 0; i < o; i++) {
          e.resolve(t[i]).then(n, r);
        }
      } : function (t, e) {
        return e(new TypeError("You must pass an array to race."));
      });
    }
  
    function q(t) {
      var e = this,
          n = new e(p);
      return j(n, t), n;
    }
  
    function D() {
      throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");
    }
  
    function K() {
      throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
    }
  
    function L() {
      var t = void 0;
      if ("undefined" != typeof global) t = global;else if ("undefined" != typeof self) t = self;else try {
        t = Function("return this")();
      } catch (e) {
        throw new Error("polyfill failed because global object is unavailable in this environment");
      }
      var n = t.Promise;
  
      if (n) {
        var r = null;
  
        try {
          r = Object.prototype.toString.call(n.resolve());
        } catch (e) {}
  
        if ("[object Promise]" === r && !n.cast) return;
      }
  
      t.Promise = it;
    }
  
    var N = void 0;
    N = Array.isArray ? Array.isArray : function (t) {
      return "[object Array]" === Object.prototype.toString.call(t);
    };
  
    var U = N,
        W = 0,
        z = void 0,
        B = void 0,
        G = function G(t, e) {
      V[W] = t, V[W + 1] = e, W += 2, 2 === W && (B ? B(a) : X());
    },
        H = "undefined" != typeof window ? window : void 0,
        I = H || {},
        J = I.MutationObserver || I.WebKitMutationObserver,
        Q = "undefined" == typeof self && "undefined" != typeof process && "[object process]" === {}.toString.call(process),
        R = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel,
        V = new Array(1e3),
        X = void 0;
  
    X = Q ? o() : J ? s() : R ? u() : void 0 === H && "function" == "function" ? f() : c();
  
    var Z = Math.random().toString(36).substring(2),
        $ = void 0,
        tt = 1,
        et = 2,
        nt = {
      error: null
    },
        rt = 0,
        ot = function () {
      function t(t, e) {
        this._instanceConstructor = t, this.promise = new t(p), this.promise[Z] || O(this.promise), U(e) ? (this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? S(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(e), 0 === this._remaining && S(this.promise, this._result))) : j(this.promise, k());
      }
  
      return t.prototype._enumerate = function (t) {
        for (var e = 0; this._state === $ && e < t.length; e++) {
          this._eachEntry(t[e], e);
        }
      }, t.prototype._eachEntry = function (t, e) {
        var n = this._instanceConstructor,
            r = n.resolve;
  
        if (r === h) {
          var o = _(t);
  
          if (o === l && t._state !== $) this._settledAt(t._state, e, t._result);else if ("function" != typeof o) this._remaining--, this._result[e] = t;else if (n === it) {
            var i = new n(p);
            w(i, t, o), this._willSettleAt(i, e);
          } else this._willSettleAt(new n(function (e) {
            return e(t);
          }), e);
        } else this._willSettleAt(r(t), e);
      }, t.prototype._settledAt = function (t, e, n) {
        var r = this.promise;
        r._state === $ && (this._remaining--, t === et ? j(r, n) : this._result[e] = n), 0 === this._remaining && S(r, this._result);
      }, t.prototype._willSettleAt = function (t, e) {
        var n = this;
        E(t, void 0, function (t) {
          return n._settledAt(tt, e, t);
        }, function (t) {
          return n._settledAt(et, e, t);
        });
      }, t;
    }(),
        it = function () {
      function t(e) {
        this[Z] = C(), this._result = this._state = void 0, this._subscribers = [], p !== e && ("function" != typeof e && D(), this instanceof t ? x(this, e) : K());
      }
  
      return t.prototype["catch"] = function (t) {
        return this.then(null, t);
      }, t.prototype["finally"] = function (t) {
        var n = this,
            r = n.constructor;
        return e(t) ? n.then(function (e) {
          return r.resolve(t()).then(function () {
            return e;
          });
        }, function (e) {
          return r.resolve(t()).then(function () {
            throw e;
          });
        }) : n.then(t, t);
      }, t;
    }();
  
    return it.prototype.then = l, it.all = F, it.race = Y, it.resolve = h, it.reject = q, it._setScheduler = n, it._setAsap = r, it._asap = G, it.polyfill = L, it.Promise = it, it.polyfill(), it;
  });
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/process/browser.js */ "./node_modules/process/browser.js"), __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Promise/es6-promise.min.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Promise/es6-promise.min.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(process, global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  !function (t, e) {
    "object" == ( false ? undefined : _typeof(exports)) && "undefined" != typeof module ? module.exports = e() :  true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (e),
          __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
          (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
          __WEBPACK_AMD_DEFINE_FACTORY__),
          __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : undefined;
  }(this, function () {
    "use strict";
  
    function t(t) {
      var e = _typeof(t);
  
      return null !== t && ("object" === e || "function" === e);
    }
  
    function e(t) {
      return "function" == typeof t;
    }
  
    function n(t) {
      B = t;
    }
  
    function r(t) {
      G = t;
    }
  
    function o() {
      return function () {
        return process.nextTick(a);
      };
    }
  
    function i() {
      return "undefined" != typeof z ? function () {
        z(a);
      } : c();
    }
  
    function s() {
      var t = 0,
          e = new J(a),
          n = document.createTextNode("");
      return e.observe(n, {
        characterData: !0
      }), function () {
        n.data = t = ++t % 2;
      };
    }
  
    function u() {
      var t = new MessageChannel();
      return t.port1.onmessage = a, function () {
        return t.port2.postMessage(0);
      };
    }
  
    function c() {
      var t = setTimeout;
      return function () {
        return t(a, 1);
      };
    }
  
    function a() {
      for (var t = 0; t < W; t += 2) {
        var e = V[t],
            n = V[t + 1];
        e(n), V[t] = void 0, V[t + 1] = void 0;
      }
  
      W = 0;
    }
  
    function f() {
      try {
        var t = Function("return this")().require("vertx");
  
        return z = t.runOnLoop || t.runOnContext, i();
      } catch (e) {
        return c();
      }
    }
  
    function l(t, e) {
      var n = this,
          r = new this.constructor(p);
      void 0 === r[Z] && O(r);
      var o = n._state;
  
      if (o) {
        var i = arguments[o - 1];
        G(function () {
          return P(o, r, i, n._result);
        });
      } else E(n, r, t, e);
  
      return r;
    }
  
    function h(t) {
      var e = this;
      if (t && "object" == _typeof(t) && t.constructor === e) return t;
      var n = new e(p);
      return g(n, t), n;
    }
  
    function p() {}
  
    function v() {
      return new TypeError("You cannot resolve a promise with itself");
    }
  
    function d() {
      return new TypeError("A promises callback cannot return that same promise.");
    }
  
    function _(t) {
      try {
        return t.then;
      } catch (e) {
        return nt.error = e, nt;
      }
    }
  
    function y(t, e, n, r) {
      try {
        t.call(e, n, r);
      } catch (o) {
        return o;
      }
    }
  
    function m(t, e, n) {
      G(function (t) {
        var r = !1,
            o = y(n, e, function (n) {
          r || (r = !0, e !== n ? g(t, n) : S(t, n));
        }, function (e) {
          r || (r = !0, j(t, e));
        }, "Settle: " + (t._label || " unknown promise"));
        !r && o && (r = !0, j(t, o));
      }, t);
    }
  
    function b(t, e) {
      e._state === tt ? S(t, e._result) : e._state === et ? j(t, e._result) : E(e, void 0, function (e) {
        return g(t, e);
      }, function (e) {
        return j(t, e);
      });
    }
  
    function w(t, n, r) {
      n.constructor === t.constructor && r === l && n.constructor.resolve === h ? b(t, n) : r === nt ? (j(t, nt.error), nt.error = null) : void 0 === r ? S(t, n) : e(r) ? m(t, n, r) : S(t, n);
    }
  
    function g(e, n) {
      e === n ? j(e, v()) : t(n) ? w(e, n, _(n)) : S(e, n);
    }
  
    function A(t) {
      t._onerror && t._onerror(t._result), T(t);
    }
  
    function S(t, e) {
      t._state === $ && (t._result = e, t._state = tt, 0 !== t._subscribers.length && G(T, t));
    }
  
    function j(t, e) {
      t._state === $ && (t._state = et, t._result = e, G(A, t));
    }
  
    function E(t, e, n, r) {
      var o = t._subscribers,
          i = o.length;
      t._onerror = null, o[i] = e, o[i + tt] = n, o[i + et] = r, 0 === i && t._state && G(T, t);
    }
  
    function T(t) {
      var e = t._subscribers,
          n = t._state;
  
      if (0 !== e.length) {
        for (var r = void 0, o = void 0, i = t._result, s = 0; s < e.length; s += 3) {
          r = e[s], o = e[s + n], r ? P(n, r, o, i) : o(i);
        }
  
        t._subscribers.length = 0;
      }
    }
  
    function M(t, e) {
      try {
        return t(e);
      } catch (n) {
        return nt.error = n, nt;
      }
    }
  
    function P(t, n, r, o) {
      var i = e(r),
          s = void 0,
          u = void 0,
          c = void 0,
          a = void 0;
  
      if (i) {
        if (s = M(r, o), s === nt ? (a = !0, u = s.error, s.error = null) : c = !0, n === s) return void j(n, d());
      } else s = o, c = !0;
  
      n._state !== $ || (i && c ? g(n, s) : a ? j(n, u) : t === tt ? S(n, s) : t === et && j(n, s));
    }
  
    function x(t, e) {
      try {
        e(function (e) {
          g(t, e);
        }, function (e) {
          j(t, e);
        });
      } catch (n) {
        j(t, n);
      }
    }
  
    function C() {
      return rt++;
    }
  
    function O(t) {
      t[Z] = rt++, t._state = void 0, t._result = void 0, t._subscribers = [];
    }
  
    function k() {
      return new Error("Array Methods must be provided an Array");
    }
  
    function F(t) {
      return new ot(this, t).promise;
    }
  
    function Y(t) {
      var e = this;
      return new e(U(t) ? function (n, r) {
        for (var o = t.length, i = 0; i < o; i++) {
          e.resolve(t[i]).then(n, r);
        }
      } : function (t, e) {
        return e(new TypeError("You must pass an array to race."));
      });
    }
  
    function q(t) {
      var e = this,
          n = new e(p);
      return j(n, t), n;
    }
  
    function D() {
      throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");
    }
  
    function K() {
      throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
    }
  
    function L() {
      var t = void 0;
      if ("undefined" != typeof global) t = global;else if ("undefined" != typeof self) t = self;else try {
        t = Function("return this")();
      } catch (e) {
        throw new Error("polyfill failed because global object is unavailable in this environment");
      }
      var n = t.Promise;
  
      if (n) {
        var r = null;
  
        try {
          r = Object.prototype.toString.call(n.resolve());
        } catch (e) {}
  
        if ("[object Promise]" === r && !n.cast) return;
      }
  
      t.Promise = it;
    }
  
    var N = void 0;
    N = Array.isArray ? Array.isArray : function (t) {
      return "[object Array]" === Object.prototype.toString.call(t);
    };
  
    var U = N,
        W = 0,
        z = void 0,
        B = void 0,
        G = function G(t, e) {
      V[W] = t, V[W + 1] = e, W += 2, 2 === W && (B ? B(a) : X());
    },
        H = "undefined" != typeof window ? window : void 0,
        I = H || {},
        J = I.MutationObserver || I.WebKitMutationObserver,
        Q = "undefined" == typeof self && "undefined" != typeof process && "[object process]" === {}.toString.call(process),
        R = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel,
        V = new Array(1e3),
        X = void 0;
  
    X = Q ? o() : J ? s() : R ? u() : void 0 === H && "function" == "function" ? f() : c();
  
    var Z = Math.random().toString(36).substring(2),
        $ = void 0,
        tt = 1,
        et = 2,
        nt = {
      error: null
    },
        rt = 0,
        ot = function () {
      function t(t, e) {
        this._instanceConstructor = t, this.promise = new t(p), this.promise[Z] || O(this.promise), U(e) ? (this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? S(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(e), 0 === this._remaining && S(this.promise, this._result))) : j(this.promise, k());
      }
  
      return t.prototype._enumerate = function (t) {
        for (var e = 0; this._state === $ && e < t.length; e++) {
          this._eachEntry(t[e], e);
        }
      }, t.prototype._eachEntry = function (t, e) {
        var n = this._instanceConstructor,
            r = n.resolve;
  
        if (r === h) {
          var o = _(t);
  
          if (o === l && t._state !== $) this._settledAt(t._state, e, t._result);else if ("function" != typeof o) this._remaining--, this._result[e] = t;else if (n === it) {
            var i = new n(p);
            w(i, t, o), this._willSettleAt(i, e);
          } else this._willSettleAt(new n(function (e) {
            return e(t);
          }), e);
        } else this._willSettleAt(r(t), e);
      }, t.prototype._settledAt = function (t, e, n) {
        var r = this.promise;
        r._state === $ && (this._remaining--, t === et ? j(r, n) : this._result[e] = n), 0 === this._remaining && S(r, this._result);
      }, t.prototype._willSettleAt = function (t, e) {
        var n = this;
        E(t, void 0, function (t) {
          return n._settledAt(tt, e, t);
        }, function (t) {
          return n._settledAt(et, e, t);
        });
      }, t;
    }(),
        it = function () {
      function t(e) {
        this[Z] = C(), this._result = this._state = void 0, this._subscribers = [], p !== e && ("function" != typeof e && D(), this instanceof t ? x(this, e) : K());
      }
  
      return t.prototype["catch"] = function (t) {
        return this.then(null, t);
      }, t.prototype["finally"] = function (t) {
        var n = this,
            r = n.constructor;
        return e(t) ? n.then(function (e) {
          return r.resolve(t()).then(function () {
            return e;
          });
        }, function (e) {
          return r.resolve(t()).then(function () {
            throw e;
          });
        }) : n.then(t, t);
      }, t;
    }();
  
    return it.prototype.then = l, it.all = F, it.race = Y, it.resolve = h, it.reject = q, it._setScheduler = n, it._setAsap = r, it._asap = G, it.polyfill = L, it.Promise = it, it;
  });
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/process/browser.js */ "./node_modules/process/browser.js"), __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Promise/index.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Promise/index.js ***!
    \*******************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _setAsap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./setAsap */ "../../ui-core/plugins/polyfills/js/Promise/setAsap.js");
  /* harmony import */ var _setAsap__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_setAsap__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _promise_polyfill__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./promise-polyfill */ "../../ui-core/plugins/polyfills/js/Promise/promise-polyfill.js");
  /* harmony import */ var _promise_polyfill__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_promise_polyfill__WEBPACK_IMPORTED_MODULE_1__);
  
  
  /* harmony default export */ __webpack_exports__["default"] = (Promise);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Promise/promise-polyfill.js":
  /*!******************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Promise/promise-polyfill.js ***!
    \******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(setImmediate, global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  (function (global, factory) {
    ( false ? undefined : _typeof(exports)) === 'object' && typeof module !== 'undefined' ? factory() :  true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
          __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
          (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
          __WEBPACK_AMD_DEFINE_FACTORY__),
          __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : undefined;
  })(this, function () {
    'use strict';
    /**
     * @this {Promise}
     */
  
    function finallyConstructor(callback) {
      var constructor = this.constructor;
      return this.then(function (value) {
        return constructor.resolve(callback()).then(function () {
          return value;
        });
      }, function (reason) {
        return constructor.resolve(callback()).then(function () {
          return constructor.reject(reason);
        });
      });
    } // Store setTimeout reference so promise-polyfill will be unaffected by
    // other code modifying setTimeout (like sinon.useFakeTimers())
  
  
    var setTimeoutFunc = setTimeout;
  
    function noop() {} // Polyfill for Function.prototype.bind
  
  
    function bind(fn, thisArg) {
      return function () {
        fn.apply(thisArg, arguments);
      };
    }
    /**
     * @constructor
     * @param {Function} fn
     */
  
  
    function Promise(fn) {
      if (!(this instanceof Promise)) throw new TypeError('Promises must be constructed via new');
      if (typeof fn !== 'function') throw new TypeError('not a function');
      /** @type {!number} */
  
      this._state = 0;
      /** @type {!boolean} */
  
      this._handled = false;
      /** @type {Promise|undefined} */
  
      this._value = undefined;
      /** @type {!Array<!Function>} */
  
      this._deferreds = [];
      doResolve(fn, this);
    }
  
    function handle(self, deferred) {
      while (self._state === 3) {
        self = self._value;
      }
  
      if (self._state === 0) {
        self._deferreds.push(deferred);
  
        return;
      }
  
      self._handled = true;
  
      Promise._immediateFn(function () {
        var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;
  
        if (cb === null) {
          (self._state === 1 ? resolve : reject)(deferred.promise, self._value);
          return;
        }
  
        var ret;
  
        try {
          ret = cb(self._value);
        } catch (e) {
          reject(deferred.promise, e);
          return;
        }
  
        resolve(deferred.promise, ret);
      });
    }
  
    function resolve(self, newValue) {
      try {
        // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure
        if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');
  
        if (newValue && (_typeof(newValue) === 'object' || typeof newValue === 'function')) {
          var then = newValue.then;
  
          if (newValue instanceof Promise) {
            self._state = 3;
            self._value = newValue;
            finale(self);
            return;
          } else if (typeof then === 'function') {
            doResolve(bind(then, newValue), self);
            return;
          }
        }
  
        self._state = 1;
        self._value = newValue;
        finale(self);
      } catch (e) {
        reject(self, e);
      }
    }
  
    function reject(self, newValue) {
      self._state = 2;
      self._value = newValue;
      finale(self);
    }
  
    function finale(self) {
      if (self._state === 2 && self._deferreds.length === 0) {
        Promise._immediateFn(function () {
          if (!self._handled) {
            Promise._unhandledRejectionFn(self._value);
          }
        });
      }
  
      for (var i = 0, len = self._deferreds.length; i < len; i++) {
        handle(self, self._deferreds[i]);
      }
  
      self._deferreds = null;
    }
    /**
     * @constructor
     */
  
  
    function Handler(onFulfilled, onRejected, promise) {
      this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;
      this.onRejected = typeof onRejected === 'function' ? onRejected : null;
      this.promise = promise;
    }
    /**
     * Take a potentially misbehaving resolver function and make sure
     * onFulfilled and onRejected are only called once.
     *
     * Makes no guarantees about asynchrony.
     */
  
  
    function doResolve(fn, self) {
      var done = false;
  
      try {
        fn(function (value) {
          if (done) return;
          done = true;
          resolve(self, value);
        }, function (reason) {
          if (done) return;
          done = true;
          reject(self, reason);
        });
      } catch (ex) {
        if (done) return;
        done = true;
        reject(self, ex);
      }
    }
  
    Promise.prototype['catch'] = function (onRejected) {
      return this.then(null, onRejected);
    };
  
    Promise.prototype.then = function (onFulfilled, onRejected) {
      // @ts-ignore
      var prom = new this.constructor(noop);
      handle(this, new Handler(onFulfilled, onRejected, prom));
      return prom;
    };
  
    Promise.prototype['finally'] = finallyConstructor;
  
    Promise.all = function (arr) {
      return new Promise(function (resolve, reject) {
        if (!arr || typeof arr.length === 'undefined') throw new TypeError('Promise.all accepts an array');
        var args = Array.prototype.slice.call(arr);
        if (args.length === 0) return resolve([]);
        var remaining = args.length;
  
        function res(i, val) {
          try {
            if (val && (_typeof(val) === 'object' || typeof val === 'function')) {
              var then = val.then;
  
              if (typeof then === 'function') {
                then.call(val, function (val) {
                  res(i, val);
                }, reject);
                return;
              }
            }
  
            args[i] = val;
  
            if (--remaining === 0) {
              resolve(args);
            }
          } catch (ex) {
            reject(ex);
          }
        }
  
        for (var i = 0; i < args.length; i++) {
          res(i, args[i]);
        }
      });
    };
  
    Promise.resolve = function (value) {
      if (value && _typeof(value) === 'object' && value.constructor === Promise) {
        return value;
      }
  
      return new Promise(function (resolve) {
        resolve(value);
      });
    };
  
    Promise.reject = function (value) {
      return new Promise(function (resolve, reject) {
        reject(value);
      });
    };
  
    Promise.race = function (values) {
      return new Promise(function (resolve, reject) {
        for (var i = 0, len = values.length; i < len; i++) {
          values[i].then(resolve, reject);
        }
      });
    }; // Use polyfill for setImmediate for performance gains
  
  
    Promise._immediateFn = typeof setImmediate === 'function' && function (fn) {
      setImmediate(fn);
    } || function (fn) {
      setTimeoutFunc(fn, 0);
    };
  
    Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {
      if (typeof console !== 'undefined' && console) {
        console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console
      }
    };
    /** @suppress {undefinedVars} */
  
  
    var globalNS = function () {
      // the only reliable means to get the global object is
      // `Function('return this')()`
      // However, this causes CSP violations in Chrome apps.
      if (typeof self !== 'undefined') {
        return self;
      }
  
      if (typeof window !== 'undefined') {
        return window;
      }
  
      if (typeof global !== 'undefined') {
        return global;
      }
  
      throw new Error('unable to locate global object');
    }();
  
    if (!('Promise' in globalNS)) {
      globalNS['Promise'] = Promise;
    } else if (!globalNS.Promise.prototype['finally']) {
      globalNS.Promise.prototype['finally'] = finallyConstructor;
    }
  });
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/timers-browserify/main.js */ "./node_modules/timers-browserify/main.js").setImmediate, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/Promise/setAsap.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/Promise/setAsap.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global, setImmediate, process) {var __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  (function (thisVar, undefined) {
    'use strict';
  
    var main = (typeof window === "undefined" ? "undefined" : _typeof(window)) === 'object' && window || (typeof global === "undefined" ? "undefined" : _typeof(global)) === 'object' && global || (typeof self === "undefined" ? "undefined" : _typeof(self)) === 'object' && self || thisVar;
    var hasSetImmediate = typeof setImmediate === 'function';
    var hasNextTick = (typeof process === "undefined" ? "undefined" : _typeof(process)) === 'object' && !!process && typeof process.nextTick === 'function';
    var index = 0;
  
    function getNewIndex() {
      if (index === 9007199254740991) {
        return 0;
      }
  
      return ++index;
    }
  
    var setAsap = function () {
      var hiddenDiv, scriptEl, timeoutFn, callbacks; // Modern browsers, fastest async
  
      if (main.MutationObserver) {
        return function setAsap(callback) {
          hiddenDiv = document.createElement("div");
          new MutationObserver(function () {
            callback();
            hiddenDiv = null;
          }).observe(hiddenDiv, {
            attributes: true
          });
          hiddenDiv.setAttribute('i', '1');
        }; // Browsers that support postMessage
      } else if (!hasSetImmediate && main.postMessage && !main.importScripts && main.addEventListener) {
        var MESSAGE_PREFIX = "com.setImmediate" + Math.random();
        callbacks = {};
  
        var onGlobalMessage = function onGlobalMessage(event) {
          if (event.source === main && event.data.indexOf(MESSAGE_PREFIX) === 0) {
            var i = +event.data.split(':')[1];
            callbacks[i]();
            delete callbacks[i];
          }
        };
  
        main.addEventListener("message", onGlobalMessage, false);
        return function setAsap(callback) {
          var i = getNewIndex();
          callbacks[i] = callback;
          main.postMessage(MESSAGE_PREFIX + ':' + i, "*");
        }; // IE browsers without postMessage
      } else if (!hasSetImmediate && main.document && 'onreadystatechange' in document.createElement('script')) {
        return function setAsap(callback) {
          scriptEl = document.createElement("script");
  
          scriptEl.onreadystatechange = function onreadystatechange() {
            scriptEl.onreadystatechange = null;
            scriptEl.parentNode.removeChild(scriptEl);
            scriptEl = null;
            callback();
          };
  
          document.body.appendChild(scriptEl);
        }; // All other browsers and node
      } else {
        timeoutFn = hasSetImmediate && setImmediate || hasNextTick && process.nextTick || setTimeout;
        return function setAsap(callback) {
          timeoutFn(callback);
        };
      }
    }();
  
    if ( true && module.exports) {
      module.exports = setAsap;
    } else if (true) {
      !(__WEBPACK_AMD_DEFINE_RESULT__ = (function () {
        return setAsap;
      }).call(exports, __webpack_require__, exports, module),
          __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    } else {}
  })(this);
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js"), __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/timers-browserify/main.js */ "./node_modules/timers-browserify/main.js").setImmediate, __webpack_require__(/*! ./../../../../../ui-products/sbn/node_modules/process/browser.js */ "./node_modules/process/browser.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/String/format.js":
  /*!*******************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/String/format.js ***!
    \*******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /**
   * {@link https://gist.github.com/darthwade/9310975}
   */
  if (!String.prototype.format) {
    String.prototype.format = function () {
      var args = arguments;
      return this.replace(/{(\d+)}/g, function (match, number) {
        return typeof args[number] != 'undefined' ? args[number] : match;
      });
    };
  }
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/String/includes.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/String/includes.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // fallback for {string}.includes()
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';
  
      if (typeof start !== 'number') {
        start = 0;
      }
  
      if (start + search.length > this.length) {
        return false;
      } else {
        return this.indexOf(search, start) !== -1;
      }
    };
  }
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/polyfill.object.values.js":
  /*!****************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/polyfill.object.values.js ***!
    \****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  /// IE 11 (and older browsers) support for Object.values
  Object.values = Object.values || function (object) {
    return Object.keys(object).map(function (e) {
      return object[e];
    });
  };
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/polyfills/js/resizeObserverPolyfill/dist/ResizeObserver.js":
  /*!************************************************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/polyfills/js/resizeObserverPolyfill/dist/ResizeObserver.js ***!
    \************************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global) {(function (global, factory) {
    // LIT-230292 - UMD causing problems in SourceJs, so we are always using the browser globals pattern
    global.ResizeObserver = factory();
  })(this, function () {
    'use strict';
    /**
     * A collection of shims that provide minimal functionality of the ES6 collections.
     *
     * These implementations are not meant to be used outside of the ResizeObserver
     * modules as they cover only a limited range of use cases.
     */
  
    /* eslint-disable require-jsdoc, valid-jsdoc */
  
    var MapShim = function () {
      if (typeof Map !== 'undefined') {
        return Map;
      }
      /**
       * Returns index in provided array that matches the specified key.
       *
       * @param {Array<Array>} arr
       * @param {*} key
       * @returns {number}
       */
  
  
      function getIndex(arr, key) {
        var result = -1;
        arr.some(function (entry, index) {
          if (entry[0] === key) {
            result = index;
            return true;
          }
  
          return false;
        });
        return result;
      }
  
      return function () {
        function anonymous() {
          this.__entries__ = [];
        }
  
        var prototypeAccessors = {
          size: {
            configurable: true
          }
        };
        /**
         * @returns {boolean}
         */
  
        prototypeAccessors.size.get = function () {
          return this.__entries__.length;
        };
        /**
         * @param {*} key
         * @returns {*}
         */
  
  
        anonymous.prototype.get = function (key) {
          var index = getIndex(this.__entries__, key);
          var entry = this.__entries__[index];
          return entry && entry[1];
        };
        /**
         * @param {*} key
         * @param {*} value
         * @returns {void}
         */
  
  
        anonymous.prototype.set = function (key, value) {
          var index = getIndex(this.__entries__, key);
  
          if (~index) {
            this.__entries__[index][1] = value;
          } else {
            this.__entries__.push([key, value]);
          }
        };
        /**
         * @param {*} key
         * @returns {void}
         */
  
  
        anonymous.prototype["delete"] = function (key) {
          var entries = this.__entries__;
          var index = getIndex(entries, key);
  
          if (~index) {
            entries.splice(index, 1);
          }
        };
        /**
         * @param {*} key
         * @returns {void}
         */
  
  
        anonymous.prototype.has = function (key) {
          return !!~getIndex(this.__entries__, key);
        };
        /**
         * @returns {void}
         */
  
  
        anonymous.prototype.clear = function () {
          this.__entries__.splice(0);
        };
        /**
         * @param {Function} callback
         * @param {*} [ctx=null]
         * @returns {void}
         */
  
  
        anonymous.prototype.forEach = function (callback, ctx) {
          var this$1 = this;
          if (ctx === void 0) ctx = null;
  
          for (var i = 0, list = this$1.__entries__; i < list.length; i += 1) {
            var entry = list[i];
            callback.call(ctx, entry[1], entry[0]);
          }
        };
  
        Object.defineProperties(anonymous.prototype, prototypeAccessors);
        return anonymous;
      }();
    }();
    /**
     * Detects whether window and document objects are available in current environment.
     */
  
  
    var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && window.document === document; // Returns global object of a current environment.
  
    var global$1 = function () {
      if (typeof global !== 'undefined' && global.Math === Math) {
        return global;
      }
  
      if (typeof self !== 'undefined' && self.Math === Math) {
        return self;
      }
  
      if (typeof window !== 'undefined' && window.Math === Math) {
        return window;
      } // eslint-disable-next-line no-new-func
  
  
      return Function('return this')();
    }();
    /**
     * A shim for the requestAnimationFrame which falls back to the setTimeout if
     * first one is not supported.
     *
     * @returns {number} Requests' identifier.
     */
  
  
    var requestAnimationFrame$1 = function () {
      if (typeof requestAnimationFrame === 'function') {
        // It's required to use a bounded function because IE sometimes throws
        // an "Invalid calling object" error if rAF is invoked without the global
        // object on the left hand side.
        return requestAnimationFrame.bind(global$1);
      }
  
      return function (callback) {
        return setTimeout(function () {
          return callback(Date.now());
        }, 1000 / 60);
      };
    }(); // Defines minimum timeout before adding a trailing call.
  
  
    var trailingTimeout = 2;
    /**
     * Creates a wrapper function which ensures that provided callback will be
     * invoked only once during the specified delay period.
     *
     * @param {Function} callback - Function to be invoked after the delay period.
     * @param {number} delay - Delay after which to invoke callback.
     * @returns {Function}
     */
  
    var throttle = function throttle(callback, delay) {
      var leadingCall = false,
          trailingCall = false,
          lastCallTime = 0;
      /**
       * Invokes the original callback function and schedules new invocation if
       * the "proxy" was called during current request.
       *
       * @returns {void}
       */
  
      function resolvePending() {
        if (leadingCall) {
          leadingCall = false;
          callback();
        }
  
        if (trailingCall) {
          proxy();
        }
      }
      /**
       * Callback invoked after the specified delay. It will further postpone
       * invocation of the original function delegating it to the
       * requestAnimationFrame.
       *
       * @returns {void}
       */
  
  
      function timeoutCallback() {
        requestAnimationFrame$1(resolvePending);
      }
      /**
       * Schedules invocation of the original function.
       *
       * @returns {void}
       */
  
  
      function proxy() {
        var timeStamp = Date.now();
  
        if (leadingCall) {
          // Reject immediately following calls.
          if (timeStamp - lastCallTime < trailingTimeout) {
            return;
          } // Schedule new call to be in invoked when the pending one is resolved.
          // This is important for "transitions" which never actually start
          // immediately so there is a chance that we might miss one if change
          // happens amids the pending invocation.
  
  
          trailingCall = true;
        } else {
          leadingCall = true;
          trailingCall = false;
          setTimeout(timeoutCallback, delay);
        }
  
        lastCallTime = timeStamp;
      }
  
      return proxy;
    }; // Minimum delay before invoking the update of observers.
  
  
    var REFRESH_DELAY = 20; // A list of substrings of CSS properties used to find transition events that
    // might affect dimensions of observed elements.
  
    var transitionKeys = ['top', 'right', 'bottom', 'left', 'width', 'height', 'size', 'weight']; // Check if MutationObserver is available.
  
    var mutationObserverSupported = typeof MutationObserver !== 'undefined';
    /**
     * Singleton controller class which handles updates of ResizeObserver instances.
     */
  
    var ResizeObserverController = function ResizeObserverController() {
      this.connected_ = false;
      this.mutationEventsAdded_ = false;
      this.mutationsObserver_ = null;
      this.observers_ = [];
      this.onTransitionEnd_ = this.onTransitionEnd_.bind(this);
      this.refresh = throttle(this.refresh.bind(this), REFRESH_DELAY);
    };
    /**
     * Adds observer to observers list.
     *
     * @param {ResizeObserverSPI} observer - Observer to be added.
     * @returns {void}
     */
  
    /**
     * Holds reference to the controller's instance.
     *
     * @private {ResizeObserverController}
     */
  
    /**
     * Keeps reference to the instance of MutationObserver.
     *
     * @private {MutationObserver}
     */
  
    /**
     * Indicates whether DOM listeners have been added.
     *
     * @private {boolean}
     */
  
  
    ResizeObserverController.prototype.addObserver = function (observer) {
      if (!~this.observers_.indexOf(observer)) {
        this.observers_.push(observer);
      } // Add listeners if they haven't been added yet.
  
  
      if (!this.connected_) {
        this.connect_();
      }
    };
    /**
     * Removes observer from observers list.
     *
     * @param {ResizeObserverSPI} observer - Observer to be removed.
     * @returns {void}
     */
  
  
    ResizeObserverController.prototype.removeObserver = function (observer) {
      var observers = this.observers_;
      var index = observers.indexOf(observer); // Remove observer if it's present in registry.
  
      if (~index) {
        observers.splice(index, 1);
      } // Remove listeners if controller has no connected observers.
  
  
      if (!observers.length && this.connected_) {
        this.disconnect_();
      }
    };
    /**
     * Invokes the update of observers. It will continue running updates insofar
     * it detects changes.
     *
     * @returns {void}
     */
  
  
    ResizeObserverController.prototype.refresh = function () {
      var changesDetected = this.updateObservers_(); // Continue running updates if changes have been detected as there might
      // be future ones caused by CSS transitions.
  
      if (changesDetected) {
        this.refresh();
      }
    };
    /**
     * Updates every observer from observers list and notifies them of queued
     * entries.
     *
     * @private
     * @returns {boolean} Returns "true" if any observer has detected changes in
     *  dimensions of it's elements.
     */
  
  
    ResizeObserverController.prototype.updateObservers_ = function () {
      // Collect observers that have active observations.
      var activeObservers = this.observers_.filter(function (observer) {
        return observer.gatherActive(), observer.hasActive();
      }); // Deliver notifications in a separate cycle in order to avoid any
      // collisions between observers, e.g. when multiple instances of
      // ResizeObserver are tracking the same element and the callback of one
      // of them changes content dimensions of the observed target. Sometimes
      // this may result in notifications being blocked for the rest of observers.
  
      activeObservers.forEach(function (observer) {
        return observer.broadcastActive();
      });
      return activeObservers.length > 0;
    };
    /**
     * Initializes DOM listeners.
     *
     * @private
     * @returns {void}
     */
  
  
    ResizeObserverController.prototype.connect_ = function () {
      // Do nothing if running in a non-browser environment or if listeners
      // have been already added.
      if (!isBrowser || this.connected_) {
        return;
      } // Subscription to the "Transitionend" event is used as a workaround for
      // delayed transitions. This way it's possible to capture at least the
      // final state of an element.
  
  
      document.addEventListener('transitionend', this.onTransitionEnd_);
      window.addEventListener('resize', this.refresh);
  
      if (mutationObserverSupported) {
        this.mutationsObserver_ = new MutationObserver(this.refresh);
        this.mutationsObserver_.observe(document, {
          attributes: true,
          childList: true,
          characterData: true,
          subtree: true
        });
      } else {
        document.addEventListener('DOMSubtreeModified', this.refresh);
        this.mutationEventsAdded_ = true;
      }
  
      this.connected_ = true;
    };
    /**
     * Removes DOM listeners.
     *
     * @private
     * @returns {void}
     */
  
  
    ResizeObserverController.prototype.disconnect_ = function () {
      // Do nothing if running in a non-browser environment or if listeners
      // have been already removed.
      if (!isBrowser || !this.connected_) {
        return;
      }
  
      document.removeEventListener('transitionend', this.onTransitionEnd_);
      window.removeEventListener('resize', this.refresh);
  
      if (this.mutationsObserver_) {
        this.mutationsObserver_.disconnect();
      }
  
      if (this.mutationEventsAdded_) {
        document.removeEventListener('DOMSubtreeModified', this.refresh);
      }
  
      this.mutationsObserver_ = null;
      this.mutationEventsAdded_ = false;
      this.connected_ = false;
    };
    /**
     * "Transitionend" event handler.
     *
     * @private
     * @param {TransitionEvent} event
     * @returns {void}
     */
  
  
    ResizeObserverController.prototype.onTransitionEnd_ = function (ref) {
      var propertyName = ref.propertyName;
      if (propertyName === void 0) propertyName = ''; // Detect whether transition may affect dimensions of an element.
  
      var isReflowProperty = transitionKeys.some(function (key) {
        return !!~propertyName.indexOf(key);
      });
  
      if (isReflowProperty) {
        this.refresh();
      }
    };
    /**
     * Returns instance of the ResizeObserverController.
     *
     * @returns {ResizeObserverController}
     */
  
  
    ResizeObserverController.getInstance = function () {
      if (!this.instance_) {
        this.instance_ = new ResizeObserverController();
      }
  
      return this.instance_;
    };
  
    ResizeObserverController.instance_ = null;
    /**
     * Defines non-writable/enumerable properties of the provided target object.
     *
     * @param {Object} target - Object for which to define properties.
     * @param {Object} props - Properties to be defined.
     * @returns {Object} Target object.
     */
  
    var defineConfigurable = function defineConfigurable(target, props) {
      for (var i = 0, list = Object.keys(props); i < list.length; i += 1) {
        var key = list[i];
        Object.defineProperty(target, key, {
          value: props[key],
          enumerable: false,
          writable: false,
          configurable: true
        });
      }
  
      return target;
    };
    /**
     * Returns the global object associated with provided element.
     *
     * @param {Object} target
     * @returns {Object}
     */
  
  
    var getWindowOf = function getWindowOf(target) {
      // Assume that the element is an instance of Node, which means that it
      // has the "ownerDocument" property from which we can retrieve a
      // corresponding global object.
      var ownerGlobal = target && target.ownerDocument && target.ownerDocument.defaultView; // Return the local global object if it's not possible extract one from
      // provided element.
  
      return ownerGlobal || global$1;
    }; // Placeholder of an empty content rectangle.
  
  
    var emptyRect = createRectInit(0, 0, 0, 0);
    /**
     * Converts provided string to a number.
     *
     * @param {number|string} value
     * @returns {number}
     */
  
    function toFloat(value) {
      return parseFloat(value) || 0;
    }
    /**
     * Extracts borders size from provided styles.
     *
     * @param {CSSStyleDeclaration} styles
     * @param {...string} positions - Borders positions (top, right, ...)
     * @returns {number}
     */
  
  
    function getBordersSize(styles) {
      var positions = [],
          len = arguments.length - 1;
  
      while (len-- > 0) {
        positions[len] = arguments[len + 1];
      }
  
      return positions.reduce(function (size, position) {
        var value = styles['border-' + position + '-width'];
        return size + toFloat(value);
      }, 0);
    }
    /**
     * Extracts paddings sizes from provided styles.
     *
     * @param {CSSStyleDeclaration} styles
     * @returns {Object} Paddings box.
     */
  
  
    function getPaddings(styles) {
      var positions = ['top', 'right', 'bottom', 'left'];
      var paddings = {};
  
      for (var i = 0, list = positions; i < list.length; i += 1) {
        var position = list[i];
        var value = styles['padding-' + position];
        paddings[position] = toFloat(value);
      }
  
      return paddings;
    }
    /**
     * Calculates content rectangle of provided SVG element.
     *
     * @param {SVGGraphicsElement} target - Element content rectangle of which needs
     *      to be calculated.
     * @returns {DOMRectInit}
     */
  
  
    function getSVGContentRect(target) {
      var bbox = target.getBBox();
      return createRectInit(0, 0, bbox.width, bbox.height);
    }
    /**
     * Calculates content rectangle of provided HTMLElement.
     *
     * @param {HTMLElement} target - Element for which to calculate the content rectangle.
     * @returns {DOMRectInit}
     */
  
  
    function getHTMLElementContentRect(target) {
      // Client width & height properties can't be
      // used exclusively as they provide rounded values.
      var clientWidth = target.clientWidth;
      var clientHeight = target.clientHeight; // By this condition we can catch all non-replaced inline, hidden and
      // detached elements. Though elements with width & height properties less
      // than 0.5 will be discarded as well.
      //
      // Without it we would need to implement separate methods for each of
      // those cases and it's not possible to perform a precise and performance
      // effective test for hidden elements. E.g. even jQuery's ':visible' filter
      // gives wrong results for elements with width & height less than 0.5.
  
      if (!clientWidth && !clientHeight) {
        return emptyRect;
      }
  
      var styles = getWindowOf(target).getComputedStyle(target);
      var paddings = getPaddings(styles);
      var horizPad = paddings.left + paddings.right;
      var vertPad = paddings.top + paddings.bottom; // Computed styles of width & height are being used because they are the
      // only dimensions available to JS that contain non-rounded values. It could
      // be possible to utilize the getBoundingClientRect if only it's data wasn't
      // affected by CSS transformations let alone paddings, borders and scroll bars.
  
      var width = toFloat(styles.width),
          height = toFloat(styles.height); // Width & height include paddings and borders when the 'border-box' box
      // model is applied (except for IE).
  
      if (styles.boxSizing === 'border-box') {
        // Following conditions are required to handle Internet Explorer which
        // doesn't include paddings and borders to computed CSS dimensions.
        //
        // We can say that if CSS dimensions + paddings are equal to the "client"
        // properties then it's either IE, and thus we don't need to subtract
        // anything, or an element merely doesn't have paddings/borders styles.
        if (Math.round(width + horizPad) !== clientWidth) {
          width -= getBordersSize(styles, 'left', 'right') + horizPad;
        }
  
        if (Math.round(height + vertPad) !== clientHeight) {
          height -= getBordersSize(styles, 'top', 'bottom') + vertPad;
        }
      } // Following steps can't be applied to the document's root element as its
      // client[Width/Height] properties represent viewport area of the window.
      // Besides, it's as well not necessary as the <html> itself neither has
      // rendered scroll bars nor it can be clipped.
  
  
      if (!isDocumentElement(target)) {
        // In some browsers (only in Firefox, actually) CSS width & height
        // include scroll bars size which can be removed at this step as scroll
        // bars are the only difference between rounded dimensions + paddings
        // and "client" properties, though that is not always true in Chrome.
        var vertScrollbar = Math.round(width + horizPad) - clientWidth;
        var horizScrollbar = Math.round(height + vertPad) - clientHeight; // Chrome has a rather weird rounding of "client" properties.
        // E.g. for an element with content width of 314.2px it sometimes gives
        // the client width of 315px and for the width of 314.7px it may give
        // 314px. And it doesn't happen all the time. So just ignore this delta
        // as a non-relevant.
  
        if (Math.abs(vertScrollbar) !== 1) {
          width -= vertScrollbar;
        }
  
        if (Math.abs(horizScrollbar) !== 1) {
          height -= horizScrollbar;
        }
      }
  
      return createRectInit(paddings.left, paddings.top, width, height);
    }
    /**
     * Checks whether provided element is an instance of the SVGGraphicsElement.
     *
     * @param {Element} target - Element to be checked.
     * @returns {boolean}
     */
  
  
    var isSVGGraphicsElement = function () {
      // Some browsers, namely IE and Edge, don't have the SVGGraphicsElement
      // interface.
      if (typeof SVGGraphicsElement !== 'undefined') {
        return function (target) {
          return target instanceof getWindowOf(target).SVGGraphicsElement;
        };
      } // If it's so, then check that element is at least an instance of the
      // SVGElement and that it has the "getBBox" method.
      // eslint-disable-next-line no-extra-parens
  
  
      return function (target) {
        return target instanceof getWindowOf(target).SVGElement && typeof target.getBBox === 'function';
      };
    }();
    /**
     * Checks whether provided element is a document element (<html>).
     *
     * @param {Element} target - Element to be checked.
     * @returns {boolean}
     */
  
  
    function isDocumentElement(target) {
      return target === getWindowOf(target).document.documentElement;
    }
    /**
     * Calculates an appropriate content rectangle for provided html or svg element.
     *
     * @param {Element} target - Element content rectangle of which needs to be calculated.
     * @returns {DOMRectInit}
     */
  
  
    function getContentRect(target) {
      if (!isBrowser) {
        return emptyRect;
      }
  
      if (isSVGGraphicsElement(target)) {
        return getSVGContentRect(target);
      }
  
      return getHTMLElementContentRect(target);
    }
    /**
     * Creates rectangle with an interface of the DOMRectReadOnly.
     * Spec: https://drafts.fxtf.org/geometry/#domrectreadonly
     *
     * @param {DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.
     * @returns {DOMRectReadOnly}
     */
  
  
    function createReadOnlyRect(ref) {
      var x = ref.x;
      var y = ref.y;
      var width = ref.width;
      var height = ref.height; // If DOMRectReadOnly is available use it as a prototype for the rectangle.
  
      var Constr = typeof DOMRectReadOnly !== 'undefined' ? DOMRectReadOnly : Object;
      var rect = Object.create(Constr.prototype); // Rectangle's properties are not writable and non-enumerable.
  
      defineConfigurable(rect, {
        x: x,
        y: y,
        width: width,
        height: height,
        top: y,
        right: x + width,
        bottom: height + y,
        left: x
      });
      return rect;
    }
    /**
     * Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.
     * Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit
     *
     * @param {number} x - X coordinate.
     * @param {number} y - Y coordinate.
     * @param {number} width - Rectangle's width.
     * @param {number} height - Rectangle's height.
     * @returns {DOMRectInit}
     */
  
  
    function createRectInit(x, y, width, height) {
      return {
        x: x,
        y: y,
        width: width,
        height: height
      };
    }
    /**
     * Class that is responsible for computations of the content rectangle of
     * provided DOM element and for keeping track of it's changes.
     */
  
  
    var ResizeObservation = function ResizeObservation(target) {
      this.broadcastWidth = 0;
      this.broadcastHeight = 0;
      this.contentRect_ = createRectInit(0, 0, 0, 0);
      this.target = target;
    };
    /**
     * Updates content rectangle and tells whether it's width or height properties
     * have changed since the last broadcast.
     *
     * @returns {boolean}
     */
  
    /**
     * Reference to the last observed content rectangle.
     *
     * @private {DOMRectInit}
     */
  
    /**
     * Broadcasted width of content rectangle.
     *
     * @type {number}
     */
  
  
    ResizeObservation.prototype.isActive = function () {
      var rect = getContentRect(this.target);
      this.contentRect_ = rect;
      return rect.width !== this.broadcastWidth || rect.height !== this.broadcastHeight;
    };
    /**
     * Updates 'broadcastWidth' and 'broadcastHeight' properties with a data
     * from the corresponding properties of the last observed content rectangle.
     *
     * @returns {DOMRectInit} Last observed content rectangle.
     */
  
  
    ResizeObservation.prototype.broadcastRect = function () {
      var rect = this.contentRect_;
      this.broadcastWidth = rect.width;
      this.broadcastHeight = rect.height;
      return rect;
    };
  
    var ResizeObserverEntry = function ResizeObserverEntry(target, rectInit) {
      var contentRect = createReadOnlyRect(rectInit); // According to the specification following properties are not writable
      // and are also not enumerable in the native implementation.
      //
      // Property accessors are not being used as they'd require to define a
      // private WeakMap storage which may cause memory leaks in browsers that
      // don't support this type of collections.
  
      defineConfigurable(this, {
        target: target,
        contentRect: contentRect
      });
    };
  
    var ResizeObserverSPI = function ResizeObserverSPI(callback, controller, callbackCtx) {
      this.activeObservations_ = [];
      this.observations_ = new MapShim();
  
      if (typeof callback !== 'function') {
        throw new TypeError('The callback provided as parameter 1 is not a function.');
      }
  
      this.callback_ = callback;
      this.controller_ = controller;
      this.callbackCtx_ = callbackCtx;
    };
    /**
     * Starts observing provided element.
     *
     * @param {Element} target - Element to be observed.
     * @returns {void}
     */
  
    /**
     * Registry of the ResizeObservation instances.
     *
     * @private {Map<Element, ResizeObservation>}
     */
  
    /**
     * Public ResizeObserver instance which will be passed to the callback
     * function and used as a value of it's "this" binding.
     *
     * @private {ResizeObserver}
     */
  
    /**
     * Collection of resize observations that have detected changes in dimensions
     * of elements.
     *
     * @private {Array<ResizeObservation>}
     */
  
  
    ResizeObserverSPI.prototype.observe = function (target) {
      if (!arguments.length) {
        throw new TypeError('1 argument required, but only 0 present.');
      } // Do nothing if current environment doesn't have the Element interface.
  
  
      if (typeof Element === 'undefined' || !(Element instanceof Object)) {
        return;
      }
  
      if (!(target instanceof getWindowOf(target).Element)) {
        throw new TypeError('parameter 1 is not of type "Element".');
      }
  
      var observations = this.observations_; // Do nothing if element is already being observed.
  
      if (observations.has(target)) {
        return;
      }
  
      observations.set(target, new ResizeObservation(target));
      this.controller_.addObserver(this); // Force the update of observations.
  
      this.controller_.refresh();
    };
    /**
     * Stops observing provided element.
     *
     * @param {Element} target - Element to stop observing.
     * @returns {void}
     */
  
  
    ResizeObserverSPI.prototype.unobserve = function (target) {
      if (!arguments.length) {
        throw new TypeError('1 argument required, but only 0 present.');
      } // Do nothing if current environment doesn't have the Element interface.
  
  
      if (typeof Element === 'undefined' || !(Element instanceof Object)) {
        return;
      }
  
      if (!(target instanceof getWindowOf(target).Element)) {
        throw new TypeError('parameter 1 is not of type "Element".');
      }
  
      var observations = this.observations_; // Do nothing if element is not being observed.
  
      if (!observations.has(target)) {
        return;
      }
  
      observations["delete"](target);
  
      if (!observations.size) {
        this.controller_.removeObserver(this);
      }
    };
    /**
     * Stops observing all elements.
     *
     * @returns {void}
     */
  
  
    ResizeObserverSPI.prototype.disconnect = function () {
      this.clearActive();
      this.observations_.clear();
      this.controller_.removeObserver(this);
    };
    /**
     * Collects observation instances the associated element of which has changed
     * it's content rectangle.
     *
     * @returns {void}
     */
  
  
    ResizeObserverSPI.prototype.gatherActive = function () {
      var this$1 = this;
      this.clearActive();
      this.observations_.forEach(function (observation) {
        if (observation.isActive()) {
          this$1.activeObservations_.push(observation);
        }
      });
    };
    /**
     * Invokes initial callback function with a list of ResizeObserverEntry
     * instances collected from active resize observations.
     *
     * @returns {void}
     */
  
  
    ResizeObserverSPI.prototype.broadcastActive = function () {
      // Do nothing if observer doesn't have active observations.
      if (!this.hasActive()) {
        return;
      }
  
      var ctx = this.callbackCtx_; // Create ResizeObserverEntry instance for every active observation.
  
      var entries = this.activeObservations_.map(function (observation) {
        return new ResizeObserverEntry(observation.target, observation.broadcastRect());
      });
      this.callback_.call(ctx, entries, ctx);
      this.clearActive();
    };
    /**
     * Clears the collection of active observations.
     *
     * @returns {void}
     */
  
  
    ResizeObserverSPI.prototype.clearActive = function () {
      this.activeObservations_.splice(0);
    };
    /**
     * Tells whether observer has active observations.
     *
     * @returns {boolean}
     */
  
  
    ResizeObserverSPI.prototype.hasActive = function () {
      return this.activeObservations_.length > 0;
    }; // Registry of internal observers. If WeakMap is not available use current shim
    // for the Map collection as it has all required methods and because WeakMap
    // can't be fully polyfilled anyway.
  
  
    var observers = typeof WeakMap !== 'undefined' ? new WeakMap() : new MapShim();
    /**
     * ResizeObserver API. Encapsulates the ResizeObserver SPI implementation
     * exposing only those methods and properties that are defined in the spec.
     */
  
    var ResizeObserver = function ResizeObserver(callback) {
      if (!(this instanceof ResizeObserver)) {
        throw new TypeError('Cannot call a class as a function.');
      }
  
      if (!arguments.length) {
        throw new TypeError('1 argument required, but only 0 present.');
      }
  
      var controller = ResizeObserverController.getInstance();
      var observer = new ResizeObserverSPI(callback, controller, this);
      observers.set(this, observer);
    }; // Expose public methods of ResizeObserver.
  
  
    ['observe', 'unobserve', 'disconnect'].forEach(function (method) {
      ResizeObserver.prototype[method] = function () {
        return (ref = observers.get(this))[method].apply(ref, arguments);
        var ref;
      };
    });
  
    var index = function () {
      // Export existing implementation if available.
      if (typeof global$1.ResizeObserver !== 'undefined') {
        return global$1.ResizeObserver;
      }
  
      return ResizeObserver;
    }();
  
    return index;
  });
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../ui-products/sbn/node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/slide/js/slide.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-core/plugins/slide/js/slide.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var slide = {
      $slide: null,
      $target: null,
      $contents: null,
      $slideinfo: null,
      $toggle: null,
      prev: null,
      isMobile: false,
      vPort: "screen-sm",
      elementvPort: null,
      back: false,
      nested: false,
      multi: false,
      activeSlide: 0,
      oldInfo: [],
      off: null,
      clone: null,
      wait: false,
      backLabel: 'back',
      $elements: null,
      isQueue: false,
      isRTL: false,
      init: function init() {
        slide.$slide = '<div class="w-slide"><div class="w-slide_head"><a href="#" class="w-slide__back"><i class=" icon-arrow_l" aria-hidden="true"></i>' + slide.backLabel + '</a><span class="w-slide__title"></span></span></div><div class="w-slide__content"></div></div>';
        slide.$elements = $(slide.$slide);
        slide.displaySlideHtmlToPage();
        slide.$contents = slide.$elements.find('.w-slide__content');
        slide.$slideinfo = slide.$elements.find('.w-slide__title');
        slide.$back = slide.$elements.find('.w-slide__back');
        slide.$toggle = $('.w-slide__btn');
        slide.elementvPort = slide.vPort;
        slide.vPort = [];
        slide.customViewPorts();
        slide.$toggle.each(function (index) {
          slide.check.viewPort($(this), index);
          slide.responsive(index);
        });
        slide.additionalInitialization();
        slide.control();
        slide.additionalControls();
  
        if (typeof facetDateChart != "undefined") {
          facetDateChart.control();
        }
  
        if (UX.utils && UX.utils.isRTL()) {
          slide.isRTL = true;
        }
      },
      displaySlideHtmlToPage: function displaySlideHtmlToPage() {
        var $main = $("main");
        if ($main.length > 0) $main.append(slide.$elements);else $body.append(slide.$elements);
      },
      additionalInitialization: function additionalInitialization() {},
      responsive: function responsive(index) {
        $(document).on(slide.vPort[index] + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          slide.off = false;
          $('.w-slide__btn').each(function () {
            if ($(this).data('ctrl-res') === slide.vPort[index]) {
              $(this).addClass('slide-active');
            }
          });
        });
        $(document).on(slide.vPort[index] + '-off', function (e) {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          slide.off = true;
          slide.on.off(e);
          $('.w-slide__btn').each(function () {
            if ($(this).data('ctrl-res') === slide.vPort[index]) {
              $(this).removeClass('slide-active');
            }
          });
        });
        $(document).on(slide.elementvPort + '-on', function (e) {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          slide.isMobile = true;
          slide.$elements.css('margin-top', 0);
  
          if ($('.w-slide.js--open').length) {
            slide.back = true;
            slide.on.hide(e);
          }
        });
        $(document).on(slide.elementvPort + '-off', function (e) {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          slide.isMobile = false;
  
          if ($('.w-slide.js--open').length) {
            slide.back = true;
            slide.on.hide(e);
          }
        });
        slide.additionalResponsive();
      },
      additionalResponsive: function additionalResponsive() {},
      control: function control() {
        $body.on('click', '.w-slide__btn', function (e) {
          if (slide.isQueue && slide.isMobile) {
            e.stopImmediatePropagation();
            $(this).off('click');
            return false;
          }
  
          slide.isQueue = true;
  
          if ($(this).hasClass('disable')) {
            e.stopPropagation();
            e.preventDefault();
            return;
          }
  
          if ($(this).hasClass('slide-active')) {
            e.stopPropagation();
            e.preventDefault();
            slide.addTransition();
            slide.$toggle = $(this);
            slide.$target = $(slide.$toggle.data('slide-target'));
            slide.back = false;
  
            if ($(this).is('[id*=pane-pcw]') && UX.tab.check.empty($(this))) {
              setTimeout(function () {
                slide.on.show(e);
              }, 3000);
            } else {
              slide.on.show(e);
            }
          }
        });
        $body.on('click', '.w-slide__back, .w-slide__hide', function (e) {
          if ($(this).hasClass("w-slide__back")) {
            e.preventDefault();
          }
  
          slide.back = true;
          slide.on.hide(e);
        });
      },
      additionalControls: function additionalControls() {},
      addTransition: function addTransition() {
        $(".w-slide, .w-slide__content").css('transition', 'all 250ms');
      },
      removeTransition: function removeTransition() {
        $(".w-slide, .w-slide__content").css('transition', '');
      },
      customViewPorts: function customViewPorts() {
        if ($('.journal-home').length) {
          slide.elementvPort = "screen-md";
        }
      },
      setBackLabel: function setBackLabel() {
        slide.$back.html('<i class=" icon-arrow_l" aria-hidden="true"></i>' + slide.backLabel);
      },
      on: {
        show: function show(e) {
          $(document).trigger("UX-detach");
  
          if (typeof jcf != "undefined") {
            jcf.destroy($(".range-slider__range"));
          }
          /**
           * Fire "open" event
           * this event is Cancelable: which means if e.preventDefault() is called then the slide will not open.
           */
  
  
          var openingEvent = $.Event("slide:open");
          $(document).trigger(openingEvent, [slide]);
  
          if (openingEvent.isDefaultPrevented()) {
            return;
          }
  
          if ($body.attr('data-active') !== 'undefined') {
            UX.controller.check(e);
          }
  
          if (slide.$toggle.is('[data-full-screen]') && !slide.$toggle.data('[full-screen]') && !slide.isMobile) $body.addClass('w-slide__not-fullWidth');else $body.removeClass('w-slide__not-fullWidth');
          slide.nested = slide.$toggle.parents(".w-slide__content").length > 0;
          slide.multi = slide.$toggle.closest('.pill-list').length > 0 || slide.$toggle.is('[data-slide-target*="#pill"]');
  
          if (slide.$toggle.closest('.w-slide__pill').length > 0) {
            slide.nested = false;
            slide.multi = true;
          }
  
          slide.on.additionalShow();
          slide.$slideinfo.hide().removeClass('js--open');
          slide.backLabel = 'back';
          slide.setBackLabel();
  
          if (slide.nested) {
            slide.activeSlide++;
            slide.$contents.append('<div class="w-slide__content nested--' + slide.activeSlide + '"></div>');
            slide.$contents = $('.nested--' + slide.activeSlide);
          }
  
          if (slide.multi) {
            if (slide.activeSlide !== 0) {
              slide.back = true;
              slide.on.hide(e);
            }
  
            slide.activeSlide++;
            slide.$elements.addClass('w-slide__pill').find('.w-slide__content').append('<div class="w-slide__content nested--' + slide.activeSlide + '"></div>');
            slide.$contents = $('.nested--' + slide.activeSlide);
          }
  
          slide.$contents.attr('original-target', slide.$toggle.data('slide-target'));
  
          if (slide.$target.hasClass('tab__pane')) {
            slide.$target.closest('.tab__content').find('.tab__pane').removeClass('active');
            slide.$target.addClass('active');
          }
  
          var label = slide.$toggle.text();
  
          if (slide.$toggle.is('[data-label]')) {
            label = slide.$toggle.data('label');
          } //LIT-163835
  
  
          if (slide.$toggle.hasClass('loa') || slide.$toggle.parents('.loa.mobile-authors').length > 0) {
            label = "AUTHORS";
          }
  
          var clonedDiv = slide.$target.children();
          slide.on.destroyJcf(clonedDiv);
  
          if (slide.$toggle.is('[data-slide-clone]')) {
            slide.clone = slide.$toggle.data('slide-clone');
  
            if (slide.clone === 'self') {
              clonedDiv = slide.$target;
            }
          } else {
            slide.clone = "";
          }
  
          slide.oldInfo.push(label);
          slide.$slideinfo.html(label);
          var isLoi = slide.$target.find('.loi').length > 0;
  
          if (isLoi) {
            slide.$contents.append(clonedDiv.html());
            $('.dropBlock-loi__holder .loi').remove();
            slide.$contents.find('.loi__list').each(function () {
              UX.loi.on.recalculate($(this));
            });
          } else {
            if (slide.clone === 'self') {
              if (slide.nested || slide.multi) {
                slide.$target.after('<div class="returnNestedDataSlideHere"></div>');
              } else {
                slide.$target.after('<div class="returnDataSlideHere"></div>');
              }
            } else {
              if (slide.nested || slide.multi) {
                slide.$target.append('<div class="returnNestedDataSlideHere"></div>');
              } else {
                slide.$target.append('<div class="returnDataSlideHere"></div>');
              }
            }
  
            clonedDiv.appendTo(slide.$contents);
  
            if ((clonedDiv.hasClass('addthis_toolbox') || clonedDiv.find('.addthis_toolbox').length > 0) && addthis) {
              // re-init social links on mobile
              addthis.toolbox('.addthis_toolbox');
            }
  
            slide.on.rebuildJcf(slide.$contents);
          } // This is needed for refreshing the google ads iframe
          // because we are cloning it into element
          // for more info:  https://stackoverflow.com/questions/435391/refresh-a-div-that-has-a-google-ad-inside-it/12083756#12083756
  
  
          if (typeof googletag !== 'undefined' && typeof googletag.pubads !== 'undefined') {
            googletag.pubads().refresh();
          }
  
          $body.addClass('lock-screen slide-is-active').attr('data-active', 'slide');
          slide.$back.focus();
          var $coolBar = $('.coolBar');
  
          if ($coolBar.length) {
            $coolBar.addClass('slide');
          }
          /*
          $('.w-slide__title').truncate({
              lines: 1
          });
          */
          // "opened" event
  
  
          var openEvent = $.Event("slide:opened");
  
          if (slide.wait) {
            setTimeout(function () {
              slide.on._showSlide();
  
              slide.on.slidePill();
              $(document).trigger(openEvent, [slide]);
            }, 150);
            slide.wait = false;
          } else {
            slide.on._showSlide();
  
            $(document).trigger(openEvent, [slide]);
          }
  
          $(document).trigger("UX-attach");
        },
        _showSlide: function _showSlide() {
          var slideWidth = '100%';
          var $slidedDiv = slide.$elements;
  
          if (slide.nested || slide.multi) {
            $slidedDiv = slide.$contents;
          }
  
          if (!slide.$elements.hasClass('js--open') && slide.multi) {
            $slidedDiv = $('[class*=nested--], .w-slide');
          }
  
          var translate = "-".concat(slideWidth);
  
          if (slide.isRTL) {
            translate = slideWidth;
          }
  
          $slidedDiv.css('transform', "translateX(".concat(translate, ")")).off().one('transitionend webkitTransitionEnd oTransitionEnd', function (e) {
            e.stopPropagation();
            slide.isQueue = false;
            slide.removeTransition();
          });
          slide.$slideinfo.show().addClass('js--open');
          slide.$elements.addClass('js--open');
          slide.on.additionalShowSlide();
        },
        additionalShow: function additionalShow() {},
        additionalShowSlide: function additionalShowSlide() {},
        slidePill: function slidePill() {},
        hide: function hide(e) {
          /**
           * Fire "close" event
           * this event is Cancelable: which means if e.preventDefault() is called then the slide will not close.
           */
          var closingEvent = $.Event("slide:close");
          $(document).trigger(closingEvent, [slide]);
  
          if (closingEvent.isDefaultPrevented()) {
            return;
          }
  
          if (typeof e !== "undefined" && $('.w-slide').hasClass('js--open')) {
            var isInsideSlide = $(e.target).closest('.w-slide').length;
  
            if (!isInsideSlide) {
              slide.back = true;
            }
          }
  
          if (slide.back) {
            slide.addTransition();
            slide.$slideinfo.hide().removeClass('js--open');
            slide.nested = true;
  
            if (slide.activeSlide === 0) {
              slide.nested = false;
              slide.$contents = slide.$elements.children('.w-slide__content');
            } else {
              slide.$contents = $('.nested--' + slide.activeSlide);
            }
  
            slide.on.destroyJcf(slide.$contents);
            var originalTarget = $(slide.$contents.attr('original-target'));
  
            if (!originalTarget) {
              originalTarget = $body;
            }
  
            var isLoi = slide.$elements.find('.loi').length > 0;
            slide.on.beforeReturnSlideContent();
  
            if (isLoi) {
              var $dropBlockHolder = $('.dropBlock-loi__holder');
              $dropBlockHolder.append(slide.$contents.html());
              $dropBlockHolder.find('.loi__list').each(function () {
                UX.loi.on.recalculate($(this));
              });
            } else {
              if (slide.$contents.find('[class*=nested--]').length) {
                slide.$contents.find('[class*=nested--]').remove();
              }
  
              var returnDataSlideHere = slide.nested || slide.multi ? '.returnNestedDataSlideHere' : '.returnDataSlideHere';
              var $returnDataSlideHere = slide.clone === 'self' ? $(returnDataSlideHere) : $(returnDataSlideHere, originalTarget);
              slide.$contents.children().appendTo($returnDataSlideHere.parent());
              $returnDataSlideHere.remove();
              slide.on.rebuildJcf(originalTarget);
            }
  
            slide.oldInfo.splice(slide.activeSlide, 1);
            slide.$slideinfo.html(slide.oldInfo[slide.activeSlide - 1]);
  
            if (slide.$toggle) {
              slide.$toggle.focus();
            }
  
            if (slide.nested) {
              slide.activeSlide--;
  
              slide.on._hideSlide();
  
              if (slide.multi) {
                slide.$contents.remove();
              }
  
              slide.$contents = $('.nested--' + slide.activeSlide);
  
              if (slide.activeSlide === 0) {
                slide.$contents = slide.$elements.children('.w-slide__content');
              }
            } else {
              slide.activeSlide = 0;
              $('body, html').removeClass('lock-screen');
              $body.removeClass('lock-screen slide-is-active').removeAttr('data-active');
              var $coolBar = $('.coolBar');
  
              if ($coolBar.length) {
                $coolBar.removeClass('slide');
              }
  
              slide.on._hideSlide();
  
              slide.$elements.removeClass('js--open');
            }
  
            slide.$slideinfo.show().addClass('js--open');
            slide.backLabel = 'back';
            slide.setBackLabel();
            slide.on.additionalHide(e);
  
            if (slide.$elements.hasClass('w-slide__pill')) {
              while (slide.activeSlide > 0) {
                slide.activeSlide--;
                slide.on.hide(e);
              }
  
              if (typeof e !== "undefined" && ($(e.target).hasClass('w-slide__back') || $(e.currentTarget).hasClass('w-slide__back')) && slide.activeSlide === 0) {
                slide.on.off(e);
              }
            }
  
            if (!isInsideSlide && !(typeof e !== "undefined" && $(e.target).closest('.pill-list').length)) {
              slide.on.off(e);
            }
  
            slide.removeTransition();
          } // This is needed for refreshing the google ads iframe
          // because we are cloning it into element
          // for more info:  https://stackoverflow.com/questions/435391/refresh-a-div-that-has-a-google-ad-inside-it/12083756#12083756
  
  
          if (typeof googletag !== 'undefined' && typeof googletag.pubads !== 'undefined') {
            googletag.pubads().refresh();
          } // "closed" event
  
  
          var closeEvent = $.Event("slide:closed");
          $(document).trigger(closeEvent, [slide]);
        },
        _hideSlide: function _hideSlide() {
          var updateTarget = slide.$elements;
          if (slide.nested) updateTarget = slide.$contents;
          updateTarget.css('transform', 'translateX(0vw)').off().one('transitionend webkitTransitionEnd oTransitionEnd', function (e) {
            e.stopPropagation();
            if (slide.back) if (!slide.nested) slide.$contents.empty();else $(this).remove();
          });
        },
        additionalHide: function additionalHide(e) {},
        beforeReturnSlideContent: function beforeReturnSlideContent() {},
        off: function off(e) {
          slide.$slideinfo.hide().removeClass('js--open');
          $('.pill-list li').removeClass('pill-active');
          var isLoi = slide.$elements.find('.loi').length > 0;
  
          if (isLoi) {
            slide.$contents = $('.loi').closest('.w-slide__content');
            var $dropBlockHolder = $('.dropBlock-loi__holder');
            $dropBlockHolder.append(slide.$contents.html());
            $dropBlockHolder.find('.loi__list').each(function () {
              UX.loi.on.recalculate($(this));
            });
          }
  
          $('body, html').removeClass('lock-screen');
          $body.removeClass('lock-screen slide-is-active').removeAttr('data-active');
          $('.coolBar').removeClass('slide');
          slide.$contents = slide.$elements.children('.w-slide__content');
          slide.$elements.css('transform', 'translateX(0vw)').off().one('transitionend webkitTransitionEnd oTransitionEnd', function (e) {
            e.stopPropagation();
            slide.$elements.removeClass('js--open');
  
            if (slide.off) {
              $('.w-slide').removeClass('w-slide__pill');
              slide.$contents.empty();
            }
          });
          slide.off = false;
          slide.on.additionalOff(e);
        },
        additionalOff: function additionalOff(e) {},
        destroyJcf: function destroyJcf($el) {
          if (typeof jcf != "undefined") {
            jcf.destroy($el.find('.jcf'));
          }
        },
        rebuildJcf: function rebuildJcf($el) {
          if (typeof jcf != "undefined") {
            jcf.replace($el.find('.jcf'));
          }
        }
      },
      check: {
        viewPort: function viewPort($el, index) {
          if (typeof $el.data('ctrl-res') !== 'undefined') {
            slide.vPort[index] = $el.data('ctrl-res');
          } else {
            $el.data('ctrl-res', slide.elementvPort);
            slide.vPort[index] = slide.elementvPort;
          }
        }
      }
    };
    UX.slide = slide; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/stickybits/js/stickybits.es.js":
  /*!********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/stickybits/js/stickybits.es.js ***!
    \********************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /**
    stickybits - Stickybits is a lightweight alternative to `position: sticky` polyfills
    @version v3.6.5
    @link https://github.com/dollarshaveclub/stickybits#readme
    @author Jeff Wainwright <yowainwright@gmail.com> (https://jeffry.in)
    @license MIT
  **/
  
  /*
    STICKYBITS 
    --------
    > a lightweight alternative to `position: sticky` polyfills 
    --------
    - each method is documented above it our view the readme
    - Stickybits does not manage polymorphic functionality (position like properties)
    * polymorphic functionality: (in the context of describing Stickybits)
      means making things like `position: sticky` be loosely supported with position fixed.
      It also means that features like `useStickyClasses` takes on styles like `position: fixed`.
    --------
    defaults 
    --------
    - version = `package.json` version
    - userAgent = viewer browser agent
    - target = DOM element selector
    - noStyles = boolean
    - offset = number
    - parentClass = 'string'
    - scrollEl = window || DOM element selector || DOM element
    - stickyClass = 'string'
    - stuckClass = 'string'
    - useStickyClasses = boolean
    - useFixed = boolean
    - useGetBoundingClientRect = boolean
    - verticalPosition = 'string'
    --------
    props
    --------
    - p = props {object}
    --------
    instance note
    --------
    - stickybits parent methods return this
    - stickybits instance methods return an instance item
    --------
    nomenclature
    --------
    - target => el => e
    - props => o || p
    - instance => item => it
    --------
    methods
    --------
    - .definePosition = defines sticky or fixed
    - .addInstance = an array of objects for each Stickybits Target
    - .getClosestParent = gets the parent for non-window scroll
    - .getTopPosition = gets the element top pixel position from the viewport
    - .computeScrollOffsets = computes scroll position
    - .toggleClasses = older browser toggler
    - .manageState = manages sticky state
    - .removeClass = older browser support class remover
    - .removeInstance = removes an instance
    - .cleanup = removes all Stickybits instances and cleans up dom from stickybits
  */
  var Stickybits = /*#__PURE__*/function () {
    var stickyOnEvent = document.createEvent('CustomEvent'),
        stickyOffEvent = document.createEvent('CustomEvent');
    stickyOnEvent.initCustomEvent('sticky-on', true, false, {});
    stickyOffEvent.initCustomEvent('sticky-off', true, false, {});
  
    function Stickybits(target, obj) {
      var o = typeof obj !== 'undefined' ? obj : {};
      this.version = '3.6.5';
      this.userAgent = window.navigator.userAgent || 'no `userAgent` provided by the browser';
      this.props = {
        customStickyChangeNumber: o.customStickyChangeNumber || null,
        noStyles: o.noStyles || false,
        stickyBitStickyOffset: o.stickyBitStickyOffset || 0,
        parentClass: o.parentClass || 'js-stickybit-parent',
        scrollEl: typeof o.scrollEl === 'string' ? document.querySelector(o.scrollEl) : o.scrollEl || window,
        stickyClass: o.stickyClass || 'js-is-sticky',
        stuckClass: o.stuckClass || 'js-is-stuck',
        stickyChangeClass: o.stickyChangeClass || 'js-is-sticky--change',
        useStickyClasses: o.useStickyClasses || false,
        useFixed: o.useFixed || false,
        useGetBoundingClientRect: o.useGetBoundingClientRect || false,
        verticalPosition: o.verticalPosition || 'top'
        /*
          define positionVal
          ----
          -  uses a computed (`.definePosition()`)
          -  defined the position
        */
  
      };
      this.props.positionVal = this.definePosition() || 'fixed';
      this.instances = [];
      var _this$props = this.props,
          positionVal = _this$props.positionVal,
          verticalPosition = _this$props.verticalPosition,
          noStyles = _this$props.noStyles,
          stickyBitStickyOffset = _this$props.stickyBitStickyOffset,
          useStickyClasses = _this$props.useStickyClasses;
      var verticalPositionStyle = verticalPosition === 'top' && !noStyles ? stickyBitStickyOffset + "px" : '';
      var positionStyle = positionVal !== 'fixed' ? positionVal : '';
      this.els = typeof target === 'string' ? document.querySelectorAll(target) : target;
      if (!('length' in this.els)) this.els = [this.els];
  
      for (var i = 0; i < this.els.length; i++) {
        var el = this.els[i]; // set vertical position
  
        el.style[verticalPosition] = verticalPositionStyle;
        el.style.position = positionStyle;
  
        if (positionVal === 'fixed' || useStickyClasses) {
          // instances are an array of objects
          this.instances.push(this.addInstance(el, this.props));
        }
      }
    }
    /*
      setStickyPosition 
      --------
        most basic thing stickybits does
      => checks to see if position sticky is supported
      => defined the position to be used
      => stickybits works accordingly
    */
  
  
    var _proto = Stickybits.prototype;
  
    _proto.definePosition = function definePosition() {
      var stickyProp;
  
      if (this.props.useFixed) {
        stickyProp = 'fixed';
      } else {
        var prefix = ['', '-o-', '-webkit-', '-moz-', '-ms-'];
        var test = document.head.style;
  
        for (var i = 0; i < prefix.length; i += 1) {
          test.position = prefix[i] + "sticky";
        }
  
        stickyProp = test.position ? test.position : 'fixed';
        test.position = '';
      }
  
      return stickyProp;
    }
    /*
      addInstance 
      --------
       manages instances of items
      - takes in an el and props
      - returns an item object
      ---
      - target = el
      - o = {object} = props
        - scrollEl = 'string' | object
        - verticalPosition = number
        - off = boolean
        - parentClass = 'string'
        - stickyClass = 'string'
        - stuckClass = 'string'
      ---
      - defined later
        - parent = dom element
        - state = 'string'
        - offset = number
        - stickyStart = number
        - stickyStop = number
      - returns an instance object
    */
    ;
  
    _proto.addInstance = function addInstance(el, props) {
      var _this = this;
  
      var item = {
        el: el,
        parent: el.parentNode,
        props: props
      };
      this.isWin = this.props.scrollEl === window;
      var se = this.isWin ? window : this.getClosestParent(item.el, item.props.scrollEl);
      this.computeScrollOffsets(item);
      item.parent.className += " " + props.parentClass;
      item.state = 'default';
  
      item.stateContainer = function () {
        return _this.manageState(item);
      };
  
      se.addEventListener('scroll', item.stateContainer);
      return item;
    }
    /*
      --------
      getParent 
      --------
      - a helper function that gets the target element's parent selected el
      - only used for non `window` scroll elements
      - supports older browsers
    */
    ;
  
    _proto.getClosestParent = function getClosestParent(el, match) {
      // p = parent element
      var p = match;
      var e = el;
      if (e.parentElement === p) return p; // traverse up the dom tree until we get to the parent
  
      while (e.parentElement !== p) {
        e = e.parentElement;
      } // return parent element
  
  
      return p;
    }
    /*
      --------
      getTopPosition
      --------
      - a helper function that gets the topPosition of a Stickybit element
      - from the top level of the DOM
    */
    ;
  
    _proto.getTopPosition = function getTopPosition(el) {
      if (this.props.useGetBoundingClientRect) {
        return el.getBoundingClientRect().top + (this.props.scrollEl.pageYOffset || document.documentElement.scrollTop);
      }
  
      var topPosition = 0;
  
      do {
        topPosition = el.offsetTop + topPosition;
      } while (el = el.offsetParent);
  
      return topPosition;
    }
    /*
      computeScrollOffsets 
      ---
      computeScrollOffsets for Stickybits
      - defines
        - offset
        - start
        - stop
    */
    ;
  
    _proto.computeScrollOffsets = function computeScrollOffsets(item) {
      var it = item;
      var p = it.props;
      var el = it.el;
      var parent = it.parent;
      var isCustom = !this.isWin && p.positionVal === 'fixed';
      var isTop = p.verticalPosition !== 'bottom';
      var scrollElOffset = isCustom ? this.getTopPosition(p.scrollEl) : 0;
      var stickyStart = isCustom ? this.getTopPosition(parent) - scrollElOffset : this.getTopPosition(parent);
      var stickyChangeOffset = p.customStickyChangeNumber !== null ? p.customStickyChangeNumber : el.offsetHeight;
      var parentBottom = stickyStart + parent.offsetHeight;
      it.offset = scrollElOffset + p.stickyBitStickyOffset;
      it.stickyStart = isTop ? stickyStart - it.offset : 0;
      it.stickyChange = it.stickyStart + stickyChangeOffset;
      it.stickyStop = isTop ? parentBottom - (el.offsetHeight + it.offset) : parentBottom - window.innerHeight;
    }
    /*
      toggleClasses 
      ---
      toggles classes (for older browser support)
      r = removed class
      a = added class
    */
    ;
  
    _proto.toggleClasses = function toggleClasses(el, r, a) {
      var e = el;
      var cArray = e.className.split(' ');
      if (a && cArray.indexOf(a) === -1) cArray.push(a);
      var rItem = cArray.indexOf(r);
      if (rItem !== -1) cArray.splice(rItem, 1);
      e.className = cArray.join(' ');
    }
    /*
      manageState 
      ---
      - defines the state
        - normal
        - sticky
        - stuck
    */
    ;
  
    _proto.manageState = function manageState(item) {
      // cache object
      var it = item;
      var e = it.el;
      var p = it.props;
      var state = it.state;
      var start = it.stickyStart;
      var change = it.stickyChange;
      var stop = it.stickyStop;
      var stl = e.style; // cache props
  
      var ns = p.noStyles;
      var pv = p.positionVal;
      var se = p.scrollEl;
      var sticky = p.stickyClass;
      var stickyChange = p.stickyChangeClass;
      var stuck = p.stuckClass;
      var vp = p.verticalPosition;
      var isTop = vp !== 'bottom';
      /*
        requestAnimationFrame
        ---
        - use rAF
        - or stub rAF
      */
  
      var rAFStub = function rAFDummy(f) {
        f();
      };
  
      var rAF = !this.isWin ? rAFStub : window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || rAFStub;
      /*
        define scroll vars
        ---
        - scroll
        - notSticky
        - isSticky
        - isStuck
      */
  
      var tC = this.toggleClasses;
      var scroll = this.isWin ? window.scrollY || window.pageYOffset : se.scrollTop;
      var notSticky = scroll > start && scroll < stop && (state === 'default' || state === 'stuck');
      var isSticky = isTop && scroll <= start && (state === 'sticky' || state === 'stuck');
      var isStuck = scroll >= stop && state === 'sticky';
      /*
        Unnamed arrow functions within this block
        ---
        - help wanted or discussion
        - view test.stickybits.js
          - `stickybits .manageState  `position: fixed` interface` for more awareness 
      */
  
      if (notSticky) {
        it.state = 'sticky';
        rAF(function () {
          tC(e, stuck, sticky);
          stl.position = pv;
          if (ns) return;
          stl.bottom = '';
          stl[vp] = p.stickyBitStickyOffset + "px";
          e.dispatchEvent(stickyOnEvent);
        });
      } else if (isSticky) {
        it.state = 'default';
        rAF(function () {
          tC(e, sticky);
          tC(e, stuck);
          if (pv === 'fixed') stl.position = '';
          e.dispatchEvent(stickyOffEvent);
        });
      } else if (isStuck) {
        it.state = 'stuck';
        rAF(function () {
          tC(e, sticky, stuck);
          if (pv !== 'fixed' || ns) return;
          stl.top = '';
          stl.bottom = '0';
          stl.position = 'absolute';
        });
      }
  
      var isStickyChange = scroll >= change && scroll <= stop;
      var isNotStickyChange = scroll < change / 2 || scroll > stop;
      var stub = 'stub'; // a stub css class to remove
  
      if (isNotStickyChange) {
        rAF(function () {
          tC(e, stickyChange);
        });
      } else if (isStickyChange) {
        rAF(function () {
          tC(e, stub, stickyChange);
        });
      }
    };
  
    _proto.update = function update(updatedProps) {
      if (updatedProps === void 0) {
        updatedProps = null;
      }
  
      for (var i = 0; i < this.instances.length; i += 1) {
        var instance = this.instances[i];
        this.computeScrollOffsets(instance);
  
        if (updatedProps) {
          for (var updatedProp in updatedProps) {
            instance.props[updatedProp] = updatedProps[updatedProp];
          }
        }
      }
  
      return this;
    }
    /*
      removes an instance 
      --------
      - cleanup instance
    */
    ;
  
    _proto.removeInstance = function removeInstance(instance) {
      var e = instance.el;
      var p = instance.props;
      var tC = this.toggleClasses;
      e.style.position = '';
      e.style[p.verticalPosition] = '';
      tC(e, p.stickyClass);
      tC(e, p.stuckClass);
      tC(e.parentNode, p.parentClass);
    }
    /*
      cleanup 
      --------
      - cleans up each instance
      - clears instance
    */
    ;
  
    _proto.cleanup = function cleanup() {
      for (var i = 0; i < this.instances.length; i += 1) {
        var instance = this.instances[i];
        instance.props.scrollEl.removeEventListener('scroll', instance.stateContainer);
        this.removeInstance(instance);
      }
  
      this.manageState = false;
      this.instances = [];
    };
  
    return Stickybits;
  }();
  /*
    export
    --------
    exports StickBits to be used 
  */
  
  
  function stickybits(target, o) {
    return new Stickybits(target, o);
  }
  
  /* harmony default export */ __webpack_exports__["default"] = (stickybits);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/tabs/js/tabs.js":
  /*!*****************************************************!*\
    !*** /home/irahhal/ui-core/plugins/tabs/js/tabs.js ***!
    \*****************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "../../ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js");
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "../../ui-core/node_modules/@babel/runtime/helpers/createClass.js");
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js-exposed");
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utility/js/bootstrap-utils */ "../../ui-core/utility/js/bootstrap-utils.js");
  
  
  
  /**
   * --------------------------------------------------------------------------
   * Bootstrap (v4.4.1): tab.js
   * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
   * --------------------------------------------------------------------------
   */
  
  
  /**
   * ------------------------------------------------------------------------
   * Constants
   * ------------------------------------------------------------------------
   */
  
  var NAME = 'tab';
  var VERSION = '4.4.1';
  var DATA_KEY = 'bs.tab';
  var EVENT_KEY = ".".concat(DATA_KEY);
  var DATA_API_KEY = '.data-api';
  var JQUERY_NO_CONFLICT = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.fn[NAME];
  var Event = {
    HIDE: "hide".concat(EVENT_KEY),
    HIDDEN: "hidden".concat(EVENT_KEY),
    SHOW: "show".concat(EVENT_KEY),
    SHOWN: "shown".concat(EVENT_KEY),
    CLICK_DATA_API: "click".concat(EVENT_KEY).concat(DATA_API_KEY)
  };
  var ClassName = {
    DROPDOWN_MENU: 'dropdown-menu',
    ACTIVE: 'active',
    DISABLED: 'disabled',
    FADE: 'fade',
    SHOW: 'show'
  };
  /*IMPORTANT this selectors edited to match out tab strucre*/
  
  var Selector = {
    DROPDOWN: '.dropdown',
    NAV_LIST_GROUP: '.tab__nav',
    ACTIVE: '.active',
    ACTIVE_UL: '> li > .active, > .active',
    DATA_TOGGLE: '.tab__nav > li:not(.arrows-slide), [data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',
    DROPDOWN_TOGGLE: '.dropdown-toggle',
    DROPDOWN_ACTIVE_CHILD: '> .dropdown-menu .active'
  };
  /**
   * ------------------------------------------------------------------------
   * Class Definition
   * ------------------------------------------------------------------------
   */
  
  var Tab = /*#__PURE__*/function () {
    function Tab(element) {
      _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, Tab);
  
      this._element = element;
    } // Getters
  
  
    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(Tab, [{
      key: "show",
      // Public
      value: function show() {
        var _this = this;
  
        if (this._element.parentNode && this._element.parentNode.nodeType === Node.ELEMENT_NODE && jquery__WEBPACK_IMPORTED_MODULE_2___default()(this._element).hasClass(ClassName.ACTIVE) || jquery__WEBPACK_IMPORTED_MODULE_2___default()(this._element).hasClass(ClassName.DISABLED)) {
          return;
        }
  
        var target;
        var previous;
        var listElement = jquery__WEBPACK_IMPORTED_MODULE_2___default()(this._element).closest(Selector.NAV_LIST_GROUP)[0];
        var selector = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_3__["default"].getSelectorFromElement(this._element);
  
        if (listElement) {
          var itemSelector = listElement.nodeName === 'UL' || listElement.nodeName === 'OL' ? Selector.ACTIVE_UL : Selector.ACTIVE;
          previous = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.makeArray(jquery__WEBPACK_IMPORTED_MODULE_2___default()(listElement).find(itemSelector));
          previous = previous[previous.length - 1];
        }
  
        var hideEvent = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.Event(Event.HIDE, {
          relatedTarget: this._element
        });
        var showEvent = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.Event(Event.SHOW, {
          relatedTarget: previous
        });
  
        if (previous) {
          jquery__WEBPACK_IMPORTED_MODULE_2___default()(previous).trigger(hideEvent);
        }
  
        jquery__WEBPACK_IMPORTED_MODULE_2___default()(this._element).trigger(showEvent);
  
        if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) {
          return;
        }
  
        if (selector) {
          target = document.querySelector(selector);
        }
  
        this._activate(this._element, listElement);
  
        var complete = function complete() {
          var hiddenEvent = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.Event(Event.HIDDEN, {
            relatedTarget: _this._element
          });
          var shownEvent = jquery__WEBPACK_IMPORTED_MODULE_2___default.a.Event(Event.SHOWN, {
            relatedTarget: previous
          });
          jquery__WEBPACK_IMPORTED_MODULE_2___default()(previous).trigger(hiddenEvent);
          jquery__WEBPACK_IMPORTED_MODULE_2___default()(_this._element).trigger(shownEvent);
        };
  
        if (target) {
          this._activate(target, target.parentNode, complete);
        } else {
          complete();
        }
      }
    }, {
      key: "dispose",
      value: function dispose() {
        jquery__WEBPACK_IMPORTED_MODULE_2___default.a.removeData(this._element, DATA_KEY);
        this._element = null;
      } // Private
  
    }, {
      key: "_activate",
      value: function _activate(element, container, callback) {
        var _this2 = this;
  
        var activeElements = container && (container.nodeName === 'UL' || container.nodeName === 'OL') ? jquery__WEBPACK_IMPORTED_MODULE_2___default()(container).find(Selector.ACTIVE_UL) : jquery__WEBPACK_IMPORTED_MODULE_2___default()(container).children(Selector.ACTIVE);
        var active = activeElements[0];
        var isTransitioning = callback && active && jquery__WEBPACK_IMPORTED_MODULE_2___default()(active).hasClass(ClassName.FADE);
  
        var complete = function complete() {
          return _this2._transitionComplete(element, active, callback);
        };
  
        if (active && isTransitioning) {
          var transitionDuration = _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_3__["default"].getTransitionDurationFromElement(active);
          jquery__WEBPACK_IMPORTED_MODULE_2___default()(active).removeClass(ClassName.SHOW).one(_utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_3__["default"].TRANSITION_END, complete).emulateTransitionEnd(transitionDuration);
        } else {
          complete();
        }
      }
    }, {
      key: "_transitionComplete",
      value: function _transitionComplete(element, active, callback) {
        if (active) {
          jquery__WEBPACK_IMPORTED_MODULE_2___default()(active).removeClass(ClassName.ACTIVE);
          var dropdownChild = jquery__WEBPACK_IMPORTED_MODULE_2___default()(active.parentNode).find(Selector.DROPDOWN_ACTIVE_CHILD)[0];
  
          if (dropdownChild) {
            jquery__WEBPACK_IMPORTED_MODULE_2___default()(dropdownChild).removeClass(ClassName.ACTIVE);
          }
  
          if (active.getAttribute('role') === 'tab') {
            active.setAttribute('aria-selected', false);
          }
        }
  
        jquery__WEBPACK_IMPORTED_MODULE_2___default()(element).addClass(ClassName.ACTIVE);
  
        if (element.getAttribute('role') === 'tab') {
          element.setAttribute('aria-selected', true);
        }
  
        _utility_js_bootstrap_utils__WEBPACK_IMPORTED_MODULE_3__["default"].reflow(element);
  
        if (element.classList.contains(ClassName.FADE)) {
          element.classList.add(ClassName.SHOW);
        }
  
        if (element.parentNode && jquery__WEBPACK_IMPORTED_MODULE_2___default()(element.parentNode).hasClass(ClassName.DROPDOWN_MENU)) {
          var dropdownElement = jquery__WEBPACK_IMPORTED_MODULE_2___default()(element).closest(Selector.DROPDOWN)[0];
  
          if (dropdownElement) {
            var dropdownToggleList = [].slice.call(dropdownElement.querySelectorAll(Selector.DROPDOWN_TOGGLE));
            jquery__WEBPACK_IMPORTED_MODULE_2___default()(dropdownToggleList).addClass(ClassName.ACTIVE);
          }
  
          element.setAttribute('aria-expanded', true);
        }
  
        if (callback) {
          callback();
        }
      } // Static
  
    }], [{
      key: "_jQueryInterface",
      value: function _jQueryInterface(config) {
        return this.each(function () {
          var $this = jquery__WEBPACK_IMPORTED_MODULE_2___default()(this);
          var data = $this.data(DATA_KEY);
  
          if (!data) {
            data = new Tab(this);
            $this.data(DATA_KEY, data);
          }
  
          if (typeof config === 'string') {
            if (typeof data[config] === 'undefined') {
              throw new TypeError("No method named \"".concat(config, "\""));
            }
  
            data[config]();
          }
        });
      }
    }, {
      key: "VERSION",
      get: function get() {
        return VERSION;
      }
    }]);
  
    return Tab;
  }();
  /**
   * ------------------------------------------------------------------------
   * Data Api implementation
   * ------------------------------------------------------------------------
   */
  
  
  jquery__WEBPACK_IMPORTED_MODULE_2___default()(document).on(Event.CLICK_DATA_API, Selector.DATA_TOGGLE, function (event) {
    var refElement = jquery__WEBPACK_IMPORTED_MODULE_2___default()(this).attr("data-toggle");
  
    if (refElement == "tab") {
      event.preventDefault();
    }
  
    Tab._jQueryInterface.call(jquery__WEBPACK_IMPORTED_MODULE_2___default()(this), 'show');
  });
  /**
   * ------------------------------------------------------------------------
   * jQuery
   * ------------------------------------------------------------------------
   */
  
  jquery__WEBPACK_IMPORTED_MODULE_2___default.a.fn[NAME] = Tab._jQueryInterface;
  jquery__WEBPACK_IMPORTED_MODULE_2___default.a.fn[NAME].Constructor = Tab;
  
  jquery__WEBPACK_IMPORTED_MODULE_2___default.a.fn[NAME].noConflict = function () {
    jquery__WEBPACK_IMPORTED_MODULE_2___default.a.fn[NAME] = JQUERY_NO_CONFLICT;
    return Tab._jQueryInterface;
  };
  
  /* harmony default export */ __webpack_exports__["default"] = (Tab);
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/touchSwipe/jquery.touchSwipe.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/touchSwipe/jquery.touchSwipe.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /*!
   * @fileOverview TouchSwipe - jQuery Plugin
   * @version 1.6.18
   *
   * @author Matt Bryson http://www.github.com/mattbryson
   * @see https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
   * @see http://labs.rampinteractive.co.uk/touchSwipe/
   * @see http://plugins.jquery.com/project/touchSwipe
   * @license
   * Copyright (c) 2010-2015 Matt Bryson
   * Dual licensed under the MIT or GPL Version 2 licenses.
   *
   */
  
  /*
   *
   * Changelog
   * $Date: 2010-12-12 (Wed, 12 Dec 2010) $
   * $version: 1.0.0
   * $version: 1.0.1 - removed multibyte comments
   *
   * $Date: 2011-21-02 (Mon, 21 Feb 2011) $
   * $version: 1.1.0 	- added allowPageScroll property to allow swiping and scrolling of page
   *					- changed handler signatures so one handler can be used for multiple events
   * $Date: 2011-23-02 (Wed, 23 Feb 2011) $
   * $version: 1.2.0 	- added click handler. This is fired if the user simply clicks and does not swipe. The event object and click target are passed to handler.
   *					- If you use the http://code.google.com/p/jquery-ui-for-ipad-and-iphone/ plugin, you can also assign jQuery mouse events to children of a touchSwipe object.
   * $version: 1.2.1 	- removed console log!
   *
   * $version: 1.2.2 	- Fixed bug where scope was not preserved in callback methods.
   *
   * $Date: 2011-28-04 (Thurs, 28 April 2011) $
   * $version: 1.2.4 	- Changed licence terms to be MIT or GPL inline with jQuery. Added check for support of touch events to stop non compatible browsers erroring.
   *
   * $Date: 2011-27-09 (Tues, 27 September 2011) $
   * $version: 1.2.5 	- Added support for testing swipes with mouse on desktop browser (thanks to https://github.com/joelhy)
   *
   * $Date: 2012-14-05 (Mon, 14 May 2012) $
   * $version: 1.2.6 	- Added timeThreshold between start and end touch, so user can ignore slow swipes (thanks to Mark Chase). Default is null, all swipes are detected
   *
   * $Date: 2012-05-06 (Tues, 05 June 2012) $
   * $version: 1.2.7 	- Changed time threshold to have null default for backwards compatibility. Added duration param passed back in events, and refactored how time is handled.
   *
   * $Date: 2012-05-06 (Tues, 05 June 2012) $
   * $version: 1.2.8 	- Added the possibility to return a value like null or false in the trigger callback. In that way we can control when the touch start/move should take effect or not (simply by returning in some cases return null; or return false;) This effects the ontouchstart/ontouchmove event.
   *
   * $Date: 2012-06-06 (Wed, 06 June 2012) $
   * $version: 1.3.0 	- Refactored whole plugin to allow for methods to be executed, as well as exposed defaults for user override. Added 'enable', 'disable', and 'destroy' methods
   *
   * $Date: 2012-05-06 (Fri, 05 June 2012) $
   * $version: 1.3.1 	- Bug fixes  - bind() with false as last argument is no longer supported in jQuery 1.6, also, if you just click, the duration is now returned correctly.
   *
   * $Date: 2012-29-07 (Sun, 29 July 2012) $
   * $version: 1.3.2	- Added fallbackToMouseEvents option to NOT capture mouse events on non touch devices.
   * 			- Added "all" fingers value to the fingers property, so any combination of fingers triggers the swipe, allowing event handlers to check the finger count
   *
   * $Date: 2012-09-08 (Thurs, 9 Aug 2012) $
   * $version: 1.3.3	- Code tidy prep for minefied version
   *
   * $Date: 2012-04-10 (wed, 4 Oct 2012) $
   * $version: 1.4.0	- Added pinch support, pinchIn and pinchOut
   *
   * $Date: 2012-11-10 (Thurs, 11 Oct 2012) $
   * $version: 1.5.0	- Added excludedElements, a jquery selector that specifies child elements that do NOT trigger swipes. By default, this is .noSwipe
   *
   * $Date: 2012-22-10 (Mon, 22 Oct 2012) $
   * $version: 1.5.1	- Fixed bug with jQuery 1.8 and trailing comma in excludedElements
   *					- Fixed bug with IE and eventPreventDefault()
   * $Date: 2013-01-12 (Fri, 12 Jan 2013) $
   * $version: 1.6.0	- Fixed bugs with pinching, mainly when both pinch and swipe enabled, as well as adding time threshold for multifinger gestures, so releasing one finger beofre the other doesnt trigger as single finger gesture.
   *					- made the demo site all static local HTML pages so they can be run locally by a developer
   *					- added jsDoc comments and added documentation for the plugin
   *					- code tidy
   *					- added triggerOnTouchLeave property that will end the event when the user swipes off the element.
   * $Date: 2013-03-23 (Sat, 23 Mar 2013) $
   * $version: 1.6.1	- Added support for ie8 touch events
   * $version: 1.6.2	- Added support for events binding with on / off / bind in jQ for all callback names.
   *                   - Deprecated the 'click' handler in favour of tap.
   *                   - added cancelThreshold property
   *                   - added option method to update init options at runtime
   * $version 1.6.3    - added doubletap, longtap events and longTapThreshold, doubleTapThreshold property
   *
   * $Date: 2013-04-04 (Thurs, 04 April 2013) $
   * $version 1.6.4    - Fixed bug with cancelThreshold introduced in 1.6.3, where swipe status no longer fired start event, and stopped once swiping back.
   *
   * $Date: 2013-08-24 (Sat, 24 Aug 2013) $
   * $version 1.6.5    - Merged a few pull requests fixing various bugs, added AMD support.
   *
   * $Date: 2014-06-04 (Wed, 04 June 2014) $
   * $version 1.6.6 	- Merge of pull requests.
   *    				- IE10 touch support
   *    				- Only prevent default event handling on valid swipe
   *    				- Separate license/changelog comment
   *    				- Detect if the swipe is valid at the end of the touch event.
   *    				- Pass fingerdata to event handlers.
   *    				- Add 'hold' gesture
   *    				- Be more tolerant about the tap distance
   *    				- Typos and minor fixes
   *
   * $Date: 2015-22-01 (Thurs, 22 Jan 2015) $
   * $version 1.6.7    - Added patch from https://github.com/mattbryson/TouchSwipe-Jquery-Plugin/issues/206 to fix memory leak
   *
   * $Date: 2015-2-2 (Mon, 2 Feb 2015) $
   * $version 1.6.8    - Added preventDefaultEvents option to proxy events regardless.
   *					- Fixed issue with swipe and pinch not triggering at the same time
   *
   * $Date: 2015-9-6 (Tues, 9 June 2015) $
   * $version 1.6.9    - Added PR from jdalton/hybrid to fix pointer events
   *					- Added scrolling demo
   *					- Added version property to plugin
   *
   * $Date: 2015-1-10 (Wed, 1 October 2015) $
   * $version 1.6.10    - Added PR from beatspace to fix tap events
   * $version 1.6.11    - Added PRs from indri-indri ( Doc tidyup), kkirsche ( Bower tidy up ), UziTech (preventDefaultEvents fixes )
   *					 - Allowed setting multiple options via .swipe("options", options_hash) and more simply .swipe(options_hash) or exisitng instances
   * $version 1.6.12    - Fixed bug with multi finger releases above 2 not triggering events
   *
   * $Date: 2015-12-18 (Fri, 18 December 2015) $
   * $version 1.6.13    - Added PRs
   *                    - Fixed #267 allowPageScroll not working correctly
   * $version 1.6.14    - Fixed #220 / #248 doubletap not firing with swipes, #223 commonJS compatible
   * $version 1.6.15    - More bug fixes
   *
   * $Date: 2016-04-29 (Fri, 29 April 2016) $
   * $version 1.6.16    - Swipes with 0 distance now allow default events to trigger.  So tapping any form elements or A tags will allow default interaction, but swiping will trigger a swipe.
                          Removed the a, input, select etc from the excluded Children list as the 0 distance tap solves that issue.
  * $Date: 2016-05-19  (Fri, 29 April 2016) $
  * $version 1.6.17     - Fixed context issue when calling instance methods via $("selector").swipe("method");
  * $version 1.6.18     - now honors fallbackToMouseEvents=false for MS Pointer events when a Mouse is used.
  
   */
  
  /**
   * See (http://jquery.com/).
   * @name $
   * @class
   * See the jQuery Library  (http://jquery.com/) for full details.  This just
   * documents the function and classes that are added to jQuery by this plug-in.
   */
  
  /**
   * See (http://jquery.com/)
   * @name fn
   * @class
   * See the jQuery Library  (http://jquery.com/) for full details.  This just
   * documents the function and classes that are added to jQuery by this plug-in.
   * @memberOf $
   */
  (function (factory) {
    if ( true && module.exports) {
      // CommonJS Module
      factory(__webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js-exposed"));
    } else {
      // Browser globals.
      factory(jQuery);
    }
  })(function ($) {
    "use strict"; //Constants
  
    var VERSION = "1.6.18",
        LEFT = "left",
        RIGHT = "right",
        UP = "up",
        DOWN = "down",
        IN = "in",
        OUT = "out",
        NONE = "none",
        AUTO = "auto",
        SWIPE = "swipe",
        PINCH = "pinch",
        TAP = "tap",
        DOUBLE_TAP = "doubletap",
        LONG_TAP = "longtap",
        HOLD = "hold",
        HORIZONTAL = "horizontal",
        VERTICAL = "vertical",
        ALL_FINGERS = "all",
        DOUBLE_TAP_THRESHOLD = 10,
        PHASE_START = "start",
        PHASE_MOVE = "move",
        PHASE_END = "end",
        PHASE_CANCEL = "cancel",
        SUPPORTS_TOUCH = ('ontouchstart' in window),
        SUPPORTS_POINTER_IE10 = window.navigator.msPointerEnabled && !window.navigator.pointerEnabled && !SUPPORTS_TOUCH,
        SUPPORTS_POINTER = (window.navigator.pointerEnabled || window.navigator.msPointerEnabled) && !SUPPORTS_TOUCH,
        PLUGIN_NS = 'TouchSwipe';
    /**
    * The default configuration, and available options to configure touch swipe with.
    * You can set the default values by updating any of the properties prior to instantiation.
    * @name $.fn.swipe.defaults
    * @namespace
    * @property {int} [fingers=1] The number of fingers to detect in a swipe. Any swipes that do not meet this requirement will NOT trigger swipe handlers.
    * @property {int} [threshold=75] The number of pixels that the user must move their finger by before it is considered a swipe.
    * @property {int} [cancelThreshold=null] The number of pixels that the user must move their finger back from the original swipe direction to cancel the gesture.
    * @property {int} [pinchThreshold=20] The number of pixels that the user must pinch their finger by before it is considered a pinch.
    * @property {int} [maxTimeThreshold=null] Time, in milliseconds, between touchStart and touchEnd must NOT exceed in order to be considered a swipe.
    * @property {int} [fingerReleaseThreshold=250] Time in milliseconds between releasing multiple fingers.  If 2 fingers are down, and are released one after the other, if they are within this threshold, it counts as a simultaneous release.
    * @property {int} [longTapThreshold=500] Time in milliseconds between tap and release for a long tap
    * @property {int} [doubleTapThreshold=200] Time in milliseconds between 2 taps to count as a double tap
    * @property {function} [swipe=null] A handler to catch all swipes. See {@link $.fn.swipe#event:swipe}
    * @property {function} [swipeLeft=null] A handler that is triggered for "left" swipes. See {@link $.fn.swipe#event:swipeLeft}
    * @property {function} [swipeRight=null] A handler that is triggered for "right" swipes. See {@link $.fn.swipe#event:swipeRight}
    * @property {function} [swipeUp=null] A handler that is triggered for "up" swipes. See {@link $.fn.swipe#event:swipeUp}
    * @property {function} [swipeDown=null] A handler that is triggered for "down" swipes. See {@link $.fn.swipe#event:swipeDown}
    * @property {function} [swipeStatus=null] A handler triggered for every phase of the swipe. See {@link $.fn.swipe#event:swipeStatus}
    * @property {function} [pinchIn=null] A handler triggered for pinch in events. See {@link $.fn.swipe#event:pinchIn}
    * @property {function} [pinchOut=null] A handler triggered for pinch out events. See {@link $.fn.swipe#event:pinchOut}
    * @property {function} [pinchStatus=null] A handler triggered for every phase of a pinch. See {@link $.fn.swipe#event:pinchStatus}
    * @property {function} [tap=null] A handler triggered when a user just taps on the item, rather than swipes it. If they do not move, tap is triggered, if they do move, it is not.
    * @property {function} [doubleTap=null] A handler triggered when a user double taps on the item. The delay between taps can be set with the doubleTapThreshold property. See {@link $.fn.swipe.defaults#doubleTapThreshold}
    * @property {function} [longTap=null] A handler triggered when a user long taps on the item. The delay between start and end can be set with the longTapThreshold property. See {@link $.fn.swipe.defaults#longTapThreshold}
    * @property (function) [hold=null] A handler triggered when a user reaches longTapThreshold on the item. See {@link $.fn.swipe.defaults#longTapThreshold}
    * @property {boolean} [triggerOnTouchEnd=true] If true, the swipe events are triggered when the touch end event is received (user releases finger).  If false, it will be triggered on reaching the threshold, and then cancel the touch event automatically.
    * @property {boolean} [triggerOnTouchLeave=false] If true, then when the user leaves the swipe object, the swipe will end and trigger appropriate handlers.
    * @property {string|undefined} [allowPageScroll='auto'] How the browser handles page scrolls when the user is swiping on a touchSwipe object. See {@link $.fn.swipe.pageScroll}.  <br/><br/>
                      <code>"auto"</code> : all undefined swipes will cause the page to scroll in that direction. <br/>
                      <code>"none"</code> : the page will not scroll when user swipes. <br/>
                      <code>"horizontal"</code> : will force page to scroll on horizontal swipes. <br/>
                      <code>"vertical"</code> : will force page to scroll on vertical swipes. <br/>
    * @property {boolean} [fallbackToMouseEvents=true] If true mouse events are used when run on a non touch device, false will stop swipes being triggered by mouse events on non touch devices.
    * @property {string} [excludedElements=".noSwipe"] A jquery selector that specifies child elements that do NOT trigger swipes. By default this excludes elements with the class .noSwipe .
    * @property {boolean} [preventDefaultEvents=true] by default default events are cancelled, so the page doesn't move.  You can disable this so both native events fire as well as your handlers.
     */
  
    var defaults = {
      fingers: 1,
      threshold: 75,
      cancelThreshold: null,
      pinchThreshold: 20,
      maxTimeThreshold: null,
      fingerReleaseThreshold: 250,
      longTapThreshold: 500,
      doubleTapThreshold: 200,
      swipe: null,
      swipeLeft: null,
      swipeRight: null,
      swipeUp: null,
      swipeDown: null,
      swipeStatus: null,
      pinchIn: null,
      pinchOut: null,
      pinchStatus: null,
      click: null,
      //Deprecated since 1.6.2
      tap: null,
      doubleTap: null,
      longTap: null,
      hold: null,
      triggerOnTouchEnd: true,
      triggerOnTouchLeave: false,
      allowPageScroll: "auto",
      fallbackToMouseEvents: true,
      excludedElements: ".noSwipe",
      preventDefaultEvents: true
    };
    /**
     * Applies TouchSwipe behaviour to one or more jQuery objects.
     * The TouchSwipe plugin can be instantiated via this method, or methods within
     * TouchSwipe can be executed via this method as per jQuery plugin architecture.
     * An existing plugin can have its options changed simply by re calling .swipe(options)
     * @see TouchSwipe
     * @class
     * @param {Mixed} method If the current DOMNode is a TouchSwipe object, and <code>method</code> is a TouchSwipe method, then
     * the <code>method</code> is executed, and any following arguments are passed to the TouchSwipe method.
     * If <code>method</code> is an object, then the TouchSwipe class is instantiated on the current DOMNode, passing the
     * configuration properties defined in the object. See TouchSwipe
     *
     */
  
    $.fn.swipe = function (method) {
      var $this = $(this),
          plugin = $this.data(PLUGIN_NS); //Check if we are already instantiated and trying to execute a method
  
      if (plugin && typeof method === 'string') {
        if (plugin[method]) {
          return plugin[method].apply(plugin, Array.prototype.slice.call(arguments, 1));
        } else {
          $.error('Method ' + method + ' does not exist on jQuery.swipe');
        }
      } //Else update existing plugin with new options hash
      else if (plugin && _typeof(method) === 'object') {
          plugin['option'].apply(plugin, arguments);
        } //Else not instantiated and trying to pass init object (or nothing)
        else if (!plugin && (_typeof(method) === 'object' || !method)) {
            return init.apply(this, arguments);
          }
  
      return $this;
    };
    /**
     * The version of the plugin
     * @readonly
     */
  
  
    $.fn.swipe.version = VERSION; //Expose our defaults so a user could override the plugin defaults
  
    $.fn.swipe.defaults = defaults;
    /**
     * The phases that a touch event goes through.  The <code>phase</code> is passed to the event handlers.
     * These properties are read only, attempting to change them will not alter the values passed to the event handlers.
     * @namespace
     * @readonly
     * @property {string} PHASE_START Constant indicating the start phase of the touch event. Value is <code>"start"</code>.
     * @property {string} PHASE_MOVE Constant indicating the move phase of the touch event. Value is <code>"move"</code>.
     * @property {string} PHASE_END Constant indicating the end phase of the touch event. Value is <code>"end"</code>.
     * @property {string} PHASE_CANCEL Constant indicating the cancel phase of the touch event. Value is <code>"cancel"</code>.
     */
  
    $.fn.swipe.phases = {
      PHASE_START: PHASE_START,
      PHASE_MOVE: PHASE_MOVE,
      PHASE_END: PHASE_END,
      PHASE_CANCEL: PHASE_CANCEL
    };
    /**
     * The direction constants that are passed to the event handlers.
     * These properties are read only, attempting to change them will not alter the values passed to the event handlers.
     * @namespace
     * @readonly
     * @property {string} LEFT Constant indicating the left direction. Value is <code>"left"</code>.
     * @property {string} RIGHT Constant indicating the right direction. Value is <code>"right"</code>.
     * @property {string} UP Constant indicating the up direction. Value is <code>"up"</code>.
     * @property {string} DOWN Constant indicating the down direction. Value is <code>"cancel"</code>.
     * @property {string} IN Constant indicating the in direction. Value is <code>"in"</code>.
     * @property {string} OUT Constant indicating the out direction. Value is <code>"out"</code>.
     */
  
    $.fn.swipe.directions = {
      LEFT: LEFT,
      RIGHT: RIGHT,
      UP: UP,
      DOWN: DOWN,
      IN: IN,
      OUT: OUT
    };
    /**
     * The page scroll constants that can be used to set the value of <code>allowPageScroll</code> option
     * These properties are read only
     * @namespace
     * @readonly
     * @see $.fn.swipe.defaults#allowPageScroll
     * @property {string} NONE Constant indicating no page scrolling is allowed. Value is <code>"none"</code>.
     * @property {string} HORIZONTAL Constant indicating horizontal page scrolling is allowed. Value is <code>"horizontal"</code>.
     * @property {string} VERTICAL Constant indicating vertical page scrolling is allowed. Value is <code>"vertical"</code>.
     * @property {string} AUTO Constant indicating either horizontal or vertical will be allowed, depending on the swipe handlers registered. Value is <code>"auto"</code>.
     */
  
    $.fn.swipe.pageScroll = {
      NONE: NONE,
      HORIZONTAL: HORIZONTAL,
      VERTICAL: VERTICAL,
      AUTO: AUTO
    };
    /**
     * Constants representing the number of fingers used in a swipe.  These are used to set both the value of <code>fingers</code> in the
     * options object, as well as the value of the <code>fingers</code> event property.
     * These properties are read only, attempting to change them will not alter the values passed to the event handlers.
     * @namespace
     * @readonly
     * @see $.fn.swipe.defaults#fingers
     * @property {string} ONE Constant indicating 1 finger is to be detected / was detected. Value is <code>1</code>.
     * @property {string} TWO Constant indicating 2 fingers are to be detected / were detected. Value is <code>2</code>.
     * @property {string} THREE Constant indicating 3 finger are to be detected / were detected. Value is <code>3</code>.
     * @property {string} FOUR Constant indicating 4 finger are to be detected / were detected. Not all devices support this. Value is <code>4</code>.
     * @property {string} FIVE Constant indicating 5 finger are to be detected / were detected. Not all devices support this. Value is <code>5</code>.
     * @property {string} ALL Constant indicating any combination of finger are to be detected.  Value is <code>"all"</code>.
     */
  
    $.fn.swipe.fingers = {
      ONE: 1,
      TWO: 2,
      THREE: 3,
      FOUR: 4,
      FIVE: 5,
      ALL: ALL_FINGERS
    };
    /**
     * Initialise the plugin for each DOM element matched
     * This creates a new instance of the main TouchSwipe class for each DOM element, and then
     * saves a reference to that instance in the elements data property.
     * @internal
     */
  
    function init(options) {
      //Prep and extend the options
      if (options && options.allowPageScroll === undefined && (options.swipe !== undefined || options.swipeStatus !== undefined)) {
        options.allowPageScroll = NONE;
      } //Check for deprecated options
      //Ensure that any old click handlers are assigned to the new tap, unless we have a tap
  
  
      if (options.click !== undefined && options.tap === undefined) {
        options.tap = options.click;
      }
  
      if (!options) {
        options = {};
      } //pass empty object so we dont modify the defaults
  
  
      options = $.extend({}, $.fn.swipe.defaults, options); //For each element instantiate the plugin
  
      return this.each(function () {
        var $this = $(this); //Check we havent already initialised the plugin
  
        var plugin = $this.data(PLUGIN_NS);
  
        if (!plugin) {
          plugin = new TouchSwipe(this, options);
          $this.data(PLUGIN_NS, plugin);
        }
      });
    }
    /**
     * Main TouchSwipe Plugin Class.
     * Do not use this to construct your TouchSwipe object, use the jQuery plugin method $.fn.swipe(); {@link $.fn.swipe}
     * @private
     * @name TouchSwipe
     * @param {DOMNode} element The HTML DOM object to apply to plugin to
     * @param {Object} options The options to configure the plugin with.  @link {$.fn.swipe.defaults}
     * @see $.fh.swipe.defaults
     * @see $.fh.swipe
     * @class
     */
  
  
    function TouchSwipe(element, options) {
      //take a local/instacne level copy of the options - should make it this.options really...
      var options = $.extend({}, options);
      var useTouchEvents = SUPPORTS_TOUCH || SUPPORTS_POINTER || !options.fallbackToMouseEvents,
          START_EV = useTouchEvents ? SUPPORTS_POINTER ? SUPPORTS_POINTER_IE10 ? 'MSPointerDown' : 'pointerdown' : 'touchstart' : 'mousedown',
          MOVE_EV = useTouchEvents ? SUPPORTS_POINTER ? SUPPORTS_POINTER_IE10 ? 'MSPointerMove' : 'pointermove' : 'touchmove' : 'mousemove',
          END_EV = useTouchEvents ? SUPPORTS_POINTER ? SUPPORTS_POINTER_IE10 ? 'MSPointerUp' : 'pointerup' : 'touchend' : 'mouseup',
          LEAVE_EV = useTouchEvents ? SUPPORTS_POINTER ? 'mouseleave' : null : 'mouseleave',
          //we manually detect leave on touch devices, so null event here
      CANCEL_EV = SUPPORTS_POINTER ? SUPPORTS_POINTER_IE10 ? 'MSPointerCancel' : 'pointercancel' : 'touchcancel'; //touch properties
  
      var distance = 0,
          direction = null,
          currentDirection = null,
          duration = 0,
          startTouchesDistance = 0,
          endTouchesDistance = 0,
          pinchZoom = 1,
          pinchDistance = 0,
          pinchDirection = 0,
          maximumsMap = null; //jQuery wrapped element for this instance
  
      var $element = $(element); //Current phase of th touch cycle
  
      var phase = "start"; // the current number of fingers being used.
  
      var fingerCount = 0; //track mouse points / delta
  
      var fingerData = {}; //track times
  
      var startTime = 0,
          endTime = 0,
          previousTouchEndTime = 0,
          fingerCountAtRelease = 0,
          doubleTapStartTime = 0; //Timeouts
  
      var singleTapTimeout = null,
          holdTimeout = null; // Add gestures to all swipable areas if supported
  
      try {
        $element.bind(START_EV, touchStart);
        $element.bind(CANCEL_EV, touchCancel);
      } catch (e) {
        $.error('events not supported ' + START_EV + ',' + CANCEL_EV + ' on jQuery.swipe');
      } //
      //Public methods
      //
  
      /**
       * re-enables the swipe plugin with the previous configuration
       * @function
       * @name $.fn.swipe#enable
       * @return {DOMNode} The Dom element that was registered with TouchSwipe
       * @example $("#element").swipe("enable");
       */
  
  
      this.enable = function () {
        //Incase we are already enabled, clean up...
        this.disable();
        $element.bind(START_EV, touchStart);
        $element.bind(CANCEL_EV, touchCancel);
        return $element;
      };
      /**
       * disables the swipe plugin
       * @function
       * @name $.fn.swipe#disable
       * @return {DOMNode} The Dom element that is now registered with TouchSwipe
       * @example $("#element").swipe("disable");
       */
  
  
      this.disable = function () {
        removeListeners();
        return $element;
      };
      /**
       * Destroy the swipe plugin completely. To use any swipe methods, you must re initialise the plugin.
       * @function
       * @name $.fn.swipe#destroy
       * @example $("#element").swipe("destroy");
       */
  
  
      this.destroy = function () {
        removeListeners();
        $element.data(PLUGIN_NS, null);
        $element = null;
      };
      /**
       * Allows run time updating of the swipe configuration options.
       * @function
       * @name $.fn.swipe#option
       * @param {String} property The option property to get or set, or a has of multiple options to set
       * @param {Object} [value] The value to set the property to
       * @return {Object} If only a property name is passed, then that property value is returned. If nothing is passed the current options hash is returned.
       * @example $("#element").swipe("option", "threshold"); // return the threshold
       * @example $("#element").swipe("option", "threshold", 100); // set the threshold after init
       * @example $("#element").swipe("option", {threshold:100, fingers:3} ); // set multiple properties after init
       * @example $("#element").swipe({threshold:100, fingers:3} ); // set multiple properties after init - the "option" method is optional!
       * @example $("#element").swipe("option"); // Return the current options hash
       * @see $.fn.swipe.defaults
       *
       */
  
  
      this.option = function (property, value) {
        if (_typeof(property) === 'object') {
          options = $.extend(options, property);
        } else if (options[property] !== undefined) {
          if (value === undefined) {
            return options[property];
          } else {
            options[property] = value;
          }
        } else if (!property) {
          return options;
        } else {
          $.error('Option ' + property + ' does not exist on jQuery.swipe.options');
        }
  
        return null;
      }; //
      // Private methods
      //
      //
      // EVENTS
      //
  
      /**
       * Event handler for a touch start event.
       * Stops the default click event from triggering and stores where we touched
       * @inner
       * @param {object} jqEvent The normalised jQuery event object.
       */
  
  
      function touchStart(jqEvent) {
        //If we already in a touch event (a finger already in use) then ignore subsequent ones..
        if (getTouchInProgress()) {
          return;
        } //Check if this element matches any in the excluded elements selectors,  or its parent is excluded, if so, DON'T swipe
  
  
        if ($(jqEvent.target).closest(options.excludedElements, $element).length > 0) {
          return;
        } //As we use Jquery bind for events, we need to target the original event object
        //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.
  
  
        var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent; //If we have a pointer event, whoes type is 'mouse' and we have said NO mouse events, then dont do anything.
  
        if (event.pointerType && event.pointerType == "mouse" && options.fallbackToMouseEvents == false) {
          return;
        }
  
        ;
        var ret,
            touches = event.touches,
            evt = touches ? touches[0] : event;
        phase = PHASE_START; //If we support touches, get the finger count
  
        if (touches) {
          // get the total number of fingers touching the screen
          fingerCount = touches.length;
        } //Else this is the desktop, so stop the browser from dragging content
        else if (options.preventDefaultEvents !== false) {
            jqEvent.preventDefault(); //call this on jq event so we are cross browser
          } //clear vars..
  
  
        distance = 0;
        direction = null;
        currentDirection = null;
        pinchDirection = null;
        duration = 0;
        startTouchesDistance = 0;
        endTouchesDistance = 0;
        pinchZoom = 1;
        pinchDistance = 0;
        maximumsMap = createMaximumsData();
        cancelMultiFingerRelease(); //Create the default finger data
  
        createFingerData(0, evt); // check the number of fingers is what we are looking for, or we are capturing pinches
  
        if (!touches || fingerCount === options.fingers || options.fingers === ALL_FINGERS || hasPinches()) {
          // get the coordinates of the touch
          startTime = getTimeStamp();
  
          if (fingerCount == 2) {
            //Keep track of the initial pinch distance, so we can calculate the diff later
            //Store second finger data as start
            createFingerData(1, touches[1]);
            startTouchesDistance = endTouchesDistance = calculateTouchesDistance(fingerData[0].start, fingerData[1].start);
          }
  
          if (options.swipeStatus || options.pinchStatus) {
            ret = triggerHandler(event, phase);
          }
        } else {
          //A touch with more or less than the fingers we are looking for, so cancel
          ret = false;
        } //If we have a return value from the users handler, then return and cancel
  
  
        if (ret === false) {
          phase = PHASE_CANCEL;
          triggerHandler(event, phase);
          return ret;
        } else {
          if (options.hold) {
            holdTimeout = setTimeout($.proxy(function () {
              //Trigger the event
              $element.trigger('hold', [event.target]); //Fire the callback
  
              if (options.hold) {
                ret = options.hold.call($element, event, event.target);
              }
            }, this), options.longTapThreshold);
          }
  
          setTouchInProgress(true);
        }
  
        return null;
      }
  
      ;
      /**
       * Event handler for a touch move event.
       * If we change fingers during move, then cancel the event
       * @inner
       * @param {object} jqEvent The normalised jQuery event object.
       */
  
      function touchMove(jqEvent) {
        //As we use Jquery bind for events, we need to target the original event object
        //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.
        var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent; //If we are ending, cancelling, or within the threshold of 2 fingers being released, don't track anything..
  
        if (phase === PHASE_END || phase === PHASE_CANCEL || inMultiFingerRelease()) return;
        var ret,
            touches = event.touches,
            evt = touches ? touches[0] : event; //Update the  finger data
  
        var currentFinger = updateFingerData(evt);
        endTime = getTimeStamp();
  
        if (touches) {
          fingerCount = touches.length;
        }
  
        if (options.hold) {
          clearTimeout(holdTimeout);
        }
  
        phase = PHASE_MOVE; //If we have 2 fingers get Touches distance as well
  
        if (fingerCount == 2) {
          //Keep track of the initial pinch distance, so we can calculate the diff later
          //We do this here as well as the start event, in case they start with 1 finger, and the press 2 fingers
          if (startTouchesDistance == 0) {
            //Create second finger if this is the first time...
            createFingerData(1, touches[1]);
            startTouchesDistance = endTouchesDistance = calculateTouchesDistance(fingerData[0].start, fingerData[1].start);
          } else {
            //Else just update the second finger
            updateFingerData(touches[1]);
            endTouchesDistance = calculateTouchesDistance(fingerData[0].end, fingerData[1].end);
            pinchDirection = calculatePinchDirection(fingerData[0].end, fingerData[1].end);
          }
  
          pinchZoom = calculatePinchZoom(startTouchesDistance, endTouchesDistance);
          pinchDistance = Math.abs(startTouchesDistance - endTouchesDistance);
        }
  
        if (fingerCount === options.fingers || options.fingers === ALL_FINGERS || !touches || hasPinches()) {
          //The overall direction of the swipe. From start to now.
          direction = calculateDirection(currentFinger.start, currentFinger.end); //The immediate direction of the swipe, direction between the last movement and this one.
  
          currentDirection = calculateDirection(currentFinger.last, currentFinger.end); //Check if we need to prevent default event (page scroll / pinch zoom) or not
  
          validateDefaultEvent(jqEvent, currentDirection); //Distance and duration are all off the main finger
  
          distance = calculateDistance(currentFinger.start, currentFinger.end);
          duration = calculateDuration(); //Cache the maximum distance we made in this direction
  
          setMaxDistance(direction, distance); //Trigger status handler
  
          ret = triggerHandler(event, phase); //If we trigger end events when threshold are met, or trigger events when touch leaves element
  
          if (!options.triggerOnTouchEnd || options.triggerOnTouchLeave) {
            var inBounds = true; //If checking if we leave the element, run the bounds check (we can use touchleave as its not supported on webkit)
  
            if (options.triggerOnTouchLeave) {
              var bounds = getbounds(this);
              inBounds = isInBounds(currentFinger.end, bounds);
            } //Trigger end handles as we swipe if thresholds met or if we have left the element if the user has asked to check these..
  
  
            if (!options.triggerOnTouchEnd && inBounds) {
              phase = getNextPhase(PHASE_MOVE);
            } //We end if out of bounds here, so set current phase to END, and check if its modified
            else if (options.triggerOnTouchLeave && !inBounds) {
                phase = getNextPhase(PHASE_END);
              }
  
            if (phase == PHASE_CANCEL || phase == PHASE_END) {
              triggerHandler(event, phase);
            }
          }
        } else {
          phase = PHASE_CANCEL;
          triggerHandler(event, phase);
        }
  
        if (ret === false) {
          phase = PHASE_CANCEL;
          triggerHandler(event, phase);
        }
      }
      /**
       * Event handler for a touch end event.
       * Calculate the direction and trigger events
       * @inner
       * @param {object} jqEvent The normalised jQuery event object.
       */
  
  
      function touchEnd(jqEvent) {
        //As we use Jquery bind for events, we need to target the original event object
        //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.
        var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent,
            touches = event.touches; //If we are still in a touch with the device wait a fraction and see if the other finger comes up
        //if it does within the threshold, then we treat it as a multi release, not a single release and end the touch / swipe
  
        if (touches) {
          if (touches.length && !inMultiFingerRelease()) {
            startMultiFingerRelease(event);
            return true;
          } else if (touches.length && inMultiFingerRelease()) {
            return true;
          }
        } //If a previous finger has been released, check how long ago, if within the threshold, then assume it was a multifinger release.
        //This is used to allow 2 fingers to release fractionally after each other, whilst maintaining the event as containing 2 fingers, not 1
  
  
        if (inMultiFingerRelease()) {
          fingerCount = fingerCountAtRelease;
        } //Set end of swipe
  
  
        endTime = getTimeStamp(); //Get duration incase move was never fired
  
        duration = calculateDuration(); //If we trigger handlers at end of swipe OR, we trigger during, but they didnt trigger and we are still in the move phase
  
        if (didSwipeBackToCancel() || !validateSwipeDistance()) {
          phase = PHASE_CANCEL;
          triggerHandler(event, phase);
        } else if (options.triggerOnTouchEnd || options.triggerOnTouchEnd === false && phase === PHASE_MOVE) {
          //call this on jq event so we are cross browser
          if (options.preventDefaultEvents !== false) {
            jqEvent.preventDefault();
          }
  
          phase = PHASE_END;
          triggerHandler(event, phase);
        } //Special cases - A tap should always fire on touch end regardless,
        //So here we manually trigger the tap end handler by itself
        //We dont run trigger handler as it will re-trigger events that may have fired already
        else if (!options.triggerOnTouchEnd && hasTap()) {
            //Trigger the pinch events...
            phase = PHASE_END;
            triggerHandlerForGesture(event, phase, TAP);
          } else if (phase === PHASE_MOVE) {
            phase = PHASE_CANCEL;
            triggerHandler(event, phase);
          }
  
        setTouchInProgress(false);
        return null;
      }
      /**
       * Event handler for a touch cancel event.
       * Clears current vars
       * @inner
       */
  
  
      function touchCancel() {
        // reset the variables back to default values
        fingerCount = 0;
        endTime = 0;
        startTime = 0;
        startTouchesDistance = 0;
        endTouchesDistance = 0;
        pinchZoom = 1; //If we were in progress of tracking a possible multi touch end, then re set it.
  
        cancelMultiFingerRelease();
        setTouchInProgress(false);
      }
      /**
       * Event handler for a touch leave event.
       * This is only triggered on desktops, in touch we work this out manually
       * as the touchleave event is not supported in webkit
       * @inner
       */
  
  
      function touchLeave(jqEvent) {
        //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.
        var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent; //If we have the trigger on leave property set....
  
        if (options.triggerOnTouchLeave) {
          phase = getNextPhase(PHASE_END);
          triggerHandler(event, phase);
        }
      }
      /**
       * Removes all listeners that were associated with the plugin
       * @inner
       */
  
  
      function removeListeners() {
        $element.unbind(START_EV, touchStart);
        $element.unbind(CANCEL_EV, touchCancel);
        $element.unbind(MOVE_EV, touchMove);
        $element.unbind(END_EV, touchEnd); //we only have leave events on desktop, we manually calculate leave on touch as its not supported in webkit
  
        if (LEAVE_EV) {
          $element.unbind(LEAVE_EV, touchLeave);
        }
  
        setTouchInProgress(false);
      }
      /**
       * Checks if the time and distance thresholds have been met, and if so then the appropriate handlers are fired.
       */
  
  
      function getNextPhase(currentPhase) {
        var nextPhase = currentPhase; // Ensure we have valid swipe (under time and over distance  and check if we are out of bound...)
  
        var validTime = validateSwipeTime();
        var validDistance = validateSwipeDistance();
        var didCancel = didSwipeBackToCancel(); //If we have exceeded our time, then cancel
  
        if (!validTime || didCancel) {
          nextPhase = PHASE_CANCEL;
        } //Else if we are moving, and have reached distance then end
        else if (validDistance && currentPhase == PHASE_MOVE && (!options.triggerOnTouchEnd || options.triggerOnTouchLeave)) {
            nextPhase = PHASE_END;
          } //Else if we have ended by leaving and didn't reach distance, then cancel
          else if (!validDistance && currentPhase == PHASE_END && options.triggerOnTouchLeave) {
              nextPhase = PHASE_CANCEL;
            }
  
        return nextPhase;
      }
      /**
       * Trigger the relevant event handler
       * The handlers are passed the original event, the element that was swiped, and in the case of the catch all handler, the direction that was swiped, "left", "right", "up", or "down"
       * @param {object} event the original event object
       * @param {string} phase the phase of the swipe (start, end cancel etc) {@link $.fn.swipe.phases}
       * @inner
       */
  
  
      function triggerHandler(event, phase) {
        var ret,
            touches = event.touches; // SWIPE GESTURES
  
        if (didSwipe() || hasSwipes()) {
          ret = triggerHandlerForGesture(event, phase, SWIPE);
        } // PINCH GESTURES (if the above didn't cancel)
  
  
        if ((didPinch() || hasPinches()) && ret !== false) {
          ret = triggerHandlerForGesture(event, phase, PINCH);
        } // CLICK / TAP (if the above didn't cancel)
  
  
        if (didDoubleTap() && ret !== false) {
          //Trigger the tap events...
          ret = triggerHandlerForGesture(event, phase, DOUBLE_TAP);
        } // CLICK / TAP (if the above didn't cancel)
        else if (didLongTap() && ret !== false) {
            //Trigger the tap events...
            ret = triggerHandlerForGesture(event, phase, LONG_TAP);
          } // CLICK / TAP (if the above didn't cancel)
          else if (didTap() && ret !== false) {
              //Trigger the tap event..
              ret = triggerHandlerForGesture(event, phase, TAP);
            } // If we are cancelling the gesture, then manually trigger the reset handler
  
  
        if (phase === PHASE_CANCEL) {
          touchCancel(event);
        } // If we are ending the gesture, then manually trigger the reset handler IF all fingers are off
  
  
        if (phase === PHASE_END) {
          //If we support touch, then check that all fingers are off before we cancel
          if (touches) {
            if (!touches.length) {
              touchCancel(event);
            }
          } else {
            touchCancel(event);
          }
        }
  
        return ret;
      }
      /**
       * Trigger the relevant event handler
       * The handlers are passed the original event, the element that was swiped, and in the case of the catch all handler, the direction that was swiped, "left", "right", "up", or "down"
       * @param {object} event the original event object
       * @param {string} phase the phase of the swipe (start, end cancel etc) {@link $.fn.swipe.phases}
       * @param {string} gesture the gesture to trigger a handler for : PINCH or SWIPE {@link $.fn.swipe.gestures}
       * @return Boolean False, to indicate that the event should stop propagation, or void.
       * @inner
       */
  
  
      function triggerHandlerForGesture(event, phase, gesture) {
        var ret; //SWIPES....
  
        if (gesture == SWIPE) {
          //Trigger status every time..
          $element.trigger('swipeStatus', [phase, direction || null, distance || 0, duration || 0, fingerCount, fingerData, currentDirection]);
  
          if (options.swipeStatus) {
            ret = options.swipeStatus.call($element, event, phase, direction || null, distance || 0, duration || 0, fingerCount, fingerData, currentDirection); //If the status cancels, then dont run the subsequent event handlers..
  
            if (ret === false) return false;
          }
  
          if (phase == PHASE_END && validateSwipe()) {
            //Cancel any taps that were in progress...
            clearTimeout(singleTapTimeout);
            clearTimeout(holdTimeout);
            $element.trigger('swipe', [direction, distance, duration, fingerCount, fingerData, currentDirection]);
  
            if (options.swipe) {
              ret = options.swipe.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection); //If the status cancels, then dont run the subsequent event handlers..
  
              if (ret === false) return false;
            } //trigger direction specific event handlers
  
  
            switch (direction) {
              case LEFT:
                $element.trigger('swipeLeft', [direction, distance, duration, fingerCount, fingerData, currentDirection]);
  
                if (options.swipeLeft) {
                  ret = options.swipeLeft.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);
                }
  
                break;
  
              case RIGHT:
                $element.trigger('swipeRight', [direction, distance, duration, fingerCount, fingerData, currentDirection]);
  
                if (options.swipeRight) {
                  ret = options.swipeRight.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);
                }
  
                break;
  
              case UP:
                $element.trigger('swipeUp', [direction, distance, duration, fingerCount, fingerData, currentDirection]);
  
                if (options.swipeUp) {
                  ret = options.swipeUp.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);
                }
  
                break;
  
              case DOWN:
                $element.trigger('swipeDown', [direction, distance, duration, fingerCount, fingerData, currentDirection]);
  
                if (options.swipeDown) {
                  ret = options.swipeDown.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);
                }
  
                break;
            }
          }
        } //PINCHES....
  
  
        if (gesture == PINCH) {
          $element.trigger('pinchStatus', [phase, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);
  
          if (options.pinchStatus) {
            ret = options.pinchStatus.call($element, event, phase, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData); //If the status cancels, then dont run the subsequent event handlers..
  
            if (ret === false) return false;
          }
  
          if (phase == PHASE_END && validatePinch()) {
            switch (pinchDirection) {
              case IN:
                $element.trigger('pinchIn', [pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);
  
                if (options.pinchIn) {
                  ret = options.pinchIn.call($element, event, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData);
                }
  
                break;
  
              case OUT:
                $element.trigger('pinchOut', [pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);
  
                if (options.pinchOut) {
                  ret = options.pinchOut.call($element, event, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData);
                }
  
                break;
            }
          }
        }
  
        if (gesture == TAP) {
          if (phase === PHASE_CANCEL || phase === PHASE_END) {
            clearTimeout(singleTapTimeout);
            clearTimeout(holdTimeout); //If we are also looking for doubelTaps, wait incase this is one...
  
            if (hasDoubleTap() && !inDoubleTap()) {
              doubleTapStartTime = getTimeStamp(); //Now wait for the double tap timeout, and trigger this single tap
              //if its not cancelled by a double tap
  
              singleTapTimeout = setTimeout($.proxy(function () {
                doubleTapStartTime = null;
                $element.trigger('tap', [event.target]);
  
                if (options.tap) {
                  ret = options.tap.call($element, event, event.target);
                }
              }, this), options.doubleTapThreshold);
            } else {
              doubleTapStartTime = null;
              $element.trigger('tap', [event.target]);
  
              if (options.tap) {
                ret = options.tap.call($element, event, event.target);
              }
            }
          }
        } else if (gesture == DOUBLE_TAP) {
          if (phase === PHASE_CANCEL || phase === PHASE_END) {
            clearTimeout(singleTapTimeout);
            clearTimeout(holdTimeout);
            doubleTapStartTime = null;
            $element.trigger('doubletap', [event.target]);
  
            if (options.doubleTap) {
              ret = options.doubleTap.call($element, event, event.target);
            }
          }
        } else if (gesture == LONG_TAP) {
          if (phase === PHASE_CANCEL || phase === PHASE_END) {
            clearTimeout(singleTapTimeout);
            doubleTapStartTime = null;
            $element.trigger('longtap', [event.target]);
  
            if (options.longTap) {
              ret = options.longTap.call($element, event, event.target);
            }
          }
        }
  
        return ret;
      } //
      // GESTURE VALIDATION
      //
  
      /**
       * Checks the user has swipe far enough
       * @return Boolean if <code>threshold</code> has been set, return true if the threshold was met, else false.
       * If no threshold was set, then we return true.
       * @inner
       */
  
  
      function validateSwipeDistance() {
        var valid = true; //If we made it past the min swipe distance..
  
        if (options.threshold !== null) {
          valid = distance >= options.threshold;
        }
  
        return valid;
      }
      /**
       * Checks the user has swiped back to cancel.
       * @return Boolean if <code>cancelThreshold</code> has been set, return true if the cancelThreshold was met, else false.
       * If no cancelThreshold was set, then we return true.
       * @inner
       */
  
  
      function didSwipeBackToCancel() {
        var cancelled = false;
  
        if (options.cancelThreshold !== null && direction !== null) {
          cancelled = getMaxDistance(direction) - distance >= options.cancelThreshold;
        }
  
        return cancelled;
      }
      /**
       * Checks the user has pinched far enough
       * @return Boolean if <code>pinchThreshold</code> has been set, return true if the threshold was met, else false.
       * If no threshold was set, then we return true.
       * @inner
       */
  
  
      function validatePinchDistance() {
        if (options.pinchThreshold !== null) {
          return pinchDistance >= options.pinchThreshold;
        }
  
        return true;
      }
      /**
       * Checks that the time taken to swipe meets the minimum / maximum requirements
       * @return Boolean
       * @inner
       */
  
  
      function validateSwipeTime() {
        var result; //If no time set, then return true
  
        if (options.maxTimeThreshold) {
          if (duration >= options.maxTimeThreshold) {
            result = false;
          } else {
            result = true;
          }
        } else {
          result = true;
        }
  
        return result;
      }
      /**
       * Checks direction of the swipe and the value allowPageScroll to see if we should allow or prevent the default behaviour from occurring.
       * This will essentially allow page scrolling or not when the user is swiping on a touchSwipe object.
       * @param {object} jqEvent The normalised jQuery representation of the event object.
       * @param {string} direction The direction of the event. See {@link $.fn.swipe.directions}
       * @see $.fn.swipe.directions
       * @inner
       */
  
  
      function validateDefaultEvent(jqEvent, direction) {
        //If the option is set, allways allow the event to bubble up (let user handle weirdness)
        if (options.preventDefaultEvents === false) {
          return;
        }
  
        if (options.allowPageScroll === NONE) {
          jqEvent.preventDefault();
        } else {
          var auto = options.allowPageScroll === AUTO;
  
          switch (direction) {
            case LEFT:
              if (options.swipeLeft && auto || !auto && options.allowPageScroll != HORIZONTAL) {
                jqEvent.preventDefault();
              }
  
              break;
  
            case RIGHT:
              if (options.swipeRight && auto || !auto && options.allowPageScroll != HORIZONTAL) {
                jqEvent.preventDefault();
              }
  
              break;
  
            case UP:
              if (options.swipeUp && auto || !auto && options.allowPageScroll != VERTICAL) {
                jqEvent.preventDefault();
              }
  
              break;
  
            case DOWN:
              if (options.swipeDown && auto || !auto && options.allowPageScroll != VERTICAL) {
                jqEvent.preventDefault();
              }
  
              break;
  
            case NONE:
              break;
          }
        }
      } // PINCHES
  
      /**
       * Returns true of the current pinch meets the thresholds
       * @return Boolean
       * @inner
       */
  
  
      function validatePinch() {
        var hasCorrectFingerCount = validateFingers();
        var hasEndPoint = validateEndPoint();
        var hasCorrectDistance = validatePinchDistance();
        return hasCorrectFingerCount && hasEndPoint && hasCorrectDistance;
      }
      /**
       * Returns true if any Pinch events have been registered
       * @return Boolean
       * @inner
       */
  
  
      function hasPinches() {
        //Enure we dont return 0 or null for false values
        return !!(options.pinchStatus || options.pinchIn || options.pinchOut);
      }
      /**
       * Returns true if we are detecting pinches, and have one
       * @return Boolean
       * @inner
       */
  
  
      function didPinch() {
        //Enure we dont return 0 or null for false values
        return !!(validatePinch() && hasPinches());
      } // SWIPES
  
      /**
       * Returns true if the current swipe meets the thresholds
       * @return Boolean
       * @inner
       */
  
  
      function validateSwipe() {
        //Check validity of swipe
        var hasValidTime = validateSwipeTime();
        var hasValidDistance = validateSwipeDistance();
        var hasCorrectFingerCount = validateFingers();
        var hasEndPoint = validateEndPoint();
        var didCancel = didSwipeBackToCancel(); // if the user swiped more than the minimum length, perform the appropriate action
        // hasValidDistance is null when no distance is set
  
        var valid = !didCancel && hasEndPoint && hasCorrectFingerCount && hasValidDistance && hasValidTime;
        return valid;
      }
      /**
       * Returns true if any Swipe events have been registered
       * @return Boolean
       * @inner
       */
  
  
      function hasSwipes() {
        //Enure we dont return 0 or null for false values
        return !!(options.swipe || options.swipeStatus || options.swipeLeft || options.swipeRight || options.swipeUp || options.swipeDown);
      }
      /**
       * Returns true if we are detecting swipes and have one
       * @return Boolean
       * @inner
       */
  
  
      function didSwipe() {
        //Enure we dont return 0 or null for false values
        return !!(validateSwipe() && hasSwipes());
      }
      /**
       * Returns true if we have matched the number of fingers we are looking for
       * @return Boolean
       * @inner
       */
  
  
      function validateFingers() {
        //The number of fingers we want were matched, or on desktop we ignore
        return fingerCount === options.fingers || options.fingers === ALL_FINGERS || !SUPPORTS_TOUCH;
      }
      /**
       * Returns true if we have an end point for the swipe
       * @return Boolean
       * @inner
       */
  
  
      function validateEndPoint() {
        //We have an end value for the finger
        return fingerData[0].end.x !== 0;
      } // TAP / CLICK
  
      /**
       * Returns true if a click / tap events have been registered
       * @return Boolean
       * @inner
       */
  
  
      function hasTap() {
        //Enure we dont return 0 or null for false values
        return !!options.tap;
      }
      /**
       * Returns true if a double tap events have been registered
       * @return Boolean
       * @inner
       */
  
  
      function hasDoubleTap() {
        //Enure we dont return 0 or null for false values
        return !!options.doubleTap;
      }
      /**
       * Returns true if any long tap events have been registered
       * @return Boolean
       * @inner
       */
  
  
      function hasLongTap() {
        //Enure we dont return 0 or null for false values
        return !!options.longTap;
      }
      /**
       * Returns true if we could be in the process of a double tap (one tap has occurred, we are listening for double taps, and the threshold hasn't past.
       * @return Boolean
       * @inner
       */
  
  
      function validateDoubleTap() {
        if (doubleTapStartTime == null) {
          return false;
        }
  
        var now = getTimeStamp();
        return hasDoubleTap() && now - doubleTapStartTime <= options.doubleTapThreshold;
      }
      /**
       * Returns true if we could be in the process of a double tap (one tap has occurred, we are listening for double taps, and the threshold hasn't past.
       * @return Boolean
       * @inner
       */
  
  
      function inDoubleTap() {
        return validateDoubleTap();
      }
      /**
       * Returns true if we have a valid tap
       * @return Boolean
       * @inner
       */
  
  
      function validateTap() {
        return (fingerCount === 1 || !SUPPORTS_TOUCH) && (isNaN(distance) || distance < options.threshold);
      }
      /**
       * Returns true if we have a valid long tap
       * @return Boolean
       * @inner
       */
  
  
      function validateLongTap() {
        //slight threshold on moving finger
        return duration > options.longTapThreshold && distance < DOUBLE_TAP_THRESHOLD;
      }
      /**
       * Returns true if we are detecting taps and have one
       * @return Boolean
       * @inner
       */
  
  
      function didTap() {
        //Enure we dont return 0 or null for false values
        return !!(validateTap() && hasTap());
      }
      /**
       * Returns true if we are detecting double taps and have one
       * @return Boolean
       * @inner
       */
  
  
      function didDoubleTap() {
        //Enure we dont return 0 or null for false values
        return !!(validateDoubleTap() && hasDoubleTap());
      }
      /**
       * Returns true if we are detecting long taps and have one
       * @return Boolean
       * @inner
       */
  
  
      function didLongTap() {
        //Enure we dont return 0 or null for false values
        return !!(validateLongTap() && hasLongTap());
      } // MULTI FINGER TOUCH
  
      /**
       * Starts tracking the time between 2 finger releases, and keeps track of how many fingers we initially had up
       * @inner
       */
  
  
      function startMultiFingerRelease(event) {
        previousTouchEndTime = getTimeStamp();
        fingerCountAtRelease = event.touches.length + 1;
      }
      /**
       * Cancels the tracking of time between 2 finger releases, and resets counters
       * @inner
       */
  
  
      function cancelMultiFingerRelease() {
        previousTouchEndTime = 0;
        fingerCountAtRelease = 0;
      }
      /**
       * Checks if we are in the threshold between 2 fingers being released
       * @return Boolean
       * @inner
       */
  
  
      function inMultiFingerRelease() {
        var withinThreshold = false;
  
        if (previousTouchEndTime) {
          var diff = getTimeStamp() - previousTouchEndTime;
  
          if (diff <= options.fingerReleaseThreshold) {
            withinThreshold = true;
          }
        }
  
        return withinThreshold;
      }
      /**
       * gets a data flag to indicate that a touch is in progress
       * @return Boolean
       * @inner
       */
  
  
      function getTouchInProgress() {
        //strict equality to ensure only true and false are returned
        return !!($element.data(PLUGIN_NS + '_intouch') === true);
      }
      /**
       * Sets a data flag to indicate that a touch is in progress
       * @param {boolean} val The value to set the property to
       * @inner
       */
  
  
      function setTouchInProgress(val) {
        //If destroy is called in an event handler, we have no el, and we have already cleaned up, so return.
        if (!$element) {
          return;
        } //Add or remove event listeners depending on touch status
  
  
        if (val === true) {
          $element.bind(MOVE_EV, touchMove);
          $element.bind(END_EV, touchEnd); //we only have leave events on desktop, we manually calcuate leave on touch as its not supported in webkit
  
          if (LEAVE_EV) {
            $element.bind(LEAVE_EV, touchLeave);
          }
        } else {
          $element.unbind(MOVE_EV, touchMove, false);
          $element.unbind(END_EV, touchEnd, false); //we only have leave events on desktop, we manually calcuate leave on touch as its not supported in webkit
  
          if (LEAVE_EV) {
            $element.unbind(LEAVE_EV, touchLeave, false);
          }
        } //strict equality to ensure only true and false can update the value
  
  
        $element.data(PLUGIN_NS + '_intouch', val === true);
      }
      /**
       * Creates the finger data for the touch/finger in the event object.
       * @param {int} id The id to store the finger data under (usually the order the fingers were pressed)
       * @param {object} evt The event object containing finger data
       * @return finger data object
       * @inner
       */
  
  
      function createFingerData(id, evt) {
        var f = {
          start: {
            x: 0,
            y: 0
          },
          last: {
            x: 0,
            y: 0
          },
          end: {
            x: 0,
            y: 0
          }
        };
        f.start.x = f.last.x = f.end.x = evt.pageX || evt.clientX;
        f.start.y = f.last.y = f.end.y = evt.pageY || evt.clientY;
        fingerData[id] = f;
        return f;
      }
      /**
       * Updates the finger data for a particular event object
       * @param {object} evt The event object containing the touch/finger data to upadte
       * @return a finger data object.
       * @inner
       */
  
  
      function updateFingerData(evt) {
        var id = evt.identifier !== undefined ? evt.identifier : 0;
        var f = getFingerData(id);
  
        if (f === null) {
          f = createFingerData(id, evt);
        }
  
        f.last.x = f.end.x;
        f.last.y = f.end.y;
        f.end.x = evt.pageX || evt.clientX;
        f.end.y = evt.pageY || evt.clientY;
        return f;
      }
      /**
       * Returns a finger data object by its event ID.
       * Each touch event has an identifier property, which is used
       * to track repeat touches
       * @param {int} id The unique id of the finger in the sequence of touch events.
       * @return a finger data object.
       * @inner
       */
  
  
      function getFingerData(id) {
        return fingerData[id] || null;
      }
      /**
       * Sets the maximum distance swiped in the given direction.
       * If the new value is lower than the current value, the max value is not changed.
       * @param {string}  direction The direction of the swipe
       * @param {int}  distance The distance of the swipe
       * @inner
       */
  
  
      function setMaxDistance(direction, distance) {
        if (direction == NONE) return;
        distance = Math.max(distance, getMaxDistance(direction));
        maximumsMap[direction].distance = distance;
      }
      /**
       * gets the maximum distance swiped in the given direction.
       * @param {string}  direction The direction of the swipe
       * @return int  The distance of the swipe
       * @inner
       */
  
  
      function getMaxDistance(direction) {
        if (maximumsMap[direction]) return maximumsMap[direction].distance;
        return undefined;
      }
      /**
       * Creats a map of directions to maximum swiped values.
       * @return Object A dictionary of maximum values, indexed by direction.
       * @inner
       */
  
  
      function createMaximumsData() {
        var maxData = {};
        maxData[LEFT] = createMaximumVO(LEFT);
        maxData[RIGHT] = createMaximumVO(RIGHT);
        maxData[UP] = createMaximumVO(UP);
        maxData[DOWN] = createMaximumVO(DOWN);
        return maxData;
      }
      /**
       * Creates a map maximum swiped values for a given swipe direction
       * @param {string} The direction that these values will be associated with
       * @return Object Maximum values
       * @inner
       */
  
  
      function createMaximumVO(dir) {
        return {
          direction: dir,
          distance: 0
        };
      } //
      // MATHS / UTILS
      //
  
      /**
       * Calculate the duration of the swipe
       * @return int
       * @inner
       */
  
  
      function calculateDuration() {
        return endTime - startTime;
      }
      /**
       * Calculate the distance between 2 touches (pinch)
       * @param {point} startPoint A point object containing x and y co-ordinates
       * @param {point} endPoint A point object containing x and y co-ordinates
       * @return int;
       * @inner
       */
  
  
      function calculateTouchesDistance(startPoint, endPoint) {
        var diffX = Math.abs(startPoint.x - endPoint.x);
        var diffY = Math.abs(startPoint.y - endPoint.y);
        return Math.round(Math.sqrt(diffX * diffX + diffY * diffY));
      }
      /**
       * Calculate the zoom factor between the start and end distances
       * @param {int} startDistance Distance (between 2 fingers) the user started pinching at
       * @param {int} endDistance Distance (between 2 fingers) the user ended pinching at
       * @return float The zoom value from 0 to 1.
       * @inner
       */
  
  
      function calculatePinchZoom(startDistance, endDistance) {
        var percent = endDistance / startDistance * 1;
        return percent.toFixed(2);
      }
      /**
       * Returns the pinch direction, either IN or OUT for the given points
       * @return string Either {@link $.fn.swipe.directions.IN} or {@link $.fn.swipe.directions.OUT}
       * @see $.fn.swipe.directions
       * @inner
       */
  
  
      function calculatePinchDirection() {
        if (pinchZoom < 1) {
          return OUT;
        } else {
          return IN;
        }
      }
      /**
       * Calculate the length / distance of the swipe
       * @param {point} startPoint A point object containing x and y co-ordinates
       * @param {point} endPoint A point object containing x and y co-ordinates
       * @return int
       * @inner
       */
  
  
      function calculateDistance(startPoint, endPoint) {
        return Math.round(Math.sqrt(Math.pow(endPoint.x - startPoint.x, 2) + Math.pow(endPoint.y - startPoint.y, 2)));
      }
      /**
       * Calculate the angle of the swipe
       * @param {point} startPoint A point object containing x and y co-ordinates
       * @param {point} endPoint A point object containing x and y co-ordinates
       * @return int
       * @inner
       */
  
  
      function calculateAngle(startPoint, endPoint) {
        var x = startPoint.x - endPoint.x;
        var y = endPoint.y - startPoint.y;
        var r = Math.atan2(y, x); //radians
  
        var angle = Math.round(r * 180 / Math.PI); //degrees
        //ensure value is positive
  
        if (angle < 0) {
          angle = 360 - Math.abs(angle);
        }
  
        return angle;
      }
      /**
       * Calculate the direction of the swipe
       * This will also call calculateAngle to get the latest angle of swipe
       * @param {point} startPoint A point object containing x and y co-ordinates
       * @param {point} endPoint A point object containing x and y co-ordinates
       * @return string Either {@link $.fn.swipe.directions.LEFT} / {@link $.fn.swipe.directions.RIGHT} / {@link $.fn.swipe.directions.DOWN} / {@link $.fn.swipe.directions.UP}
       * @see $.fn.swipe.directions
       * @inner
       */
  
  
      function calculateDirection(startPoint, endPoint) {
        if (comparePoints(startPoint, endPoint)) {
          return NONE;
        }
  
        var angle = calculateAngle(startPoint, endPoint);
  
        if (angle <= 45 && angle >= 0) {
          return LEFT;
        } else if (angle <= 360 && angle >= 315) {
          return LEFT;
        } else if (angle >= 135 && angle <= 225) {
          return RIGHT;
        } else if (angle > 45 && angle < 135) {
          return DOWN;
        } else {
          return UP;
        }
      }
      /**
       * Returns a MS time stamp of the current time
       * @return int
       * @inner
       */
  
  
      function getTimeStamp() {
        var now = new Date();
        return now.getTime();
      }
      /**
       * Returns a bounds object with left, right, top and bottom properties for the element specified.
       * @param {DomNode} The DOM node to get the bounds for.
       */
  
  
      function getbounds(el) {
        el = $(el);
        var offset = el.offset();
        var bounds = {
          left: offset.left,
          right: offset.left + el.outerWidth(),
          top: offset.top,
          bottom: offset.top + el.outerHeight()
        };
        return bounds;
      }
      /**
       * Checks if the point object is in the bounds object.
       * @param {object} point A point object.
       * @param {int} point.x The x value of the point.
       * @param {int} point.y The x value of the point.
       * @param {object} bounds The bounds object to test
       * @param {int} bounds.left The leftmost value
       * @param {int} bounds.right The righttmost value
       * @param {int} bounds.top The topmost value
       * @param {int} bounds.bottom The bottommost value
       */
  
  
      function isInBounds(point, bounds) {
        return point.x > bounds.left && point.x < bounds.right && point.y > bounds.top && point.y < bounds.bottom;
      }
  
      ;
      /**
       * Checks if the two points are equal
       * @param {object} point A point object.
       * @param {object} point B point object.
       * @return true of the points match
       */
  
      function comparePoints(pointA, pointB) {
        return pointA.x == pointB.x && pointA.y == pointB.y;
      }
    }
    /**
     * A catch all handler that is triggered for all swipe directions.
     * @name $.fn.swipe#swipe
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler that is triggered for "left" swipes.
     * @name $.fn.swipe#swipeLeft
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler that is triggered for "right" swipes.
     * @name $.fn.swipe#swipeRight
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler that is triggered for "up" swipes.
     * @name $.fn.swipe#swipeUp
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler that is triggered for "down" swipes.
     * @name $.fn.swipe#swipeDown
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler triggered for every phase of the swipe. This handler is constantly fired for the duration of the pinch.
     * This is triggered regardless of swipe thresholds.
     * @name $.fn.swipe#swipeStatus
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {string} phase The phase of the swipe event. See {@link $.fn.swipe.phases}
     * @param {string} direction The direction the user swiped in. This is null if the user has yet to move. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user swiped. This is 0 if the user has yet to move.
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {object} fingerData The coordinates of fingers in event
     * @param {string} currentDirection The current direction the user is swiping.
     */
  
    /**
     * A handler triggered for pinch in events.
     * @name $.fn.swipe#pinchIn
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user pinched
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {int} zoom The zoom/scale level the user pinched too, 0-1.
     * @param {object} fingerData The coordinates of fingers in event
     */
  
    /**
     * A handler triggered for pinch out events.
     * @name $.fn.swipe#pinchOut
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user pinched
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {int} zoom The zoom/scale level the user pinched too, 0-1.
     * @param {object} fingerData The coordinates of fingers in event
     */
  
    /**
     * A handler triggered for all pinch events. This handler is constantly fired for the duration of the pinch. This is triggered regardless of thresholds.
     * @name $.fn.swipe#pinchStatus
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}
     * @param {int} distance The distance the user pinched
     * @param {int} duration The duration of the swipe in milliseconds
     * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}
     * @param {int} zoom The zoom/scale level the user pinched too, 0-1.
     * @param {object} fingerData The coordinates of fingers in event
     */
  
    /**
     * A click handler triggered when a user simply clicks, rather than swipes on an element.
     * This is deprecated since version 1.6.2, any assignment to click will be assigned to the tap handler.
     * You cannot use <code>on</code> to bind to this event as the default jQ <code>click</code> event will be triggered.
     * Use the <code>tap</code> event instead.
     * @name $.fn.swipe#click
     * @event
     * @deprecated since version 1.6.2, please use {@link $.fn.swipe#tap} instead
     * @default null
     * @param {EventObject} event The original event object
     * @param {DomObject} target The element clicked on.
     */
  
    /**
     * A click / tap handler triggered when a user simply clicks or taps, rather than swipes on an element.
     * @name $.fn.swipe#tap
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {DomObject} target The element clicked on.
     */
  
    /**
     * A double tap handler triggered when a user double clicks or taps on an element.
     * You can set the time delay for a double tap with the {@link $.fn.swipe.defaults#doubleTapThreshold} property.
     * Note: If you set both <code>doubleTap</code> and <code>tap</code> handlers, the <code>tap</code> event will be delayed by the <code>doubleTapThreshold</code>
     * as the script needs to check if its a double tap.
     * @name $.fn.swipe#doubleTap
     * @see  $.fn.swipe.defaults#doubleTapThreshold
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {DomObject} target The element clicked on.
     */
  
    /**
     * A long tap handler triggered once a tap has been release if the tap was longer than the longTapThreshold.
     * You can set the time delay for a long tap with the {@link $.fn.swipe.defaults#longTapThreshold} property.
     * @name $.fn.swipe#longTap
     * @see  $.fn.swipe.defaults#longTapThreshold
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {DomObject} target The element clicked on.
     */
  
    /**
     * A hold tap handler triggered as soon as the longTapThreshold is reached
     * You can set the time delay for a long tap with the {@link $.fn.swipe.defaults#longTapThreshold} property.
     * @name $.fn.swipe#hold
     * @see  $.fn.swipe.defaults#longTapThreshold
     * @event
     * @default null
     * @param {EventObject} event The original event object
     * @param {DomObject} target The element clicked on.
     */
  
  });
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/transplant/js/transplant.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/transplant/js/transplant.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window);
    var transplant = {
      $element: null,
      $target: null,
      $order: null,
      $cloneData: null,
      $clonedContainer: null,
      init: function init() {
        var transArray = $('[data-toggle="transplant"]');
        transArray.each(function (index) {
          var $this = $(this);
          transplant.$element = $this.data('transplant');
          transplant.$target = $($this.data('target'));
          transplant.$direction = $($this.data('direction'));
          transplant.$order = $this.data('transplant-order');
          transplant.$remove = $this.data('remove');
          transplant.$targetClass = $this.data('target-class');
          transplant.$classNames = $this.data('class-names');
  
          if (transplant.$direction === "to" || typeof transplant.$direction === 'undefined') {
            if (transplant.$element === 'self') {
              transplant.$element = $this;
            } else {
              transplant.$element = $this.find(transplant.$element);
            }
  
            transplant.$cloneData = transplant.$element.clone(true, true).removeAttr('data-toggle').attr('data-transplant-order', transplant.$order);
            transplant.clone();
  
            if (transplant.$targetClass) {
              transplant.$target.find('.transplanted-clone').addClass(transplant.$targetClass);
            }
  
            if (transplant.$classNames) {
              transplant.$element.addClass(transplant.$classNames);
            }
  
            if (transplant.$remove === true) {
              transplant.remove();
            }
          } else {
            transplant.$target = $this;
            var array = $this.data('target').split(",");
            $.each(array, function (index, item) {
              // go through selectors
              transplant.$element = $(item);
              transplant.$cloneData = transplant.$element.clone(true, true).attr('data-transplant-order', transplant.$order);
              transplant.clone();
  
              if (transplant.$targetClass) {
                transplant.$element.addClass(transplant.$targetClass);
              }
  
              if (transplant.$classNames) {
                transplant.$target.find(".transplanted-clone").addClass(transplant.$classNames);
              }
  
              if (transplant.$remove === true) {
                transplant.remove();
              }
            });
          }
        });
        transplant.order();
      },
      clone: function clone() {
        if (transplant.$element.hasClass('cloned')) return;
  
        if (transplant.$target.find('.transplanted-clone').length <= 0) {
          if (transplant.$target.is('ul')) {
            transplant.$target.append('<li class="transplanted-clone"></li>');
          } else {
            transplant.$target.append('<div class="transplanted-clone"></div>');
          }
  
          transplant.$clonedContainer = transplant.$target.find('.transplanted-clone');
  
          if (transplant.$cloneData.is('li')) {
            transplant.$clonedContainer.append('<ul class="transplanted-clone__ul"></ul>');
            transplant.$clonedContainer = transplant.$target.find('.transplanted-clone__ul').addClass(transplant.$classNames);
          }
        }
  
        transplant.$clonedContainer.append(transplant.$cloneData);
        transplant.$element.addClass('cloned');
      },
      order: function order() {
        var clonedItems = transplant.$clonedContainer.children();
        clonedItems.sort(function (a, b) {
          return $(a).data("transplant-order") - $(b).data("transplant-order");
        });
        transplant.$clonedContainer.html(clonedItems);
      },
      remove: function remove() {
        if (transplant.$target) {
          transplant.$element.remove();
        } else {
          transplant.$source.remove();
        }
      }
    };
    UX.transplant = transplant; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/truncate/js/init.js":
  /*!*********************************************************!*\
    !*** /home/irahhal/ui-core/plugins/truncate/js/init.js ***!
    \*********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    $(document).ready(function () {
      $('.creative-work__title').not("[data-truncate='none']").truncate({
        lines: 3,
        addClass: 'min-height'
      });
      $('.creative-work .loa').not("[data-truncate='none']").truncate({
        lines: 2,
        type: 'list',
        addClass: 'loa-height'
      });
      $('.featured .grid-item:first-child .creative-work__title').not("[data-truncate='none']").truncate({
        lines: 2,
        addClass: 'min-height'
      });
      $('.card .creative-work__title').not("[data-truncate='none']").truncate({
        lines: 2,
        addClass: 'min-height'
      });
      $('.card .creative-work .loa').not("[data-truncate='none']").truncate({
        lines: 1,
        type: 'list',
        addClass: 'loa-height'
      });
    });
    $(window).on('resized orientationchange', function () {
      $('.creative-work__title, .creative-work .loa').not("[data-truncate='none']").truncate();
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/plugins/truncate/js/truncate.js":
  /*!*************************************************************!*\
    !*** /home/irahhal/ui-core/plugins/truncate/js/truncate.js ***!
    \*************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  (function ($) {
    var methods;
  
    function truncateText() {
      var that = this;
      var $this = $(this);
      var height = $this.height();
      var maxHeight = this.settings.lines * parseFloat($this.css('line-height'));
      var visible = !$this.closest(':not(:visible)').length;
  
      if (visible && height === 0) {
        setTimeout(function () {
          truncateText.call(that);
        }, 30);
        return;
      }
  
      if (height > maxHeight) {
        removeElements.call(this, $this);
      } else {
        setTimeout(function () {
          $this.addClass(that.settings.addClass);
        }, 0);
        $this.data('truncationDone', true);
        that.settings.onComplete();
      }
    }
  
    function removeElements(containerEl) {
      var that = this;
      var $this = $(this);
      var height = $this.height();
      var maxHeight = this.settings.lines * Math.ceil(parseFloat($this.css('line-height')));
      var $lastRemoved;
      var $parent;
      var $seeMore;
  
      if (this.settings.seeMoreLink) {
        $seeMore = seeMoreLink.call(this);
      } else {
        $seeMore = ellipsis.call(this);
      }
  
      if (containerEl.get(0).nodeType === Node.ELEMENT_NODE) {
        while (height > maxHeight && containerEl.contents().length) {
          $lastRemoved = containerEl.contents().last().remove();
          height = $this.height();
        }
  
        if (height <= maxHeight && $lastRemoved) {
          if ($.trim($lastRemoved.text()) !== '') {
            containerEl.append($lastRemoved);
            height = $this.height();
  
            if (height > maxHeight) {
              removeElements.call(this, $lastRemoved);
            }
          } else {
            $this.append($seeMore);
  
            if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
              setTimeout(function () {
                $this.addClass(that.settings.addClass);
              }, 0);
            }
  
            $this.data('truncationDone', true);
            that.settings.onComplete();
          }
        } else if ($.trim(containerEl.text()) === '') {
          $parent = containerEl.parent();
          containerEl.remove();
          height = $this.height();
  
          if ($.trim($parent.text()) === '') {
            removeElements.call(this, $parent);
          } else if (height <= maxHeight) {
            if ($this.children().length) {
              var $lastChild = $this.children().last();
  
              if ($lastChild.is('br')) {
                $lastChild.after($seeMore);
              } else {
                $lastChild.parent().append($seeMore);
              }
            } else {
              $this.append($seeMore);
            }
  
            if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
              setTimeout(function () {
                $this.addClass(that.settings.addClass);
              }, 0);
            }
  
            $this.data('truncationDone', true);
            that.settings.onComplete();
          }
        }
      } else {
        var textContent = containerEl.text();
        var min = 0;
        var max = textContent.length - 1;
        var mid = Math.floor((min + max) / 2);
        $parent = containerEl.parent();
  
        while (min < max) {
          if (height > maxHeight) {
            //max = mid - 1;
            max = mid + parseInt((max - mid) * maxHeight / height, 10);
          } else {
            min = mid + 1;
          }
  
          $seeMore.remove();
          mid = Math.floor((min + max) / 2);
          containerEl.get(0).textContent = textContent.substr(0, this.settings.midWordEnabled ? mid : Math.min(mid, textContent.lastIndexOf(' ', mid)));
  
          if ($.trim($parent.text()) === '') {
            removeElements.call(this, $parent);
            return;
          }
  
          containerEl.parent().append($seeMore);
          height = $this.height();
        }
  
        while (height > maxHeight && mid > 0) {
          $seeMore.remove();
          mid = mid - 1;
          containerEl.get(0).textContent = textContent.substr(0, this.settings.midWordEnabled ? mid : Math.min(mid, textContent.lastIndexOf(' ', mid)));
  
          if ($.trim($parent.text()) === '') {
            removeElements.call(this, $parent);
            return;
          }
  
          containerEl.parent().append($seeMore);
          height = $this.height();
        }
  
        if (mid === 0) {
          $seeMore.remove();
  
          if ($.trim($parent.text()) === '') {
            removeElements.call(this, $parent);
          }
        }
  
        if (height <= maxHeight) {
          if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
            setTimeout(function () {
              $this.addClass(that.settings.addClass);
            }, 0);
          }
  
          $this.data('truncationDone', true);
          that.settings.onComplete();
        }
      }
    }
  
    function truncateList() {
      var that = this;
      var $this = $(this);
      var height = $this.height();
      var lineHeight = Math.ceil(Math.max($this.children().height(), parseFloat($this.css('line-height'))));
      var maxHeight = this.settings.lines * lineHeight;
      var visible = !$this.closest(':not(:visible)').length;
  
      if ($this.children().length === 0) {
        $this.addClass(that.settings.addClass);
        $this.data('truncationDone', true);
        that.settings.onComplete();
        return;
      }
  
      if (visible && (height === 0 || maxHeight === 0)) {
        setTimeout(function () {
          truncateList.call(that);
        }, 30);
        return;
      }
  
      switch (this.settings.position) {
        case 'middle':
          if (height > maxHeight) {
            removeListItemsMiddle.call(this, $this);
          } else {
            if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
              setTimeout(function () {
                $this.addClass(that.settings.addClass);
              }, 0);
            }
  
            $this.data('truncationDone', true);
            that.settings.onComplete();
          }
  
          break;
  
        case 'end':
          if (height > maxHeight) {
            removeListItemsEnd.call(this, $this);
          } else {
            if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
              setTimeout(function () {
                $this.addClass(that.settings.addClass);
              }, 0);
            }
  
            $this.data('truncationDone', true);
            that.settings.onComplete();
          }
  
          break;
  
        case 'betweenFirstAndLast':
          removeListItemsBetweenFirstAndLast.call(this, $this);
          break;
  
        case 'beforeLast':
          if (height > maxHeight) {
            removeListItemsBeforeLast.call(this, $this);
          } else {
            if (this.settings.addClass && !$this.hasClass(this.settings.addClass)) {
              setTimeout(function () {
                $this.addClass(that.settings.addClass);
              }, 0);
            }
  
            $this.data('truncationDone', true);
            that.settings.onComplete();
          }
  
          break;
      }
    }
  
    function removeListItemsMiddle() {
      var that = this;
      var $this = $(this);
      var height;
      var lineHeight = Math.ceil(Math.max($this.children().height(), parseFloat($this.css('line-height'))));
      var maxHeight = this.settings.lines * lineHeight;
      var $seeMore;
      var removedCount = 0;
      var $removedItems;
      var $lastRemoved;
      var visible = !$this.closest(':not(:visible)').length;
  
      if (this.settings.seeMoreLink) {
        $seeMore = seeMoreMiddleLink.call(this);
      } else {
        $seeMore = ellipsis.call(this, true);
      }
  
      var removeItems = function removeItems() {
        height = $this.height();
        if (!visible) return;
  
        if (height > maxHeight) {
          while (height > maxHeight && $this.contents().length > 2) {
            $seeMore.remove();
  
            if ($removedItems && $this.find($removedItems).length) {
              $removedItems.remove();
            }
  
            var indexToRemove = Math.floor($this.contents().length / 2);
            $lastRemoved = $($this.contents().get(indexToRemove)).remove();
  
            if ($lastRemoved && $lastRemoved.get(0).nodeType === Node.ELEMENT_NODE) {
              if (that.settings.ignoreCountList !== null) {
                if (!$lastRemoved.is(that.settings.ignoreCountList)) {
                  removedCount += 1;
                }
              } else {
                removedCount += 1;
              }
            }
  
            indexToRemove -= 1;
            height = $this.height();
  
            if (height > maxHeight && $this.contents().length > 2) {
              $lastRemoved = $($this.contents().get(indexToRemove)).remove();
  
              if ($lastRemoved && $lastRemoved.get(0).nodeType === Node.ELEMENT_NODE) {
                if (that.settings.ignoreCountList !== null) {
                  if (!$lastRemoved.is(that.settings.ignoreCountList)) {
                    removedCount += 1;
                  }
                } else {
                  removedCount += 1;
                }
              }
  
              indexToRemove -= 1;
            }
  
            if (that.settings.showRemovedCount && removedCount > 0) {
              $removedItems = $.fn.truncate.removedCountMarkup(removedCount);
              $removedItems.insertAfter($($this.contents().get(indexToRemove)));
            } else {
              $seeMore.insertAfter($($this.contents().get(indexToRemove)));
            }
  
            height = $this.height();
          }
  
          setTimeout(removeItems, 500);
        } else {
          if (that.settings.addClass && !$this.hasClass(that.settings.addClass)) {
            setTimeout(function () {
              $this.addClass(that.settings.addClass);
            }, 0);
          }
  
          $this.data('truncationDone', true);
          that.settings.onComplete();
        }
      };
  
      removeItems();
    }
  
    function removeListItemsEnd() {
      var that = this;
      var $this = $(this);
      var height;
      var lineHeight = Math.ceil(Math.max($this.children().height(), parseFloat($this.css('line-height'))));
      var maxHeight = this.settings.lines * lineHeight;
      var $seeMore;
      var removedCount = 0;
      var $removedItems;
      var $lastRemoved;
      var visible = !$this.closest(':not(:visible)').length;
  
      if (this.settings.seeMoreLink) {
        $seeMore = seeMoreLink.call(this);
      } else {
        $seeMore = ellipsis.call(this);
      }
  
      var removeItems = function removeItems() {
        height = $this.height();
        if (!visible) return;
  
        if (height > maxHeight) {
          while (height > maxHeight && $this.contents().length > 1) {
            if ($removedItems && $this.find($removedItems).length) {
              $removedItems.remove();
            }
  
            if ($this.find($seeMore).length) {
              $lastRemoved = $($this.contents().get($this.contents().length - 2)).remove();
            } else {
              $lastRemoved = $this.contents().last().remove();
  
              if (!that.settings.showRemovedCount) {
                $this.append($seeMore);
              }
            }
  
            if ($lastRemoved && $lastRemoved.get(0).nodeType === Node.ELEMENT_NODE) {
              if (that.settings.ignoreCountList !== null) {
                if (!$lastRemoved.is(that.settings.ignoreCountList)) {
                  removedCount += 1;
                }
              } else {
                removedCount += 1;
              }
            }
  
            if (that.settings.showRemovedCount && removedCount > 0) {
              $removedItems = $.fn.truncate.removedCountMarkup(removedCount);
              $this.append($removedItems);
            }
  
            height = $this.height();
          }
  
          setTimeout(removeItems, 500);
        } else {
          if (that.settings.addClass && !$this.hasClass(that.settings.addClass)) {
            setTimeout(function () {
              $this.addClass(that.settings.addClass);
            }, 0);
          }
  
          $this.data('truncationDone', true);
          that.settings.onComplete();
        }
      };
  
      removeItems();
    }
  
    function removeListItemsBeforeLast() {
      var that = this;
      var $this = $(this);
      var height = $this.height();
      var lineHeight = Math.ceil(Math.max($this.children().height(), parseFloat($this.css('line-height'))));
      var maxHeight = this.settings.lines * lineHeight;
      var $seeMoreLink = seeMoreMiddleLink.call(this);
      var removedCount = 0;
      var $removedItems;
      var $lastRemoved;
      var visible = !$this.closest(':not(:visible)').length;
  
      var removeItems = function removeItems() {
        height = $this.height();
        if (!visible) return;
  
        if (height > maxHeight) {
          var $lastXItems = $('<div></div>');
  
          while ($this.children().length > 1 && $lastXItems.children().length < that.settings.lastItemsCount || $this.contents().last().get(0).nodeType === Node.TEXT_NODE) {
            $lastXItems.prepend($this.contents().last().remove());
          }
  
          var $lastXItemsContent = $lastXItems.contents();
  
          while (height > maxHeight && $this.children().length > 2) {
            if ($removedItems && $this.find($removedItems).length) {
              $removedItems.remove();
            }
  
            $seeMoreLink.remove();
            $lastXItemsContent.remove();
            $lastRemoved = $this.contents().last().remove();
  
            if ($lastRemoved && $lastRemoved.get(0).nodeType === Node.ELEMENT_NODE) {
              if (that.settings.ignoreCountList !== null) {
                if (!$lastRemoved.is(that.settings.ignoreCountList)) {
                  removedCount += 1;
                }
              } else {
                removedCount += 1;
              }
            }
  
            if (that.settings.showRemovedCount && removedCount > 0) {
              $removedItems = $.fn.truncate.removedCountMarkup(removedCount);
              $this.append($removedItems);
            } else {
              $this.append($seeMoreLink);
            }
  
            $this.append($lastXItemsContent);
            height = $this.height();
          }
  
          setTimeout(removeItems, 500);
        } else {
          if (that.settings.addClass && !$this.hasClass(that.settings.addClass)) {
            setTimeout(function () {
              $this.addClass(that.settings.addClass);
            }, 0);
          }
  
          $this.data('truncationDone', true);
          that.settings.onComplete();
        }
      };
  
      removeItems();
    }
  
    function removeListItemsBetweenFirstAndLast() {
      var that = this;
      var $this = $(this);
      var $items = $this.children();
      var $seeMore;
      var removedCount = $items.length - 2;
      var $removedItems;
  
      if ($items.length > 2) {
        if (this.settings.seeMoreLink) {
          $seeMore = seeMoreMiddleLink.call(this);
        } else {
          $seeMore = ellipsis.call(this, true);
        }
  
        if (that.settings.showRemovedCount) {
          $removedItems = $.fn.truncate.removedCountMarkup(removedCount);
        }
  
        $this.html('');
        $this.append($items.first());
  
        if (that.settings.showRemovedCount && removedCount > 0) {
          $this.append($removedItems);
        } else {
          $this.append($seeMore);
        }
  
        $this.append($items.last());
      }
  
      if (that.settings.addClass && !$this.hasClass(that.settings.addClass)) {
        setTimeout(function () {
          $this.addClass(that.settings.addClass);
        }, 0);
      }
  
      $this.data('truncationDone', true);
      that.settings.onComplete();
    }
  
    function ellipsis(isLink) {
      return $('<' + (isLink ? 'a href="#"' : 'span') + ' class="ellipsis"> ' + this.settings.ellipsisChar + ' </' + (isLink ? 'a' : 'span') + '>');
    }
  
    function seeMoreLink() {
      var seeMore = ' <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ' + this.settings.seeMoreText + ' <i class=" ' + this.settings.seeMoreIcon + ' "></i>',
          link;
  
      if (this.settings.seeMoreHtml) {
        seeMore = this.settings.seeMoreHtml;
      } else if (this.settings.isMobile) {
        seeMore = ' <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ' + this.settings.seeMoreText + ' <i class=" ' + this.settings.seeMoreIconMobile + ' "></i>';
      }
  
      if (this.settings.isMobile && this.isSliding) {
        link = '<a href="javascript:void(0)" class="read-more w-slide__btn slide-active" data-slide-target="' + this.settings.mobileTarget + '" aria-expanded="false">' + seeMore + '</a>';
      } else {
        link = '<a href="javascript:void(0)" class="read-more" aria-expanded="false">' + seeMore + '</a>';
      }
  
      if (this.parentTagName === 'UL') {
        link = '<li>' + link + '</li>';
      }
  
      return $(link);
    }
  
    function seeMoreMiddleLink() {
      var seeMore = ' <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ' + this.settings.seeMoreText + ' <i class=" ' + this.settings.seeMoreIcon + ' "></i> <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ',
          link;
  
      if (this.settings.seeMoreHtml) {
        seeMore = this.settings.seeMoreHtml;
      } else if (this.settings.isMobile) {
        seeMore = ' <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ' + this.settings.seeMoreText + ' <i class="' + this.settings.seeMoreIconMobile + '"></i> <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ';
      }
  
      if (this.settings.isMobile) {
        link = '<a href="javascript:void(0)" class="read-more w-slide__btn slide-active " data-slide-target="' + this.settings.mobileTarget + '" aria-expanded="false">' + seeMore + '</a>';
      } else {
        link = '<a href="javascript:void(0)" class="read-more" aria-expanded="false">' + seeMore + '</a>';
      }
  
      if (this.parentTagName === 'UL') {
        link = '<li>' + link + '</li>';
      }
  
      return $(link);
    }
  
    function seeLessLink() {
      var seeLess = (this.settings.lessLinkEllipsis ? ' <span class="ellipsis">' + this.settings.ellipsisChar + '</span> ' : ' ') + this.settings.seeLessText + ' <i class="' + this.settings.seeLessIcon + '"></i>',
          link;
  
      if (this.settings.seeLessHtml) {
        seeLess = this.settings.seeLessHtml;
      }
  
      link = '<a href="javascript:void(0)" class="read-less" aria-expanded="true">' + seeLess + '</a>';
  
      if (this.parentTagName === 'UL') {
        link = '<li>' + link + '</li>';
      }
  
      return $(link);
    }
  
    function addEventHandlers() {
      var that = this;
      var $this = $(this);
      var allowedKeys = [9, 13]; // tabs and enter (return)
  
      var allowTabToReadMore = true;
  
      if (that.settings.readMoreWithSpacebar) {
        allowedKeys = [9, 13, 32]; // tabs and enter (return) and spacebar
      }
  
      if (that.settings.animation) {
        var checkHeight = true;
        var originalHeight;
      }
  
      $this.on('touchend mousedown keydown', function (evt) {
        if (evt.type === 'keydown' && allowedKeys.indexOf(evt.keyCode) < 0) {
          // preventing random keys from triggering action
          return;
        }
  
        if (that.settings.readMoreWithSpacebar) {
          allowTabToReadMore = evt.keyCode !== 9;
        }
  
        if (that.settings.animation) {
          if (checkHeight) {
            originalHeight = $this.outerHeight(true);
            checkHeight = false;
          }
        }
  
        if ($this.data('truncationDone') && allowTabToReadMore) {
          var $evtTarget = $(evt.target);
  
          if ($evtTarget.hasClass('ellipsis') && $evtTarget.is('a')) {
            // ellipsis clicked
            readMore();
          }
  
          if ($evtTarget.hasClass('read-more') && !$evtTarget.hasClass('w-slide__btn') || $evtTarget.parent().hasClass('read-more') && !$evtTarget.parent().hasClass('w-slide__btn') || $evtTarget.hasClass('removed-items-count')) {
            // "Read more" link clicked
            readMore();
          }
  
          if ($evtTarget.hasClass('read-less') || $evtTarget.parent().hasClass('read-less')) {
            // "Read less" link clicked
            readLess();
          }
        }
  
        function readMore() {
          evt.preventDefault();
          var truncatedLength = $this.children().length;
          $this.data('truncatedContent', $this.html());
          $this.html($this.data('originalContent'));
          var lessLink = seeLessLink.call(that);
          $this.append(lessLink);
  
          if (that.settings.animation) {
            $this.css('height', 'auto');
            var autoHeight = $this.outerHeight(true);
            $this.height(originalHeight).animate({
              height: autoHeight
            }, 300);
            setTimeout(function () {
              $this.css('height', 'auto');
            }, 350);
          }
  
          if (evt.type === 'keydown') {
            if ($this[0].parentTagName === 'UL') {
              $this.children().eq(truncatedLength - 1).find('a').trigger('focus');
            } else {
              lessLink.focus();
            }
          }
        }
  
        function readLess() {
          if (evt.keyCode === 9) {
            // preventing tabulation limbo
            return;
          } else {
            evt.preventDefault();
          }
  
          if (that.settings.animation) {
            $this.animate({
              height: originalHeight
            }, 300);
            setTimeout(function () {
              $this.html($this.data('truncatedContent'));
            }, 250);
          } else {
            $this.html($this.data('truncatedContent'));
          }
  
          $this.find('.read-more').focus(); //var moreLink = seeMoreLink.call(that);
          //$(evt.target).replaceWith(moreLink);
        }
      });
  
      if (!$(document).data('activeTabHandlerAdded')) {
        $(document).data('activeTabHandlerAdded', 'yes');
        $(document).on('tabs:changeActiveTab', function (evt, data) {
          setTimeout(function () {
            $('.truncate-delayed', data.tabId).truncate();
          }, 10);
        });
      }
    }
  
    function addResponsiveHandlers() {
      var that = this;
  
      function targetViewportOn() {
        that.settings.isMobile = true;
        truncateStart.call(that);
      }
  
      function targetViewportOff() {
        that.settings.isMobile = false;
        truncateStart.call(that);
      }
  
      if (this.prevVPort) {
        // remove previous responsive handlers
        $(document).off(this.prevVPort + '-on', targetViewportOn);
        $(document).off(this.prevVPort + '-off', targetViewportOff);
      }
  
      $(document).on(this.settings.vPort + '-on', targetViewportOn); // Waiting for custom event that will be triggered by controller.js to activate responsive effects
  
      $(document).on(this.settings.vPort + '-off', targetViewportOff); // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
  
      this.prevVPort = this.settings.vPort;
    }
  
    function truncateStart() {
      var $this = $(this);
  
      if (this.settings.showRemovedCount) {
        $this.truncate('destroy'); // destroy in case showRemovedCount to get a correct number
      }
  
      if (this.settings.isMobile && this.settings.targetViewport === 'desktop' || !this.settings.isMobile && this.settings.targetViewport === 'mobile') {
        restoreContent.call(this);
        return;
      }
  
      if ($this.closest('.tab__pane').length && !$this.closest('.tab__pane').hasClass('active')) {
        $this.addClass('truncate-delayed');
        return;
      } else {
        $this.removeClass('truncate-delayed');
      }
  
      if (this.settings && this.settings.type === 'text') {
        truncateText.call(this);
      } else if (this.settings && this.settings.type === 'list') {
        this.parentTagName = $this.get(0).tagName;
        truncateList.call(this);
      }
    }
  
    function restoreContent() {
      var $this = $(this);
  
      if ($this.data('originalContent')) {
        $this.html($this.data('originalContent'));
  
        if (this.settings && this.settings.addClass) {
          $this.removeClass(this.settings.addClass);
        }
      }
    }
  
    methods = {
      init: function init(options) {
        return this.each(function () {
          var $this = $(this);
          var firstInit = true;
  
          if ($this.data('originalContent')) {
            if ($this.data('settings')) {
              this.settings = $this.data('settings');
            }
  
            restoreContent.call(this);
            firstInit = false;
          } else {
            $this.data('originalContent', $this.html());
          } // read configuration from data attributes
  
  
          var dataAttrOptions = {};
  
          if ($this.data('truncate-lines')) {
            dataAttrOptions.lines = parseInt($this.data('truncate-lines'), 10);
          }
  
          if ($this.data('truncate-type')) {
            dataAttrOptions.type = $this.data('truncate-type');
          }
  
          if ($this.data('truncate-position')) {
            dataAttrOptions.position = $this.data('truncate-position');
          }
  
          if (typeof $this.data('truncate-show-removed-count') !== 'undefined') {
            dataAttrOptions.showRemovedCount = $this.data('truncate-show-removed-count');
          }
  
          if (typeof $this.data('truncate-see-more-link') !== 'undefined') {
            dataAttrOptions.seeMoreLink = $this.data('truncate-see-more-link');
          }
  
          if ($this.data('truncate-see-more-text')) {
            dataAttrOptions.seeMoreText = $this.data('truncate-see-more-text');
          }
  
          if ($this.data('truncate-see-less-text')) {
            dataAttrOptions.seeLessText = $this.data('truncate-see-less-text');
          }
  
          if ($this.data('truncate-see-more-html')) {
            dataAttrOptions.seeMoreHtml = $this.data('truncate-see-more-html');
          }
  
          if ($this.data('truncate-see-less-html')) {
            dataAttrOptions.seeLessHtml = $this.data('truncate-see-less-html');
          }
  
          if ($this.data('truncate-ellipsis-char')) {
            dataAttrOptions.ellipsisChar = $this.data('truncate-ellipsis-char');
          }
  
          if ($this.data('truncate-last-items-count')) {
            dataAttrOptions.lastItemsCount = parseInt($this.data('truncate-last-items-count'), 10);
          }
  
          if ($this.data('truncate-mobile-target')) {
            dataAttrOptions.mobileTarget = $this.data('truncate-mobile-target');
          }
  
          if ($this.data('truncate-add-class')) {
            dataAttrOptions.addClass = $this.data('truncate-add-class');
          }
  
          if ($this.data('truncate-vport')) {
            dataAttrOptions.vPort = $this.data('truncate-vport');
          }
  
          if ($this.data('truncate-target-viewport')) {
            dataAttrOptions.targetViewport = $this.data('truncate-target-viewport');
          }
  
          if (typeof $this.data('truncate-mid-word-enabled') !== 'undefined') {
            dataAttrOptions.midWordEnabled = $this.data('truncate-mid-word-enabled');
          }
  
          if (typeof $this.data('truncate-less-link-ellipsis') !== 'undefined') {
            dataAttrOptions.lessLinkEllipsis = $this.data('truncate-less-link-ellipsis');
          }
  
          this.settings = $.extend({}, this.settings || $.fn.truncate.defaults, dataAttrOptions, options || {});
          $this.data('settings', this.settings);
          $this.data('truncationDone', false);
          truncateStart.call(this);
  
          if (firstInit) {
            addEventHandlers.call(this);
          }
  
          addResponsiveHandlers.call(this);
        });
      },
      destroy: function destroy() {
        return this.each(function () {
          restoreContent.call(this);
        });
      }
    };
  
    $.fn.truncate = function (method) {
      if (methods[method]) {
        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
      } else if (_typeof(method) === 'object' || !method) {
        return methods.init.apply(this, arguments);
      } else {
        $.error('Method ' + method + ' does not exist on jQuery.truncate');
      }
    };
  
    $.fn.truncate.removedCountMarkup = function (count) {
      return $('<a href="javascript:void(0)" class="removed-items-count"> + ' + count + ' </a>');
    };
    /* Default truncate settings. */
  
  
    $.fn.truncate.defaults = {
      type: 'text',
      // text, list
      position: 'end',
      // end, middle, beforeLast, betweenFirstAndLast
      showRemovedCount: false,
      lines: 1,
      seeMoreLink: false,
      seeMoreText: 'See More',
      seeLessText: 'See Less',
      seeMoreIcon: "icon-section_arrow_d",
      seeLessIcon: "icon-section_arrow_u",
      seeMoreIconMobile: "icon-arrow_r",
      seeMoreHtml: '',
      seeLessHtml: '',
      ellipsisChar: '&hellip;',
      lessLinkEllipsis: false,
      lastItemsCount: 1,
      isMobile: false,
      isSliding: true,
      mobileTarget: '',
      targetViewport: 'all',
      // all, desktop, mobile
      addClass: '',
      vPort: 'screen-sm',
      midWordEnabled: false,
      animation: false,
      ignoreCountList: null,
      readMoreWithSpacebar: false,
      onComplete: function onComplete() {}
    };
  })(jQuery);
  
  /***/ }),
  
  /***/ "../../ui-core/utility/ab-logger/js/ab-logger.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/utility/ab-logger/js/ab-logger.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function ($, UX) {
    var abLogger = {
      loggingUrl: '/action/clientSideLogging',
      selectors: {
        trigger: '.js__abTestingTrigger',
        doiLink: 'a[href^="/doi/"]',
        childElement: '.search__item, .creative-work, .item'
      },
      init: function init() {
        var $parent = $(this.selectors.trigger);
  
        if ($parent.length > 0) {
          var expType = $parent.data('exp-type');
          var queryId = $parent.data('query-id');
          var itemSelector = $parent.data('child-selector') ? $parent.data('child-selector') : this.selectors.childElement;
          this.logSearchResultsByHrefSelector(expType, queryId, $parent.find(itemSelector));
        }
      },
      logClick: function logClick(e, doi, expType, queryId, pos) {
        $.ajax({
          url: this.loggingUrl,
          data: {
            type: '102',
            doi: doi,
            queryId: queryId,
            exp: expType,
            event: 'click',
            pos: pos + 1
          },
          async: false
        });
        e.stopImmediatePropagation();
        return true;
      },
      logSearchResultsByHrefSelector: function logSearchResultsByHrefSelector(expType, queryId, $elm) {
        var $links = $elm.find(this.selectors.doiLink);
        var that = this;
        $links.each(function (i) {
          var doi = that.sliceDoiFromHref($(this).attr('href'));
          that.bindElementToMouseUpEvent(this, doi, expType, queryId, i);
        });
      },
      bindElementToMouseUpEvent: function bindElementToMouseUpEvent(element, doi, expType, queryId, i) {
        var that = this;
        $(element).on('mouseup', function (e) {
          switch (e.which) {
            case 1:
              // Left click;
              that.logClick(e, doi, expType, queryId, i);
              break;
  
            case 2:
              // Wheel click (new tab);
              that.logClick(e, doi, expType, queryId, i);
              break;
  
            case 3:
              // Right click;
              // No proper way to track 'Open in new window / tab' from context menu at the moment.
              break;
          }
  
          return true;
        });
      },
      sliceDoiFromHref: function sliceDoiFromHref(href) {
        var doi = href.split('/');
        var doiFirst = doi[doi.length - 2];
        var doiLast = doi[doi.length - 1];
  
        if (doiLast.indexOf('?') > 0) {
          doiLast = doiLast.substring(0, doiLast.indexOf('?'));
        }
  
        return doiFirst + '/' + doiLast;
      }
    };
    UX.abLogger = abLogger;
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/addThisEnhancement.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/addThisEnhancement.js ***!
    \**************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var addThisEnhancement = {
      $addThisElements: $(),
      init: function init() {
        this.$addThisElements = $('.addthis');
  
        if (this.$addThisElements.length > 0) {
          this.control();
        }
      },
      control: function control() {
        $.each(this.$addThisElements, function (i, element) {
          var links = $(element).find('a');
          $.each(links, function (j, link) {
            var text = [].reduce.call(link.childNodes, function (a, b) {
              return a + (b.nodeType === 3 ? b.textContent : '');
            }, '');
            $(link).removeAttr('title').attr('aria-label', text);
          });
        });
      }
    };
    UX.addThisEnhancement = addThisEnhancement;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/bootstrap-utils.js":
  /*!***********************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/bootstrap-utils.js ***!
    \***********************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js-exposed");
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);
  /**
   * --------------------------------------------------------------------------
   * Bootstrap (v4.4.1): util.js
   * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
   * --------------------------------------------------------------------------
   */
  
  /**
   * ------------------------------------------------------------------------
   * Private TransitionEnd Helpers
   * ------------------------------------------------------------------------
   */
  
  var TRANSITION_END = 'transitionend';
  var MAX_UID = 1000000;
  var MILLISECONDS_MULTIPLIER = 1000; // Shoutout AngusCroll (https://goo.gl/pxwQGp)
  
  function toType(obj) {
    return {}.toString.call(obj).match(/\s([a-z]+)/i)[1].toLowerCase();
  }
  
  function getSpecialTransitionEndEvent() {
    return {
      bindType: TRANSITION_END,
      delegateType: TRANSITION_END,
      handle: function handle(event) {
        if (jquery__WEBPACK_IMPORTED_MODULE_0___default()(event.target).is(this)) {
          return event.handleObj.handler.apply(this, arguments); // eslint-disable-line prefer-rest-params
        }
  
        return undefined; // eslint-disable-line no-undefined
      }
    };
  }
  
  function transitionEndEmulator(duration) {
    var _this = this;
  
    var called = false;
    jquery__WEBPACK_IMPORTED_MODULE_0___default()(this).one(Util.TRANSITION_END, function () {
      called = true;
    });
    setTimeout(function () {
      if (!called) {
        Util.triggerTransitionEnd(_this);
      }
    }, duration);
    return this;
  }
  
  function setTransitionEndSupport() {
    jquery__WEBPACK_IMPORTED_MODULE_0___default.a.fn.emulateTransitionEnd = transitionEndEmulator;
    jquery__WEBPACK_IMPORTED_MODULE_0___default.a.event.special[Util.TRANSITION_END] = getSpecialTransitionEndEvent();
  }
  /**
   * --------------------------------------------------------------------------
   * Public Util Api
   * --------------------------------------------------------------------------
   */
  
  
  var Util = {
    TRANSITION_END: 'bsTransitionEnd',
    getUID: function getUID(prefix) {
      do {
        // eslint-disable-next-line no-bitwise
        prefix += ~~(Math.random() * MAX_UID); // "~~" acts like a faster Math.floor() here
      } while (document.getElementById(prefix));
  
      return prefix;
    },
    getSelectorFromElement: function getSelectorFromElement(element) {
      var selector = element.getAttribute('data-target');
  
      if (!selector || selector === '#') {
        var hrefAttr = element.getAttribute('href');
        selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : '';
      }
  
      try {
        return document.querySelector(selector) ? selector : null;
      } catch (err) {
        return null;
      }
    },
    getTransitionDurationFromElement: function getTransitionDurationFromElement(element) {
      if (!element) {
        return 0;
      } // Get transition-duration of the element
  
  
      var transitionDuration = jquery__WEBPACK_IMPORTED_MODULE_0___default()(element).css('transition-duration');
      var transitionDelay = jquery__WEBPACK_IMPORTED_MODULE_0___default()(element).css('transition-delay');
      var floatTransitionDuration = parseFloat(transitionDuration);
      var floatTransitionDelay = parseFloat(transitionDelay); // Return 0 if element or transition duration is not found
  
      if (!floatTransitionDuration && !floatTransitionDelay) {
        return 0;
      } // If multiple durations are defined, take the first
  
  
      transitionDuration = transitionDuration.split(',')[0];
      transitionDelay = transitionDelay.split(',')[0];
      return (parseFloat(transitionDuration) + parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER;
    },
    reflow: function reflow(element) {
      return element.offsetHeight;
    },
    triggerTransitionEnd: function triggerTransitionEnd(element) {
      jquery__WEBPACK_IMPORTED_MODULE_0___default()(element).trigger(TRANSITION_END);
    },
    // TODO: Remove in v5
    supportsTransitionEnd: function supportsTransitionEnd() {
      return Boolean(TRANSITION_END);
    },
    isElement: function isElement(obj) {
      return (obj[0] || obj).nodeType;
    },
    typeCheckConfig: function typeCheckConfig(componentName, config, configTypes) {
      for (var property in configTypes) {
        if (Object.prototype.hasOwnProperty.call(configTypes, property)) {
          var expectedTypes = configTypes[property];
          var value = config[property];
          var valueType = value && Util.isElement(value) ? 'element' : toType(value);
  
          if (!new RegExp(expectedTypes).test(valueType)) {
            throw new Error("".concat(componentName.toUpperCase(), ": ") + "Option \"".concat(property, "\" provided type \"").concat(valueType, "\" ") + "but expected type \"".concat(expectedTypes, "\"."));
          }
        }
      }
    },
    findShadowRoot: function findShadowRoot(element) {
      if (!document.documentElement.attachShadow) {
        return null;
      } // Can find the shadow root otherwise it'll return the document
  
  
      if (typeof element.getRootNode === 'function') {
        var root = element.getRootNode();
        return root instanceof ShadowRoot ? root : null;
      }
  
      if (element instanceof ShadowRoot) {
        return element;
      } // when we don't find a shadow root
  
  
      if (!element.parentNode) {
        return null;
      }
  
      return Util.findShadowRoot(element.parentNode);
    },
    jQueryDetection: function jQueryDetection() {
      if (typeof jquery__WEBPACK_IMPORTED_MODULE_0___default.a === 'undefined') {
        throw new TypeError('Bootstrap\'s JavaScript requires jQuery. jQuery must be included before Bootstrap\'s JavaScript.');
      }
  
      var version = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.fn.jquery.split(' ')[0].split('.');
      var minMajor = 1;
      var ltMajor = 2;
      var minMinor = 9;
      var minPatch = 1;
      var maxMajor = 4;
  
      if (version[0] < ltMajor && version[1] < minMinor || version[0] === minMajor && version[1] === minMinor && version[2] < minPatch || version[0] >= maxMajor) {
        throw new Error('Bootstrap\'s JavaScript requires at least jQuery v1.9.1 but less than v4.0.0');
      }
    }
  };
  Util.jQueryDetection();
  setTransitionEndSupport();
  /* harmony default export */ __webpack_exports__["default"] = (Util);
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/jquery.selector.focusable.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/jquery.selector.focusable.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function ($) {
    // Focusable pseoudo selector
    $.extend($.expr[':'], {
      focusable: function focusable(el, index, selector) {
        var $el = $(el);
        return $el.is('button, [href], input, select, textarea, object, [tabindex]:not([tabindex="-1"])') // we don't need to check "area" tag, while it is focusable only when it has href attr
        && $el.is(':not(:disabled)') // disabled elements are not focusable
        && $el.is(':visible');
      }
    }); // Tabbable pseudo selector
  
    $.extend($.expr[':'], {
      tabbable: function tabbable(el, index, selector) {
        var $el = $(el);
        return $el.is(':focusable') && $el.is(':not([tabindex="-1"])');
      }
    });
  })(jQuery);
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/namespace.js":
  /*!*****************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/namespace.js ***!
    \*****************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // create global namespace for all JS modules
  window.UX = {};
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/no-focusable-svg.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/no-focusable-svg.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var noFocusableSVG = {
      init: function init() {
        if (UX.test.isIE) {
          var svgs = document.getElementsByTagName("svg");
          var i = svgs.length;
  
          while (i--) {
            svgs[i].setAttribute("focusable", false);
          }
        }
      }
    };
    UX.noFocusableSVG = noFocusableSVG;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/observe-dom.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/observe-dom.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  window.observeDOM = function () {
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver,
        eventListenerSupported = window.addEventListener;
    return function (obj, callback) {
      if (MutationObserver) {
        // define a new observer
        var obs = new MutationObserver(function (mutations, observer) {
          if (mutations[0].addedNodes.length || mutations[0].removedNodes.length) callback();
        }); // have the observer observe foo for changes in children
  
        obs.observe(obj, {
          childList: true,
          subtree: true
        });
      } else if (eventListenerSupported) {
        obj.addEventListener('DOMNodeInserted', callback, false);
        obj.addEventListener('DOMNodeRemoved', callback, false);
      }
    };
  }();
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/tests.js":
  /*!*************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/tests.js ***!
    \*************************************************/
  /*! exports provided: isIE */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isIE", function() { return isIE; });
  (function (UX) {
    /**
     * UX Namespace for tests
     * @namespace
     * @type {*|{}}
     */
    UX.test = UX.test || {};
    /**
     * Test browser support for input[type=date]
     * @returns {boolean}
     */
  
    UX.test.inputDate = function () {
      // test for input|type=date support
      // it could be better, when tests are separated and used globally - Modernizr test for this issue is much more sofisticated for example
      var hasDateInputSupport = false;
  
      function checkInput(type) {
        var input = document.createElement("input");
        input.setAttribute("type", type);
        return input.type === type;
      }
  
      function checkDateInput() {
        var input = document.createElement('input');
        input.setAttribute('type', 'date');
        var notADateValue = 'not-a-date';
        input.setAttribute('value', notADateValue);
        return input.value !== notADateValue;
      }
  
      if (checkInput('date') && checkDateInput()) {
        hasDateInputSupport = true;
      }
  
      return hasDateInputSupport;
    };
    /**
     * detect IE
     * returns version of IE or false, if browser is not Internet Explorer
     */
  
  
    UX.test.isIE = function isIE() {
      var ua = window.navigator.userAgent;
      var msie = ua.indexOf('MSIE ');
  
      if (msie > 0) {
        // IE 10 or older => return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
      }
  
      var trident = ua.indexOf('Trident/');
  
      if (trident > 0) {
        // IE 11 => return version number
        var rv = ua.indexOf('rv:');
        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
      }
  
      var edge = ua.indexOf('Edge/');
  
      if (edge > 0) {
        // Edge (IE 12+) => return version number
        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
      } // other browser
  
  
      return false;
    };
  })(UX);
  
  var isIE = UX.test.isIE();
  
  /***/ }),
  
  /***/ "../../ui-core/utility/js/utils.js":
  /*!*************************************************!*\
    !*** /home/irahhal/ui-core/utility/js/utils.js ***!
    \*************************************************/
  /*! exports provided: default, generateId, capitalizeFirstLetter, fixedHeaderHeight, flattenAndFlip */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateId", function() { return generateId; });
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirstLetter", function() { return capitalizeFirstLetter; });
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fixedHeaderHeight", function() { return fixedHeaderHeight; });
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flattenAndFlip", function() { return flattenAndFlip; });
  /* harmony import */ var _tests__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tests */ "../../ui-core/utility/js/tests.js");
  /* harmony import */ var _plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/polyfills/js/NodeList/forEach */ "../../ui-core/plugins/polyfills/js/NodeList/forEach.js");
  /* harmony import */ var _plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_1__);
  
  
  
  (function (UX) {
    /**
     * UX namespace for basic utils
     * @namespace
     * @type {*|{}}
     */
    UX.utils = UX.utils || {};
    /**
     * Generate unique ID suffix
     * @returns {string}
     */
  
    UX.utils.generateId = function () {
      // Math.random should be unique because of its seeding algorithm.
      // Convert it to base 36 (numbers + letters), and grab the first 9 characters
      // after the decimal.
      return '_' + Math.random().toString(36).substr(2, 9);
    };
    /**
     * Capitalize first letter
     * @param {string} string
     * @returns {string}
     */
  
  
    UX.utils.capitalizeFirstLetter = function (string) {
      if (typeof string == "string") {
        return string.charAt(0).toUpperCase() + string.slice(1);
      } else {
        return "";
      }
    };
  
    UX.utils.fixedHeaderHeight = function (selector) {
      if (!selector) selector = '.header';
      var fixedHeader = document.querySelector(selector);
      if (!fixedHeader) return 0;
  
      if (fixedHeader.querySelector('.scrollThenFix')) {
        return fixedHeader.querySelector('.scrollThenFix').getBoundingClientRect().height;
      }
  
      if (fixedHeader.classList.contains('auto-hide-bar') || fixedHeader.querySelectorAll('.auto-hide-bar').length) {
        var fixedHeaderElements = fixedHeader.querySelectorAll('.fixed-element');
        var height = 0;
        fixedHeaderElements.forEach(function (element) {
          height += element.getBoundingClientRect().height;
        });
        return height;
      }
  
      var parentsOfHeader = fixedHeader.parentElement;
      var isFixed;
  
      if (_tests__WEBPACK_IMPORTED_MODULE_0__["isIE"]) {
        isFixed = fixedHeader.classList.contains('fixed') || parentsOfHeader.classList.contains('fixed');
      } else {
        var headerPositions = {
          'header': window.getComputedStyle(fixedHeader).position,
          'parents': window.getComputedStyle(parentsOfHeader).position
        };
        isFixed = ['fixed', 'sticky'].indexOf(headerPositions.header) !== -1 || ['fixed', 'sticky'].indexOf(headerPositions.parents) !== -1;
      }
  
      return isFixed ? fixedHeader.getBoundingClientRect().height : 0;
    };
  
    UX.utils.flattenAndFlip = function (object) {
      var result = {};
  
      var _loop = function _loop(type) {
        if (!object.hasOwnProperty(type)) return "continue";
        object[type].forEach(function (ext) {
          return result[ext] = type;
        });
      };
  
      for (var type in object) {
        var _ret = _loop(type);
  
        if (_ret === "continue") continue;
      }
  
      return result;
    };
  
    UX.utils.getUrlParameter = function (sParam) {
      var sPageURL = window.location.search.substring(1),
          sURLVariables = sPageURL.split('&'),
          sParameterName,
          i;
  
      for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');
  
        if (sParameterName[0] === sParam) {
          return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
      }
    };
  
    UX.utils.removeUrlParam = function (key, sourceURL) {
      if (typeof sourceURL === "undefined") {
        return;
      }
  
      var rtn = sourceURL.split("?")[0],
          param,
          params_arr = [],
          queryString = sourceURL.indexOf("?") !== -1 ? sourceURL.split("?")[1] : "";
  
      if (queryString !== "") {
        params_arr = queryString.split("&");
  
        for (var i = params_arr.length - 1; i >= 0; i -= 1) {
          param = params_arr[i].split("=")[0];
  
          if (param === key) {
            params_arr.splice(i, 1);
          }
        }
  
        rtn = rtn + "?" + params_arr.join("&");
      }
  
      return rtn;
    };
  
    UX.utils.escapeHtml = function (string) {
      var entityMap = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#39;',
        '/': '&#x2F;',
        '`': '&#x60;',
        '=': '&#x3D;'
      };
      return String(string).replace(/[&<>"'`=\/]/g, function (s) {
        return entityMap[s];
      });
    };
  
    UX.utils.isRTL = function () {
      return document.querySelector('html').getAttribute('dir') === 'rtl';
    };
  })(UX);
  
  /* harmony default export */ __webpack_exports__["default"] = (UX.utils);
  var _UX$utils = UX.utils,
      generateId = _UX$utils.generateId,
      capitalizeFirstLetter = _UX$utils.capitalizeFirstLetter,
      fixedHeaderHeight = _UX$utils.fixedHeaderHeight,
      flattenAndFlip = _UX$utils.flattenAndFlip;
  
  
  /***/ }),
  
  /***/ "../../ui-core/utility/load-fonts/js/load-fonts.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/utility/load-fonts/js/load-fonts.js ***!
    \*****************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FontLoader; });
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "../../ui-core/node_modules/@babel/runtime/helpers/classCallCheck.js");
  /* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "../../ui-core/node_modules/@babel/runtime/helpers/createClass.js");
  /* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
  
  
  
  var FontFaceObserver = __webpack_require__(/*! fontfaceobserver */ "../../ui-core/node_modules/fontfaceobserver/fontfaceobserver.standalone.js");
  
  var FontLoader = /*#__PURE__*/function () {
    function FontLoader() {
      var typeFace = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Open Sans';
      var fontWeights = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [300, 400, 600, 700, 800];
      var timeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10000;
  
      _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, FontLoader);
  
      this.typeFace = typeFace;
      this.fontWeights = fontWeights;
      this.subset = new FontFaceObserver(typeFace);
  
      this._init();
    }
  
    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(FontLoader, [{
      key: "_init",
      value: function _init() {
        this._addListeners();
      }
    }, {
      key: "_addListeners",
      value: function _addListeners() {
        window.addEventListener('load', this._loadFonts.bind(this));
      }
    }, {
      key: "_loadFonts",
      value: function _loadFonts() {
        var _this = this;
  
        this.subset.load().then(function () {
          var fonts = _this.fontWeights.map(function (weight) {
            return new FontFaceObserver(_this.typeFace, {
              weight: weight
            }).load(null, _this.timeout);
          });
  
          Promise.all(fonts).then(function () {
            document.documentElement.className += ' fonts-loaded';
          }, function () {
            console.warn('Font is not available after waiting 10 seconds');
          })["catch"](function (e) {
            console.error(e);
          });
        });
      }
    }]);
  
    return FontLoader;
  }();
  
  
  
  /***/ }),
  
  /***/ "../../ui-core/utility/resized-event/js/resized-event.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/utility/resized-event/js/resized-event.js ***!
    \***********************************************************************/
  /*! exports provided: default */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _plugins_polyfills_js_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/polyfills/js/CustomEvent.js */ "../../ui-core/plugins/polyfills/js/CustomEvent.js");
  /* harmony import */ var _plugins_polyfills_js_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__);
  
  /* harmony default export */ __webpack_exports__["default"] = (function () {
    var timer;
    var windowWidth = $(window).width();
    window.addEventListener('resize', function (event) {
      if (timer) clearTimeout(timer);
      timer = setTimeout(function () {
        if ($(window).width() !== windowWidth) {
          // fix for mobile devices - scrolling triggers resize events when the action bar disappears
          windowWidth = $(window).width();
          window.dispatchEvent(new CustomEvent('resized'));
          $(window).trigger('resized');
        }
      }, 100, event);
    });
  });
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/ad-placeholder/js/ad-placeholder.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/ad-placeholder/js/ad-placeholder.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var adplaceholder = {
      init: function init() {
        $(".js__toggleAdForm").on("click", function (e) {
          e.preventDefault();
          var elemToToggle = "#" + $(this).data("toggle");
          $(elemToToggle).slideToggle();
        });
      }
    };
    UX.adplaceholder = adplaceholder; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/administrators/js/administrators.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/administrators/js/administrators.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var administrators = {
      $removeBtn: $('.js__removeAdmins'),
      init: function init() {
        administrators.controller();
      },
      controller: function controller() {
        administrators.$removeBtn.on('click', function (e) {
          e.preventDefault();
          e.stopPropagation();
          administrators.form.submit();
        });
      },
      form: {
        submit: function submit() {
          var hasUserChecked = administrators.form.conflictCheck();
  
          if (!hasUserChecked) {
            administrators.form.error_msg();
            return;
          } else {
            administrators.$removeBtn.closest('form').submit();
          }
        },
        conflictCheck: function conflictCheck() {
          return administrators.$removeBtn.closest('form').find('[type="checkbox"]:checked').length !== 0;
        },
        error_msg: function error_msg() {
          alert('Please select an administrator to remove.');
        }
      }
    };
    UX.administrators = administrators; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/advanced-search/js/advanced-search.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/advanced-search/js/advanced-search.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var searchFieldsCtrl = {
      clonedInside: '.advanced-search--searchIn',
      $wrapper: null,
      $form: null,
      $terms: null,
      escape: 27,
      dateRangeVal: $('#staticRangeSelect').val(),
      vPort: 'screen-sm',
      // default responsive break point
      isMobile: false,
      $magicSuggest: null,
      magicSuggestObjects: [],
      $cloningInput: null,
      $accessibilitySpan: null,
      init: function init() {
        searchFieldsCtrl.$form = $('.frmSearch');
        searchFieldsCtrl.$magicSuggest = $('.magicsuggest');
        searchFieldsCtrl.initMagicSuggest();
        searchFieldsCtrl.check.submitButton();
        searchFieldsCtrl.check.terms();
        searchFieldsCtrl.control();
        searchFieldsCtrl.addtionalControls();
        searchFieldsCtrl.$form.find('input[type=text]:first').focus();
        var $lastTerm = $('.advanced-search--searchIn').find('.searchIn--field:last-child');
        searchFieldsCtrl.check.lastClone($lastTerm);
      },
      control: function control() {
        $body.on('click', '.advanced-search--searchIn [class*="-ctrl-field"]', function (e) {
          e.preventDefault();
          e.stopPropagation();
          searchFieldsCtrl.$wrapper = $(this).closest('.searchIn--field');
  
          if ($(this).is('.add-ctrl-field')) {
            searchFieldsCtrl.$terms = $(this).closest('.advanced-search--searchIn').find('.searchIn--field');
  
            if (searchFieldsCtrl.$terms.length < 7) {
              searchFieldsCtrl.on.clone($(this));
            }
          } else {
            searchFieldsCtrl.on.remove($(this));
          }
        });
        $body.on('keyup input', '.searchIn--field input', function () {
          searchFieldsCtrl.$form = $(this).closest('form');
          searchFieldsCtrl.check.submitButton();
        });
        searchFieldsCtrl.click.toggleSearchBlock();
        $(document).on(searchFieldsCtrl.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          searchFieldsCtrl.isMobile = true;
        });
        $(document).on(searchFieldsCtrl.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          searchFieldsCtrl.isMobile = false;
        });
        $('.advanced-search--advancedFilters .radio--primary input[type="radio"]').change(function () {
          $('.advanced-search--advancedFilters .radio--primary input[type="radio"]').prop('checked', false);
          $(this).prop('checked', true);
        });
        $('body').on('change', '#earlyCite', function () {
          // this code added to solve LIT-190918
          var $earlyCite_hidden = $('#earlyCite_hidden');
  
          if ($earlyCite_hidden.val() === '') {
            $earlyCite_hidden.val('off');
            $earlyCite_hidden.prop('disabled', false);
          } else {
            $earlyCite_hidden.val('');
            $earlyCite_hidden.prop('disabled', true);
          }
        });
        $('body').on('change', '[type=radio][name=Ppub]', function () {
          $('#publicationDate .time-frame').find('select').prop('disabled', true);
          $(this).closest('.time-frame').find('select').prop('disabled', false);
        });
      },
      addtionalControls: function addtionalControls() {},
      initMagicSuggest: function initMagicSuggest() {
        searchFieldsCtrl.$magicSuggest.each(function () {
          searchFieldsCtrl.on.doSuggest($(this));
        });
      },
      hideTriggerOption: function hideTriggerOption($elem) {
        var hideTrigger = true;
  
        if ($elem.hasClass('showDefaultData')) {
          hideTrigger = false;
        }
  
        return hideTrigger;
      },
      click: {
        toggleSearchBlock: function toggleSearchBlock() {
          $body.on('click', '.search__result .advanced-search__ctrl', function (e) {
            if (!searchFieldsCtrl.isMobile) {
              e.preventDefault();
              $(this).toggleClass('js--open');
              $('.search-result__meta .advanced-search__tabs').toggle();
            }
          });
        }
      },
      on: {
        clone: function clone($this) {
          searchFieldsCtrl.$wrapper.clone(true, true).find('input').val('').end().appendTo(searchFieldsCtrl.clonedInside);
          $this.addClass('hidden');
          $this.siblings('.remove-ctrl-field').removeClass('hidden');
          $this = $('.advanced-search--searchIn').children('.searchIn--field:last-child');
          searchFieldsCtrl.check.lastClone($this);
        },
        remove: function remove($this) {
          searchFieldsCtrl.$form = $this.closest('form');
          searchFieldsCtrl.$wrapper.remove();
          searchFieldsCtrl.on.additionalRemove($this);
          searchFieldsCtrl.check.submitButton();
          $this = $('.advanced-search--searchIn').children('.searchIn--field:last-child');
          searchFieldsCtrl.check.lastClone($this);
        },
        additionalRemove: function additionalRemove($elem) {},
        doSuggest: function doSuggest($elem) {
          var doSuggestTarget = $elem.data('auto-complete-target');
          var withinData = $elem.data('auto-complete-within'),
              maxWords = 200,
              maxChars = 222,
              name = $elem.attr('name'),
              id = $elem.attr('id'),
              values = $elem.attr('data-values') ? JSON.parse($elem.attr('data-values')) : [];
  
          if (withinData) {
            doSuggestTarget = doSuggestTarget + '&within=' + withinData;
          }
  
          var magicSuggestCfg = searchFieldsCtrl.setMagicSuggestCfg(id, name);
          searchFieldsCtrl.$accessibilitySpan = $elem.closest('.searchIn--field').find('.ui-helper-hidden-accessible');
          var $ms = $elem.magicSuggest({
            data: '/action/doSuggest?target=' + doSuggestTarget,
            // realData
            // data: '/specs/ux3/widgets/advanced-search/templates/demo/fakeAutoCompleteData.json', // fakeData
            method: 'GET',
            valueField: 'value',
            autoSelect: false,
            allowFreeEntries: 'false',
            displayField: 'label',
            cls: 'search-term',
            hideTrigger: searchFieldsCtrl.hideTriggerOption($elem),
            inputCfg: magicSuggestCfg,
            beforeSend: function beforeSend(xhr, settings) {
              var enteredTerm = settings.url.substr(settings.url.indexOf('query=') + 6).replace(/[+]/g, ' ');
  
              if (enteredTerm.split(' ').length > maxWords || enteredTerm.length > maxChars || !enteredTerm.replace(/\s/g, '').length) {
                if ($elem.hasClass('showDefaultData')) {
                  //get all data
                  settings.url += '*:*';
                } else {
                  return false;
                }
              }
            }
          });
  
          if (values.length) {
            $ms.setSelection(values);
          }
  
          $($ms).on('selectionchange', function () {
            searchFieldsCtrl.check.submitButton();
          });
          $($ms).on('load', function (e, m) {
            var count = $ms.container.find('.ms-res-item').length;
            searchFieldsCtrl.$accessibilitySpan.html(count + ' results are available, use up and down arrow keys to navigate.');
          });
          $($ms).on('keyup', function (e, m, v) {
            if (v.keyCode === 38 || v.keyCode === 40) {
              var label = $ms.container.find('.ms-res-item-active').text();
              searchFieldsCtrl.$accessibilitySpan.html(label);
            }
          });
          searchFieldsCtrl.magicSuggestObjects.push($ms);
          searchFieldsCtrl.check.submitButton();
          var didSuggest = $.Event('search:didSuggest');
          $(document).trigger(didSuggest, $ms);
        }
      },
      setMagicSuggestCfg: function setMagicSuggestCfg(id, name) {
        return {
          'id': id,
          'name': name
        };
      },
      check: {
        emptyInputs: function emptyInputs(form) {
          var textInputs = $(form).find('input[type=search]');
  
          if (textInputs.length === 0) {
            textInputs = $(form).find('input[type=text]');
          }
  
          textInputs = $(textInputs).add($(form).find('.checkVal'));
          var $emptyFields = $(textInputs).filter(function () {
            return this.value === '';
          });
          return $emptyFields.length === textInputs.length;
        },
        submitButton: function submitButton() {
          if (searchFieldsCtrl.check.emptyInputs(searchFieldsCtrl.$form) && searchFieldsCtrl.check.emptySuggestions()) {
            $(searchFieldsCtrl.$form).find('button[type=submit]').attr('disabled', true);
          } else {
            $(searchFieldsCtrl.$form).find('button[type=submit]').removeAttr('disabled', true);
          }
        },
        emptySuggestions: function emptySuggestions() {
          var suggestions = searchFieldsCtrl.magicSuggestObjects;
  
          if (!suggestions.length) {
            return true;
          }
  
          return suggestions.filter(function (suggestion) {
            return suggestion.getValue().length > 0;
          }).length === 0;
        },
        terms: function terms() {
          searchFieldsCtrl.$terms = $('.advanced-search--searchIn .searchIn--field');
          searchFieldsCtrl.$terms.each(function (index) {
            var number = index + 1;
            var $this = $(this);
            searchFieldsCtrl.$cloningInput = searchFieldsCtrl.check.defineCloningInput($this);
            $this.find('[for*="searchArea"]').attr({
              "for": 'searchArea' + number
            });
            $this.find('[for*="text"]').attr({
              "for": 'text' + number
            });
            $this.find('select').attr({
              id: 'searchArea' + number,
              name: 'field' + number
            });
            searchFieldsCtrl.$cloningInput.attr({
              id: 'text' + number,
              name: 'text' + number
            });
          });
        },
        defineCloningInput: function defineCloningInput($this) {
          return $this.find('input');
        },
        lastClone: function lastClone($this) {
          if ($this.index() === 6) {
            $this.children('.add-ctrl-field').addClass('hidden');
            $this.children('.remove-ctrl-field').removeClass('hidden');
          } else {
            $this.children('.add-ctrl-field').removeClass('hidden');
            $this.children('.remove-ctrl-field').addClass('hidden');
          }
  
          searchFieldsCtrl.check.terms();
        }
      }
    };
    UX.searchFieldsCtrl = searchFieldsCtrl; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/advisor-action-records/js/advisor-action-records.js":
  /*!*****************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/advisor-action-records/js/advisor-action-records.js ***!
    \*****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var advisorActionRecords = {
      $container: null,
      init: function init() {
        advisorActionRecords.$container = $('.advisorActionRecords');
      }
    };
    UX.advisorActionRecords = advisorActionRecords;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/article-tools/js/article-tools.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/article-tools/js/article-tools.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var articleTools = {
      init: function init() {
        articleTools.control();
      },
      copy: function copy(str) {
        var additionalLink = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
        var el = document.createElement('textarea');
        el.id = 'temp_element';
        el.value = document.location.protocol + '//' + document.location.host + additionalLink + str;
        el.setAttribute('readonly', '');
        document.body.appendChild(el);
        /*to work on IOS*/
  
        var selector = document.querySelector('#temp_element');
  
        if (navigator.userAgent.match(/ipad|ipod|iphone/i)) {
          selector.setSelectionRange(0, 999999);
        } else {
          selector.select();
        }
  
        document.execCommand('copy');
        document.body.removeChild(el); // to show alert message that the text is copied, implemented on RMIT
  
        var copiedEvent = $.Event("link:copied");
        $(document).trigger(copiedEvent, [articleTools]);
  
        if (copiedEvent.isDefaultPrevented()) {
          return;
        }
      },
      control: function control() {
        if ($('figure .figure__image').length === 0) {
          $(".download_Figures").closest(".article-tool").hide();
        }
      }
    };
    UX.articleTools = articleTools;
  
    if ($(".article-tools__ctrl").length) {
      UX.articleTools.init();
    }
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/author-history/js/author-history.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/author-history/js/author-history.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var authorsHistory = {
      $container: null,
      $list: null,
      $history: null,
      $back: null,
      ajaxUrl: '/action/authorSubmissions',
      author: null,
      vPort: 'screen-sm',
      isMobile: false,
  
      /**
       * @private
       */
      _loadingResult: {
        success: false,
        data: null
      },
      noResultsMsg: 'No previous submissions were found for this author.',
      errorMsg: 'Error occurred while retrieving submission history.',
      selectors: {
        rootElement: '.pbAuthorsHistory',
        active: '.active',
        authorName: '.author-name',
        authorsList: '.authors-list',
        authorHistory: '.author-history',
        backToList: '.back-to-list',
        historyResults: '.history-results',
        resultMessage: '.result-message'
      },
      classes: {
        active: 'active',
        loading: 'loading',
        expanded: 'expanded',
        correspondingAuthor: 'corresponding-author'
      },
      init: function init() {
        authorsHistory.$container = $(authorsHistory.selectors.rootElement);
        authorsHistory.$list = authorsHistory.$container.find(authorsHistory.selectors.authorsList);
        authorsHistory.$history = authorsHistory.$container.find(authorsHistory.selectors.authorHistory);
        authorsHistory.$back = authorsHistory.$container.find(authorsHistory.selectors.backToList);
        authorsHistory.author = authorsHistory.$list.find('.active button').data('index');
        authorsHistory.additionalInit();
        authorsHistory.responsive();
        authorsHistory.controller();
        if (authorsHistory.author) authorsHistory.loadHistory();
      },
      additionalInit: function additionalInit() {},
      controller: function controller() {
        authorsHistory.$list.on('click', 'button', function (e) {
          e.preventDefault();
          if (!$(this).closest('li').hasClass(authorsHistory.classes.active)) authorsHistory.on.selectAuthor($(this));
        });
        authorsHistory.$back.on('click', function () {
          authorsHistory.on.mobileHistoryHide();
        });
      },
      responsive: function responsive() {
        $(document).on(authorsHistory.vPort + '-on', function () {
          authorsHistory.isMobile = true;
          authorsHistory.$list.find('li').removeClass(authorsHistory.classes.active);
        });
        $(document).on(authorsHistory.vPort + '-off', function () {
          authorsHistory.isMobile = false;
        });
      },
      on: {
        selectAuthor: function selectAuthor($this) {
          if (typeof $this === "string") {
            authorsHistory.author = $this;
          } else if ($this instanceof jQuery) {
            // toggle active element
            authorsHistory.$list.find(authorsHistory.selectors.active).removeClass(authorsHistory.classes.active);
            $this.closest('li').addClass(authorsHistory.classes.active); // get author data
  
            authorsHistory.author = $this.data('index');
          } else {
            return;
          }
  
          authorsHistory.loadHistory();
  
          if (authorsHistory.isMobile) {
            this.mobileHistoryShow();
          }
        },
        mobileHistoryShow: function mobileHistoryShow() {
          var author = authorsHistory.$list.find('[data-index="' + authorsHistory.author + '"]');
          var $authName = authorsHistory.$history.find(authorsHistory.selectors.authorName);
          $authName.text(author.text());
          if (author.closest("li").hasClass(authorsHistory.classes.correspondingAuthor)) $authName.addClass(authorsHistory.classes.correspondingAuthor);
          authorsHistory.$container.addClass(authorsHistory.classes.expanded);
        },
        mobileHistoryHide: function mobileHistoryHide() {
          var $authName = authorsHistory.$history.find(authorsHistory.selectors.authorName);
          $authName.text('');
          $authName.removeClass(authorsHistory.classes.correspondingAuthor);
          authorsHistory.$container.removeClass(authorsHistory.classes.expanded);
          authorsHistory.$list.find('li').removeClass(authorsHistory.classes.active);
        }
      },
      loadHistory: function loadHistory() {
        authorsHistory.render.loading(true);
        $.ajax({
          url: authorsHistory.ajaxUrl,
          data: {
            authorName: authorsHistory.author
          },
          success: authorsHistory.render.renderSuccess,
          error: function error(_error) {
            authorsHistory.render.message(authorsHistory.errorMsg);
          },
          complete: function complete() {
            authorsHistory.render.loading(false);
          }
        });
      },
      render: {
        renderSuccess: function renderSuccess(res) {
          if (res.data && res.data.length) {
            authorsHistory.render.table(res.data);
          } else {
            authorsHistory.render.message(authorsHistory.noResultsMsg);
          }
        },
        message: function message(str, context) {
          var $historyResults = authorsHistory.$history.find(authorsHistory.selectors.historyResults);
          var $resultMessage = authorsHistory.$history.find(authorsHistory.selectors.resultMessage);
          $historyResults.hide();
          $historyResults.find('tbody').html('');
  
          if (typeof context === "string") {
            $resultMessage.addClass('text-' + context);
          }
  
          $resultMessage.find('span').text(str);
          $resultMessage.show();
        },
        row: function row(rowData) {
          if (rowData) {
            var $target = authorsHistory.$history.find(authorsHistory.selectors.historyResults).find('tbody');
            var markup = "<tr>";
            if (rowData.state === "Approved") markup += '<td data-thead="Title"><a href="/doi/' + rowData.doi + '">' + rowData.title + '</a></td>';else markup += '<td data-thead="Title">' + rowData.title + '</td>';
            markup += '<td data-thead="Type">' + rowData.type + '</td>';
            markup += '<td data-thead="Submit Date">' + rowData.submitDate + '</td>';
            markup += '<td data-thead="Status">' + rowData.state + '</td>';
            markup += '</tr>';
            $target.append(markup);
          }
        },
        table: function table(historyItems) {
          var $historyResults = authorsHistory.$history.find(authorsHistory.selectors.historyResults);
          authorsHistory.$history.find(authorsHistory.selectors.resultMessage).hide();
          $historyResults.find('tbody').html('');
  
          if (historyItems) {
            historyItems.forEach(function (item) {
              authorsHistory.render.row(item);
            });
          }
  
          $historyResults.show();
        },
        loading: function loading(state) {
          if (state === true) {
            authorsHistory.$container.addClass(authorsHistory.classes.loading);
          } else {
            authorsHistory.$container.removeClass(authorsHistory.classes.loading);
          }
        }
      }
    };
    UX.authorsHistory = authorsHistory;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/author-history/js/mimicked-author-history.js":
  /*!**********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/author-history/js/mimicked-author-history.js ***!
    \**********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    UX.authorsHistory.ajaxUrl = '//127.0.0.1:8080/specs/ux3/widgets/author-history/js/history-ajax-sample.json'; //'/action/authorSubmissions',
  
    UX.authorsHistory.loadHistory = function () {
      UX.authorsHistory.render.loading(true);
      $.ajax({
        url: UX.authorsHistory.ajaxUrl,
        data: {
          authorName: UX.authorsHistory.author
        },
        success: UX.authorsHistory.render.renderSuccess,
        error: function error(_error) {
          UX.authorsHistory.render.message(UX.authorsHistory.errorMsg);
        },
        complete: function complete() {
          setTimeout(function () {
            UX.authorsHistory.render.loading(false);
          }, 500);
        }
      });
    };
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/author-index/js/author-index.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/author-index/js/author-index.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (UX) {
    var authorIndex = {
      selectors: {
        authorIndexAlphanumeric: '.author-index__alphanumeric',
        alphanumericTitle: '.alphanumeric-title',
        alphanumericTitleSelected: '.alphanumeric-title.is--selected'
      },
      classes: {
        isSelected: 'is--selected'
      },
      html: {
        letter: '<span class="letter">%letter%</span>'
      },
      init: function init() {
        authorIndex.on.build();
      },
      on: {
        build: function build() {
          var selectedLetter = authorIndex.get.letter('alphabetRange');
  
          if (selectedLetter && selectedLetter !== null) {
            var selectedLetterLink = authorIndex.selectors.alphanumericTitle + '[title=' + selectedLetter + ']';
            document.querySelector(selectedLetterLink).classList.add(authorIndex.classes.isSelected);
            var finalHtml = authorIndex.html.letter.replace('%letter%', selectedLetter);
            document.querySelector(authorIndex.selectors.authorIndexAlphanumeric).insertAdjacentHTML('beforeend', finalHtml);
          }
        }
      },
      get: {
        letter: function letter(name) {
          name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
          var regexS = "[\\?&]" + name + "=([^&#]*)";
          var regex = new RegExp(regexS);
          var results = regex.exec(location.href);
          return results == null ? null : results[1];
        }
      }
    };
    UX.authorIndex = authorIndex; // add to global namespace
  })(UX);
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/cookie-policy-popup/js/cookie-policy-popup.js":
  /*!***********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/cookie-policy-popup/js/cookie-policy-popup.js ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var cookiePolicyPopupWidget = {
      $element: $('.cookiePolicy-popup'),
      acceptUrl: '/action/cookiePolicy?response=accept',
      init: function init() {
        cookiePolicyPopupWidget.control();
      },
      control: function control() {
        cookiePolicyPopupWidget.additionalControl();
        cookiePolicyPopupWidget.$element.on('click', '.cookiePolicy-popup__close, #accept-cookie-policy', function (e) {
          e.preventDefault();
          $.get(cookiePolicyPopupWidget.acceptUrl, function () {
            console.log("Cookies Accepted!");
          });
          cookiePolicyPopupWidget.$element.slideUp('fast', function () {
            cookiePolicyPopupWidget.$element.remove();
            cookiePolicyPopupWidget.cookieRemoved(); // @TODO: This fix is to be removed after the fix that Haitham Athamneh will apply
  
            if (UX.coolbar) {
              UX.coolbar.headerHeight = $('header').outerHeight() || 0;
              $('.coolBar--res').addClass('trans').css('top', UX.coolbar.headerHeight);
            }
  
            if (UX.pageBody && UX.pageBody.on && UX.pageBody.on.setContentTopPadding) {
              UX.pageBody.on.setContentTopPadding(true);
            }
          });
        });
      },
      cookieRemoved: function cookieRemoved() {},
      additionalControl: function additionalControl() {}
    };
    UX.cookiePolicyPopupWidget = cookiePolicyPopupWidget;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/device-pairing/js/device-pairing.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/device-pairing/js/device-pairing.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var devicePairing = {
      $pairedDevicesTable: $(".device-pairing__devices table"),
      $noPairedDevicesResult: $(".device-pairing__devices .no-result"),
      $pairingHistoryTable: $(".device-pairing__history table"),
      pairingHistoryTableRow: '.device-pairing__history tbody tr',
      $noPairedDevicesHistoryResult: $(".device-pairing__history .no-result"),
      $instAdminUnpairSelectedBtn: $("#instAdminUnpairSelected"),
      $instAdminUnpairAllBtn: $("#instAdminUnpairAll"),
      $unpairDialogForm: $("#unpairDevicesDialogForm"),
      selectedDevicesArray: [],
      $deviceSelectedList: $(".device-pairing__selectedList"),
      $unpairButtonsPanel: $(".unpairButtonsPanel"),
      paginationContainer: '.device-pairing__pagination',
      widgetId: $("#widgetId").text(),
      pbContext: encodeURI($("[name='pbContext']").attr("content")),
      $selectEmailInstButton: $(".selectEmailInstButton"),
      $confirmAddEmailButton: $('.confirmAddEmailButton'),
      $continueInstButton: $('.continueInstButton'),
      isInstitutionMode: $('.dp-institution-template').length > 0,
      clientPagination: null,
      init: function init() {
        if (!$('.device-pairing-demo').length) {
          devicePairing.initialization();
        }
  
        devicePairing.clientPagination = jQuery.extend(true, {}, UX.clientPagination);
        devicePairing.clientPagination.set.containerName(devicePairing.paginationContainer);
        devicePairing.clientPagination.set.tableRowName(devicePairing.pairingHistoryTableRow);
        devicePairing.clientPagination.init();
        devicePairing.control();
        devicePairing.additionalControl();
      },
      initialization: function initialization() {
        if (devicePairing.$pairedDevicesTable.length > 0) {
          if (devicePairing.isInstitutionMode) {
            $.get("/pb/widgets/ux3/DevicePairingManagementController/pairedDevicesOfUser?widgetId=" + devicePairing.widgetId + "&pbContext=" + devicePairing.pbContext, {
              serviceName: $(".serviceNameHidden").text(),
              userEmail: $(".userEmailHidden").text()
            }).done(function (html) {
              devicePairing.on.fillPairedDevicesTable(html);
            }).fail(function (jqXHR, textStatus, errorThrown) {
              devicePairing.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
          } else {
            $.get("/pb/widgets/ux3/DevicePairingController/pairedDevices?widgetId=" + devicePairing.widgetId + "&pbContext=" + devicePairing.pbContext, {}).done(function (html) {
              devicePairing.on.fillPairedDevicesTable(html);
            }).fail(function (jqXHR, textStatus, errorThrown) {
              devicePairing.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
          }
        }
  
        if (devicePairing.$pairingHistoryTable.length > 0) {
          $.get("/pb/widgets/ux3/DevicePairingManagementController/pairingHistory?widgetId=" + devicePairing.widgetId + "&pbContext=" + devicePairing.pbContext, {
            serviceName: $(".serviceNameHidden").text(),
            userEmail: $(".userEmailHidden").text()
          }).done(function (html) {
            if (html.indexOf("device-pairing__row") >= 0) {
              devicePairing.$pairingHistoryTable.find("tbody").html(html);
              devicePairing.$pairingHistoryTable.trigger("update");
              devicePairing.clientPagination.buildPagination();
              devicePairing.$pairingHistoryTable.removeClass('hidden');
              devicePairing.$noPairedDevicesHistoryResult.addClass('hidden');
            } else {
              devicePairing.$pairingHistoryTable.addClass('hidden');
              devicePairing.$noPairedDevicesHistoryResult.removeClass('hidden');
            }
          }).fail(function (jqXHR, textStatus, errorThrown) {
            devicePairing.on.displayErrorDialog("error occure on the server : " + errorThrown);
          });
        }
      },
      control: function control() {
        $body.on('change', '.institutionId-radio', function (e) {
          devicePairing.$continueInstButton.prop("disabled", false);
        });
        $body.on('change', '.instEmailSelected-checkbox', function (e) {
          if ($("input[name=instEmailSelected]:checked").length > 0) {
            devicePairing.$selectEmailInstButton.prop("disabled", false);
          } else {
            devicePairing.$selectEmailInstButton.prop("disabled", true);
          }
        });
        $body.on('keyup', '.instEmailSelected-textbox', function (e) {
          $(".device-pairing__add-instEmail .error").addClass('hidden');
  
          if ($(this).val() != '') {
            if (!devicePairing.check.isValidEmail($(this).val())) devicePairing.$confirmAddEmailButton.prop("disabled", true);else devicePairing.$confirmAddEmailButton.prop("disabled", false);
          } else {
            devicePairing.$confirmAddEmailButton.prop("disabled", true);
          }
        });
        $body.on('focusout', '.instEmailSelected-textbox', function (e) {
          if ($(this).val() != '') {
            if (!devicePairing.check.isValidEmail($(this).val())) {
              $(".device-pairing__add-instEmail .error").removeClass('hidden');
            } else {
              devicePairing.$confirmAddEmailButton.prop("disabled", false);
            }
          }
        });
        $body.on('change', 'input[name=deviceId]', function (e) {
          if ($("input[name=deviceId]:checked").length > 0) {
            devicePairing.$instAdminUnpairSelectedBtn.prop("disabled", false);
          } else {
            devicePairing.$instAdminUnpairSelectedBtn.prop("disabled", true);
          }
        });
        $body.on('click', '#instAdminUnpairSelected', function (e) {
          e.preventDefault();
          devicePairing.selectedDevicesArray = [];
          devicePairing.$deviceSelectedList.empty();
          devicePairing.$pairedDevicesTable.find("input[name='deviceId']:checked").each(function () {
            devicePairing.selectedDevicesArray.push($(this).attr('id'));
            devicePairing.$deviceSelectedList.append("<li>" + $(this).val() + "</li>");
          });
        });
        $body.on('click', '#instAdminUnpairAll', function (e) {
          e.preventDefault();
          devicePairing.selectedDevicesArray = [];
          devicePairing.$deviceSelectedList.empty();
          devicePairing.$pairedDevicesTable.find("input[name='deviceId']").each(function () {
            devicePairing.selectedDevicesArray.push($(this).attr('id'));
            devicePairing.$deviceSelectedList.append("<li>" + $(this).val() + "</li>");
          });
        });
        $body.on('click', '#ConfirmUnpairDevices', function (e) {
          e.preventDefault();
  
          if (devicePairing.isInstitutionMode) {
            $.get("/pb/widgets/ux3/DevicePairingManagementController/unpairSelected?widgetId=" + devicePairing.widgetId + "&pbContext=" + devicePairing.pbContext, {
              serviceName: $(".serviceNameHidden").text(),
              userEmail: $(".userEmailHidden").text(),
              devices: JSON.stringify(devicePairing.selectedDevicesArray),
              antiForgeryToken: $(".antiForgeryToken").text()
            }).done(function (html) {
              devicePairing.on.fillPairedDevicesTable(html);
            }).fail(function (jqXHR, textStatus, errorThrown) {
              devicePairing.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
          } else {
            $.get("/pb/widgets/ux3/DevicePairingController/unpairSelected?widgetId=" + devicePairing.widgetId + "&pbContext=" + devicePairing.pbContext, {
              devices: JSON.stringify(devicePairing.selectedDevicesArray)
            }).done(function (html) {
              devicePairing.on.fillPairedDevicesTable(html);
            }).fail(function (jqXHR, textStatus, errorThrown) {
              devicePairing.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
          }
  
          devicePairing.selectedDevicesArray = [];
          devicePairing.$unpairDialogForm.modal('toggle');
        });
      },
      additionalControl: function additionalControl() {},
      on: {
        fillPairedDevicesTable: function fillPairedDevicesTable(html) {
          devicePairing.$pairedDevicesTable.find("tbody").html(html);
          devicePairing.$pairedDevicesTable.trigger("update");
          devicePairing.$instAdminUnpairSelectedBtn.prop("disabled", true);
  
          if (html.indexOf("device-pairing__row") >= 0) {
            devicePairing.$pairedDevicesTable.removeClass('hidden');
            devicePairing.$unpairButtonsPanel.removeClass('hidden');
            devicePairing.$noPairedDevicesResult.addClass('hidden');
          } else {
            devicePairing.$pairedDevicesTable.addClass('hidden');
            devicePairing.$unpairButtonsPanel.addClass('hidden');
            devicePairing.$noPairedDevicesResult.removeClass('hidden');
          }
        },
        displayErrorDialog: function displayErrorDialog(message) {
          $("#devicePairingError").find(".message").html(message);
          $("#devicePairingError").modal('toggle');
        }
      },
      check: {
        isValidEmail: function isValidEmail(value) {
          var emailPattern = /^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i;
  
          if (!emailPattern.test(value)) {
            return false;
          }
  
          return true;
        }
      }
    };
    UX.devicePairing = devicePairing;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/disable-adblocker/js/disable-adblocker.js":
  /*!*******************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/disable-adblocker/js/disable-adblocker.js ***!
    \*******************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var disableAdblocker = {
      init: function init() {
        disableAdblocker.set.variables();
  
        if (disableAdblocker.hasAdBlock() && disableAdblocker.displayPopup()) {
          disableAdblocker.$modal.modal('show');
          disableAdblocker.controls();
        }
      },
      set: {
        variables: function variables() {
          disableAdblocker.$modal = $('#DisableAdBlocker');
          disableAdblocker.isUserLogedin = document.querySelector('.pb-page') && document.querySelector('.pb-page').hasAttribute('data-pb-user-name') ? true : false;
          disableAdblocker.adblockerContinueBtn = document.querySelector('.disable-adblocker__continue-btn');
          disableAdblocker.adblockerDisableBtn = document.querySelector('.disable-adblocker__disable-btn');
          disableAdblocker.adblockerActionsBack = document.querySelectorAll('.actions__back');
        }
      },
      controls: function controls() {
        disableAdblocker.adblockerDisableBtn.addEventListener('click', function (e) {
          disableAdblocker.slideContent(e, '-100%');
        });
        disableAdblocker.adblockerContinueBtn.addEventListener('click', function () {
          disableAdblocker.isUserLogedin ? localStorage.setItem('hideAdBlock', true) : sessionStorage.setItem('hideAdBlock', true);
        });
        disableAdblocker.adblockerActionsBack.forEach(function (elem) {
          elem.addEventListener('click', function (e) {
            disableAdblocker.slideContent(e, '0');
          });
        });
      },
      hasAdBlock: function hasAdBlock() {
        var t = document.createElement('div');
        t.innerHTML = '&nbsp;', t.className = 'adsbox pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads adglare-ad-server text-ad-links';
        var e = !(t.style = 'width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;');
  
        try {
          document.body.appendChild(t);
          var a = document.getElementsByClassName('adsbox')[0];
  
          if (0 !== a.offsetHeight && 0 !== a.clientHeight || (e = !0), void 0 !== window.getComputedStyle) {
            var d = window.getComputedStyle(a, null);
            !d || 'none' != d.getPropertyValue('display') && 'hidden' != d.getPropertyValue('visibility') || (e = !0);
          }
  
          document.body.removeChild(t);
        } catch (a) {}
  
        return e;
      },
      displayPopup: function displayPopup() {
        return disableAdblocker.isUserLogedin ? !localStorage.getItem('hideAdBlock') : !sessionStorage.getItem('hideAdBlock');
      },
      slideContent: function slideContent(e, value) {
        e.preventDefault();
        e.stopImmediatePropagation();
        document.querySelector('.disable-adblocker__content').style.transform = "translateX(".concat(value, ")");
        document.querySelector('.disable-adblocker__instructions').style.transform = "translateX(".concat(value, ")");
      },
      openTab: function openTab(evt, tabContentId) {
        var tabcontent = document.querySelectorAll('.tabcontent');
        var blockers = document.querySelectorAll('.blocker-list .blocker button');
        tabcontent.forEach(function (tab) {
          tab.style.display = 'none';
        });
        blockers.forEach(function (blocker) {
          blocker.classList.remove('active');
        });
        document.getElementById(tabContentId).style.display = 'block';
        evt.currentTarget.classList.add('active');
      }
    };
    UX.disableAdblocker = disableAdblocker;
    document.addEventListener('DOMContentLoaded', function () {
      if (document.getElementById('DisableAdBlocker')) {
        UX.disableAdblocker.init();
      }
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/exam-certificate/js/exam-certificate.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/exam-certificate/js/exam-certificate.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var examCertificate = {
      $body: $('body'),
      $examCertificateMessage: $('.exam-certificate-message'),
      printCertificate: function printCertificate() {
        examCertificate.$body.empty();
        examCertificate.$body.append(examCertificate.$examCertificateMessage);
        window.print();
      }
    };
    UX.examCertificate = examCertificate; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/export-citations/js/export-citations.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/export-citations/js/export-citations.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var exportCitation = {
      $toggle: $('#citation-format'),
      $target: $('.csl-response'),
      $wrapper: null,
      $multiToggle: $('.issue-Item__checkbox:checked'),
      // overwrite its value based on product html structure
      dois: null,
      $trigger: null,
      response: null,
      selectCiteStyle: null,
      responseFormat: {},
      citationLimited: false,
      citationLimitNumber: 0,
      loadingAdditionalInfo: '',
      init: function init() {
        exportCitation.control();
      },
      control: function control(url, params, dataType) {
        $(document).on('click', '[data-target="#exportCitation"]', function () {
          exportCitation.$trigger = $(this);
          exportCitation.resetPopup(exportCitation.$trigger);
          exportCitation.dois = exportCitation.collectDois(exportCitation.$trigger).toString();
          exportCitation.loadCiteProc(exportCitation.$toggle);
        });
        $(document).on('change', '#citation-format', function () {
          exportCitation.loadCiteProc($(this));
        });
        $(document).on('click', '.download__btn', function (e) {
          exportCitation.downloadCiteProc($(this));
        });
      },
      getWarningMessage: function getWarningMessage(message) {
        return message;
      },
      performServerSideAjax: function performServerSideAjax(url, params, selectCiteStyle) {
        $.ajax({
          url: url,
          data: params,
          async: true,
          success: function success(response) {
            exportCitation.response = response;
            exportCitation.responseFormat[selectCiteStyle] = exportCitation.response;
            exportCitation.setContent(exportCitation.responseFormat[selectCiteStyle].content);
          }
        });
      },
      collectDois: function collectDois($el) {
        var doisArray = [];
        var multiDois = false;
  
        if ($el.hasClass('export-citation')) {
          multiDois = true;
        }
  
        if (multiDois) {
          exportCitation.$multiToggle = $('.issue-Item__checkbox:checked');
          exportCitation.$multiToggle.each(function () {
            var $this = $(this);
            var doiValue = $this.attr('name') === 'doi' ? $this.val() : $this.attr('name');
            doisArray.push(doiValue);
          });
        } else {
          $el.find('[name="doiVal"]').each(function () {
            doisArray.push($(this).val());
          });
        }
  
        return doisArray;
      },
      loadCiteProc: function loadCiteProc($el) {
        exportCitation.selectCiteStyle = $el.val();
        var selectedFormat = $('[value=' + exportCitation.selectCiteStyle + ']').data('format'),
            targetCustomCSLFIle = 'custom-' + exportCitation.selectCiteStyle;
        $('#export-warning').empty();
        exportCitation.$wrapper = $el.closest('.csl-wrapper');
        exportCitation.$target = exportCitation.$wrapper.find('.csl-response');
  
        if (exportCitation.selectCiteStyle) {
          exportCitation.$wrapper.find('.copy__btn, .download__btn').addClass('disabled').parent('li').css('cursor', ''); //add spinner
  
          var loadingText = "Loading " + exportCitation.loadingAdditionalInfo + "... ";
          exportCitation.$target.html('<span>' + loadingText + '</span>');
          var action_server = '/action/exportCiteProcCitation'; // var action_server = '/specs/ux3/widgets/export-citations/js/dummy-csl-metaData.json'; // dummy for UX3 testing
          //var action_server = '/specs/products/acm/widgets/export-citations/js/dummy-csl-metaData.json'; // dummy for ACM testing
  
          var params = exportCitation.setParams(targetCustomCSLFIle, selectedFormat);
  
          if (typeof exportCitation.responseFormat[exportCitation.selectCiteStyle] !== 'undefined') {
            exportCitation.setContent(exportCitation.responseFormat[exportCitation.selectCiteStyle].content);
          } else {
            exportCitation.performServerSideAjax(action_server, params, exportCitation.selectCiteStyle);
          }
  
          exportCitation.$wrapper.find('[name="dois"]').val(exportCitation.dois);
          exportCitation.$wrapper.find('[name="format"]').val(selectedFormat);
        }
      },
      setParams: function setParams(targetCustomCSLFIle, selectedFormat) {
        return {
          dois: exportCitation.dois,
          targetFile: targetCustomCSLFIle,
          format: selectedFormat
        };
      },
      resetPopup: function resetPopup($el) {
        exportCitation.$target.html('');
        exportCitation.responseFormat = {};
        exportCitation.$toggle.prop('selectedIndex', 0);
        var $modal = $($el.attr('data-target'));
        $modal.find('.copy__btn, .download__btn').addClass('disabled').parent('li').css('cursor', '');
      },
      setContent: function setContent(content) {
        exportCitation.$target.html(content);
        exportCitation.$wrapper.find('[name="content"]').val(exportCitation.$target.text());
        exportCitation.$wrapper.find('.copy__btn, .download__btn').removeClass('disabled').parent('li').css('cursor', 'pointer');
  
        if (exportCitation.responseFormat[exportCitation.selectCiteStyle].warning) {
          exportCitation.$wrapper.find('#export-warning').html(exportCitation.getWarningMessage(exportCitation.responseFormat[exportCitation.selectCiteStyle].warning));
        }
      },
      downloadCiteProc: function downloadCiteProc($el) {
        var downloadContainer = exportCitation.$target,
            downloadData = '';
  
        if (downloadContainer.is('.csl-response')) {
          if (exportCitation.$target.find('.csl-right-inline').length) {
            downloadContainer = exportCitation.$target.find('.csl-right-inline');
            downloadData = downloadContainer.html();
          } else if (exportCitation.$target.find('.csl-entry').length) {
            downloadContainer = exportCitation.$target.find('.csl-entry');
            downloadData = downloadContainer.html();
          }
  
          if (downloadContainer.length > 1) {
            var downloadMultiText = '';
            downloadContainer.each(function () {
              downloadMultiText += $(this).html() + '\n\n';
            });
            downloadData = downloadMultiText;
          }
        }
  
        $el.attr('href', 'data:' + exportCitation.responseFormat[exportCitation.selectCiteStyle].contentType + ';charset=utf-8,' + encodeURIComponent(downloadData));
        $el.attr('download', exportCitation.responseFormat[exportCitation.selectCiteStyle].fileName + '.' + exportCitation.responseFormat[exportCitation.selectCiteStyle].suffix);
      }
    };
    UX.exportCitation = exportCitation; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/favorites/js/favorites.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/favorites/js/favorites.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var favorites = {
      actions_select: ".favoritePublicationsOptions",
      sort_select: ".sortOptions",
      actions_activator: ".js__favActions",
      sort_activator: ".js__favSort",
      tabs_nav: '.account-tab__nav a',
      $body: $('body'),
      lastModfied: '',
      vPort: '',
      type: 'Article',
      init: function init() {
        favorites.controller();
        favorites.updateSortingLinks(), favorites.addEventsToActions();
        favorites.additionalController();
        favorites.manipulateUrl();
      },
      controller: function controller() {
        favorites.$body.on('click', favorites.actions_activator, function () {
          $(this).closest(favorites.actions_select).val($(this).data("value"));
          $(this).closest(favorites.actions_select).trigger("change");
        });
        favorites.$body.on('click', '[name="markall"]', function (e) {
          var $target = $(this).parents('form').find('tbody .table__mark'),
              $target_input = $target.find('[type="checkbox"]'),
              $target_jcf_span = $target.find('.jcf-checkbox'),
              check = $(this).prop('checked');
          $target_input.prop('checked', check);
  
          if (check) {
            $target_jcf_span.removeClass('jcf-unchecked');
            $target_jcf_span.addClass('jcf-checked');
          } else {
            $target_jcf_span.removeClass('jcf-checked');
            $target_jcf_span.addClass('jcf-unchecked');
          }
        });
        favorites.$body.on('click', favorites.tabs_nav, function () {
          favorites.type = $(this).attr('data-type');
          sessionStorage.setItem('activeTab', this.getAttribute('href'));
          favorites.updateSortingLinks();
        });
      },
      additionalController: function additionalController() {},
      addEventsToActions: function addEventsToActions() {
        $(favorites.actions_select).change(function () {
          favorites.fav_actions(this);
        });
      },
      error_msg: function error_msg() {
        alert('Please select one publication at least');
      },
      fav_actions: function fav_actions(el) {
        if (!$('input[type=checkbox][name="doi"]:checked').length) {
          favorites.error_msg();
          $(el).val('');
          return;
        }
  
        var val = $(el).val();
        var form = $(el).parents("form");
        var action = '';
        if (!val) return;
  
        if (val == 'alert') {
          action = '/action/doUpdateAlertSettings';
          $('option[value=' + val + ']', el).val('addJournalBookAlert');
        } else if (val == 'delete') {
          action = form.attr('action');
        } else if (val == 'publicationAddJournalBookAlert') {
          action = '/action/doUpdateAlertSettings';
          $('option[value=' + val + ']', el).val('addJournalBookAlert');
          $("input[type=checkbox][name=doi]").each(function () {
            $(this).val($(el).parent("td").attr("serialDoi"));
          });
        } else {
          action = val;
        }
  
        form.attr('action', action);
        var activeTab = "#" + $(el).closest("li[role='tabpanel']").attr('id');
        sessionStorage.setItem('activeTab', activeTab);
        form.get(0).submit();
      },
      manipulateUrl: function manipulateUrl() {
        var pathname = favorites.getLocationUrl();
        $('[name="href"]').val(pathname);
        var strippedPathname = favorites.stripParam(pathname, 'sortBy');
        $('[name="currentUrl"]').val(strippedPathname);
        var favType = favorites.getParam(pathname, 'type');
  
        if (favType) {
          favorites.type = favType;
  
          if ($(favorites.tabs_nav + "[data-type='" + favType + "']").length) {
            $(favorites.tabs_nav + "[data-type='" + favType + "']").trigger('click');
          }
        }
      },
      getLocationUrl: function getLocationUrl() {
        var pathname = window.location.pathname,
            url = window.location.href,
            originalRequestUri = pathname + url.split(pathname)[1];
        return originalRequestUri;
      },
      stripParam: function stripParam(originalRequestUri, param) {
        var newPathname = '';
        var arr = originalRequestUri.split('&');
        $.each(arr, function (key, value) {
          var indexOfParam = this.indexOf(param);
  
          if (indexOfParam == 0) {
            arr[key] = '';
          }
  
          newPathname += arr[key];
          if (key < arr.length - 1 && indexOfParam != 0) newPathname += '&';
        });
        return newPathname;
      },
      getParam: function getParam(originalRequestUri, param) {
        var arr = originalRequestUri.split('&');
        var type = '';
        $.each(arr, function (key, value) {
          var keyVal = this.split('=');
  
          if (keyVal[0] === param) {
            type = keyVal[1];
            return false;
          }
        });
        return type;
      },
      updateSortingLinks: function updateSortingLinks() {
        var sortLinks = document.querySelectorAll('.favoriteShortlist .sorting-link');
        Array.prototype.forEach.call(sortLinks, function (link) {
          var sortVal = link.dataset.sortId;
          link.href = "/action/showPreferences?menuTab=favorites&sortBy=".concat(sortVal, "&type=").concat(favorites.type);
        });
      }
    };
    UX.favorites = favorites; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/list-of-issues-detailed/js/list-of-issues-accordion.js":
  /*!********************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/list-of-issues-detailed/js/list-of-issues-accordion.js ***!
    \********************************************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.from */ "../../ui-core/node_modules/core-js/modules/es.array.from.js");
  /* harmony import */ var core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.string.iterator */ "../../ui-core/node_modules/core-js/modules/es.string.iterator.js");
  /* harmony import */ var core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! unfetch/polyfill/index */ "../../ui-core/node_modules/unfetch/polyfill/index.js");
  /* harmony import */ var unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var element_closest_polyfill__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! element-closest-polyfill */ "../../ui-core/node_modules/element-closest-polyfill/index.js");
  /* harmony import */ var element_closest_polyfill__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(element_closest_polyfill__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _plugins_accordion_js_accordion__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../plugins/accordion/js/accordion */ "../../ui-core/plugins/accordion/js/accordion.js");
  
  
  
  
  
  var listOfIssuesAccordion = {
    init: function init() {
      var listOfIssuesElements = Array.from(document.querySelectorAll('.loi-accordion, .loi-accordion__nested'));
      listOfIssuesElements.forEach(function (element) {
        // Check which of the accordion to open based on the expanced property in the json.
        var indicesToOpen = element.dataset.expandedChildIndex ? [parseInt(element.dataset.expandedChildIndex)] : []; // If needed you can store the instances of the accordions in window object.
  
        new _plugins_accordion_js_accordion__WEBPACK_IMPORTED_MODULE_4__["default"](element, {
          openMultiplePanels: true,
          // This is used to keep the buttons SEO friendly.
          usingAnchorTagAsTrigger: true,
          openHeadersOnLoad: indicesToOpen,
          openPrefixCallback: listOfIssuesAccordion.getIssues
        });
      });
    },
    urlLocal: "/specs/ux3/widgets/list-of-issues-detailed/templates/list-of-issues-detailed/ajax/respond.html",
    url: function url(widgetId, issueId) {
      return "/pb/widgets/loi/content?widgetId=".concat(widgetId, "&pbContext=").concat(listOfIssuesAccordion.pageContext(), "&id=").concat(issueId);
    },
    pageContext: function pageContext() {
      return encodeURI(document.head.querySelector('[name=pbContext]').content).replace(/#/g, '%23');
    },
    getIssues: function getIssues(container, header, panel) {
      if (panel.children.length > 0) return;
  
      if (container.dataset.ajax === 'true') {
        var parentAccordion = container.closest('.loi-accordion');
        var widgetId = parentAccordion.id;
        var issueId = header.id;
        var defaultLanguage = 'en-US,en;q=0.9';
        var options = {
          headers: {
            'accept-language': document.documentElement.lang || defaultLanguage
          }
        };
        panel.classList.add('loi-loading'); // to test it locally use --> fetch(listOfIssuesAccordion.urlLocal)
  
        fetch(listOfIssuesAccordion.url(widgetId, issueId), options).then(function (res) {
          res.text().then(function (html) {
            panel.classList.remove('loi-loading');
  
            if (panel.childNodes.length) {
              return;
            }
  
            panel.insertAdjacentHTML('afterbegin', document.createTextNode(html).textContent);
          });
        })["catch"](function (err) {
          panel.classList.remove('loi-loading');
          console.error(err);
        });
      }
    }
  };
  listOfIssuesAccordion.init();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/list-of-issues/js/loi.js":
  /*!**************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/list-of-issues/js/loi.js ***!
    \**************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! unfetch/polyfill/index */ "../../ui-core/node_modules/unfetch/polyfill/index.js");
  /* harmony import */ var unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(unfetch_polyfill_index__WEBPACK_IMPORTED_MODULE_0__);
  //Todo:After we remove the old LOI we should clean up this script and remove all code related to old loi
  //IN LIT-257898 I merged list-of-issues-detailed script and add here because list-of-issues-detailed.js  is already was overriding loi.js and it was confusing
  //After we remove list-of-issue folder we should copy this file with cleanup and put it under list-of-issues-detailed and modify the path for all ux3 products
  
  
  (function () {
    //document.activeElement
    var $body = $('body'),
        $window = $(window);
    var loi = {
      $wrapper: null,
      $list: null,
      $loiHolder: null,
      $controls: null,
      $nextBtn: null,
      $prevBtn: null,
      $listItem: null,
      revers: false,
      isTouched: false,
      pointerPosition: 0.0,
      cumulativeShift: 0.0,
      isMobile: false,
      vPort: "screen-sm",
      // default responsive break point
      year: null,
      // holds active year
      widgetId: null,
      // holds widget ID
      pagecontext: null,
      // holds page context
      doi: null,
      // holds DOI
      decade: null,
      // holds decade range
      wrapper: $(".loi-wrapper"),
      targetPane: null,
      url: "/specs/products/ux3/widgets/list-of-issues/templates/list-of-issues/ajax/2009.html",
      isNewLoi: false,
      init: function init() {
        loi.$wrapper = $('.swipe__wrapper');
        loi.$list = $('.loi__list');
        loi.$loiHolder = $('.dropBlock-loi__holder');
        loi.$controls = '<div class="loi-list__controls"><span class="loi__btn--prev"><i class="icon-arrow_l" aria-hidden="true"></i></span><span class="loi__btn--next"><i class="icon-arrow_r" aria-hidden="true"></i></span></div>';
        loi.isNewLoi = $('.loi-wrapper').hasClass('list-of-issues-detailed');
        loi.addtionalInitialization();
        loi.on.build();
        loi.control();
        loi.addtionalControls();
        $window.on('resized', function () {
          loi.on.rebuild();
        });
        $window.load(function () {
          $('.loi__list:visible').each(function () {
            loi.on.recalculate($(this));
          });
        });
        $(".loi__archive").addClass("event-init");
        loi.on.pageLoad();
      },
      addtionalInitialization: function addtionalInitialization() {},
      ajaxResponse: function ajaxResponse() {},
      control: function control() {
        loi.$list.on('click', 'a', function (e) {
          loi.$listItem = $(this);
          loi.on.select();
        });
        $body.on('click', '.loi__btn--prev', function () {
          loi.$prevBtn = $(this);
          loi.on.prev();
        });
        $body.on('click', '.loi__btn--next', function () {
          loi.$nextBtn = $(this);
          loi.on.next();
        });
        $body.on('touchmove', function (e) {
          loi.on.touch.move(e);
        });
        loi.responsiveController();
  
        if (loi.isNewLoi) {
          // check if new loi or its the old one
          loi.setActiveTabsInView();
          $body.on('click', '.list-of-issues-detailed .loi__list a', function (e) {
            //on click call
            e.preventDefault();
  
            var _this = $(this);
  
            var paneSlected = _this.data('target') ? _this.data('target') : _this.attr('href');
  
            if ($(paneSlected).hasClass('nested-tab')) {
              setTimeout(function () {
                //Need to check this code when we remove old loi
                var loiTabNav = '> .loi > .swipe__wrapper .tab__nav';
                loi.on.recalculate($(paneSlected).find(loiTabNav)); // to grab the first nav
  
                $(paneSlected).find('.tab__pane.active').find(loiTabNav).each(function () {
                  loi.on.recalculate($(this)); // to grab the nested navs
                });
              }, 50);
            }
  
            var tabTarget = _this.data('target'),
                currentTab = $(tabTarget),
                innerTabs = currentTab.find('.tab__nav'),
                selectionEnd = currentTab.parents('.loi-wrapper').length && currentTab.parents('.loi-wrapper').data('order') === 'ascendingOrder' ? 'last' : 'first';
  
            if (currentTab.length && innerTabs.length) {
              // find all tabs inside and selected actives
              var activeTabSource = currentTab.find('.tab__nav').find('li:' + selectionEnd + '-of-type a');
              var activeTab = activeTabSource.data('target') ? activeTabSource.data('target') : activeTabSource.attr('href');
              var triggerTarget = $('[data-target=\'' + activeTab + '\'], [href=\'' + activeTab + '\']');
              triggerTarget.click();
              var scrollTarget = triggerTarget.parent().parent().closest('.scroll');
              loi.scrollToActiveLinkInTabList(scrollTarget);
              return;
            }
  
            loi.wrapper = _this.closest('.loi-wrapper');
            loi.get.activeLink(_this);
            loi.set.historyState(_this);
  
            if (loi.link && $('.list-of-issues-detailed').attr('data-ajax') == 'ajax') {
              loi.load.ajax();
            }
          });
        } else {
          // this should be removed once we replace the new loi with the old one
          $body.on('click', '.tab__nav a', function () {
            var _this = $(this);
  
            var paneSlected = _this.data('target') ? _this.data('target') : _this.attr('href');
  
            if ($(paneSlected).hasClass('nested-tab')) {
              setTimeout(function () {
                //Need to check this code when we remove old loi
                var loiTabNav = '> .loi > .swipe__wrapper .tab__nav';
                loi.on.recalculate($(paneSlected).find(loiTabNav)); // to grab the first nav
  
                $(paneSlected).find('.tab__pane.active').find(loiTabNav).each(function () {
                  loi.on.recalculate($(this)); // to grab the nested navs
                });
              }, 50);
            }
          });
          $body.on('click', '.loi__list a', function () {
            loi.wrapper = $(this).closest(".loi-wrapper");
  
            if (loi.wrapper.length === 0) {
              loi.wrapper = $('.loi-wrapper');
            }
  
            if ($(this).closest(".tab__pane").length) {
              loi.get.activeDecade($(this));
              loi.get.year($(this));
            } else {
              loi.get.decade($(this));
              loi.get.activeYear($(this));
            }
  
            loi.get.doi();
            loi.get.pagecontext();
            loi.get.url();
  
            if (loi.wrapper.find(".dropBlock-loi__holder").length) {
              var type = loi.wrapper.find(".dropBlock-loi__holder").attr("data-grouptype");
            } else {
              var type = loi.wrapper.attr("data-grouptype");
            }
  
            if (type == "decade") {
              if (loi.year && loi.decade && loi.pagecontext && loi.doi) {
                loi.load.ajax();
              }
            }
          });
        }
      },
      responsiveController: function responsiveController() {
        $(document).on(loi.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          loi.isMobile = true;
          $('.loi').addClass("loi--res"); // class will be used in our scss (to replace media queries)
  
          $('.loi__banner').addClass("loi--res"); // class will be used in our scss (to replace media queries)
  
          if ($('.corrections-container__label').length > 0) {
            $('.corrections-container__label').addClass('w-slide__btn slide-active');
          }
  
          loi.setActiveTabsInView();
        });
        $(document).on(loi.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          loi.isMobile = false;
          $('.loi').removeClass("loi--res");
          $('.loi__banner').removeClass("loi--res");
  
          if ($('.corrections-container__label').length > 0) {
            $('.corrections-container__label').removeClass('w-slide__btn slide-active');
          }
  
          loi.setActiveTabsInView();
        });
      },
      scrollToActiveLinkInTabList: function scrollToActiveLinkInTabList($tabListScrollElement) {
        setTimeout(function () {
          var $listItem = $tabListScrollElement.find('.tab__nav li.active');
          var isInView = $listItem[0].getBoundingClientRect().left >= $tabListScrollElement[0].getBoundingClientRect().left && $listItem[0].getBoundingClientRect().right <= $tabListScrollElement[0].getBoundingClientRect().right;
  
          if (!isInView) {
            var scrollRightDistanceToEdge = $tabListScrollElement[0].getBoundingClientRect().right - $listItem[0].getBoundingClientRect().right;
            var scrollLeftDistanceToEdge = $listItem[0].getBoundingClientRect().left - $tabListScrollElement[0].getBoundingClientRect().left;
            var scrollLeftValue = scrollLeftDistanceToEdge >= 0 ? $tabListScrollElement.scrollLeft() - scrollRightDistanceToEdge + 20 : $tabListScrollElement.scrollLeft() + scrollLeftDistanceToEdge - 20;
            $tabListScrollElement.animate({
              scrollLeft: scrollLeftValue
            }, 400);
          }
        }, 50);
      },
      setActiveTabsInView: function setActiveTabsInView() {
        loi.$list.filter(':visible').each(function (index, listElm) {
          var scrollTarget = $(listElm).parent();
          loi.scrollToActiveLinkInTabList(scrollTarget);
        });
      },
      addtionalControls: function addtionalControls() {},
      on: {
        select: function select() {
          loi.$list = loi.$listItem.closest('.swipe__wrapper').find('.loi__list');
          loi.$nextBtn = loi.$listItem.closest('.swipe__wrapper').find('.loi__btn--next');
          loi.$prevBtn = loi.$listItem.closest('.swipe__wrapper').find('.loi__btn--prev');
          loi.$scroll = loi.$list.closest('.scroll');
          var thisLinkPosition = loi.$listItem.offset().left;
          var nextButtonPosition = loi.$nextBtn.offset().left;
          var prevButtonPosition = loi.$prevBtn.offset().left;
  
          if (thisLinkPosition > nextButtonPosition - loi.$listItem.outerWidth()) {
            loi.$scroll.stop().animate({
              scrollLeft: '+=' + loi.$listItem.outerWidth()
            }, 500, 'linear', function () {
              loi.on.activeArrows();
            });
          } else if (thisLinkPosition < prevButtonPosition + loi.$prevBtn.outerWidth()) {
            loi.$scroll.stop().animate({
              scrollLeft: '-=' + loi.$listItem.outerWidth()
            }, 500, 'linear', function () {
              loi.on.activeArrows();
            });
          }
        },
        next: function next() {
          loi.$list = loi.$nextBtn.closest('.swipe__wrapper').find('.loi__list');
          loi.$prevBtn = loi.$list.closest('.loi-list__wrapper').find('.loi__btn--prev');
          loi.$scroll = loi.$list.closest('.scroll');
          var screenSize = loi.$scroll.width();
          var shiftSize = screenSize - 20; /// 3;
  
          if (!loi.$nextBtn.hasClass('inactive')) {
            loi.$scroll.stop().animate({
              scrollLeft: '+=' + shiftSize
            }, 500, 'linear', function () {
              loi.on.activeArrows();
            });
          }
        },
        prev: function prev() {
          loi.$list = loi.$prevBtn.closest('.swipe__wrapper').find('.loi__list');
          loi.$nextBtn = loi.$list.closest('.loi-list__wrapper').find('.loi__btn--next');
          loi.$scroll = loi.$list.closest('.scroll');
          var screenSize = loi.$scroll.width();
          var shiftSize = screenSize - 20; /// 3;
  
          loi.$scroll.stop().animate({
            scrollLeft: '-=' + shiftSize
          }, 500, 'linear', function () {
            loi.on.activeArrows();
          });
        },
        touch: {
          move: function move(e) {
            if ($(e.target).closest('.loi__list').length || $(e.target).hasClass('loi__list')) {
              loi.$list = $(e.target).closest('.loi__list');
              loi.$wrapper = $(e.target).closest('.loi-list__wrapper');
              loi.$nextBtn = $(e.target).closest('.loi-list__wrapper').find('.loi__btn--next');
              loi.$prevBtn = $(e.target).closest('.loi-list__wrapper').find('.loi__btn--prev');
              loi.on.activeArrows();
            }
          }
        },
        escape: function escape() {},
        tab: function tab() {},
        tabRevers: function tabRevers() {},
        activeArrows: function activeArrows() {
          loi.$scroll = loi.$list.closest('.scroll');
  
          if (parseInt(loi.$scroll.scrollLeft()) > 0) {
            loi.$prevBtn.removeClass('inactive');
          } else {
            loi.$prevBtn.addClass('inactive');
          }
  
          var sliderSize = loi.$list.width();
          var wrapperSize = loi.$wrapper.width() + 10;
  
          if (parseInt(loi.$scroll.scrollLeft()) > parseInt(sliderSize - wrapperSize)) {
            loi.$nextBtn.addClass('inactive');
          } else {
            loi.$nextBtn.removeClass('inactive');
          }
        },
        build: function build() {
          //setTimeout(function () {
          loi.$wrapper = loi.$list.closest('.swipe__wrapper');
          loi.$wrapper.addClass('loi-list__wrapper');
          loi.$list.each(function (index) {
            var loiListWidth = $(this).width();
  
            if (loiListWidth > loi.$wrapper.width()) {
              $(this).closest('.swipe__wrapper').prepend(loi.$controls);
            }
  
            $('.loi__btn--prev').addClass('inactive');
          }); //}, 250);
  
          loi.$nextBtn = $('.loi__btn--next');
          loi.$prevBtn = $('.loi__btn--prev');
  
          if ($('.journal-home').length) {
            loi.vPort = "screen-md";
          }
        },
        rebuild: function rebuild() {
          $('.loi-list__controls').remove();
          loi.$list = $('.loi__list');
          loi.$list.each(function (index) {
            var loiListWidth = $(this).width();
  
            if (loiListWidth > loi.$wrapper.width()) {
              $(this).closest('.swipe__wrapper').prepend(loi.$controls);
              $('.loi__btn--prev').addClass('inactive');
            } else {
              $(this).closest('.swipe__wrapper').find('.loi-list__controls').remove();
            }
          });
        },
        recalculate: function recalculate(elem) {
          var tabNavWidth = 25;
          elem.find('li').each(function (index) {
            tabNavWidth += $(this).innerWidth();
          });
          elem.width(tabNavWidth);
          loi.$wrapper = elem.closest('.swipe__wrapper').addClass('loi-list__wrapper');
  
          if (tabNavWidth > loi.$wrapper.width()) {
            if (elem.closest('.swipe__wrapper').find('.loi-list__controls').length == 0) {
              elem.closest('.swipe__wrapper').prepend(loi.$controls);
            }
  
            $('.loi__btn--prev').addClass('inactive');
          } else {
            elem.closest('.swipe__wrapper').find('.loi-list__controls').remove();
          }
        },
        pageLoad: function pageLoad() {
          var qs = window.location.search.substr(1);
          var qsParams = {};
          qs.split('&').map(function (param) {
            var keyVal = param.split('=');
            qsParams[keyVal[0]] = keyVal[1];
          });
          loi.$loiHolder.each(function (index, elem) {
            var groupType = $(elem).attr('data-grouptype');
            var $loiBanner = $(elem).prev('.loi__banner-list');
            var notMobile = window.innerWidth > parseInt(UX.grid.screenSm);
  
            if (qsParams.year && notMobile) {
              if (groupType === 'decade') {
                var $yearElem = $('[data-expand=' + qsParams.year + ']', elem);
  
                if ($yearElem.length) {
                  var decadeElemId = $yearElem.closest('li[role=tabpanel]').attr('id');
                  var $decadeElem = $('a[href$=#' + decadeElemId + ']', elem);
                  $('.loi__archive', $loiBanner).trigger('click');
  
                  if ($decadeElem.length) {
                    $decadeElem.trigger('focus').trigger('click');
                  }
  
                  setTimeout(function () {
                    $yearElem.trigger('focus').trigger('click');
                  }, 100);
                }
              } else if (groupType === 'year') {
                $('.loi__archive', $loiBanner).trigger('click');
                $('[data-expand=' + qsParams.year + ']', elem).trigger('focus').trigger('click');
              }
            }
  
            if (qsParams.volume) {
              if (groupType === 'volume') {
                $('.loi__archive', $loiBanner).trigger('click');
                $('[data-expand=' + qsParams.volume + ']', elem).trigger('click');
              }
            }
          });
        }
      },
      load: {
        ajax: function ajax() {
          var liElement = UX.loi.targetPane[0];
  
          if (liElement && liElement.childNodes.length) {
            return;
          }
  
          var tabPane = document.querySelector('.tab__pane');
          var defaultLanguage = 'en-US,en;q=0.9';
          var options = {
            headers: {
              'accept-language': document.documentElement.lang || defaultLanguage
            }
          };
  
          if (loi.isNewLoi) {
            UX.loi.get.doi();
            UX.loi.get.pagecontext();
            UX.loi.get.url();
          }
  
          if (tabPane) {
            tabPane.classList.remove("loading");
            liElement.classList.add("loading");
          }
  
          fetch(UX.loi.url, options).then(function (Response) {
            Response.text().then(function (issue) {
              liElement.innerHTML = issue;
              liElement.classList.remove("loading");
              loi.ajaxResponse();
            });
          })["catch"](function (error) {
            console.error(error);
            liElement.classList.remove("loading");
          });
        }
      },
      get: {
        year: function year(element) {
          // get year from selected
          loi.year = element.find("span").text();
          loi.targetPane = element.attr("href");
        },
        activeDecade: function activeDecade(element) {
          // get active decade based on selected element
          var parent = element.closest(".tab__pane").attr("aria-labelledby");
          loi.decade = $("#" + parent).data("decade") ? $("#" + parent).data("decade") : $("#" + parent).find("span").text();
        },
        decade: function decade(element) {
          // get decade from selected
          loi.decade = element.data("decade") ? element.data("decade") : element.find("span").text();
        },
        activeYear: function activeYear(element) {
          // get active year based in selected element
          var child = element.attr("href");
          loi.year = $(child).find(".loi__list").find(".active").find("span").text();
          loi.targetPane = $(child).find(".loi__list").find(".active").find("a").attr("href");
        },
        url: function url() {
          if (loi.isNewLoi) {
            loi.widgetId = $('.loi-wrapper').attr('data-db-parent-of'); //get widget ID
  
            if (loi.widgetId == undefined) {
              loi.widgetId = loi.wrapper.attr('data-widget-id'); //get widget ID
            }
  
            loi.url = '/pb/widgets/loi/content?widgetId=' + loi.widgetId + '&pbContext=' + loi.pagecontext.replace(/#/g, '%23') + '&id=' + loi.link; // The hash is not encoded in pbContext
          } else {
            //This for old loi it should removed
            loi.widgetId = loi.wrapper.attr("data-db-parent-of"); //get widget ID
  
            if (loi.widgetId == undefined) {
              loi.widgetId = loi.wrapper.attr("data-widget-id"); //get widget ID
            }
  
            loi.url = "/pb/widgets/loi/loiAjax?widgetId=" + loi.widgetId + "&pbContext=" + loi.pagecontext + "&doi=" + loi.doi + "&decadeRange=" + loi.decade + "&yearParam=" + loi.year; // group all needed parameters
          }
        },
        doi: function doi() {
          loi.doi = loi.wrapper.attr("data-journal-doi");
        },
        pagecontext: function pagecontext() {
          loi.pagecontext = encodeURI($("[name='pbContext']").attr("content")); // get page context
        },
        activeLink: function activeLink(element) {
          // clicked item
          if (element.attr('data-url')) {
            var itemLink = element.attr('data-url'),
                targetSource = element.data('target');
            loi.link = itemLink;
            loi.targetPane = $(targetSource);
          } else {
            //Todo:check if this code needed!
            var itemLink = element.attr('href'),
                targetSource = $(itemLink).find('.tab__nav .active a.empty');
            loi.targetPane = targetSource.data('target') ? targetSource.data('target') : targetSource.attr('href');
            loi.link = targetSource.attr('data-url');
          }
        }
      },
      set: {
        historyState: function historyState(element) {
          var href = element.attr('href');
  
          if (href) {
            history.replaceState(null, 'loi history', href);
          }
        }
      },
      check: {
        viewPort: function viewPort() {
          $('.loi').each(function () {
            if ($(this).attr('data-ctrl-res')) {
              loi.vPort = $(this).attr('data-ctrl-res');
            }
          });
        }
      }
    };
    UX.loi = loi; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/manage-alerts/js/manage-alerts.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/manage-alerts/js/manage-alerts.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body'),
        isMobile = false; // variable use to determine if responsive mode is on or off
  
    function createAndAppendInput(name, value, form) {
      var inp = document.createElement("input");
      inp.type = "hidden";
      inp.name = name;
      inp.value = value;
      form.append(inp);
    }
  
    var alerts = {
      $target: null,
      $toggle: null,
      init: function init() {
        alerts.$toggle = $("[name='markall']"); //alerts.on.build();
  
        alerts.control();
        alerts.additionalController();
      },
      control: function control() {
        $body.on('click', '[name="markall"]', function (e) {
          //e.preventDefault();
          alerts.$target = $(this).closest('.alert__list');
  
          if ($(this).closest('#citationAlerts').length) {
            alerts.$target = $('#citationAlerts');
          }
  
          if ($(this).prop('checked')) {
            alerts.$target.find('[type="checkbox"]:not(:checked)').click();
          } else {
            alerts.$target.find('[type="checkbox"]:checked').click();
          }
        });
        $body.on('change', '.alert__freq', function (e) {
          alerts.on.frequency_change($(this));
        });
        $body.on('change', '.alert__sort', function (e) {
          alerts.on.sorting_change($(this));
        });
        $body.on('click', '.js__citActions', function (e) {
          alerts.on.cit_actions_change($(this));
        });
        $body.on('click', '.btn--cancel', function (e) {
          e.preventDefault();
          alerts.on.reset_form($(this));
        });
      },
      additionalController: function additionalController() {},
      on: {
        build: function build() {},
        error_msg: function error_msg() {
          alert('Please select one publication at least');
        },
        frequency_change: function frequency_change($el) {
          var form = $el.parents("form"),
              value = $el.find('select').val();
          form.find("input[name=action]").val(""); //clear the delete field
  
          createAndAppendInput("save", "true", form);
          createAndAppendInput("updateAxa", "true", form);
          form.submit();
        },
        sorting_change: function sorting_change($el) {
          var sortBy = $el.find('select').val();
          var activeTab = "#" + $el.closest("li[role='tabpanel']").attr('id');
          sessionStorage.setItem('activeTab', activeTab);
          $('<form action="/action/showAlertSettings">' + '<input type="hidden" name="type" value="citation" />' + '<input type="hidden" name="menuTab" value="Alerts"/>' + '<input type="hidden" name="sortBy" value="' + sortBy + '"/>' + '</form>').appendTo('body').submit();
        },
        cit_actions_change: function cit_actions_change($el) {
          var form = $el.parents("form"),
              val = $el.attr('data-value');
          if (!val) return;
  
          if (!$('input[type=checkbox][name="citId"]:checked').length) {
            alerts.on.error_msg();
            return;
          }
  
          form.find("input[name=action]").val(val);
          if ($el.parents('.dropBlock__holder').length) UX.dropBlock.on.hide();
          var activeTab = "#" + $el.closest("li[role='tabpanel']").attr('id');
          sessionStorage.setItem('activeTab', activeTab);
          form.get(0).submit();
        },
        reset_form: function reset_form($el) {
          var $form = $el.closest('form');
          $form.trigger('reset');
          $form.find('input[name=pubCode], input[name=markall]').prop('checked', false);
          $form.find('input[name=format][value=T]').prop('checked', true);
        }
      }
    };
    UX.alerts = alerts; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/menu/js/responsive-menu.js":
  /*!****************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/menu/js/responsive-menu.js ***!
    \****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $("body");
    var reponsiveMenu = {
      vPort: "screen-sm",
      elementvPort: null,
      isMobile: false,
      // variable use to determine if responsive mode is on or off
      $menuContainer: $(".responsive-menu-container"),
      leftSectionWidth: null,
      rightSectionWidth: null,
      maxMenuItemWidth: 135,
      $moreDropsown: $('.responsive-menu-nav .menubar > .dropdown-more'),
      $menu: $(".responsive-menu-nav >.drawer__nav"),
      $menuWrapper: $('.responsive-menu-nav'),
      init: function init() {
        reponsiveMenu.elementvPort = reponsiveMenu.vPort;
        reponsiveMenu.vPort = [];
        $(".responsive-menu-container").each(function (index) {
          reponsiveMenu.check.viewPort(index, $(this));
          reponsiveMenu.responsive(index);
        });
        reponsiveMenu.control();
        reponsiveMenu.on.build();
      },
      responsive: function responsive(index) {
        $(document).on(reponsiveMenu.vPort[index] + '-on', function () {
          reponsiveMenu.isMobile = true;
          $(".responsive-menu-container").each(function () {
            if ($(this).data('ctrl-res') === reponsiveMenu.vPort[index]) {
              $(this).addClass("js--disabled-responsive-menu"); // class will be used in our scss (to replace media queries)
            }
          });
        });
        $(document).on(reponsiveMenu.vPort[index] + '-off', function () {
          reponsiveMenu.isMobile = false;
          $(".responsive-menu-container").each(function () {
            if ($(this).data('ctrl-res') === reponsiveMenu.vPort[index]) {
              $(this).removeClass("js--disabled-responsive-menu"); // class will be used in our scss (to replace media queries)
            }
          });
        });
      },
      control: function control() {
        $(window).on('resize', function () {
          reponsiveMenu.modifyMenu();
        });
        $body.on('touchend', '.dropdown-more >a, .dropdown.menu-parent>a ', function (e) {
          if ($(this).parents(".dropdown-more").length > 0 && !$(this).parent().hasClass(".dropdown-more")) {
            $(".responsive-menu-nav .js--opened:not(.dropdown-more)").not($(this).parent()).removeClass('js--opened');
          } else {
            $(".responsive-menu-nav .js--opened").not($(this).parent()).removeClass('js--opened');
          }
  
          $(this).parent().toggleClass('js--opened');
  
          if (!$(this).parent().hasClass('js--opened')) {
            $(this).parent().addClass('js--forceClose');
          } else {
            $(this).parent().removeClass('js--forceClose');
          }
        });
        $body.click(function (e) {
          $('.responsive-menu-nav .js--opened:not(:hover)').removeClass('js--opened');
        });
      },
      on: {
        build: function build() {
          reponsiveMenu.$menuWrapper.show();
          reponsiveMenu.modifyMenu();
          setTimeout(function () {
            reponsiveMenu.modifyMenu();
          }, 800);
        }
      },
      modifyMenu: function modifyMenu() {
        $(".responsive-menu-container").each(function () {
          reponsiveMenu.$menuContainer = $(this);
          reponsiveMenu.$moreDropsown = reponsiveMenu.$menuContainer.find(".dropdown-more");
  
          if (!reponsiveMenu.$menuContainer.hasClass('js--disabled-responsive-menu')) {
            reponsiveMenu.leftSectionWidth = reponsiveMenu.$menuContainer.find(".left-section").width();
            reponsiveMenu.rightSectionWidth = reponsiveMenu.$menuContainer.find(".right-section").width();
            reponsiveMenu.$menu = reponsiveMenu.$menuContainer.find(".drawer__nav");
            reponsiveMenu.$menuWrapper = reponsiveMenu.$menuContainer.find(".responsive-menu-nav");
            var availableMenuWidth = reponsiveMenu.$menuContainer.width() - (reponsiveMenu.leftSectionWidth + reponsiveMenu.rightSectionWidth + 35);
            var menuWidth = reponsiveMenu.$menu.width();
  
            if (availableMenuWidth > 0 && menuWidth > 0) {
              if (menuWidth > availableMenuWidth) {
                while (menuWidth > availableMenuWidth) {
                  var $lastMenuItem = reponsiveMenu.$menu.find('.menubar > [role="menuitem"]:not(.dropdown-more)').last();
  
                  if ($lastMenuItem.length > 0) {
                    reponsiveMenu.$moreDropsown.removeClass('hidden');
                    reponsiveMenu.$moreDropsown.find('>.dropdown__menu').prepend($lastMenuItem[0].outerHTML);
                    $lastMenuItem.remove();
                    menuWidth = reponsiveMenu.$menu.width();
                  } else {
                    break;
                  }
                }
              } else if (availableMenuWidth > menuWidth + reponsiveMenu.maxMenuItemWidth && !reponsiveMenu.$moreDropsown.hasClass('hidden')) {
                while (availableMenuWidth > menuWidth) {
                  var $moreItems = reponsiveMenu.$moreDropsown.find('.dropdown__menu [role="menuitem"]');
                  var $firstMoreItem = $moreItems.first();
  
                  if ($firstMoreItem.length > 0) {
                    reponsiveMenu.$moreDropsown.before($firstMoreItem[0].outerHTML);
  
                    if ($moreItems.length <= 1) {
                      reponsiveMenu.$moreDropsown.addClass('hidden');
                    }
  
                    $firstMoreItem.remove();
                    menuWidth = reponsiveMenu.$menu.width();
                  } else {
                    break;
                  }
                }
  
                if (menuWidth > availableMenuWidth) {
                  reponsiveMenu.modifyMenu();
                }
              }
            }
          } else {
            if (!reponsiveMenu.$moreDropsown.hasClass('hidden')) {
              reponsiveMenu.$moreDropsown.addClass('hidden');
              reponsiveMenu.$moreDropsown.before(reponsiveMenu.$moreDropsown.find('.dropdown__menu').html());
              reponsiveMenu.$moreDropsown.find('.dropdown__menu').empty();
            }
          }
        });
      },
      check: {
        viewPort: function viewPort(index, $el) {
          if (typeof $el.data('ctrl-res') != 'undefined' || $el.data('ctrl-res') == '') {
            reponsiveMenu.vPort[index] = $el.data('ctrl-res');
          } else {
            $el.data('ctrl-res', reponsiveMenu.elementvPort);
            reponsiveMenu.vPort[index] = reponsiveMenu.elementvPort;
          }
        }
      }
    };
    UX.reponsiveMenu = reponsiveMenu; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/multi-search/js/multi-search.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/multi-search/js/multi-search.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        $dropblock__holder,
        $multi_search; // get the 'data-widget-id' attribute from the current generated widget
  
    function getWidgetId(elem) {
      var widgetEl = elem.parents('[data-widget-id]')[0];
      var widgetId = widgetEl ? $(widgetEl).data('widget-id') : '';
      return widgetId;
    } // get The content attribute from the meta tag in the head
  
  
    function getPbContext() {
      var pbContext = $('[name="pbContext"]').attr('content');
      return pbContext ? pbContext : '';
    }
  
    var multiSearch = {
      init: function init() {
        $dropblock__holder = $('.multi-search__dropblock__holder'); //$multi_search = $('.multi-search');
  
        multiSearch.control();
      },
      control: function control() {
        $body.on('click', '.multi-search__dropblock__holder a', function () {
          var el = $(this);
          multiSearch.set.parent(el);
          multiSearch.on.select.dropdown(el);
        });
        $body.on('click', 'a.remove-topic', function () {
          var el = $(this);
          var widgetID = getWidgetId(el);
          multiSearch.set.parent(el);
          multiSearch.topic.remove(widgetID);
        });
      },
      on: {
        select: {
          dropdown: function dropdown(elem) {
            var tagLabel = elem.data('label');
            var tagId = elem.data('value');
            var widgetID = getWidgetId(elem);
            multiSearch.topic.add(tagLabel, tagId, widgetID);
          }
        }
      },
      topic: {
        add: function add(label, id, widgetID) {
          var params = {
            'multiSearchAction': 'applyTopic',
            'tagId': id,
            'tagLabel': label,
            'widgetId': widgetID
          };
          multiSearch.ajax(params);
        },
        remove: function remove(widgetID) {
          var params = {
            'multiSearchAction': 'removeTopic',
            'widgetId': widgetID
          };
          multiSearch.ajax(params);
        },
        lazyload: function lazyload() {
          function lazyLoad() {
            $('.lazy-load').remove();
            $('.delayLoad').removeClass('delayLoad').addClass('delayedLoad');
          }
  
          $('.creative-work .loa').not("[data-truncate='none']").truncate({
            lines: 2,
            type: 'list',
            addClass: 'loa-height'
          });
          $('.card .creative-work .loa').not("[data-truncate='none']").truncate({
            lines: 1,
            type: 'list',
            addClass: 'loa-height'
          });
          setTimeout(lazyLoad, 10);
        }
      },
      set: {
        parent: function parent(elem) {
          $multi_search = $(elem.parents('.multi-search')[0]);
        }
      },
      ajax: function ajax(params) {
        params['pbContext'] = getPbContext();
        $.ajax({
          type: 'GET',
          url: '/pb/widgets/multiSearch/updateTopic',
          dataType: 'html',
          data: params,
          async: true,
          success: function success(html) {
            multiSearch.render(html);
            multiSearch.topic.lazyload();
          },
          error: function error(_error) {
            console.log(_error);
          }
        });
      },
      render: function render(html) {
        $multi_search.html('');
        $multi_search.replaceWith(html);
      }
    };
    UX.multiSearch = multiSearch;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pairing-management/js/pairing-management.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pairing-management/js/pairing-management.js ***!
    \*********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var pairingManagment = {
      widgetId: $("#pairingManagmentWidgetId").text(),
      pbContext: encodeURI($("[name='pbContext']").attr("content")),
      $pairedEmailsTable: $(".pairedEmailsTable"),
      emailsTableRow: ".pairing-management__row",
      paginationContainer: '.pairing-management__pagination',
      clientPagination: null,
      init: function init() {
        pairingManagment.initialization();
        pairingManagment.addtionalInitialization();
        pairingManagment.control();
      },
      initialization: function initialization() {
        pairingManagment.on.setDatePickers();
  
        if (!$(".pairing-management-demo").length) {
          pairingManagment.on.refreshPairedDevices();
        }
  
        pairingManagment.clientPagination = jQuery.extend(true, {}, UX.clientPagination);
        pairingManagment.clientPagination.set.containerName(pairingManagment.paginationContainer);
        pairingManagment.clientPagination.set.tableRowName(pairingManagment.emailsTableRow);
        pairingManagment.clientPagination.init();
      },
      addtionalInitialization: function addtionalInitialization() {},
      control: function control() {
        $body.on('click', '.dateFilter .calendar', function (e) {
          e.preventDefault();
          $(this).siblings('.datepicker').datepicker('show');
        });
        $body.on('click', pairingManagment.paginationContainer + ' .prev, ' + pairingManagment.paginationContainer + ' .next, ' + pairingManagment.paginationContainer + ' .page', function (e) {
          e.preventDefault();
          $("input[name=userEmail]").prop("checked", false);
          pairingManagment.on.disableActionButtons();
        });
        $body.on('click', '#refreshButton', function (e) {
          e.preventDefault();
          pairingManagment.on.refreshPairedDevices();
        });
        $body.on('click', '#addExternalEmailButton', function (e) {
          e.preventDefault();
          pairingManagment.clear.dialog($("#externalEmailDialogForm"));
        });
        $body.on('click', '#confirmAddExternalEmail', function (e) {
          e.preventDefault();
          pairingManagment.on.addExternalEmail();
        });
        $body.on('click', '#confirmExtendReinstate', function (e) {
          e.preventDefault();
          pairingManagment.on.extendReinstateEmail();
        });
        $body.on('click', '#confirmRevokeAccess', function (e) {
          e.preventDefault();
          pairingManagment.on.revokeEmail();
        });
        $("#viewDetailButton").click(function () {
          var userEmail = $("input[name=userEmail]:checked").attr("id");
          $(this).closest("form").append("<input type='hidden' name='userEmail' value='" + userEmail + "'/>");
        });
        $body.on('click', '#extendReinstateButton', function (e) {
          e.preventDefault();
          pairingManagment.clear.dialog($("#extendReinstateAccessDialogForm"));
          var selectedEmail = $("input[name=userEmail]:checked").val();
          $("#extendEmail").val(selectedEmail);
        });
        $body.on('click', '#revokeButton', function (e) {
          e.preventDefault();
          pairingManagment.clear.dialog($("#revokeAccessDialogForm"));
          var selectedEmail = $("input[name=userEmail]:checked").val();
          $("#revokeAccessEmail").val(selectedEmail);
        });
        $body.on('change', 'input[name=userEmail]', function (e) {
          $("#extendReinstateButton").prop("disabled", false);
          $("#revokeButton").prop("disabled", false);
          $("#viewDetailButton").prop("disabled", false);
          $('.pairing-management__actions .withSelected').removeClass('disabled');
        });
      },
      check: {
        expirationDays: function expirationDays(expirationDaysField) {
          // validate expiration days to ensure it is an integer
          var intRegex = /^\d+$/;
  
          if (!intRegex.test(expirationDaysField.val())) {
            expirationDaysField.addClass("ui-state-error");
            return false;
          }
  
          return true;
        },
        reason: function reason(reasonField) {
          // ensure reason field has text
          if (!reasonField.val()) {
            reasonField.addClass("ui-state-error");
            return false;
          }
  
          return true;
        },
        email: function email(emailField) {
          //ensure email field isn't empty
          if (!emailField.val() || $.trim($(emailField).val()).length == 0) {
            emailField.addClass("ui-state-error");
            return false;
          }
  
          return true;
        }
      },
      clear: {
        dialog: function dialog($dialog) {
          $dialog.find('input').removeClass('ui-state-error').val('');
          $dialog.find('.expdays').val('180');
        },
        filters: function filters() {
          // reset email filter
          $("input[name=emailFilter]").prop("checked", function () {
            return this.getAttribute("checked") == "checked";
          }); // reset permission filter
  
          $("input[name=permissionFilter]").prop("checked", function () {
            return this.getAttribute("checked") == "checked";
          }); // reset the text input filters
  
          $("input[name=emailAddress]").val("");
          $("input[name=name]").val("");
          pairingManagment.on.setDatePickers();
        }
      },
      on: {
        setDatePickers: function setDatePickers() {
          var fromDateElement = $("#fromDate");
          var toDateElement = $("#toDate");
          fromDateElement.datepicker({
            defaultDate: "-1w",
            numberOfMonths: 1,
            onClose: function onClose(selectedDate) {
              $("#toDate").datepicker("option", "minDate", selectedDate);
            }
          });
          fromDateElement.datepicker("setDate", "-180d");
          toDateElement.datepicker({
            defaultDate: "+0",
            numberOfMonths: 1,
            onClose: function onClose(selectedDate) {
              $("#fromDate").datepicker("option", "maxDate", selectedDate);
            }
          });
          toDateElement.datepicker("setDate", "+1d");
        },
        addExternalEmail: function addExternalEmail() {
          var addExtEmailEmailField = $("#addExternalEmail");
          var addExtEmailExpDaysField = $("#addExternalEmailExp");
          var addExtEmailReasonField = $("#addExternalEmailReason");
          var valid = true;
          valid = valid && pairingManagment.check.email(addExtEmailEmailField);
          valid = valid && pairingManagment.check.expirationDays(addExtEmailExpDaysField);
          valid = valid && pairingManagment.check.reason(addExtEmailReasonField);
  
          if (valid) {
            $.get("/pb/widgets/ux3/DevicePairingManagementController/addExternalEmail?widgetId=" + pairingManagment.widgetId + "&pbContext=" + pairingManagment.pbContext, {
              serviceName: $(".serviceNameHidden").text(),
              email: addExtEmailEmailField.val(),
              daysToExpiration: addExtEmailExpDaysField.val(),
              reason: addExtEmailReasonField.val(),
              antiForgeryToken: $(".antiForgeryToken").text()
            }).done(function (html) {
              // check if the response html is not an error page
              if (html.indexOf("externalEmailError") == -1) {
                pairingManagment.$pairedEmailsTable.find("tbody").html(html);
                pairingManagment.$pairedEmailsTable.trigger("update");
                pairingManagment.on.disableActionButtons();
                pairingManagment.clientPagination.buildPagination();
                pairingManagment.clear.filters();
              } else {
                // error trying to add external email
                pairingManagment.on.displayErrorDialog(html);
              }
            }).fail(function (jqXHR, textStatus, errorThrown) {
              pairingManagment.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
            $("#externalEmailDialogForm").modal("toggle");
          }
        },
        extendReinstateEmail: function extendReinstateEmail() {
          var extendReinstateEmailField = $("#extendEmail");
          var extendReinstateExpDaysField = $("#extendEmailExp");
          var extendReinstateReasonField = $("#extendEmailReason");
          var valid = true;
          valid = valid && pairingManagment.check.expirationDays(extendReinstateExpDaysField);
          valid = valid && pairingManagment.check.reason(extendReinstateReasonField);
          var selectedEmail = extendReinstateEmailField.val();
  
          if (valid) {
            $.get("/pb/widgets/ux3/DevicePairingManagementController/extendReinstateEmail?widgetId=" + pairingManagment.widgetId + "&pbContext=" + pairingManagment.pbContext, {
              serviceName: $(".serviceNameHidden").text(),
              extendReinstateEmail: selectedEmail,
              daysToExpiration: extendReinstateExpDaysField.val(),
              reason: extendReinstateReasonField.val(),
              // need to send the current filter options as well, so that we maintain the same filters
              emailFilter: $('input[name=emailFilter]:checked').attr("id"),
              permissionFilter: $('input[name=permissionFilter]:checked').attr("id"),
              emailAddress: $('input[name=emailAddress]').val(),
              name: $('input[name=name]').val(),
              fromDate: $('input[name=fromDate]').val(),
              toDate: $('input[name=toDate]').val(),
              antiForgeryToken: $(".antiForgeryToken").text()
            }).done(function (html) {
              pairingManagment.$pairedEmailsTable.find("tbody").html(html);
              pairingManagment.$pairedEmailsTable.trigger("update");
              pairingManagment.clientPagination.buildPagination();
              $("input[value=" + "'" + selectedEmail + "'" + "]").prop("checked", true);
            }).fail(function (jqXHR, textStatus, errorThrown) {
              pairingManagment.on.displayErrorDialog("error occure on the server : " + errorThrown);
            });
            $("#extendReinstateAccessDialogForm").modal("toggle");
          }
        },
        revokeEmail: function revokeEmail() {
          var revokeEmailField = $("#revokeAccessEmail");
          var revokeReasonField = $("#revokeAccessReason");
          var selectedEmail = revokeEmailField.val();
          $.get("/pb/widgets/ux3/DevicePairingManagementController/revokeAccess?widgetId=" + pairingManagment.widgetId + "&pbContext=" + pairingManagment.pbContext, {
            serviceName: $(".serviceNameHidden").text(),
            revokeEmail: selectedEmail,
            reason: revokeReasonField.val(),
            // need to send the current filter options as well, so that we maintain the same filters
            emailFilter: $('input[name=emailFilter]:checked').attr("id"),
            permissionFilter: $('input[name=permissionFilter]:checked').attr("id"),
            emailAddress: $('input[name=emailAddress]').val(),
            name: $('input[name=name]').val(),
            fromDate: $('input[name=fromDate]').val(),
            toDate: $('input[name=toDate]').val(),
            antiForgeryToken: $(".antiForgeryToken").text()
          }).done(function (html) {
            pairingManagment.$pairedEmailsTable.find("tbody").html(html);
            pairingManagment.$pairedEmailsTable.trigger("update");
            pairingManagment.clientPagination.buildPagination();
            $("input[value=" + "'" + selectedEmail + "'" + "]").prop("checked", true);
          }).fail(function (jqXHR, textStatus, errorThrown) {
            pairingManagment.on.displayErrorDialog("error occure on the server : " + errorThrown);
          });
          $("#revokeAccessDialogForm").modal("toggle");
        },
        refreshPairedDevices: function refreshPairedDevices() {
          $.get("/pb/widgets/ux3/DevicePairingManagementController/institutionPairedDevices?widgetId=" + pairingManagment.widgetId + "&pbContext=" + pairingManagment.pbContext, {
            serviceName: $(".serviceNameHidden").text(),
            emailFilter: $('input[name=emailFilter]:checked').attr("id"),
            permissionFilter: $('input[name=permissionFilter]:checked').attr("id"),
            emailAddress: $('input[name=emailAddress]').val(),
            name: $('input[name=name]').val(),
            fromDate: $('input[name=fromDate]').val(),
            toDate: $('input[name=toDate]').val()
          }).done(function (html) {
            pairingManagment.$pairedEmailsTable.find("tbody").html(html);
            pairingManagment.$pairedEmailsTable.trigger("update");
            pairingManagment.on.disableActionButtons();
            pairingManagment.clientPagination.buildPagination();
          }).fail(function (jqXHR, textStatus, errorThrown) {
            pairingManagment.on.displayErrorDialog("error occure on the server : " + errorThrown);
          });
        },
        disableActionButtons: function disableActionButtons() {
          $("#extendReinstateButton").prop("disabled", true);
          $("#revokeButton").prop("disabled", true);
          $("#viewDetailButton").prop("disabled", true);
          $('.pairing-management__actions .withSelected').addClass('disabled');
        },
        displayErrorDialog: function displayErrorDialog(message) {
          $("#externalEmailError").find(".message").html(message);
          $("#externalEmailError").modal('toggle');
        }
      }
    };
    UX.pairingManagment = pairingManagment; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pcm-add-library/js/pcm-add-library.js":
  /*!***************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pcm-add-library/js/pcm-add-library.js ***!
    \***************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  window.addEventListener("message", receiveMessage, false);
  
  function receiveMessage(event) {
    //Todo check for cross origin
    var eData = event.data,
        $pcmBtn = $('#pcm_add_Ctrl');
  
    if (eData) {
      if (eData.type == 'library-item-status') {
        if (eData.status) {
          //Item in Library
          $pcmBtn.addClass('added');
        } else {
          //Item is not in Library
          $pcmBtn.removeClass('added');
        }
      }
    }
  }
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-action-bar/js/mimicked-pd-action-bar.js":
  /*!********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-action-bar/js/mimicked-pd-action-bar.js ***!
    \********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  UX.pdActionBar.on.build = function () {
    var $autocomplete = $(".ux-modal-container").find(".ux3-autocomplete");
  
    if (typeof $autocomplete.autocomplete !== 'undefined') {
      $autocomplete.autocomplete({
        source: function source(request, response) {
          $.ajax({
            url: "https://jsonplaceholder.typicode.com/posts",
            dataType: "json",
            data: {
              query: request.term
            },
            success: function success(data) {
              response($.map(data, function (el) {
                return {
                  label: el.title,
                  value: el.title,
                  id: el.id
                };
              }));
            }
          });
        },
        minLength: 2,
        open: function open() {
          $(".ui-menu.ui-autocomplete").width($(this).innerWidth());
        },
        select: function select(event, ui) {
          $("[name='submitted-to']").val(ui.item.id);
        }
      });
    }
  };
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-action-bar/js/pd-action-bar.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-action-bar/js/pd-action-bar.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var pdActionBar = {
      actionBarSelector: ".pd-action-bar",
      defaultCommentsSelector: ".js-defaultComments",
      btnSubmit: "[data-action]",
      btnRedirect: "[data-redirect]",
      confirmationHTML: "<div class=\"toast toast--success\"><i aria-hidden=\"true\" class=\"icon-check\"></i><div class=\"toast__text\">You have successfully submitted the article</div> </div>",
      validReferrer: "/action/showDraft",
      init: function init() {
        pdActionBar.controller();
        pdActionBar.on.build();
  
        if (window.performance && performance.navigation.type == 0) {
          var documentReferrer = document.referrer;
  
          if (documentReferrer) {
            var urlDocumentReferrer = new URL(documentReferrer);
            var urlDocumentLocation = new URL(document.location);
  
            if (urlDocumentLocation.hash == "#submission-successful" && urlDocumentReferrer.pathname == pdActionBar.validReferrer) {
              this.showConfirmation(urlDocumentLocation.pathname);
            }
          }
        }
      },
      controller: function controller() {
        $body.on('click', pdActionBar.btnSubmit, function (e) {
          e.preventDefault();
          var target = e.target;
          var $target = $(target);
  
          if (target.tagName === "BUTTON") {
            if ($target.is(".btn--reject") && !pdActionBar.validateRejectReasons()) {
              return false;
            }
  
            var $form = $(pdActionBar.actionBarSelector).find("form");
            $form.attr("action", $target.attr("data-action"));
            $form.submit();
          }
        });
        $body.on('click', pdActionBar.btnRedirect, function (e) {
          e.preventDefault();
          var target = e.target;
  
          if (target.tagName === "BUTTON") {
            window.location = $(target).attr("data-redirect");
          }
        });
        var $defaultComments = $(pdActionBar.defaultCommentsSelector);
  
        if ($defaultComments.length) {
          var target = $defaultComments.data("comment-target");
          var $target = $(target);
          $defaultComments.on('change', "[type='radio']", function (e) {
            // enable button
            var $submitCommentBtn = $defaultComments.closest('.modal__dialog').find(pdActionBar.btnSubmit);
            $submitCommentBtn.prop('disabled', !$defaultComments.find(':checked').length);
            $target.prop('disabled', !$defaultComments.find(':checked').length);
            var text = $(this).data("comment-default");
            var updated = $(this).data('comment-changed');
  
            if (updated != false) {
              $target.val(updated);
            } else {
              $target.val(text);
            }
  
            $target.focus();
          });
          $target.on('keyup', function () {
            var $selected = $defaultComments.find("[type='radio']:checked");
            var newVal = $(this).val();
            $selected.data('comment-changed', newVal);
            $selected.attr('data-comment-changed', newVal);
          });
        }
      },
      on: {
        build: function build() {
          //initialize jqueru ui autocomplete
          var $autocomplete = $(".ux-modal-container").find(".ux3-autocomplete");
          $autocomplete.autocomplete({
            source: function source(request, response) {
              $.ajax({
                url: $autocomplete.data("url"),
                dataType: "json",
                data: {
                  query: request.term
                },
                success: function success(data) {
                  response($.map(data, function (el) {
                    return {
                      label: el.label,
                      value: el.label,
                      id: el.value
                    };
                  }));
                }
              });
            },
            open: function open() {
              $(".ui-menu.ui-autocomplete").width($(this).innerWidth());
            },
            minLength: 2,
            select: function select(event, ui) {
              $("[name='submitted-to']").val(ui.item.id);
            }
          });
        }
      },
      showConfirmation: function showConfirmation(redirectionUrl) {
        var el = $(".pdActionBar");
        var delay = 3000;
  
        if (el) {
          el.prepend(pdActionBar.confirmationHTML);
          var timeoutID = window.setTimeout(function () {
            $(".toast").fadeOut();
            document.location = redirectionUrl;
          }, delay);
        }
      },
      validateRejectReasons: function validateRejectReasons() {
        var $defaultComments = $(pdActionBar.defaultCommentsSelector),
            $target = $($defaultComments.data("comment-target")),
            $defaultCommentsError = $defaultComments.closest('.input-group').find('.error'),
            $targetError = $target.closest('.input-group').find('.error');
        var pass = true;
        $defaultCommentsError.addClass('hidden');
        $targetError.addClass('hidden');
        $target.removeClass('not-valid');
  
        if (!$defaultComments.find("[name='rejection-reason']:checked").length) {
          $defaultCommentsError.removeClass('hidden');
          pass = false;
        }
  
        if ($target.val().trim() === "") {
          $target.addClass('not-valid');
          $targetError.removeClass('hidden');
          pass = false;
        }
  
        return pass;
      }
    };
    UX.pdActionBar = pdActionBar; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-authors/js/mimicked-pd-authos.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-authors/js/mimicked-pd-authos.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  UX.submissionAuthors.on.doSuggest = function () {
    var affilationMagicSuggest = UX.submissionAuthors.$modal.find('.aff-magicsuggest'); // $(UX.submissionAuthors.authorAjaxLink).attr("href", '//localhost:8080/specs/ux3/widgets/pd-authors/js/orcid-author.json');
  
    UX.submissionAuthors.affilationMagicSuggest = affilationMagicSuggest.magicSuggest({
      data: [{
        "value": "0001",
        "label": "Test Inst"
      }, {
        "value": "0002",
        "label": "AAA Inst"
      }],
      method: 'GET',
      valueField: 'value',
      autoSelect: false,
      allowFreeEntries: false,
      displayField: 'label',
      hideTrigger: 'true',
      useCommaKey: false,
      mode: "remote"
    });
  };
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-authors/js/pd-authors.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-authors/js/pd-authors.js ***!
    \*****************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ "../../ui-core/node_modules/@babel/runtime/helpers/toConsumableArray.js");
  /* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _plugins_polyfills_js_Element_closest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/polyfills/js/Element/closest */ "../../ui-core/plugins/polyfills/js/Element/closest.js");
  /* harmony import */ var _plugins_polyfills_js_Element_matches__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/polyfills/js/Element/matches */ "../../ui-core/plugins/polyfills/js/Element/matches.js");
  /* harmony import */ var _plugins_polyfills_js_Element_matches__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_Element_matches__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _plugins_polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/polyfills/js/Element/remove */ "../../ui-core/plugins/polyfills/js/Element/remove.js");
  /* harmony import */ var _plugins_polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_Element_remove__WEBPACK_IMPORTED_MODULE_3__);
  
  
  
  
  
  (function () {
    var $body = $('body');
    var submissionAuthors = {
      list: [],
      affiliationsValues: '.td-affiliations-val',
      $affiliationsInputTemplate: $('.affiliationsInputTemplate'),
      affilationMagicSuggest: null,
      $affiliationsAjaxLink: $('#affiliationAjaxLink'),
      authorAjaxLink: '.authorAjaxLink',
      $container: $('.submission-authors'),
      $affiliationsTypes: $('.affiliations-types'),
      affilationsSplitter: '|#|',
      errText: 'Field is missing',
      errEmailText: 'Please enter a valid email address',
      classes: {
        notValid: 'not-valid'
      },
      selectors: {
        noValid: '.not-valid',
        error: '.error'
      },
      init: function init() {
        this.modal.init('#authors-modal');
        this.table.init('.authors__table', '.submission-authors .rowTemplate tr');
        this.controller();
      },
      saveAuthorsToArray: function saveAuthorsToArray() {
        var _this = this;
  
        // Save all Authors into array for later use
        submissionAuthors.list = [];
        this.table.rows().forEach(function (row) {
          var fullName = $(row).find("".concat(_this.table.tds.name, " .td-text")).text() + ' ' + $(row).find("".concat(_this.table.tds.lastName, " .td-text")).text();
          submissionAuthors.list.push(fullName);
        });
  
        if (UX.funders.fillAuthors) {
          UX.funders.fillAuthors();
        }
  
        $(document).trigger('autosave');
      },
      controller: function controller() {
        $body.on('click', submissionAuthors.authorAjaxLink, submissionAuthors.handlers.getAuthor);
        $body.on('click', '#saveAuthor', submissionAuthors.handlers.authorSave);
        $body.on('click', '#addAuthor', submissionAuthors.handlers.authorAdd);
        $body.on('click', '.submission-authors .delete', submissionAuthors.handlers.authorDelete);
        $body.on('click', '.submission-authors .edit', submissionAuthors.handlers.authorEdit);
        this.table.tableElem.addEventListener('click', submissionAuthors.handlers.toggleCorresponding);
        submissionAuthors.nextController();
      },
      nextController: function nextController() {},
  
      /**
       * fixme: THIS HAS BEEN DISABLED DUE TO LIT-232173 AND IT MAY BE RETURNED SOMEDAY
       */
      saveAffiliations: function saveAffiliations() {
        var affiliationsValue = '';
        var affiliationsText = '';
        var $affiliationsValue = $('[name="author-affilation[]"]');
        var $affiliationsText = $('#author-affilation .ms-sel-item');
        var affiliationsHiddenInputs = '';
        var affiliationsTypes = submissionAuthors.$affiliationsTypes.text().split(',');
        $affiliationsValue.each(function (index) {
          var affValue = $(this).val();
  
          if ($(this).val() == $($affiliationsText[index]).text()) {
            affValue = 'text';
          } else if (affiliationsTypes[index] !== '') {
            if (affiliationsTypes[index] === 'text') affValue = 'text';else {
              var affType = submissionAuthors.getAffiliationsType(affiliationsTypes[index], $(this).val());
              affValue = affType + '|' + $(this).val();
            }
          } else {
            affValue = 'isni|' + $(this).val();
          }
  
          affValue += '|' + $($affiliationsText[index]).text();
          affiliationsValue += affValue + submissionAuthors.affilationsSplitter;
          affiliationsHiddenInputs += submissionAuthors.$affiliationsInputTemplate.html().replace(/\{\{0\}\}/gi, affValue).replace(/\{\{1\}\}/gi, rowNum).replace(/fakedinput/gi, 'input');
        });
        $affiliationsText.each(function (index) {
          affiliationsText += $(this).text();
          if (index != $affiliationsText.length - 1) affiliationsText += ', ';
        });
        if (affiliationsValue != '') affiliationsValue = affiliationsValue.substring(0, affiliationsValue.lastIndexOf(submissionAuthors.affilationsSplitter));
      },
      handlers: {
        getAuthor: function getAuthor(e) {
          e.preventDefault();
          submissionAuthors.modal.validation_message = '';
  
          if (submissionAuthors.modal.$orcid.val() === '') {
            submissionAuthors.modal.validation_message = 'Please enter ORCID number';
          } else {
            var url = $(submissionAuthors.authorAjaxLink).attr('href') + '?orcid=' + submissionAuthors.modal.$orcid.val();
            $.ajax({
              type: 'GET',
              url: url,
              success: function success(data) {
                if (data) {
                  var emptyRes = Object.keys(data).length === 0 && data.constructor === Object;
  
                  if (emptyRes) {
                    submissionAuthors.modal.validation_message = 'No results from ORCID server';
                  }
  
                  if (data.message && data.message.text) {
                    submissionAuthors.modal.validation_message = data.message.text;
                  } //fill inputs with json data
  
  
                  var aff_names = [];
  
                  if (data.author) {
                    if (data.author.affiliations && data.author.affiliations.length > 0) {
                      data.author.affiliations.forEach(function (item) {
                        if (item.name) aff_names.push(item.name);
                      });
                    }
  
                    submissionAuthors.modal.fields = {
                      'name': data.author.firstName,
                      'lastName': data.author.lastName,
                      'affiliations': aff_names.join(','),
                      'email': data.author.email
                    };
                  }
                } else {
                  submissionAuthors.modal.validation_message = 'Error occurred when check ORCID in the server';
                }
              },
              error: function error(e) {
                submissionAuthors.modal.validation_message = 'Error occurred when check ORCID in the server';
              }
            });
          }
        },
        toggleCorresponding: function toggleCorresponding(e) {
          if (!e.target.matches(".corresponding-toggle") && !e.target.closest(".corresponding-toggle")) return;
          e.preventDefault();
          var new_row = e.target.closest('.author__row');
          submissionAuthors.table.changeCorresponding(new_row);
          $(document).trigger('autosave');
        },
        authorAdd: function authorAdd(e) {
          e.preventDefault();
          submissionAuthors.on.beforeValidate();
          submissionAuthors.$affiliationsTypes.text('');
          submissionAuthors.modal.clear();
          submissionAuthors.modal.title = 'Add Author';
          submissionAuthors.modal.mode = 'add';
          submissionAuthors.modal.row_number = submissionAuthors.table.rows(true).length;
          submissionAuthors.modal.toggle();
        },
        authorSave: function authorSave(e) {
          e.preventDefault();
          submissionAuthors.on.beforeValidate();
  
          if (submissionAuthors.on.validate()) {
            var rowNum = submissionAuthors.modal.row_number;
  
            if (submissionAuthors.modal.mode === 'add') {
              //add new row
              submissionAuthors.table.add_row(rowNum, submissionAuthors.modal.fields);
            } else {
              //edit row
              submissionAuthors.table.update_row(rowNum, submissionAuthors.modal.fields);
            }
  
            submissionAuthors.modal.toggle(true);
            submissionAuthors.saveAuthorsToArray();
          }
        },
        authorDelete: function authorDelete(e) {
          e.preventDefault();
          var authorRow = e.target.closest('tr');
          submissionAuthors.table.destroy(authorRow);
          submissionAuthors.saveAuthorsToArray();
        },
        authorEdit: function authorEdit(e) {
          e.preventDefault();
          var $this = $(e.target);
          submissionAuthors.on.beforeValidate();
          var rowNumber = $this.closest('tr').data('row-num');
          submissionAuthors.modal.mode = 'edit';
          submissionAuthors.modal.row_number = rowNumber;
          submissionAuthors.modal.validation_message = ' ';
          submissionAuthors.modal.fields = submissionAuthors.table.extract_values(e.target.closest("tr"));
          submissionAuthors.modal.title = 'Edit Author';
          submissionAuthors.modal.toggle();
        }
      },
      getAffiliationsType: function getAffiliationsType(text, val) {
        var affArray = text.split(',');
        var type = '';
        $.each(affArray, function (i, arrayVal) {
          if (arrayVal.indexOf(val) >= 0) {
            type = arrayVal.replace(val + '=', '');
            return false;
          }
        });
        return type;
      },
      getAffiliationsSelectedItems: function getAffiliationsSelectedItems(values) {
        var selectedValues = [];
  
        if (values) {
          var valuesArr = values.split(submissionAuthors.affilationsSplitter);
          $.each(valuesArr, function (i, arrayVal) {
            var itemvals = arrayVal.split('|');
  
            if (itemvals[0] == 'text') {
              selectedValues.push({
                label: itemvals[1],
                value: itemvals[1]
              });
            } else {
              selectedValues.push({
                label: itemvals[2],
                value: itemvals[1]
              });
            }
          });
        }
  
        return selectedValues;
      },
      getAffiliationsTypes: function getAffiliationsTypes($row) {
        var $affiValus = $row.find('.affiliations__hidden-inputs input');
        var types = '';
        $affiValus.each(function (index) {
          if ($(this).val().indexOf('|') >= 0) {
            if ($(this).val().split('|')[0] != 'text') {
              types += $(this).val().split('|')[1] + '=' + $(this).val().split('|')[0] + ',';
            }
          }
        });
        if (types !== '') types = types.slice(0, -1);
        return types;
      },
      on: {
        doSuggest: function doSuggest() {
          var affilationMagicSuggest = submissionAuthors.modal.find('.aff-magicsuggest');
          submissionAuthors.affilationMagicSuggest = affilationMagicSuggest.magicSuggest({
            data: submissionAuthors.$affiliationsAjaxLink.val(),
            method: 'GET',
            valueField: 'value',
            autoSelect: false,
            allowFreeEntries: false,
            mode: 'remote',
            displayField: 'label',
            hideTrigger: 'true',
            useCommaKey: false
          });
        },
        beforeValidate: function beforeValidate() {
          submissionAuthors.modal.find(submissionAuthors.selectors.error).text('');
          submissionAuthors.modal.find(submissionAuthors.selectors.notValid).removeClass(submissionAuthors.classes.notValid);
        },
        validate: function validate() {
          var re = /[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;
          var result = true;
          submissionAuthors.modal.find(submissionAuthors.selectors.error).text('');
          submissionAuthors.modal.find(submissionAuthors.selectors.notValid).removeClass(submissionAuthors.classes.notValid); // required fields
  
          var requiredFields = ['name', 'lastName', 'affiliations', 'email'];
          requiredFields.forEach(function (item) {
            var $field = submissionAuthors.modal["$".concat(item)],
                $error = submissionAuthors.modal["$".concat(item, "_err")];
  
            if ($field.val() === '') {
              submissionAuthors.showError($field, $error, submissionAuthors.errText);
              result = false;
            }
  
            if (item === 'email' && !re.test($field.val())) {
              submissionAuthors.showError($field, $error, submissionAuthors.errEmailText);
              result = false;
            }
          });
          return result;
        }
      },
      showError: function showError($field, $error, message) {
        $field.addClass(this.classes.notValid);
        $error.text(message);
      },
      table: {
        tableElem: null,
        templateRow: null,
        tds: {
          orcid: '.author-orcid-td',
          name: '.author-name-td',
          lastName: '.author-surname-td',
          affiliations: '.author-affiliation-td',
          email: '.author-email-td'
        },
        init: function init(table_selector, row_template) {
          this.tableElem = document.querySelector(table_selector);
          this.templateRow = document.querySelector(row_template);
        },
        add_row: function add_row(row_num, values) {
          var row_html = this.templateRow.outerHTML;
          row_html = row_html.replace(/\{\{0\}\}/gi, values.orcid).replace(/\{\{1\}\}/gi, values.name).replace(/\{\{2\}\}/gi, values.lastName).replace(/\{\{3\}\}/gi, values.affiliations).replace(/\{\{4\}\}/gi, values.email).replace(/\{\{5\}\}/gi, row_num).replace(/fakedinput/gi, "input");
          this.tableElem.querySelector("tbody").insertAdjacentHTML('beforeend', row_html);
  
          if (Array.isArray(values.affiliations)) {
            this.add_affiliations_array(values.affiliations, row_num);
          }
        },
  
        /**
         * @param row_num
         * @return {HTMLElement}
         */
        get_row: function get_row(row_num) {
          return this.tableElem.querySelector("tr[data-row-num=\"".concat(row_num, "\"]"));
        },
        update_row: function update_row(row_num, values) {
          var row = this.get_row(row_num);
  
          for (var tdsKey in this.tds) {
            if (!this.tds.hasOwnProperty(tdsKey) || !values.hasOwnProperty(tdsKey)) continue;
            var td = row.querySelector(this.tds[tdsKey]);
            var input = td.querySelector("input:not(hidden)");
            td.querySelector(".td-text").textContent = values[tdsKey]; // if the affiliations are an array add multiple hidden input
  
            if (tdsKey === "affiliations" && Array.isArray(values[tdsKey])) {
              this.add_affiliations_array(values[tdsKey], row_num);
            } else {
              input.value = values[tdsKey];
            }
          }
  
          row.classList.remove(submissionAuthors.classes.notValid);
          row.closest('.submission-authors').classList.remove(submissionAuthors.classes.notValid);
        },
        add_affiliations_array: function add_affiliations_array(values, row_num) {
          var parentNode = this.get_row(row_num).querySelector(".affiliations__hidden-inputs");
          parentNode.innerHTML = "";
          var input = document.createElement("input");
          input.type = "hidden";
          input.name = "authors[".concat(row_num, "].affiliations[]");
  
          for (var i = 0; i < values.length; i++) {
            var clonedInput = input.cloneNode(true);
            clonedInput.value = values[i];
            parentNode.append(clonedInput);
          }
  
          input.remove();
        },
        destroy: function destroy(row) {
          row.classList.add("deleted", "hidden");
          row.innerHTML = "";
        },
        extract_values: function extract_values(row) {
          var values = {};
  
          for (var tdsKey in this.tds) {
            if (!this.tds.hasOwnProperty(tdsKey)) continue;
            values[tdsKey] = row.querySelector("".concat(this.tds[tdsKey], " .td-text")).html();
          }
  
          return values;
        },
        rows: function rows(withDeleted) {
          var selector = "tbody tr";
          if (!withDeleted) selector += ":not(.deleted)";
          return _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(this.tableElem.querySelectorAll(selector));
        },
        changeCorresponding: function changeCorresponding(newCorresponding) {
          // toggle old corresponding off
          var oldCorresponding = this.tableElem.querySelector(".author__corresponding");
  
          if (oldCorresponding) {
            oldCorresponding.querySelector("[name*='corresponding']").value = "false";
            oldCorresponding.classList.remove("author__corresponding");
  
            var _deleteBtn = oldCorresponding.querySelector(".btn--action.delete");
  
            if (_deleteBtn) _deleteBtn.classList.remove("hidden", "disabled");
          }
  
          newCorresponding.querySelector("[name*='corresponding']").value = "true";
          newCorresponding.classList.add("author__corresponding");
          var deleteBtn = newCorresponding.querySelector(".btn--action.delete");
          if (deleteBtn) deleteBtn.classList.add("hidden", "disabled");
        }
      },
      modal: {
        $modal: null,
        $orcid: null,
        $orcid_err: null,
        $name: null,
        $name_err: null,
        $lastName: null,
        $lastName_err: null,
        $affiliations: null,
        $affiliations_err: null,
        $email: null,
        $email_err: null,
        $modalValidationMessage: null,
        $modalTitle: null,
        init: function init(modal_selector) {
          this.$modal = $(modal_selector);
          this.$orcid = this.$modal.find('#author-orcid');
          this.$orcid_err = this.$modal.find('#author-orcid + .error');
          this.$name = this.$modal.find('#author-name');
          this.$name_err = this.$modal.find('#author-name + .error');
          this.$lastName = this.$modal.find('#author-last-name');
          this.$lastName_err = this.$modal.find('#author-last-name + .error');
          this.$affiliations = this.$modal.find('#author-affilation');
          this.$affiliations_err = this.$modal.find('#author-affilation + .error');
          this.$email = this.$modal.find('#author-email');
          this.$email_err = this.$modal.find('#author-email + .error');
          this.$modalValidationMessage = this.$modal.find('.modal-validation-message');
          this.$modalTitle = this.$modal.find('#authors-modal .modal__header .modal__title');
        },
        find: function find(selector) {
          return this.$modal.find(selector);
        },
  
        set mode(mode) {
          this.find('.mode').val(mode);
        },
  
        /**
         * @return {string}
         */
        get mode() {
          return this.find('.mode').val();
        },
  
        set row_number(row_number) {
          this.find('.row-num').val(row_number);
        },
  
        /**
         * @return {number}
         */
        get row_number() {
          return this.find('.row-num').val();
        },
  
        set title(title) {
          this.$modalTitle.text(title);
        },
  
        set validation_message(message) {
          if (message === "") {
            this.$modalValidationMessage.hide();
          } else {
            this.$modalValidationMessage.show();
          }
  
          this.$modalValidationMessage.text(message);
        },
  
        set_fields: function set_fields(values) {
          if (typeof values['orcid'] !== 'undefined') this.$orcid.val(values['orcid']);
          if (typeof values['name'] !== 'undefined') this.$name.val(values['name']);
          if (typeof values['lastName'] !== 'undefined') this.$lastName.val(values['lastName']);
          if (typeof values['affiliations'] !== 'undefined') this.$affiliations.val(values['affiliations']);
          if (typeof values['email'] !== 'undefined') this.$email.val(values['email']);
        },
        get_fields: function get_fields() {
          return {
            'orcid': this.$orcid.val(),
            'name': this.$name.val(),
            'lastName': this.$lastName.val(),
            'affiliations': this.$affiliations.val(),
            'email': this.$email.val()
          };
        },
  
        set fields(values) {
          this.set_fields(values);
        },
  
        get fields() {
          return this.get_fields();
        },
  
        clear: function clear() {
          this.$orcid.val('');
          this.$name.val('');
          this.$lastName.val('');
          this.$affiliations.val('');
          this.$email.val('');
          this.validation_message = '';
        },
        toggle: function toggle(close) {
          if (close) this.$modal.modal('hide');else this.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'toggle');
        }
      }
    };
    UX.submissionAuthors = submissionAuthors; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-basic-metadata/js/mimicked-pd-basic-metadata.js":
  /*!****************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-basic-metadata/js/mimicked-pd-basic-metadata.js ***!
    \****************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  UX.basicMetadata.autocomplete.sources.journals = function (url, request, response) {
    $.ajax({
      url: 'https://jsonplaceholder.typicode.com/posts',
      dataType: 'json',
      data: {
        query: request.term
      },
      success: function success(data) {
        response($.map(data, function (el) {
          return {
            label: el.title,
            value: el.title,
            id: el.id
          };
        }));
      }
    });
  };
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-basic-metadata/js/pd-basic-metadata.js":
  /*!*******************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-basic-metadata/js/pd-basic-metadata.js ***!
    \*******************************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/polyfills/js/NodeList/forEach */ "../../ui-core/plugins/polyfills/js/NodeList/forEach.js");
  /* harmony import */ var _plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_NodeList_forEach__WEBPACK_IMPORTED_MODULE_0__);
  
  
  (function () {
    var $body = $('body');
    var basicMetadata = {
      posterMeetingName: null,
      typeName: null,
      container: null,
      $additionalInformation: null,
      $submittedInput: null,
      $dateInput: null,
      init: function init() {
        this.posterMeetingName = '.basic-metadata__meeting-name';
        this.$additionalInformation = $('.meeting-additional-information');
        this.typeName = '[name="basic-metadata.type"]'; // this.posterMeetingDate = ".basic-metadata__meeting-date";
  
        this.container = '.basic-metadata';
        this.$submittedInput = $('[name="basic-metadata.preprint-submitted-to"]');
        this.$dateInput = $('input.datepicker');
        basicMetadata.on.build();
        basicMetadata.on.alignDropZones();
  
        if ($(basicMetadata.posterMeetingName).length > 0) {
          basicMetadata.controller();
          basicMetadata.on.handleAdditional();
        }
      },
      on: {
        build: function build() {
          basicMetadata.autocomplete.submittedTo();
          basicMetadata.autocomplete.meetings();
        },
        handleAdditional: function handleAdditional(item) {
          $('.meeting-additional-information__location').text('');
          $('.meeting-additional-information__date').text('');
  
          if (item) {
            $('.meeting-additional-information__location').text(item.location);
            $('.meeting-additional-information__date').text(item.date);
            basicMetadata.$additionalInformation.removeClass('hidden');
          } else {
            basicMetadata.$additionalInformation.addClass('hidden');
          }
        },
        alignDropZones: function alignDropZones() {
          var hasDropZones = document.querySelectorAll('.has-extra-dropzone');
          hasDropZones.forEach(function (item) {
            var textarea = item.querySelector('textarea');
            var dropZone = item.querySelector('.extra-dropzone');
            if (!textarea || !dropZone) return;
  
            var fixItemPadding = function fixItemPadding() {
              if (textarea.scrollHeight > textarea.clientHeight) {
                // has scrollBar
                // set `right` to be the scrollbar width
                dropZone.style.right = textarea.offsetWidth - textarea.clientWidth + 'px';
              } else {
                // does'nt have scrollBar
                dropZone.style.right = 0;
              }
            };
  
            fixItemPadding();
            textarea.addEventListener('keyup', fixItemPadding);
          });
        }
      },
      controller: function controller() {
        $body.on('click', basicMetadata.typeName, function (e) {
          if ($(this).val() == 'poster') {
            $('.poster').show();
            $('.preprint').hide();
          } else {
            $('.poster').hide();
            $('.preprint').show();
          }
        });
        basicMetadata.$dateInput.keyup(function (e) {
          if (e.keyCode == 8 || e.keyCode == 46) {
            $.datepicker._clearDate(this);
          }
        });
      },
      autocomplete: {
        $submittedToAutocomplete: null,
        $meetingsAutocomplete: null,
        submittedTo: function submittedTo() {
          var _this = this;
  
          //initialize jqueru ui autocomplete
          this.$submittedToAutocomplete = $(basicMetadata.container).find('.submittedTo-field.ux3-autocomplete');
          this.$submittedToAutocomplete.autocomplete({
            source: function source(request, response) {
              _this.sources.journals(_this.$submittedToAutocomplete.data('url'), request, response);
            },
            open: function open() {
              $('.ui-menu.ui-autocomplete').width($(this).innerWidth());
            },
            minLength: 2,
            select: function select(event, ui) {
              basicMetadata.$submittedInput.val(ui.item.id);
            },
            change: function change(event, ui) {
              if (!ui.item) basicMetadata.$submittedInput.val('');
            }
          });
        },
        meetings: function meetings() {
          this.$meetingsAutocomplete = $(basicMetadata.container).find('.meetings-field.ux3-autocomplete');
          var $target = $(basicMetadata.container).find('[name="basic-metadata.poster-meeting"]');
          var meetings = this.sources.meetings();
          this.$meetingsAutocomplete.autocomplete({
            source: function source(request, response) {
              var matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), 'i');
              response($.grep(meetings, function (item) {
                return matcher.test(item.label);
              }));
            },
            open: function open() {
              $('.ui-menu.ui-autocomplete').width($(this).innerWidth());
            },
            minLength: 2,
            select: function select(event, ui) {
              $target.val(ui.item.name);
              basicMetadata.on.handleAdditional(ui.item);
            },
            change: function change(event, ui) {
              if (!ui.item) $target.val('');else basicMetadata.on.handleAdditional(ui.item);
            }
          });
        },
        sources: {
          journals: function journals(url, request, response) {
            $.ajax({
              url: url,
              dataType: 'json',
              data: {
                query: request.term
              },
              success: function success(data) {
                response($.map(data, function (el) {
                  return {
                    label: el.label,
                    value: el.label,
                    id: el.value
                  };
                }));
              }
            });
          },
          meetings: function meetings() {
            var meetings = basicMetadata.autocomplete.$meetingsAutocomplete.data('source');
            if (!meetings) return [];
            basicMetadata.autocomplete.$meetingsAutocomplete.data('source', null);
            basicMetadata.autocomplete.$meetingsAutocomplete.removeAttr('data-source');
            return meetings.sort(function (a, b) {
              return a.label > b.label ? 1 : -1;
            });
          }
        }
      }
    };
    UX.basicMetadata = basicMetadata; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-grants/js/funders.js":
  /*!*************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-grants/js/funders.js ***!
    \*************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var funders = {
      magicSuggestData: null,
      $modal: null,
      $modalName: null,
      $modalValidationMessage: null,
      $modalNumber: null,
      $modalRecipient: null,
      $funderAjaxLink: null,
      td1: null,
      td2: null,
      td3: null,
      $table: null,
      $templateRow: null,
      $modalTitle: null,
      magicSuggest: null,
      fundersValues: null,
      $funderInputTemplate: null,
      init: function init() {
        this.$modal = $('#funders-modal');
        this.$funderAjaxLink = $("#funderAjaxLink");
        this.$modalName = $("#funder-name");
        this.$modalNumber = $("#funder-grant-number");
        this.$modalRecipient = $("#funder-recipient");
        this.td1 = ".funder-td";
        this.td2 = ".grant-number-td";
        this.td3 = ".recipient-funder-td";
        this.$modalValidationMessage = $(".modal-validation-message");
        this.$table = $('.funders__table');
        this.$templateRow = $('.funders .rowTemplate tr');
        this.$modalTitle = $("#funders-modal .modal__header .modal__title");
        this.fundersValues = ".td-funders-val";
        this.$funderInputTemplate = $(".funderInputTemplate");
        funders.controller();
        funders.on.doSuggest();
      },
      fillAuthors: function fillAuthors() {
        if (UX.submissionAuthors.list && funders.$modalRecipient) {
          funders.$modalRecipient.find("option").remove();
          var authors = UX.submissionAuthors.list;
          funders.$modalRecipient.append('<option value="Other">Other</option>');
  
          for (var index = 0; index < authors.length; index++) {
            funders.$modalRecipient.append('<option value="' + authors[index] + '">' + authors[index] + '</option>');
          }
  
          if ($(funders.$modalRecipient).length > 0) $(funders.$modalRecipient)[0].selectedIndex = 0;
        }
      },
      controller: function controller() {
        $body.on('click', '#saveFunder', function (e) {
          e.preventDefault();
  
          if (funders.$modalNumber.val() == "" || funders.$modalRecipient.val() == "") {
            funders.$modalValidationMessage.text("Please fill all fields ");
          } else {
            var fundersValue = "";
            var fundersText = "";
            var $fundersValue = $('[name="funder-name[]"]');
            var $fundersText = $('#funder-name .ms-sel-item');
            var rowNum = funders.$modal.find(".row-num").val();
            var funderHiddenInputs = "";
            $fundersValue.each(function (index) {
              fundersValue += $(this).val();
              if (index != $fundersValue.length - 1) fundersValue += ",";
              funderHiddenInputs += funders.$funderInputTemplate.html().replace(/\{\{0\}\}/gi, $(this).val()).replace(/\{\{1\}\}/gi, rowNum).replace(/fakedinput/gi, "input");
            });
            $fundersText.each(function (index) {
              fundersText += $(this).text();
              if (index != $fundersText.length - 1) fundersText += ",";
            });
  
            if (funders.$modal.find(".mode").val() == 'add') {
              //add new row
              var rowHtml = funders.$templateRow[0].outerHTML;
              rowHtml = rowHtml.replace(/\{\{0\}\}/gi, fundersText).replace(/\{\{0_val\}\}/gi, fundersValue).replace(/\{\{0_inputs\}\}/gi, funderHiddenInputs).replace(/\{\{1\}\}/gi, funders.$modalNumber.val()).replace(/\{\{2\}\}/gi, funders.$modalRecipient.val()).replace(/\{\{3\}\}/gi, rowNum).replace(/fakedinput/gi, "input");
              funders.$table.find("tbody").append(rowHtml);
            } else {
              //edit row
              var $rowToEdit = funders.$table.find("tr[data-row-num=" + rowNum + "]");
              var $td1 = $rowToEdit.find(funders.td1);
              $td1.find('.td-text').text(fundersText);
              $td1.find('.funder__hidden-inputs').html(funderHiddenInputs);
              $td1.find(funders.fundersValues).html(fundersValue);
              var $td2 = $rowToEdit.find(funders.td2);
              $td2.find('.td-text').text(funders.$modalNumber.val());
              $td2.find('input').val(funders.$modalNumber.val());
              var $td3 = $rowToEdit.find(funders.td3);
              $td3.find('.td-text').text(funders.$modalRecipient.val());
              $td3.find('input').val(funders.$modalRecipient.val());
            }
  
            funders.$modal.modal('toggle');
            $(document).trigger('autosave');
          }
        });
        $body.on('click', '#addGrant', function (e) {
          e.preventDefault();
          funders.$modal.find(".mode").val('add');
          funders.$modal.find(".row-num").val(funders.$table.find('tbody tr').length);
          funders.magicSuggest.clear();
          funders.$modalNumber.val('');
          $(funders.$modalRecipient)[0].selectedIndex = 0;
          funders.$modalValidationMessage.text('');
          funders.$modalTitle.text('Add Funder');
          funders.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'toggle');
        });
        $body.on('click', '.funders .delete', function (e) {
          e.preventDefault();
          $(this).closest("tr").addClass('deleted hidden');
          $(this).closest("tr").html('');
        });
        $body.on('click', '.funders .edit', function (e) {
          e.preventDefault();
          var rowNumber = $(this).closest("tr").data("row-num");
          funders.$modal.find(".mode").val('edit');
          funders.$modal.find(".row-num").val(rowNumber);
          funders.$modalValidationMessage.text(' ');
          funders.$modalNumber.val($(this).closest("tr").find(funders.td2 + ' .td-text').html());
          var selectedFunders = $(this).closest("tr").find(funders.fundersValues).html().split(",");
          funders.magicSuggest.clear();
          if (selectedFunders != "") funders.magicSuggest.setValue(selectedFunders); //if problem occure here you can use "setSelection" check pd-author.js
  
          var selectedRecipient = $(this).closest("tr").find(funders.td3 + ' .td-text').html();
          var selectRecipientsOptions = $(funders.$modalRecipient).find("option");
          $(funders.$modalRecipient)[0].selectedIndex = 0;
          selectRecipientsOptions.each(function (index, option) {
            if ($(option).val() == selectedRecipient) {
              $(funders.$modalRecipient)[0].selectedIndex = index;
            }
          });
          funders.$modalTitle.text('Edit Funder');
          funders.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'toggle');
        });
      },
      on: {
        doSuggest: function doSuggest() {
          funders.$modal.find('.magicsuggest').each(function () {
            var data;
            if (funders.magicSuggestData == null) funders.magicSuggestData = funders.$funderAjaxLink.val();
            funders.magicSuggest = $(this).magicSuggest({
              data: funders.magicSuggestData,
              method: 'GET',
              valueField: 'value',
              autoSelect: false,
              allowFreeEntries: false,
              displayField: 'label',
              hideTrigger: 'true',
              useCommaKey: false,
              mode: "remote"
            });
          });
        }
      }
    };
    UX.funders = funders; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-grants/js/mimicked-funders.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-grants/js/mimicked-funders.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    UX.funders.magicSuggestData = [{
      "value": "v1",
      "label": "Secretary of Defense"
    }, {
      "value": "v2",
      "label": "Defense"
    }, {
      "value": "v3",
      "label": "Department of Energy"
    }];
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-metadata-form/js/pd-metadata-form.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-metadata-form/js/pd-metadata-form.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var draftForm = {
      $form: null,
      btnSubmit: null,
      btnRedirect: null,
      $notValid: null,
      autosaveEnabled: false,
      selectors: {
        basicMetadaType: '[name="basic-metadata.type"]',
        basicMetadaTypeSelected: '[name="basic-metadata.type"]:checked',
        hasExtraDropzone: '.has-extra-dropzone'
      },
      init: function init() {
        draftForm.$form = $("#draftForm");
        draftForm.btnSubmit = '#draftForm [data-action]';
        draftForm.btnRedirect = '#draftForm [data-redirect]';
        draftForm.$notValid = $('.not-valid');
        draftForm.autosaveEnabled = draftForm.$form.hasClass('autosave-form');
        draftForm.controller();
      },
      classes: {
        hidden: 'hidden',
        notValid: 'not-valid',
        hasError: 'has-error',
        errorInput: 'error-input'
      },
      isValid: true,
      controller: function controller() {
        draftForm.$form.on('keyup keypress', function (e) {
          var keyCode = e.keyCode || e.which;
  
          if (keyCode === 13) {
            e.preventDefault();
            return false;
          }
        });
        $body.on('click', draftForm.btnSubmit, function (e) {
          e.preventDefault();
          var target = e.target;
  
          if (target.tagName === 'BUTTON') {
            draftForm.$form.attr('action', $(target).attr('data-action'));
  
            if (target.id == 'draft-form__submit') {
              draftForm.validate();
            } else {
              if (draftForm.validateFilesAndLinks()) {
                draftForm.submitForm();
              }
            }
          }
        });
        $body.on('click', draftForm.btnRedirect, function (e) {
          e.preventDefault();
          var target = e.target;
  
          if (target.tagName === 'BUTTON') {
            window.location = $(target).attr('data-redirect');
          }
        });
        $(draftForm.selectors.basicMetadaType).on('change', function (e) {
          $('[data-related-field="basic-metadata.type"]').addClass(draftForm.classes.hidden);
        });
      },
      validateBasicMetaData: function validateBasicMetaData() {
        //basic metadata
        var selectedType = $(draftForm.selectors.basicMetadaTypeSelected).val();
        var requiredFields = [];
        requiredFields.push('basic-metadata.title');
        requiredFields.push('basic-metadata.abstract');
        requiredFields.push('basic-metadata.license'); //LICENSE
  
        requiredFields.push('editorial-category.uri'); //CATEGORY
  
        requiredFields.push('search-categories.uris[]'); //TAGS
  
        requiredFields.push('pdf.path__validator'); //PDF
  
        switch (selectedType) {
          case 'poster':
            requiredFields.push('basic-metadata.poster-meeting');
            requiredFields.push('basic-metadata.poster-first-presented-date-ui');
            break;
  
          case 'preprint':
            break;
  
          default:
            $('[data-related-field="basic-metadata.type"]').removeClass(draftForm.classes.hidden);
            draftForm.isValid = false;
        }
  
        requiredFields.forEach(function (field) {
          var $element = $('[name="' + field + '"]');
          var tempSelector = '[data-related-field="' + field + '"]';
          $element.removeClass(draftForm.classes.notValid);
  
          if (!$element.val() || !$element.val().length || $element.val() == 0) {
            draftForm.isValid = false;
            $(tempSelector).removeClass(draftForm.classes.hidden);
            $element.addClass(draftForm.classes.notValid);
            $element.closest(draftForm.selectors.hasExtraDropzone).addClass(draftForm.classes.hasError);
          }
        });
      },
      validate: function validate() {
        draftForm.isValid = true;
        $('.metadata-form__message').addClass(draftForm.classes.hidden);
        draftForm.validateBasicMetaData();
        draftForm.validateTaxonomies();
        draftForm.validatePdf();
        draftForm.validateAuthors();
        draftForm.isValid = draftForm.validateFilesAndLinks() && draftForm.isValid;
  
        if (draftForm.isValid === true) {
          draftForm.submitForm();
        } else {
          var $firstErrorMessage = $('.error:visible').eq(0);
          $(document).scrollTop($firstErrorMessage.closest('.submission-card').offset().top - $('header').height());
          $.each($('.not-valid, .error-input'), function () {
            var $this = $(this);
            $this.on('focus', function (e) {
              $this.removeClass(draftForm.classes.notValid);
              $this.closest(draftForm.selectors.hasExtraDropzone).removeClass(draftForm.classes.hasError);
              $('[data-related-field="' + $this.attr("name") + '"]').addClass(draftForm.classes.hidden);
              if ($this.is('.tags-input')) $this.closest('.categories-widget').find('.error').addClass(draftForm.classes.hidden);
              $this.off('focus');
            });
          });
          return false;
        }
      },
      validateFilesAndLinks: function validateFilesAndLinks() {
        var $rows = $('.uploaded-files tbody tr, .supplemental-links__table tbody tr');
        var _isValid = true;
  
        if ($rows.length) {
          $rows.find('.submission__select, .td-text textarea').each(function () {
            var $this = $(this);
  
            if ($this.hasClass(draftForm.classes.notValid) || $this.hasClass(draftForm.classes.errorInput)) {
              _isValid = false;
            }
  
            if ($this.val() === '' || $this.val() === 'unspecified') {
              $this.closest('td').find('.error').show();
              $this.addClass(draftForm.classes.notValid); // on focus hide error
  
              $this.on('focus', function () {
                $this.closest('td').find('.error').hide();
                $this.removeClass(draftForm.classes.notValid);
                $this.off('focus');
              });
              _isValid = false;
            }
          });
        }
  
        return _isValid;
      },
      submitForm: function submitForm() {
        if (draftForm.autosaveEnabled) {
          $(draftForm.btnSubmit).prop('disabled', true);
          $(document).trigger('autosave:now');
          draftForm.$form.on('autosave:saved', function () {
            draftForm.$form.submit();
          });
          draftForm.$form.on('autosave:complete', function () {
            $(draftForm.btnSubmit).prop('disabled', false);
          });
        } else {
          draftForm.$form.submit();
          $(draftForm.btnSubmit).prop('disabled', false);
        }
      },
      validateTaxonomies: function validateTaxonomies() {
        if (!$('[name="search-categories.uris[]"]').length) {
          $('.taxonomies-input-group .tags-input').addClass(draftForm.classes.notValid);
          $('[data-related-field="search-categories.uris"]').removeClass(draftForm.classes.hidden);
        } else {
          $('.taxonomies-input-group .tags-input').removeClass(draftForm.classes.notValid);
          $('[data-related-field="search-categories.uris"]').addClass(draftForm.classes.hidden);
        }
      },
      validatePdf: function validatePdf() {
        $('input[name="pdf.path__validator"].not-valid').closest('.uploader__input-wrapper').addClass(draftForm.classes.errorInput);
      },
      validateAuthors: function validateAuthors() {
        var $submissionAuthors = $('.submission-authors'); // name, affiliations and email of authors
  
        var $fields = $submissionAuthors.find('input[name$="first-name"], input[name$="last-name"], input[name$="affiliations"], input[name$="email"]');
        $fields.closest('tr').removeClass(draftForm.classes.notValid);
        $fields.each(function () {
          var $field = $(this);
          $field.removeClass(draftForm.classes.notValid);
  
          if (!$field.val() || !$field.val().length || $field.val() == 0) {
            draftForm.isValid = false;
            $submissionAuthors.find('> .error').text('Author name, affiliations and email are required.');
            $submissionAuthors.addClass(draftForm.classes.notValid);
            $field.closest('tr').addClass(draftForm.classes.notValid);
          }
        }); // corresponding author validation
  
        if (!$submissionAuthors.find('.author__row.author__corresponding').length) {
          draftForm.isValid = false;
          $submissionAuthors.find('> .error').text('Please select corresponding author.');
          $submissionAuthors.addClass(draftForm.classes.notValid);
        }
      }
    };
    UX.draftForm = draftForm; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-pdf/js/pd-pdf.js":
  /*!*********************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-pdf/js/pd-pdf.js ***!
    \*********************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _plugins_AjaxUploader_Uploader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/AjaxUploader/Uploader */ "../../ui-core/plugins/AjaxUploader/Uploader.js");
  
  
  (function () {
    var $body = $('body');
    var pdPdf = {
      $uploader: null,
      $uploaderInput: null,
      $filenameInput: null,
      validateKey: "pdf.path__validator",
      $validator: null,
      currentItem: null,
      init: function init() {
        pdPdf.$uploader = $('.pd-pdf .ajax-uploader');
        pdPdf.$uploaderContainer = $('.pd-pdf .uploader__input');
        pdPdf.$uploaderInputWrapper = $('.pd-pdf .uploader__input-wrapper');
        pdPdf.$uploaderInput = $('.pd-pdf .uploader__file');
        pdPdf.$filenameInput = $('.pd-pdf input[name="pdf_filename"]');
        pdPdf.$uploaderItem = $('.pd-pdf .files-list__item');
        pdPdf.$validator = pdPdf.$uploader.find('[name="' + pdPdf.validateKey + '"]');
        pdPdf.controller();
        if (pdPdf.$uploader.length) pdPdf.ajaxUploader.init();
      },
      controller: function controller() {
        pdPdf.$uploaderItem.on('click', '.remove-file', function () {
          if (pdPdf.currentItem) pdPdf.currentItem.abort();
          pdPdf.on.reset();
          setTimeout(function () {
            $(document).trigger('autosave'); // todo: get rid of jQuery trigger
          }, 500);
        });
      },
      on: {
        invalidate: function invalidate() {
          pdPdf.$validator.val('');
          pdPdf.$uploader.find("[data-related-field='" + pdPdf.validateKey + "']").addClass("hidden");
        },
        setValid: function setValid() {
          pdPdf.$validator.val('success');
          $(document).trigger('autosave');
        },
        reset: function reset() {
          pdPdf.$uploaderInputWrapper.removeClass('error-input');
          pdPdf.$uploaderItem.find('.uploader__message span').text("");
          pdPdf.$uploaderItem.data('state', '');
          pdPdf.$uploaderItem.removeAttr('data-state');
          pdPdf.$uploaderContainer.css("display", '');
          pdPdf.$uploaderInput.val('');
          pdPdf.$filenameInput.val('');
          pdPdf.currentItem = null;
        }
      },
      ajaxUploader: {
        init: function init() {
          var ajaxUploaderOptions = {
            dropzone: '.pd-pdf.uploader__wrapper',
            ajax: {
              url: pdPdf.$uploader.data('upload-url'),
              data: {
                "type": "pdf",
                "doi": pdPdf.$uploader.data('doi'),
                "signature": pdPdf.$uploader.data('signature'),
                "anti-forgery-token": pdPdf.$uploader.data('forgery')
              }
            },
            handlers: {
              start: function start() {
                pdPdf.on.invalidate();
              },
              beforeUpload: pdPdf.ajaxUploader.on.processFile,
              validationError: function validationError(exception, item) {
                pdPdf.ajaxUploader.showError(item.getState(), exception.message);
                pdPdf.on.invalidate();
              },
              progress: function progress(value, item) {
                var $progress = pdPdf.$uploaderItem.find(".uploader__progress progress");
                $progress.val(value);
              },
              success: function success(item) {
                pdPdf.$uploaderItem.data("state", item.getState());
                pdPdf.$uploaderItem.attr("data-state", item.getState());
                pdPdf.$filenameInput.val(item.fileName());
                pdPdf.on.setValid();
              },
              error: function error(item, message) {
                pdPdf.ajaxUploader.showError(item.getState(), message);
                pdPdf.on.invalidate();
              }
            }
          };
          new _plugins_AjaxUploader_Uploader__WEBPACK_IMPORTED_MODULE_0__["default"](pdPdf.$uploader, ajaxUploaderOptions);
        },
        on: {
          processFile: function processFile(item) {
            pdPdf.on.reset();
            pdPdf.currentItem = item;
            var filename = item.fileName();
            var fileSize = item.fileSizeHuman();
            pdPdf.$uploaderItem.find('.file-name').text(filename);
            pdPdf.$uploaderItem.find('.file-size').text("(" + fileSize + ")");
            pdPdf.$uploaderContainer.css("display", "none");
            pdPdf.$uploaderItem.attr('data-state', item.getState());
          }
        },
        showError: function showError(state, errorMessage) {
          pdPdf.$uploaderInputWrapper.addClass('error-input');
  
          if (errorMessage) {
            pdPdf.$uploaderItem.find('.uploader__message span').text(errorMessage);
          }
  
          pdPdf.$uploaderItem.data('state', state);
          pdPdf.$uploaderItem.attr('data-state', state);
        }
      }
    };
    UX.pdPdf = pdPdf; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-search-categories/js/pd-search-categories.js":
  /*!*************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-search-categories/js/pd-search-categories.js ***!
    \*************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var pdSearchCategories = {
      $element: null,
      $categoriesBlock: null,
      $tagsInput: null,
      $toggleButton: null,
      vPort: 'screen-sm',
      hideClasses: ['hidden-sm', 'hidden-xs'],
      init: function init() {
        this.$element = $(".taxonomies-input-group");
        this.$dropdown = pdSearchCategories.$element.find('[data-db-target-for]');
        this.$categoriesBlock = this.$element.find(".taxonomies-dropblock");
        this.$tagsInput = this.$element.find(".tags-input");
        this.$toggleButton = $('.taxonomies__toggle');
        this.controller();
        this.slideController();
      },
      responsive: function responsive() {
        $(document).on(pdSearchCategories.vPort + '-on');
      },
      slideController: function slideController() {
        var _this = this;
  
        $(document).on('slide:opened', function (e, slide) {
          pdSearchCategories.$categoriesBlock = slide.$contents.find(".taxonomies-dropblock");
          pdSearchCategories.$tagsInput.find(".tags-input__item").each(function () {
            pdSearchCategories.$categoriesBlock.find("input[value='" + $(this).data('value') + "']").prop('checked', true);
          });
  
          _this.on.slideToggleButton();
  
          slide.$contents.find('input[type=checkbox]').on("change", pdSearchCategories.on.checkboxClick);
        });
        $(document).on('slide:closed', function (e, slide) {
          pdSearchCategories.$categoriesBlock = pdSearchCategories.$element.find(".taxonomies-dropblock");
        });
      },
      controller: function controller() {
        this.$tagsInput.on("click", function (e) {
          if ($(e.target).is('.tags-input__item, .tags-input__item *')) return false;
        });
        this.$tagsInput.on("click", ".tags-input__remove", function (e) {
          e.stopPropagation();
          var val = $(this).closest('.tags-input__item').data('value');
          var $checkbox = pdSearchCategories.$categoriesBlock.find('input[id="' + val + '"]');
          pdSearchCategories.on.removeTag($checkbox);
          pdSearchCategories.on.toggleInput();
          if (!pdSearchCategories.$tagsInput.hasClass('js--open')) $(document).trigger('autosave');
        });
        this.$categoriesBlock.on("change", "input[type=checkbox]", pdSearchCategories.on.checkboxClick);
        this.on.slideToggleButton();
        pdSearchCategories.$dropdown.on('dropBlock:close', function (event, controller, target) {
          $(document).trigger('autosave');
        });
      },
      on: {
        slideToggleButton: function slideToggleButton() {
          $(document).off('click', '.taxonomies__toggle');
          $(document).on('click', '.taxonomies__toggle', function (e) {
            e.preventDefault();
            var $list = $(this).siblings('.taxonomies__list');
            $list.slideToggle();
            $(this).toggleClass('js--open');
          });
        },
        checkboxClick: function checkboxClick(e) {
          e.stopPropagation();
          var $checkbox = $(this);
          if ($checkbox.is(":checked")) pdSearchCategories.on.addTag($checkbox);else pdSearchCategories.on.removeTag($checkbox);
          pdSearchCategories.on.toggleInput();
        },
        removeTag: function removeTag($checkbox) {
          var category = $checkbox.val();
          var $tag = pdSearchCategories.$tagsInput.find('[data-value="' + category + '"]');
          var parent = $checkbox.data("parent-id");
  
          if (!parent) {
            // I'm parent and my children should be removed with me.
            var selectedChildren = pdSearchCategories.$categoriesBlock.find('input[data-parent-id="' + category + '"]:checked');
  
            if (selectedChildren.length) {
              selectedChildren.each(function () {
                pdSearchCategories.on.removeTag($(this));
              });
            }
          }
  
          $checkbox.prop('checked', false);
          $tag.remove();
        },
        addTag: function addTag($checkbox) {
          var category = $checkbox.val();
          var label = $checkbox.siblings('.label-txt').text();
          var tag = pdSearchCategories.buildTag(category, label);
          var parent = $checkbox.data("parent-id");
  
          if (parent) {
            // I'm child and my parent should be selected with me.
            var $parentTag = pdSearchCategories.$tagsInput.find('[data-value="' + parent + '"]');
  
            if (!$parentTag.length) {
              var $parent = pdSearchCategories.$categoriesBlock.find('input[id="' + parent + '"]');
              $parent.prop('checked', true);
              $parentTag = pdSearchCategories.on.addTag($parent);
            }
  
            return $(tag).appendTo($parentTag.find('> ul'));
          }
  
          return $(tag).appendTo(pdSearchCategories.$tagsInput.find('.tags-input__list'));
        },
        toggleInput: function toggleInput() {
          if (pdSearchCategories.$tagsInput.find('> .tags-input__list').is(":empty")) {
            pdSearchCategories.$tagsInput.addClass(pdSearchCategories.hideClasses.join(" "));
          } else {
            pdSearchCategories.$tagsInput.removeClass(pdSearchCategories.hideClasses.join(" "));
          }
        }
      },
      buildTag: function buildTag(category, label) {
        return '<li class="tags-input__item" data-value="' + category + '"><span>' + label + '</span><input type="hidden" name="search-categories.uris[]" value="' + category + '"><ul></ul><span title="Remove" class="tags-input__remove"></span></li>';
      }
    };
    UX.pdSearchCategories = pdSearchCategories; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-submission-list/js/pd-submission-list.js":
  /*!*********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-submission-list/js/pd-submission-list.js ***!
    \*********************************************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _plugins_polyfills_js_String_includes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/polyfills/js/String/includes */ "../../ui-core/plugins/polyfills/js/String/includes.js");
  /* harmony import */ var _plugins_polyfills_js_String_includes__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_plugins_polyfills_js_String_includes__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _plugins_polyfills_js_Element_closest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/polyfills/js/Element/closest */ "../../ui-core/plugins/polyfills/js/Element/closest.js");
  /* harmony import */ var _plugins_polyfills_js_Promise_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/polyfills/js/Promise/index */ "../../ui-core/plugins/polyfills/js/Promise/index.js");
  
  
  
  
  (function () {
    var $body = $('body'),
        isMobile = false;
    /**
     * Submission List Model
     *
     */
  
    var submissionList = {
      submissionListItem: null,
      $submissionListItems: null,
      submissionListWrapper: null,
      submissionListItself: null,
      dashboardMain: null,
      $toolsDropBlocks: null,
      $loadingTarget: null,
      loaderStatus: false,
      doi: null,
      widgets: [{
        "class": '.pdActionBar',
        url: '/pb/widgets/preprint/submissionActionBar'
      }, {
        "class": '.pbArticleView',
        url: '/pb/widgets/preprint/submissionContent'
      }, {
        "class": '.pbActionRecords',
        url: '/pb/widgets/preprint/actionRecords'
      }, {
        "class": '.pbAuthorsHistory',
        url: '/pb/widgets/preprint/authorHistory'
      }],
      selectors: {
        submissionListItemNotSelected: '.submission-list-item:not(.selected)'
      },
      classes: {
        loading: 'loading',
        hidden: 'hidden'
      },
      htmlMarkups: {
        loadingWrapper: '<div class="loading-wrapper"><svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" width="64px" height="64px" viewBox="0 0 128 128" xml:space="preserve"> <g transform="rotate(222.589 64 64)"> <path d="M75.4 126.63a11.43 11.43 0 0 1-2.1-22.65 40.9 40.9 0 0 0 30.5-30.6 11.4 11.4 0 1 1 22.27 4.87h.02a63.77 63.77 0 0 1-47.8 48.05v-.02a11.38 11.38 0 0 1-2.93.37z" fill="#999999" fill-opacity="1"></path> <animateTransform attributeName="transform" type="rotate" from="0 64 64" to="360 64 64" dur="1000ms" repeatCount="indefinite"></animateTransform> </g> </svg> </div>',
        ajaxError: '<div class="warning-text-color">Oops. Something went wrong!</div>'
      },
      vPort: 'screen-sm',
      dashboardActions: {
        'admin': "showAdminDashboard",
        'advisor': "showAdvisorDashboard",
        'author': "showAuthorDashboard"
      },
      init: function init() {
        this.submissionListItem = '.submission-list-item';
        this.$submissionListItems = $(this.submissionListItem);
        this.$toolsDropBlocks = $('.pd-list-tools .dropBlock');
        this.$loadingTarget = $('body');
        this.submissionListWrapper = document.querySelector('.submission-list');
        this.submissionListItself = document.querySelector('.submission-list__list');
        this.dashboardMain = document.querySelector('.dashboard-main');
        this.prepare();
        this.responsive();
        this.controller();
        this.additionalInit();
      },
      additionalInit: function additionalInit() {},
      responsive: function responsive() {
        $(document).on("".concat(submissionList.vPort, "-on"), function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
          submissionList.methods.resetListStyle();
        });
        $(document).on("".concat(submissionList.vPort, "-off"), function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = false;
          submissionList.methods.prepareListStyle();
        });
      },
      prepare: function prepare() {
        this.methods.prepareListStyle();
        this.methods.truncateTitles();
        this.methods.selectFirstItem();
      },
      controller: function controller() {
        var _this = this;
  
        this.$submissionListItems.on('click', function (e) {
          return e.preventDefault();
        });
        $(this.submissionListItself).on('click', submissionList.selectors.submissionListItemNotSelected, this._clickHandler);
        $(document).on('slide:opened', function (e, slide) {
          var el = slide.$toggle.closest(_this.submissionListItem)[0];
          if (el) _this.on.click(el).then(_this.on.widgetsLoaded);
        });
        this.additionalController();
      },
      additionalController: function additionalController() {},
      _clickHandler: function _clickHandler(e) {
        e.preventDefault();
  
        if (!isMobile) {
          var el = e.target.closest(submissionList.submissionListItem);
          submissionList.on.click(el).then(submissionList.on.widgetsLoaded);
        }
      },
      on: {
        /**
         *
         * @param {HTMLElement} el
         * @return Promise
         */
        click: function click(el) {
          submissionList.methods.setLoading(true);
          document.querySelectorAll("".concat(submissionList.submissionListItem, ".selected")).forEach(function (item) {
            item.classList.remove("selected");
          });
          el.classList.add("selected");
          submissionList.doi = el.dataset.doi;
          return submissionList.on.loadWidgets();
        },
  
        /**
         * Load Widgets
         * @return Promise
         */
        loadWidgets: function loadWidgets() {
          var promises = [];
  
          var loadWidget = function loadWidget(widget, resolve) {
            var $widget = $(widget["class"]);
            var replace = widget.replace !== false;
            $widget.html('');
            var widgetId = $widget.data('widget-id');
            var pbContext = $("[name='pbContext']").attr('content');
            return new _plugins_polyfills_js_Promise_index__WEBPACK_IMPORTED_MODULE_2__["default"](function (resolve, reject) {
              $.ajax({
                type: 'GET',
                url: widget.url,
                dataType: 'html',
                data: {
                  doi: submissionList.doi,
                  widgetId: widgetId,
                  pbContext: pbContext,
                  dashboard: submissionList.methods.currentDashboard(),
                  currentTab: submissionList.methods.currentState()
                },
                success: function success(html) {
                  if (replace) {
                    if (html.trim() === '') html = "<div class=\"".concat(widget["class"].substr(1), "\" data-widget-id=\"").concat(widgetId, "\"></div>");
                    $widget.replaceWith(html);
                  } else {
                    $widget.html(html);
                  }
  
                  if (widget.onSuccess && widget.onSuccess.length) {
                    widget.onSuccess.forEach(function (item) {
                      if ($(item["class"]).length) {
                        promises.push(loadWidget(item));
                      }
                    });
                  }
                },
                error: function error() {
                  $widget.replaceWith(submissionList.htmlMarkups.ajaxError);
                },
                complete: function complete() {
                  submissionList.methods.setLoading(false);
                  resolve(widget["class"]);
                }
              });
            });
          };
  
          submissionList.widgets.forEach(function (widget) {
            if ($(widget["class"]).length) {
              promises.push(loadWidget(widget));
            }
          });
          return new _plugins_polyfills_js_Promise_index__WEBPACK_IMPORTED_MODULE_2__["default"](function (resolve, reject) {
            _plugins_polyfills_js_Promise_index__WEBPACK_IMPORTED_MODULE_2__["default"].all(promises).then(function () {
              resolve('all');
            });
          });
        },
        widgetsLoaded: function widgetsLoaded() {
          setTimeout(function () {
            submissionList.methods.refreshWidgets();
          }, 0);
        }
      },
      methods: {
        /**
         * Truncate Submissions titles in the list
         */
        truncateTitles: function truncateTitles() {
          $('.submission-list-item__title').not('[data-truncate="none"]').truncate({
            lines: 2
          });
        },
        prepareListStyle: function prepareListStyle() {
          this.setListHeight();
          this.setDashboardMainHeight();
          this.makeListSticky();
        },
        resetListStyle: function resetListStyle() {
          this.setListHeight(true);
          this.setDashboardMainHeight(true);
          this.makeListSticky(true);
        },
  
        /**
         * Set List height to fill the page
         * @param {boolean} [destroy]
         * @param {number} [exclude]
         */
        setListHeight: function setListHeight(destroy, exclude) {
          if (destroy) {
            submissionList.submissionListItself.style.height = '';
            return;
          }
  
          if (submissionList.submissionListWrapper && submissionList.submissionListItself) {
            var excludeHeight = typeof exclude !== "undefined" ? exclude : 25;
            excludeHeight += submissionList.submissionListWrapper.querySelector('.pd-list-tools').parentElement.getBoundingClientRect().height;
            excludeHeight += this.mainPaddingTop;
            submissionList.submissionListItself.style.height = "calc(100vh - ".concat(excludeHeight, "px)");
          }
        },
  
        /**
         * Set the `dashboard-main` height to be fixed with page height
         * @param {boolean} [destroy]
         */
        setDashboardMainHeight: function setDashboardMainHeight(destroy) {
          var target;
  
          if (submissionList.submissionListWrapper && submissionList.dashboardMain && submissionList.dashboardMain.dataset.fixedHeight !== 'false') {
            target = submissionList.dashboardMain.closest('[class*="col-"]');
          }
  
          if (target) {
            if (destroy) {
              target.style.height = '';
              target.style.overflowY = '';
            } else {
              target.style.height = "".concat(submissionList.submissionListWrapper.getBoundingClientRect().height, "px");
              target.style.overflowY = 'auto';
            }
          }
        },
  
        /**
         * Make the list sticky while scrolling
         * @param {boolean} [destroy]
         */
        makeListSticky: function makeListSticky(destroy) {
          var stickyWrapper = submissionList.submissionListWrapper.parentElement;
  
          if (destroy) {
            stickyWrapper.style.position = '';
            stickyWrapper.style.top = '';
            return;
          }
  
          stickyWrapper.style.position = 'sticky';
          stickyWrapper.style.top = "".concat(this.mainPaddingTop, "px");
        },
  
        /**
         * Select First item in the list on page load
         */
        selectFirstItem: function selectFirstItem() {
          var firstItem = document.querySelector("".concat(submissionList.submissionListItem, ":first-child"));
          if (!firstItem) return; // setTimeout trick to let the browser execute this after it finishes rendering
  
          setTimeout(function () {
            $(firstItem).trigger('click');
          }, 0);
        },
  
        get mainPaddingTop() {
          var main = document.querySelector('main.content');
  
          if (main) {
            return parseInt(window.getComputedStyle(main).getPropertyValue('padding-top'));
          }
  
          return 0;
        },
  
        setLoading: function setLoading(state) {
          if (state === true) {
            submissionList.loaderStatus = true;
            var loadingEl = submissionList.htmlMarkups.loadingWrapper;
            if (document.querySelector(".loading-wrapper")) loadingEl = loadingEl.outerHTML;
            submissionList.$loadingTarget.append(loadingEl);
            submissionList.$loadingTarget.addClass(submissionList.classes.loading);
          } else {
            submissionList.loaderStatus = false;
            submissionList.$loadingTarget.find("> .loading-wrapper").remove();
            submissionList.$loadingTarget.removeClass(submissionList.classes.loading);
          }
        },
        checkIncomplete: function checkIncomplete() {
          $(".submission-card").each(function (index, element) {
            if ($(element).find(".incomplete").length) $(element).find('.badge').removeClass(submissionList.classes.hidden);
          });
        },
        refreshWidgets: function refreshWidgets() {
          if ($('.pd-action-bar').length) {
            UX.pdActionBar.init();
          }
  
          if ($('.pbArticleView').length) {
            UX.accordion.init();
            submissionList.methods.checkIncomplete();
          }
  
          if ($('.pbActionRecords').length) {
            UX.advisorActionRecords.init();
          }
  
          if ($('.pbAuthorsHistory').length) {
            UX.authorsHistory.init();
          }
  
          if ($('.dashboard-toolbar').length) {
            UX.dashboardToolbar.init();
          }
        },
        currentDashboard: function currentDashboard() {
          var pathname = window.location.pathname;
  
          for (var dashboard in submissionList.dashboardActions) {
            if (!submissionList.dashboardActions.hasOwnProperty(dashboard)) continue;
            var action = submissionList.dashboardActions[dashboard];
            if (pathname.indexOf(action) !== -1) return dashboard;
          }
  
          return '';
        },
        currentState: function currentState() {
          var statusNameElem = document.querySelector(".status-tabs .active");
          if (!statusNameElem) return false;
          var statusName = statusNameElem.textContent.toLowerCase();
          return statusName.replace(/\s+/g, "-");
        }
      }
    };
    UX.submissionList = submissionList; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-supplemental-files/js/pd-supplemental-files.js":
  /*!***************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-supplemental-files/js/pd-supplemental-files.js ***!
    \***************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        isMobile = false;
    var supplementalFiles = {
      $container: null,
      tdDesc: null,
      tdPath: null,
      $table: null,
      $templateRow: null,
      $uploaderElement: null,
      vPort: 'screen-sm',
      $selector: null,
      $condition: null,
      $fileName: null,
      $lastElement: null,
      $this: null,
      files: {},
      selectors: {
        submissionSubmit: 'select.submission__select',
        errorNotImage: '.error--not-image'
      },
      init: function init() {
        this.$container = $('.supplemental-files');
        this.tdDesc = '.description-td';
        this.tdPath = '.path-td';
        this.$table = this.$container.find('.uploaded-files');
        this.$templateRow = this.$container.find('.rowTemplate tr');
        this.$uploaderElement = this.$container.find('.ajax-uploader');
        this.modal.init();
        this.controller();
      },
      controller: function controller() {
        this.$table.on('click', '.edit', supplementalFiles.on.edit);
        this.$table.on('change', supplementalFiles.selectors.submissionSubmit, function () {
          $(document).trigger('autosave');
          var $this = $(this);
          $this.removeClass('not-valid');
          $this.removeClass('error-input');
          $(this).closest('td').find(supplementalFiles.selectors.errorNotImage).hide();
          supplementalFiles.on.fileTypeChange($this);
        });
        var uploaderElement = supplementalFiles.$uploaderElement[0];
        if (uploaderElement) uploaderElement.addEventListener('success:uploader', supplementalFiles.on.success); // popup
  
        this.$table.on('mouseenter', '.js-editable:not(.js--open) .js-editable__text', supplementalFiles.on.showPopup);
        this.$table.on('mouseleave', '.js-editable', supplementalFiles.on.hidePopup);
        this.$table.on('click', '.remove-file', function () {
          var rowIndex = $(this).closest('tr').data('index');
          delete supplementalFiles.files[rowIndex];
        });
      },
  
      /**
       * Determine if I am in mobile
       */
      responsive: function responsive() {
        $(document).on(supplementalFiles.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
        });
        $(document).on(supplementalFiles.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
        });
      },
      isFileImage: function isFileImage($this) {
        var index = $this.closest('tr').data('index');
  
        if (!supplementalFiles.files[index].getType().includes('image/')) {
          $this.addClass('not-valid');
          $this.closest('td').find(supplementalFiles.selectors.errorNotImage).show();
        }
      },
      on: {
        add: function add(item) {
          // show table
          supplementalFiles.$table.show();
          var $row = supplementalFiles.$templateRow.clone();
          var html = $row.html();
          html = html.replace(/fakedinput/gi, 'input').replace(/fakedtextarea/gi, 'textarea').replace(/fakedselect/gi, 'select').replace(/\{\{filenameTruncated\}\}/gi, item.fileNameTruncated()).replace(/\{\{filename\}\}/gi, item.fileName()).replace(/{{index}}/gi, item.getIndex());
          $row.html(html);
          $row.data("index", item.getIndex());
          $row.attr("data-index", item.getIndex());
          $row.appendTo(supplementalFiles.$table.find('tbody'));
          var selectors = $row.find('.future-jcf');
  
          if (selectors) {
            selectors.removeClass('future-jcf');
            selectors.addClass('jcf');
            jcf.replace(selectors);
          }
  
          if (UX.editInPlace) {
            UX.editInPlace.init();
          }
  
          if (UX.charCounter) {
            UX.charCounter.init();
          }
  
          setTimeout(function () {
            $(document).trigger('autosave'); // todo: get rid of jQuery trigger
          }, 500);
          return $row;
        },
        edit: function edit() {
          var index = $(this).closest('tr').data('index');
          supplementalFiles.modal.show(index);
        },
  
        /**
         * Show popup on row cell
         */
        showPopup: function showPopup() {
          if (!isMobile) {
            var content = $(this).text();
            var hasHover = $(this).closest(".js-editable").find('.hover-popup').length;
  
            if (content !== "" && !hasHover) {
              var html = "<div class='hover-popup'>" + content + "</div>";
              var $hover = $(html);
              $hover.width($(this).outerWidth());
              $hover.insertAfter($(this));
            }
          }
        },
  
        /**
         * Hide popup on row cell
         */
        hidePopup: function hidePopup() {
          if (!isMobile) {
            $(this).find(".hover-popup").remove();
          }
        },
        success: function success(ev) {
          /**
           * @var {UploaderFile}
           */
          var item = ev.detail.item;
          var $item = supplementalFiles.$uploaderElement.find(".files-list__item[data-index=".concat(item.getIndex(), "]"));
          supplementalFiles.on.add(item);
          $item.remove();
        },
        fileTypeChange: function fileTypeChange($this) {
          var selectedVal = $this.val();
  
          if (selectedVal === 'image') {
            supplementalFiles.isFileImage($this);
          }
        }
      },
      modal: {
        $modal: null,
        $row: null,
        $filename: null,
        $description: null,
        $type: null,
        $saveBtn: null,
        init: function init() {
          this.$modal = $("#suppfiles-modal");
          this.$filename = this.$modal.find('.suppfile-filename');
          this.$description = this.$modal.find('.suppfile-description');
          this.$type = this.$modal.find('.suppfile-type');
          this.$saveBtn = this.$modal.find('#saveSuppFile');
          this.controller();
        },
        controller: function controller() {
          this.$modal.on('show.bs.modal', function () {
            supplementalFiles.modal.refreshPlugins();
          });
          this.$saveBtn.on('click', function () {
            supplementalFiles.modal.save();
            supplementalFiles.modal.hide();
          });
        },
        show: function show(rowNum) {
          if (rowNum !== false) {
            this.$row = supplementalFiles.$table.find("tr[data-index=\"".concat(rowNum, "\"]"));
            this.prepare();
          }
  
          this.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'show');
        },
        hide: function hide() {
          this.$modal.modal('hide');
        },
        refreshPlugins: function refreshPlugins() {
          jcf.getInstance(this.$type).refresh();
          UX.charCounter.init();
        },
        prepare: function prepare() {
          var data = this.getDataFromRow();
          if (data.filename) this.$filename.html(data.filename);
          if (data.description) this.$description.val(data.description);
          if (data.type) this.$type.val(data.type);
        },
        getDataFromRow: function getDataFromRow() {
          var data = {};
          data.filename = this.$row.find('.path-td .td-text').html();
          data.description = this.$row.find('.description-td textarea').val();
          data.type = this.$row.find('.file-type-td select').val();
          return data;
        },
        save: function save() {
          var newDescription = this.$description.val();
          this.$row.find('.description-td .js-editable__text').text(newDescription);
          this.$row.find('.description-td textarea').val(newDescription);
          var newType = this.$type.val();
          var newTypeLabel = this.$type.find("option[value=\"".concat(newType, "\"]")).text();
          var $select = this.$row.find('.file-type-td select');
          $select.val(newType);
          this.$row.find('.file-type-td .td-text').text(newTypeLabel);
          jcf.getInstance($select).refresh();
        }
      }
    };
    UX.supplementalFiles = supplementalFiles; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/pd-supplemental-links/js/pd-supplemental-links.js":
  /*!***************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/pd-supplemental-links/js/pd-supplemental-links.js ***!
    \***************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (UX) {
    var $body = $('body'),
        isMobile = false;
    var supplementalLinks = {
      $table: null,
      $templateRow: null,
      $newLinkInput: null,
      $validationMessage: null,
      $saveLink: null,
      $addLink: null,
      $form: null,
      vPort: 'screen-sm',
      tds: {
        url: '.url-doi-td',
        description: '.description-td',
        type: '.content-type-td'
      },
      strings: {
        "notUrl": "Please enter a valid URL ",
        "empty": "This field can't be empty ",
        "emptyUrl": "URL can't be empty ",
        "emptyDescription": "Description can't be empty ",
        "add": "Add Supplemental Link",
        "edit": "Edit Supplemental Link"
      },
      // For validating URLS
      urlPattern: /(?:https?|ftp):\/\/(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/i,
      init: function init() {
        this.$table = $('.supplemental-links__table');
        this.$templateRow = $('.supplemental-links .rowTemplate tr');
        this.$form = $(".supplemental-links__form");
        this.$saveLink = $("#saveSuppLink");
        this.$addLink = $("#addSuppLink");
        this.$newLinkInput = $("#supp-link-url");
        this.$validationMessage = $(".supplemental-links .validation-message");
        this.modal.init();
        supplementalLinks.responsive();
        supplementalLinks.controller();
      },
  
      /**
       * Determine if I am in mobile
       */
      responsive: function responsive() {
        $(document).on(supplementalLinks.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
        });
        $(document).on(supplementalLinks.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
        });
      },
  
      /**
       * Events handlers for thew widget
       */
      controller: function controller() {
        // mobile Add link button -> opens the modal
        supplementalLinks.$addLink.on('click', function (e) {
          e.preventDefault();
          supplementalLinks.modal.show();
        }); // desktop Save link button -> add link directly from input with defaults
  
        supplementalLinks.$saveLink.on('click', supplementalLinks.on.saveLinkClick); // Save on enter && toggle desktop add link button state
  
        supplementalLinks.$newLinkInput.on('input keyup', function (e) {
          if (e.keyCode === 13) supplementalLinks.$saveLink.trigger('click');else supplementalLinks.methods.toggleState();
        }); // rows events
  
        supplementalLinks.rowControllers(this.$table.find('tbody tr'));
      },
      on: {
        /**
         * Handler for desktop add link button
         */
        saveLinkClick: function saveLinkClick(e) {
          e.preventDefault();
          var data = {
            url: supplementalLinks.$newLinkInput.val(),
            description: supplementalLinks.$newLinkInput.val()
          };
          var validationResult = supplementalLinks.methods.validate(data);
  
          if (!validationResult.success) {
            supplementalLinks.methods.showError(validationResult.message);
            return;
          }
  
          supplementalLinks.methods.save(data); // return to first state
  
          supplementalLinks.$newLinkInput.val("");
          supplementalLinks.methods.toggleState();
        }
      },
      methods: {
        /**
         * Show error in desktop
         * @param message
         */
        showError: function showError(message) {
          supplementalLinks.$validationMessage.text(message);
          var vmWidth = supplementalLinks.$validationMessage.outerWidth();
          supplementalLinks.$newLinkInput.css('padding-right', vmWidth);
          supplementalLinks.$form.addClass('error-input');
        },
  
        /**
         * Hide error in desktop
         */
        hideError: function hideError() {
          supplementalLinks.$validationMessage.text("");
          supplementalLinks.$newLinkInput.css('padding-right', false);
          supplementalLinks.$form.removeClass('error-input');
        },
  
        /**
         * Check the validation of URL
         * @param url
         * @returns {boolean}
         */
        validateUrl: function validateUrl(url) {
          return supplementalLinks.urlPattern.test(url);
        },
  
        /**
         * Validate Input Data
         * @param data
         * @returns {*}
         */
        validate: function validate(data) {
          if (!data.url || data.url === "") {
            return {
              success: false,
              message: supplementalLinks.strings["emptyUrl"]
            };
          }
  
          if (!this.validateUrl(data.url)) {
            return {
              success: false,
              message: supplementalLinks.strings["notUrl"]
            };
          }
  
          if (!data.description || data.description === "") {
            return {
              success: false,
              message: supplementalLinks.strings["emptyDescription"]
            };
          }
  
          return {
            success: true
          };
        },
  
        /**
         * Save input data to new table row
         * @param data
         */
        save: function save(data) {
          supplementalLinks.methods.hideError();
          var index = supplementalLinks.$table.find("tbody tr").length;
  
          if (index === 0) {
            supplementalLinks.$table.removeClass("hidden");
          } //add new row
  
  
          supplementalLinks.newRow.make(index, data); // auto-save the form
  
          $(document).trigger('autosave');
        },
  
        /**
         * Toggle desktop add link disabled state
         */
        toggleState: function toggleState() {
          if (supplementalLinks.$newLinkInput.val() === "") supplementalLinks.$saveLink.prop('disabled', true);else supplementalLinks.$saveLink.prop('disabled', false);
        }
      },
  
      /**
       * Events handlers for table rows
       * @param $row
       */
      rowControllers: function rowControllers($row) {
        var $urlTd = $row.find(this.tds.url);
        $urlTd.on('editInPlace:onSave', '.js-editable', supplementalLinks.newRow.handlers.onUpdateUrl);
        $urlTd.on('keydown', '.js-editable.validation-error textarea', supplementalLinks.newRow.handlers.cleanURLEditableErrors); // remove
  
        $row.find('.remove-link').on('click', supplementalLinks.newRow.handlers.remove); // popup
  
        $row.on('mouseenter', '.js-editable:not(.js--open) .js-editable__text', supplementalLinks.newRow.handlers.showPopup);
        $row.on('mouseleave', '.js-editable', supplementalLinks.newRow.handlers.hidePopup); // When edit button is clicked for one row
  
        $row.on('click', '.btn--action.edit', supplementalLinks.newRow.handlers.edit);
      },
  
      /**
       * New Row functions
       */
      newRow: {
        $row: null,
        data: {},
  
        /**
         * Make new row
         * @param index
         * @param data
         */
        make: function make(index, data) {
          this.data = data;
          this.render(index);
          this.init();
        },
  
        /**
         * Generate new row html and append
         * @param index
         */
        render: function render(index) {
          var rowHtml = supplementalLinks.$templateRow[0].outerHTML;
          rowHtml = rowHtml.replace(/\{\{url\}\}/gi, this.data.url).replace(/\{\{description\}\}/gi, this.data.description).replace(/\{\{index\}\}/gi, index).replace(/fakedinput/gi, "input").replace(/fakedtextarea/gi, "textarea").replace(/fakedselect/gi, "select");
          this.$row = $(rowHtml).appendTo(supplementalLinks.$table.find("tbody"));
        },
  
        /**
         * Initialize the new row
         */
        init: function init() {
          this.plugins();
          this.controller();
        },
  
        /**
         * Run the plugins used in the new row
         */
        plugins: function plugins() {
          var selectors = this.$row.find(".future-jcf");
  
          if (selectors.length) {
            if (this.data.type) {
              if (this.data.type.value) selectors.val(this.data.type.value);
              if (this.data.type.label) this.$row.find(supplementalLinks.tds.type + " .td-text").text(this.data.type.label);
            }
  
            selectors.addClass("jcf").removeClass("future-jcf");
            jcf.replace(selectors);
          }
  
          if (!isMobile && UX.editInPlace) {
            UX.editInPlace.init();
          }
  
          if (UX.charCounter) {
            UX.charCounter.init();
          }
        },
  
        /**
         * Attach events handlers to the new row
         */
        controller: function controller() {
          supplementalLinks.rowControllers(this.$row);
        },
  
        /**
         * Row Events Handlers
         */
        handlers: {
          /**
           * Remove the row
           */
          remove: function remove() {
            var $row = $(this).closest('tr');
            $row.remove();
  
            if (!supplementalLinks.$table.find("tbody tr").length) {
              supplementalLinks.$table.addClass("hidden");
            }
          },
  
          /**
           * Edit the row
           * @param e
           */
          edit: function edit(e) {
            e.preventDefault();
            var index = $(this).closest('tr').data("index");
            supplementalLinks.modal.show(index);
          },
  
          /**
           * Show popup on row cell
           */
          showPopup: function showPopup() {
            if (!isMobile) {
              var content = $(this).text();
              var hasHover = $(this).closest(".js-editable").find('.hover-popup').length;
  
              if (content !== "" && !hasHover) {
                var html = "<div class='hover-popup'>" + content + "</div>";
                var $hover = $(html);
                $hover.width($(this).outerWidth());
                $hover.insertAfter($(this));
              }
            }
          },
  
          /**
           * Hide popup on row cell
           */
          hidePopup: function hidePopup() {
            if (!isMobile) {
              $(this).find(".hover-popup").remove();
            }
          },
  
          /**
           * On Updating the url using edit-in-place plugin
           * @param e
           */
          onUpdateUrl: function onUpdateUrl(e) {
            var value = $(this).find('.js-editable__input textarea').val();
            $(this).removeClass("validation-error");
            $(this).find(".js-editable__validate").text("");
  
            if (!supplementalLinks.methods.validateUrl(value)) {
              e.preventDefault();
              $(this).find(".js-editable__validate").text(supplementalLinks.strings["notUrl"]);
              $(this).find('.btn-save').prop('disabled', true);
              $(this).addClass("validation-error");
            }
          },
  
          /**
           * Clear the edit-in-place errors
           */
          cleanURLEditableErrors: function cleanURLEditableErrors() {
            var $item = $(this).closest('.js-editable');
            $item.removeClass("validation-error");
            $item.find('.btn-save').prop('disabled', false);
          }
        }
      },
  
      /**
       * Supplemental Links Modal
       */
      modal: {
        $modal: null,
        $row: null,
        $mode: null,
        $url: null,
        $description: null,
        $type: null,
        $title: null,
        $saveBtn: null,
        $validation: null,
        init: function init() {
          this.$modal = $("#supplemental-links-modal");
          this.$mode = this.$modal.find("input.mode");
          this.$url = this.$modal.find(".link-url");
          this.$description = this.$modal.find(".link-description");
          this.$type = this.$modal.find(".link-type");
          this.$title = this.$modal.find(".modal__title");
          this.$saveBtn = this.$modal.find("#saveLink");
          this.$validation = this.$modal.find(".modal-validation-message");
          this.controller();
        },
  
        /**
         * Modal events handlers
         */
        controller: function controller() {
          this.$modal.on('show.bs.modal', function () {
            supplementalLinks.modal.refreshPlugins();
          });
          this.$saveBtn.on("click", function () {
            if (supplementalLinks.modal.save() !== false) supplementalLinks.modal.hide();
          });
        },
  
        /**
         * Show modal either for adding or editing
         * @param rowNum
         */
        show: function show(rowNum) {
          if (typeof rowNum !== "undefined" && rowNum !== false) {
            this.$row = supplementalLinks.$table.find('tr[data-index="' + rowNum + '"]');
            this.prepare();
            this.$title.text(supplementalLinks.strings.edit);
            this.$mode.val("update");
          } else {
            this.$title.text(supplementalLinks.strings.add);
            this.$mode.val("store");
          }
  
          this.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'show');
        },
  
        /**
         * Hide the modal
         */
        hide: function hide() {
          this.$modal.modal('hide');
        },
  
        /**
         * Refresh the plugins in the modal
         */
        refreshPlugins: function refreshPlugins() {
          jcf.getInstance(this.$type).refresh();
          UX.charCounter.init();
        },
  
        /**
         * Prepare modal inputs from current row
         */
        prepare: function prepare() {
          var data = this.getDataFromRow();
          if (data.url) this.$url.val(data.url);
          if (data.description) this.$description.val(data.description);
          if (data.type && data.type.value) this.$type.val(data.type.value);
        },
  
        /**
         * Get data from the current row
         */
        getDataFromRow: function getDataFromRow() {
          var data = {};
          data.url = this.$row.find(supplementalLinks.tds.url + ' textarea').val();
          data.description = this.$row.find(supplementalLinks.tds.description + ' textarea').val();
          data.type = {};
          data.type.value = this.$row.find(supplementalLinks.tds.type + ' select').val();
          data.type.label = this.$row.find(supplementalLinks.tds.type + ' select').find('option[value="' + data.type.value + '"]').text();
          return data;
        },
  
        /**
         * Get data from modal inputs
         */
        getDataFromModal: function getDataFromModal() {
          var data = {};
          data.url = this.$url.val();
          data.description = this.$description.val();
          data.type = {};
          data.type.value = this.$type.val();
          data.type.label = this.$type.find('option[value="' + data.type.value + '"]').text();
          return data;
        },
  
        /**
         * Save the supplemental link
         */
        save: function save() {
          var mode = this.$mode.val();
          var newData = this.getDataFromModal(); // clear previous errors
  
          supplementalLinks.modal.showError(""); // validate
  
          var validationResult = supplementalLinks.methods.validate(newData);
  
          if (!validationResult.success) {
            supplementalLinks.modal.showError(validationResult.message);
            return false;
          }
  
          switch (mode) {
            case "store":
              this.store(newData);
              break;
  
            case "update":
              this.update(newData);
              break;
          } // clear inputs
  
  
          this.clear();
        },
  
        /**
         * Save new Link
         * @param newData
         */
        store: function store(newData) {
          supplementalLinks.methods.save(newData);
        },
  
        /**
         * Update old Link
         * @param newData
         */
        update: function update(newData) {
          this.$row.find(supplementalLinks.tds.url + ' .js-editable__text').text(newData.url);
          this.$row.find(supplementalLinks.tds.url + ' textarea').val(newData.url);
          this.$row.find(supplementalLinks.tds.description + ' .js-editable__text').text(newData.description);
          this.$row.find(supplementalLinks.tds.description + ' textarea').val(newData.description);
          var $select = this.$row.find(supplementalLinks.tds.type + ' select');
          $select.val(newData.type.value);
          this.$row.find(supplementalLinks.tds.type + ' .td-text').text(newData.type.label);
          jcf.getInstance($select).refresh();
        },
  
        /**
         * Show modal error
         * @param message
         */
        showError: function showError(message) {
          this.$validation.text(message);
        },
  
        /**
         * Clear modal inputs
         */
        clear: function clear() {
          this.$url.val("");
          this.$description.val("");
          this.$type.val("");
          this.refreshPlugins();
        }
      }
    };
    UX.supplementalLinks = supplementalLinks; // add to global namespace
  })(UX);
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/profile-main/js/profile-main.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/profile-main/js/profile-main.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body'),
        isMobile = false;
    var profileMain = {
      $select: null,
      init: function init() {
        profileMain.control();
      },
      control: function control() {
        $body.on('change', '#institutionList', function (e) {
          e.preventDefault();
          profileMain.$select = $(this);
          var href = profileMain.$select.val();
          location.href = href;
        });
        $("#institutionList").val(location.toString());
      }
    };
    UX.profileMain = profileMain; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/profile-menu/js/profile-menu.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/profile-menu/js/profile-menu.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body'),
        isMobile = false; // variable use to determine if responsive mode is on or off
  
    var dropblockUl = {
      $target: null,
      $toggle: null,
      $ul: null,
      $li: null,
      vPort: "screen-sm",
      // default responsive break point
      classes: {
        iconChevronDown: 'icon-arrow_d_n pull-right'
      },
      init: function init() {
        dropblockUl.$target = $('.profile-menu');
        dropblockUl.on.build();
        dropblockUl.control();
      },
      control: function control() {
        $body.on('click', '.profile-menu--res a', function (e) {
          dropblockUl.on.select.dropdown($(this));
        });
        $(document).on(dropblockUl.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
          $('.profile-menu').addClass("profile-menu--res"); // class will be used in our scss (to replace media queries)
  
          dropblockUl.on.build();
        });
        $(document).on(dropblockUl.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
          $('.profile-menu').removeClass("profile-menu--res");
          dropblockUl.on.build();
        });
      },
      on: {
        select: {
          dropdown: function dropdown(elem) {
            var dataAttr = elem.closest('ul').data('mobile-toggle');
  
            if (dataAttr === 'dropdown' || elem.closest('ul').hasClass('dropblock--tab')) {
              var dropdownContainer = elem.closest('.dropBlock');
              dropdownContainer.children('a').find('span').text(elem.text());
            }
          }
        },
        dropdownBuild: function dropdownBuild(elem) {
          // rebuild tabs to be as drop down
          if (UX.dropBlock) {
            UX.dropBlock.init();
          }
  
          elem.wrap('<div class="profile-menu--dropBlock" data-db-parent-of="dbTab-profile-menu"></div>');
          var $dropdownContainer = elem.closest('.profile-menu--dropBlock');
          var $activeTab = dropblockUl.get.activeTab(elem);
          $dropdownContainer.prepend('<a href="#" data-db-target-for="dbTab-profile-menu"><span>' + $activeTab.text() + '</span><i class="' + dropblockUl.classes.iconChevronDown + '" aria-hidden="true"></i></a>');
          elem.attr('data-db-target-of', 'dbTab-profile-menu');
        },
        dropdownDestroy: function dropdownDestroy(elem) {
          // return tabs to default
          var dropdownContainer = elem.closest('.profile-menu--dropBlock');
          dropdownContainer.children('a').remove();
          elem.removeAttr('data-db-target-of').removeClass('js--open').removeAttr('style').unwrap('.profile-menu--dropBlock');
        },
        build: function build() {
          if (isMobile) {
            dropblockUl.on.dropdownBuild(dropblockUl.$target);
          } else {
            dropblockUl.on.dropdownDestroy(dropblockUl.$target);
          }
        }
      },
      get: {
        activeTab: function activeTab(elem) {
          return elem.find('a.active,.active a');
        }
      }
    };
    UX.dropblockUl = dropblockUl; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/publication-content/js/crossref.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/publication-content/js/crossref.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  document.addEventListener('DOMContentLoaded', function (event) {
    var SETTINGS = {
      ENDPOINT: 'https://crossmark.crossref.org/dialog',
      SCRIPT_VERSION: 'v2.0',
      // LOGO_URL: 'http://crossmark-cdn.crossref.org/widget/v2.0/logos/crossmark-logo-square.svg',
      STYLESHEET_URL: 'https://crossmark-cdn.crossref.org/widget/v2.0/style.css'
    };
    var touchStarted = false;
    var touchArea;
  
    var tapEvent = function tapEvent(element, callback) {
      element.addEventListener('click', function (event) {
        if (event.ctrlKey || event.shiftKey || event.metaKey || event.which !== 1) {
          return;
        }
  
        return callback(event);
      }, false);
      element.addEventListener('touchstart', function (event) {
        if (event.touches.length > 1) return touchStarted = false;
        touchArea = {
          x: event.touches[0].screenX,
          y: event.touches[0].screenY
        };
        touchStarted = element;
        event.stopPropagation();
      }, false);
      window.addEventListener('touchstart', function (event) {
        touchStarted = false;
      });
      element.addEventListener('touchmove', function (event) {
        if (event.touches.length > 1) return touchStarted = false;
        var newTouchArea = {
          x: event.touches[0].screenX,
          y: event.touches[0].screenY
        };
  
        if (Math.pow(touchArea.x - newTouchArea.x, 2) + Math.pow(touchArea.y - newTouchArea.y, 2) > 500) {
          touchStarted = false;
        }
      }, false);
      element.addEventListener('touchend', function (event) {
        if (touchStarted) {
          var element = touchStarted;
          touchStarted = false;
          var x = event.changedTouches[0].pageX - window.pageXOffset;
          var y = event.changedTouches[0].pageY - window.pageYOffset;
          var target = document.elementFromPoint(x, y);
          return callback(event);
        } else {
          event.preventDefault();
        }
      }, false);
    };
  
    var buildQueryString = function buildQueryString(data) {
      var query = [];
  
      for (var key in data) {
        query.push(encodeURIComponent(key) + '=' + encodeURIComponent(data[key]));
      }
  
      return '?' + query.join('&');
    };
  
    var isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; // Scan for case-insensitive.
  
    var getDoiMeta = function getDoiMeta() {
      var metaTags = document.querySelectorAll("meta");
  
      for (var i in metaTags) {
        if (metaTags.hasOwnProperty(i)) {
          var tag = metaTags[i];
  
          if ((tag.name || "").toLowerCase() == "dc.identifier" && tag.scheme == "doi") {
            return tag;
          }
        }
      }
    };
  
    var doiMeta = getDoiMeta();
    var doi = doiMeta ? doiMeta.getAttribute('content').replace(/^(info:doi\/|doi:)/, '') : null;
    if (doi == null) doi = $("#crossMark").data('doi');
    var queryData = {
      doi: doi,
      domain: window.location.hostname,
      uri_scheme: window.location.protocol,
      cm_version: SETTINGS.SCRIPT_VERSION
    };
    var css = document.createElement('link');
    css.setAttribute('href', SETTINGS.STYLESHEET_URL);
    css.setAttribute('type', 'text/css');
    css.setAttribute('rel', 'stylesheet');
    document.querySelector('head').appendChild(css);
    var widget = document.createElement('div');
    widget.setAttribute('id', 'crossmark-widget'); // Initial display none to avoid a flash on load.
  
    widget.style.display = 'none';
    widget.innerHTML = '<div class="crossmark-reset crossmark-overlay"></div>' + '<div class="crossmark-reset crossmark-popup">' + '<div class="crossmark-reset crossmark-popup__offset">' + '<div class="crossmark-reset crossmark-popup__inner">' + '<div class="crossmark-reset crossmark-popup__header">' + '<button class="crossmark-reset crossmark-popup__btn-close"><span class="sr-only">Close crossmark popup</span></button>' + '</div>' + '<div class="crossmark-reset crossmark-popup__content-wrapper">' + '<iframe title="Crossmark service - Intentionally blank" aria-hidden="true" class="crossmark-reset crossmark-popup__content"></iframe>' + '</div>' + '</div>' + '</div>' + '</div>';
    var overlay = widget.querySelector('.crossmark-overlay');
    var popup = widget.querySelector('.crossmark-popup');
    var popupOffset = widget.querySelector('.crossmark-popup__offset');
    var popupInner = widget.querySelector('.crossmark-popup__inner');
    var logo = widget.querySelector('.crossmark-popup__logo');
    var content = widget.querySelector('.crossmark-popup__content');
    var closeButton = widget.querySelector('.crossmark-popup__btn-close');
    if (isIos) popupOffset.classList.add('is-ios'); // logo.setAttribute('src', SETTINGS.LOGO_URL);
  
    document.body.appendChild(widget);
    [overlay, popup, closeButton].map(function (element) {
      tapEvent(element, function (event) {
        widget.style.display = 'none';
        event.preventDefault();
        event.stopPropagation();
      });
    });
    tapEvent(popupInner, function (event) {
      event.stopPropagation();
    });
    var initialised = false; // delete queryData.domain;
  
    var links = [].slice.call(document.querySelectorAll('[data-target=crossmark]'), 0);
    links.map(function (link) {
      link.style.cursor = 'pointer';
      link.setAttribute('href', SETTINGS.ENDPOINT + buildQueryString(queryData));
      tapEvent(link, function (event) {
        if (!initialised) {
          content.setAttribute('src', SETTINGS.ENDPOINT + buildQueryString(queryData));
          initialised = true;
        }
  
        widget.style.display = 'block';
        if (isIos) popupInner.style.top = window.scrollY + 'px';
        event.preventDefault();
        event.stopPropagation();
      });
    });
  });
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/publication-content/js/publication-content.js":
  /*!***********************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/publication-content/js/publication-content.js ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var tab = UX.tab;
    var loader = {
      $activator: '',
      doi: '',
      figure: '',
      tab: '',
      references: '',
      related: '',
      details: '',
      $tabs: null,
      $spinner: null,
      figuresTab: '.figures-tab',
      tabFigure: '#pane-pcw-Figures , #pane-pcw-figures',
      referencesTab: '.references-tab',
      tabReferences: '#pane-pcw-References, #pane-pcw-references',
      relatedTab: '.related-tab',
      tabRelated: '#pane-pcw-Related, #pane-pcw-related',
      detailsTab: '.details-tab',
      accessTab: '.access-tab',
      tabDetails: '#pane-pcw-Details, #pane-pcw-details',
      vPort: 'screen-xs',
      isMobile: false,
      mathJaxConfig: 'MathJax.Hub.Config({CommonHTML: { linebreaks: { automatic: true } },"HTML-CSS": { linebreaks: {automatic: true}},SVG: { linebreaks: { automatic: true} },});',
      cloudFlareScript: '',
      openSeaDragonCloudFlareScript: '',
      init: function init() {
        // show spinner
        loader.$tabs = $('.article__tab');
        loader.$spinner = $('.tab__spinner');
        loader.cloudFlareScript = $('.cloudFlareScript').length && $('.cloudFlareScript').val();
        loader.openSeaDragonCloudFlareScript = $('.openSeaDragonCloudFlareScript').length && $('.openSeaDragonCloudFlareScript').val();
        loader.get.figures();
        loader.get.references();
        loader.get.related();
        loader.get.details();
        loader.truncation.init();
  
        if ($('article')) {
          loader.load.articleTabs();
        }
  
        loader.tableToggle();
        loader.controller();
        loader.additionalController();
      },
      controller: function controller() {
        $('body').on('click', '.figures-tab', function (e) {
          loader.load.figures(true);
        });
        $('body').on('click', '.boxed-text', function (e) {
          e.preventDefault();
          var $el = $(this),
              boxedContent = $el.attr('href'),
              boxedHtml = $(boxedContent).html(),
              $myModal = $('#myModal');
  
          if ($myModal.length === 0) {
            var modal_start = '<div class="ux-modal-container"><div id="myModal" class="modal"><div class="modal__dialog  modal--large"><div class="modal-content">',
                modal_header = '<div class="modal__header clearfix"><button type="button" data-dismiss="modal" class="close">X</button></div>',
                modal_body = '<div class="modal__body"></div>',
                modal_end = '</div></div></div></div>',
                modal = modal_start + modal_header + modal_body + modal_end;
            $('body').append(modal);
          }
  
          $myModal.find('.modal__body').html(boxedHtml);
          $myModal.modal('show');
        });
        $(document).on(loader.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          loader.isMobile = true;
          loader.rebuild.responsive();
          loader.rebuild.extra();
          loader.figures.accordion();
        });
        $(document).on(loader.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          loader.isMobile = false;
          loader.rebuild.original();
          loader.figures.back();
        });
        loader.articleTabsTrigger();
        loader.get.mathjax();
      },
      additionalController: function additionalController() {},
      articleTabsTrigger: function articleTabsTrigger() {
        if ($('.access-tab').length) {
          $('.access-tab').trigger('click');
        }
  
        loader.get.mathjax();
      },
      rebuild: {
        original: function original() {
          // return loi to be as default
          var $loaWrapper = $('.loa-wrapper');
          $loaWrapper.find('.accordion-tabbed__tab').removeClass('accordion-tabbed__tab').addClass('accordion-tabbed__tab-mobile');
          $loaWrapper.find('.delimiter').removeClass('hidden');
          var $author = $loaWrapper.find('.accordion-tabbed__control');
          $author.each(function () {
            var id = $(this).attr('data-id');
            $(this).attr('data-db-target-for', id);
            $(this).next().attr('data-db-target-of', id).removeAttr('style');
          });
        },
        responsive: function responsive() {
          // rebuild loi to be in selected responsive mode
          var $loaWrapper = $('.loa-wrapper');
          $loaWrapper.find('.accordion-tabbed__tab-mobile').removeClass('accordion-tabbed__tab-mobile').addClass('accordion-tabbed__tab ').find('.accordion-tabbed__control').removeAttr('data-db-target-for');
          $loaWrapper.find('.loa-accordion').contents().map(function () {
            if (this.nodeType === 3) {
              //Node.TEXT_NODE
              $(this).wrap('<span class="delimiter hidden"></span>');
            }
  
            if ($(this).hasClass('delimiter')) {
              $(this).addClass('hidden');
            }
          });
          $loaWrapper.find('.accordion-tabbed__content').removeAttr('data-db-target-of').hide();
        },
        extra: function extra() {}
      },
      get: {
        figures: function figures() {
          // get current doi
          loader.figure = $('article').attr('data-figures');
        },
        references: function references() {
          // get current doi
          loader.references = $('article').attr('data-references');
        },
        related: function related() {
          // get current doi
          loader.related = $('article').attr('data-related');
        },
        details: function details() {
          // get current doi
          loader.details = $('article').attr('data-details');
        },
        mathjax: function mathjax() {
          if ($("article").attr("data-enable-mathjax") == "true" && ($(".math-formula").length || $(".disp-formula").length || $(".inline-formula").length)) {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"; // use the location of your MathJax
  
            var config = loader.mathJaxConfig;
  
            if (window.opera) {
              script.innerHTML = config;
            } else {
              script.text = config;
            }
  
            document.getElementsByTagName("head")[0].appendChild(script);
          }
        }
      },
      load: {
        articleTabs: function articleTabs() {
          if ($(loader.figuresTab).parent('li.active').length) {
            loader.load.figures();
          }
  
          loader.load.references();
          loader.load.related();
          loader.load.details();
        },
        figures: function figures() {
          var preventSelectActiveTab = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
          // set figures pane as a target and set the requested html file
          loader.load.articleTab(loader.figure, loader.figuresTab, loader.tabFigure, 'figure', preventSelectActiveTab);
        },
        references: function references() {
          // set references pane as a target and set the requested html file
          var $articleReferences = $('.article__body .article__references'); // if the references exist on the body then copy it to ref tab else get it from server
  
          if ($articleReferences.length) {
            if ($('.article__body.show-references').length) {
              //copy past references
              var articlesRefCopy = $articleReferences.clone();
              articlesRefCopy.appendTo(loader.tabReferences);
              $articleReferences.find('[id]').each(function () {
                //to remove dupliate Ids
                this.id = this.id + "_copied";
              });
            } else {
              //cut past references
              $articleReferences.appendTo(loader.tabReferences);
              $articleReferences.show();
            }
  
            $(loader.tabReferences).removeClass('empty');
            loader.$spinner.hide(); // hide spinner pane
          } else {
            loader.load.articleTab(loader.references, loader.referencesTab, loader.tabReferences, 'references');
          }
        },
        related: function related() {
          // set related pane as a target and set the requested html file
          loader.load.articleTab(loader.related, loader.relatedTab, loader.tabRelated, 'related');
          loader.truncation.creativeWorkMeta();
        },
        details: function details() {
          // set details pane as a target and set the requested html file
          loader.load.articleTab(loader.details, loader.detailsTab, loader.tabDetails, 'details');
        },
        articleTab: function articleTab(ajaxUrl, tabSelector, paneSelector, tabName) {
          var preventSelectActiveTab = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
  
          if (ajaxUrl === undefined) {
            // check if tab' service url has been defined
            UX.loader.selectActiveTab(tabSelector, paneSelector, preventSelectActiveTab);
            return false;
          }
  
          if (tab.check.empty($(tabSelector))) {
            // check if tab panes is empty
            loader.getContent(ajaxUrl, tabSelector, paneSelector, tabName, preventSelectActiveTab); // get tab content
          } else {
            UX.loader.selectActiveTab(tabSelector, paneSelector, preventSelectActiveTab);
          }
        }
      },
      getContent: function getContent(ajaxUrl, tabSelector, paneSelector, tabName) {
        var _this = this;
  
        var preventSelectActiveTab = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
        // get content using ajax request
        loader.$spinner.show(); // show spinner pane
  
        var $tabPane = $(paneSelector);
        console.log(document.cookie + "    those are the cookies");
        return;
        fetch(ajaxUrl, {
          credentials: 'include'
        }).then(function (res) {
          res.text().then(function (html) {
            $tabPane.html(html);
            $tabPane.trigger('content-loaded');
            UX.loader.selectActiveTab(tabSelector, paneSelector, preventSelectActiveTab);
            loader.attach();
            var loaderTarget = $(_this).attr('id'),
                isFigures = loader.tabFigure.indexOf(loaderTarget) !== -1;
  
            if (isFigures && loader.isMobile) {
              loader.figures.accordion();
            }
  
            loader.getContentSuccess(tabName);
          });
        })["catch"](function (err) {
          var msg = 'Sorry but there was an error: ';
          console.log(msg + " " + err.toString());
        });
      },
      getContentSuccess: function getContentSuccess(tabName) {},
      selectActiveTab: function selectActiveTab(tab, tabTarget, preventSelectActiveTab) {
        UX.loader.$spinner.hide();
  
        if (!preventSelectActiveTab && UX.loader.isArticleTabEmpty($(tab)) && $(tabTarget).hasClass('active')) {
          $('.details-tab').trigger('click');
        }
      },
      isArticleTabEmpty: function isArticleTabEmpty($tab) {
        return tab.check.empty($tab) || $tab.hasClass('figures-tab') && $($tab.data('slide-target')).find('figure').length === 0 || $tab.hasClass('references-tab') && $($tab.data('slide-target')).find('.NoContentMessage').length;
      },
      attach: function attach() {
        if (UX.figureViewer !== undefined) UX.figureViewer.expand();
      },
      figures: {
        figcaption: "figcaption",
        figureTitle: ".figure__title",
        figureCaption: ".figure__caption",
        accordionClass: "accordion",
        accordionContent: "accordion__content",
        accordionTrigger: $('<button title="Toggle figure caption" class="accordion__control"/>'),
        accordionTriggerIcon: $('<i aria-hidden="true" class="icon-section_arrow_d"/>'),
        accordionTriggerCaption: $('<span>Caption</span>'),
        accordion: function accordion() {
          //turn figures caption into accordion on mobile
          if (!$(loader.figures.figcaption).hasClass(loader.figures.accordionClass)) {
            loader.figures.accordionTriggerCaption.appendTo(loader.figures.accordionTrigger);
            loader.figures.accordionTriggerIcon.appendTo(loader.figures.accordionTrigger);
            $(loader.figures.figcaption).find(loader.figures.figureCaption).before(loader.figures.accordionTrigger);
            $(loader.figures.figcaption).addClass(loader.figures.accordionClass);
            $(loader.figures.figcaption).find(loader.figures.figureCaption).addClass(loader.figures.accordionContent).hide();
          }
        },
        back: function back() {
          // remove accordion features on desktop
          if ($(loader.figures.figcaption).hasClass(loader.figures.accordionClass)) {
            $(".accordion__control").remove();
            $(loader.figures.figcaption).removeClass(loader.figures.accordionClass);
            $(loader.figures.figcaption).find(loader.figures.figureCaption).removeClass(loader.figures.accordionContent).show();
          }
        }
      },
      truncation: {
        toTrunk8: '.loa-accordion',
        toTrunk8Mobile: '.loa.mobile-authors',
        linesToShow: 3,
        MobileLinesToShow: 3,
        showMoreText: 'See all authors',
        showLessText: 'See fewer authors',
        seeMoreIcon: "icon-section_arrow_d",
        seeLessIcon: "icon-section_arrow_u",
        seeMoreIconMobile: "icon-arrow_r",
        init: function init() {
          if (loader.isMobile) {
            $(loader.truncation.toTrunk8Mobile).not("[data-truncate='none']").truncate({
              lines: loader.truncation.MobileLinesToShow,
              type: 'list',
              seeMoreLink: true,
              seeMoreText: loader.truncation.showMoreText,
              seeLessText: loader.truncation.showLessText,
              seeMoreIcon: loader.truncation.seeMoreIcon,
              seeLessIcon: loader.truncation.seeLessIcon,
              seeMoreIconMobile: loader.truncation.seeMoreIconMobile,
              isMobile: true,
              mobileTarget: '#sb-1'
            });
          } else {
            $(loader.truncation.toTrunk8).not("[data-truncate='none']").truncate({
              lines: loader.truncation.linesToShow,
              type: 'list',
              seeMoreLink: true,
              seeMoreText: loader.truncation.showMoreText,
              seeLessText: loader.truncation.showLessText,
              seeMoreIcon: loader.truncation.seeMoreIcon,
              seeLessIcon: loader.truncation.seeLessIcon,
              seeMoreIconMobile: loader.truncation.seeMoreIconMobile
            });
          }
        },
        creativeWorkMeta: function creativeWorkMeta() {
          $('.creative-work .meta').not("[data-truncate='none']").truncate({
            lines: 1
          });
        }
      },
      tableToggle: function tableToggle() {
        var $triggers = $(".tableToggle__trigger");
  
        if ($triggers.length) {
          $triggers.on("click", function (event) {
            var $target = $(event.currentTarget),
                $tableToggle = $target.closest(".tableToggle");
            $tableToggle.find(".tableToggle__table").toggle();
            $tableToggle.find(".tableToggle__image").toggle();
            $target.find("span").toggle();
          });
        }
      }
    };
    UX.loader = loader; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/quick-search/js/quick-search.js":
  /*!*********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/quick-search/js/quick-search.js ***!
    \*********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var quickSearch = {
      confNumOfHistoryItems: '',
      confNumOfPublicationTitles: '',
      confNumOfGroupItems: '',
      confNumOfPublicationItems: '',
      confNumOfTopics: '',
      confNumOfContributors: '',
      confNumOfDOIItems: '',
      removeOptionEnabled: true,
      removeOptionHtml: '[Remove]',
      init: function init() {
        quickSearch.defineCatcomplete();
        quickSearch.initAutoComplete();
        quickSearch.controller();
        quickSearch.additionalController();
      },
      controller: function controller() {
        $(document).on('submit', '[name="defaultQuickSearch"],[name="citationQuickSearch"],[name="thisJournalQuickSearch"]', function (e) {
          var empty = true;
          $(this).find('input[type="text"],input[type="search"]').each(function () {
            if ($(this).val() && $(this).val() !== '') {
              empty = false;
            }
          });
  
          if ($(this).find('.ms-sel-item').length > 0) {
            empty = false;
          }
  
          if (empty) {
            window.location = '/search/advanced';
            e.preventDefault();
          }
        }); // FOCUS TRAP for QuickSearch in Dropdown
  
        $(function () {
          $(document).on('keydown', '.quick-search :tabbable:not([readonly])', function (e) {
            var loop = $(this).closest('.quick-search');
  
            if ($body.attr('data-active') !== 'dropBlock' && !loop.closest('.dropBlock__holder.js--open').length) {
              return;
            }
  
            var firstTabbable = loop.find(':tabbable:not([readonly])').first();
            var lastTabbable = loop.find(':tabbable:not([readonly])').last(); // Leaving the first element with Tab : focus the last one
  
            if (firstTabbable.is(e.target) && e.shiftKey === true && window.innerWidth >= UX.grid.screenMd) {
              e.preventDefault();
              lastTabbable.focus();
            } // Leaving the last element with Tab : focus the first one
  
  
            if (lastTabbable.is(e.target) && e.shiftKey === false) {
              if (e.which === 13) {
                UX.dropBlock.on.hide();
              }
  
              e.preventDefault();
              firstTabbable.focus();
            }
          });
        });
      },
      additionalController: function additionalController() {},
      defineCatcomplete: function defineCatcomplete() {
        $.widget('custom.catcomplete', $.ui.autocomplete, {
          _create: function _create() {
            this._super();
  
            this.widget().addClass('quickSearchAutocomplete');
            this.widget().menu('option', 'items', '> :not(.qsaCategory)');
          },
          _renderMenu: function _renderMenu(ul, items) {
            if ($(this.element).attr('name') === 'quickLinkJournal') {
              ul.addClass('citation');
            }
  
            if ($(this.element).closest('.quick-search').find('.quick-search__links-wrapper').length) {
              ul.addClass('with-advanced-links');
            }
  
            var fuzzySuggesterEnabled = $(this.element).data('fuzzy-suggester');
            var that = this;
  
            if (fuzzySuggesterEnabled) {
              $(ul).addClass('newSuggester');
            }
  
            $.each(items, function (index, item) {
              if (fuzzySuggesterEnabled) {
                var catSelector = '.ui-autocomplete-category[data-category="' + item.category + '"]';
  
                if ($(catSelector).length < 1) {
                  if (item.category === 'Quick Links') {
                    ul.prepend('<li class="ui-autocomplete-category" data-category="' + item.category + '">' + item.category + '</li>');
                  } else {
                    ul.append('<li class="ui-autocomplete-category" data-category="' + item.category + '">' + item.category + '</li>');
                  }
                }
  
                var $item = that._renderItemData(ul, item);
  
                $(ul).children(catSelector).after($item);
              } else {
                var $item = that._renderItemData(ul, item);
  
                $(ul).append($item);
              }
            });
  
            if ($('.ui-autocomplete-category').size() < 2) {
              $('.ui-autocomplete-category').remove();
            }
          },
          _renderItem: function _renderItem(ul, item) {
            var fuzzySuggesterEnabled = $(this.element).data('fuzzy-suggester');
            var $aWrap = $('<a>').addClass('qsaHistoryItem');
  
            if (item.history) {
              var itemSpan = quickSearch.getItem(item, true);
  
              if (quickSearch.removeOptionEnabled) {
                var removeDiv = $('<a>').attr('href', '#').addClass('qsaRemove').html(quickSearch.removeOptionHtml);
                removeDiv.bind('click', function (e) {
                  e.preventDefault();
                  e.stopPropagation();
                  var selectedHistoryItem = $(e.target.parentNode.parentNode).data().qsaItem;
                  var autoCompeteSearchUri = ['/action/doDeleteHistory?ajax=true&uri=', encodeURIComponent(selectedHistoryItem.value)].join('');
                  $.ajax(autoCompeteSearchUri).done(function (result) {
                    if (result === 'true') {
                      e.target.parentNode.remove();
                    }
                  });
                });
              }
  
              $aWrap.append(removeDiv);
              $aWrap.append(itemSpan);
            } else {
              $aWrap.html(quickSearch.getItem(item, false)).attr('title', item.label);
            }
  
            var $elm = $('<li>').data('qsaItem', item).data('item-param', item.param).append($aWrap).addClass('qsaItem');
            $elm.attr('aria-label', item.label);
  
            if (item.category && fuzzySuggesterEnabled) {
              $elm.attr('aria-label', item.category + ' : ' + item.label);
              $elm.attr('data-category', item.category);
            }
  
            return $elm;
          },
          _resizeMenu: function _resizeMenu() {
            var ul = this.menu.element;
  
            if (this.element.outerWidth() < 250) {
              ul.outerWidth(this.element.outerWidth() + 40 / 100 * this.element.outerWidth());
            } else {
              ul.outerWidth(this.element.outerWidth());
            }
  
            if ($('.advanced-and-citation-block').length) {
              $('.advanced-and-citation-block').clone().appendTo(ul);
            }
          }
        });
      },
      initAutoComplete: function initAutoComplete() {
        $('.quickSearchFormContainer .autocomplete').catcomplete({
          source: function source(request, response) {
            var enteredTerm = request.term,
                $inputElem = $(this.element),
                maxWords = $inputElem.data('auto-complete-max-words'),
                maxChars = $inputElem.data('auto-complete-max-chars'),
                fuzzySuggesterEnabled = $inputElem.data('fuzzy-suggester');
  
            if (enteredTerm.split(' ').length > maxWords || enteredTerm.length > maxChars || !enteredTerm.replace(/\s/g, '').length) {
              return false;
            }
  
            var selectedOption = $inputElem.closest('.quick-search').find('.search-in--dropblock .active a').text().toLowerCase(),
                autoCompleteSearchType = '';
  
            if (selectedOption === 'title' || selectedOption === 'citation') {
              autoCompleteSearchType = 'title-';
            } else if (selectedOption === 'contrib') {
              autoCompleteSearchType = 'contrib-';
            }
  
            if (fuzzySuggesterEnabled) {
              autoCompleteSearchType = 'fuzzy-';
            }
  
            quickSearch.defineConf($inputElem);
            var isDisabled = quickSearch.disableAutoCompleteIfAllSetToZero();
  
            if (!isDisabled) {
              quickSearch.sendAjaxRequest($inputElem, enteredTerm, autoCompleteSearchType, selectedOption, response);
            }
          },
          //To prevent showing value when user is using up/down arrow key
          focus: function focus(event, ui) {
            return false;
          },
          //autoFocus:true,
          select: function select(event, ui) {
            quickSearch.additionalSelect(ui);
  
            if ($(event.target).attr('name') !== 'quickLinkJournal') {
              $(event.target).val(ui.item.label);
              window.location.href = quickSearch.setPageUrl(ui);
            } else {
              $(event.target).val(ui.item.label);
            }
  
            return false;
          }
        }).bind('click', function (e) {
          $(this).catcomplete({
            minLength: 2
          });
        });
      },
      additionalSelect: function additionalSelect(ui) {},
      defineConf: function defineConf($inputSearchText) {
        quickSearch.confNumOfHistoryItems = $inputSearchText.data('history-items-conf');
        quickSearch.confNumOfPublicationTitles = $inputSearchText.data('publication-titles-conf');
        quickSearch.confNumOfGroupItems = $inputSearchText.data('group-titles-conf');
        quickSearch.confNumOfPublicationItems = $inputSearchText.data('publication-items-conf');
        quickSearch.confNumOfTopics = $inputSearchText.data('topics-conf');
        quickSearch.confNumOfContributors = $inputSearchText.data('contributors-conf');
        quickSearch.confNumOfDOIItems = $inputSearchText.data('doi-items-conf');
      },
      disableAutoCompleteIfAllSetToZero: function disableAutoCompleteIfAllSetToZero() {
        return quickSearch.confNumOfHistoryItems === 0 && quickSearch.confNumOfGroupItems === 0 && quickSearch.confNumOfPublicationTitles === 0 && quickSearch.confNumOfTopics === 0 && quickSearch.confNumOfContributors === 0 && quickSearch.confNumOfPublicationItems === 0 && quickSearch.confNumOfDOIItems === 0;
      },
      sendAjaxRequest: function sendAjaxRequest($inputSearchText, enteredTerm, autoCompleteSearchType, selectedOption, response) {
        var results = [],
            fuzzySuggesterEnabled = $inputSearchText.data('fuzzy-suggester'),
            displayLabels = $inputSearchText.data('display-labels');
  
        if (selectedOption === 'citation') {
          //quick fix for LIT-138406
          var autoCompeteSearchUrl = ['/action/doSuggest?target=title-auto-complete&query=', enteredTerm, '&pts=', quickSearch.confNumOfPublicationTitles, '&fl=PubID'].join('');
        } else {
          var autoCompeteSearchUrl = ['/action/doSuggest?target=', autoCompleteSearchType, 'auto-complete&query=', enteredTerm, '&hs=', quickSearch.confNumOfHistoryItems, '&pts=', quickSearch.confNumOfPublicationTitles, '&ptgs=', quickSearch.confNumOfGroupItems, '&ptfs=', quickSearch.confNumOfPublicationItems, '&ts=', quickSearch.confNumOfTopics, '&cs=', quickSearch.confNumOfContributors, '&fl=PubID'].join('');
        }
  
        if (fuzzySuggesterEnabled) {
          autoCompeteSearchUrl = [autoCompeteSearchUrl, '&its=', quickSearch.confNumOfDOIItems].join('');
        }
  
        $.getJSON(autoCompeteSearchUrl).done(function (resultData) {
          var numOfTitles, NumOfGroupItems, numOfItems, numOfTopics, numOfContrib, numOfHistory, numOfDOIItems;
          numOfTitles = NumOfGroupItems = numOfItems = numOfTopics = numOfContrib = numOfHistory = numOfDOIItems = 0;
  
          var getSuggestion = function getSuggestion(item) {
            var paramFormattedValue;
  
            if (item.param === "SeriesKey") {
              paramFormattedValue = "Journal";
            } else if (item.param === "ContentGroupKey") {
              if (item.seriesKey === "mrwseries") {
                paramFormattedValue = "Reference Work";
              } else {
                paramFormattedValue = "Book";
              }
            } else {
              paramFormattedValue = item.paramFormatted;
            }
  
            var suggestion = quickSearch.setSuggestion(item, paramFormattedValue, fuzzySuggesterEnabled, displayLabels, selectedOption);
            return suggestion;
          }; //resultData = [{"param":"DOI","value":"10.15766/mep_2374-8265.10019","label":"Utilizing Caries Management by Risk Assessment (CAMBRA) for the Purpose of Creating a Caries Prevention Treatment Plan for Individualized Patient Care","highlight":"Utilizing \u003cspan class\u003d\"fuzzy-match\"\u003eCaries\u003c/span\u003e Management by Risk Assessment (\u003cspan class\u003d\"fuzzy-match\"\u003eCAMBRA\u003c/span\u003e) for the Purpose of Creating a \u003cspan class\u003d\"fuzzy-match\"\u003eCaries\u003c/span\u003e Prevention Treatment Plan for Individualized Patient \u003cspan class\u003d\"fuzzy-match\"\u003eCare\u003c/span\u003e","paramFormatted":"Article","seriesKey":"mep","url":"/doi/abs/10.15766/mep_2374-8265.10019"},{"param":"DOI","value":"10.15766/mep_2374-8265.10327","label":"Simulation Case: Cardiac Arrest After Carbon Dioxide (CO2) Embolism","highlight":"Simulation \u003cspan class\u003d\"fuzzy-match\"\u003eCase\u003c/span\u003e: \u003cspan class\u003d\"fuzzy-match\"\u003eCardiac\u003c/span\u003e Arrest After \u003cspan class\u003d\"fuzzy-match\"\u003eCarbon\u003c/span\u003e Dioxide (CO2) Embolism","paramFormatted":"Article","seriesKey":"mep","url":"/doi/abs/10.15766/mep_2374-8265.10327"},{"param":"DOI","value":"10.15766/mep_2374-8265.10082","label":"Simulation Case: Cardiac Arrest During Pediatric Posterior Spinal Fusion","highlight":"Simulation \u003cspan class\u003d\"fuzzy-match\"\u003eCase\u003c/span\u003e: \u003cspan class\u003d\"fuzzy-match\"\u003eCardiac\u003c/span\u003e Arrest During Pediatric Posterior Spinal Fusion","paramFormatted":"Article","seriesKey":"mep","url":"/doi/abs/10.15766/mep_2374-8265.10082"},{"param":"ContribAuthorStored","value":"McCoy, Matthew","label":"McCoy, Matthew","highlight":"McCoy, Matthew","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dMcCoy%2C+Matthew"},{"param":"ContribAuthorStored","value":"Cai, Jennifer","label":"Cai, Jennifer","highlight":"\u003cspan onclick\u003d\"highlight()\" class\u003d\"single_highlight_class\"\u003eCa\u003c/span\u003ei, Jennifer","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dCai%2C+Jennifer"},{"param":"ContribAuthorStored","value":"Wong, Ka Kit","label":"Wong, Ka Kit","highlight":"Wong, Ka Kit","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dWong%2C+Ka+Kit"},{"param":"ContribAuthorStored","value":"Kai, Tara","label":"Kai, Tara","highlight":"Kai, Tara","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dKai%2C+Tara"},{"param":"ContribAuthorStored","value":"Whittaker, Mary-Kay","label":"Whittaker, Mary-Kay","highlight":"Whittaker, Mary-Kay","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dWhittaker%2C+Mary-Kay"},{"param":"ContribAuthorStored","value":"Zuo, Stephanie W","label":"Zuo, Stephanie W","highlight":"Zuo, Stephanie W","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dZuo%2C+Stephanie+W"},{"param":"ContribAuthorStored","value":"Craven, Kay","label":"Craven, Kay","highlight":"Craven, Kay","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dCraven%2C+Kay"},{"param":"ContribAuthorStored","value":"Key-Solle, Mikelle","label":"Key-Solle, Mikelle","highlight":"Key-Solle, Mikelle","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dKey-Solle%2C+Mikelle"},{"param":"ContribAuthorStored","value":"Kay, Denise","label":"Kay, Denise","highlight":"Kay, Denise","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dKay%2C+Denise"},{"param":"ContribAuthorStored","value":"Choi, Seungtaek","label":"Choi, Seungtaek","highlight":"Choi, Seungtaek","paramFormatted":"Author","url":"/action/doSearch?ContribAuthorStored\u003dChoi%2C+Seungtaek"}];
  
  
          $.each(resultData, function (i, item) {
            quickSearch.prependSearchOption(i, $inputSearchText, enteredTerm, results);
  
            if (item.param === 'history' && numOfHistory < quickSearch.confNumOfHistoryItems) {
              results.push(getSuggestion(item));
              numOfHistory++;
            } else if (item.param === 'SeriesKey' && numOfTitles < quickSearch.confNumOfPublicationTitles) {
              results.push(getSuggestion(item));
              numOfTitles++;
            } else if (item.param === 'DOI' && numOfItems < quickSearch.confNumOfPublicationItems) {
              results.push(getSuggestion(item));
              numOfItems++;
            } else if (item.param === 'ContentGroupKey' && NumOfGroupItems < quickSearch.confNumOfGroupItems) {
              results.push(getSuggestion(item));
              NumOfGroupItems++;
            } else if (item.param === 'ConceptID' && numOfTopics < quickSearch.confNumOfTopics) {
              results.push(getSuggestion(item));
              numOfTopics++;
            } else if (item.param === 'ContribAuthorRaw' && numOfContrib < quickSearch.confNumOfContributors) {
              results.push(getSuggestion(item));
              numOfContrib++;
            } else if (item.param === 'DOI' && numOfDOIItems < confNumOfDOIItems) {
              results.push(getSuggestion(item));
              numOfDOIItems = numOfDOIItems + 1;
            }
          });
          response(results);
        }).fail(function () {
          console.log('failed');
        });
      },
      getItem: function getItem(item, history) {
        if (history) {
          return $.parseHTML(item.highlight);
        } else {
          return item.highlight;
        }
      },
      setPageUrl: function setPageUrl() {
        return ui.item.value;
      },
      setSuggestion: function setSuggestion(item, paramFormattedValue, fuzzySuggesterEnabled, displayLabels, selectedOption) {
        var suggestion = {
          'label': item.label,
          'highlight': item.highlight,
          'category': item.param === 'DOI' ? 'Quick Links' : 'Suggested Search',
          'param': item.param,
          'paramFormatted': paramFormattedValue,
          'history': false
        };
  
        if (item.param === 'history') {
          suggestion['value'] = decodeURI(item.value);
          suggestion['history'] = true;
        } else if (selectedOption === 'citation') {
          suggestion['value'] = item.url;
        } else {
          suggestion['value'] = item.url;
        }
  
        if (fuzzySuggesterEnabled && displayLabels) {
          suggestion['highlight'] += '<span class="pull-right suggestionType">' + item.paramFormatted + '</span>';
        }
  
        return suggestion;
      },
      prependSearchOption: function prependSearchOption(i, $inputSearchText, enteredTerm, results) {}
    };
    UX.quickSearch = quickSearch; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/raa/js/raa.js":
  /*!***************************************************!*\
    !*** /home/irahhal/ui-core/widgets/raa/js/raa.js ***!
    \***************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var raa = {};
  $(document).ready(function () {
    // display user login popup - loginBar
    $(document).on('click', '#indivLogin, #guestLogin', function (event) {
      event.preventDefault();
      event.stopPropagation();
      $(this).toggleClass("active");
      $(".navigation-login-dropdown-container:not(.login-options)").toggleClass('hidden');
  
      if ($('.search-open').is(":visible")) {
        toggleQuickSearch();
      }
    });
    $(document).on('click', function (e) {
      if ($(e.target).attr('id') !== 'indivLogin' && $(e.target).attr('id') !== 'guestLogin' && !$('.navigation-login-dropdown-container').hasClass('hidden')) {
        $('.navigation-login-dropdown-container').addClass('hidden');
      }
    }); // enable sumbit btn for access token widget
  
    $('#accessTokenForm div.input-group input[type=text]').on('keyup input change', function () {
      !$('#accessTokenForm div.input-group #tokenAccess').val().length ? $('#accessTokenForm input[type=submit]').attr('disabled', 'disabled') : $('#accessTokenForm input[type=submit]').removeAttr('disabled');
    }); // enable sumbit btn for access token widget
  
    $('.registration-popup input[type=submit]').attr('disabled', 'disabled');
    $('.registration-popup input[type=text]').on('keyup input change', function () {
      !$(this).val().length ? $('.registration-form input[type=submit]').attr('disabled', 'disabled') : $('.registration-form input[type=submit]').removeAttr('disabled');
    }); // display verification code hidden msg after 3m
  
    if ($('#check-if-exist')) {
      setTimeout(function () {
        $('#hidden-message').css('visibility', 'visible');
      }, 30000);
    } // enable sumbit btn for 2-step widget
  
  
    $('#check-if-exist input[type=input]').on('keyup input change', function () {
      !$('#check-if-exist input[type=input]').val().length ? $('#check-if-exist input[type=submit]').attr('disabled', 'disabled') : $('#check-if-exist input[type=submit]').removeAttr('disabled');
    });
  });
  $(window).on('load', function () {
    // recaptcha load
    if ($('.g-recaptcha').length) {
      loadRecaptcha();
    }
  });
  
  function loadInstitutionPage(selectDom) {
    var href = $(selectDom).val();
    location.href = href;
  }
  
  window.loadInstitutionPage = loadInstitutionPage; // add to global namespace
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/raa/js/two-factors-authentication.js":
  /*!**************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/raa/js/two-factors-authentication.js ***!
    \**************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  if (document.addEventListener) {
    document.addEventListener("DOMContentLoaded", twoFactorAuthentication, false);
  } else {
    document.onreadystatechange = twoFactorAuthentication;
  }
  
  function twoFactorAuthentication() {
    if (document.getElementById('select-list-hidden')) {
      var functionX = function functionX(e) {
        var targetedElement = null;
        if (typeof e == 'undefined') e = window.event;
  
        if (typeof e.srcElement == 'undefined') {
          targetedElement = e.originalTarget;
        } else {
          targetedElement = e.srcElement;
        }
  
        if (targetedElement.tagName === 'A') {
          e.preventDefault ? e.preventDefault() : e.returnValue = false;
          var firstchildnew = document.getElementById('selectOneOfTheOptions').getElementsByTagName('a')[0];
          var true1 = document.getElementById('selectOneOfTheOptions').getElementsByTagName("a");
  
          if (true1) {
            e.preventDefault ? e.preventDefault() : e.returnValue = false;
            true1.innerHTML = targetedElement;
            var clon3 = targetedElement.cloneNode(true);
            var res = clon3.innerHTML.split("+");
            clon3.innerHTML = '+' + res[1];
            document.getElementById("selectOneOfTheOptions").appendChild(clon3);
            firstchildnew.remove();
          }
  
          functionaddToHidden(e);
        }
      }; ////////////////////////to add selected country to hidden value and updated it directly after country select////////////////////////////////
  
  
      // Strip non numbers from the value of the phone input
      var stripNonNumbers = function stripNonNumbers(val) {
        return val.replace(/\D/g, '');
      };
  
      var functionaddToHidden = function functionaddToHidden(e) {
        var input = document.getElementById('js__mobile-countries');
        var messages = document.getElementById('codeAndPhone');
        e = e || window.event;
        if (typeof e == 'undefined') e = window.event;
  
        if (typeof e.srcElement == 'undefined') {
          var sourceb = e.originalTarget;
        } else {
          var sourceb = e.srcElement;
        }
  
        if (sourceb.tagName == "A") {
          var code2 = sourceb.innerHTML;
          var res = code2.split("+");
          code2 = '+' + res[1];
          var messages = document.getElementById('codeAndPhone');
          messages.value = code2 + input.value;
        } else if (sourceb.tagName == "INPUT") {
          var functionY = function functionY(e) {
            var code = document.getElementById('selectOneOfTheOptions').getElementsByTagName('a')[0].innerHTML;
            var res = code.split("+");
            code = '+' + res[1];
            messages.value = code + input.value;
          };
  
          if (input.addEventListener) {
            input.addEventListener("input", function (e) {
              functionY(e || event);
            }, false);
          } else {
            input.attachEvent("onpropertychange", function (e) {
              functionY(e || event);
            });
          }
  
          ;
        }
  
        document.getElementById("js__countries-select").className = "f32 hide";
      };
  
      var hasClass = function hasClass(element, cls) {
        return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
      }; /////////////////////////////////////////////////////////
  
  
      var closestt = function closestt(el, selector) {
        // traverse parents
        while (el !== null) {
          elementParent = el.parentElement;
  
          if (elementParent !== null && (hasClass(elementParent, selector) || hasClass(el, "flag"))) {
            return elementParent;
          }
  
          el = elementParent;
        }
  
        return null;
      };
  
      var hide = function hide() {
        var elem = document.getElementById('select-list-hidden');
        elem.style.display = 'none';
      };
  
      var findNextTabStop = function findNextTabStop(el, dir) {
        var universe = document.querySelectorAll('#js__countries-select a');
        var list = Array.prototype.filter.call(universe, function (item) {
          return item.tabIndex >= "-1";
        });
        var index = list.indexOf(el);
  
        if (dir == "next") {
          return list[index + 1] || list[0];
        } else {
          return list[index - 1] || list[0];
        }
      }; // up and down accessibility code
  
  
      var first = document.getElementById('container-all');
      var scrollableList = document.createElement("div");
      scrollableList.setAttribute('class', 'scrollableList');
      first.appendChild(scrollableList); /////////////////////////////////////////////////////////////////////
  
      var parent_node = document.querySelectorAll('.scrollableList');
      var selectOneOfTheOptions = document.createElement("div");
      selectOneOfTheOptions.setAttribute('id', 'selectOneOfTheOptions');
      parent_node[0].appendChild(selectOneOfTheOptions); /////////////////////////////////////////////////////////////////////
  
      var js__countries_select = document.createElement("ul");
      js__countries_select.setAttribute('tabindex', '-1');
      js__countries_select.setAttribute('id', 'js__countries-select');
      js__countries_select.setAttribute('class', 'f32 hide');
      parent_node[0].appendChild(js__countries_select); /////////////////////////////////////////////////////////////////////
  
      var selectList = document.getElementById('select-list-hidden').getElementsByTagName('option');
  
      for (var j = 0; j < selectList.length; j++) {
        var a = selectList[j];
        var countries_text = selectList[j].text;
        var ulss = document.getElementById('js__countries-select');
        var classesAll = selectList[j].getAttribute("class");
        var node = document.createElement("li");
        ulss.appendChild(node);
        var ulss = document.getElementById('js__countries-select').getElementsByTagName('li')[j];
        var linkes_to_add = document.createElement("a");
        var textnode = document.createTextNode(countries_text);
  
        if (j == 0) {
          linkes_to_add.setAttribute('tabindex', '0');
        }
  
        linkes_to_add.setAttribute('href', '#');
        linkes_to_add.appendChild(textnode);
        linkes_to_add.setAttribute('class', classesAll);
        ulss.appendChild(linkes_to_add);
      }
  
      var li23 = document.createElement('i');
      li23.innerHTML = '';
      li23.setAttribute('class', 'countries-select '); // and make sure myclass has some styles in css
  
      document.getElementById("selectOneOfTheOptions").appendChild(li23); ////////////////////////////////////////////////////////////////////////////////////////
      //var innerHtmlItems = document.getElementById("js__countries-select").getElementsByTagName("li")[0].innerHTML;
  
      var true2 = document.getElementById('selectOneOfTheOptions').getElementsByTagName("a");
      var innerdeep = document.getElementById("js__countries-select").getElementsByTagName("li")[0].getElementsByTagName("a")[0];
      document.createElement('a');
      var like = innerdeep;
      true2.innerHTML = like;
      var clon3 = like.cloneNode(true);
      var res = clon3.innerHTML.split("+");
      clon3.innerHTML = '+' + res[1];
      document.getElementById("selectOneOfTheOptions").appendChild(clon3);
  
      document.getElementById("selectOneOfTheOptions").onclick = function (e) {
        if (typeof e == 'undefined') e = window.event;
        e.preventDefault ? e.preventDefault() : e.returnValue = false;
  
        if (document.getElementById("js__countries-select").className == "f32 hide") {
          e.preventDefault ? e.preventDefault() : e.returnValue = false;
          document.getElementById("js__countries-select").className = "f32";
          var focusedElement = document.getElementById("js__countries-select").getElementsByTagName('a')[0];
          focusedElement.focus();
          e = e || window.event;
          document.getElementById("js__countries-select").className = "f32";
        } else {
          document.getElementById("js__countries-select").className = "f32 hide";
        }
      }; ///////////////////////////////////////////////////////////////////////////////
  
  
      var ul = document.getElementById('js__countries-select'); // Parent
  
      if (ul.addEventListener) {
        ul.addEventListener("click", function (e) {
          functionX(e || event);
        }, false);
      } else {
        ul.attachEvent("onclick", function (e) {
          functionX(e || event);
        });
      }
  
      document.getElementById('js__mobile-countries').onkeydown = function (e) {
        if (typeof e == 'undefined') {
          e = window.event;
        }
  
        functionaddToHidden(e);
      };
  
      document.getElementById('js__mobile-countries').onkeyup = function (e) {
        var start = this.selectionStart,
            end = this.selectionEnd;
        this.value = stripNonNumbers(this.value);
        this.setSelectionRange(start, end);
        $(".OK-btn").attr("disabled", !this.value);
      };
  
      document.getElementById('js__mobile-countries').addEventListener("focusout", function (e) {
        this.value = stripNonNumbers(this.value);
      });
  
      document.getElementById('js__countries-select').getElementsByTagName('a').onmousedown = function (e) {
        if (typeof e == 'undefined') e = window.event;
        functionaddToHidden(e);
      };
  
      if (!Array.prototype.some) {
        Array.prototype.some = function (func) {
          for (var i in this) {
            if (func(i)) return true;
          }
  
          return false;
        };
      }
  
      document.onmousedown = function (e) {
        if (typeof e == 'undefined') e = window.event;
  
        if (typeof e.srcElement == 'undefined') {
          var sourceE = e.originalTarget;
        } else {
          var sourceE = e.srcElement;
        }
  
        if (closestt(sourceE, '.js__pincode-container') == null && !(sourceE.id == "js__countries-select")) {
          if (document.getElementById('js__mobile-countries')) {
            document.getElementById("js__countries-select").className = "f32 hide";
          }
        }
      };
  
      window.onload = hide;
  
      Element.prototype.remove = function () {
        this.parentElement.removeChild(this);
      }; //Added "remove" function to work on ie8
  
  
      NodeList.prototype.remove = HTMLCollection.prototype.remove = function () {
        for (var i = this.length - 1; i >= 0; i--) {
          if (this[i] && this[i].parentElement) {
            this[i].parentElement.removeChild(this[i]);
          }
        }
      }; //Added "filter" function to work on ie8
  
  
      if (!Array.prototype.filter) {
        Array.prototype.filter = function (fun
        /*, thisp */
        ) {
          "use strict";
  
          if (this === void 0 || this === null) throw new TypeError();
          var t = Object(this);
          var len = t.length >>> 0;
          if (typeof fun !== "function") throw new TypeError();
          var res = [];
          var thisp = arguments[1];
  
          for (var i = 0; i < len; i++) {
            if (i in t) {
              var val = t[i]; // in case fun mutates this
  
              if (fun.call(thisp, val, i, t)) res.push(val);
            }
          }
  
          return res;
        };
      } //Added "indexof" function to work on ie8
  
  
      if (!Array.prototype.indexOf) {
        Array.prototype.indexOf = function (elt
        /*, from*/
        ) {
          var len = this.length >>> 0;
          var from = Number(arguments[1]) || 0;
          from = from < 0 ? Math.ceil(from) : Math.floor(from);
          if (from < 0) from += len;
  
          for (; from < len; from++) {
            if (from in this && this[from] === elt) return from;
          }
  
          return -1;
        };
      }
  
      document.onkeydown = function (event) {
        event = event || window.event;
  
        if (typeof event.srcElement == 'undefined') {
          var classes = event.originalTarget;
        } else {
          var classes = event.srcElement;
        }
  
        if (event.keyCode == 40 || event.which == 40) {
          //var classes = event.srcElement;
          event.preventDefault ? event.preventDefault() : event.returnValue = false;
          var nextEl = findNextTabStop(classes, "next");
          nextEl.focus();
        } else if (event.keyCode == 38 || event.which == 38) {
          //var classes=event.target;
          event.preventDefault ? event.preventDefault() : event.returnValue = false;
          var nextEl = findNextTabStop(classes, "prev");
          nextEl.focus();
        } // close pincode after clicking escape key
  
  
        var isEscape = false;
  
        if ("key" in event) {
          isEscape = event.key == "Escape";
        } else {
          isEscape = event.keyCode == 27;
        }
  
        if (isEscape) {
          document.getElementById("js__countries-select").className = "f32 hide";
        } // "Enter" press handler
  
  
        var targetEL = event.target;
  
        if ((event.keyCode == 13 || event.which == 13) && hasClass(targetEL, "flag")) {
          if (document.getElementById("js__countries-select").className == "f32 hide") {
            var focusedElement = document.getElementById("js__countries-select").getElementsByTagName('a')[0];
            focusedElement.focus();
            event = event || window.event;
            document.getElementById("js__countries-select").className = "f32";
          } else {
            if (!hasClass(document.getElementById("js__countries-select"), "hide")) {
              event.preventDefault ? event.preventDefault() : event.returnValue = false;
              document.getElementById("js__mobile-countries").focus();
              document.getElementById("js__countries-select").className = "f32 hide";
            }
          }
  
          var keycode1 = event.keyCode ? event.keyCode : event.which;
          var targetedElement = event.target;
  
          if (targetedElement.tagName === 'A') {
            var firstchildnew = document.getElementById('selectOneOfTheOptions').getElementsByTagName('a')[0];
            var true1 = document.getElementById('selectOneOfTheOptions').getElementsByTagName("a");
  
            if (true1) {
              var targetedElement = event.target;
              var like = targetedElement;
              var li2 = document.createElement('a');
              li2.setAttribute('href', '#');
              true1.innerHTML = li2;
              var toremove = document.getElementById('selectOneOfTheOptions').getElementsByTagName("a")[0];
              var toremoveinner = toremove;
              var clon3 = like.cloneNode(true);
              var res = clon3.innerHTML.split("+");
              clon3.innerHTML = '+' + res[1];
              document.getElementById("selectOneOfTheOptions").appendChild(clon3);
              firstchildnew.remove();
            }
          }
        } // alphabetical accessibility handler
  
  
        e = event || document.event;
        if (typeof e == 'undefined') e = document.event;
  
        if (e.keyCode >= 65 && e.keyCode <= 130 || e.which >= 65 && e.which <= 130) {
          var keycode1 = e.keyCode ? e.keyCode : e.which;
          var string1 = String.fromCharCode(keycode1);
          var searchon1 = document.getElementById('js__countries-select').getElementsByTagName('a');
  
          for (var j = 0; j < searchon1.length; j++) {
            var a = searchon1[j];
            var countries_text = searchon1[j].innerHTML;
            var chare = countries_text.charAt(0);
            var lowercase = chare.toLowerCase();
            var lowString1 = string1.toLowerCase();
  
            if (lowString1 == lowercase) {
              searchon1[j].focus();
              return true;
            }
          }
        }
      };
    }
  
    if (document.getElementById('check-if-exist')) {
      setTimeout(function () {
        document.getElementById('hidden-message').style.visibility = "visible";
        document.getElementById('hidden-message').style.display = "block";
      }, 30000);
    }
  
    var submit,
        passPin = document.getElementsByClassName("type-pass-pin")[0];
  
    if (passPin) {
      passPin.addEventListener('keyup', function () {
        console.log("s");
        var children = this.form.children;
  
        for (var i = 0; i < children.length; i++) {
          if (children[i].className == "OK-btn") {
            submit = children[i];
            break;
          }
        }
  
        $(".OK-btn").attr("disabled", !this.value);
      });
    }
  
    var pinForm = document.getElementsByClassName('js__pinCode')[0];
  
    if (pinForm) {
      pinForm.addEventListener('submit', function () {
        var passPin = document.getElementsByClassName('type-pass-pin')[0];
        var pinValue = passPin.value;
        var numeric = isNumeric(pinValue);
  
        if (!numeric || pinValue == '' || pinValue == "Type the 6 diget PIN  Code") {
          //var errorMsg = "Please fill this field with numbers";
          var errorMsg = this.querySelector('.error-msg');
          errorMsg.innerHTML = "Please fill this field with numbers";
          errorMsg.className = errorMsg.className.replace(/\bhidden\b/, '');
          return false;
        }
      });
    }
  }
  
  function isNumeric(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
  }
  
  if (!(typeof jQuery == 'undefined')) {
    // check if Jquery is loaded
    (function ($) {
      var selectElement = $(".scrollableList").siblings("select");
      $(".scrollableList").siblings().each(function () {
        if ($(this).hasClass("sbHolder")) {
          selectElement.selectbox("detach"); // destroy selectbox if existed
        } else if ($(this).hasClass("bootstrap-select")) {
          $(this).hide(); // hide bootstrap ui select element
        }
      });
      selectElement.hide();
    })(jQuery);
  
    jQuery(document).ready(function () {
      jQuery('.pb-collapse').click(function () {
        jQuery(".notAuth-msg-container").toggleClass('collapsed');
        jQuery(this).find('img').toggle();
      });
    });
  }
  
  $(document).on("click", ".tfa-option", function (event) {
    event.preventDefault();
  
    if (document.getElementById('tfa-options')) {
      if (document.getElementById('tfa-options').style.display == 'none') {
        document.getElementById('tfa-options').style.display = 'block';
      } else {
        document.getElementById('tfa-options').style.display = 'none';
      }
    }
  });
  
  function tfaResetAuthentication() {
    if (document.getElementById('reset-verification-warning').style.display == 'none') {
      document.getElementById('reset-verification-warning').style.display = 'block';
      document.getElementsByClassName('reset-verification-option')[0].style.display = 'none';
    }
  
    var redirectUri = document.getElementsByName('redirectUri')[0].value;
    document.getElementsByName('redirectUri')[0].value = encodeURI('/action/resetTfaMethod?redirectUri=' + redirectUri);
  }
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/remote-access-email-domains/js/remote-access-email-domains.js":
  /*!***************************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/remote-access-email-domains/js/remote-access-email-domains.js ***!
    \***************************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var remoteAccessEmail = {
      $modal: $('#emailDomainsConfirmationDialog'),
      init: function init() {
        var showConfirmation = $('.showConfirmation').text().trim();
  
        if (showConfirmation == 'true') {
          remoteAccessEmail.$modal.modal({
            backdrop: 'static',
            keyboard: false
          }, 'toggle');
        }
      }
    };
    UX.remoteAccessEmail = remoteAccessEmail; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/search-result/js/search-result.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/search-result/js/search-result.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $body = $('body');
    var searchResult = {
      url: location.href,
      rememberUserLayout: true,
  
      /**
       * The saved search panel
       */
      $savedSearchPanel: null,
  
      /**
       * Frequency Column Labels
       */
      frequencyLabels: {},
  
      /**
       * The max search queries needed to for iteration over the table
       */
      maxSearchQueries: null,
  
      /**
       * Link to edit saved search item
       */
      goLink: '/action/doSearch?target=saved&runSaved=',
  
      /**
       * Link to remove saved search item
       */
      removeLink: '/action/doDeleteSearch?searchType=saved&queryId=',
      init: function init() {
        //searchResult.get.url();
        this.$savedSearchPanel = $('.advancedSearch__tabs .saved-searches');
        this.maxSearchQueries = this.$savedSearchPanel.data('queries');
        this.frequencyLabels = this.$savedSearchPanel.data('frequency-labels');
        searchResult.control();
        searchResult.additionalInit();
        searchResult.additionalControl();
        searchResult.set.userPublicationLayout();
      },
      control: function control() {
        $body.on('click', '#saveSearchTriggerButton', function () {
          searchResult.openSaveSearchDialog();
        });
        $body.on('submit', '#saveSearchDialog form', function (event) {
          return searchResult.onSaveSearchSubmitHandler(event);
        });
        $body.on('click', '.search__layout>span', function () {
          $(".search__layout>span").removeClass('active');
          $(this).addClass('active');
  
          if ($(this).hasClass('search__layout-tile')) {
            $(".search-result__body").addClass('search-result--tile');
            localStorage.setItem("userPublicationLayout", "tile");
          } else {
            $(".search-result__body").removeClass('search-result--tile');
            localStorage.setItem("userPublicationLayout", "list");
          }
        });
      },
      additionalControl: function additionalControl() {},
      additionalInit: function additionalInit() {},
      set: {
        userPublicationLayout: function userPublicationLayout() {
          if (searchResult.rememberUserLayout) {
            if (localStorage.userPublicationLayout == 'tile') {
              $('.search__layout-tile').click();
            } else if (localStorage.userPublicationLayout == 'list') {
              $('.search__layout-list').click();
            }
          }
        }
      },
      get: {
        url: function url() {},
        text: function text(name) {
          name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
          var regexS = "[\\?&]" + name + "=([^&#]*)";
          var regex = new RegExp(regexS);
          var results = regex.exec(searchResult.url);
          return results == null ? null : results[1];
        },
        value: function value() {}
      },
  
      /**
       * Responsible for rendering row items
       */
      render: {
        /**
         * Responsible for rendering rows
         *
         * @param {object} item
         * @param {number} index
         */
        row: function row(item, index) {
          console.log(searchResult.$savedSearchPanel);
          var $row = searchResult.$savedSearchPanel.find('tbody tr').eq(index);
          console.log($row);
          this.columns($row, item);
          this.actions($row, item);
  
          if ($row.hasClass('hidden')) {
            $row.removeClass('hidden');
            searchResult.$savedSearchPanel.find('.table-responsive').parent().removeClass('hidden');
            searchResult.$savedSearchPanel.find('.emptySavedSearches').remove();
          }
        },
  
        /**
         * Responsible for rendering columns
         *
         * @param {jQuery} $row
         * @param {object} item
         */
        columns: function columns($row, item) {
          var qName = item.qName,
              qSavedOn = item.qSavedOn,
              qLastRun = item.qLastRun;
          $row.find('.name-td').html(qName);
          $row.find('.saved-on-td').html(qSavedOn);
          $row.find('.last-run-td').html(qLastRun);
          this.additionalColumns($row, item);
          this.frequencyColumn($row, item);
        },
  
        /**
         * Responsible for additional columns rendering,
         * can be used to modify rendered row columns
         *
         * @param {jQuery} $row
         * @param {object} item
         */
        additionalColumns: function additionalColumns($row, item) {},
  
        /**
         * Render Frequency Column
         *
         * @param {jQuery} $row
         * @param {string} qAlertStatus
         */
        frequencyColumn: function frequencyColumn($row, _ref) {
          var qAlertStatus = _ref.qAlertStatus;
          var frequency = qAlertStatus;
  
          if (searchResult.frequencyLabels && searchResult.frequencyLabels[frequency]) {
            frequency = searchResult.frequencyLabels[frequency];
          }
  
          $row.find('.frequency-td').html(frequency);
        },
  
        /**
         * Responsible for rendering action columns
         *
         * @param {jQuery} $row
         * @param {number} qId
         */
        actions: function actions($row, _ref2) {
          var qId = _ref2.qId;
          $row.find('[data-action-type="saved-search--remove"]').attr('href', searchResult.removeLink + qId);
          $row.find('[data-action-type="saved-search--run"]').attr('href', searchResult.goLink + qId);
        }
      },
      openSaveSearchDialog: function openSaveSearchDialog() {
        var openDialog = searchResult.getCookie("openDialog");
  
        if (openDialog != null && openDialog != "") {
          var saveSearchButton = $('#saveSearchTriggerButton');
  
          if (saveSearchButton.length > 0) {
            document.cookie = "openDialog=;expires=Wed; 01 Jan 1970";
            saveSearchButton.click();
          }
        }
      },
      getCookie: function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
  
        for (var i = 0; i < ca.length; i++) {
          var c = ca[i];
  
          while (c.charAt(0) == ' ') {
            c = c.substring(1);
          }
  
          if (c.indexOf(nameEQ) != -1) return c.substring(nameEQ.length, c.length);
        }
  
        return null;
      },
      onSaveSearchSubmitHandler: function onSaveSearchSubmitHandler(e) {
        $('#newSearchSaveButton').hide();
        $('.saveSearchProgress').show();
        $.ajax({
          type: "POST",
          url: "/action/doSaveSearch",
          data: $(e.target).serialize(),
          success: searchResult.saveSearchSuccessHandler,
          error: function error(data) {
            $('.error.saveSearchMsg').show('fade').removeClass('hidden');
            $('#newSearchSaveButton').show();
            $('.saveSearchProgress').hide();
            $('#saveSearchDialog').modal('toggle');
            $('#saveSearchDialog').click();
          }
        });
        return false;
      },
      saveSearchSuccessHandler: function saveSearchSuccessHandler(data) {
        $('.success.saveSearchMsg').show('fade').removeClass('hidden');
        $('#newSearchSaveButton').show();
        $('.saveSearchProgress').hide();
        $('#saveSearchDialog').modal('toggle');
        $('#saveSearchDialog').click();
        UX.modal.on.hide();
        searchResult.redrawSavedSearchesPanel(JSON.parse(data).favQueries);
      },
  
      /**
       * Redraws the table rows using the incoming from favQueries
       *
       * @param {array} jsonData
       */
      redrawSavedSearchesPanel: function redrawSavedSearchesPanel(jsonData) {
        var _this = this;
  
        jsonData.forEach(function (value, index) {
          if (index >= searchResult.maxSearchQueries) {
            return;
          }
  
          console.log('trying to render');
  
          _this.render.row(value, index);
        });
      }
    };
    UX.searchResult = searchResult; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/show-recommended/js/show-recommended.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/show-recommended/js/show-recommended.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (UX) {
    'use strict';
  
    var showRecommended = {
      selectors: {
        placeholder: '.show-recommended-placeholder'
      },
      init: function init() {
        $(showRecommended.selectors.placeholder).each(function (index, widget) {
          showRecommended.getContent(widget);
        });
      },
      getContent: function getContent(widget) {
        var $widget = $(widget);
        $widget.load($widget.attr('data-ajaxurl'), function () {
          showRecommended.truncate($widget);
          setTimeout(function () {
            showRecommended.checkIfClosed($widget);
            showRecommended.hideSkeletons($widget);
            $(document).trigger('showRecommended:loaded');
          }, 10);
        });
      },
      truncate: function truncate($widget) {
        $('.creative-work__title', $widget).not("[data-truncate='none']").truncate({
          lines: 3,
          addClass: 'min-height'
        });
        $('.creative-work .loa', $widget).not("[data-truncate='none']").truncate({
          lines: 2,
          type: 'list',
          addClass: 'loa-height'
        });
      },
      checkIfClosed: function checkIfClosed($widget) {
        var $accordionTab = $widget.closest('.accordion-tabbed__tab');
  
        if (!$accordionTab.hasClass('js--open')) {
          $accordionTab.find('.accordion-tabbed__control').attr("aria-expanded", "false");
          $accordionTab.find('.accordion-tabbed__content').hide();
        }
      },
      hideSkeletons: function hideSkeletons($widget) {
        $('.lazy-load', $widget).remove();
        $('.delayLoad', $widget).removeClass('delayLoad').addClass('delayedLoad');
        $widget.replaceWith($widget.children());
      }
    };
    UX.showRecommended = showRecommended;
  })(UX);
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/slideshow/js/showcase-slideshow.js":
  /*!************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/slideshow/js/showcase-slideshow.js ***!
    \************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-core/node_modules/@babel/runtime/helpers/typeof.js");
  
  /*
  * This script provides functionality for a slider which is to be navigated with some list of content. Where slider is
  * .js-showcase-showbox and the list of items that serve as navigation is .js-showcase-navigables.
  * Slider is managed by owl.carousel and the nav items functionality is built upon owl's api.
  *
  *
  * The navigation list as well as the owl slider requires to be hooked directly on list's container:
  *
  * E.g.:
  *   .js-showcase-navigables
  *       .item
  *       .item
  *       .item
  *
  * @TODO check on accessibility implementation once OWL's accessibility is implemented
  *
  * */
  (function () {
    var showcaseSlideshow = {
      selectors: {
        navigation: '.js-showcase-navigables',
        showbox: '.js-showcase-showbox',
        instance: '.js-showcase-slideshow',
        currentItemClass: 'js-showcase-current'
      },
      defaultOptions: {},
      instances: [],
      applyOptions: function applyOptions(options, obj) {
        /* this allows to apply different options for each slider on the page */
        return options;
      },
      init: function init(options) {
        /* slider behaviour can be customised here for all the sliders on the website */
  
        /*
        * Custom options structue:
        * {
        *   navigationEvent: 'mouseover' || 'click' || ... ,
        *   sliderOptions: {
        *      [... Owl Slider Options]
        *   }
        * }
        *
        * */
        showcaseSlideshow.defaultOptions = _typeof(options) === 'object' ? options : {};
        var instances = $(showcaseSlideshow.selectors.instance);
  
        if (typeof $.fn.owlCarousel === 'function' && instances.length) {
          instances.each(function (i, o) {
            showcaseSlideshow.initInstance(o, showcaseSlideshow.defaultOptions);
          });
        }
      },
      initInstance: function initInstance(element, options) {
        var instance = $(element),
            singularOptions = options;
  
        if (typeof options === 'undefined') {
          options = showcaseSlideshow.defaultOptions;
        }
  
        if (typeof showcaseSlideshow.applyOptions === 'function') {
          /* Different options can be applied for each slider by rewriting the callback */
          // cloning options from the source for each slider instance to prevent any unintentional modifications
          singularOptions = showcaseSlideshow.applyOptions($.extend(true, {}, options), instance);
        }
  
        showcaseSlideshow.initNavigation(instance, singularOptions);
        /* The order of initiation is important. Navigation has to be created before slider init. */
  
        var sliderOptions = _typeof(singularOptions.sliderOptions) === 'object' ? singularOptions.sliderOptions : {}; // extracting slider options from common options array
  
        showcaseSlideshow.initShowbox(instance, sliderOptions);
        showcaseSlideshow.instances.push(instance);
      },
      initNavigation: function initNavigation(instance, options) {
        var event = typeof options !== 'undefined' && !!options.navigationEvent ? options.navigationEvent : 'click'; // default event is click
  
        instance.showboxNavigation = instance.find(showcaseSlideshow.selectors.navigation);
        instance.showboxNavigation.children().on(event + '.showcaseSlideshow', function (e) {
          /* @TODO allow event type customisation */
          var item = instance.showboxNavigation.children().index(this);
          instance.showbox.trigger('to.owl.carousel', [item]); // what is the default speed?
        });
        instance.showboxNavigation.on(event, 'a', function (e) {
          // that's mostly for those content elements that come to us as html and we cant set it up without anchors. Like the authors.
          e.preventDefault();
        });
      },
      initShowbox: function initShowbox(instance, customOptions) {
        var defaultOptions = {
          navigation: true,
          // Show next and prev buttons
          items: 1,
          singleItem: true,
          loop: true,
          // When loop is on owl carousel gives incorrect indexes
          margin: 0,
          transitionStyle: 'fade',
          dots: false,
          // autoWidth: true,
          onChanged: function onChanged(e) {
            if (e.property.name === 'position') showcaseSlideshow.onChangeNavCurrentItem(e, instance); // pass the data of
          },
          onInitialized: function onInitialized() {
            showcaseSlideshow.setNavCurrentItem(instance);
            showcaseSlideshow.initNavigationArrows(instance);
          }
        },
            options = $.extend({}, defaultOptions, customOptions);
        instance.showbox = instance.find(showcaseSlideshow.selectors.showbox).addClass('owl-carousel').owlCarousel(options);
      },
      setNavCurrentItem: function setNavCurrentItem(instance) {
        /* @TODO check if an initialization with a preset position is possible, implement support if this is the case */
        if (typeof instance.showboxNavigation !== 'undefined') instance.showboxNavigation.children().eq(0).addClass(showcaseSlideshow.selectors.currentItemClass);else {
          console.log('No navigation was passed.');
        }
      },
      onChangeNavCurrentItem: function onChangeNavCurrentItem(e, instance) {
        var items = instance.find(showcaseSlideshow.selectors.navigation).children(),
            settings = instance.showbox.data('owl.carousel'),
            // accessing setting of the owl carousel
        order = 0; // default active item
  
        if (settings.options.loop === true) {
          var normalOrder = e.item.index - e.relatedTarget.clones().length / 2; // fix for the enabled loop in the owl settings
  
          order = normalOrder == e.item.count ? 0 : normalOrder; // if index of items is one too many it means we are back on the start
        } else {
          order = e.property.value;
        }
  
        var currentItem = items.removeClass(showcaseSlideshow.selectors.currentItemClass).eq(order).addClass(showcaseSlideshow.selectors.currentItemClass);
        /* @TODO implement scroll control with modules options */
  
        showcaseSlideshow.maybeScrollTo(currentItem);
        /* As can be seen above items should follow immediately without any subcontainers.
           That is to allow no specific selectors but just children usage for a wider application of the script
        */
      },
      maybeScrollTo: function maybeScrollTo(item) {
        var position = item.position(),
            parent = item.parent(),
            to = false;
  
        if (Math.ceil(position.top) >= parent.height() || position.top + item.outerHeight() > parent.height()) {
          /* the item is down below the fold */
          to = parent.scrollTop() + position.top + item.outerHeight() - parent.height();
        } else if (position.top < 0) {
          /* the item is up above the fold */
          to = parent.scrollTop() + position.top;
        }
  
        if (to !== false) {
          parent.animate({
            scrollTop: to
          });
        }
        /*
            check if the item's in visible range if not manipulate scroll so the item will appear at the closest edge to its relative position
        */
  
      },
      initNavigationArrows: function initNavigationArrows(instance, prevSelector, nextSelector) {
        /* custom arrows can be passed and customised */
        var prevArrow = typeof prevSelector !== 'undefined' ? instance.find(prevSelector) : instance.find('.js-showcase-prev'),
            nextArrow = typeof nextSelector !== 'undefined' ? instance.find(nextSelector) : instance.find('.js-showcase-next');
        prevArrow.on('click.showcaseSlideshow', function (e) {
          e.preventDefault();
          instance.showbox.trigger('prev.owl.carousel');
        });
        nextArrow.on('click.showcaseSlideshow', function (e) {
          e.preventDefault();
          instance.showbox.trigger('next.owl.carousel');
        });
      }
    };
    UX.showcaseSlideshow = showcaseSlideshow;
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/table-of-content/js/table-of-content.js":
  /*!*****************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/table-of-content/js/table-of-content.js ***!
    \*****************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var tocJs = {
      $loa: null,
      vPort: 'screen-xs',
      init: function init() {
        var $toSection = $('.to-section');
  
        if ($toSection.length) {
          $toSection.each(function () {
            var section = $(this).text();
            var id = $(this).attr("id");
            $('<li role="menuitem"><a class="w-slide__hide" href="#' + id + '"><span>' + section + '</span></a></li>').appendTo('.sections__drop');
          });
        } else {
          $('.toc-go-section, .toc__section').remove();
        }
  
        tocJs.$loa = $('.issue-item .loa, .search__item .meta__authors, .search__item .loa');
        tocJs.control();
      },
      control: function control() {
        $(window).on('load orientationchange', function (event) {
          tocJs.truncate();
        });
        $(document).on(tocJs.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          tocJs.isMobile = true;
          tocJs.truncate();
        });
        $(document).on(tocJs.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          tocJs.isMobile = false;
          tocJs.truncate();
        });
      },
      truncate: function truncate() {
        try {
          tocJs.$loa.not("[data-truncate='none']").truncate({
            lines: 2,
            type: 'list',
            seeMoreLink: true,
            seeMoreText: 'See all authors',
            seeLessText: 'See fewer authors'
          });
        } catch (err) {}
      }
    };
    UX.tocJs = tocJs; // add to global namespace
  
    $(document).ready(function () {
      if ($('.loa, .meta__authors').length) {
        UX.tocJs.init();
      }
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/trusted-proxy/js/trusted-proxy.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/trusted-proxy/js/trusted-proxy.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var trustedPoxy = {
      init: function init() {
        trustedPoxy.control();
      },
      control: function control() {
        $(document).on('change', '.trustedProxyUserId', function () {
          this.closest('form').submit();
        });
      }
    };
    UX.trustedPoxy = trustedPoxy; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/two-factor-authentication/js/two-factor-authentication.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/two-factor-authentication/js/two-factor-authentication.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var tfa = {
      init: function init() {
        tfa.toggleMessage();
      },
      toggleMessage: function toggleMessage() {
        $('.two-factor-authentication__toggle').click(function () {
          $(this).closest('.two-factor-authentication').toggleClass('two-factor-authentication--collapsed');
        });
      }
    };
    UX.tfa = tfa; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-core/widgets/usage-reports/js/usage-reports.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-core/widgets/usage-reports/js/usage-reports.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var reports = {
      $form: $("#institutionUsageReport"),
      report_input_name: "counterIds",
      submitActor: null,
      $submitActors: null,
      $usageReports: $('.usageReports'),
      init: function init() {
        this.$submitActors = this.$form.find('button[type=submit]');
        reports.controller();
        reports.additionalController();
      },
      controller: function controller() {
        reports.$submitActors.click(function (event) {
          reports.submitActor = this;
        });
        reports.$form.submit(function (event) {
          event.preventDefault();
  
          if (null === reports.submitActor) {
            // If no actor is explicitly clicked, the browser will
            // automatically choose the first in source-order
            // so we do the same here
            reports.submitActor = reports.$submitActors[0];
          }
  
          $('<input />').attr('type', 'hidden').attr('name', reports.submitActor.name).attr('value', "").appendTo(reports.$form);
          var error_msg = $(this).children('.error_msg');
          var dateRangeCheck = reports.check.dateRange();
          var reportsRange = reports.check.selectedReports();
  
          if (dateRangeCheck && reportsRange) {
            $(this).unbind('submit').submit();
            error_msg.hide();
          } else {
            var notifyEmail_error_msg = $('[name="notify"]').next('.error_msg');
            notifyEmail_error_msg.hide();
            error_msg.hide();
  
            if (reports.submitActor.name == "notify") {
              notifyEmail_error_msg.html(reports.$usageReports.data('errors-below'));
              notifyEmail_error_msg.show();
            } else {
              error_msg.html(reports.$usageReports.data('errors'));
              error_msg.show();
            }
          }
        });
        reports.$form.on('click change', '.ranges-selects select', function () {
          reports.on.selectRange();
        });
        reports.$form.on('click change', '.year-select select', function () {
          reports.on.selectYear();
        });
      },
      additionalController: function additionalController() {},
      error_msg: function error_msg(msg) {
        alert("Errors:\n" + msg);
      },
      on: {
        selectRange: function selectRange() {
          var el = reports.$form.find("#dateRange");
          el.find('input[type="radio"]').prop('checked', false);
          el.find('input#range-date').prop('checked', true);
        },
        selectYear: function selectYear() {
          var el = reports.$form.find("#dateRange");
          el.find('input[type="radio"]').prop('checked', false);
          el.find('input#year-date').prop('checked', true);
        }
      },
      check: {
        dateRange: function dateRange() {
          var el = reports.$form.find('#dateRange');
  
          if (el.find('input#range-date:checked').length) {
            // start date
            var month = el.find('select#startMonthId').val();
            var year = el.find('select#startYear').val();
            var start = new Date(year, month, 1); // end date
  
            month = el.find('select#endMonthId').val();
            year = el.find('select#endYear').val();
            var end = new Date(year, month, 1);
            var msg = [];
            if (start > end) msg.push(reports.$usageReports.data('invalid-month-range'));
            var numMonths = reports.monthDiff(start, end);
            if (numMonths > 10) msg.push(reports.$usageReports.data('invalid-month-number'));
            var error_msg = el.find('.error_msg');
  
            if (msg.length) {
              error_msg.html(msg.join('<br>'));
              error_msg.show();
              return false;
            } else {
              error_msg.html('');
              error_msg.hide();
              return true;
            }
          }
  
          return true;
        },
        selectedReports: function selectedReports() {
          var el = reports.$form.find('#reports');
          var error_msg = el.find('.error_msg');
  
          if (!el.find('input[name="' + reports.report_input_name + '"]:checked').length) {
            error_msg.html(reports.$usageReports.data('select-report-error'));
            error_msg.show();
            return false;
          } else {
            error_msg.html("");
            error_msg.hide();
            return true;
          }
        }
      },
      monthDiff: function monthDiff(d1, d2) {
        var months;
        months = (d2.getFullYear() - d1.getFullYear()) * 12;
        months -= d1.getMonth() + 1;
        months += d2.getMonth();
        return months <= 0 ? 0 : months;
      }
    };
    UX.reports = reports; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_.debounce.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_.debounce.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (context) {
    // DEBOUNCE method taken from Underscore.js
    // @todo: use lodash or underscore from package
    context._ = context._ || {}; // Returns a function, that, as long as it continues to be invoked, will not
    // be triggered. The function will be called after it stops being called for
    // N milliseconds. If `immediate` is passed, trigger the function on the
    // leading edge, instead of the trailing.
  
    _.debounce = _.debounce || function (func) {
      var wait = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 250;
      var immediate = arguments.length > 2 ? arguments[2] : undefined;
      var timeout;
      return function () {
        var context = this,
            args = arguments;
  
        var later = function later() {
          timeout = null;
          if (!immediate) func.apply(context, args);
        };
  
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
      };
    };
  })(window);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_deprecated.polyfill--jQuery.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_deprecated.polyfill--jQuery.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/typeof.js");
  
  /// Polyfill deprecated methods which are used somewhere in black-box of our scripts ...
  (function ($) {
    // MagicSuggest uses deprecated and in jQuery3 undefined function size for getting property length of an object ...
    $.fn.size = function () {
      if (_typeof(this) === 'object' && this.length) {
        return this.length;
      }
  
      return null;
    };
  })(jQuery);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_deprecated.polyfill.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_deprecated.polyfill.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (root) {
    try {
      // SourceJS workaround: turn off define support for now because of SourceJS5
      if (typeof root.define !== 'undefined') {
        root.__orig__define = root.define;
        root.define = false; // cannot use delete('define') due to strict mode, and as to be set to anything but object. Safest is to use FALSE
      }
    } catch (e) {
      console.warn('Define workaround didn\'t work because:', e);
    }
  })(window);
  
  (function () {
    jcf = window.jcf || {};
    var __deprecated__jcf__info = 'JCF plugin is not present. Interface with empty methods is here, to preserve compatibility with hardcoded scripts.';
  
    var __deprecated__jcf = function __deprecated__jcf() {
      if (__deprecated__jcf__info) console.warn(__deprecated__jcf__info);
      __deprecated__jcf__info = false;
    };
  
    jcf.destroy = jcf.destroy || __deprecated__jcf;
    jcf.replace = jcf.replace || __deprecated__jcf;
    jcf.setOptions = jcf.setOptions || __deprecated__jcf;
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_enquireIt.js":
  /*!*******************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_enquireIt.js ***!
    \*******************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _node_modules_ui_core_utility_resized_event_js_resized_event__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/ui-core/utility/resized-event/js/resized-event */ "../../ui-core/utility/resized-event/js/resized-event.js");
   // this utility works against the mobile first approach
  // @todo rewrite to comply with the mobile first approach
  
  (function () {
    var enquireIt = {
      init: function init() {
        // Responsive behavior controllers ( media query listeners )
        UX.controller.enabled = true;
        enquire.register('screen and (max-width: ' + UX.grid.screenXsMax + 'px)', {
          match: function match() {
            $(document).trigger('screen-xs-on'); // screen is xs
  
            $(document).trigger('smartResize'); // resize have been made
          },
          unmatch: function unmatch() {
            $(document).trigger('screen-xs-off'); // screen is not xs anymore
  
            $(document).trigger('smartResize'); // resize have been made
          }
        }).register('screen and (max-width: ' + UX.grid.screenSmMax + 'px)', {
          match: function match() {
            $(document).trigger('screen-sm-on'); // screen is sm
  
            $(document).trigger('smartResize'); // resize have been made
          },
          unmatch: function unmatch() {
            $(document).trigger('screen-sm-off'); // screen is not sm anymore
  
            $(document).trigger('smartResize'); // resize have been made
          }
        }).register('screen and (max-width: ' + UX.grid.screenMdMax + 'px)', {
          match: function match() {
            $(document).trigger('screen-md-on'); // screen is md
  
            $(document).trigger('smartResize'); // resize have been made
          },
          unmatch: function unmatch() {
            $(document).trigger('screen-md-off'); // screen is not md anymore
  
            $(document).trigger('smartResize'); // resize have been made
          }
        }).register('screen and (min-width: 0px)', {
          match: function match() {
            $(document).trigger('screen-lg-on'); // screen is lg
  
            $(document).trigger('smartResize'); // resize have been made
          }
        });
        Object(_node_modules_ui_core_utility_resized_event_js_resized_event__WEBPACK_IMPORTED_MODULE_0__["default"])();
      }
    };
    UX.enquireIt = enquireIt; // add to global namespace
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_fill-polyfill.js":
  /*!***********************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_fill-polyfill.js ***!
    \***********************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  if (!Array.prototype.fill) {
    Object.defineProperty(Array.prototype, 'fill', {
      value: function value(_value) {
        // Steps 1-2.
        if (this == null) {
          throw new TypeError('this is null or not defined');
        }
  
        var O = Object(this); // Steps 3-5.
  
        var len = O.length >>> 0; // Steps 6-7.
  
        var start = arguments[1];
        var relativeStart = start >> 0; // Step 8.
  
        var k = relativeStart < 0 ? Math.max(len + relativeStart, 0) : Math.min(relativeStart, len); // Steps 9-10.
  
        var end = arguments[2];
        var relativeEnd = end === undefined ? len : end >> 0; // Step 11.
  
        var _final = relativeEnd < 0 ? Math.max(len + relativeEnd, 0) : Math.min(relativeEnd, len); // Step 12.
  
  
        while (k < _final) {
          O[k] = _value;
          k++;
        } // Step 13.
  
  
        return O;
      }
    });
  }
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_load-fonts.js":
  /*!********************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_load-fonts.js ***!
    \********************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var ui_core_utility_load_fonts_js_load_fonts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ui-core/utility/load-fonts/js/load-fonts */ "../../ui-core/utility/load-fonts/js/load-fonts.js");
  
  
  (function () {
    var fontloader = {
      init: function init() {
        new ui_core_utility_load_fonts_js_load_fonts__WEBPACK_IMPORTED_MODULE_0__["default"]('Lato', [300, 500, 700]);
        new ui_core_utility_load_fonts_js_load_fonts__WEBPACK_IMPORTED_MODULE_0__["default"]('Volkhov', [400, 700]);
      }
    };
    UX.fontloader = fontloader;
    document.addEventListener('DOMContentLoaded', function () {
      UX.fontloader.init();
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/_sticky.js":
  /*!****************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/_sticky.js ***!
    \****************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var ui_core_plugins_stickybits_js_stickybits_es__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ui-core/plugins/stickybits/js/stickybits.es */ "../../ui-core/plugins/stickybits/js/stickybits.es.js");
  
  
  (function ($, UX) {
    var sticky = {
      stickyNodes: [],
      stickyTargets: '.header, .issue-navigator, .navbar, .article__aside, .article__navbar, .table-of-content__nav, .tos-list',
      height: 0,
      vPort: 'screen-md',
      sVPort: 'screen-xs',
      init: function init() {
        this.stickyNodes = document.querySelectorAll(this.stickyTargets);
        this.setHeaderHeight();
        this.control();
        this.setSticky();
      },
      control: function control() {
        $(document).on(this.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          sticky.setHeaderHeight();
        }).on(this.vPort + '-on', function () {
          sticky.setHeaderHeight('--sm');
        }).on(this.sVPort + '-on', function () {
          sticky.setHeaderHeight('--sm');
        }).on(this.sVPort + '-off', function () {
          sticky.setHeaderHeight('--sm');
        });
      },
      setHeaderHeight: function setHeaderHeight() {
        var _this = this;
  
        var size = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        setTimeout(function () {
          _this.height = $('.header').innerHeight();
          var adHeight = $('.ad--top').innerHeight();
          document.documentElement.style.setProperty('--header-height' + size, _this.height + 'px');
          document.documentElement.style.setProperty('--header-ad-height' + size, adHeight + 'px');
        }, 100);
      },
      setSticky: function setSticky() {
        if (!UX.test.isIE() || UX.test.isIE() > 11) {
          return;
        }
  
        Object(ui_core_plugins_stickybits_js_stickybits_es__WEBPACK_IMPORTED_MODULE_0__["default"])("".concat(this.stickyTargets, ", .article__navbar__secondary"), {
          useStickyClasses: true
        });
        this.stickyNodes.forEach(function (node) {
          var nodeWinOffset = node.getBoundingClientRect();
          node.style.left = nodeWinOffset.left + 'px';
          node.style.width = nodeWinOffset.width + 'px';
          node.style.right = window.outerWidth - nodeWinOffset.right + 'px';
        });
      }
    };
    $(function () {
      sticky.init();
    });
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/all.js":
  /*!************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/all.js ***!
    \************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _deprecated_polyfill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_deprecated.polyfill */ "../../ui-theme-classic/js/_deprecated.polyfill.js");
  /* harmony import */ var _deprecated_polyfill__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_deprecated_polyfill__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _fill_polyfill__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_fill-polyfill */ "../../ui-theme-classic/js/_fill-polyfill.js");
  /* harmony import */ var _fill_polyfill__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_fill_polyfill__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _node_modules_ui_core_plugins_polyfills_js_polyfill_object_values__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/polyfills/js/polyfill.object.values */ "../../ui-core/plugins/polyfills/js/polyfill.object.values.js");
  /* harmony import */ var _node_modules_ui_core_plugins_polyfills_js_polyfill_object_values__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_polyfills_js_polyfill_object_values__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _node_modules_ui_core_plugins_polyfills_js_resizeObserverPolyfill_dist_ResizeObserver__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/polyfills/js/resizeObserverPolyfill/dist/ResizeObserver */ "../../ui-core/plugins/polyfills/js/resizeObserverPolyfill/dist/ResizeObserver.js");
  /* harmony import */ var _node_modules_ui_core_plugins_polyfills_js_resizeObserverPolyfill_dist_ResizeObserver__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_polyfills_js_resizeObserverPolyfill_dist_ResizeObserver__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _debounce__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_.debounce */ "../../ui-theme-classic/js/_.debounce.js");
  /* harmony import */ var _debounce__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_debounce__WEBPACK_IMPORTED_MODULE_4__);
  /* harmony import */ var _node_modules_ui_core_plugins_enquireJs_js_enquire__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/enquireJs/js/enquire */ "../../ui-core/plugins/enquireJs/js/enquire.js");
  /* harmony import */ var _node_modules_ui_core_plugins_enquireJs_js_enquire__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_enquireJs_js_enquire__WEBPACK_IMPORTED_MODULE_5__);
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js-exposed");
  /* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_6__);
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_jquery_migrate_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/jquery/jquery-migrate.js */ "../../ui-core/plugins/jquery/jquery-migrate.js");
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_jquery_migrate_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_jquery_jquery_migrate_js__WEBPACK_IMPORTED_MODULE_7__);
  /* harmony import */ var _node_modules_ui_core_utility_js_jquery_selector_focusable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/jquery.selector.focusable */ "../../ui-core/utility/js/jquery.selector.focusable.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_jquery_selector_focusable__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_js_jquery_selector_focusable__WEBPACK_IMPORTED_MODULE_8__);
  /* harmony import */ var _deprecated_polyfill_jQuery__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./_deprecated.polyfill--jQuery */ "../../ui-theme-classic/js/_deprecated.polyfill--jQuery.js");
  /* harmony import */ var _deprecated_polyfill_jQuery__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_deprecated_polyfill_jQuery__WEBPACK_IMPORTED_MODULE_9__);
  /* harmony import */ var _node_modules_ui_core_plugins_panzoom_jquery_panzoom__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/panzoom/jquery.panzoom */ "../../ui-core/plugins/panzoom/jquery.panzoom.js");
  /* harmony import */ var _node_modules_ui_core_plugins_panzoom_jquery_panzoom__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_panzoom_jquery_panzoom__WEBPACK_IMPORTED_MODULE_10__);
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_ui_jquery_ui__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/jquery-ui/jquery-ui */ "../../ui-core/plugins/jquery-ui/jquery-ui.js");
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_ui_jquery_ui__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_jquery_ui_jquery_ui__WEBPACK_IMPORTED_MODULE_11__);
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_ui_jquery_ui_touch_punch_min__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/jquery-ui/jquery.ui.touch-punch.min */ "../../ui-core/plugins/jquery-ui/jquery.ui.touch-punch.min.js");
  /* harmony import */ var _node_modules_ui_core_plugins_jquery_ui_jquery_ui_touch_punch_min__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_jquery_ui_jquery_ui_touch_punch_min__WEBPACK_IMPORTED_MODULE_12__);
  /* harmony import */ var _node_modules_ui_core_plugins_touchSwipe_jquery_touchSwipe__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/touchSwipe/jquery.touchSwipe */ "../../ui-core/plugins/touchSwipe/jquery.touchSwipe.js");
  /* harmony import */ var _node_modules_ui_core_plugins_touchSwipe_jquery_touchSwipe__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_touchSwipe_jquery_touchSwipe__WEBPACK_IMPORTED_MODULE_13__);
  /* harmony import */ var _node_modules_ui_core_plugins_owl_carousel_js_owl_carousel_min__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/owl-carousel/js/owl.carousel.min */ "../../ui-core/plugins/owl-carousel/js/owl.carousel.min.js");
  /* harmony import */ var _node_modules_ui_core_plugins_owl_carousel_js_owl_carousel_min__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_owl_carousel_js_owl_carousel_min__WEBPACK_IMPORTED_MODULE_14__);
  /* harmony import */ var _node_modules_ui_core_plugins_tabs_js_tabs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/tabs/js/tabs */ "../../ui-core/plugins/tabs/js/tabs.js");
  /* harmony import */ var _node_modules_ui_core_plugins_modal_js_modal__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/modal/js/modal */ "../../ui-core/plugins/modal/js/modal.js");
  /* harmony import */ var _node_modules_ui_core_plugins_magicSearch_js_magicsuggest__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/magicSearch/js/magicsuggest */ "../../ui-core/plugins/magicSearch/js/magicsuggest.js");
  /* harmony import */ var _node_modules_ui_core_plugins_magicSearch_js_magicsuggest__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_magicSearch_js_magicsuggest__WEBPACK_IMPORTED_MODULE_17__);
  /* harmony import */ var _node_modules_ui_core_plugins_literatum_imports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/literatum/imports */ "../../ui-core/plugins/literatum/imports.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_namespace__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/namespace */ "../../ui-core/utility/js/namespace.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_namespace__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_js_namespace__WEBPACK_IMPORTED_MODULE_19__);
  /* harmony import */ var ui_core_plugins_polyfills_js_Promise_es6_promise_min__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ui-core/plugins/polyfills/js/Promise/es6-promise.min */ "../../ui-core/plugins/polyfills/js/Promise/es6-promise.min.js");
  /* harmony import */ var ui_core_plugins_polyfills_js_Promise_es6_promise_min__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(ui_core_plugins_polyfills_js_Promise_es6_promise_min__WEBPACK_IMPORTED_MODULE_20__);
  /* harmony import */ var ui_core_plugins_polyfills_js_Promise_es6_promise_auto_min__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ui-core/plugins/polyfills/js/Promise/es6-promise.auto.min */ "../../ui-core/plugins/polyfills/js/Promise/es6-promise.auto.min.js");
  /* harmony import */ var ui_core_plugins_polyfills_js_Promise_es6_promise_auto_min__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(ui_core_plugins_polyfills_js_Promise_es6_promise_auto_min__WEBPACK_IMPORTED_MODULE_21__);
  /* harmony import */ var _load_fonts__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./_load-fonts */ "../../ui-theme-classic/js/_load-fonts.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_utils__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/utils */ "../../ui-core/utility/js/utils.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_tests__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/tests */ "../../ui-core/utility/js/tests.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_no_focusable_svg__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/no-focusable-svg */ "../../ui-core/utility/js/no-focusable-svg.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_no_focusable_svg__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_js_no_focusable_svg__WEBPACK_IMPORTED_MODULE_25__);
  /* harmony import */ var _node_modules_ui_core_utility_js_addThisEnhancement__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/addThisEnhancement */ "../../ui-core/utility/js/addThisEnhancement.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_addThisEnhancement__WEBPACK_IMPORTED_MODULE_26___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_js_addThisEnhancement__WEBPACK_IMPORTED_MODULE_26__);
  /* harmony import */ var _node_modules_ui_core_utility_js_observe_dom__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../node_modules/ui-core/utility/js/observe-dom */ "../../ui-core/utility/js/observe-dom.js");
  /* harmony import */ var _node_modules_ui_core_utility_js_observe_dom__WEBPACK_IMPORTED_MODULE_27___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_js_observe_dom__WEBPACK_IMPORTED_MODULE_27__);
  /* harmony import */ var _node_modules_ui_core_utility_ab_logger_js_ab_logger__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../node_modules/ui-core/utility/ab-logger/js/ab-logger */ "../../ui-core/utility/ab-logger/js/ab-logger.js");
  /* harmony import */ var _node_modules_ui_core_utility_ab_logger_js_ab_logger__WEBPACK_IMPORTED_MODULE_28___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_utility_ab_logger_js_ab_logger__WEBPACK_IMPORTED_MODULE_28__);
  /* harmony import */ var _enquireIt__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./_enquireIt */ "../../ui-theme-classic/js/_enquireIt.js");
  /* harmony import */ var _node_modules_ui_core_plugins_controller_js_controller__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/controller/js/controller */ "../../ui-core/plugins/controller/js/controller.js");
  /* harmony import */ var _node_modules_ui_core_plugins_controller_js_controller__WEBPACK_IMPORTED_MODULE_30___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_controller_js_controller__WEBPACK_IMPORTED_MODULE_30__);
  /* harmony import */ var _node_modules_ui_core_plugins_cookies_js_cookies__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/cookies/js/cookies */ "../../ui-core/plugins/cookies/js/cookies.js");
  /* harmony import */ var _node_modules_ui_core_plugins_cookies_js_cookies__WEBPACK_IMPORTED_MODULE_31___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_cookies_js_cookies__WEBPACK_IMPORTED_MODULE_31__);
  /* harmony import */ var _node_modules_ui_core_plugins_custom_form_js_jcf__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/custom-form/js/jcf */ "../../ui-core/plugins/custom-form/js/jcf.js");
  /* harmony import */ var _node_modules_ui_core_plugins_custom_form_js_jcf__WEBPACK_IMPORTED_MODULE_32___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_custom_form_js_jcf__WEBPACK_IMPORTED_MODULE_32__);
  /* harmony import */ var _node_modules_ui_core_plugins_custom_form_js_jcf_range__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/custom-form/js/jcf.range */ "../../ui-core/plugins/custom-form/js/jcf.range.js");
  /* harmony import */ var _node_modules_ui_core_plugins_custom_form_js_jcf_range__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_custom_form_js_jcf_range__WEBPACK_IMPORTED_MODULE_33__);
  /* harmony import */ var _node_modules_ui_core_basic_lists_js_list__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../node_modules/ui-core/basic/lists/js/list */ "../../ui-core/basic/lists/js/list.js");
  /* harmony import */ var _node_modules_ui_core_basic_lists_js_list__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_basic_lists_js_list__WEBPACK_IMPORTED_MODULE_34__);
  /* harmony import */ var _node_modules_ui_core_basic_base_js_pageBody__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../node_modules/ui-core/basic/base/js/pageBody */ "../../ui-core/basic/base/js/pageBody.js");
  /* harmony import */ var _node_modules_ui_core_basic_base_js_pageBody__WEBPACK_IMPORTED_MODULE_35___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_basic_base_js_pageBody__WEBPACK_IMPORTED_MODULE_35__);
  /* harmony import */ var _node_modules_ui_core_basic_base_js_base__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../node_modules/ui-core/basic/base/js/base */ "../../ui-core/basic/base/js/base.js");
  /* harmony import */ var _node_modules_ui_core_basic_base_js_base__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_basic_base_js_base__WEBPACK_IMPORTED_MODULE_36__);
  /* harmony import */ var _node_modules_ui_core_basic_inputs_js_inputs__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../node_modules/ui-core/basic/inputs/js/inputs */ "../../ui-core/basic/inputs/js/inputs.js");
  /* harmony import */ var _node_modules_ui_core_basic_inputs_js_inputs__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_basic_inputs_js_inputs__WEBPACK_IMPORTED_MODULE_37__);
  /* harmony import */ var _node_modules_ui_core_plugins_drawer_js_drawer__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/drawer/js/drawer */ "../../ui-core/plugins/drawer/js/drawer.js");
  /* harmony import */ var _node_modules_ui_core_components_coolbar_js_coolbar__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../node_modules/ui-core/components/coolbar/js/coolbar */ "../../ui-core/components/coolbar/js/coolbar.js");
  /* harmony import */ var _node_modules_ui_core_components_coolbar_js_coolbar__WEBPACK_IMPORTED_MODULE_39___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_coolbar_js_coolbar__WEBPACK_IMPORTED_MODULE_39__);
  /* harmony import */ var _node_modules_ui_core_components_drop_block_js_drop_block__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../node_modules/ui-core/components/drop-block/js/drop-block */ "../../ui-core/components/drop-block/js/drop-block.js");
  /* harmony import */ var _node_modules_ui_core_components_drop_block_js_drop_block__WEBPACK_IMPORTED_MODULE_40___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_drop_block_js_drop_block__WEBPACK_IMPORTED_MODULE_40__);
  /* harmony import */ var _node_modules_ui_core_components_modal_js_modal__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ../node_modules/ui-core/components/modal/js/modal */ "../../ui-core/components/modal/js/modal.js");
  /* harmony import */ var _node_modules_ui_core_components_modal_js_modal__WEBPACK_IMPORTED_MODULE_41___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_modal_js_modal__WEBPACK_IMPORTED_MODULE_41__);
  /* harmony import */ var _node_modules_ui_core_components_tables_js_tables__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ../node_modules/ui-core/components/tables/js/tables */ "../../ui-core/components/tables/js/tables.js");
  /* harmony import */ var _node_modules_ui_core_components_tables_js_tables__WEBPACK_IMPORTED_MODULE_42___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_tables_js_tables__WEBPACK_IMPORTED_MODULE_42__);
  /* harmony import */ var _node_modules_ui_core_components_facet_date_js_facet_date__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../node_modules/ui-core/components/facet-date/js/facet-date */ "../../ui-core/components/facet-date/js/facet-date.js");
  /* harmony import */ var _node_modules_ui_core_components_facet_date_js_facet_date__WEBPACK_IMPORTED_MODULE_43___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_facet_date_js_facet_date__WEBPACK_IMPORTED_MODULE_43__);
  /* harmony import */ var _node_modules_ui_core_components_accordion_js_accordion__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ../node_modules/ui-core/components/accordion/js/accordion */ "../../ui-core/components/accordion/js/accordion.js");
  /* harmony import */ var _node_modules_ui_core_components_accordion_js_accordion__WEBPACK_IMPORTED_MODULE_44___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_accordion_js_accordion__WEBPACK_IMPORTED_MODULE_44__);
  /* harmony import */ var _node_modules_ui_core_components_refine_search_js_refine_search__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../node_modules/ui-core/components/refine-search/js/refine-search */ "../../ui-core/components/refine-search/js/refine-search.js");
  /* harmony import */ var _node_modules_ui_core_components_refine_search_js_refine_search__WEBPACK_IMPORTED_MODULE_45___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_refine_search_js_refine_search__WEBPACK_IMPORTED_MODULE_45__);
  /* harmony import */ var _node_modules_ui_core_components_figure_viewer_js_figure_viewer_script__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../node_modules/ui-core/components/figure-viewer/js/figure-viewer-script */ "../../ui-core/components/figure-viewer/js/figure-viewer-script.js");
  /* harmony import */ var _node_modules_ui_core_components_figure_viewer_js_figure_viewer_script__WEBPACK_IMPORTED_MODULE_46___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_figure_viewer_js_figure_viewer_script__WEBPACK_IMPORTED_MODULE_46__);
  /* harmony import */ var _node_modules_ui_core_plugins_lazyload_js_jquery_lazyload__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/lazyload/js/jquery.lazyload */ "../../ui-core/plugins/lazyload/js/jquery.lazyload.js");
  /* harmony import */ var _node_modules_ui_core_plugins_lazyload_js_jquery_lazyload__WEBPACK_IMPORTED_MODULE_47___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_lazyload_js_jquery_lazyload__WEBPACK_IMPORTED_MODULE_47__);
  /* harmony import */ var _node_modules_ui_core_plugins_truncate_js_truncate__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/truncate/js/truncate */ "../../ui-core/plugins/truncate/js/truncate.js");
  /* harmony import */ var _node_modules_ui_core_plugins_truncate_js_truncate__WEBPACK_IMPORTED_MODULE_48___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_truncate_js_truncate__WEBPACK_IMPORTED_MODULE_48__);
  /* harmony import */ var _node_modules_ui_core_plugins_truncate_js_init__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/truncate/js/init */ "../../ui-core/plugins/truncate/js/init.js");
  /* harmony import */ var _node_modules_ui_core_plugins_truncate_js_init__WEBPACK_IMPORTED_MODULE_49___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_truncate_js_init__WEBPACK_IMPORTED_MODULE_49__);
  /* harmony import */ var _node_modules_ui_core_components_teaser_js_teaser__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ../node_modules/ui-core/components/teaser/js/teaser */ "../../ui-core/components/teaser/js/teaser.js");
  /* harmony import */ var _node_modules_ui_core_components_teaser_js_teaser__WEBPACK_IMPORTED_MODULE_50___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_teaser_js_teaser__WEBPACK_IMPORTED_MODULE_50__);
  /* harmony import */ var _node_modules_ui_core_components_tabs_js_tabs__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ../node_modules/ui-core/components/tabs/js/tabs */ "../../ui-core/components/tabs/js/tabs.js");
  /* harmony import */ var _node_modules_ui_core_components_tabs_js_tabs__WEBPACK_IMPORTED_MODULE_51___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_tabs_js_tabs__WEBPACK_IMPORTED_MODULE_51__);
  /* harmony import */ var _node_modules_ui_core_plugins_slide_js_slide__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/slide/js/slide */ "../../ui-core/plugins/slide/js/slide.js");
  /* harmony import */ var _node_modules_ui_core_plugins_slide_js_slide__WEBPACK_IMPORTED_MODULE_52___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_slide_js_slide__WEBPACK_IMPORTED_MODULE_52__);
  /* harmony import */ var _node_modules_ui_core_components_datepicker_js_datepicker__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ../node_modules/ui-core/components/datepicker/js/datepicker */ "../../ui-core/components/datepicker/js/datepicker.js");
  /* harmony import */ var _node_modules_ui_core_components_datepicker_js_datepicker__WEBPACK_IMPORTED_MODULE_53___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_datepicker_js_datepicker__WEBPACK_IMPORTED_MODULE_53__);
  /* harmony import */ var _node_modules_ui_core_components_edit_in_place_js_edit_in_place__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ../node_modules/ui-core/components/edit-in-place/js/edit-in-place */ "../../ui-core/components/edit-in-place/js/edit-in-place.js");
  /* harmony import */ var _node_modules_ui_core_components_edit_in_place_js_edit_in_place__WEBPACK_IMPORTED_MODULE_54___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_edit_in_place_js_edit_in_place__WEBPACK_IMPORTED_MODULE_54__);
  /* harmony import */ var _node_modules_ui_core_components_counter_js_counter__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ../node_modules/ui-core/components/counter/js/counter */ "../../ui-core/components/counter/js/counter.js");
  /* harmony import */ var _node_modules_ui_core_components_counter_js_counter__WEBPACK_IMPORTED_MODULE_55___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_counter_js_counter__WEBPACK_IMPORTED_MODULE_55__);
  /* harmony import */ var _node_modules_ui_core_components_tables_js_sortable_table_row__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ../node_modules/ui-core/components/tables/js/sortable-table-row */ "../../ui-core/components/tables/js/sortable-table-row.js");
  /* harmony import */ var _node_modules_ui_core_components_tables_js_sortable_table_row__WEBPACK_IMPORTED_MODULE_56___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_tables_js_sortable_table_row__WEBPACK_IMPORTED_MODULE_56__);
  /* harmony import */ var _node_modules_ui_core_components_client_pagination_js_client_pagination__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ../node_modules/ui-core/components/client-pagination/js/client-pagination */ "../../ui-core/components/client-pagination/js/client-pagination.js");
  /* harmony import */ var _node_modules_ui_core_components_client_pagination_js_client_pagination__WEBPACK_IMPORTED_MODULE_57___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_client_pagination_js_client_pagination__WEBPACK_IMPORTED_MODULE_57__);
  /* harmony import */ var _node_modules_ui_core_components_back_to_top_js_back_to_top__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ../node_modules/ui-core/components/back-to-top/js/back-to-top */ "../../ui-core/components/back-to-top/js/back-to-top.js");
  /* harmony import */ var _node_modules_ui_core_components_back_to_top_js_back_to_top__WEBPACK_IMPORTED_MODULE_58___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_back_to_top_js_back_to_top__WEBPACK_IMPORTED_MODULE_58__);
  /* harmony import */ var _node_modules_ui_core_components_facet_date_chart_js_facet_date_chart__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ../node_modules/ui-core/components/facet-date-chart/js/facet-date-chart */ "../../ui-core/components/facet-date-chart/js/facet-date-chart.js");
  /* harmony import */ var _node_modules_ui_core_components_facet_date_chart_js_facet_date_chart__WEBPACK_IMPORTED_MODULE_59___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_facet_date_chart_js_facet_date_chart__WEBPACK_IMPORTED_MODULE_59__);
  /* harmony import */ var _node_modules_ui_core_components_progress_bar_js_progress_bar__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ../node_modules/ui-core/components/progress-bar/js/progress-bar */ "../../ui-core/components/progress-bar/js/progress-bar.js");
  /* harmony import */ var _node_modules_ui_core_components_progress_bar_js_progress_bar__WEBPACK_IMPORTED_MODULE_60___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_progress_bar_js_progress_bar__WEBPACK_IMPORTED_MODULE_60__);
  /* harmony import */ var _node_modules_ui_core_components_truncater_js_truncater__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ../node_modules/ui-core/components/truncater/js/truncater */ "../../ui-core/components/truncater/js/truncater.js");
  /* harmony import */ var _node_modules_ui_core_components_truncater_js_truncater__WEBPACK_IMPORTED_MODULE_61___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_truncater_js_truncater__WEBPACK_IMPORTED_MODULE_61__);
  /* harmony import */ var _node_modules_ui_core_components_autosave_form_js_autosave_form__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ../node_modules/ui-core/components/autosave-form/js/autosave-form */ "../../ui-core/components/autosave-form/js/autosave-form.js");
  /* harmony import */ var _node_modules_ui_core_components_autosave_form_js_autosave_form__WEBPACK_IMPORTED_MODULE_62___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_autosave_form_js_autosave_form__WEBPACK_IMPORTED_MODULE_62__);
  /* harmony import */ var _node_modules_ui_core_widgets_slideshow_js_showcase_slideshow__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/slideshow/js/showcase-slideshow */ "../../ui-core/widgets/slideshow/js/showcase-slideshow.js");
  /* harmony import */ var _node_modules_ui_core_widgets_slideshow_js_showcase_slideshow__WEBPACK_IMPORTED_MODULE_63___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_slideshow_js_showcase_slideshow__WEBPACK_IMPORTED_MODULE_63__);
  /* harmony import */ var _node_modules_ui_core_widgets_list_of_issues_js_loi__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/list-of-issues/js/loi */ "../../ui-core/widgets/list-of-issues/js/loi.js");
  /* harmony import */ var _node_modules_ui_core_widgets_trusted_proxy_js_trusted_proxy__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/trusted-proxy/js/trusted-proxy */ "../../ui-core/widgets/trusted-proxy/js/trusted-proxy.js");
  /* harmony import */ var _node_modules_ui_core_widgets_trusted_proxy_js_trusted_proxy__WEBPACK_IMPORTED_MODULE_65___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_trusted_proxy_js_trusted_proxy__WEBPACK_IMPORTED_MODULE_65__);
  /* harmony import */ var _node_modules_ui_core_widgets_quick_search_js_quick_search__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/quick-search/js/quick-search */ "../../ui-core/widgets/quick-search/js/quick-search.js");
  /* harmony import */ var _node_modules_ui_core_widgets_quick_search_js_quick_search__WEBPACK_IMPORTED_MODULE_66___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_quick_search_js_quick_search__WEBPACK_IMPORTED_MODULE_66__);
  /* harmony import */ var _node_modules_ui_core_widgets_advanced_search_js_advanced_search__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/advanced-search/js/advanced-search */ "../../ui-core/widgets/advanced-search/js/advanced-search.js");
  /* harmony import */ var _node_modules_ui_core_widgets_advanced_search_js_advanced_search__WEBPACK_IMPORTED_MODULE_67___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_advanced_search_js_advanced_search__WEBPACK_IMPORTED_MODULE_67__);
  /* harmony import */ var _node_modules_ui_core_widgets_search_result_js_search_result__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/search-result/js/search-result */ "../../ui-core/widgets/search-result/js/search-result.js");
  /* harmony import */ var _node_modules_ui_core_widgets_search_result_js_search_result__WEBPACK_IMPORTED_MODULE_68___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_search_result_js_search_result__WEBPACK_IMPORTED_MODULE_68__);
  /* harmony import */ var _node_modules_ui_core_widgets_publication_content_js_publication_content__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/publication-content/js/publication-content */ "../../ui-core/widgets/publication-content/js/publication-content.js");
  /* harmony import */ var _node_modules_ui_core_widgets_publication_content_js_publication_content__WEBPACK_IMPORTED_MODULE_69___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_publication_content_js_publication_content__WEBPACK_IMPORTED_MODULE_69__);
  /* harmony import */ var _node_modules_ui_core_widgets_table_of_content_js_table_of_content__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/table-of-content/js/table-of-content */ "../../ui-core/widgets/table-of-content/js/table-of-content.js");
  /* harmony import */ var _node_modules_ui_core_widgets_table_of_content_js_table_of_content__WEBPACK_IMPORTED_MODULE_70___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_table_of_content_js_table_of_content__WEBPACK_IMPORTED_MODULE_70__);
  /* harmony import */ var _node_modules_ui_core_widgets_publication_content_js_crossref__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/publication-content/js/crossref */ "../../ui-core/widgets/publication-content/js/crossref.js");
  /* harmony import */ var _node_modules_ui_core_widgets_publication_content_js_crossref__WEBPACK_IMPORTED_MODULE_71___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_publication_content_js_crossref__WEBPACK_IMPORTED_MODULE_71__);
  /* harmony import */ var _node_modules_ui_core_widgets_ad_placeholder_js_ad_placeholder__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/ad-placeholder/js/ad-placeholder */ "../../ui-core/widgets/ad-placeholder/js/ad-placeholder.js");
  /* harmony import */ var _node_modules_ui_core_widgets_ad_placeholder_js_ad_placeholder__WEBPACK_IMPORTED_MODULE_72___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_ad_placeholder_js_ad_placeholder__WEBPACK_IMPORTED_MODULE_72__);
  /* harmony import */ var _node_modules_ui_core_widgets_manage_alerts_js_manage_alerts__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/manage-alerts/js/manage-alerts */ "../../ui-core/widgets/manage-alerts/js/manage-alerts.js");
  /* harmony import */ var _node_modules_ui_core_widgets_manage_alerts_js_manage_alerts__WEBPACK_IMPORTED_MODULE_73___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_manage_alerts_js_manage_alerts__WEBPACK_IMPORTED_MODULE_73__);
  /* harmony import */ var _node_modules_ui_core_widgets_favorites_js_favorites__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/favorites/js/favorites */ "../../ui-core/widgets/favorites/js/favorites.js");
  /* harmony import */ var _node_modules_ui_core_widgets_favorites_js_favorites__WEBPACK_IMPORTED_MODULE_74___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_favorites_js_favorites__WEBPACK_IMPORTED_MODULE_74__);
  /* harmony import */ var _node_modules_ui_core_widgets_profile_main_js_profile_main__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/profile-main/js/profile-main */ "../../ui-core/widgets/profile-main/js/profile-main.js");
  /* harmony import */ var _node_modules_ui_core_widgets_profile_main_js_profile_main__WEBPACK_IMPORTED_MODULE_75___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_profile_main_js_profile_main__WEBPACK_IMPORTED_MODULE_75__);
  /* harmony import */ var _node_modules_ui_core_widgets_usage_reports_js_usage_reports__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/usage-reports/js/usage-reports */ "../../ui-core/widgets/usage-reports/js/usage-reports.js");
  /* harmony import */ var _node_modules_ui_core_widgets_usage_reports_js_usage_reports__WEBPACK_IMPORTED_MODULE_76___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_usage_reports_js_usage_reports__WEBPACK_IMPORTED_MODULE_76__);
  /* harmony import */ var _node_modules_ui_core_widgets_cookie_policy_popup_js_cookie_policy_popup__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/cookie-policy-popup/js/cookie-policy-popup */ "../../ui-core/widgets/cookie-policy-popup/js/cookie-policy-popup.js");
  /* harmony import */ var _node_modules_ui_core_widgets_cookie_policy_popup_js_cookie_policy_popup__WEBPACK_IMPORTED_MODULE_77___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_cookie_policy_popup_js_cookie_policy_popup__WEBPACK_IMPORTED_MODULE_77__);
  /* harmony import */ var _node_modules_ui_core_widgets_administrators_js_administrators__WEBPACK_IMPORTED_MODULE_78__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/administrators/js/administrators */ "../../ui-core/widgets/administrators/js/administrators.js");
  /* harmony import */ var _node_modules_ui_core_widgets_administrators_js_administrators__WEBPACK_IMPORTED_MODULE_78___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_administrators_js_administrators__WEBPACK_IMPORTED_MODULE_78__);
  /* harmony import */ var _node_modules_ui_core_widgets_multi_search_js_multi_search__WEBPACK_IMPORTED_MODULE_79__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/multi-search/js/multi-search */ "../../ui-core/widgets/multi-search/js/multi-search.js");
  /* harmony import */ var _node_modules_ui_core_widgets_multi_search_js_multi_search__WEBPACK_IMPORTED_MODULE_79___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_multi_search_js_multi_search__WEBPACK_IMPORTED_MODULE_79__);
  /* harmony import */ var _node_modules_ui_core_widgets_two_factor_authentication_js_two_factor_authentication__WEBPACK_IMPORTED_MODULE_80__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/two-factor-authentication/js/two-factor-authentication */ "../../ui-core/widgets/two-factor-authentication/js/two-factor-authentication.js");
  /* harmony import */ var _node_modules_ui_core_widgets_two_factor_authentication_js_two_factor_authentication__WEBPACK_IMPORTED_MODULE_80___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_two_factor_authentication_js_two_factor_authentication__WEBPACK_IMPORTED_MODULE_80__);
  /* harmony import */ var _node_modules_ui_core_widgets_raa_js_raa__WEBPACK_IMPORTED_MODULE_81__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/raa/js/raa */ "../../ui-core/widgets/raa/js/raa.js");
  /* harmony import */ var _node_modules_ui_core_widgets_raa_js_raa__WEBPACK_IMPORTED_MODULE_81___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_raa_js_raa__WEBPACK_IMPORTED_MODULE_81__);
  /* harmony import */ var _node_modules_ui_core_plugins_transplant_js_transplant__WEBPACK_IMPORTED_MODULE_82__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/transplant/js/transplant */ "../../ui-core/plugins/transplant/js/transplant.js");
  /* harmony import */ var _node_modules_ui_core_plugins_transplant_js_transplant__WEBPACK_IMPORTED_MODULE_82___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_transplant_js_transplant__WEBPACK_IMPORTED_MODULE_82__);
  /* harmony import */ var _node_modules_ui_core_widgets_author_index_js_author_index__WEBPACK_IMPORTED_MODULE_83__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/author-index/js/author-index */ "../../ui-core/widgets/author-index/js/author-index.js");
  /* harmony import */ var _node_modules_ui_core_widgets_author_index_js_author_index__WEBPACK_IMPORTED_MODULE_83___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_author_index_js_author_index__WEBPACK_IMPORTED_MODULE_83__);
  /* harmony import */ var _node_modules_ui_core_widgets_device_pairing_js_device_pairing__WEBPACK_IMPORTED_MODULE_84__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/device-pairing/js/device-pairing */ "../../ui-core/widgets/device-pairing/js/device-pairing.js");
  /* harmony import */ var _node_modules_ui_core_widgets_device_pairing_js_device_pairing__WEBPACK_IMPORTED_MODULE_84___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_device_pairing_js_device_pairing__WEBPACK_IMPORTED_MODULE_84__);
  /* harmony import */ var _node_modules_ui_core_widgets_pairing_management_js_pairing_management__WEBPACK_IMPORTED_MODULE_85__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pairing-management/js/pairing-management */ "../../ui-core/widgets/pairing-management/js/pairing-management.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pairing_management_js_pairing_management__WEBPACK_IMPORTED_MODULE_85___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pairing_management_js_pairing_management__WEBPACK_IMPORTED_MODULE_85__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_action_bar_js_pd_action_bar__WEBPACK_IMPORTED_MODULE_86__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-action-bar/js/pd-action-bar */ "../../ui-core/widgets/pd-action-bar/js/pd-action-bar.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_action_bar_js_pd_action_bar__WEBPACK_IMPORTED_MODULE_86___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_action_bar_js_pd_action_bar__WEBPACK_IMPORTED_MODULE_86__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_authors_js_pd_authors__WEBPACK_IMPORTED_MODULE_87__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-authors/js/pd-authors */ "../../ui-core/widgets/pd-authors/js/pd-authors.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_basic_metadata_js_pd_basic_metadata__WEBPACK_IMPORTED_MODULE_88__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-basic-metadata/js/pd-basic-metadata */ "../../ui-core/widgets/pd-basic-metadata/js/pd-basic-metadata.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_grants_js_funders__WEBPACK_IMPORTED_MODULE_89__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-grants/js/funders */ "../../ui-core/widgets/pd-grants/js/funders.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_grants_js_funders__WEBPACK_IMPORTED_MODULE_89___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_grants_js_funders__WEBPACK_IMPORTED_MODULE_89__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_metadata_form_js_pd_metadata_form__WEBPACK_IMPORTED_MODULE_90__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-metadata-form/js/pd-metadata-form */ "../../ui-core/widgets/pd-metadata-form/js/pd-metadata-form.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_metadata_form_js_pd_metadata_form__WEBPACK_IMPORTED_MODULE_90___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_metadata_form_js_pd_metadata_form__WEBPACK_IMPORTED_MODULE_90__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_pdf_js_pd_pdf__WEBPACK_IMPORTED_MODULE_91__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-pdf/js/pd-pdf */ "../../ui-core/widgets/pd-pdf/js/pd-pdf.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_search_categories_js_pd_search_categories__WEBPACK_IMPORTED_MODULE_92__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-search-categories/js/pd-search-categories */ "../../ui-core/widgets/pd-search-categories/js/pd-search-categories.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_search_categories_js_pd_search_categories__WEBPACK_IMPORTED_MODULE_92___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_search_categories_js_pd_search_categories__WEBPACK_IMPORTED_MODULE_92__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_submission_list_js_pd_submission_list__WEBPACK_IMPORTED_MODULE_93__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-submission-list/js/pd-submission-list */ "../../ui-core/widgets/pd-submission-list/js/pd-submission-list.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_supplemental_files_js_pd_supplemental_files__WEBPACK_IMPORTED_MODULE_94__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-supplemental-files/js/pd-supplemental-files */ "../../ui-core/widgets/pd-supplemental-files/js/pd-supplemental-files.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_supplemental_files_js_pd_supplemental_files__WEBPACK_IMPORTED_MODULE_94___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_supplemental_files_js_pd_supplemental_files__WEBPACK_IMPORTED_MODULE_94__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_supplemental_links_js_pd_supplemental_links__WEBPACK_IMPORTED_MODULE_95__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-supplemental-links/js/pd-supplemental-links */ "../../ui-core/widgets/pd-supplemental-links/js/pd-supplemental-links.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_supplemental_links_js_pd_supplemental_links__WEBPACK_IMPORTED_MODULE_95___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_supplemental_links_js_pd_supplemental_links__WEBPACK_IMPORTED_MODULE_95__);
  /* harmony import */ var _node_modules_ui_core_widgets_profile_menu_js_profile_menu__WEBPACK_IMPORTED_MODULE_96__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/profile-menu/js/profile-menu */ "../../ui-core/widgets/profile-menu/js/profile-menu.js");
  /* harmony import */ var _node_modules_ui_core_widgets_profile_menu_js_profile_menu__WEBPACK_IMPORTED_MODULE_96___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_profile_menu_js_profile_menu__WEBPACK_IMPORTED_MODULE_96__);
  /* harmony import */ var _node_modules_ui_core_widgets_remote_access_email_domains_js_remote_access_email_domains__WEBPACK_IMPORTED_MODULE_97__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/remote-access-email-domains/js/remote-access-email-domains */ "../../ui-core/widgets/remote-access-email-domains/js/remote-access-email-domains.js");
  /* harmony import */ var _node_modules_ui_core_widgets_remote_access_email_domains_js_remote_access_email_domains__WEBPACK_IMPORTED_MODULE_97___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_remote_access_email_domains_js_remote_access_email_domains__WEBPACK_IMPORTED_MODULE_97__);
  /* harmony import */ var _node_modules_ui_core_widgets_exam_certificate_js_exam_certificate__WEBPACK_IMPORTED_MODULE_98__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/exam-certificate/js/exam-certificate */ "../../ui-core/widgets/exam-certificate/js/exam-certificate.js");
  /* harmony import */ var _node_modules_ui_core_widgets_exam_certificate_js_exam_certificate__WEBPACK_IMPORTED_MODULE_98___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_exam_certificate_js_exam_certificate__WEBPACK_IMPORTED_MODULE_98__);
  /* harmony import */ var _node_modules_ui_core_widgets_menu_js_responsive_menu__WEBPACK_IMPORTED_MODULE_99__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/menu/js/responsive-menu */ "../../ui-core/widgets/menu/js/responsive-menu.js");
  /* harmony import */ var _node_modules_ui_core_widgets_menu_js_responsive_menu__WEBPACK_IMPORTED_MODULE_99___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_menu_js_responsive_menu__WEBPACK_IMPORTED_MODULE_99__);
  /* harmony import */ var _node_modules_ui_core_widgets_pcm_add_library_js_pcm_add_library__WEBPACK_IMPORTED_MODULE_100__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pcm-add-library/js/pcm-add-library */ "../../ui-core/widgets/pcm-add-library/js/pcm-add-library.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pcm_add_library_js_pcm_add_library__WEBPACK_IMPORTED_MODULE_100___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pcm_add_library_js_pcm_add_library__WEBPACK_IMPORTED_MODULE_100__);
  /* harmony import */ var _node_modules_ui_core_widgets_author_history_js_author_history__WEBPACK_IMPORTED_MODULE_101__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/author-history/js/author-history */ "../../ui-core/widgets/author-history/js/author-history.js");
  /* harmony import */ var _node_modules_ui_core_widgets_author_history_js_author_history__WEBPACK_IMPORTED_MODULE_101___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_author_history_js_author_history__WEBPACK_IMPORTED_MODULE_101__);
  /* harmony import */ var _node_modules_ui_core_widgets_advisor_action_records_js_advisor_action_records__WEBPACK_IMPORTED_MODULE_102__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/advisor-action-records/js/advisor-action-records */ "../../ui-core/widgets/advisor-action-records/js/advisor-action-records.js");
  /* harmony import */ var _node_modules_ui_core_widgets_advisor_action_records_js_advisor_action_records__WEBPACK_IMPORTED_MODULE_102___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_advisor_action_records_js_advisor_action_records__WEBPACK_IMPORTED_MODULE_102__);
  /* harmony import */ var _node_modules_ui_core_widgets_article_tools_js_article_tools__WEBPACK_IMPORTED_MODULE_103__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/article-tools/js/article-tools */ "../../ui-core/widgets/article-tools/js/article-tools.js");
  /* harmony import */ var _node_modules_ui_core_widgets_article_tools_js_article_tools__WEBPACK_IMPORTED_MODULE_103___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_article_tools_js_article_tools__WEBPACK_IMPORTED_MODULE_103__);
  /* harmony import */ var _node_modules_ui_core_widgets_show_recommended_js_show_recommended__WEBPACK_IMPORTED_MODULE_104__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/show-recommended/js/show-recommended */ "../../ui-core/widgets/show-recommended/js/show-recommended.js");
  /* harmony import */ var _node_modules_ui_core_widgets_show_recommended_js_show_recommended__WEBPACK_IMPORTED_MODULE_104___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_show_recommended_js_show_recommended__WEBPACK_IMPORTED_MODULE_104__);
  /* harmony import */ var _node_modules_ui_core_widgets_list_of_issues_detailed_js_list_of_issues_accordion__WEBPACK_IMPORTED_MODULE_105__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/list-of-issues-detailed/js/list-of-issues-accordion */ "../../ui-core/widgets/list-of-issues-detailed/js/list-of-issues-accordion.js");
  /* harmony import */ var _node_modules_ui_core_widgets_disable_adblocker_js_disable_adblocker__WEBPACK_IMPORTED_MODULE_106__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/disable-adblocker/js/disable-adblocker */ "../../ui-core/widgets/disable-adblocker/js/disable-adblocker.js");
  /* harmony import */ var _node_modules_ui_core_widgets_disable_adblocker_js_disable_adblocker__WEBPACK_IMPORTED_MODULE_106___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_disable_adblocker_js_disable_adblocker__WEBPACK_IMPORTED_MODULE_106__);
  /* harmony import */ var _components_toggle__WEBPACK_IMPORTED_MODULE_107__ = __webpack_require__(/*! ./components/_toggle */ "../../ui-theme-classic/js/components/_toggle.js");
  /* harmony import */ var _components_toggle__WEBPACK_IMPORTED_MODULE_107___default = /*#__PURE__*/__webpack_require__.n(_components_toggle__WEBPACK_IMPORTED_MODULE_107__);
  /* harmony import */ var _widgets_collapsible_menu__WEBPACK_IMPORTED_MODULE_108__ = __webpack_require__(/*! ./widgets/_collapsible-menu */ "../../ui-theme-classic/js/widgets/_collapsible-menu.js");
  /* harmony import */ var _widgets_collapsible_menu__WEBPACK_IMPORTED_MODULE_108___default = /*#__PURE__*/__webpack_require__.n(_widgets_collapsible_menu__WEBPACK_IMPORTED_MODULE_108__);
  /* harmony import */ var _widgets_slideshow__WEBPACK_IMPORTED_MODULE_109__ = __webpack_require__(/*! ./widgets/_slideshow */ "../../ui-theme-classic/js/widgets/_slideshow.js");
  /* harmony import */ var _widgets_slideshow__WEBPACK_IMPORTED_MODULE_109___default = /*#__PURE__*/__webpack_require__.n(_widgets_slideshow__WEBPACK_IMPORTED_MODULE_109__);
  /* harmony import */ var _widgets_publication_content__WEBPACK_IMPORTED_MODULE_110__ = __webpack_require__(/*! ./widgets/_publication-content */ "../../ui-theme-classic/js/widgets/_publication-content.js");
  /* harmony import */ var _widgets_publication_content__WEBPACK_IMPORTED_MODULE_110___default = /*#__PURE__*/__webpack_require__.n(_widgets_publication_content__WEBPACK_IMPORTED_MODULE_110__);
  /* harmony import */ var _widgets_drawer__WEBPACK_IMPORTED_MODULE_111__ = __webpack_require__(/*! ./widgets/_drawer */ "../../ui-theme-classic/js/widgets/_drawer.js");
  /* harmony import */ var _widgets_drawer__WEBPACK_IMPORTED_MODULE_111___default = /*#__PURE__*/__webpack_require__.n(_widgets_drawer__WEBPACK_IMPORTED_MODULE_111__);
  /* harmony import */ var _widgets_dropBlockUl__WEBPACK_IMPORTED_MODULE_112__ = __webpack_require__(/*! ./widgets/_dropBlockUl */ "../../ui-theme-classic/js/widgets/_dropBlockUl.js");
  /* harmony import */ var _widgets_dropBlockUl__WEBPACK_IMPORTED_MODULE_112___default = /*#__PURE__*/__webpack_require__.n(_widgets_dropBlockUl__WEBPACK_IMPORTED_MODULE_112__);
  /* harmony import */ var _widgets_book_product__WEBPACK_IMPORTED_MODULE_113__ = __webpack_require__(/*! ./widgets/_book-product */ "../../ui-theme-classic/js/widgets/_book-product.js");
  /* harmony import */ var _widgets_book_product__WEBPACK_IMPORTED_MODULE_113___default = /*#__PURE__*/__webpack_require__.n(_widgets_book_product__WEBPACK_IMPORTED_MODULE_113__);
  /* harmony import */ var _widgets_table_of_content__WEBPACK_IMPORTED_MODULE_114__ = __webpack_require__(/*! ./widgets/_table-of-content */ "../../ui-theme-classic/js/widgets/_table-of-content.js");
  /* harmony import */ var _widgets_table_of_content__WEBPACK_IMPORTED_MODULE_114___default = /*#__PURE__*/__webpack_require__.n(_widgets_table_of_content__WEBPACK_IMPORTED_MODULE_114__);
  /* harmony import */ var _widgets_quick_search__WEBPACK_IMPORTED_MODULE_115__ = __webpack_require__(/*! ./widgets/_quick-search */ "../../ui-theme-classic/js/widgets/_quick-search.js");
  /* harmony import */ var _widgets_quick_search__WEBPACK_IMPORTED_MODULE_115___default = /*#__PURE__*/__webpack_require__.n(_widgets_quick_search__WEBPACK_IMPORTED_MODULE_115__);
  /* harmony import */ var _components_slide_js__WEBPACK_IMPORTED_MODULE_116__ = __webpack_require__(/*! ./components/slide.js */ "../../ui-theme-classic/js/components/slide.js");
  /* harmony import */ var _components_slide_js__WEBPACK_IMPORTED_MODULE_116___default = /*#__PURE__*/__webpack_require__.n(_components_slide_js__WEBPACK_IMPORTED_MODULE_116__);
  /* harmony import */ var _components_transplant__WEBPACK_IMPORTED_MODULE_117__ = __webpack_require__(/*! ./components/transplant */ "../../ui-theme-classic/js/components/transplant.js");
  /* harmony import */ var _components_transplant__WEBPACK_IMPORTED_MODULE_117___default = /*#__PURE__*/__webpack_require__.n(_components_transplant__WEBPACK_IMPORTED_MODULE_117__);
  /* harmony import */ var _components_article__WEBPACK_IMPORTED_MODULE_118__ = __webpack_require__(/*! ./components/article */ "../../ui-theme-classic/js/components/article.js");
  /* harmony import */ var _components_article__WEBPACK_IMPORTED_MODULE_118___default = /*#__PURE__*/__webpack_require__.n(_components_article__WEBPACK_IMPORTED_MODULE_118__);
  /* harmony import */ var _components_form__WEBPACK_IMPORTED_MODULE_119__ = __webpack_require__(/*! ./components/form */ "../../ui-theme-classic/js/components/form.js");
  /* harmony import */ var _components_form__WEBPACK_IMPORTED_MODULE_119___default = /*#__PURE__*/__webpack_require__.n(_components_form__WEBPACK_IMPORTED_MODULE_119__);
  /* harmony import */ var _components_tabs__WEBPACK_IMPORTED_MODULE_120__ = __webpack_require__(/*! ./components/tabs */ "../../ui-theme-classic/js/components/tabs.js");
  /* harmony import */ var _components_tabs__WEBPACK_IMPORTED_MODULE_120___default = /*#__PURE__*/__webpack_require__.n(_components_tabs__WEBPACK_IMPORTED_MODULE_120__);
  /* harmony import */ var _sticky__WEBPACK_IMPORTED_MODULE_121__ = __webpack_require__(/*! ./_sticky */ "../../ui-theme-classic/js/_sticky.js");
  // @todo dynamic imports
  // @sample:
  // const __path__modules = '../../../../node_modules';
  // import (__path__modules + "/jquery/dist/jquery");
  // @todo 2 make it modules imports as import('jquery');
  console.log('Classic Theme MainJS - UX3 based'); // Classic
  
  
   // -- VANILA JS --
  // # polyfills - has to be first - before everything else
  
  
   // # lodash/underscore, ...
  
   // # utils, plugins
  
   // media query JS
  // -- JQUERY --
  // # jQuery
  
  
   // @fixme this is here only because NO ONE HERE KNOWS HOW TO CODE! And Literatum JS is DEPENDENT!!!&^*#%& on jQuery UI < 1.12! ... are YOU SERIOUS?! AND it is here only because laziness of devs here
  // ## jQuery plugins
  // ### Selectors
  
  
   // ### ?
  
   // ?
  
   // ?
  
   // ?
  
   // ?
  
   // @todo use this instead of whole jQuery UI
  //import "../../../../node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker"; // instead of jQueryUI // @fixme: import "bootstrap-datepicker"; # module import should work
  //
  
   // BS v3 tabs
  // import '../node_modules/ui-core/plugins/tabs/js/tabs-accessibility'; // no need for this anymore
  
   // BS modal
  //
  
   // # Literatum connector
  
   // -- UX3 --
  // # namespace
  
   // -- Font Loader
  
  
  
   // # Variables
  // What is actually used in JS are only those 4 variables ... si instead of whole THEO:
  
  UX.grid = {
    // refers to max values from SCSS
    screenXsMax: 576 - 1,
    // $screen-xs-max
    screenSmMax: 768 - 1,
    // $screen-sm-max
    screenMdMax: 1124 - 1,
    // $screen-md-max
    screenLgMax: 1200 - 1 // $screen-lg-max
  
  }; // ## Utils, polyfills and polymorphs
  
   // basic UX3 useful functions
  
   // basic UX3 features tests
  
  
  
  
   // # custom enquireIt
  
   // ## ------------------------------- BASIC -------------------------
  // import '../node_modules/ui-core/plugins/controller/js/enquireIt'; // UX3 media queries
  
   // UX3 state machine
  
   // UX3 cookies
  
  
  
  
  
  
   // ## ------------------------------- COMPONENTS --------------------
  
  
   // ??
  
  
  
   // import '../node_modules/ui-core/components/facet/js/toggle';
  
  
  
  
  
  
  
  
  
  
   // import slide after tabs !!!
  
  
  
  
  
  
   //import '../node_modules/ui-core/components/side-bar-sections/js/side-bar-sections'; // replaced by article TOC
  
  
  
  
   // ## ------------------------------- WIDGETS --------------------
  // import '../node_modules/ui-core/widgets/slideshow/js/slideshow'; // replaced by classic/js/widgets/_slideshow
  
  
   // replaced by classic/js/widgets/_loi
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   // import '../node_modules/ui-core/widgets/list-of-issues-detailed/js/list-of-issues-detailed'; // replaced by classic/js/widgets/_loi
  
  
  
  
   // @fixme ! deprecate this
  // ## ------------------------------- TEMPLATES --------------------
  // import '../node_modules/ui-core/templates/footer/js/footer';
  // import '../node_modules/ui-core/templates/my-account/js/my-account';
  //Classic
  
   //todo: rewrite
  
   // import './widgets/_loi';// deprecated use ui-core
  // import './widgets/_accordion-loi';
  
  
  
  
  
  
  
   // Classic - imported from EHP solutions
  
  
   // import './components/drawer'; // not working correctly @fixme
  // Product
  
  
  
   // end: SourceJS workaround
  
  try {
    if (typeof define !== 'undefined') {
      define = __orig__define;
    }
  } catch (e) {
    console.warn('Something went wrong with returning define method to original state, but it probably should not affect app. But still, better check error message: ', e);
  } // # Notes
  // ## REMOVED or DEPRECATED totally
  // - all JS handling of sticky position
  // import '../node_modules/ui-core/plugins/sticko/js/sticko'
  // import '../node_modules/ui-core/plugins/scrollo/js/scrollo'
  // import '../node_modules/ui-core/plugins/header-scroll-fix/js/header-scroll-fix'
  // import '../node_modules/ui-core/plugins/auto-hide-bar/js/auto-hide-bar'
  // import '../node_modules/ui-core/components/coolbar/js/stickybar';
  // - plugin used only for placing one popup on whole site - widget - special character palette - which seems unused
  // import '../node_modules/ui-core/plugins/popper/popper';
  // - special character palette widget JS - should be refactored to at least not use plugin above
  // import '../node_modules/ui-core/widgets/special-character-palette/js/special-character-palette';
  // import '../node_modules/ui-core/plugins/jquery/jquery-migrate' // jQuery migrate from 1, 2 - definitely should not be here
  // - Product THEO/YAML variables
  // import '../variables/js/imports';
  
  
  
  
  (function () {
    $(document).ready(function () {
      // detect IE to reset "sticky" position as it's not supported there
      if (window.ActiveXObject || "ActiveXObject" in window) {
        $('body').addClass("IE");
      } // "HACK" for active item in secondary navigation
      //It should not be solve this way, but we have nothing better now :/
  
  
      var item = $('.secondary-navigation a[href="' + location.pathname + '"]');
  
      if (item) {
        item.addClass("active");
      }
  
      UX.controller.init(); // try {
      //     if (!$(".source_example").length && $(".sticko , .sticko__md, .sticko__sm").length) {
      //         UX.sticko.init();
      //     }
      // } catch (e) {
      //     console.error(e);
      // }
  
      try {
        if ($('[data-toggle="nav"]').length) {
          UX.menu.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".datepicker").length) {
          UX.datepicker.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.w-slide__btn').length) {
          UX.slide.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('[data-db-target-for]').length) {
          UX.dropBlock.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('[data-toggle="modal"]').length) {
          UX.modal.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('table').length) {
          UX.toggleTable.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.facet').length) {
          UX.toggle.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.facetDate.init();
  
        if ($('.accordion').length) {
          UX.accordion.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.facetDateChart').length) {
          UX.facetDateChart.init();
        }
      } catch (e) {
        console.error(e);
      } // try {
      //
      //     if ($('.coolBar').length) {
      //         UX.coolbar.init();
      //     }
      // } catch (e) {
      //     console.error(e);
      // }
      // try {
      //     if ($('.stickybar').length) {
      //         UX.stickybar.init();
      //     }
      // } catch (e) {
      //     console.error(e);
      // }
  
  
      try {
        if ($('article').length) {
          UX.loader.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.back-to-top').length) {
          UX.backToTop.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.refineSearch').length || $('.advanced-search').length) {
          UX.refine.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.advanced-search').length) {
          UX.searchFieldsCtrl.init();
        }
      } catch (e) {
        console.error(e);
      } // try {
      //     if ($(".table-fn").length || $('.ref.fn').length || $(".scroll-to-target").length || $("a.sr-only-focusable").length) {
      //         UX.scrollo.init();
      //     }
      // } catch (e) {
      //     console.error(e);
      // }
  
  
      try {
        if ($('figure').length) {
          UX.figureViewer.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.tab').length) {
          UX.tab.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.owl-carousel').length) {
          UX.slider.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.loi__banner').length) {
          UX.loi.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.quick-search').length) {
          UX.quickSearch.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.fieldsCtrl.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('[data-toggle="transplant"]').length) {
          UX.transplant.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".js__toggleAdForm").length) {
          UX.adplaceholder.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".trusted-proxy-form").length) {
          UX.trustedPoxy.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.alerts.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($("#institutionList").length) {
          UX.profileMain.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.dropblockUl.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.searchResult.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".favoriteShortlist").length) {
          UX.favorites.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".expandable-list").length) {
          UX.list.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".basic-metadata").length) {
          UX.basicMetadata.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".supplemental-links").length) {
          UX.supplementalLinks.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".funders").length) {
          UX.funders.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".uploader").length) {
          UX.fileUploader.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.author-index').length) {
          UX.authorIndex.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".sortable-table").length) {
          UX.sortableTableRow.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".submission-authors").length) {
          UX.submissionAuthors.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($("#institutionUsageReport").length) {
          UX.reports.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.cookiePolicy-popup').length) {
          UX.cookiePolicyPopupWidget.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".supplemental-files").length) {
          UX.supplementalFiles.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".js-editable").length) {
          UX.editInPlace.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".submission-list").length) {
          UX.submissionList.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".pd-action-bar").length) {
          UX.pdActionBar.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".authorsHistoryWidget").length) {
          UX.authorsHistory.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".js-counter").length) {
          UX.charCounter.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($("#draftForm").length) {
          UX.draftForm.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".pairing-management").length) {
          UX.pairingManagment.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".device-pairing").length) {
          UX.devicePairing.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".scrollThenFix").length) {//UX.headerScrollFix.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".taxonomies-input-group").length) {
          UX.pdSearchCategories.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.client-pagination').length) {
          UX.clientPagination.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.remote-access-email-domains').length) {
          UX.remoteAccessEmail.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.js__removeAdmins').length) {
          UX.administrators.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.responsive-menu-nav').length) {
          UX.reponsiveMenu.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.js__removeAdmins').length) {
          UX.administrators.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.multi-search').length) {
          UX.multiSearch.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.sections-block').length) {
          UX.sidebarSections.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.auto-hide-primary-bar').length) {
          UX.autoHideBar.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.pageBody.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".js--truncate").length) {
          UX.truncater.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".progress-bar").length) {
          UX.progressBar.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".two-factor-authentication").length) {
          UX.tfa.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.scp').length) {
          UX.charPalette.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($(".js-showcase-slideshow").length) {
          UX.showcaseSlideshow.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        if ($('.autosave-form').length) {
          UX.pdAutoSave.init();
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.noFocusableSVG.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        if (document.querySelector('.share__block') !== null) {
          observeDOM(document.querySelector('.share__block'), function () {
            UX.noFocusableSVG.init();
          });
        }
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.showRecommended.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.abLogger.init();
      } catch (e) {
        console.error(e);
      }
  
      try {
        UX.enquireIt.init(); // important: keep it always last
      } catch (e) {
        console.error(e);
      }
    });
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/_accordion.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/_accordion.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var accordion = UX.accordion;
  
    UX.accordion.logic = function (elem) {
      if (accordion.hideAllBoolean) {
        accordion.hideAll();
      }
  
      accordion.$tabbedElements = elem;
      var parentAccordion = accordion.$tabbedElements.closest('.accordion');
  
      if (parentAccordion.parent('[data-default-collapsed]').length) {
        accordion.defaultCollapsed = parentAccordion.parent('[data-default-collapsed]');
      }
  
      if (accordion.defaultCollapsed || accordion.defaultCollapsed == "all") {
        accordion.$tabbedElements.each(function () {
          var $this = $(this);
          $this.find(".accordion-tabbed__tab").each(function (index) {
            var $this = $(this);
  
            if (accordion.preventAccordionBehavior($this)) {
              return;
            }
  
            if (!accordion.collapseTabsByDefault(this) && index == accordion.openedAccordion && !$this.hasClass('accordion__closed') && accordion.defaultCollapsed != "all") {
              $this.addClass('js--open');
              $this.find('.accordion-tabbed__control').attr('aria-expanded', 'true');
              $this.find('.accordion-tabbed__content').show();
  
              if ($this.find('.accordion-lazy').length) {
                accordion.getAccordionContent($this.find('.accordion-lazy'));
              }
            } else {
              $this.removeClass('js--open');
              $this.find('.accordion-tabbed__control').attr('aria-expanded', 'false');
              $this.find('.accordion-tabbed__content').hide();
            }
          });
        });
      } else {
        accordion.$tabbedElements.each(function () {
          var $this = $(this);
          $this.find("[class*='accordion-tabbed__tab']").each(function (index) {
            var $this = $(this);
            $this.addClass('js--open');
            $this.find('.accordion-tabbed__control').attr('aria-expanded', 'true');
            $this.find('.accordion-tabbed__content').show();
          });
        });
      }
    };
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/_toggle.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/_toggle.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  //todo: needs to be refactored...
  (function ($, UX) {
    var $body = $('body');
    var _toggle = {
      $toggle: $('.facet:not(.displayAll)'),
      toggleClasses: "icon-chevron-up",
      init: function init() {
        _toggle.on.build();
  
        _toggle.control();
      },
      control: function control() {
        $body.on('click', '.facet__show-more', function (e) {
          e.preventDefault();
  
          _toggle.on.toggle($(this));
        });
        $body.find('.facet .dropdown__toggle').off();
        $body.on('click', '.facet .dropdown__toggle', function (e) {
          e.preventDefault();
  
          _toggle.on.toggleFacet($(this));
        });
      },
      on: {
        build: function build() {
          _toggle.$toggle.each(function () {
            var $target = $(this).find('ul.facet__list');
            var $lis = $target.children('li');
            var $select = $(this).find('.facet__select ');
            var $options = $select.children('option');
            var lisNum = $lis.length;
            var optionsNum = $options.length;
            var isToggle = lisNum > 5;
            _toggle.facetsMoreText = $(this).closest(".facets-group").data("more-text");
            _toggle.facetsLessText = $(this).closest(".facets-group").data("less-text");
            var moreCount = optionsNum + lisNum - 5;
            if ($target.find('[name=facet-hidden-items]').length) moreCount = $target.find('[name=facet-hidden-items]').val();
            $target.closest('.facet').attr('data-more-count', moreCount);
            if (isToggle) $target.after('<a href="#" class="facet__show-more" aria-expanded="false">' + _toggle.facetsMoreText + ' <span class="facet__show-more__count">(' + moreCount + ')</span> <i class="icon-chevron-down" aria-hidden="true"></i></a>');
            $select.each(function () {
              var mis = $(this).magicSuggest({
                hideTrigger: 'true',
                allowFreeEntries: 'false',
                expandOnFocus: true,
                maxSelection: 1,
                placeholder: $(this).data('placeholder')
              });
              $(mis).on('selectionchange', function (e, m, selection) {
                if (selection != undefined) {
                  window.location.href = selection[0].id;
                }
              });
            });
          });
        },
        toggle: function toggle(elem) {
          var $toggle = elem.closest('.facet');
          var $target = $toggle.find('ul.facet__list');
          $target.find('.js--toggle').slideToggle();
          $toggle.find('.facet__select--hidden').toggle();
          elem.toggleClass('js--open');
  
          if (elem.hasClass('js--open')) {
            elem.html(_toggle.facetsLessText + ' <i class="icon-chevron-up" aria-hidden="true"></i>');
            elem.closest(".accordion__content").find('li:nth-child(6) a').focus();
            elem.attr('aria-expanded', true);
          } else {
            elem.html(_toggle.facetsMoreText + ' <span class="facet__show-more__count">(' + $toggle.data('more-count') + ')</span> <i class="icon-chevron-down" aria-hidden="true"></i>');
            elem.closest(".accordion__content").find('li:first-child a').blur();
            elem.attr('aria-expanded', false);
          }
        },
        toggleFacet: function toggleFacet(elem) {
          var $toggle = elem.closest('li');
          var $target = $toggle.children('ul.facet-dropdown__menu');
          $target.slideToggle();
          elem.toggleClass('js--open');
          elem.find('i').toggleClass(_toggle.toggleClasses);
  
          if (elem.hasClass('js--open')) {
            $target.attr('aria-hidden', false);
          } else {
            $target.attr('aria-hidden', true);
          }
        }
      }
    };
    UX.toggle = _toggle; // add to global namespace
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/article.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/article.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function ($, UX) {
    $window = $(window);
    UX.article = UX.article || {};
    UX.settings = UX.settings || {};
    UX.settings.article = UX.settings.article || {}; // default settings
  
    UX.settings.article = $.extend(true, {}, {
      selector: {
        toc__block: '.tos-list__body',
        toc__nav: '[data-create=tos]',
        toc__targets: '.article__content .section__title, .authorArticleInfoCon, .table-of-content .tos-list__target',
        article__content: '.article__content, .table-of-content'
      }
    }, UX.settings.article);
  
    UX.article.init = function () {
      UX.article.toc__create();
      $window.on("scroll", UX.article.toc__scrollSpy);
    }; /// Document TOC creator
  
  
    UX.article.toc__create = function () {
      var $sections = UX.article.$sections = $(UX.settings.article.selector.toc__targets);
      var $nav = UX.article.$nav = $(UX.settings.article.selector.toc__nav);
      var $block = UX.article.$ctrl = $(UX.settings.article.selector.toc__block);
      var $articleContent = UX.article.$articleContent = $(UX.settings.article.selector.article__content);
      UX.article.offset = $('.header').outerHeight() || 0 + $('.navbar').outerHeight() || 0 + $('.article__navbar').outerHeight() || 0;
  
      if (!$nav.length || !($sections.length > 1)) {
        $nav.remove();
        $block.remove();
        return;
      }
  
      $articleContent.addClass('has-sections');
      var ul = $('<ul class="rlist w-slide--list" role="menu"/>').appendTo($nav);
      $sections.each(function () {
        var $this = $(this).clone(),
            $li = $('<li/>').attr('role', 'menuitem').appendTo(ul),
            $link = $('<a class="w-slide__hide"/>').attr('href', "#" + $this.attr('id')).appendTo($li);
        $this.find('.ref').remove();
        $('<span/>').text($this.text()).appendTo($link);
      });
    };
  
    UX.article.toc__scrollSpy = _.debounce(function () {
      // @todo: taken code from 'side-bar-sections' - should be refactored to not use EACH
      UX.article.$sections.each(function (e) {
        if ($(window).scrollTop() >= $(this).offset().top - UX.article.offset - $(this).outerHeight() - 15) {
          var id = $(this).attr('id');
          UX.article.$nav.find('a').removeClass("active");
          UX.article.$nav.find('a[href="#' + id + '"]').addClass("active");
        }
      });
    }); // init self on ready
  
    $(document).ready(UX.article.init);
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/form.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/form.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function ($, UX) {
    UX.form = UX.form || {};
  
    UX.form.init = function () {
      UX.form.select();
    };
  
    UX.form.select = function () {
      $('select.jcf').wrap('<div class="select"/>').parent().append('<span class="after"/>');
    }; // init self on ready
  
  
    $(document).ready(UX.form.init);
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/slide.js":
  /*!*************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/slide.js ***!
    \*************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (UX) {
    var $window = $(window),
        $body = $('body');
    var slide = UX.slide;
    slide.vPort = 'screen-xs'; // Save original functions
  
    var _ux3lvl_slide_init = slide.init;
    var _ux3lvl_slide_onShow = slide.on.show;
    var _ux3lvl_slide_onHide = slide.on.hide;
    var _ux3lvl_slide_onOff = slide.on.off;
  
    slide.init = function () {
      _ux3lvl_slide_init.apply(this, arguments);
  
      slide.$back.attr('tabindex', '-1');
    };
  
    slide.on.show = function () {
      _ux3lvl_slide_onShow.apply(this, arguments);
  
      slide.$back.removeAttr('tabindex');
    };
  
    slide.on.hide = function () {
      _ux3lvl_slide_onHide.apply(this, arguments);
  
      slide.$back.attr('tabindex', '-1');
    };
  
    slide.on.off = function () {
      _ux3lvl_slide_onOff.apply(this, arguments);
  
      slide.$back.attr('tabindex', '-1');
    };
  
    slide.responsive = function (index) {
      $(document).on(slide.vPort[index] + '-on', function () {
        // Waiting for custom event that will be triggered by controller.js to activate responsive effects
        slide.off = false;
        slide.$elements.css('transform', "");
        $('.w-slide__btn').each(function () {
          if ($(this).data('ctrl-res') == slide.vPort[index]) {
            $(this).addClass('slide-active');
          }
        });
      });
      $(document).on(slide.vPort[index] + '-off', function (e) {
        // Waiting for custom event that will be triggered by controller.js to activate responsive effects
        slide.off = true;
        slide.on.off(e);
        slide.$elements.css('transform', "");
        $('.w-slide__btn').each(function () {
          if ($(this).data('ctrl-res') == slide.vPort[index]) {
            $(this).removeClass('slide-active');
          }
        });
      });
      $(document).on(slide.elementvPort + '-on', function (e) {
        // Waiting for custom event that will be triggered by controller.js to activate responsive effects
        slide.isMobile = true;
        slide.$elements.css('margin-top', 0);
        slide.back = true;
  
        if ($body.attr('data-active') === 'slide') {
          slide.on.hide(e);
        }
      });
      $(document).on(slide.elementvPort + '-off', function (e) {
        // Waiting for custom event that will be triggered by controller.js to activate responsive effects
        slide.isMobile = false;
        slide.back = true;
  
        if ($body.attr('data-active') === 'slide') {
          slide.on.hide(e);
        }
      });
    };
  })(UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/tabs.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/tabs.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    UX.tab = UX.tab || {};
    UX.tab.vPort = 'screen-sm';
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/components/transplant.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/components/transplant.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function (UX) {
    var transplant = UX.transplant;
    var isMobile = false; // Save original functions
  
    var _ux3lvl_transplant_clone = transplant.clone;
    transplant.vPort = "screen-sm";
  
    transplant.clone = function () {
      _ux3lvl_transplant_clone.apply(this, arguments);
  
      if (transplant.$element.hasClass('cloned-with-ids')) return;
      transplant.$element.addClass('cloned-with-ids'); // suffix duplicate IDs!
  
      var id = transplant.$element.attr('id');
  
      if (id) {
        transplant.$element.attr('id', id + '-cloned');
      }
  
      transplant.$element.find('[id]').each(function () {
        var $this = $(this);
        var id = $this.attr('id');
        $this.attr('id', id + '-cloned');
      }); // Cloned dropBlocks ID, controls handling
  
      var targetFor = transplant.$element.attr("data-db-target-of");
  
      if (targetFor) {
        var $controler = $("[data-db-target-for=" + targetFor + "]");
  
        if (!isMobile) {
          $controler.attr({
            'aria-controls': targetFor + '-cloned'
          });
        }
  
        $(document).on(transplant.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
          $controler.attr({
            'aria-controls': targetFor
          });
        });
        $(document).on(transplant.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
          $controler.attr({
            'aria-controls': targetFor + '-cloned'
          });
        });
      }
    };
  })(UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/sourceJs.js":
  /*!*****************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/sourceJs.js ***!
    \*****************************************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/toConsumableArray.js");
  /* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_grants_js_mimicked_funders__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-grants/js/mimicked-funders */ "../../ui-core/widgets/pd-grants/js/mimicked-funders.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_grants_js_mimicked_funders__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_grants_js_mimicked_funders__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_authors_js_mimicked_pd_authos__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-authors/js/mimicked-pd-authos */ "../../ui-core/widgets/pd-authors/js/mimicked-pd-authos.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_authors_js_mimicked_pd_authos__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_authors_js_mimicked_pd_authos__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_basic_metadata_js_mimicked_pd_basic_metadata__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-basic-metadata/js/mimicked-pd-basic-metadata */ "../../ui-core/widgets/pd-basic-metadata/js/mimicked-pd-basic-metadata.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_basic_metadata_js_mimicked_pd_basic_metadata__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_basic_metadata_js_mimicked_pd_basic_metadata__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _node_modules_ui_core_widgets_pd_action_bar_js_mimicked_pd_action_bar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/pd-action-bar/js/mimicked-pd-action-bar */ "../../ui-core/widgets/pd-action-bar/js/mimicked-pd-action-bar.js");
  /* harmony import */ var _node_modules_ui_core_widgets_pd_action_bar_js_mimicked_pd_action_bar__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_pd_action_bar_js_mimicked_pd_action_bar__WEBPACK_IMPORTED_MODULE_4__);
  /* harmony import */ var _node_modules_ui_core_widgets_author_history_js_mimicked_author_history__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/author-history/js/mimicked-author-history */ "../../ui-core/widgets/author-history/js/mimicked-author-history.js");
  /* harmony import */ var _node_modules_ui_core_widgets_author_history_js_mimicked_author_history__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_author_history_js_mimicked_author_history__WEBPACK_IMPORTED_MODULE_5__);
  /* harmony import */ var _node_modules_ui_core_widgets_raa_js_two_factors_authentication__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/raa/js/two-factors-authentication */ "../../ui-core/widgets/raa/js/two-factors-authentication.js");
  /* harmony import */ var _node_modules_ui_core_widgets_raa_js_two_factors_authentication__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_raa_js_two_factors_authentication__WEBPACK_IMPORTED_MODULE_6__);
  /* harmony import */ var _widgets_override_loi_ajax__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./widgets/_override-loi-ajax */ "../../ui-theme-classic/js/widgets/_override-loi-ajax.js");
  /* harmony import */ var _widgets_override_loi_ajax__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_widgets_override_loi_ajax__WEBPACK_IMPORTED_MODULE_7__);
  /* harmony import */ var _node_modules_ui_core_plugins_copy_text_js_copy_text__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../node_modules/ui-core/plugins/copy-text/js/copy-text */ "../../ui-core/plugins/copy-text/js/copy-text.js");
  /* harmony import */ var _node_modules_ui_core_plugins_copy_text_js_copy_text__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_plugins_copy_text_js_copy_text__WEBPACK_IMPORTED_MODULE_8__);
  /* harmony import */ var _node_modules_ui_core_widgets_export_citations_js_export_citations__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../node_modules/ui-core/widgets/export-citations/js/export-citations */ "../../ui-core/widgets/export-citations/js/export-citations.js");
  /* harmony import */ var _node_modules_ui_core_widgets_export_citations_js_export_citations__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_widgets_export_citations_js_export_citations__WEBPACK_IMPORTED_MODULE_9__);
  /* harmony import */ var _node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../node_modules/ui-core/components/article-actions-bar/js/article-action-bar */ "../../ui-core/components/article-actions-bar/js/article-action-bar.js");
  /* harmony import */ var _node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_10__);
  
  // SourceJS Classic Theme
  console.log('Classic Theme SourceJS'); // Select text in input on click
  
  document.body.addEventListener('click', function (e) {
    var target = e.target;
  
    if (target.tagName === 'INPUT' && target.type === 'text') {
      target.select();
    }
  });
  /**
   * Mock content in profilePages
   */
  
  try {
    /**
     * Tab-like mock for profile content
     * @context {Node}
     */
    var mock__profilePage_changeContent = function mock__profilePage_changeContent() {
      // hide all
      _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(document.querySelectorAll(mock__profilePage_list.join(', '))).forEach(function (el) {
        el.style.display = 'none';
      }); // display one
  
  
      var href = this.href.substr(this.href.lastIndexOf('#')); // get hash href
  
      document.querySelector(href).style.display = 'block'; // remove active from all
  
      mock__profilePage_links.forEach(function (el) {
        el.classList.remove('active');
      }); // set active to current
  
      this.classList.add('active');
    };
    /**
     * mock links to change content
     * @param nodes
     */
  
  
    var mock__profilePage_nav = function mock__profilePage_nav(nodes) {
      _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(nodes).forEach(function (el) {
        el.classList.add('sourceJs--mock__link');
        el.addEventListener('click', mock__profilePage_changeContent);
      });
    }; // Init
  
  
    console.warn('Profile pages has mocked content - links with  symbol are mocked');
    var mock__profilePage_initialized = false;
    var mock__profilePage_links = document.querySelectorAll('.profile-menu a[href*="#"]');
    /**
     * List for mock can be set in content, or here is default
     * @type {string[]}
     */
  
    var mock__profilePage_list = undefined.mock__profilePage_list || ['#mock-addresses', '#mock-access', '#mock-personal', '#mock-fav', '#mock-saved_searches', '#mock-alerts'];
  
    if (mock__profilePage_links.length > 0 && !mock__profilePage_initialized) {
      mock__profilePage_inicialized = true;
      mock__profilePage_nav(mock__profilePage_links);
    }
  } catch (e) {
    console.error('Mock of profile menu failed with following error:', e);
  } // @fixme "mimic" is not standard for anything ... MOCK is the word what is used for this kind of things ...
  
  
  
  
  
  
  
  
   // Core
  
  
  
  
  
  if ($('#citation-format').length) {
    UX.exportCitation.init();
  }
  
  if ($('.copy__btn').length) {
    UX.copyText.init();
  }
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_book-product.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_book-product.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function ($, UX) {
    $body = $('body');
    var bookProduct = {
      init: function init() {
        bookProduct.control();
      },
      control: function control() {
        $body.on('click', ".book-product__content button", function (e) {
          bookProduct.showOverlay($(this));
        });
        $body.on('click', ".book-product__overlay a", function (e) {
          bookProduct.hideOverlay($(this));
        });
      },
      showOverlay: function showOverlay($this) {
        $this.closest(".book-product").find(".book-product__overlay").show();
      },
      hideOverlay: function hideOverlay($this) {
        $this.closest(".book-product__overlay").hide();
      }
    };
    UX.bookProduct = bookProduct; // init self on ready
  
    $(document).ready(UX.bookProduct.init);
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_collapsible-menu.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_collapsible-menu.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // todo: It has to be refactor
  // the source for this file is profile-menu.js
  (function ($, UX) {
    var $window = $(window),
        $body = $('body'),
        isMobile = false; // variable use to determine if responsive mode is on or off
  
    var collapsibleMenu = {
      cName: "",
      cNameRes: "",
      $target: null,
      $toggle: null,
      $ul: null,
      $li: null,
      vPort: "screen-md",
      // default responsive break point
      init: function init() {
        collapsibleMenu.cName = "collapsible-menu", collapsibleMenu.cNameRes = collapsibleMenu.cName + "--res", collapsibleMenu.$target = $("[data-collapsible-id]"), collapsibleMenu.$target.addClass(collapsibleMenu.cName), collapsibleMenu.id = collapsibleMenu.$target.data('collapsible-id');
        collapsibleMenu.on.dropdownDestroy(collapsibleMenu.$target);
        collapsibleMenu.on.build();
        collapsibleMenu.control();
      },
      control: function control() {
        $body.on('click', '.collapsible-menu--res a', function (e) {
          collapsibleMenu.on.select.dropdown($(this));
        });
        $(document).on(collapsibleMenu.vPort + '-on', function () {
          // Waiting for custom event that will be triggered by controller.js to activate responsive effects
          isMobile = true;
          $('.collapsible-menu').addClass(collapsibleMenu.cNameRes); // class will be used in our scss (to replace media queries)
  
          collapsibleMenu.on.build();
        });
        $(document).on(collapsibleMenu.vPort + '-off', function () {
          // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
          isMobile = false;
          $('.collapsible-menu').removeClass(collapsibleMenu.cNameRes);
          collapsibleMenu.on.build();
        });
      },
      on: {
        select: {
          dropdown: function dropdown(elem) {
            var dataAttr = elem.closest('ul').data('mobile-toggle');
  
            if (dataAttr === 'dropdown' || elem.closest('ul').hasClass('dropblock--tab')) {
              var dropdownContainer = elem.closest('.dropBlock');
              dropdownContainer.children('a').find('span').text(elem.text());
            }
          }
        },
        dropdownBuild: function dropdownBuild(elem) {
          // rebuild tabs to be as drop down
          if (UX.dropBlock) {
            UX.dropBlock.init();
          }
  
          elem.wrap('<div class="' + collapsibleMenu.cName + '--dropBlock" data-db-parent-of="dbTab-collapsible-menu"></div>');
          var $dropdownContainer = elem.closest('.' + collapsibleMenu.cName + '--dropBlock');
          var $activeTab = collapsibleMenu.get.activeTab(elem);
          activevalue = "Select";
  
          if ($activeTab.text().length > 0) {
            activevalue = $activeTab.text();
          }
  
          if ($(".issue-navigator__link").text().length > 0) {
            activevalue = $(".issue-navigator__link").text();
          }
  
          $dropdownContainer.prepend('<a href="#" data-db-target-for="dbTab-' + collapsibleMenu.cName + '"><span>' + activevalue + '</span><i class="icon-chevron-down" aria-hidden="true"></i></a>');
          elem.attr('data-db-target-of', 'dbTab-' + collapsibleMenu.cName);
        },
        dropdownDestroy: function dropdownDestroy(elem) {
          // return tabs to default
          var dropdownContainer = elem.closest('.' + collapsibleMenu.cName + '--dropBlock');
          dropdownContainer.children('a').remove();
          elem.removeAttr('data-db-target-of').removeClass('js--open').removeAttr('style').unwrap('.' + collapsibleMenu.cName + '--dropBlock');
        },
        build: function build() {
          if (isMobile) {
            collapsibleMenu.on.dropdownBuild(collapsibleMenu.$target);
          } else {
            collapsibleMenu.on.dropdownDestroy(collapsibleMenu.$target);
          }
        }
      },
      get: {
        activeTab: function activeTab(elem) {
          return elem.find('a.active');
        }
      }
    };
    UX.collapsibleMenu = collapsibleMenu;
    $(document).ready(UX.collapsibleMenu.init);
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_drawer.js":
  /*!************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_drawer.js ***!
    \************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    // Mostly this file was added to do fix som eIOs related issues
    var $body = $('body'),
        // @fixme: use document element instead of body ...
    isMobile = false;
    var menu = UX.menu = UX.menu || {};
  
    menu.init = function () {
      var menu1 = new menubar('menubar', false);
      $('.main-nav').each(function (index) {
        menu.menuHeaderMainTitle = $(this).find('.menu-header').text();
        menu.$target = $(this);
        menu.check.viewPort(index);
        menu.responsive(index);
      });
      menu.items = $('.main-nav').find('a, button, input'); //$(".header__nav a, .header__nav button, .header__nav input");
  
      menu.iosControl(); // this is the only difference between this init function and the generic one (drawer.js in ux3 )
  
      menu.control();
      menu.additionalControl();
    };
  
    menu.iosControl = function () {
      if ($('body').hasClass('iOS')) {
        $body.on('click', '.js--open[data-toggle="nav"]', function (e) {
          $(window).scrollTop(menu.offsetY); // scroll to previous scrolling point for IOs devices
        });
        $body.on('click', '[data-toggle="nav"]', function (e) {
          menu.offsetY = $body.data('yoffset') || window.pageYOffset; // get current scrolling point for IOS devices
  
          $body.data('yoffset', menu.offsetY);
        });
      }
    };
  
    menu.additionalControl = function () {
      $body.on('click', '.js--open[data-toggle="nav"]', function (e) {
        e.preventDefault();
        menu.on.hide(e);
        menu.$target.attr("style", "display: none !important");
      });
    };
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_dropBlockUl.js":
  /*!*****************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_dropBlockUl.js ***!
    \*****************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    //@fixme profile menu only code is the actual script ...
    var dropblockUl = UX.dropblockUl;
  
    dropblockUl.get.activeTab = function (elem) {
      return elem.find('.active .item-text, a.active, .active a').first();
    };
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_override-loi-ajax.js":
  /*!***********************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_override-loi-ajax.js ***!
    \***********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    UX.loi.get.url = function () {
      // override ajax url setup
      UX.loi.url = "/specs/products/themes/classic/widgets/list-of-issues/templates/ajax/response.html";
    };
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_publication-content.js":
  /*!*************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_publication-content.js ***!
    \*************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  var loader = UX.loader;
  
  loader.additionalController = function () {
    if ($('.altmetric-embed').length) {
      // LIT-263055
      $('.altmetric-embed').on('altmetric:hide', function () {
        $('.no-content').show();
      });
    }
  
    var $sections = $('#sectionMenu'),
        $window = $(window);
  
    if ($sections.length) {
      $window.on('scroll', function () {
        loader.setSectionHeight($sections, $window);
      });
    }
  };
  
  loader.setSectionHeight = function ($sections, $window) {
    //LIT-318905
    var $footer = $('.footer');
    var footerTop = $footer.offset().top;
    var marginTop = parseInt($footer.css('margin-top'));
    var scrollTop = $window.scrollTop() + $window.height();
    var headerHeight = $('.header').height();
  
    if (scrollTop >= footerTop) {
      $sections.css("max-height", "calc(100vh - ".concat(headerHeight + scrollTop - footerTop + marginTop, "px)"));
    } else {
      $sections.css("max-height", "");
    }
  };
  
  loader.truncation.linesToShow = 2;
  loader.truncation.MobileLinesToShow = 2;
  loader.truncation.showMoreText = $('article').data('more-authors-text');
  loader.truncation.showLessText = $('article').data('less-authors-text');
  loader.truncation.seeMoreIconMobile = 'icon-section_arrow_d';
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_quick-search.js":
  /*!******************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_quick-search.js ***!
    \******************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  UX.quickSearch.additionalController = function () {
    var $body = $('body');
    $body.on('keyup', '.citationSearchContainer input[name="quickLinkJournal"]', function () {
      if ($('.citationSearchContainer  input[name="quickLinkJournal"]').val() == '') {
        $('.citationSearchContainer .mainSearchButton').attr('disabled', true);
      } else {
        $('.citationSearchContainer .mainSearchButton').removeAttr('disabled');
      }
    });
  };
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_slideshow.js":
  /*!***************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_slideshow.js ***!
    \***************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var $window = $(window),
        $body = $('body');
    var slider = {
      $slider: null,
      options: {},
      vPort: "always",
      // default responsive break point
      isMobile: false,
      navText: ["<span class='hidden-xs'>prev</span><i class='icon-arrow_l visible-xs'></i>", "<span class='hidden-xs'>next</span><i class='icon-arrow_r visible-xs'></i>"],
      init: function init() {
        slider.additionalInit();
        slider.on.build();
        slider.control();
        slider.additionalControls();
      },
      control: function control() {
        $body.on('click', '.owl-play', function () {
          slider.$slider = $(this).closest('.owl-carousel');
          slider.$slider.data('owl.carousel').options.autoplay = true;
          slider.$slider.trigger('refresh.owl.carousel'); //slider.$slider.trigger('play.owl.autoplay');
        });
        $body.on('click', '.owl-pause', function () {
          slider.$slider = $(this).closest('.owl-carousel');
          slider.$slider.trigger('stop.owl.autoplay');
        });
        $body.on('touchend', '.owl-pause, .owl-play, .owl-prev, .owl-next', function () {
          $(this).css('background', '#d6d6d6');
        });
        $('body').on('touchstart', '.owl-pause, .owl-play, .owl-prev, .owl-next', function () {
          $(this).css('background', '#869791');
        });
        $('.owl-carousel').each(function () {
          var $element = $(this);
  
          if (typeof $element.closest('.viewport-slider').data("slider-vport") != 'undefined') {
            slider.vPort = $element.closest('.viewport-slider').data("slider-vport");
            $(document).on(slider.vPort + '-on', function () {
              // Waiting for custom event that will be triggered by controller.js to activate responsive effects
              slider.isMobile = true;
              slider.get.options($element, true);
            });
            $(document).on(slider.vPort + '-off', function () {
              // Waiting for custom event that will be triggered by controller.js to deactivate responsive effects
              slider.isMobile = false;
              slider.on.destroy($element);
            });
          }
        });
  
        if ($('.owl-item:not(.cloned)').first().hasClass('active')) {
          $('.owl-nav .owl-next').addClass('owl-nav-active');
        }
      },
      additionalInit: function additionalInit() {},
      additionalControls: function additionalControls() {},
  
      /**
       * Accessibility for owl carousel
       * @namespace
       * @property {boolean} _flagChangeFocus - flag to inform translate to change focus, when we cannot pass this information in event
       */
      accessibility: {
        /**
         * @name _flagChangeFocus
         * @type Boolean
         * @default false
         * @protected
         */
        _flagChangeFocus: false,
  
        /**
         * Setup slider accessibility
         * @param {jQuery} $slider - jQuery object of Owl carousel container .owl-carousel
         * @public
         */
        setup: function setup($slider) {
          // make slides accessible
          this.slider($slider);
          console.log($slider);
          var $parent = $slider.parent(".slideShow"); // apply meta info to next and previous buttons and make them focusable
  
          $slider.find('.owl-prev').attr({
            'role': 'button',
            'title': $parent.data("tooltip-next"),
            'aria-label': $parent.data("tooltip-next"),
            'tabindex': '0'
          });
          $slider.find('.owl-next').attr({
            'role': 'button',
            'title': $parent.data("tooltip-prev"),
            'aria-label': $parent.data("tooltip-prev"),
            'tabindex': '0'
          });
          $slider.find('.owl-dot').each(function () {
            var $dot = $(this);
            $dot.attr({
              'role': 'button',
              'title': $parent.data("tooltip-bullets") + ($dot.index() + 1),
              'aria-label': $parent.data("tooltip-bullets") + ($dot.index() + 1),
              'tabindex': '0'
            });
          }); // make root element focusable
  
          var $root = $slider.find('.owl-stage');
          var label = $slider.data('label') || "Slideshow";
          $root.attr({
            'role': 'listbox',
            'aria-label': label,
            // @todo aria-labeled-by if we have data for it, we don't right now
            'tabindex': '0'
          });
          $slider.find('.owl-item').attr({
            'role': 'option'
          }); // make root element id and use it for aria controls
  
          var id = $root.attr('id');
  
          if (!id) {
            id = 'slider' + UX.utils.generateId();
            $root.attr('id', id);
          } // make Controls to inform screen readers what they control
  
  
          $slider.find('.owl-nav, .owl-dots, .owl-controls').attr({
            'role': 'navigation',
            'aria-label': label,
            'aria-controls': id
          }); // listen for keyboard input
  
          this.keyboardControls($slider); // make slider accessible by tab key
  
          this.keyboardTabAccess($slider); // handle autoplay carousels
  
          this.handleAutoplay($slider); // make dots accessible
  
          this.dots($slider);
        },
  
        /**
         * Setup keyboard navigation for slider
         * @param {jQuery} $slider - jQuery object of Owl carousel container .owl-carousel
         * @protected
         */
        keyboardControls: function keyboardControls($slider) {
          $slider.on('keydown', function (e) {
            slider.$slider = $(this);
            var $focusedElement = $(document.activeElement),
                type = e.which == 39 ? 'next' : null,
                type = e.which == 37 ? 'prev' : type,
                type = e.which == 13 ? 'enter' : type; // use left and right arrow keys to navigate
  
            if (type == 'next') {
              slider.accessibility._flagChangeFocus = true; // flag to change focus after change
  
              slider.$slider.trigger('next.owl.carousel');
            } else if (type == 'prev') {
              slider.accessibility._flagChangeFocus = true; // flag to change focus after change
  
              slider.$slider.trigger('prev.owl.carousel');
            } else if (type == 'enter') {
              // if the prev and next buttons are focused, catch "Enter" and navigate in the right direction
              e.preventDefault();
  
              if ($focusedElement.hasClass('owl-next')) {
                slider.$slider.trigger('next.owl.carousel');
              } else if ($focusedElement.hasClass('owl-prev')) {
                slider.$slider.trigger('prev.owl.carousel');
              } else if ($focusedElement.hasClass('owl-dot') || $focusedElement.hasClass('owl-play') || $focusedElement.hasClass('owl-pause')) {
                $focusedElement.trigger('click');
              }
            }
          });
          $slider.on('translated.owl.carousel', function (event) {
            // change focus to first tabbable element in slide
            if (slider.accessibility._flagChangeFocus) {
              slider.accessibility._flagChangeFocus = false;
              var $slide = $(event.target).find('.owl-item').eq(event.item.index);
              $slide.find(':tabbable').first().focus();
            }
  
            slider.accessibility.slider($slider);
          });
        },
  
        /**
         * Setup tab key access for slider
         * @param {jQuery} $slider - jQuery object of Owl carousel container .owl-carousel
         * @see inspired by Peppermint.js slider [https://wd.dizaina.net/en/scripts/peppermint/]
         * @protected
         */
        keyboardTabAccess: function keyboardTabAccess($slider) {
          $slider.find('.owl-item').each(function () {
            var slide = this;
            var $slide = $(slide); //IE fallback first
  
            slide.onfocusin = function () {
              slider.accessibility.slide($slide, 'enable');
              slider.accessibility.slide($slide, 'show');
              slider.$slider = $(this).closest('.owl-carousel');
              var oneOwl = slider.$slider.data('owl.carousel'),
                  stageToReset = slider.$slider.find('.owl-stage-outer')[0],
                  indexOfFocusedSlide = oneOwl.relative($(this).index()); //Reset the scroll
  
              stageToReset.scrollLeft = 0; //WebKit sets the scroll after the event, we need to reset it with zero timeout.
              //Keep the first reset to prevent jittering in other browsers
  
              setTimeout(function () {
                stageToReset.scrollLeft = 0;
              }, 0);
  
              if (!$(this).hasClass('active')) {
                // switch to the slide containing the event if is not visible already
                // last argument is to enforce "OLD" function for moving in slideshow, necesary for multiple slides displayed in same time
                // it is not documented anywhere, it comes from built-in plugin src/js/owl.navigation.js from method Navigation.prototype.to ....
                oneOwl.to(indexOfFocusedSlide, oneOwl.settings.smartSpeed ? oneOwl.settings.smartSpeed : 500, true);
              }
            }; //Now use the function bound to `onfocusin` in a regular `addEventListener`
  
  
            if (slide.addEventListener) slide.addEventListener('focus', slide.onfocusin, true); //`true` turns on the capturing
          });
        },
  
        /**
         * Make dots navigation accessible
         * @param $slider
         */
        dots: function dots($slider) {
          $slider.find('.owl-dot').on('click', function () {
            /**
             * Solution for outlines here:
             *
             * Blur this, while we don't want to outline to be visible in this case
             * but we want to see outline when user cycle through page by tab key
             *
             * solution combined with CSS rule - to don't display outline, when mouse button is pressed
             *  .owl-dot:active:focus {
             *      outline: none;
             *  }
             *
             */
            $(this).blur();
            slider.accessibility._flagChangeFocus = true; // flag to change focus after change
          });
        },
  
        /**
         * Make controls accessible
         * @param $slider
         * @public
         */
        controls: function controls($slider) {
          var buttons = {
            play: $slider.find('.owl-play'),
            pause: $slider.find('.owl-pause')
          };
          buttons.play.attr({
            'role': 'button',
            'title': 'Play slideshow',
            'aria-label': 'Play slideshow',
            'tabindex': '0'
          }).on('click', function () {
            $slider.removeAttr('data-pause');
            slider.on.toggleControls(false, buttons.play, buttons.pause);
          });
          buttons.pause.attr({
            'role': 'button',
            'title': 'Pause slideshow',
            'aria-label': 'Pause slideshow',
            'tabindex': '0'
          }).on('click', function () {
            $slider.attr({
              'data-pause': 'true'
            });
            slider.on.toggleControls(true, buttons.play, buttons.pause);
          });
          slider.on.toggleControls(!slider.options.autoplay, buttons.play, buttons.pause);
        },
  
        /**
         * Pause on focus if auto-play is enabled
         * @see aria-live documentation
         * @param {jQuery} $slider
         */
        handleAutoplay: function handleAutoplay($slider) {
          var autoplay = $slider.data('autoplay');
  
          if (autoplay) {
            $slider.attr({
              'aria-live': 'off'
            });
            $slider.bind('focusin', function (event) {
              $(this).attr({
                'aria-live': 'polite'
              });
  
              if (event.target && ($(event.target).hasClass('owl-play') || $(event.target).hasClass('owl-pause'))) {
                // don't stop autoplay on controls
                return;
              }
  
              $(this).trigger('stop.owl.autoplay');
            }).bind('focusout', function () {
              if (!$slider.data('pause')) {
                $(this).trigger('play.owl.autoplay');
              }
  
              $(this).attr({
                'aria-live': 'off'
              });
            });
          }
        },
  
        /**
         * Set attributes for slider based on active slide
         * This is only wrapper function to avoid necessity of finding slides in function call
         * @param {jQuery} $slider - jQuery object of Owl carousel container .owl-carousel
         * @public
         */
        slider: function slider($slider) {
          this.slides($slider.find('.owl-item'));
        },
  
        /**
         * Set attributes for slides based on active slide and cloned slides
         * This is the main logic for handling accessibility visibility to be correctly read by screen readers, etc.
         * @param {jQuery} $slides - jQuery collection of slides
         * @public
         */
        slides: function slides($slides) {
          // hide all
          this.slide($slides, 'hide'); // disable cloned items to skip duplicate slides
  
          this.slide($slides.filter('.cloned'), 'disable'); // enable clone in case it becomes active
  
          this.slide($slides.filter('.cloned.active'), 'enable'); // show active
  
          this.slide($slides.filter('.active'));
        },
  
        /**
         * Handle one slide - mixed methods
         * @param {jQuery} $slide - collections of slides or one slide
         * @param {('show'|'hide'|'enable'|'disable')} [action] - available methods
         * @public
         */
        slide: function slide($slide, action) {
          var actions = {
            /**
             * let screen readers know an item is active
             * set aria visible on active slide
             * @param {jQuery} $slide - collections of slides or one slide
             * @private
             */
            show: function show($slide) {
              $slide.attr('aria-selected', 'true');
              $slide.attr('aria-hidden', 'false');
            },
  
            /**
             * set aria hidden on all slides
             * @param {jQuery} $slide - collections of slides or one slide
             * @private
             */
            hide: function hide($slide) {
              $slide.attr('aria-selected', 'false');
              $slide.attr('aria-hidden', 'true');
            },
  
            /**
             * enable tab index on in case it becomes active
             * @param {jQuery} $slide - collections of slides or one slide
             * @private
             */
            enable: function enable($slide) {
              $slide.find('[data-was-tabbable]').removeAttr('tabindex').removeAttr('data-was-tabbable');
            },
  
            /**
             * disable tab index on items to skip duplicate slides in tab order
             * @param {jQuery} $slide - collections of slides or one slide
             * @private
             */
            disable: function disable($slide) {
              $slide.find(':tabbable').attr('data-was-tabbable', true).attr('tabindex', '-1');
            }
          }; // actions logic
  
          if (typeof action === 'string') {
            if (typeof actions[action] === 'undefined') {
              throw new TypeError('No method named "' + action + '" found.');
            }
  
            actions[action]($slide);
          } else if (actions.show) {
            // default action
            actions.show($slide);
          }
        }
      },
      get: {
        options: function options($element, pass) {
          slider.$slider = $element;
          slider.speed = slider.$slider.data('speed');
          slider.autoplay = slider.$slider.data('autoplay');
          slider.animation = slider.$slider.data('animation');
          slider.autoWidth = slider.set.autoWidth();
  
          if (slider.animation === 'fade') {
            slider.animation = 'fadeOut';
          } else if (slider.animation === 'slide') {
            slider.animation = '';
          } else if (slider.animation === 'none') {
            slider.animation = 'fadeOut';
            slider.speed = 0;
          }
  
          slider.items = slider.$slider.data('items');
          slider.set.responsive();
          slider.indicators = slider.$slider.data('indicators');
          slider.arrow = slider.$slider.data('arrow');
          slider.controls = slider.$slider.data('controls');
          slider.stagePadding = slider.$slider.data('stagepadding');
          slider.autoHeight = slider.set.autoHeight();
          slider.dotsEach = slider.$slider.data('dotseach') != undefined ? slider.$slider.data('dotseach') : false;
          UX.slider.loop = UX.slider.$slider.data('loop');
          UX.slider.slideBy = UX.slider.$slider.data('slideby');
          slider.options = {
            stagePadding: slider.stagePadding,
            loop: UX.slider.loop,
            items: slider.items,
            responsive: slider.responsive,
            autoplay: slider.autoplay,
            autoWidth: slider.autoWidth,
            animateOut: slider.animation,
            dots: slider.indicators,
            nav: slider.arrow,
            dotsEach: slider.dotsEach,
            slideBy: UX.slider.slideBy,
            autoHeight: slider.autoHeight,
            autoplayTimeout: slider.speed,
            autoplayHoverPause: slider.autoplay,
            navText: slider.navText,
            onInitialized: function onInitialized(event) {
              // allow slider accessibility
              slider.accessibility.setup(slider.$slider);
              slider.$slider.find('.owl-item.active').first().addClass("first");
  
              if (slider.$slider.closest('.equal-height-slides').length) {
                //make all slide same height if slide container contains ".equal-height-slides" class
                var sliderHeight = slider.$slider.height();
  
                if (sliderHeight > 0) {
                  slider.$slider.find('.owl-item', '.slide-item').css('height', slider.$slider.height());
                  slider.$slider.find('.slide-item').css('height', '100%');
                }
              }
            }
          };
          slider.on.activate(slider.$slider, pass);
  
          if (slider.controls) {
            slider.on.buildControls(slider.$slider);
          }
        },
        responsiveData: function responsiveData() {
          if (slider.$slider.data('responsive')) {
            return slider.$slider.data('responsive');
          } else {
            var responsiveData = slider.$slider.closest('.responsive-slider').data("responsive");
  
            if (responsiveData) {
              return responsiveData;
            }
          }
  
          return null;
        }
      },
      set: {
        responsive: function responsive() {
          slider.responsive = slider.get.responsiveData();
  
          if (slider.responsive) {
            for (var key in slider.responsive) {
              switch (key) {
                case "xsMin":
                  slider.responsive[0] = slider.responsive[key];
                  break;
  
                case "smMin":
                  slider.responsive[UX.grid.screenXsMax] = slider.responsive[key];
                  break;
  
                case "mdMin":
                  slider.responsive[UX.grid.screenSmMax] = slider.responsive[key];
                  break;
  
                case "lgMin":
                  slider.responsive[UX.grid.screenMdMax] = slider.responsive[key];
                  break;
              }
            }
          }
        },
        autoHeight: function autoHeight() {
          var autoHeight = slider.$slider.closest('.autoheight-slider').data('autoheight');
  
          if (autoHeight != undefined) {
            return autoHeight;
          } else {
            return true;
          }
        },
        autoWidth: function autoWidth() {
          return false;
        }
      },
      on: {
        destroy: function destroy($element) {
          if (slider.vPort.length > 0) {
            $element.each(function () {
              if (!$(this).hasClass('slide-removal')) {
                $(this).addClass('slide-removal').trigger('destroy.owl.carousel');
                $(this).find('.owl-stage-outer').children(':eq(0)').unwrap();
              }
            });
          }
        },
        activate: function activate($element, pass) {
          if (pass || slider.vPort == "always") {
            $element.owlCarousel(slider.options);
  
            if ($element.hasClass('slide-removal')) {
              $element.removeClass('slide-removal');
            }
          } else {
            if (!$element.hasClass('slide-removal')) {
              $element.addClass('slide-removal');
            }
          }
        },
        build: function build() {
          $('.owl-carousel').each(function (index) {
            if (typeof $(this).closest('.viewport-slider').data("slider-vport") != 'undefined') {
              slider.vPort = $(this).closest('.viewport-slider').data("slider-vport");
            } else {
              slider.vPort = "always";
            }
  
            slider.get.options($(this), false);
            $(this).on('changed.owl.carousel', function (e) {
              slider.on.changedSlide($(this), e);
            });
            $(this).on('translated.owl.carousel', function (e) {
              slider.on.translated($(this));
            });
          });
        },
        translated: function translated($slider) {
          $slider.find('.owl-item').removeClass('first');
          $slider.find('.owl-item.active').first().addClass('first');
        },
        changedSlide: function changedSlide($slider, e) {
          if ($slider.find('.owl-item:not(.cloned)').last().hasClass('active')) {
            $slider.find('.owl-nav .owl-next').addClass('owl-nav-active');
            $slider.find('.owl-nav .owl-prev').removeClass('owl-nav-active');
          } else if ($('.owl-item:not(.cloned)').first().hasClass('active')) {
            $slider.find('.owl-nav .owl-prev').addClass('owl-nav-active');
            $slider.find('.owl-nav .owl-next').removeClass('owl-nav-active');
          }
        },
        rebuild: {
          responsive: function responsive() {}
        },
        buildControls: function buildControls(elem) {
          var $owlContainer = elem.find('.owl-stage-outer');
  
          if (!elem.find('.owl-controls').length) {
            $owlContainer.after('<div class="owl-controls"><div class="owl-play btn" ><i class="icon-play"></i></div><div class="owl-pause btn" ><i class="icon-pause"></i></div></div>');
          }
  
          slider.accessibility.controls(elem);
        },
        toggleControls: function toggleControls() {
          var showPlay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
          var $play = arguments.length > 1 ? arguments[1] : undefined;
          var $pause = arguments.length > 2 ? arguments[2] : undefined;
  
          if (showPlay) {
            $play.show();
            $pause.hide();
          } else {
            $play.hide();
            $pause.show();
          }
        }
      }
    };
    UX.slider = slider; // add to global namespace
  
    /* if (window.PB && window.PB.$) {
     // make this module reinitializes in pageBuilder mode
     window.PB.$(document.documentElement).on("WidgetReinit.slider", slider.init);
     }*/
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/js/widgets/_table-of-content.js":
  /*!**********************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/js/widgets/_table-of-content.js ***!
    \**********************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var tocJs = UX.tocJs;
    var tocTranslation = document.querySelector('.toc-js__translation');
    var seeMoreText = tocTranslation && tocTranslation.dataset.seeMoreText || 'See all authors';
    var seeLessText = tocTranslation && tocTranslation.dataset.seeLessText || 'See fewer authors';
  
    tocJs.init = function () {
      var $toSection = $('.to-section');
  
      if ($toSection.length) {
        $toSection.each(function () {
          var $this = $(this),
              section = $this.text(),
              id = $(this).attr('id');
          $('<li role="menuitem"><a class="w-slide__hide" href="#' + id + '"><span>' + section + '</span></a></li>').appendTo('.sections__drop');
        });
      } else {
        $('.toc-go-section, .toc__section').remove();
      }
  
      tocJs.$loa = $('.issue-item .loa, .search__item .meta__authors, .search__item .loa, .search-item .meta__authors, .search-item .loa');
      tocJs.control();
    };
  
    tocJs.truncate = function () {
      try {
        tocJs.$loa.not("[data-truncate='none']").truncate({
          lines: 2,
          type: 'list',
          seeMoreLink: true,
          seeMoreText: seeMoreText,
          seeLessText: seeLessText
        });
      } catch (err) {
        console.error(err);
      }
    };
  
    UX.tocJs = tocJs;
  })();
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/arrayLikeToArray.js":
  /*!**********************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/arrayLikeToArray.js ***!
    \**********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
  
    for (var i = 0, arr2 = new Array(len); i < len; i++) {
      arr2[i] = arr[i];
    }
  
    return arr2;
  }
  
  module.exports = _arrayLikeToArray;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/arrayLikeToArray.js");
  
  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return arrayLikeToArray(arr);
  }
  
  module.exports = _arrayWithoutHoles;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/iterableToArray.js":
  /*!*********************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/iterableToArray.js ***!
    \*********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);
  }
  
  module.exports = _iterableToArray;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/nonIterableSpread.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/nonIterableSpread.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  
  module.exports = _nonIterableSpread;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/toConsumableArray.js":
  /*!***********************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/toConsumableArray.js ***!
    \***********************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayWithoutHoles = __webpack_require__(/*! ./arrayWithoutHoles */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js");
  
  var iterableToArray = __webpack_require__(/*! ./iterableToArray */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/iterableToArray.js");
  
  var unsupportedIterableToArray = __webpack_require__(/*! ./unsupportedIterableToArray */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js");
  
  var nonIterableSpread = __webpack_require__(/*! ./nonIterableSpread */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/nonIterableSpread.js");
  
  function _toConsumableArray(arr) {
    return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();
  }
  
  module.exports = _toConsumableArray;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/typeof.js":
  /*!************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/typeof.js ***!
    \************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _typeof(obj) {
    "@babel/helpers - typeof";
  
    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      module.exports = _typeof = function _typeof(obj) {
        return typeof obj;
      };
    } else {
      module.exports = _typeof = function _typeof(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
      };
    }
  
    return _typeof(obj);
  }
  
  module.exports = _typeof;
  
  /***/ }),
  
  /***/ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js":
  /*!********************************************************************************************************!*\
    !*** /home/irahhal/ui-theme-classic/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js ***!
    \********************************************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ "../../ui-theme-classic/node_modules/@babel/runtime/helpers/arrayLikeToArray.js");
  
  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);
  }
  
  module.exports = _unsupportedIterableToArray;
  
  /***/ }),
  
  /***/ "./js/all.js":
  /*!*******************!*\
    !*** ./js/all.js ***!
    \*******************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _node_modules_ui_theme_js_all__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/ui-theme/js/all */ "../../ui-theme-classic/js/all.js");
  /* harmony import */ var _node_modules_ui_theme_js_components_accordion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/ui-theme/js/components/_accordion */ "../../ui-theme-classic/js/components/_accordion.js");
  /* harmony import */ var _node_modules_ui_theme_js_components_accordion__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_theme_js_components_accordion__WEBPACK_IMPORTED_MODULE_1__);
  /* harmony import */ var _node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../node_modules/ui-core/components/article-actions-bar/js/article-action-bar */ "../../ui-core/components/article-actions-bar/js/article-action-bar.js");
  /* harmony import */ var _node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_ui_core_components_article_actions_bar_js_article_action_bar__WEBPACK_IMPORTED_MODULE_2__);
  /* harmony import */ var _components_facet_date__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/facet-date */ "./js/components/facet-date.js");
  /* harmony import */ var _components_facet_date__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_components_facet_date__WEBPACK_IMPORTED_MODULE_3__);
  /* harmony import */ var _widgets_publication_content__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./widgets/publication-content */ "./js/widgets/publication-content.js");
  /* harmony import */ var _widgets_publication_content__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_widgets_publication_content__WEBPACK_IMPORTED_MODULE_4__);
  /* harmony import */ var _widgets_form_actions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./widgets/form-actions */ "./js/widgets/form-actions.js");
  /* harmony import */ var _widgets_form_actions__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_widgets_form_actions__WEBPACK_IMPORTED_MODULE_5__);
  /* harmony import */ var _widgets_alerts__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./widgets/alerts */ "./js/widgets/alerts.js");
  /* harmony import */ var _widgets_alerts__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_widgets_alerts__WEBPACK_IMPORTED_MODULE_6__);
  /* harmony import */ var _templates_publisher__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./templates/publisher */ "./js/templates/publisher.js");
  /* harmony import */ var _templates_publisher__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_templates_publisher__WEBPACK_IMPORTED_MODULE_7__);
  // MainJS sbn product
  // Classic
  
  
   // SBN
  //Components
  
   //Widgets
  
  
  
   //Templates
  
  
  
  if ($('.publisher_brief').length) {
    UX.publisher.init();
  }
  
  $("header").css("background", "red");
  
  /***/ }),
  
  /***/ "./js/components/facet-date.js":
  /*!*************************************!*\
    !*** ./js/components/facet-date.js ***!
    \*************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    UX.facetDate.on.setRange = function (sliderRange, elem) {
      var $toggle = elem.closest('.range-slider');
      var $target = $toggle.find('.jcf-active-handle');
      var tmp = $target.attr("class").match(/jcf-index[\w-]*\b/);
      var tmp2 = tmp.toString().split('-')[2];
      var thisValIndex = parseInt(sliderRange.values[tmp2 - 1], 10);
      var thisVal = UX.facetDate.sliderValues[thisValIndex];
      $('input.index-' + tmp2).val(thisVal);
    };
  
    UX.facetDate.control = function () {
      $body.on('click', '.custom-date', function (e) {
        e.preventDefault();
        UX.facetDate.on.toggle($(this));
      });
      $(document).on("UX-attach", function () {
        UX.facetDate.init();
      });
      $(document).on("UX-detach", function () {
        jcf.destroy($(".range-slider__range"));
      });
      $('.range-slider__range').on('input', function () {
        var sliderRange = jcf.getInstance($(this));
        UX.facetDate.on.setRange(sliderRange, $(this));
      });
      UX.facetDate.$rangeStart.on('change', function () {
        UX.facetDate.on.setStart($(this));
      });
      UX.facetDate.$rangeEnd.on('change', function () {
        UX.facetDate.on.setEnd($(this));
      });
      $('.range-slider__range').on('change change:startend', function () {
        UX.facetDate.updateUrl($(this));
      });
    };
  })();
  
  /***/ }),
  
  /***/ "./js/sourceJs.js":
  /*!************************!*\
    !*** ./js/sourceJs.js ***!
    \************************/
  /*! no exports provided */
  /***/ (function(module, __webpack_exports__, __webpack_require__) {
  
  "use strict";
  __webpack_require__.r(__webpack_exports__);
  /* harmony import */ var _node_modules_ui_theme_js_sourceJs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/ui-theme/js/sourceJs */ "../../ui-theme-classic/js/sourceJs.js");
  
  
  /***/ }),
  
  /***/ "./js/templates/publisher.js":
  /*!***********************************!*\
    !*** ./js/templates/publisher.js ***!
    \***********************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var publisher = {
      $publisher_brief: null,
      init: function init() {
        $publisher_brief = $('.publisher-content-item .publisher_brief');
        publisher.truncate();
      },
      truncate: function truncate() {
        try {
          $publisher_brief.truncate({
            lines: 7,
            type: 'text',
            seeMoreLink: true,
            seeMoreText: 'Read More',
            seeLessText: 'Less'
          });
        } catch (err) {}
      }
    };
    UX.publisher = publisher;
  })();
  
  /***/ }),
  
  /***/ "./js/widgets/alerts.js":
  /*!******************************!*\
    !*** ./js/widgets/alerts.js ***!
    \******************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var alerts = UX.alerts;
  
    alerts.control = function () {
      $body.on('click', '[name="markall"]', function (e) {
        alerts.$target = $(this).closest('.alerts--list-wrapper').find('.alert__list');
  
        if ($(this).closest('#citationAlerts').length) {
          alerts.$target = $('#citationAlerts');
        }
  
        if ($(this).prop('checked')) {
          alerts.$target.find('li:not(.hidden)').find('[type="checkbox"]').click();
        } else {
          alerts.$target.find('[type="checkbox"]:checked').click();
        }
      });
      $('#frmAlerts .search-for-alerts').keydown(function (e) {
        if (e.keyCode == 13) {
          e.preventDefault();
          return;
        }
      });
      $body.on('change', '.alert__freq', function (e) {
        alerts.on.frequency_change($(this));
      });
      $body.on('change', '.alert__sort', function (e) {
        alerts.on.sorting_change($(this));
      });
      $body.on('click', '.js__citActions', function (e) {
        alerts.on.cit_actions_change($(this));
      });
      $body.on('click', '.btn--cancel', function (e) {
        e.preventDefault();
        alerts.on.reset_form($(this));
      });
    };
  
    alerts.additionalController = function () {
      $('.search-for-alerts').keyup(function () {
        // Declare variables
        var input, filter, alertsList, alertsItems, filteredLinks, i, j, txtValue;
        input = document.querySelector('.search-for-alerts');
        filter = input.value.toUpperCase();
        alertsList = document.querySelectorAll(".alert__list");
  
        for (i = 0; i < alertsList.length; i++) {
          // Loop through all alert lists
          alertsItems = alertsList[i].getElementsByTagName('li'); // Loop through all list items, and hide those who don't match the search query
  
          for (j = 0; j < alertsItems.length; j++) {
            filteredLinks = alertsItems[j].getElementsByTagName("a")[0];
            txtValue = filteredLinks.textContent || filteredLinks.innerText;
  
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
              alertsItems[j].classList.remove("hidden");
            } else {
              alertsItems[j].classList.add("hidden");
            }
          }
        }
      });
    };
  })();
  
  /***/ }),
  
  /***/ "./js/widgets/form-actions.js":
  /*!************************************!*\
    !*** ./js/widgets/form-actions.js ***!
    \************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    var formAction = {
      selectAllBox: null,
      checkboxes: null,
      bulkAction: null,
      searchForm: null,
      init: function init() {
        formAction.searchForm = $('#frmSearch, #frmIssueItems');
        formAction.selectAllBox = $('.form__actions input');
        formAction.checkboxes = $('.search-result__body  input[type="checkbox"], .table-of-content input[type="checkbox"]');
        formAction.bulkAction = $('.form__actions select[name="bulkActions"]');
        formAction.validateBulkActions();
        formAction.control();
      },
      control: function control() {
        formAction.selectAllBox.click(function () {
          formAction.checkboxes.prop('checked', this.checked);
          formAction.validateBulkActions();
        });
        formAction.checkboxes.on('click', function () {
          formAction.selectAllBox.prop('checked', false);
          formAction.validateBulkActions();
        });
        formAction.bulkAction.on('change', function () {
          if (!formAction.searchForm.length || !formAction.hasSelectedItems()) {
            return;
          }
  
          formAction.searchForm.submit();
        });
        formAction.searchForm.on('submit', function (e) {
          this.action = formAction.bulkAction.val();
        });
      },
      hasSelectedItems: function hasSelectedItems() {
        return formAction.checkboxes.filter(function () {
          return this.checked;
        }).length;
      },
      validateBulkActions: function validateBulkActions() {
        formAction.bulkAction.prop('disabled', !formAction.hasSelectedItems());
        var isSafari = /^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent);
        if (isSafari) formAction.searchForm.removeAttr("target");
      }
    };
    UX.formAction = formAction;
    $(UX.formAction.init);
  })(jQuery, UX);
  
  /***/ }),
  
  /***/ "./js/widgets/publication-content.js":
  /*!*******************************************!*\
    !*** ./js/widgets/publication-content.js ***!
    \*******************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  (function () {
    if ($('.purchase-options-container .addOffer__btn').length) {
      $('.purchase-options-container .radio .label').on('click', function () {
        $('.purchase-options-container .addOffer__btn').removeAttr('disabled');
      });
    }
  })();
  
  /***/ }),
  
  /***/ "./node_modules/@babel/runtime/helpers/typeof.js":
  /*!*******************************************************!*\
    !*** ./node_modules/@babel/runtime/helpers/typeof.js ***!
    \*******************************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  function _typeof(obj) {
    "@babel/helpers - typeof";
  
    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      module.exports = _typeof = function _typeof(obj) {
        return typeof obj;
      };
    } else {
      module.exports = _typeof = function _typeof(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
      };
    }
  
    return _typeof(obj);
  }
  
  module.exports = _typeof;
  
  /***/ }),
  
  /***/ "./node_modules/expose-loader/index.js?$!./node_modules/jquery/dist/jquery.js-exposed":
  /*!***********************************************************************************!*\
    !*** ./node_modules/expose-loader?$!./node_modules/jquery/dist/jquery.js-exposed ***!
    \***********************************************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global) {module.exports = global["$"] = __webpack_require__(/*! -!./jquery.js */ "./node_modules/jquery/dist/jquery.js");
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "./node_modules/jquery/dist/jquery.js":
  /*!********************************************!*\
    !*** ./node_modules/jquery/dist/jquery.js ***!
    \********************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!
   * jQuery JavaScript Library v3.5.1
   * https://jquery.com/
   *
   * Includes Sizzle.js
   * https://sizzlejs.com/
   *
   * Copyright JS Foundation and other contributors
   * Released under the MIT license
   * https://jquery.org/license
   *
   * Date: 2020-05-04T22:49Z
   */
  ( function( global, factory ) {
  
    "use strict";
  
    if (  true && typeof module.exports === "object" ) {
  
      // For CommonJS and CommonJS-like environments where a proper `window`
      // is present, execute the factory and get jQuery.
      // For environments that do not have a `window` with a `document`
      // (such as Node.js), expose a factory as module.exports.
      // This accentuates the need for the creation of a real `window`.
      // e.g. var jQuery = require("jquery")(window);
      // See ticket #14549 for more info.
      module.exports = global.document ?
        factory( global, true ) :
        function( w ) {
          if ( !w.document ) {
            throw new Error( "jQuery requires a window with a document" );
          }
          return factory( w );
        };
    } else {
      factory( global );
    }
  
  // Pass this if window is not defined yet
  } )( typeof window !== "undefined" ? window : this, function( window, noGlobal ) {
  
  // Edge <= 12 - 13+, Firefox <=18 - 45+, IE 10 - 11, Safari 5.1 - 9+, iOS 6 - 9.1
  // throw exceptions when non-strict code (e.g., ASP.NET 4.5) accesses strict mode
  // arguments.callee.caller (trac-13335). But as of jQuery 3.0 (2016), strict mode should be common
  // enough that all such attempts are guarded in a try block.
  "use strict";
  
  var arr = [];
  
  var getProto = Object.getPrototypeOf;
  
  var slice = arr.slice;
  
  var flat = arr.flat ? function( array ) {
    return arr.flat.call( array );
  } : function( array ) {
    return arr.concat.apply( [], array );
  };
  
  
  var push = arr.push;
  
  var indexOf = arr.indexOf;
  
  var class2type = {};
  
  var toString = class2type.toString;
  
  var hasOwn = class2type.hasOwnProperty;
  
  var fnToString = hasOwn.toString;
  
  var ObjectFunctionString = fnToString.call( Object );
  
  var support = {};
  
  var isFunction = function isFunction( obj ) {
  
        // Support: Chrome <=57, Firefox <=52
        // In some browsers, typeof returns "function" for HTML <object> elements
        // (i.e., `typeof document.createElement( "object" ) === "function"`).
        // We don't want to classify *any* DOM node as a function.
        return typeof obj === "function" && typeof obj.nodeType !== "number";
    };
  
  
  var isWindow = function isWindow( obj ) {
      return obj != null && obj === obj.window;
    };
  
  
  var document = window.document;
  
  
  
    var preservedScriptAttributes = {
      type: true,
      src: true,
      nonce: true,
      noModule: true
    };
  
    function DOMEval( code, node, doc ) {
      doc = doc || document;
  
      var i, val,
        script = doc.createElement( "script" );
  
      script.text = code;
      if ( node ) {
        for ( i in preservedScriptAttributes ) {
  
          // Support: Firefox 64+, Edge 18+
          // Some browsers don't support the "nonce" property on scripts.
          // On the other hand, just using `getAttribute` is not enough as
          // the `nonce` attribute is reset to an empty string whenever it
          // becomes browsing-context connected.
          // See https://github.com/whatwg/html/issues/2369
          // See https://html.spec.whatwg.org/#nonce-attributes
          // The `node.getAttribute` check was added for the sake of
          // `jQuery.globalEval` so that it can fake a nonce-containing node
          // via an object.
          val = node[ i ] || node.getAttribute && node.getAttribute( i );
          if ( val ) {
            script.setAttribute( i, val );
          }
        }
      }
      doc.head.appendChild( script ).parentNode.removeChild( script );
    }
  
  
  function toType( obj ) {
    if ( obj == null ) {
      return obj + "";
    }
  
    // Support: Android <=2.3 only (functionish RegExp)
    return typeof obj === "object" || typeof obj === "function" ?
      class2type[ toString.call( obj ) ] || "object" :
      typeof obj;
  }
  /* global Symbol */
  // Defining this global in .eslintrc.json would create a danger of using the global
  // unguarded in another place, it seems safer to define global only for this module
  
  
  
  var
    version = "3.5.1",
  
    // Define a local copy of jQuery
    jQuery = function( selector, context ) {
  
      // The jQuery object is actually just the init constructor 'enhanced'
      // Need init if jQuery is called (just allow error to be thrown if not included)
      return new jQuery.fn.init( selector, context );
    };
  
  jQuery.fn = jQuery.prototype = {
  
    // The current version of jQuery being used
    jquery: version,
  
    constructor: jQuery,
  
    // The default length of a jQuery object is 0
    length: 0,
  
    toArray: function() {
      return slice.call( this );
    },
  
    // Get the Nth element in the matched element set OR
    // Get the whole matched element set as a clean array
    get: function( num ) {
  
      // Return all the elements in a clean array
      if ( num == null ) {
        return slice.call( this );
      }
  
      // Return just the one element from the set
      return num < 0 ? this[ num + this.length ] : this[ num ];
    },
  
    // Take an array of elements and push it onto the stack
    // (returning the new matched element set)
    pushStack: function( elems ) {
  
      // Build a new jQuery matched element set
      var ret = jQuery.merge( this.constructor(), elems );
  
      // Add the old object onto the stack (as a reference)
      ret.prevObject = this;
  
      // Return the newly-formed element set
      return ret;
    },
  
    // Execute a callback for every element in the matched set.
    each: function( callback ) {
      return jQuery.each( this, callback );
    },
  
    map: function( callback ) {
      return this.pushStack( jQuery.map( this, function( elem, i ) {
        return callback.call( elem, i, elem );
      } ) );
    },
  
    slice: function() {
      return this.pushStack( slice.apply( this, arguments ) );
    },
  
    first: function() {
      return this.eq( 0 );
    },
  
    last: function() {
      return this.eq( -1 );
    },
  
    even: function() {
      return this.pushStack( jQuery.grep( this, function( _elem, i ) {
        return ( i + 1 ) % 2;
      } ) );
    },
  
    odd: function() {
      return this.pushStack( jQuery.grep( this, function( _elem, i ) {
        return i % 2;
      } ) );
    },
  
    eq: function( i ) {
      var len = this.length,
        j = +i + ( i < 0 ? len : 0 );
      return this.pushStack( j >= 0 && j < len ? [ this[ j ] ] : [] );
    },
  
    end: function() {
      return this.prevObject || this.constructor();
    },
  
    // For internal use only.
    // Behaves like an Array's method, not like a jQuery method.
    push: push,
    sort: arr.sort,
    splice: arr.splice
  };
  
  jQuery.extend = jQuery.fn.extend = function() {
    var options, name, src, copy, copyIsArray, clone,
      target = arguments[ 0 ] || {},
      i = 1,
      length = arguments.length,
      deep = false;
  
    // Handle a deep copy situation
    if ( typeof target === "boolean" ) {
      deep = target;
  
      // Skip the boolean and the target
      target = arguments[ i ] || {};
      i++;
    }
  
    // Handle case when target is a string or something (possible in deep copy)
    if ( typeof target !== "object" && !isFunction( target ) ) {
      target = {};
    }
  
    // Extend jQuery itself if only one argument is passed
    if ( i === length ) {
      target = this;
      i--;
    }
  
    for ( ; i < length; i++ ) {
  
      // Only deal with non-null/undefined values
      if ( ( options = arguments[ i ] ) != null ) {
  
        // Extend the base object
        for ( name in options ) {
          copy = options[ name ];
  
          // Prevent Object.prototype pollution
          // Prevent never-ending loop
          if ( name === "__proto__" || target === copy ) {
            continue;
          }
  
          // Recurse if we're merging plain objects or arrays
          if ( deep && copy && ( jQuery.isPlainObject( copy ) ||
            ( copyIsArray = Array.isArray( copy ) ) ) ) {
            src = target[ name ];
  
            // Ensure proper type for the source value
            if ( copyIsArray && !Array.isArray( src ) ) {
              clone = [];
            } else if ( !copyIsArray && !jQuery.isPlainObject( src ) ) {
              clone = {};
            } else {
              clone = src;
            }
            copyIsArray = false;
  
            // Never move original objects, clone them
            target[ name ] = jQuery.extend( deep, clone, copy );
  
          // Don't bring in undefined values
          } else if ( copy !== undefined ) {
            target[ name ] = copy;
          }
        }
      }
    }
  
    // Return the modified object
    return target;
  };
  
  jQuery.extend( {
  
    // Unique for each copy of jQuery on the page
    expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),
  
    // Assume jQuery is ready without the ready module
    isReady: true,
  
    error: function( msg ) {
      throw new Error( msg );
    },
  
    noop: function() {},
  
    isPlainObject: function( obj ) {
      var proto, Ctor;
  
      // Detect obvious negatives
      // Use toString instead of jQuery.type to catch host objects
      if ( !obj || toString.call( obj ) !== "[object Object]" ) {
        return false;
      }
  
      proto = getProto( obj );
  
      // Objects with no prototype (e.g., `Object.create( null )`) are plain
      if ( !proto ) {
        return true;
      }
  
      // Objects with prototype are plain iff they were constructed by a global Object function
      Ctor = hasOwn.call( proto, "constructor" ) && proto.constructor;
      return typeof Ctor === "function" && fnToString.call( Ctor ) === ObjectFunctionString;
    },
  
    isEmptyObject: function( obj ) {
      var name;
  
      for ( name in obj ) {
        return false;
      }
      return true;
    },
  
    // Evaluates a script in a provided context; falls back to the global one
    // if not specified.
    globalEval: function( code, options, doc ) {
      DOMEval( code, { nonce: options && options.nonce }, doc );
    },
  
    each: function( obj, callback ) {
      var length, i = 0;
  
      if ( isArrayLike( obj ) ) {
        length = obj.length;
        for ( ; i < length; i++ ) {
          if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {
            break;
          }
        }
      } else {
        for ( i in obj ) {
          if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {
            break;
          }
        }
      }
  
      return obj;
    },
  
    // results is for internal usage only
    makeArray: function( arr, results ) {
      var ret = results || [];
  
      if ( arr != null ) {
        if ( isArrayLike( Object( arr ) ) ) {
          jQuery.merge( ret,
            typeof arr === "string" ?
            [ arr ] : arr
          );
        } else {
          push.call( ret, arr );
        }
      }
  
      return ret;
    },
  
    inArray: function( elem, arr, i ) {
      return arr == null ? -1 : indexOf.call( arr, elem, i );
    },
  
    // Support: Android <=4.0 only, PhantomJS 1 only
    // push.apply(_, arraylike) throws on ancient WebKit
    merge: function( first, second ) {
      var len = +second.length,
        j = 0,
        i = first.length;
  
      for ( ; j < len; j++ ) {
        first[ i++ ] = second[ j ];
      }
  
      first.length = i;
  
      return first;
    },
  
    grep: function( elems, callback, invert ) {
      var callbackInverse,
        matches = [],
        i = 0,
        length = elems.length,
        callbackExpect = !invert;
  
      // Go through the array, only saving the items
      // that pass the validator function
      for ( ; i < length; i++ ) {
        callbackInverse = !callback( elems[ i ], i );
        if ( callbackInverse !== callbackExpect ) {
          matches.push( elems[ i ] );
        }
      }
  
      return matches;
    },
  
    // arg is for internal usage only
    map: function( elems, callback, arg ) {
      var length, value,
        i = 0,
        ret = [];
  
      // Go through the array, translating each of the items to their new values
      if ( isArrayLike( elems ) ) {
        length = elems.length;
        for ( ; i < length; i++ ) {
          value = callback( elems[ i ], i, arg );
  
          if ( value != null ) {
            ret.push( value );
          }
        }
  
      // Go through every key on the object,
      } else {
        for ( i in elems ) {
          value = callback( elems[ i ], i, arg );
  
          if ( value != null ) {
            ret.push( value );
          }
        }
      }
  
      // Flatten any nested arrays
      return flat( ret );
    },
  
    // A global GUID counter for objects
    guid: 1,
  
    // jQuery.support is not used in Core but other projects attach their
    // properties to it so it needs to exist.
    support: support
  } );
  
  if ( typeof Symbol === "function" ) {
    jQuery.fn[ Symbol.iterator ] = arr[ Symbol.iterator ];
  }
  
  // Populate the class2type map
  jQuery.each( "Boolean Number String Function Array Date RegExp Object Error Symbol".split( " " ),
  function( _i, name ) {
    class2type[ "[object " + name + "]" ] = name.toLowerCase();
  } );
  
  function isArrayLike( obj ) {
  
    // Support: real iOS 8.2 only (not reproducible in simulator)
    // `in` check used to prevent JIT error (gh-2145)
    // hasOwn isn't used here due to false negatives
    // regarding Nodelist length in IE
    var length = !!obj && "length" in obj && obj.length,
      type = toType( obj );
  
    if ( isFunction( obj ) || isWindow( obj ) ) {
      return false;
    }
  
    return type === "array" || length === 0 ||
      typeof length === "number" && length > 0 && ( length - 1 ) in obj;
  }
  var Sizzle =
  /*!
   * Sizzle CSS Selector Engine v2.3.5
   * https://sizzlejs.com/
   *
   * Copyright JS Foundation and other contributors
   * Released under the MIT license
   * https://js.foundation/
   *
   * Date: 2020-03-14
   */
  ( function( window ) {
  var i,
    support,
    Expr,
    getText,
    isXML,
    tokenize,
    compile,
    select,
    outermostContext,
    sortInput,
    hasDuplicate,
  
    // Local document vars
    setDocument,
    document,
    docElem,
    documentIsHTML,
    rbuggyQSA,
    rbuggyMatches,
    matches,
    contains,
  
    // Instance-specific data
    expando = "sizzle" + 1 * new Date(),
    preferredDoc = window.document,
    dirruns = 0,
    done = 0,
    classCache = createCache(),
    tokenCache = createCache(),
    compilerCache = createCache(),
    nonnativeSelectorCache = createCache(),
    sortOrder = function( a, b ) {
      if ( a === b ) {
        hasDuplicate = true;
      }
      return 0;
    },
  
    // Instance methods
    hasOwn = ( {} ).hasOwnProperty,
    arr = [],
    pop = arr.pop,
    pushNative = arr.push,
    push = arr.push,
    slice = arr.slice,
  
    // Use a stripped-down indexOf as it's faster than native
    // https://jsperf.com/thor-indexof-vs-for/5
    indexOf = function( list, elem ) {
      var i = 0,
        len = list.length;
      for ( ; i < len; i++ ) {
        if ( list[ i ] === elem ) {
          return i;
        }
      }
      return -1;
    },
  
    booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|" +
      "ismap|loop|multiple|open|readonly|required|scoped",
  
    // Regular expressions
  
    // http://www.w3.org/TR/css3-selectors/#whitespace
    whitespace = "[\\x20\\t\\r\\n\\f]",
  
    // https://www.w3.org/TR/css-syntax-3/#ident-token-diagram
    identifier = "(?:\\\\[\\da-fA-F]{1,6}" + whitespace +
      "?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",
  
    // Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
    attributes = "\\[" + whitespace + "*(" + identifier + ")(?:" + whitespace +
  
      // Operator (capture 2)
      "*([*^$|!~]?=)" + whitespace +
  
      // "Attribute values must be CSS identifiers [capture 5]
      // or strings [capture 3 or capture 4]"
      "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" +
      whitespace + "*\\]",
  
    pseudos = ":(" + identifier + ")(?:\\((" +
  
      // To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
      // 1. quoted (capture 3; capture 4 or capture 5)
      "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
  
      // 2. simple (capture 6)
      "((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
  
      // 3. anything else (capture 2)
      ".*" +
      ")\\)|)",
  
    // Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
    rwhitespace = new RegExp( whitespace + "+", "g" ),
    rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" +
      whitespace + "+$", "g" ),
  
    rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
    rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace +
      "*" ),
    rdescend = new RegExp( whitespace + "|>" ),
  
    rpseudo = new RegExp( pseudos ),
    ridentifier = new RegExp( "^" + identifier + "$" ),
  
    matchExpr = {
      "ID": new RegExp( "^#(" + identifier + ")" ),
      "CLASS": new RegExp( "^\\.(" + identifier + ")" ),
      "TAG": new RegExp( "^(" + identifier + "|[*])" ),
      "ATTR": new RegExp( "^" + attributes ),
      "PSEUDO": new RegExp( "^" + pseudos ),
      "CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" +
        whitespace + "*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" +
        whitespace + "*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
      "bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
  
      // For use in libraries implementing .is()
      // We use this for POS matching in `select`
      "needsContext": new RegExp( "^" + whitespace +
        "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + whitespace +
        "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
    },
  
    rhtml = /HTML$/i,
    rinputs = /^(?:input|select|textarea|button)$/i,
    rheader = /^h\d$/i,
  
    rnative = /^[^{]+\{\s*\[native \w/,
  
    // Easily-parseable/retrievable ID or TAG or CLASS selectors
    rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
  
    rsibling = /[+~]/,
  
    // CSS escapes
    // http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
    runescape = new RegExp( "\\\\[\\da-fA-F]{1,6}" + whitespace + "?|\\\\([^\\r\\n\\f])", "g" ),
    funescape = function( escape, nonHex ) {
      var high = "0x" + escape.slice( 1 ) - 0x10000;
  
      return nonHex ?
  
        // Strip the backslash prefix from a non-hex escape sequence
        nonHex :
  
        // Replace a hexadecimal escape sequence with the encoded Unicode code point
        // Support: IE <=11+
        // For values outside the Basic Multilingual Plane (BMP), manually construct a
        // surrogate pair
        high < 0 ?
          String.fromCharCode( high + 0x10000 ) :
          String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
    },
  
    // CSS string/identifier serialization
    // https://drafts.csswg.org/cssom/#common-serializing-idioms
    rcssescape = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,
    fcssescape = function( ch, asCodePoint ) {
      if ( asCodePoint ) {
  
        // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER
        if ( ch === "\0" ) {
          return "\uFFFD";
        }
  
        // Control characters and (dependent upon position) numbers get escaped as code points
        return ch.slice( 0, -1 ) + "\\" +
          ch.charCodeAt( ch.length - 1 ).toString( 16 ) + " ";
      }
  
      // Other potentially-special ASCII characters get backslash-escaped
      return "\\" + ch;
    },
  
    // Used for iframes
    // See setDocument()
    // Removing the function wrapper causes a "Permission Denied"
    // error in IE
    unloadHandler = function() {
      setDocument();
    },
  
    inDisabledFieldset = addCombinator(
      function( elem ) {
        return elem.disabled === true && elem.nodeName.toLowerCase() === "fieldset";
      },
      { dir: "parentNode", next: "legend" }
    );
  
  // Optimize for push.apply( _, NodeList )
  try {
    push.apply(
      ( arr = slice.call( preferredDoc.childNodes ) ),
      preferredDoc.childNodes
    );
  
    // Support: Android<4.0
    // Detect silently failing push.apply
    // eslint-disable-next-line no-unused-expressions
    arr[ preferredDoc.childNodes.length ].nodeType;
  } catch ( e ) {
    push = { apply: arr.length ?
  
      // Leverage slice if possible
      function( target, els ) {
        pushNative.apply( target, slice.call( els ) );
      } :
  
      // Support: IE<9
      // Otherwise append directly
      function( target, els ) {
        var j = target.length,
          i = 0;
  
        // Can't trust NodeList.length
        while ( ( target[ j++ ] = els[ i++ ] ) ) {}
        target.length = j - 1;
      }
    };
  }
  
  function Sizzle( selector, context, results, seed ) {
    var m, i, elem, nid, match, groups, newSelector,
      newContext = context && context.ownerDocument,
  
      // nodeType defaults to 9, since context defaults to document
      nodeType = context ? context.nodeType : 9;
  
    results = results || [];
  
    // Return early from calls with invalid selector or context
    if ( typeof selector !== "string" || !selector ||
      nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {
  
      return results;
    }
  
    // Try to shortcut find operations (as opposed to filters) in HTML documents
    if ( !seed ) {
      setDocument( context );
      context = context || document;
  
      if ( documentIsHTML ) {
  
        // If the selector is sufficiently simple, try using a "get*By*" DOM method
        // (excepting DocumentFragment context, where the methods don't exist)
        if ( nodeType !== 11 && ( match = rquickExpr.exec( selector ) ) ) {
  
          // ID selector
          if ( ( m = match[ 1 ] ) ) {
  
            // Document context
            if ( nodeType === 9 ) {
              if ( ( elem = context.getElementById( m ) ) ) {
  
                // Support: IE, Opera, Webkit
                // TODO: identify versions
                // getElementById can match elements by name instead of ID
                if ( elem.id === m ) {
                  results.push( elem );
                  return results;
                }
              } else {
                return results;
              }
  
            // Element context
            } else {
  
              // Support: IE, Opera, Webkit
              // TODO: identify versions
              // getElementById can match elements by name instead of ID
              if ( newContext && ( elem = newContext.getElementById( m ) ) &&
                contains( context, elem ) &&
                elem.id === m ) {
  
                results.push( elem );
                return results;
              }
            }
  
          // Type selector
          } else if ( match[ 2 ] ) {
            push.apply( results, context.getElementsByTagName( selector ) );
            return results;
  
          // Class selector
          } else if ( ( m = match[ 3 ] ) && support.getElementsByClassName &&
            context.getElementsByClassName ) {
  
            push.apply( results, context.getElementsByClassName( m ) );
            return results;
          }
        }
  
        // Take advantage of querySelectorAll
        if ( support.qsa &&
          !nonnativeSelectorCache[ selector + " " ] &&
          ( !rbuggyQSA || !rbuggyQSA.test( selector ) ) &&
  
          // Support: IE 8 only
          // Exclude object elements
          ( nodeType !== 1 || context.nodeName.toLowerCase() !== "object" ) ) {
  
          newSelector = selector;
          newContext = context;
  
          // qSA considers elements outside a scoping root when evaluating child or
          // descendant combinators, which is not what we want.
          // In such cases, we work around the behavior by prefixing every selector in the
          // list with an ID selector referencing the scope context.
          // The technique has to be used as well when a leading combinator is used
          // as such selectors are not recognized by querySelectorAll.
          // Thanks to Andrew Dupont for this technique.
          if ( nodeType === 1 &&
            ( rdescend.test( selector ) || rcombinators.test( selector ) ) ) {
  
            // Expand context for sibling selectors
            newContext = rsibling.test( selector ) && testContext( context.parentNode ) ||
              context;
  
            // We can use :scope instead of the ID hack if the browser
            // supports it & if we're not changing the context.
            if ( newContext !== context || !support.scope ) {
  
              // Capture the context ID, setting it first if necessary
              if ( ( nid = context.getAttribute( "id" ) ) ) {
                nid = nid.replace( rcssescape, fcssescape );
              } else {
                context.setAttribute( "id", ( nid = expando ) );
              }
            }
  
            // Prefix every selector in the list
            groups = tokenize( selector );
            i = groups.length;
            while ( i-- ) {
              groups[ i ] = ( nid ? "#" + nid : ":scope" ) + " " +
                toSelector( groups[ i ] );
            }
            newSelector = groups.join( "," );
          }
  
          try {
            push.apply( results,
              newContext.querySelectorAll( newSelector )
            );
            return results;
          } catch ( qsaError ) {
            nonnativeSelectorCache( selector, true );
          } finally {
            if ( nid === expando ) {
              context.removeAttribute( "id" );
            }
          }
        }
      }
    }
  
    // All others
    return select( selector.replace( rtrim, "$1" ), context, results, seed );
  }
  
  /**
   * Create key-value caches of limited size
   * @returns {function(string, object)} Returns the Object data after storing it on itself with
   *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
   *	deleting the oldest entry
   */
  function createCache() {
    var keys = [];
  
    function cache( key, value ) {
  
      // Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
      if ( keys.push( key + " " ) > Expr.cacheLength ) {
  
        // Only keep the most recent entries
        delete cache[ keys.shift() ];
      }
      return ( cache[ key + " " ] = value );
    }
    return cache;
  }
  
  /**
   * Mark a function for special use by Sizzle
   * @param {Function} fn The function to mark
   */
  function markFunction( fn ) {
    fn[ expando ] = true;
    return fn;
  }
  
  /**
   * Support testing using an element
   * @param {Function} fn Passed the created element and returns a boolean result
   */
  function assert( fn ) {
    var el = document.createElement( "fieldset" );
  
    try {
      return !!fn( el );
    } catch ( e ) {
      return false;
    } finally {
  
      // Remove from its parent by default
      if ( el.parentNode ) {
        el.parentNode.removeChild( el );
      }
  
      // release memory in IE
      el = null;
    }
  }
  
  /**
   * Adds the same handler for all of the specified attrs
   * @param {String} attrs Pipe-separated list of attributes
   * @param {Function} handler The method that will be applied
   */
  function addHandle( attrs, handler ) {
    var arr = attrs.split( "|" ),
      i = arr.length;
  
    while ( i-- ) {
      Expr.attrHandle[ arr[ i ] ] = handler;
    }
  }
  
  /**
   * Checks document order of two siblings
   * @param {Element} a
   * @param {Element} b
   * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
   */
  function siblingCheck( a, b ) {
    var cur = b && a,
      diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
        a.sourceIndex - b.sourceIndex;
  
    // Use IE sourceIndex if available on both nodes
    if ( diff ) {
      return diff;
    }
  
    // Check if b follows a
    if ( cur ) {
      while ( ( cur = cur.nextSibling ) ) {
        if ( cur === b ) {
          return -1;
        }
      }
    }
  
    return a ? 1 : -1;
  }
  
  /**
   * Returns a function to use in pseudos for input types
   * @param {String} type
   */
  function createInputPseudo( type ) {
    return function( elem ) {
      var name = elem.nodeName.toLowerCase();
      return name === "input" && elem.type === type;
    };
  }
  
  /**
   * Returns a function to use in pseudos for buttons
   * @param {String} type
   */
  function createButtonPseudo( type ) {
    return function( elem ) {
      var name = elem.nodeName.toLowerCase();
      return ( name === "input" || name === "button" ) && elem.type === type;
    };
  }
  
  /**
   * Returns a function to use in pseudos for :enabled/:disabled
   * @param {Boolean} disabled true for :disabled; false for :enabled
   */
  function createDisabledPseudo( disabled ) {
  
    // Known :disabled false positives: fieldset[disabled] > legend:nth-of-type(n+2) :can-disable
    return function( elem ) {
  
      // Only certain elements can match :enabled or :disabled
      // https://html.spec.whatwg.org/multipage/scripting.html#selector-enabled
      // https://html.spec.whatwg.org/multipage/scripting.html#selector-disabled
      if ( "form" in elem ) {
  
        // Check for inherited disabledness on relevant non-disabled elements:
        // * listed form-associated elements in a disabled fieldset
        //   https://html.spec.whatwg.org/multipage/forms.html#category-listed
        //   https://html.spec.whatwg.org/multipage/forms.html#concept-fe-disabled
        // * option elements in a disabled optgroup
        //   https://html.spec.whatwg.org/multipage/forms.html#concept-option-disabled
        // All such elements have a "form" property.
        if ( elem.parentNode && elem.disabled === false ) {
  
          // Option elements defer to a parent optgroup if present
          if ( "label" in elem ) {
            if ( "label" in elem.parentNode ) {
              return elem.parentNode.disabled === disabled;
            } else {
              return elem.disabled === disabled;
            }
          }
  
          // Support: IE 6 - 11
          // Use the isDisabled shortcut property to check for disabled fieldset ancestors
          return elem.isDisabled === disabled ||
  
            // Where there is no isDisabled, check manually
            /* jshint -W018 */
            elem.isDisabled !== !disabled &&
            inDisabledFieldset( elem ) === disabled;
        }
  
        return elem.disabled === disabled;
  
      // Try to winnow out elements that can't be disabled before trusting the disabled property.
      // Some victims get caught in our net (label, legend, menu, track), but it shouldn't
      // even exist on them, let alone have a boolean value.
      } else if ( "label" in elem ) {
        return elem.disabled === disabled;
      }
  
      // Remaining elements are neither :enabled nor :disabled
      return false;
    };
  }
  
  /**
   * Returns a function to use in pseudos for positionals
   * @param {Function} fn
   */
  function createPositionalPseudo( fn ) {
    return markFunction( function( argument ) {
      argument = +argument;
      return markFunction( function( seed, matches ) {
        var j,
          matchIndexes = fn( [], seed.length, argument ),
          i = matchIndexes.length;
  
        // Match elements found at the specified indexes
        while ( i-- ) {
          if ( seed[ ( j = matchIndexes[ i ] ) ] ) {
            seed[ j ] = !( matches[ j ] = seed[ j ] );
          }
        }
      } );
    } );
  }
  
  /**
   * Checks a node for validity as a Sizzle context
   * @param {Element|Object=} context
   * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
   */
  function testContext( context ) {
    return context && typeof context.getElementsByTagName !== "undefined" && context;
  }
  
  // Expose support vars for convenience
  support = Sizzle.support = {};
  
  /**
   * Detects XML nodes
   * @param {Element|Object} elem An element or a document
   * @returns {Boolean} True iff elem is a non-HTML XML node
   */
  isXML = Sizzle.isXML = function( elem ) {
    var namespace = elem.namespaceURI,
      docElem = ( elem.ownerDocument || elem ).documentElement;
  
    // Support: IE <=8
    // Assume HTML when documentElement doesn't yet exist, such as inside loading iframes
    // https://bugs.jquery.com/ticket/4833
    return !rhtml.test( namespace || docElem && docElem.nodeName || "HTML" );
  };
  
  /**
   * Sets document-related variables once based on the current document
   * @param {Element|Object} [doc] An element or document object to use to set the document
   * @returns {Object} Returns the current document
   */
  setDocument = Sizzle.setDocument = function( node ) {
    var hasCompare, subWindow,
      doc = node ? node.ownerDocument || node : preferredDoc;
  
    // Return early if doc is invalid or already selected
    // Support: IE 11+, Edge 17 - 18+
    // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
    // two documents; shallow comparisons work.
    // eslint-disable-next-line eqeqeq
    if ( doc == document || doc.nodeType !== 9 || !doc.documentElement ) {
      return document;
    }
  
    // Update global variables
    document = doc;
    docElem = document.documentElement;
    documentIsHTML = !isXML( document );
  
    // Support: IE 9 - 11+, Edge 12 - 18+
    // Accessing iframe documents after unload throws "permission denied" errors (jQuery #13936)
    // Support: IE 11+, Edge 17 - 18+
    // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
    // two documents; shallow comparisons work.
    // eslint-disable-next-line eqeqeq
    if ( preferredDoc != document &&
      ( subWindow = document.defaultView ) && subWindow.top !== subWindow ) {
  
      // Support: IE 11, Edge
      if ( subWindow.addEventListener ) {
        subWindow.addEventListener( "unload", unloadHandler, false );
  
      // Support: IE 9 - 10 only
      } else if ( subWindow.attachEvent ) {
        subWindow.attachEvent( "onunload", unloadHandler );
      }
    }
  
    // Support: IE 8 - 11+, Edge 12 - 18+, Chrome <=16 - 25 only, Firefox <=3.6 - 31 only,
    // Safari 4 - 5 only, Opera <=11.6 - 12.x only
    // IE/Edge & older browsers don't support the :scope pseudo-class.
    // Support: Safari 6.0 only
    // Safari 6.0 supports :scope but it's an alias of :root there.
    support.scope = assert( function( el ) {
      docElem.appendChild( el ).appendChild( document.createElement( "div" ) );
      return typeof el.querySelectorAll !== "undefined" &&
        !el.querySelectorAll( ":scope fieldset div" ).length;
    } );
  
    /* Attributes
    ---------------------------------------------------------------------- */
  
    // Support: IE<8
    // Verify that getAttribute really returns attributes and not properties
    // (excepting IE8 booleans)
    support.attributes = assert( function( el ) {
      el.className = "i";
      return !el.getAttribute( "className" );
    } );
  
    /* getElement(s)By*
    ---------------------------------------------------------------------- */
  
    // Check if getElementsByTagName("*") returns only elements
    support.getElementsByTagName = assert( function( el ) {
      el.appendChild( document.createComment( "" ) );
      return !el.getElementsByTagName( "*" ).length;
    } );
  
    // Support: IE<9
    support.getElementsByClassName = rnative.test( document.getElementsByClassName );
  
    // Support: IE<10
    // Check if getElementById returns elements by name
    // The broken getElementById methods don't pick up programmatically-set names,
    // so use a roundabout getElementsByName test
    support.getById = assert( function( el ) {
      docElem.appendChild( el ).id = expando;
      return !document.getElementsByName || !document.getElementsByName( expando ).length;
    } );
  
    // ID filter and find
    if ( support.getById ) {
      Expr.filter[ "ID" ] = function( id ) {
        var attrId = id.replace( runescape, funescape );
        return function( elem ) {
          return elem.getAttribute( "id" ) === attrId;
        };
      };
      Expr.find[ "ID" ] = function( id, context ) {
        if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
          var elem = context.getElementById( id );
          return elem ? [ elem ] : [];
        }
      };
    } else {
      Expr.filter[ "ID" ] =  function( id ) {
        var attrId = id.replace( runescape, funescape );
        return function( elem ) {
          var node = typeof elem.getAttributeNode !== "undefined" &&
            elem.getAttributeNode( "id" );
          return node && node.value === attrId;
        };
      };
  
      // Support: IE 6 - 7 only
      // getElementById is not reliable as a find shortcut
      Expr.find[ "ID" ] = function( id, context ) {
        if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
          var node, i, elems,
            elem = context.getElementById( id );
  
          if ( elem ) {
  
            // Verify the id attribute
            node = elem.getAttributeNode( "id" );
            if ( node && node.value === id ) {
              return [ elem ];
            }
  
            // Fall back on getElementsByName
            elems = context.getElementsByName( id );
            i = 0;
            while ( ( elem = elems[ i++ ] ) ) {
              node = elem.getAttributeNode( "id" );
              if ( node && node.value === id ) {
                return [ elem ];
              }
            }
          }
  
          return [];
        }
      };
    }
  
    // Tag
    Expr.find[ "TAG" ] = support.getElementsByTagName ?
      function( tag, context ) {
        if ( typeof context.getElementsByTagName !== "undefined" ) {
          return context.getElementsByTagName( tag );
  
        // DocumentFragment nodes don't have gEBTN
        } else if ( support.qsa ) {
          return context.querySelectorAll( tag );
        }
      } :
  
      function( tag, context ) {
        var elem,
          tmp = [],
          i = 0,
  
          // By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too
          results = context.getElementsByTagName( tag );
  
        // Filter out possible comments
        if ( tag === "*" ) {
          while ( ( elem = results[ i++ ] ) ) {
            if ( elem.nodeType === 1 ) {
              tmp.push( elem );
            }
          }
  
          return tmp;
        }
        return results;
      };
  
    // Class
    Expr.find[ "CLASS" ] = support.getElementsByClassName && function( className, context ) {
      if ( typeof context.getElementsByClassName !== "undefined" && documentIsHTML ) {
        return context.getElementsByClassName( className );
      }
    };
  
    /* QSA/matchesSelector
    ---------------------------------------------------------------------- */
  
    // QSA and matchesSelector support
  
    // matchesSelector(:active) reports false when true (IE9/Opera 11.5)
    rbuggyMatches = [];
  
    // qSa(:focus) reports false when true (Chrome 21)
    // We allow this because of a bug in IE8/9 that throws an error
    // whenever `document.activeElement` is accessed on an iframe
    // So, we allow :focus to pass through QSA all the time to avoid the IE error
    // See https://bugs.jquery.com/ticket/13378
    rbuggyQSA = [];
  
    if ( ( support.qsa = rnative.test( document.querySelectorAll ) ) ) {
  
      // Build QSA regex
      // Regex strategy adopted from Diego Perini
      assert( function( el ) {
  
        var input;
  
        // Select is set to empty string on purpose
        // This is to test IE's treatment of not explicitly
        // setting a boolean content attribute,
        // since its presence should be enough
        // https://bugs.jquery.com/ticket/12359
        docElem.appendChild( el ).innerHTML = "<a id='" + expando + "'></a>" +
          "<select id='" + expando + "-\r\\' msallowcapture=''>" +
          "<option selected=''></option></select>";
  
        // Support: IE8, Opera 11-12.16
        // Nothing should be selected when empty strings follow ^= or $= or *=
        // The test attribute must be unknown in Opera but "safe" for WinRT
        // https://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
        if ( el.querySelectorAll( "[msallowcapture^='']" ).length ) {
          rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
        }
  
        // Support: IE8
        // Boolean attributes and "value" are not treated correctly
        if ( !el.querySelectorAll( "[selected]" ).length ) {
          rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
        }
  
        // Support: Chrome<29, Android<4.4, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.8+
        if ( !el.querySelectorAll( "[id~=" + expando + "-]" ).length ) {
          rbuggyQSA.push( "~=" );
        }
  
        // Support: IE 11+, Edge 15 - 18+
        // IE 11/Edge don't find elements on a `[name='']` query in some cases.
        // Adding a temporary attribute to the document before the selection works
        // around the issue.
        // Interestingly, IE 10 & older don't seem to have the issue.
        input = document.createElement( "input" );
        input.setAttribute( "name", "" );
        el.appendChild( input );
        if ( !el.querySelectorAll( "[name='']" ).length ) {
          rbuggyQSA.push( "\\[" + whitespace + "*name" + whitespace + "*=" +
            whitespace + "*(?:''|\"\")" );
        }
  
        // Webkit/Opera - :checked should return selected option elements
        // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
        // IE8 throws error here and will not see later tests
        if ( !el.querySelectorAll( ":checked" ).length ) {
          rbuggyQSA.push( ":checked" );
        }
  
        // Support: Safari 8+, iOS 8+
        // https://bugs.webkit.org/show_bug.cgi?id=136851
        // In-page `selector#id sibling-combinator selector` fails
        if ( !el.querySelectorAll( "a#" + expando + "+*" ).length ) {
          rbuggyQSA.push( ".#.+[+~]" );
        }
  
        // Support: Firefox <=3.6 - 5 only
        // Old Firefox doesn't throw on a badly-escaped identifier.
        el.querySelectorAll( "\\\f" );
        rbuggyQSA.push( "[\\r\\n\\f]" );
      } );
  
      assert( function( el ) {
        el.innerHTML = "<a href='' disabled='disabled'></a>" +
          "<select disabled='disabled'><option/></select>";
  
        // Support: Windows 8 Native Apps
        // The type and name attributes are restricted during .innerHTML assignment
        var input = document.createElement( "input" );
        input.setAttribute( "type", "hidden" );
        el.appendChild( input ).setAttribute( "name", "D" );
  
        // Support: IE8
        // Enforce case-sensitivity of name attribute
        if ( el.querySelectorAll( "[name=d]" ).length ) {
          rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
        }
  
        // FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
        // IE8 throws error here and will not see later tests
        if ( el.querySelectorAll( ":enabled" ).length !== 2 ) {
          rbuggyQSA.push( ":enabled", ":disabled" );
        }
  
        // Support: IE9-11+
        // IE's :disabled selector does not pick up the children of disabled fieldsets
        docElem.appendChild( el ).disabled = true;
        if ( el.querySelectorAll( ":disabled" ).length !== 2 ) {
          rbuggyQSA.push( ":enabled", ":disabled" );
        }
  
        // Support: Opera 10 - 11 only
        // Opera 10-11 does not throw on post-comma invalid pseudos
        el.querySelectorAll( "*,:x" );
        rbuggyQSA.push( ",.*:" );
      } );
    }
  
    if ( ( support.matchesSelector = rnative.test( ( matches = docElem.matches ||
      docElem.webkitMatchesSelector ||
      docElem.mozMatchesSelector ||
      docElem.oMatchesSelector ||
      docElem.msMatchesSelector ) ) ) ) {
  
      assert( function( el ) {
  
        // Check to see if it's possible to do matchesSelector
        // on a disconnected node (IE 9)
        support.disconnectedMatch = matches.call( el, "*" );
  
        // This should fail with an exception
        // Gecko does not error, returns false instead
        matches.call( el, "[s!='']:x" );
        rbuggyMatches.push( "!=", pseudos );
      } );
    }
  
    rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join( "|" ) );
    rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join( "|" ) );
  
    /* Contains
    ---------------------------------------------------------------------- */
    hasCompare = rnative.test( docElem.compareDocumentPosition );
  
    // Element contains another
    // Purposefully self-exclusive
    // As in, an element does not contain itself
    contains = hasCompare || rnative.test( docElem.contains ) ?
      function( a, b ) {
        var adown = a.nodeType === 9 ? a.documentElement : a,
          bup = b && b.parentNode;
        return a === bup || !!( bup && bup.nodeType === 1 && (
          adown.contains ?
            adown.contains( bup ) :
            a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
        ) );
      } :
      function( a, b ) {
        if ( b ) {
          while ( ( b = b.parentNode ) ) {
            if ( b === a ) {
              return true;
            }
          }
        }
        return false;
      };
  
    /* Sorting
    ---------------------------------------------------------------------- */
  
    // Document order sorting
    sortOrder = hasCompare ?
    function( a, b ) {
  
      // Flag for duplicate removal
      if ( a === b ) {
        hasDuplicate = true;
        return 0;
      }
  
      // Sort on method existence if only one input has compareDocumentPosition
      var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
      if ( compare ) {
        return compare;
      }
  
      // Calculate position if both inputs belong to the same document
      // Support: IE 11+, Edge 17 - 18+
      // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
      // two documents; shallow comparisons work.
      // eslint-disable-next-line eqeqeq
      compare = ( a.ownerDocument || a ) == ( b.ownerDocument || b ) ?
        a.compareDocumentPosition( b ) :
  
        // Otherwise we know they are disconnected
        1;
  
      // Disconnected nodes
      if ( compare & 1 ||
        ( !support.sortDetached && b.compareDocumentPosition( a ) === compare ) ) {
  
        // Choose the first element that is related to our preferred document
        // Support: IE 11+, Edge 17 - 18+
        // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
        // two documents; shallow comparisons work.
        // eslint-disable-next-line eqeqeq
        if ( a == document || a.ownerDocument == preferredDoc &&
          contains( preferredDoc, a ) ) {
          return -1;
        }
  
        // Support: IE 11+, Edge 17 - 18+
        // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
        // two documents; shallow comparisons work.
        // eslint-disable-next-line eqeqeq
        if ( b == document || b.ownerDocument == preferredDoc &&
          contains( preferredDoc, b ) ) {
          return 1;
        }
  
        // Maintain original order
        return sortInput ?
          ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
          0;
      }
  
      return compare & 4 ? -1 : 1;
    } :
    function( a, b ) {
  
      // Exit early if the nodes are identical
      if ( a === b ) {
        hasDuplicate = true;
        return 0;
      }
  
      var cur,
        i = 0,
        aup = a.parentNode,
        bup = b.parentNode,
        ap = [ a ],
        bp = [ b ];
  
      // Parentless nodes are either documents or disconnected
      if ( !aup || !bup ) {
  
        // Support: IE 11+, Edge 17 - 18+
        // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
        // two documents; shallow comparisons work.
        /* eslint-disable eqeqeq */
        return a == document ? -1 :
          b == document ? 1 :
          /* eslint-enable eqeqeq */
          aup ? -1 :
          bup ? 1 :
          sortInput ?
          ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
          0;
  
      // If the nodes are siblings, we can do a quick check
      } else if ( aup === bup ) {
        return siblingCheck( a, b );
      }
  
      // Otherwise we need full lists of their ancestors for comparison
      cur = a;
      while ( ( cur = cur.parentNode ) ) {
        ap.unshift( cur );
      }
      cur = b;
      while ( ( cur = cur.parentNode ) ) {
        bp.unshift( cur );
      }
  
      // Walk down the tree looking for a discrepancy
      while ( ap[ i ] === bp[ i ] ) {
        i++;
      }
  
      return i ?
  
        // Do a sibling check if the nodes have a common ancestor
        siblingCheck( ap[ i ], bp[ i ] ) :
  
        // Otherwise nodes in our document sort first
        // Support: IE 11+, Edge 17 - 18+
        // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
        // two documents; shallow comparisons work.
        /* eslint-disable eqeqeq */
        ap[ i ] == preferredDoc ? -1 :
        bp[ i ] == preferredDoc ? 1 :
        /* eslint-enable eqeqeq */
        0;
    };
  
    return document;
  };
  
  Sizzle.matches = function( expr, elements ) {
    return Sizzle( expr, null, null, elements );
  };
  
  Sizzle.matchesSelector = function( elem, expr ) {
    setDocument( elem );
  
    if ( support.matchesSelector && documentIsHTML &&
      !nonnativeSelectorCache[ expr + " " ] &&
      ( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
      ( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {
  
      try {
        var ret = matches.call( elem, expr );
  
        // IE 9's matchesSelector returns false on disconnected nodes
        if ( ret || support.disconnectedMatch ||
  
          // As well, disconnected nodes are said to be in a document
          // fragment in IE 9
          elem.document && elem.document.nodeType !== 11 ) {
          return ret;
        }
      } catch ( e ) {
        nonnativeSelectorCache( expr, true );
      }
    }
  
    return Sizzle( expr, document, null, [ elem ] ).length > 0;
  };
  
  Sizzle.contains = function( context, elem ) {
  
    // Set document vars if needed
    // Support: IE 11+, Edge 17 - 18+
    // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
    // two documents; shallow comparisons work.
    // eslint-disable-next-line eqeqeq
    if ( ( context.ownerDocument || context ) != document ) {
      setDocument( context );
    }
    return contains( context, elem );
  };
  
  Sizzle.attr = function( elem, name ) {
  
    // Set document vars if needed
    // Support: IE 11+, Edge 17 - 18+
    // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
    // two documents; shallow comparisons work.
    // eslint-disable-next-line eqeqeq
    if ( ( elem.ownerDocument || elem ) != document ) {
      setDocument( elem );
    }
  
    var fn = Expr.attrHandle[ name.toLowerCase() ],
  
      // Don't get fooled by Object.prototype properties (jQuery #13807)
      val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
        fn( elem, name, !documentIsHTML ) :
        undefined;
  
    return val !== undefined ?
      val :
      support.attributes || !documentIsHTML ?
        elem.getAttribute( name ) :
        ( val = elem.getAttributeNode( name ) ) && val.specified ?
          val.value :
          null;
  };
  
  Sizzle.escape = function( sel ) {
    return ( sel + "" ).replace( rcssescape, fcssescape );
  };
  
  Sizzle.error = function( msg ) {
    throw new Error( "Syntax error, unrecognized expression: " + msg );
  };
  
  /**
   * Document sorting and removing duplicates
   * @param {ArrayLike} results
   */
  Sizzle.uniqueSort = function( results ) {
    var elem,
      duplicates = [],
      j = 0,
      i = 0;
  
    // Unless we *know* we can detect duplicates, assume their presence
    hasDuplicate = !support.detectDuplicates;
    sortInput = !support.sortStable && results.slice( 0 );
    results.sort( sortOrder );
  
    if ( hasDuplicate ) {
      while ( ( elem = results[ i++ ] ) ) {
        if ( elem === results[ i ] ) {
          j = duplicates.push( i );
        }
      }
      while ( j-- ) {
        results.splice( duplicates[ j ], 1 );
      }
    }
  
    // Clear input after sorting to release objects
    // See https://github.com/jquery/sizzle/pull/225
    sortInput = null;
  
    return results;
  };
  
  /**
   * Utility function for retrieving the text value of an array of DOM nodes
   * @param {Array|Element} elem
   */
  getText = Sizzle.getText = function( elem ) {
    var node,
      ret = "",
      i = 0,
      nodeType = elem.nodeType;
  
    if ( !nodeType ) {
  
      // If no nodeType, this is expected to be an array
      while ( ( node = elem[ i++ ] ) ) {
  
        // Do not traverse comment nodes
        ret += getText( node );
      }
    } else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
  
      // Use textContent for elements
      // innerText usage removed for consistency of new lines (jQuery #11153)
      if ( typeof elem.textContent === "string" ) {
        return elem.textContent;
      } else {
  
        // Traverse its children
        for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
          ret += getText( elem );
        }
      }
    } else if ( nodeType === 3 || nodeType === 4 ) {
      return elem.nodeValue;
    }
  
    // Do not include comment or processing instruction nodes
  
    return ret;
  };
  
  Expr = Sizzle.selectors = {
  
    // Can be adjusted by the user
    cacheLength: 50,
  
    createPseudo: markFunction,
  
    match: matchExpr,
  
    attrHandle: {},
  
    find: {},
  
    relative: {
      ">": { dir: "parentNode", first: true },
      " ": { dir: "parentNode" },
      "+": { dir: "previousSibling", first: true },
      "~": { dir: "previousSibling" }
    },
  
    preFilter: {
      "ATTR": function( match ) {
        match[ 1 ] = match[ 1 ].replace( runescape, funescape );
  
        // Move the given value to match[3] whether quoted or unquoted
        match[ 3 ] = ( match[ 3 ] || match[ 4 ] ||
          match[ 5 ] || "" ).replace( runescape, funescape );
  
        if ( match[ 2 ] === "~=" ) {
          match[ 3 ] = " " + match[ 3 ] + " ";
        }
  
        return match.slice( 0, 4 );
      },
  
      "CHILD": function( match ) {
  
        /* matches from matchExpr["CHILD"]
          1 type (only|nth|...)
          2 what (child|of-type)
          3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
          4 xn-component of xn+y argument ([+-]?\d*n|)
          5 sign of xn-component
          6 x of xn-component
          7 sign of y-component
          8 y of y-component
        */
        match[ 1 ] = match[ 1 ].toLowerCase();
  
        if ( match[ 1 ].slice( 0, 3 ) === "nth" ) {
  
          // nth-* requires argument
          if ( !match[ 3 ] ) {
            Sizzle.error( match[ 0 ] );
          }
  
          // numeric x and y parameters for Expr.filter.CHILD
          // remember that false/true cast respectively to 0/1
          match[ 4 ] = +( match[ 4 ] ?
            match[ 5 ] + ( match[ 6 ] || 1 ) :
            2 * ( match[ 3 ] === "even" || match[ 3 ] === "odd" ) );
          match[ 5 ] = +( ( match[ 7 ] + match[ 8 ] ) || match[ 3 ] === "odd" );
  
          // other types prohibit arguments
        } else if ( match[ 3 ] ) {
          Sizzle.error( match[ 0 ] );
        }
  
        return match;
      },
  
      "PSEUDO": function( match ) {
        var excess,
          unquoted = !match[ 6 ] && match[ 2 ];
  
        if ( matchExpr[ "CHILD" ].test( match[ 0 ] ) ) {
          return null;
        }
  
        // Accept quoted arguments as-is
        if ( match[ 3 ] ) {
          match[ 2 ] = match[ 4 ] || match[ 5 ] || "";
  
        // Strip excess characters from unquoted arguments
        } else if ( unquoted && rpseudo.test( unquoted ) &&
  
          // Get excess from tokenize (recursively)
          ( excess = tokenize( unquoted, true ) ) &&
  
          // advance to the next closing parenthesis
          ( excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length ) ) {
  
          // excess is a negative index
          match[ 0 ] = match[ 0 ].slice( 0, excess );
          match[ 2 ] = unquoted.slice( 0, excess );
        }
  
        // Return only captures needed by the pseudo filter method (type and argument)
        return match.slice( 0, 3 );
      }
    },
  
    filter: {
  
      "TAG": function( nodeNameSelector ) {
        var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
        return nodeNameSelector === "*" ?
          function() {
            return true;
          } :
          function( elem ) {
            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
          };
      },
  
      "CLASS": function( className ) {
        var pattern = classCache[ className + " " ];
  
        return pattern ||
          ( pattern = new RegExp( "(^|" + whitespace +
            ")" + className + "(" + whitespace + "|$)" ) ) && classCache(
              className, function( elem ) {
                return pattern.test(
                  typeof elem.className === "string" && elem.className ||
                  typeof elem.getAttribute !== "undefined" &&
                    elem.getAttribute( "class" ) ||
                  ""
                );
          } );
      },
  
      "ATTR": function( name, operator, check ) {
        return function( elem ) {
          var result = Sizzle.attr( elem, name );
  
          if ( result == null ) {
            return operator === "!=";
          }
          if ( !operator ) {
            return true;
          }
  
          result += "";
  
          /* eslint-disable max-len */
  
          return operator === "=" ? result === check :
            operator === "!=" ? result !== check :
            operator === "^=" ? check && result.indexOf( check ) === 0 :
            operator === "*=" ? check && result.indexOf( check ) > -1 :
            operator === "$=" ? check && result.slice( -check.length ) === check :
            operator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :
            operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
            false;
          /* eslint-enable max-len */
  
        };
      },
  
      "CHILD": function( type, what, _argument, first, last ) {
        var simple = type.slice( 0, 3 ) !== "nth",
          forward = type.slice( -4 ) !== "last",
          ofType = what === "of-type";
  
        return first === 1 && last === 0 ?
  
          // Shortcut for :nth-*(n)
          function( elem ) {
            return !!elem.parentNode;
          } :
  
          function( elem, _context, xml ) {
            var cache, uniqueCache, outerCache, node, nodeIndex, start,
              dir = simple !== forward ? "nextSibling" : "previousSibling",
              parent = elem.parentNode,
              name = ofType && elem.nodeName.toLowerCase(),
              useCache = !xml && !ofType,
              diff = false;
  
            if ( parent ) {
  
              // :(first|last|only)-(child|of-type)
              if ( simple ) {
                while ( dir ) {
                  node = elem;
                  while ( ( node = node[ dir ] ) ) {
                    if ( ofType ?
                      node.nodeName.toLowerCase() === name :
                      node.nodeType === 1 ) {
  
                      return false;
                    }
                  }
  
                  // Reverse direction for :only-* (if we haven't yet done so)
                  start = dir = type === "only" && !start && "nextSibling";
                }
                return true;
              }
  
              start = [ forward ? parent.firstChild : parent.lastChild ];
  
              // non-xml :nth-child(...) stores cache data on `parent`
              if ( forward && useCache ) {
  
                // Seek `elem` from a previously-cached index
  
                // ...in a gzip-friendly way
                node = parent;
                outerCache = node[ expando ] || ( node[ expando ] = {} );
  
                // Support: IE <9 only
                // Defend against cloned attroperties (jQuery gh-1709)
                uniqueCache = outerCache[ node.uniqueID ] ||
                  ( outerCache[ node.uniqueID ] = {} );
  
                cache = uniqueCache[ type ] || [];
                nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];
                diff = nodeIndex && cache[ 2 ];
                node = nodeIndex && parent.childNodes[ nodeIndex ];
  
                while ( ( node = ++nodeIndex && node && node[ dir ] ||
  
                  // Fallback to seeking `elem` from the start
                  ( diff = nodeIndex = 0 ) || start.pop() ) ) {
  
                  // When found, cache indexes on `parent` and break
                  if ( node.nodeType === 1 && ++diff && node === elem ) {
                    uniqueCache[ type ] = [ dirruns, nodeIndex, diff ];
                    break;
                  }
                }
  
              } else {
  
                // Use previously-cached element index if available
                if ( useCache ) {
  
                  // ...in a gzip-friendly way
                  node = elem;
                  outerCache = node[ expando ] || ( node[ expando ] = {} );
  
                  // Support: IE <9 only
                  // Defend against cloned attroperties (jQuery gh-1709)
                  uniqueCache = outerCache[ node.uniqueID ] ||
                    ( outerCache[ node.uniqueID ] = {} );
  
                  cache = uniqueCache[ type ] || [];
                  nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];
                  diff = nodeIndex;
                }
  
                // xml :nth-child(...)
                // or :nth-last-child(...) or :nth(-last)?-of-type(...)
                if ( diff === false ) {
  
                  // Use the same loop as above to seek `elem` from the start
                  while ( ( node = ++nodeIndex && node && node[ dir ] ||
                    ( diff = nodeIndex = 0 ) || start.pop() ) ) {
  
                    if ( ( ofType ?
                      node.nodeName.toLowerCase() === name :
                      node.nodeType === 1 ) &&
                      ++diff ) {
  
                      // Cache the index of each encountered element
                      if ( useCache ) {
                        outerCache = node[ expando ] ||
                          ( node[ expando ] = {} );
  
                        // Support: IE <9 only
                        // Defend against cloned attroperties (jQuery gh-1709)
                        uniqueCache = outerCache[ node.uniqueID ] ||
                          ( outerCache[ node.uniqueID ] = {} );
  
                        uniqueCache[ type ] = [ dirruns, diff ];
                      }
  
                      if ( node === elem ) {
                        break;
                      }
                    }
                  }
                }
              }
  
              // Incorporate the offset, then check against cycle size
              diff -= last;
              return diff === first || ( diff % first === 0 && diff / first >= 0 );
            }
          };
      },
  
      "PSEUDO": function( pseudo, argument ) {
  
        // pseudo-class names are case-insensitive
        // http://www.w3.org/TR/selectors/#pseudo-classes
        // Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
        // Remember that setFilters inherits from pseudos
        var args,
          fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
            Sizzle.error( "unsupported pseudo: " + pseudo );
  
        // The user may use createPseudo to indicate that
        // arguments are needed to create the filter function
        // just as Sizzle does
        if ( fn[ expando ] ) {
          return fn( argument );
        }
  
        // But maintain support for old signatures
        if ( fn.length > 1 ) {
          args = [ pseudo, pseudo, "", argument ];
          return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
            markFunction( function( seed, matches ) {
              var idx,
                matched = fn( seed, argument ),
                i = matched.length;
              while ( i-- ) {
                idx = indexOf( seed, matched[ i ] );
                seed[ idx ] = !( matches[ idx ] = matched[ i ] );
              }
            } ) :
            function( elem ) {
              return fn( elem, 0, args );
            };
        }
  
        return fn;
      }
    },
  
    pseudos: {
  
      // Potentially complex pseudos
      "not": markFunction( function( selector ) {
  
        // Trim the selector passed to compile
        // to avoid treating leading and trailing
        // spaces as combinators
        var input = [],
          results = [],
          matcher = compile( selector.replace( rtrim, "$1" ) );
  
        return matcher[ expando ] ?
          markFunction( function( seed, matches, _context, xml ) {
            var elem,
              unmatched = matcher( seed, null, xml, [] ),
              i = seed.length;
  
            // Match elements unmatched by `matcher`
            while ( i-- ) {
              if ( ( elem = unmatched[ i ] ) ) {
                seed[ i ] = !( matches[ i ] = elem );
              }
            }
          } ) :
          function( elem, _context, xml ) {
            input[ 0 ] = elem;
            matcher( input, null, xml, results );
  
            // Don't keep the element (issue #299)
            input[ 0 ] = null;
            return !results.pop();
          };
      } ),
  
      "has": markFunction( function( selector ) {
        return function( elem ) {
          return Sizzle( selector, elem ).length > 0;
        };
      } ),
  
      "contains": markFunction( function( text ) {
        text = text.replace( runescape, funescape );
        return function( elem ) {
          return ( elem.textContent || getText( elem ) ).indexOf( text ) > -1;
        };
      } ),
  
      // "Whether an element is represented by a :lang() selector
      // is based solely on the element's language value
      // being equal to the identifier C,
      // or beginning with the identifier C immediately followed by "-".
      // The matching of C against the element's language value is performed case-insensitively.
      // The identifier C does not have to be a valid language name."
      // http://www.w3.org/TR/selectors/#lang-pseudo
      "lang": markFunction( function( lang ) {
  
        // lang value must be a valid identifier
        if ( !ridentifier.test( lang || "" ) ) {
          Sizzle.error( "unsupported lang: " + lang );
        }
        lang = lang.replace( runescape, funescape ).toLowerCase();
        return function( elem ) {
          var elemLang;
          do {
            if ( ( elemLang = documentIsHTML ?
              elem.lang :
              elem.getAttribute( "xml:lang" ) || elem.getAttribute( "lang" ) ) ) {
  
              elemLang = elemLang.toLowerCase();
              return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
            }
          } while ( ( elem = elem.parentNode ) && elem.nodeType === 1 );
          return false;
        };
      } ),
  
      // Miscellaneous
      "target": function( elem ) {
        var hash = window.location && window.location.hash;
        return hash && hash.slice( 1 ) === elem.id;
      },
  
      "root": function( elem ) {
        return elem === docElem;
      },
  
      "focus": function( elem ) {
        return elem === document.activeElement &&
          ( !document.hasFocus || document.hasFocus() ) &&
          !!( elem.type || elem.href || ~elem.tabIndex );
      },
  
      // Boolean properties
      "enabled": createDisabledPseudo( false ),
      "disabled": createDisabledPseudo( true ),
  
      "checked": function( elem ) {
  
        // In CSS3, :checked should return both checked and selected elements
        // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
        var nodeName = elem.nodeName.toLowerCase();
        return ( nodeName === "input" && !!elem.checked ) ||
          ( nodeName === "option" && !!elem.selected );
      },
  
      "selected": function( elem ) {
  
        // Accessing this property makes selected-by-default
        // options in Safari work properly
        if ( elem.parentNode ) {
          // eslint-disable-next-line no-unused-expressions
          elem.parentNode.selectedIndex;
        }
  
        return elem.selected === true;
      },
  
      // Contents
      "empty": function( elem ) {
  
        // http://www.w3.org/TR/selectors/#empty-pseudo
        // :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
        //   but not by others (comment: 8; processing instruction: 7; etc.)
        // nodeType < 6 works because attributes (2) do not appear as children
        for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
          if ( elem.nodeType < 6 ) {
            return false;
          }
        }
        return true;
      },
  
      "parent": function( elem ) {
        return !Expr.pseudos[ "empty" ]( elem );
      },
  
      // Element/input types
      "header": function( elem ) {
        return rheader.test( elem.nodeName );
      },
  
      "input": function( elem ) {
        return rinputs.test( elem.nodeName );
      },
  
      "button": function( elem ) {
        var name = elem.nodeName.toLowerCase();
        return name === "input" && elem.type === "button" || name === "button";
      },
  
      "text": function( elem ) {
        var attr;
        return elem.nodeName.toLowerCase() === "input" &&
          elem.type === "text" &&
  
          // Support: IE<8
          // New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
          ( ( attr = elem.getAttribute( "type" ) ) == null ||
            attr.toLowerCase() === "text" );
      },
  
      // Position-in-collection
      "first": createPositionalPseudo( function() {
        return [ 0 ];
      } ),
  
      "last": createPositionalPseudo( function( _matchIndexes, length ) {
        return [ length - 1 ];
      } ),
  
      "eq": createPositionalPseudo( function( _matchIndexes, length, argument ) {
        return [ argument < 0 ? argument + length : argument ];
      } ),
  
      "even": createPositionalPseudo( function( matchIndexes, length ) {
        var i = 0;
        for ( ; i < length; i += 2 ) {
          matchIndexes.push( i );
        }
        return matchIndexes;
      } ),
  
      "odd": createPositionalPseudo( function( matchIndexes, length ) {
        var i = 1;
        for ( ; i < length; i += 2 ) {
          matchIndexes.push( i );
        }
        return matchIndexes;
      } ),
  
      "lt": createPositionalPseudo( function( matchIndexes, length, argument ) {
        var i = argument < 0 ?
          argument + length :
          argument > length ?
            length :
            argument;
        for ( ; --i >= 0; ) {
          matchIndexes.push( i );
        }
        return matchIndexes;
      } ),
  
      "gt": createPositionalPseudo( function( matchIndexes, length, argument ) {
        var i = argument < 0 ? argument + length : argument;
        for ( ; ++i < length; ) {
          matchIndexes.push( i );
        }
        return matchIndexes;
      } )
    }
  };
  
  Expr.pseudos[ "nth" ] = Expr.pseudos[ "eq" ];
  
  // Add button/input type pseudos
  for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
    Expr.pseudos[ i ] = createInputPseudo( i );
  }
  for ( i in { submit: true, reset: true } ) {
    Expr.pseudos[ i ] = createButtonPseudo( i );
  }
  
  // Easy API for creating new setFilters
  function setFilters() {}
  setFilters.prototype = Expr.filters = Expr.pseudos;
  Expr.setFilters = new setFilters();
  
  tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
    var matched, match, tokens, type,
      soFar, groups, preFilters,
      cached = tokenCache[ selector + " " ];
  
    if ( cached ) {
      return parseOnly ? 0 : cached.slice( 0 );
    }
  
    soFar = selector;
    groups = [];
    preFilters = Expr.preFilter;
  
    while ( soFar ) {
  
      // Comma and first run
      if ( !matched || ( match = rcomma.exec( soFar ) ) ) {
        if ( match ) {
  
          // Don't consume trailing commas as valid
          soFar = soFar.slice( match[ 0 ].length ) || soFar;
        }
        groups.push( ( tokens = [] ) );
      }
  
      matched = false;
  
      // Combinators
      if ( ( match = rcombinators.exec( soFar ) ) ) {
        matched = match.shift();
        tokens.push( {
          value: matched,
  
          // Cast descendant combinators to space
          type: match[ 0 ].replace( rtrim, " " )
        } );
        soFar = soFar.slice( matched.length );
      }
  
      // Filters
      for ( type in Expr.filter ) {
        if ( ( match = matchExpr[ type ].exec( soFar ) ) && ( !preFilters[ type ] ||
          ( match = preFilters[ type ]( match ) ) ) ) {
          matched = match.shift();
          tokens.push( {
            value: matched,
            type: type,
            matches: match
          } );
          soFar = soFar.slice( matched.length );
        }
      }
  
      if ( !matched ) {
        break;
      }
    }
  
    // Return the length of the invalid excess
    // if we're just parsing
    // Otherwise, throw an error or return tokens
    return parseOnly ?
      soFar.length :
      soFar ?
        Sizzle.error( selector ) :
  
        // Cache the tokens
        tokenCache( selector, groups ).slice( 0 );
  };
  
  function toSelector( tokens ) {
    var i = 0,
      len = tokens.length,
      selector = "";
    for ( ; i < len; i++ ) {
      selector += tokens[ i ].value;
    }
    return selector;
  }
  
  function addCombinator( matcher, combinator, base ) {
    var dir = combinator.dir,
      skip = combinator.next,
      key = skip || dir,
      checkNonElements = base && key === "parentNode",
      doneName = done++;
  
    return combinator.first ?
  
      // Check against closest ancestor/preceding element
      function( elem, context, xml ) {
        while ( ( elem = elem[ dir ] ) ) {
          if ( elem.nodeType === 1 || checkNonElements ) {
            return matcher( elem, context, xml );
          }
        }
        return false;
      } :
  
      // Check against all ancestor/preceding elements
      function( elem, context, xml ) {
        var oldCache, uniqueCache, outerCache,
          newCache = [ dirruns, doneName ];
  
        // We can't set arbitrary data on XML nodes, so they don't benefit from combinator caching
        if ( xml ) {
          while ( ( elem = elem[ dir ] ) ) {
            if ( elem.nodeType === 1 || checkNonElements ) {
              if ( matcher( elem, context, xml ) ) {
                return true;
              }
            }
          }
        } else {
          while ( ( elem = elem[ dir ] ) ) {
            if ( elem.nodeType === 1 || checkNonElements ) {
              outerCache = elem[ expando ] || ( elem[ expando ] = {} );
  
              // Support: IE <9 only
              // Defend against cloned attroperties (jQuery gh-1709)
              uniqueCache = outerCache[ elem.uniqueID ] ||
                ( outerCache[ elem.uniqueID ] = {} );
  
              if ( skip && skip === elem.nodeName.toLowerCase() ) {
                elem = elem[ dir ] || elem;
              } else if ( ( oldCache = uniqueCache[ key ] ) &&
                oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {
  
                // Assign to newCache so results back-propagate to previous elements
                return ( newCache[ 2 ] = oldCache[ 2 ] );
              } else {
  
                // Reuse newcache so results back-propagate to previous elements
                uniqueCache[ key ] = newCache;
  
                // A match means we're done; a fail means we have to keep checking
                if ( ( newCache[ 2 ] = matcher( elem, context, xml ) ) ) {
                  return true;
                }
              }
            }
          }
        }
        return false;
      };
  }
  
  function elementMatcher( matchers ) {
    return matchers.length > 1 ?
      function( elem, context, xml ) {
        var i = matchers.length;
        while ( i-- ) {
          if ( !matchers[ i ]( elem, context, xml ) ) {
            return false;
          }
        }
        return true;
      } :
      matchers[ 0 ];
  }
  
  function multipleContexts( selector, contexts, results ) {
    var i = 0,
      len = contexts.length;
    for ( ; i < len; i++ ) {
      Sizzle( selector, contexts[ i ], results );
    }
    return results;
  }
  
  function condense( unmatched, map, filter, context, xml ) {
    var elem,
      newUnmatched = [],
      i = 0,
      len = unmatched.length,
      mapped = map != null;
  
    for ( ; i < len; i++ ) {
      if ( ( elem = unmatched[ i ] ) ) {
        if ( !filter || filter( elem, context, xml ) ) {
          newUnmatched.push( elem );
          if ( mapped ) {
            map.push( i );
          }
        }
      }
    }
  
    return newUnmatched;
  }
  
  function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
    if ( postFilter && !postFilter[ expando ] ) {
      postFilter = setMatcher( postFilter );
    }
    if ( postFinder && !postFinder[ expando ] ) {
      postFinder = setMatcher( postFinder, postSelector );
    }
    return markFunction( function( seed, results, context, xml ) {
      var temp, i, elem,
        preMap = [],
        postMap = [],
        preexisting = results.length,
  
        // Get initial elements from seed or context
        elems = seed || multipleContexts(
          selector || "*",
          context.nodeType ? [ context ] : context,
          []
        ),
  
        // Prefilter to get matcher input, preserving a map for seed-results synchronization
        matcherIn = preFilter && ( seed || !selector ) ?
          condense( elems, preMap, preFilter, context, xml ) :
          elems,
  
        matcherOut = matcher ?
  
          // If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
          postFinder || ( seed ? preFilter : preexisting || postFilter ) ?
  
            // ...intermediate processing is necessary
            [] :
  
            // ...otherwise use results directly
            results :
          matcherIn;
  
      // Find primary matches
      if ( matcher ) {
        matcher( matcherIn, matcherOut, context, xml );
      }
  
      // Apply postFilter
      if ( postFilter ) {
        temp = condense( matcherOut, postMap );
        postFilter( temp, [], context, xml );
  
        // Un-match failing elements by moving them back to matcherIn
        i = temp.length;
        while ( i-- ) {
          if ( ( elem = temp[ i ] ) ) {
            matcherOut[ postMap[ i ] ] = !( matcherIn[ postMap[ i ] ] = elem );
          }
        }
      }
  
      if ( seed ) {
        if ( postFinder || preFilter ) {
          if ( postFinder ) {
  
            // Get the final matcherOut by condensing this intermediate into postFinder contexts
            temp = [];
            i = matcherOut.length;
            while ( i-- ) {
              if ( ( elem = matcherOut[ i ] ) ) {
  
                // Restore matcherIn since elem is not yet a final match
                temp.push( ( matcherIn[ i ] = elem ) );
              }
            }
            postFinder( null, ( matcherOut = [] ), temp, xml );
          }
  
          // Move matched elements from seed to results to keep them synchronized
          i = matcherOut.length;
          while ( i-- ) {
            if ( ( elem = matcherOut[ i ] ) &&
              ( temp = postFinder ? indexOf( seed, elem ) : preMap[ i ] ) > -1 ) {
  
              seed[ temp ] = !( results[ temp ] = elem );
            }
          }
        }
  
      // Add elements to results, through postFinder if defined
      } else {
        matcherOut = condense(
          matcherOut === results ?
            matcherOut.splice( preexisting, matcherOut.length ) :
            matcherOut
        );
        if ( postFinder ) {
          postFinder( null, results, matcherOut, xml );
        } else {
          push.apply( results, matcherOut );
        }
      }
    } );
  }
  
  function matcherFromTokens( tokens ) {
    var checkContext, matcher, j,
      len = tokens.length,
      leadingRelative = Expr.relative[ tokens[ 0 ].type ],
      implicitRelative = leadingRelative || Expr.relative[ " " ],
      i = leadingRelative ? 1 : 0,
  
      // The foundational matcher ensures that elements are reachable from top-level context(s)
      matchContext = addCombinator( function( elem ) {
        return elem === checkContext;
      }, implicitRelative, true ),
      matchAnyContext = addCombinator( function( elem ) {
        return indexOf( checkContext, elem ) > -1;
      }, implicitRelative, true ),
      matchers = [ function( elem, context, xml ) {
        var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
          ( checkContext = context ).nodeType ?
            matchContext( elem, context, xml ) :
            matchAnyContext( elem, context, xml ) );
  
        // Avoid hanging onto element (issue #299)
        checkContext = null;
        return ret;
      } ];
  
    for ( ; i < len; i++ ) {
      if ( ( matcher = Expr.relative[ tokens[ i ].type ] ) ) {
        matchers = [ addCombinator( elementMatcher( matchers ), matcher ) ];
      } else {
        matcher = Expr.filter[ tokens[ i ].type ].apply( null, tokens[ i ].matches );
  
        // Return special upon seeing a positional matcher
        if ( matcher[ expando ] ) {
  
          // Find the next relative operator (if any) for proper handling
          j = ++i;
          for ( ; j < len; j++ ) {
            if ( Expr.relative[ tokens[ j ].type ] ) {
              break;
            }
          }
          return setMatcher(
            i > 1 && elementMatcher( matchers ),
            i > 1 && toSelector(
  
            // If the preceding token was a descendant combinator, insert an implicit any-element `*`
            tokens
              .slice( 0, i - 1 )
              .concat( { value: tokens[ i - 2 ].type === " " ? "*" : "" } )
            ).replace( rtrim, "$1" ),
            matcher,
            i < j && matcherFromTokens( tokens.slice( i, j ) ),
            j < len && matcherFromTokens( ( tokens = tokens.slice( j ) ) ),
            j < len && toSelector( tokens )
          );
        }
        matchers.push( matcher );
      }
    }
  
    return elementMatcher( matchers );
  }
  
  function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
    var bySet = setMatchers.length > 0,
      byElement = elementMatchers.length > 0,
      superMatcher = function( seed, context, xml, results, outermost ) {
        var elem, j, matcher,
          matchedCount = 0,
          i = "0",
          unmatched = seed && [],
          setMatched = [],
          contextBackup = outermostContext,
  
          // We must always have either seed elements or outermost context
          elems = seed || byElement && Expr.find[ "TAG" ]( "*", outermost ),
  
          // Use integer dirruns iff this is the outermost matcher
          dirrunsUnique = ( dirruns += contextBackup == null ? 1 : Math.random() || 0.1 ),
          len = elems.length;
  
        if ( outermost ) {
  
          // Support: IE 11+, Edge 17 - 18+
          // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
          // two documents; shallow comparisons work.
          // eslint-disable-next-line eqeqeq
          outermostContext = context == document || context || outermost;
        }
  
        // Add elements passing elementMatchers directly to results
        // Support: IE<9, Safari
        // Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
        for ( ; i !== len && ( elem = elems[ i ] ) != null; i++ ) {
          if ( byElement && elem ) {
            j = 0;
  
            // Support: IE 11+, Edge 17 - 18+
            // IE/Edge sometimes throw a "Permission denied" error when strict-comparing
            // two documents; shallow comparisons work.
            // eslint-disable-next-line eqeqeq
            if ( !context && elem.ownerDocument != document ) {
              setDocument( elem );
              xml = !documentIsHTML;
            }
            while ( ( matcher = elementMatchers[ j++ ] ) ) {
              if ( matcher( elem, context || document, xml ) ) {
                results.push( elem );
                break;
              }
            }
            if ( outermost ) {
              dirruns = dirrunsUnique;
            }
          }
  
          // Track unmatched elements for set filters
          if ( bySet ) {
  
            // They will have gone through all possible matchers
            if ( ( elem = !matcher && elem ) ) {
              matchedCount--;
            }
  
            // Lengthen the array for every element, matched or not
            if ( seed ) {
              unmatched.push( elem );
            }
          }
        }
  
        // `i` is now the count of elements visited above, and adding it to `matchedCount`
        // makes the latter nonnegative.
        matchedCount += i;
  
        // Apply set filters to unmatched elements
        // NOTE: This can be skipped if there are no unmatched elements (i.e., `matchedCount`
        // equals `i`), unless we didn't visit _any_ elements in the above loop because we have
        // no element matchers and no seed.
        // Incrementing an initially-string "0" `i` allows `i` to remain a string only in that
        // case, which will result in a "00" `matchedCount` that differs from `i` but is also
        // numerically zero.
        if ( bySet && i !== matchedCount ) {
          j = 0;
          while ( ( matcher = setMatchers[ j++ ] ) ) {
            matcher( unmatched, setMatched, context, xml );
          }
  
          if ( seed ) {
  
            // Reintegrate element matches to eliminate the need for sorting
            if ( matchedCount > 0 ) {
              while ( i-- ) {
                if ( !( unmatched[ i ] || setMatched[ i ] ) ) {
                  setMatched[ i ] = pop.call( results );
                }
              }
            }
  
            // Discard index placeholder values to get only actual matches
            setMatched = condense( setMatched );
          }
  
          // Add matches to results
          push.apply( results, setMatched );
  
          // Seedless set matches succeeding multiple successful matchers stipulate sorting
          if ( outermost && !seed && setMatched.length > 0 &&
            ( matchedCount + setMatchers.length ) > 1 ) {
  
            Sizzle.uniqueSort( results );
          }
        }
  
        // Override manipulation of globals by nested matchers
        if ( outermost ) {
          dirruns = dirrunsUnique;
          outermostContext = contextBackup;
        }
  
        return unmatched;
      };
  
    return bySet ?
      markFunction( superMatcher ) :
      superMatcher;
  }
  
  compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
    var i,
      setMatchers = [],
      elementMatchers = [],
      cached = compilerCache[ selector + " " ];
  
    if ( !cached ) {
  
      // Generate a function of recursive functions that can be used to check each element
      if ( !match ) {
        match = tokenize( selector );
      }
      i = match.length;
      while ( i-- ) {
        cached = matcherFromTokens( match[ i ] );
        if ( cached[ expando ] ) {
          setMatchers.push( cached );
        } else {
          elementMatchers.push( cached );
        }
      }
  
      // Cache the compiled function
      cached = compilerCache(
        selector,
        matcherFromGroupMatchers( elementMatchers, setMatchers )
      );
  
      // Save selector and tokenization
      cached.selector = selector;
    }
    return cached;
  };
  
  /**
   * A low-level selection function that works with Sizzle's compiled
   *  selector functions
   * @param {String|Function} selector A selector or a pre-compiled
   *  selector function built with Sizzle.compile
   * @param {Element} context
   * @param {Array} [results]
   * @param {Array} [seed] A set of elements to match against
   */
  select = Sizzle.select = function( selector, context, results, seed ) {
    var i, tokens, token, type, find,
      compiled = typeof selector === "function" && selector,
      match = !seed && tokenize( ( selector = compiled.selector || selector ) );
  
    results = results || [];
  
    // Try to minimize operations if there is only one selector in the list and no seed
    // (the latter of which guarantees us context)
    if ( match.length === 1 ) {
  
      // Reduce context if the leading compound selector is an ID
      tokens = match[ 0 ] = match[ 0 ].slice( 0 );
      if ( tokens.length > 2 && ( token = tokens[ 0 ] ).type === "ID" &&
        context.nodeType === 9 && documentIsHTML && Expr.relative[ tokens[ 1 ].type ] ) {
  
        context = ( Expr.find[ "ID" ]( token.matches[ 0 ]
          .replace( runescape, funescape ), context ) || [] )[ 0 ];
        if ( !context ) {
          return results;
  
        // Precompiled matchers will still verify ancestry, so step up a level
        } else if ( compiled ) {
          context = context.parentNode;
        }
  
        selector = selector.slice( tokens.shift().value.length );
      }
  
      // Fetch a seed set for right-to-left matching
      i = matchExpr[ "needsContext" ].test( selector ) ? 0 : tokens.length;
      while ( i-- ) {
        token = tokens[ i ];
  
        // Abort if we hit a combinator
        if ( Expr.relative[ ( type = token.type ) ] ) {
          break;
        }
        if ( ( find = Expr.find[ type ] ) ) {
  
          // Search, expanding context for leading sibling combinators
          if ( ( seed = find(
            token.matches[ 0 ].replace( runescape, funescape ),
            rsibling.test( tokens[ 0 ].type ) && testContext( context.parentNode ) ||
              context
          ) ) ) {
  
            // If seed is empty or no tokens remain, we can return early
            tokens.splice( i, 1 );
            selector = seed.length && toSelector( tokens );
            if ( !selector ) {
              push.apply( results, seed );
              return results;
            }
  
            break;
          }
        }
      }
    }
  
    // Compile and execute a filtering function if one is not provided
    // Provide `match` to avoid retokenization if we modified the selector above
    ( compiled || compile( selector, match ) )(
      seed,
      context,
      !documentIsHTML,
      results,
      !context || rsibling.test( selector ) && testContext( context.parentNode ) || context
    );
    return results;
  };
  
  // One-time assignments
  
  // Sort stability
  support.sortStable = expando.split( "" ).sort( sortOrder ).join( "" ) === expando;
  
  // Support: Chrome 14-35+
  // Always assume duplicates if they aren't passed to the comparison function
  support.detectDuplicates = !!hasDuplicate;
  
  // Initialize against the default document
  setDocument();
  
  // Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
  // Detached nodes confoundingly follow *each other*
  support.sortDetached = assert( function( el ) {
  
    // Should return 1, but returns 4 (following)
    return el.compareDocumentPosition( document.createElement( "fieldset" ) ) & 1;
  } );
  
  // Support: IE<8
  // Prevent attribute/property "interpolation"
  // https://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
  if ( !assert( function( el ) {
    el.innerHTML = "<a href='#'></a>";
    return el.firstChild.getAttribute( "href" ) === "#";
  } ) ) {
    addHandle( "type|href|height|width", function( elem, name, isXML ) {
      if ( !isXML ) {
        return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
      }
    } );
  }
  
  // Support: IE<9
  // Use defaultValue in place of getAttribute("value")
  if ( !support.attributes || !assert( function( el ) {
    el.innerHTML = "<input/>";
    el.firstChild.setAttribute( "value", "" );
    return el.firstChild.getAttribute( "value" ) === "";
  } ) ) {
    addHandle( "value", function( elem, _name, isXML ) {
      if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
        return elem.defaultValue;
      }
    } );
  }
  
  // Support: IE<9
  // Use getAttributeNode to fetch booleans when getAttribute lies
  if ( !assert( function( el ) {
    return el.getAttribute( "disabled" ) == null;
  } ) ) {
    addHandle( booleans, function( elem, name, isXML ) {
      var val;
      if ( !isXML ) {
        return elem[ name ] === true ? name.toLowerCase() :
          ( val = elem.getAttributeNode( name ) ) && val.specified ?
            val.value :
            null;
      }
    } );
  }
  
  return Sizzle;
  
  } )( window );
  
  
  
  jQuery.find = Sizzle;
  jQuery.expr = Sizzle.selectors;
  
  // Deprecated
  jQuery.expr[ ":" ] = jQuery.expr.pseudos;
  jQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;
  jQuery.text = Sizzle.getText;
  jQuery.isXMLDoc = Sizzle.isXML;
  jQuery.contains = Sizzle.contains;
  jQuery.escapeSelector = Sizzle.escape;
  
  
  
  
  var dir = function( elem, dir, until ) {
    var matched = [],
      truncate = until !== undefined;
  
    while ( ( elem = elem[ dir ] ) && elem.nodeType !== 9 ) {
      if ( elem.nodeType === 1 ) {
        if ( truncate && jQuery( elem ).is( until ) ) {
          break;
        }
        matched.push( elem );
      }
    }
    return matched;
  };
  
  
  var siblings = function( n, elem ) {
    var matched = [];
  
    for ( ; n; n = n.nextSibling ) {
      if ( n.nodeType === 1 && n !== elem ) {
        matched.push( n );
      }
    }
  
    return matched;
  };
  
  
  var rneedsContext = jQuery.expr.match.needsContext;
  
  
  
  function nodeName( elem, name ) {
  
    return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
  
  };
  var rsingleTag = ( /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i );
  
  
  
  // Implement the identical functionality for filter and not
  function winnow( elements, qualifier, not ) {
    if ( isFunction( qualifier ) ) {
      return jQuery.grep( elements, function( elem, i ) {
        return !!qualifier.call( elem, i, elem ) !== not;
      } );
    }
  
    // Single element
    if ( qualifier.nodeType ) {
      return jQuery.grep( elements, function( elem ) {
        return ( elem === qualifier ) !== not;
      } );
    }
  
    // Arraylike of elements (jQuery, arguments, Array)
    if ( typeof qualifier !== "string" ) {
      return jQuery.grep( elements, function( elem ) {
        return ( indexOf.call( qualifier, elem ) > -1 ) !== not;
      } );
    }
  
    // Filtered directly for both simple and complex selectors
    return jQuery.filter( qualifier, elements, not );
  }
  
  jQuery.filter = function( expr, elems, not ) {
    var elem = elems[ 0 ];
  
    if ( not ) {
      expr = ":not(" + expr + ")";
    }
  
    if ( elems.length === 1 && elem.nodeType === 1 ) {
      return jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [];
    }
  
    return jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
      return elem.nodeType === 1;
    } ) );
  };
  
  jQuery.fn.extend( {
    find: function( selector ) {
      var i, ret,
        len = this.length,
        self = this;
  
      if ( typeof selector !== "string" ) {
        return this.pushStack( jQuery( selector ).filter( function() {
          for ( i = 0; i < len; i++ ) {
            if ( jQuery.contains( self[ i ], this ) ) {
              return true;
            }
          }
        } ) );
      }
  
      ret = this.pushStack( [] );
  
      for ( i = 0; i < len; i++ ) {
        jQuery.find( selector, self[ i ], ret );
      }
  
      return len > 1 ? jQuery.uniqueSort( ret ) : ret;
    },
    filter: function( selector ) {
      return this.pushStack( winnow( this, selector || [], false ) );
    },
    not: function( selector ) {
      return this.pushStack( winnow( this, selector || [], true ) );
    },
    is: function( selector ) {
      return !!winnow(
        this,
  
        // If this is a positional/relative selector, check membership in the returned set
        // so $("p:first").is("p:last") won't return true for a doc with two "p".
        typeof selector === "string" && rneedsContext.test( selector ) ?
          jQuery( selector ) :
          selector || [],
        false
      ).length;
    }
  } );
  
  
  // Initialize a jQuery object
  
  
  // A central reference to the root jQuery(document)
  var rootjQuery,
  
    // A simple way to check for HTML strings
    // Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
    // Strict HTML recognition (#11290: must start with <)
    // Shortcut simple #id case for speed
    rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,
  
    init = jQuery.fn.init = function( selector, context, root ) {
      var match, elem;
  
      // HANDLE: $(""), $(null), $(undefined), $(false)
      if ( !selector ) {
        return this;
      }
  
      // Method init() accepts an alternate rootjQuery
      // so migrate can support jQuery.sub (gh-2101)
      root = root || rootjQuery;
  
      // Handle HTML strings
      if ( typeof selector === "string" ) {
        if ( selector[ 0 ] === "<" &&
          selector[ selector.length - 1 ] === ">" &&
          selector.length >= 3 ) {
  
          // Assume that strings that start and end with <> are HTML and skip the regex check
          match = [ null, selector, null ];
  
        } else {
          match = rquickExpr.exec( selector );
        }
  
        // Match html or make sure no context is specified for #id
        if ( match && ( match[ 1 ] || !context ) ) {
  
          // HANDLE: $(html) -> $(array)
          if ( match[ 1 ] ) {
            context = context instanceof jQuery ? context[ 0 ] : context;
  
            // Option to run scripts is true for back-compat
            // Intentionally let the error be thrown if parseHTML is not present
            jQuery.merge( this, jQuery.parseHTML(
              match[ 1 ],
              context && context.nodeType ? context.ownerDocument || context : document,
              true
            ) );
  
            // HANDLE: $(html, props)
            if ( rsingleTag.test( match[ 1 ] ) && jQuery.isPlainObject( context ) ) {
              for ( match in context ) {
  
                // Properties of context are called as methods if possible
                if ( isFunction( this[ match ] ) ) {
                  this[ match ]( context[ match ] );
  
                // ...and otherwise set as attributes
                } else {
                  this.attr( match, context[ match ] );
                }
              }
            }
  
            return this;
  
          // HANDLE: $(#id)
          } else {
            elem = document.getElementById( match[ 2 ] );
  
            if ( elem ) {
  
              // Inject the element directly into the jQuery object
              this[ 0 ] = elem;
              this.length = 1;
            }
            return this;
          }
  
        // HANDLE: $(expr, $(...))
        } else if ( !context || context.jquery ) {
          return ( context || root ).find( selector );
  
        // HANDLE: $(expr, context)
        // (which is just equivalent to: $(context).find(expr)
        } else {
          return this.constructor( context ).find( selector );
        }
  
      // HANDLE: $(DOMElement)
      } else if ( selector.nodeType ) {
        this[ 0 ] = selector;
        this.length = 1;
        return this;
  
      // HANDLE: $(function)
      // Shortcut for document ready
      } else if ( isFunction( selector ) ) {
        return root.ready !== undefined ?
          root.ready( selector ) :
  
          // Execute immediately if ready is not present
          selector( jQuery );
      }
  
      return jQuery.makeArray( selector, this );
    };
  
  // Give the init function the jQuery prototype for later instantiation
  init.prototype = jQuery.fn;
  
  // Initialize central reference
  rootjQuery = jQuery( document );
  
  
  var rparentsprev = /^(?:parents|prev(?:Until|All))/,
  
    // Methods guaranteed to produce a unique set when starting from a unique set
    guaranteedUnique = {
      children: true,
      contents: true,
      next: true,
      prev: true
    };
  
  jQuery.fn.extend( {
    has: function( target ) {
      var targets = jQuery( target, this ),
        l = targets.length;
  
      return this.filter( function() {
        var i = 0;
        for ( ; i < l; i++ ) {
          if ( jQuery.contains( this, targets[ i ] ) ) {
            return true;
          }
        }
      } );
    },
  
    closest: function( selectors, context ) {
      var cur,
        i = 0,
        l = this.length,
        matched = [],
        targets = typeof selectors !== "string" && jQuery( selectors );
  
      // Positional selectors never match, since there's no _selection_ context
      if ( !rneedsContext.test( selectors ) ) {
        for ( ; i < l; i++ ) {
          for ( cur = this[ i ]; cur && cur !== context; cur = cur.parentNode ) {
  
            // Always skip document fragments
            if ( cur.nodeType < 11 && ( targets ?
              targets.index( cur ) > -1 :
  
              // Don't pass non-elements to Sizzle
              cur.nodeType === 1 &&
                jQuery.find.matchesSelector( cur, selectors ) ) ) {
  
              matched.push( cur );
              break;
            }
          }
        }
      }
  
      return this.pushStack( matched.length > 1 ? jQuery.uniqueSort( matched ) : matched );
    },
  
    // Determine the position of an element within the set
    index: function( elem ) {
  
      // No argument, return index in parent
      if ( !elem ) {
        return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
      }
  
      // Index in selector
      if ( typeof elem === "string" ) {
        return indexOf.call( jQuery( elem ), this[ 0 ] );
      }
  
      // Locate the position of the desired element
      return indexOf.call( this,
  
        // If it receives a jQuery object, the first element is used
        elem.jquery ? elem[ 0 ] : elem
      );
    },
  
    add: function( selector, context ) {
      return this.pushStack(
        jQuery.uniqueSort(
          jQuery.merge( this.get(), jQuery( selector, context ) )
        )
      );
    },
  
    addBack: function( selector ) {
      return this.add( selector == null ?
        this.prevObject : this.prevObject.filter( selector )
      );
    }
  } );
  
  function sibling( cur, dir ) {
    while ( ( cur = cur[ dir ] ) && cur.nodeType !== 1 ) {}
    return cur;
  }
  
  jQuery.each( {
    parent: function( elem ) {
      var parent = elem.parentNode;
      return parent && parent.nodeType !== 11 ? parent : null;
    },
    parents: function( elem ) {
      return dir( elem, "parentNode" );
    },
    parentsUntil: function( elem, _i, until ) {
      return dir( elem, "parentNode", until );
    },
    next: function( elem ) {
      return sibling( elem, "nextSibling" );
    },
    prev: function( elem ) {
      return sibling( elem, "previousSibling" );
    },
    nextAll: function( elem ) {
      return dir( elem, "nextSibling" );
    },
    prevAll: function( elem ) {
      return dir( elem, "previousSibling" );
    },
    nextUntil: function( elem, _i, until ) {
      return dir( elem, "nextSibling", until );
    },
    prevUntil: function( elem, _i, until ) {
      return dir( elem, "previousSibling", until );
    },
    siblings: function( elem ) {
      return siblings( ( elem.parentNode || {} ).firstChild, elem );
    },
    children: function( elem ) {
      return siblings( elem.firstChild );
    },
    contents: function( elem ) {
      if ( elem.contentDocument != null &&
  
        // Support: IE 11+
        // <object> elements with no `data` attribute has an object
        // `contentDocument` with a `null` prototype.
        getProto( elem.contentDocument ) ) {
  
        return elem.contentDocument;
      }
  
      // Support: IE 9 - 11 only, iOS 7 only, Android Browser <=4.3 only
      // Treat the template element as a regular one in browsers that
      // don't support it.
      if ( nodeName( elem, "template" ) ) {
        elem = elem.content || elem;
      }
  
      return jQuery.merge( [], elem.childNodes );
    }
  }, function( name, fn ) {
    jQuery.fn[ name ] = function( until, selector ) {
      var matched = jQuery.map( this, fn, until );
  
      if ( name.slice( -5 ) !== "Until" ) {
        selector = until;
      }
  
      if ( selector && typeof selector === "string" ) {
        matched = jQuery.filter( selector, matched );
      }
  
      if ( this.length > 1 ) {
  
        // Remove duplicates
        if ( !guaranteedUnique[ name ] ) {
          jQuery.uniqueSort( matched );
        }
  
        // Reverse order for parents* and prev-derivatives
        if ( rparentsprev.test( name ) ) {
          matched.reverse();
        }
      }
  
      return this.pushStack( matched );
    };
  } );
  var rnothtmlwhite = ( /[^\x20\t\r\n\f]+/g );
  
  
  
  // Convert String-formatted options into Object-formatted ones
  function createOptions( options ) {
    var object = {};
    jQuery.each( options.match( rnothtmlwhite ) || [], function( _, flag ) {
      object[ flag ] = true;
    } );
    return object;
  }
  
  /*
   * Create a callback list using the following parameters:
   *
   *	options: an optional list of space-separated options that will change how
   *			the callback list behaves or a more traditional option object
   *
   * By default a callback list will act like an event callback list and can be
   * "fired" multiple times.
   *
   * Possible options:
   *
   *	once:			will ensure the callback list can only be fired once (like a Deferred)
   *
   *	memory:			will keep track of previous values and will call any callback added
   *					after the list has been fired right away with the latest "memorized"
   *					values (like a Deferred)
   *
   *	unique:			will ensure a callback can only be added once (no duplicate in the list)
   *
   *	stopOnFalse:	interrupt callings when a callback returns false
   *
   */
  jQuery.Callbacks = function( options ) {
  
    // Convert options from String-formatted to Object-formatted if needed
    // (we check in cache first)
    options = typeof options === "string" ?
      createOptions( options ) :
      jQuery.extend( {}, options );
  
    var // Flag to know if list is currently firing
      firing,
  
      // Last fire value for non-forgettable lists
      memory,
  
      // Flag to know if list was already fired
      fired,
  
      // Flag to prevent firing
      locked,
  
      // Actual callback list
      list = [],
  
      // Queue of execution data for repeatable lists
      queue = [],
  
      // Index of currently firing callback (modified by add/remove as needed)
      firingIndex = -1,
  
      // Fire callbacks
      fire = function() {
  
        // Enforce single-firing
        locked = locked || options.once;
  
        // Execute callbacks for all pending executions,
        // respecting firingIndex overrides and runtime changes
        fired = firing = true;
        for ( ; queue.length; firingIndex = -1 ) {
          memory = queue.shift();
          while ( ++firingIndex < list.length ) {
  
            // Run callback and check for early termination
            if ( list[ firingIndex ].apply( memory[ 0 ], memory[ 1 ] ) === false &&
              options.stopOnFalse ) {
  
              // Jump to end and forget the data so .add doesn't re-fire
              firingIndex = list.length;
              memory = false;
            }
          }
        }
  
        // Forget the data if we're done with it
        if ( !options.memory ) {
          memory = false;
        }
  
        firing = false;
  
        // Clean up if we're done firing for good
        if ( locked ) {
  
          // Keep an empty list if we have data for future add calls
          if ( memory ) {
            list = [];
  
          // Otherwise, this object is spent
          } else {
            list = "";
          }
        }
      },
  
      // Actual Callbacks object
      self = {
  
        // Add a callback or a collection of callbacks to the list
        add: function() {
          if ( list ) {
  
            // If we have memory from a past run, we should fire after adding
            if ( memory && !firing ) {
              firingIndex = list.length - 1;
              queue.push( memory );
            }
  
            ( function add( args ) {
              jQuery.each( args, function( _, arg ) {
                if ( isFunction( arg ) ) {
                  if ( !options.unique || !self.has( arg ) ) {
                    list.push( arg );
                  }
                } else if ( arg && arg.length && toType( arg ) !== "string" ) {
  
                  // Inspect recursively
                  add( arg );
                }
              } );
            } )( arguments );
  
            if ( memory && !firing ) {
              fire();
            }
          }
          return this;
        },
  
        // Remove a callback from the list
        remove: function() {
          jQuery.each( arguments, function( _, arg ) {
            var index;
            while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
              list.splice( index, 1 );
  
              // Handle firing indexes
              if ( index <= firingIndex ) {
                firingIndex--;
              }
            }
          } );
          return this;
        },
  
        // Check if a given callback is in the list.
        // If no argument is given, return whether or not list has callbacks attached.
        has: function( fn ) {
          return fn ?
            jQuery.inArray( fn, list ) > -1 :
            list.length > 0;
        },
  
        // Remove all callbacks from the list
        empty: function() {
          if ( list ) {
            list = [];
          }
          return this;
        },
  
        // Disable .fire and .add
        // Abort any current/pending executions
        // Clear all callbacks and values
        disable: function() {
          locked = queue = [];
          list = memory = "";
          return this;
        },
        disabled: function() {
          return !list;
        },
  
        // Disable .fire
        // Also disable .add unless we have memory (since it would have no effect)
        // Abort any pending executions
        lock: function() {
          locked = queue = [];
          if ( !memory && !firing ) {
            list = memory = "";
          }
          return this;
        },
        locked: function() {
          return !!locked;
        },
  
        // Call all callbacks with the given context and arguments
        fireWith: function( context, args ) {
          if ( !locked ) {
            args = args || [];
            args = [ context, args.slice ? args.slice() : args ];
            queue.push( args );
            if ( !firing ) {
              fire();
            }
          }
          return this;
        },
  
        // Call all the callbacks with the given arguments
        fire: function() {
          self.fireWith( this, arguments );
          return this;
        },
  
        // To know if the callbacks have already been called at least once
        fired: function() {
          return !!fired;
        }
      };
  
    return self;
  };
  
  
  function Identity( v ) {
    return v;
  }
  function Thrower( ex ) {
    throw ex;
  }
  
  function adoptValue( value, resolve, reject, noValue ) {
    var method;
  
    try {
  
      // Check for promise aspect first to privilege synchronous behavior
      if ( value && isFunction( ( method = value.promise ) ) ) {
        method.call( value ).done( resolve ).fail( reject );
  
      // Other thenables
      } else if ( value && isFunction( ( method = value.then ) ) ) {
        method.call( value, resolve, reject );
  
      // Other non-thenables
      } else {
  
        // Control `resolve` arguments by letting Array#slice cast boolean `noValue` to integer:
        // * false: [ value ].slice( 0 ) => resolve( value )
        // * true: [ value ].slice( 1 ) => resolve()
        resolve.apply( undefined, [ value ].slice( noValue ) );
      }
  
    // For Promises/A+, convert exceptions into rejections
    // Since jQuery.when doesn't unwrap thenables, we can skip the extra checks appearing in
    // Deferred#then to conditionally suppress rejection.
    } catch ( value ) {
  
      // Support: Android 4.0 only
      // Strict mode functions invoked without .call/.apply get global-object context
      reject.apply( undefined, [ value ] );
    }
  }
  
  jQuery.extend( {
  
    Deferred: function( func ) {
      var tuples = [
  
          // action, add listener, callbacks,
          // ... .then handlers, argument index, [final state]
          [ "notify", "progress", jQuery.Callbacks( "memory" ),
            jQuery.Callbacks( "memory" ), 2 ],
          [ "resolve", "done", jQuery.Callbacks( "once memory" ),
            jQuery.Callbacks( "once memory" ), 0, "resolved" ],
          [ "reject", "fail", jQuery.Callbacks( "once memory" ),
            jQuery.Callbacks( "once memory" ), 1, "rejected" ]
        ],
        state = "pending",
        promise = {
          state: function() {
            return state;
          },
          always: function() {
            deferred.done( arguments ).fail( arguments );
            return this;
          },
          "catch": function( fn ) {
            return promise.then( null, fn );
          },
  
          // Keep pipe for back-compat
          pipe: function( /* fnDone, fnFail, fnProgress */ ) {
            var fns = arguments;
  
            return jQuery.Deferred( function( newDefer ) {
              jQuery.each( tuples, function( _i, tuple ) {
  
                // Map tuples (progress, done, fail) to arguments (done, fail, progress)
                var fn = isFunction( fns[ tuple[ 4 ] ] ) && fns[ tuple[ 4 ] ];
  
                // deferred.progress(function() { bind to newDefer or newDefer.notify })
                // deferred.done(function() { bind to newDefer or newDefer.resolve })
                // deferred.fail(function() { bind to newDefer or newDefer.reject })
                deferred[ tuple[ 1 ] ]( function() {
                  var returned = fn && fn.apply( this, arguments );
                  if ( returned && isFunction( returned.promise ) ) {
                    returned.promise()
                      .progress( newDefer.notify )
                      .done( newDefer.resolve )
                      .fail( newDefer.reject );
                  } else {
                    newDefer[ tuple[ 0 ] + "With" ](
                      this,
                      fn ? [ returned ] : arguments
                    );
                  }
                } );
              } );
              fns = null;
            } ).promise();
          },
          then: function( onFulfilled, onRejected, onProgress ) {
            var maxDepth = 0;
            function resolve( depth, deferred, handler, special ) {
              return function() {
                var that = this,
                  args = arguments,
                  mightThrow = function() {
                    var returned, then;
  
                    // Support: Promises/A+ section 2.3.3.3.3
                    // https://promisesaplus.com/#point-59
                    // Ignore double-resolution attempts
                    if ( depth < maxDepth ) {
                      return;
                    }
  
                    returned = handler.apply( that, args );
  
                    // Support: Promises/A+ section 2.3.1
                    // https://promisesaplus.com/#point-48
                    if ( returned === deferred.promise() ) {
                      throw new TypeError( "Thenable self-resolution" );
                    }
  
                    // Support: Promises/A+ sections 2.3.3.1, 3.5
                    // https://promisesaplus.com/#point-54
                    // https://promisesaplus.com/#point-75
                    // Retrieve `then` only once
                    then = returned &&
  
                      // Support: Promises/A+ section 2.3.4
                      // https://promisesaplus.com/#point-64
                      // Only check objects and functions for thenability
                      ( typeof returned === "object" ||
                        typeof returned === "function" ) &&
                      returned.then;
  
                    // Handle a returned thenable
                    if ( isFunction( then ) ) {
  
                      // Special processors (notify) just wait for resolution
                      if ( special ) {
                        then.call(
                          returned,
                          resolve( maxDepth, deferred, Identity, special ),
                          resolve( maxDepth, deferred, Thrower, special )
                        );
  
                      // Normal processors (resolve) also hook into progress
                      } else {
  
                        // ...and disregard older resolution values
                        maxDepth++;
  
                        then.call(
                          returned,
                          resolve( maxDepth, deferred, Identity, special ),
                          resolve( maxDepth, deferred, Thrower, special ),
                          resolve( maxDepth, deferred, Identity,
                            deferred.notifyWith )
                        );
                      }
  
                    // Handle all other returned values
                    } else {
  
                      // Only substitute handlers pass on context
                      // and multiple values (non-spec behavior)
                      if ( handler !== Identity ) {
                        that = undefined;
                        args = [ returned ];
                      }
  
                      // Process the value(s)
                      // Default process is resolve
                      ( special || deferred.resolveWith )( that, args );
                    }
                  },
  
                  // Only normal processors (resolve) catch and reject exceptions
                  process = special ?
                    mightThrow :
                    function() {
                      try {
                        mightThrow();
                      } catch ( e ) {
  
                        if ( jQuery.Deferred.exceptionHook ) {
                          jQuery.Deferred.exceptionHook( e,
                            process.stackTrace );
                        }
  
                        // Support: Promises/A+ section 2.3.3.3.4.1
                        // https://promisesaplus.com/#point-61
                        // Ignore post-resolution exceptions
                        if ( depth + 1 >= maxDepth ) {
  
                          // Only substitute handlers pass on context
                          // and multiple values (non-spec behavior)
                          if ( handler !== Thrower ) {
                            that = undefined;
                            args = [ e ];
                          }
  
                          deferred.rejectWith( that, args );
                        }
                      }
                    };
  
                // Support: Promises/A+ section 2.3.3.3.1
                // https://promisesaplus.com/#point-57
                // Re-resolve promises immediately to dodge false rejection from
                // subsequent errors
                if ( depth ) {
                  process();
                } else {
  
                  // Call an optional hook to record the stack, in case of exception
                  // since it's otherwise lost when execution goes async
                  if ( jQuery.Deferred.getStackHook ) {
                    process.stackTrace = jQuery.Deferred.getStackHook();
                  }
                  window.setTimeout( process );
                }
              };
            }
  
            return jQuery.Deferred( function( newDefer ) {
  
              // progress_handlers.add( ... )
              tuples[ 0 ][ 3 ].add(
                resolve(
                  0,
                  newDefer,
                  isFunction( onProgress ) ?
                    onProgress :
                    Identity,
                  newDefer.notifyWith
                )
              );
  
              // fulfilled_handlers.add( ... )
              tuples[ 1 ][ 3 ].add(
                resolve(
                  0,
                  newDefer,
                  isFunction( onFulfilled ) ?
                    onFulfilled :
                    Identity
                )
              );
  
              // rejected_handlers.add( ... )
              tuples[ 2 ][ 3 ].add(
                resolve(
                  0,
                  newDefer,
                  isFunction( onRejected ) ?
                    onRejected :
                    Thrower
                )
              );
            } ).promise();
          },
  
          // Get a promise for this deferred
          // If obj is provided, the promise aspect is added to the object
          promise: function( obj ) {
            return obj != null ? jQuery.extend( obj, promise ) : promise;
          }
        },
        deferred = {};
  
      // Add list-specific methods
      jQuery.each( tuples, function( i, tuple ) {
        var list = tuple[ 2 ],
          stateString = tuple[ 5 ];
  
        // promise.progress = list.add
        // promise.done = list.add
        // promise.fail = list.add
        promise[ tuple[ 1 ] ] = list.add;
  
        // Handle state
        if ( stateString ) {
          list.add(
            function() {
  
              // state = "resolved" (i.e., fulfilled)
              // state = "rejected"
              state = stateString;
            },
  
            // rejected_callbacks.disable
            // fulfilled_callbacks.disable
            tuples[ 3 - i ][ 2 ].disable,
  
            // rejected_handlers.disable
            // fulfilled_handlers.disable
            tuples[ 3 - i ][ 3 ].disable,
  
            // progress_callbacks.lock
            tuples[ 0 ][ 2 ].lock,
  
            // progress_handlers.lock
            tuples[ 0 ][ 3 ].lock
          );
        }
  
        // progress_handlers.fire
        // fulfilled_handlers.fire
        // rejected_handlers.fire
        list.add( tuple[ 3 ].fire );
  
        // deferred.notify = function() { deferred.notifyWith(...) }
        // deferred.resolve = function() { deferred.resolveWith(...) }
        // deferred.reject = function() { deferred.rejectWith(...) }
        deferred[ tuple[ 0 ] ] = function() {
          deferred[ tuple[ 0 ] + "With" ]( this === deferred ? undefined : this, arguments );
          return this;
        };
  
        // deferred.notifyWith = list.fireWith
        // deferred.resolveWith = list.fireWith
        // deferred.rejectWith = list.fireWith
        deferred[ tuple[ 0 ] + "With" ] = list.fireWith;
      } );
  
      // Make the deferred a promise
      promise.promise( deferred );
  
      // Call given func if any
      if ( func ) {
        func.call( deferred, deferred );
      }
  
      // All done!
      return deferred;
    },
  
    // Deferred helper
    when: function( singleValue ) {
      var
  
        // count of uncompleted subordinates
        remaining = arguments.length,
  
        // count of unprocessed arguments
        i = remaining,
  
        // subordinate fulfillment data
        resolveContexts = Array( i ),
        resolveValues = slice.call( arguments ),
  
        // the master Deferred
        master = jQuery.Deferred(),
  
        // subordinate callback factory
        updateFunc = function( i ) {
          return function( value ) {
            resolveContexts[ i ] = this;
            resolveValues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
            if ( !( --remaining ) ) {
              master.resolveWith( resolveContexts, resolveValues );
            }
          };
        };
  
      // Single- and empty arguments are adopted like Promise.resolve
      if ( remaining <= 1 ) {
        adoptValue( singleValue, master.done( updateFunc( i ) ).resolve, master.reject,
          !remaining );
  
        // Use .then() to unwrap secondary thenables (cf. gh-3000)
        if ( master.state() === "pending" ||
          isFunction( resolveValues[ i ] && resolveValues[ i ].then ) ) {
  
          return master.then();
        }
      }
  
      // Multiple arguments are aggregated like Promise.all array elements
      while ( i-- ) {
        adoptValue( resolveValues[ i ], updateFunc( i ), master.reject );
      }
  
      return master.promise();
    }
  } );
  
  
  // These usually indicate a programmer mistake during development,
  // warn about them ASAP rather than swallowing them by default.
  var rerrorNames = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;
  
  jQuery.Deferred.exceptionHook = function( error, stack ) {
  
    // Support: IE 8 - 9 only
    // Console exists when dev tools are open, which can happen at any time
    if ( window.console && window.console.warn && error && rerrorNames.test( error.name ) ) {
      window.console.warn( "jQuery.Deferred exception: " + error.message, error.stack, stack );
    }
  };
  
  
  
  
  jQuery.readyException = function( error ) {
    window.setTimeout( function() {
      throw error;
    } );
  };
  
  
  
  
  // The deferred used on DOM ready
  var readyList = jQuery.Deferred();
  
  jQuery.fn.ready = function( fn ) {
  
    readyList
      .then( fn )
  
      // Wrap jQuery.readyException in a function so that the lookup
      // happens at the time of error handling instead of callback
      // registration.
      .catch( function( error ) {
        jQuery.readyException( error );
      } );
  
    return this;
  };
  
  jQuery.extend( {
  
    // Is the DOM ready to be used? Set to true once it occurs.
    isReady: false,
  
    // A counter to track how many items to wait for before
    // the ready event fires. See #6781
    readyWait: 1,
  
    // Handle when the DOM is ready
    ready: function( wait ) {
  
      // Abort if there are pending holds or we're already ready
      if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
        return;
      }
  
      // Remember that the DOM is ready
      jQuery.isReady = true;
  
      // If a normal DOM Ready event fired, decrement, and wait if need be
      if ( wait !== true && --jQuery.readyWait > 0 ) {
        return;
      }
  
      // If there are functions bound, to execute
      readyList.resolveWith( document, [ jQuery ] );
    }
  } );
  
  jQuery.ready.then = readyList.then;
  
  // The ready event handler and self cleanup method
  function completed() {
    document.removeEventListener( "DOMContentLoaded", completed );
    window.removeEventListener( "load", completed );
    jQuery.ready();
  }
  
  // Catch cases where $(document).ready() is called
  // after the browser event has already occurred.
  // Support: IE <=9 - 10 only
  // Older IE sometimes signals "interactive" too soon
  if ( document.readyState === "complete" ||
    ( document.readyState !== "loading" && !document.documentElement.doScroll ) ) {
  
    // Handle it asynchronously to allow scripts the opportunity to delay ready
    window.setTimeout( jQuery.ready );
  
  } else {
  
    // Use the handy event callback
    document.addEventListener( "DOMContentLoaded", completed );
  
    // A fallback to window.onload, that will always work
    window.addEventListener( "load", completed );
  }
  
  
  
  
  // Multifunctional method to get and set values of a collection
  // The value/s can optionally be executed if it's a function
  var access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
    var i = 0,
      len = elems.length,
      bulk = key == null;
  
    // Sets many values
    if ( toType( key ) === "object" ) {
      chainable = true;
      for ( i in key ) {
        access( elems, fn, i, key[ i ], true, emptyGet, raw );
      }
  
    // Sets one value
    } else if ( value !== undefined ) {
      chainable = true;
  
      if ( !isFunction( value ) ) {
        raw = true;
      }
  
      if ( bulk ) {
  
        // Bulk operations run against the entire set
        if ( raw ) {
          fn.call( elems, value );
          fn = null;
  
        // ...except when executing function values
        } else {
          bulk = fn;
          fn = function( elem, _key, value ) {
            return bulk.call( jQuery( elem ), value );
          };
        }
      }
  
      if ( fn ) {
        for ( ; i < len; i++ ) {
          fn(
            elems[ i ], key, raw ?
            value :
            value.call( elems[ i ], i, fn( elems[ i ], key ) )
          );
        }
      }
    }
  
    if ( chainable ) {
      return elems;
    }
  
    // Gets
    if ( bulk ) {
      return fn.call( elems );
    }
  
    return len ? fn( elems[ 0 ], key ) : emptyGet;
  };
  
  
  // Matches dashed string for camelizing
  var rmsPrefix = /^-ms-/,
    rdashAlpha = /-([a-z])/g;
  
  // Used by camelCase as callback to replace()
  function fcamelCase( _all, letter ) {
    return letter.toUpperCase();
  }
  
  // Convert dashed to camelCase; used by the css and data modules
  // Support: IE <=9 - 11, Edge 12 - 15
  // Microsoft forgot to hump their vendor prefix (#9572)
  function camelCase( string ) {
    return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
  }
  var acceptData = function( owner ) {
  
    // Accepts only:
    //  - Node
    //    - Node.ELEMENT_NODE
    //    - Node.DOCUMENT_NODE
    //  - Object
    //    - Any
    return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
  };
  
  
  
  
  function Data() {
    this.expando = jQuery.expando + Data.uid++;
  }
  
  Data.uid = 1;
  
  Data.prototype = {
  
    cache: function( owner ) {
  
      // Check if the owner object already has a cache
      var value = owner[ this.expando ];
  
      // If not, create one
      if ( !value ) {
        value = {};
  
        // We can accept data for non-element nodes in modern browsers,
        // but we should not, see #8335.
        // Always return an empty object.
        if ( acceptData( owner ) ) {
  
          // If it is a node unlikely to be stringify-ed or looped over
          // use plain assignment
          if ( owner.nodeType ) {
            owner[ this.expando ] = value;
  
          // Otherwise secure it in a non-enumerable property
          // configurable must be true to allow the property to be
          // deleted when data is removed
          } else {
            Object.defineProperty( owner, this.expando, {
              value: value,
              configurable: true
            } );
          }
        }
      }
  
      return value;
    },
    set: function( owner, data, value ) {
      var prop,
        cache = this.cache( owner );
  
      // Handle: [ owner, key, value ] args
      // Always use camelCase key (gh-2257)
      if ( typeof data === "string" ) {
        cache[ camelCase( data ) ] = value;
  
      // Handle: [ owner, { properties } ] args
      } else {
  
        // Copy the properties one-by-one to the cache object
        for ( prop in data ) {
          cache[ camelCase( prop ) ] = data[ prop ];
        }
      }
      return cache;
    },
    get: function( owner, key ) {
      return key === undefined ?
        this.cache( owner ) :
  
        // Always use camelCase key (gh-2257)
        owner[ this.expando ] && owner[ this.expando ][ camelCase( key ) ];
    },
    access: function( owner, key, value ) {
  
      // In cases where either:
      //
      //   1. No key was specified
      //   2. A string key was specified, but no value provided
      //
      // Take the "read" path and allow the get method to determine
      // which value to return, respectively either:
      //
      //   1. The entire cache object
      //   2. The data stored at the key
      //
      if ( key === undefined ||
          ( ( key && typeof key === "string" ) && value === undefined ) ) {
  
        return this.get( owner, key );
      }
  
      // When the key is not a string, or both a key and value
      // are specified, set or extend (existing objects) with either:
      //
      //   1. An object of properties
      //   2. A key and value
      //
      this.set( owner, key, value );
  
      // Since the "set" path can have two possible entry points
      // return the expected data based on which path was taken[*]
      return value !== undefined ? value : key;
    },
    remove: function( owner, key ) {
      var i,
        cache = owner[ this.expando ];
  
      if ( cache === undefined ) {
        return;
      }
  
      if ( key !== undefined ) {
  
        // Support array or space separated string of keys
        if ( Array.isArray( key ) ) {
  
          // If key is an array of keys...
          // We always set camelCase keys, so remove that.
          key = key.map( camelCase );
        } else {
          key = camelCase( key );
  
          // If a key with the spaces exists, use it.
          // Otherwise, create an array by matching non-whitespace
          key = key in cache ?
            [ key ] :
            ( key.match( rnothtmlwhite ) || [] );
        }
  
        i = key.length;
  
        while ( i-- ) {
          delete cache[ key[ i ] ];
        }
      }
  
      // Remove the expando if there's no more data
      if ( key === undefined || jQuery.isEmptyObject( cache ) ) {
  
        // Support: Chrome <=35 - 45
        // Webkit & Blink performance suffers when deleting properties
        // from DOM nodes, so set to undefined instead
        // https://bugs.chromium.org/p/chromium/issues/detail?id=378607 (bug restricted)
        if ( owner.nodeType ) {
          owner[ this.expando ] = undefined;
        } else {
          delete owner[ this.expando ];
        }
      }
    },
    hasData: function( owner ) {
      var cache = owner[ this.expando ];
      return cache !== undefined && !jQuery.isEmptyObject( cache );
    }
  };
  var dataPriv = new Data();
  
  var dataUser = new Data();
  
  
  
  //	Implementation Summary
  //
  //	1. Enforce API surface and semantic compatibility with 1.9.x branch
  //	2. Improve the module's maintainability by reducing the storage
  //		paths to a single mechanism.
  //	3. Use the same single mechanism to support "private" and "user" data.
  //	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
  //	5. Avoid exposing implementation details on user objects (eg. expando properties)
  //	6. Provide a clear path for implementation upgrade to WeakMap in 2014
  
  var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
    rmultiDash = /[A-Z]/g;
  
  function getData( data ) {
    if ( data === "true" ) {
      return true;
    }
  
    if ( data === "false" ) {
      return false;
    }
  
    if ( data === "null" ) {
      return null;
    }
  
    // Only convert to a number if it doesn't change the string
    if ( data === +data + "" ) {
      return +data;
    }
  
    if ( rbrace.test( data ) ) {
      return JSON.parse( data );
    }
  
    return data;
  }
  
  function dataAttr( elem, key, data ) {
    var name;
  
    // If nothing was found internally, try to fetch any
    // data from the HTML5 data-* attribute
    if ( data === undefined && elem.nodeType === 1 ) {
      name = "data-" + key.replace( rmultiDash, "-$&" ).toLowerCase();
      data = elem.getAttribute( name );
  
      if ( typeof data === "string" ) {
        try {
          data = getData( data );
        } catch ( e ) {}
  
        // Make sure we set the data so it isn't changed later
        dataUser.set( elem, key, data );
      } else {
        data = undefined;
      }
    }
    return data;
  }
  
  jQuery.extend( {
    hasData: function( elem ) {
      return dataUser.hasData( elem ) || dataPriv.hasData( elem );
    },
  
    data: function( elem, name, data ) {
      return dataUser.access( elem, name, data );
    },
  
    removeData: function( elem, name ) {
      dataUser.remove( elem, name );
    },
  
    // TODO: Now that all calls to _data and _removeData have been replaced
    // with direct calls to dataPriv methods, these can be deprecated.
    _data: function( elem, name, data ) {
      return dataPriv.access( elem, name, data );
    },
  
    _removeData: function( elem, name ) {
      dataPriv.remove( elem, name );
    }
  } );
  
  jQuery.fn.extend( {
    data: function( key, value ) {
      var i, name, data,
        elem = this[ 0 ],
        attrs = elem && elem.attributes;
  
      // Gets all values
      if ( key === undefined ) {
        if ( this.length ) {
          data = dataUser.get( elem );
  
          if ( elem.nodeType === 1 && !dataPriv.get( elem, "hasDataAttrs" ) ) {
            i = attrs.length;
            while ( i-- ) {
  
              // Support: IE 11 only
              // The attrs elements can be null (#14894)
              if ( attrs[ i ] ) {
                name = attrs[ i ].name;
                if ( name.indexOf( "data-" ) === 0 ) {
                  name = camelCase( name.slice( 5 ) );
                  dataAttr( elem, name, data[ name ] );
                }
              }
            }
            dataPriv.set( elem, "hasDataAttrs", true );
          }
        }
  
        return data;
      }
  
      // Sets multiple values
      if ( typeof key === "object" ) {
        return this.each( function() {
          dataUser.set( this, key );
        } );
      }
  
      return access( this, function( value ) {
        var data;
  
        // The calling jQuery object (element matches) is not empty
        // (and therefore has an element appears at this[ 0 ]) and the
        // `value` parameter was not undefined. An empty jQuery object
        // will result in `undefined` for elem = this[ 0 ] which will
        // throw an exception if an attempt to read a data cache is made.
        if ( elem && value === undefined ) {
  
          // Attempt to get data from the cache
          // The key will always be camelCased in Data
          data = dataUser.get( elem, key );
          if ( data !== undefined ) {
            return data;
          }
  
          // Attempt to "discover" the data in
          // HTML5 custom data-* attrs
          data = dataAttr( elem, key );
          if ( data !== undefined ) {
            return data;
          }
  
          // We tried really hard, but the data doesn't exist.
          return;
        }
  
        // Set the data...
        this.each( function() {
  
          // We always store the camelCased key
          dataUser.set( this, key, value );
        } );
      }, null, value, arguments.length > 1, null, true );
    },
  
    removeData: function( key ) {
      return this.each( function() {
        dataUser.remove( this, key );
      } );
    }
  } );
  
  
  jQuery.extend( {
    queue: function( elem, type, data ) {
      var queue;
  
      if ( elem ) {
        type = ( type || "fx" ) + "queue";
        queue = dataPriv.get( elem, type );
  
        // Speed up dequeue by getting out quickly if this is just a lookup
        if ( data ) {
          if ( !queue || Array.isArray( data ) ) {
            queue = dataPriv.access( elem, type, jQuery.makeArray( data ) );
          } else {
            queue.push( data );
          }
        }
        return queue || [];
      }
    },
  
    dequeue: function( elem, type ) {
      type = type || "fx";
  
      var queue = jQuery.queue( elem, type ),
        startLength = queue.length,
        fn = queue.shift(),
        hooks = jQuery._queueHooks( elem, type ),
        next = function() {
          jQuery.dequeue( elem, type );
        };
  
      // If the fx queue is dequeued, always remove the progress sentinel
      if ( fn === "inprogress" ) {
        fn = queue.shift();
        startLength--;
      }
  
      if ( fn ) {
  
        // Add a progress sentinel to prevent the fx queue from being
        // automatically dequeued
        if ( type === "fx" ) {
          queue.unshift( "inprogress" );
        }
  
        // Clear up the last queue stop function
        delete hooks.stop;
        fn.call( elem, next, hooks );
      }
  
      if ( !startLength && hooks ) {
        hooks.empty.fire();
      }
    },
  
    // Not public - generate a queueHooks object, or return the current one
    _queueHooks: function( elem, type ) {
      var key = type + "queueHooks";
      return dataPriv.get( elem, key ) || dataPriv.access( elem, key, {
        empty: jQuery.Callbacks( "once memory" ).add( function() {
          dataPriv.remove( elem, [ type + "queue", key ] );
        } )
      } );
    }
  } );
  
  jQuery.fn.extend( {
    queue: function( type, data ) {
      var setter = 2;
  
      if ( typeof type !== "string" ) {
        data = type;
        type = "fx";
        setter--;
      }
  
      if ( arguments.length < setter ) {
        return jQuery.queue( this[ 0 ], type );
      }
  
      return data === undefined ?
        this :
        this.each( function() {
          var queue = jQuery.queue( this, type, data );
  
          // Ensure a hooks for this queue
          jQuery._queueHooks( this, type );
  
          if ( type === "fx" && queue[ 0 ] !== "inprogress" ) {
            jQuery.dequeue( this, type );
          }
        } );
    },
    dequeue: function( type ) {
      return this.each( function() {
        jQuery.dequeue( this, type );
      } );
    },
    clearQueue: function( type ) {
      return this.queue( type || "fx", [] );
    },
  
    // Get a promise resolved when queues of a certain type
    // are emptied (fx is the type by default)
    promise: function( type, obj ) {
      var tmp,
        count = 1,
        defer = jQuery.Deferred(),
        elements = this,
        i = this.length,
        resolve = function() {
          if ( !( --count ) ) {
            defer.resolveWith( elements, [ elements ] );
          }
        };
  
      if ( typeof type !== "string" ) {
        obj = type;
        type = undefined;
      }
      type = type || "fx";
  
      while ( i-- ) {
        tmp = dataPriv.get( elements[ i ], type + "queueHooks" );
        if ( tmp && tmp.empty ) {
          count++;
          tmp.empty.add( resolve );
        }
      }
      resolve();
      return defer.promise( obj );
    }
  } );
  var pnum = ( /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/ ).source;
  
  var rcssNum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" );
  
  
  var cssExpand = [ "Top", "Right", "Bottom", "Left" ];
  
  var documentElement = document.documentElement;
  
  
  
    var isAttached = function( elem ) {
        return jQuery.contains( elem.ownerDocument, elem );
      },
      composed = { composed: true };
  
    // Support: IE 9 - 11+, Edge 12 - 18+, iOS 10.0 - 10.2 only
    // Check attachment across shadow DOM boundaries when possible (gh-3504)
    // Support: iOS 10.0-10.2 only
    // Early iOS 10 versions support `attachShadow` but not `getRootNode`,
    // leading to errors. We need to check for `getRootNode`.
    if ( documentElement.getRootNode ) {
      isAttached = function( elem ) {
        return jQuery.contains( elem.ownerDocument, elem ) ||
          elem.getRootNode( composed ) === elem.ownerDocument;
      };
    }
  var isHiddenWithinTree = function( elem, el ) {
  
      // isHiddenWithinTree might be called from jQuery#filter function;
      // in that case, element will be second argument
      elem = el || elem;
  
      // Inline style trumps all
      return elem.style.display === "none" ||
        elem.style.display === "" &&
  
        // Otherwise, check computed style
        // Support: Firefox <=43 - 45
        // Disconnected elements can have computed display: none, so first confirm that elem is
        // in the document.
        isAttached( elem ) &&
  
        jQuery.css( elem, "display" ) === "none";
    };
  
  
  
  function adjustCSS( elem, prop, valueParts, tween ) {
    var adjusted, scale,
      maxIterations = 20,
      currentValue = tween ?
        function() {
          return tween.cur();
        } :
        function() {
          return jQuery.css( elem, prop, "" );
        },
      initial = currentValue(),
      unit = valueParts && valueParts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),
  
      // Starting value computation is required for potential unit mismatches
      initialInUnit = elem.nodeType &&
        ( jQuery.cssNumber[ prop ] || unit !== "px" && +initial ) &&
        rcssNum.exec( jQuery.css( elem, prop ) );
  
    if ( initialInUnit && initialInUnit[ 3 ] !== unit ) {
  
      // Support: Firefox <=54
      // Halve the iteration target value to prevent interference from CSS upper bounds (gh-2144)
      initial = initial / 2;
  
      // Trust units reported by jQuery.css
      unit = unit || initialInUnit[ 3 ];
  
      // Iteratively approximate from a nonzero starting point
      initialInUnit = +initial || 1;
  
      while ( maxIterations-- ) {
  
        // Evaluate and update our best guess (doubling guesses that zero out).
        // Finish if the scale equals or crosses 1 (making the old*new product non-positive).
        jQuery.style( elem, prop, initialInUnit + unit );
        if ( ( 1 - scale ) * ( 1 - ( scale = currentValue() / initial || 0.5 ) ) <= 0 ) {
          maxIterations = 0;
        }
        initialInUnit = initialInUnit / scale;
  
      }
  
      initialInUnit = initialInUnit * 2;
      jQuery.style( elem, prop, initialInUnit + unit );
  
      // Make sure we update the tween properties later on
      valueParts = valueParts || [];
    }
  
    if ( valueParts ) {
      initialInUnit = +initialInUnit || +initial || 0;
  
      // Apply relative offset (+=/-=) if specified
      adjusted = valueParts[ 1 ] ?
        initialInUnit + ( valueParts[ 1 ] + 1 ) * valueParts[ 2 ] :
        +valueParts[ 2 ];
      if ( tween ) {
        tween.unit = unit;
        tween.start = initialInUnit;
        tween.end = adjusted;
      }
    }
    return adjusted;
  }
  
  
  var defaultDisplayMap = {};
  
  function getDefaultDisplay( elem ) {
    var temp,
      doc = elem.ownerDocument,
      nodeName = elem.nodeName,
      display = defaultDisplayMap[ nodeName ];
  
    if ( display ) {
      return display;
    }
  
    temp = doc.body.appendChild( doc.createElement( nodeName ) );
    display = jQuery.css( temp, "display" );
  
    temp.parentNode.removeChild( temp );
  
    if ( display === "none" ) {
      display = "block";
    }
    defaultDisplayMap[ nodeName ] = display;
  
    return display;
  }
  
  function showHide( elements, show ) {
    var display, elem,
      values = [],
      index = 0,
      length = elements.length;
  
    // Determine new display value for elements that need to change
    for ( ; index < length; index++ ) {
      elem = elements[ index ];
      if ( !elem.style ) {
        continue;
      }
  
      display = elem.style.display;
      if ( show ) {
  
        // Since we force visibility upon cascade-hidden elements, an immediate (and slow)
        // check is required in this first loop unless we have a nonempty display value (either
        // inline or about-to-be-restored)
        if ( display === "none" ) {
          values[ index ] = dataPriv.get( elem, "display" ) || null;
          if ( !values[ index ] ) {
            elem.style.display = "";
          }
        }
        if ( elem.style.display === "" && isHiddenWithinTree( elem ) ) {
          values[ index ] = getDefaultDisplay( elem );
        }
      } else {
        if ( display !== "none" ) {
          values[ index ] = "none";
  
          // Remember what we're overwriting
          dataPriv.set( elem, "display", display );
        }
      }
    }
  
    // Set the display of the elements in a second loop to avoid constant reflow
    for ( index = 0; index < length; index++ ) {
      if ( values[ index ] != null ) {
        elements[ index ].style.display = values[ index ];
      }
    }
  
    return elements;
  }
  
  jQuery.fn.extend( {
    show: function() {
      return showHide( this, true );
    },
    hide: function() {
      return showHide( this );
    },
    toggle: function( state ) {
      if ( typeof state === "boolean" ) {
        return state ? this.show() : this.hide();
      }
  
      return this.each( function() {
        if ( isHiddenWithinTree( this ) ) {
          jQuery( this ).show();
        } else {
          jQuery( this ).hide();
        }
      } );
    }
  } );
  var rcheckableType = ( /^(?:checkbox|radio)$/i );
  
  var rtagName = ( /<([a-z][^\/\0>\x20\t\r\n\f]*)/i );
  
  var rscriptType = ( /^$|^module$|\/(?:java|ecma)script/i );
  
  
  
  ( function() {
    var fragment = document.createDocumentFragment(),
      div = fragment.appendChild( document.createElement( "div" ) ),
      input = document.createElement( "input" );
  
    // Support: Android 4.0 - 4.3 only
    // Check state lost if the name is set (#11217)
    // Support: Windows Web Apps (WWA)
    // `name` and `type` must use .setAttribute for WWA (#14901)
    input.setAttribute( "type", "radio" );
    input.setAttribute( "checked", "checked" );
    input.setAttribute( "name", "t" );
  
    div.appendChild( input );
  
    // Support: Android <=4.1 only
    // Older WebKit doesn't clone checked state correctly in fragments
    support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;
  
    // Support: IE <=11 only
    // Make sure textarea (and checkbox) defaultValue is properly cloned
    div.innerHTML = "<textarea>x</textarea>";
    support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
  
    // Support: IE <=9 only
    // IE <=9 replaces <option> tags with their contents when inserted outside of
    // the select element.
    div.innerHTML = "<option></option>";
    support.option = !!div.lastChild;
  } )();
  
  
  // We have to close these tags to support XHTML (#13200)
  var wrapMap = {
  
    // XHTML parsers do not magically insert elements in the
    // same way that tag soup parsers do. So we cannot shorten
    // this by omitting <tbody> or other required elements.
    thead: [ 1, "<table>", "</table>" ],
    col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
    tr: [ 2, "<table><tbody>", "</tbody></table>" ],
    td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],
  
    _default: [ 0, "", "" ]
  };
  
  wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
  wrapMap.th = wrapMap.td;
  
  // Support: IE <=9 only
  if ( !support.option ) {
    wrapMap.optgroup = wrapMap.option = [ 1, "<select multiple='multiple'>", "</select>" ];
  }
  
  
  function getAll( context, tag ) {
  
    // Support: IE <=9 - 11 only
    // Use typeof to avoid zero-argument method invocation on host objects (#15151)
    var ret;
  
    if ( typeof context.getElementsByTagName !== "undefined" ) {
      ret = context.getElementsByTagName( tag || "*" );
  
    } else if ( typeof context.querySelectorAll !== "undefined" ) {
      ret = context.querySelectorAll( tag || "*" );
  
    } else {
      ret = [];
    }
  
    if ( tag === undefined || tag && nodeName( context, tag ) ) {
      return jQuery.merge( [ context ], ret );
    }
  
    return ret;
  }
  
  
  // Mark scripts as having already been evaluated
  function setGlobalEval( elems, refElements ) {
    var i = 0,
      l = elems.length;
  
    for ( ; i < l; i++ ) {
      dataPriv.set(
        elems[ i ],
        "globalEval",
        !refElements || dataPriv.get( refElements[ i ], "globalEval" )
      );
    }
  }
  
  
  var rhtml = /<|&#?\w+;/;
  
  function buildFragment( elems, context, scripts, selection, ignored ) {
    var elem, tmp, tag, wrap, attached, j,
      fragment = context.createDocumentFragment(),
      nodes = [],
      i = 0,
      l = elems.length;
  
    for ( ; i < l; i++ ) {
      elem = elems[ i ];
  
      if ( elem || elem === 0 ) {
  
        // Add nodes directly
        if ( toType( elem ) === "object" ) {
  
          // Support: Android <=4.0 only, PhantomJS 1 only
          // push.apply(_, arraylike) throws on ancient WebKit
          jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );
  
        // Convert non-html into a text node
        } else if ( !rhtml.test( elem ) ) {
          nodes.push( context.createTextNode( elem ) );
  
        // Convert html into DOM nodes
        } else {
          tmp = tmp || fragment.appendChild( context.createElement( "div" ) );
  
          // Deserialize a standard representation
          tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
          wrap = wrapMap[ tag ] || wrapMap._default;
          tmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];
  
          // Descend through wrappers to the right content
          j = wrap[ 0 ];
          while ( j-- ) {
            tmp = tmp.lastChild;
          }
  
          // Support: Android <=4.0 only, PhantomJS 1 only
          // push.apply(_, arraylike) throws on ancient WebKit
          jQuery.merge( nodes, tmp.childNodes );
  
          // Remember the top-level container
          tmp = fragment.firstChild;
  
          // Ensure the created nodes are orphaned (#12392)
          tmp.textContent = "";
        }
      }
    }
  
    // Remove wrapper from fragment
    fragment.textContent = "";
  
    i = 0;
    while ( ( elem = nodes[ i++ ] ) ) {
  
      // Skip elements already in the context collection (trac-4087)
      if ( selection && jQuery.inArray( elem, selection ) > -1 ) {
        if ( ignored ) {
          ignored.push( elem );
        }
        continue;
      }
  
      attached = isAttached( elem );
  
      // Append to fragment
      tmp = getAll( fragment.appendChild( elem ), "script" );
  
      // Preserve script evaluation history
      if ( attached ) {
        setGlobalEval( tmp );
      }
  
      // Capture executables
      if ( scripts ) {
        j = 0;
        while ( ( elem = tmp[ j++ ] ) ) {
          if ( rscriptType.test( elem.type || "" ) ) {
            scripts.push( elem );
          }
        }
      }
    }
  
    return fragment;
  }
  
  
  var
    rkeyEvent = /^key/,
    rmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
    rtypenamespace = /^([^.]*)(?:\.(.+)|)/;
  
  function returnTrue() {
    return true;
  }
  
  function returnFalse() {
    return false;
  }
  
  // Support: IE <=9 - 11+
  // focus() and blur() are asynchronous, except when they are no-op.
  // So expect focus to be synchronous when the element is already active,
  // and blur to be synchronous when the element is not already active.
  // (focus and blur are always synchronous in other supported browsers,
  // this just defines when we can count on it).
  function expectSync( elem, type ) {
    return ( elem === safeActiveElement() ) === ( type === "focus" );
  }
  
  // Support: IE <=9 only
  // Accessing document.activeElement can throw unexpectedly
  // https://bugs.jquery.com/ticket/13393
  function safeActiveElement() {
    try {
      return document.activeElement;
    } catch ( err ) { }
  }
  
  function on( elem, types, selector, data, fn, one ) {
    var origFn, type;
  
    // Types can be a map of types/handlers
    if ( typeof types === "object" ) {
  
      // ( types-Object, selector, data )
      if ( typeof selector !== "string" ) {
  
        // ( types-Object, data )
        data = data || selector;
        selector = undefined;
      }
      for ( type in types ) {
        on( elem, type, selector, data, types[ type ], one );
      }
      return elem;
    }
  
    if ( data == null && fn == null ) {
  
      // ( types, fn )
      fn = selector;
      data = selector = undefined;
    } else if ( fn == null ) {
      if ( typeof selector === "string" ) {
  
        // ( types, selector, fn )
        fn = data;
        data = undefined;
      } else {
  
        // ( types, data, fn )
        fn = data;
        data = selector;
        selector = undefined;
      }
    }
    if ( fn === false ) {
      fn = returnFalse;
    } else if ( !fn ) {
      return elem;
    }
  
    if ( one === 1 ) {
      origFn = fn;
      fn = function( event ) {
  
        // Can use an empty set, since event contains the info
        jQuery().off( event );
        return origFn.apply( this, arguments );
      };
  
      // Use same guid so caller can remove using origFn
      fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
    }
    return elem.each( function() {
      jQuery.event.add( this, types, fn, data, selector );
    } );
  }
  
  /*
   * Helper functions for managing events -- not part of the public interface.
   * Props to Dean Edwards' addEvent library for many of the ideas.
   */
  jQuery.event = {
  
    global: {},
  
    add: function( elem, types, handler, data, selector ) {
  
      var handleObjIn, eventHandle, tmp,
        events, t, handleObj,
        special, handlers, type, namespaces, origType,
        elemData = dataPriv.get( elem );
  
      // Only attach events to objects that accept data
      if ( !acceptData( elem ) ) {
        return;
      }
  
      // Caller can pass in an object of custom data in lieu of the handler
      if ( handler.handler ) {
        handleObjIn = handler;
        handler = handleObjIn.handler;
        selector = handleObjIn.selector;
      }
  
      // Ensure that invalid selectors throw exceptions at attach time
      // Evaluate against documentElement in case elem is a non-element node (e.g., document)
      if ( selector ) {
        jQuery.find.matchesSelector( documentElement, selector );
      }
  
      // Make sure that the handler has a unique ID, used to find/remove it later
      if ( !handler.guid ) {
        handler.guid = jQuery.guid++;
      }
  
      // Init the element's event structure and main handler, if this is the first
      if ( !( events = elemData.events ) ) {
        events = elemData.events = Object.create( null );
      }
      if ( !( eventHandle = elemData.handle ) ) {
        eventHandle = elemData.handle = function( e ) {
  
          // Discard the second event of a jQuery.event.trigger() and
          // when an event is called after a page has unloaded
          return typeof jQuery !== "undefined" && jQuery.event.triggered !== e.type ?
            jQuery.event.dispatch.apply( elem, arguments ) : undefined;
        };
      }
  
      // Handle multiple events separated by a space
      types = ( types || "" ).match( rnothtmlwhite ) || [ "" ];
      t = types.length;
      while ( t-- ) {
        tmp = rtypenamespace.exec( types[ t ] ) || [];
        type = origType = tmp[ 1 ];
        namespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();
  
        // There *must* be a type, no attaching namespace-only handlers
        if ( !type ) {
          continue;
        }
  
        // If event changes its type, use the special event handlers for the changed type
        special = jQuery.event.special[ type ] || {};
  
        // If selector defined, determine special event api type, otherwise given type
        type = ( selector ? special.delegateType : special.bindType ) || type;
  
        // Update special based on newly reset type
        special = jQuery.event.special[ type ] || {};
  
        // handleObj is passed to all event handlers
        handleObj = jQuery.extend( {
          type: type,
          origType: origType,
          data: data,
          handler: handler,
          guid: handler.guid,
          selector: selector,
          needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
          namespace: namespaces.join( "." )
        }, handleObjIn );
  
        // Init the event handler queue if we're the first
        if ( !( handlers = events[ type ] ) ) {
          handlers = events[ type ] = [];
          handlers.delegateCount = 0;
  
          // Only use addEventListener if the special events handler returns false
          if ( !special.setup ||
            special.setup.call( elem, data, namespaces, eventHandle ) === false ) {
  
            if ( elem.addEventListener ) {
              elem.addEventListener( type, eventHandle );
            }
          }
        }
  
        if ( special.add ) {
          special.add.call( elem, handleObj );
  
          if ( !handleObj.handler.guid ) {
            handleObj.handler.guid = handler.guid;
          }
        }
  
        // Add to the element's handler list, delegates in front
        if ( selector ) {
          handlers.splice( handlers.delegateCount++, 0, handleObj );
        } else {
          handlers.push( handleObj );
        }
  
        // Keep track of which events have ever been used, for event optimization
        jQuery.event.global[ type ] = true;
      }
  
    },
  
    // Detach an event or set of events from an element
    remove: function( elem, types, handler, selector, mappedTypes ) {
  
      var j, origCount, tmp,
        events, t, handleObj,
        special, handlers, type, namespaces, origType,
        elemData = dataPriv.hasData( elem ) && dataPriv.get( elem );
  
      if ( !elemData || !( events = elemData.events ) ) {
        return;
      }
  
      // Once for each type.namespace in types; type may be omitted
      types = ( types || "" ).match( rnothtmlwhite ) || [ "" ];
      t = types.length;
      while ( t-- ) {
        tmp = rtypenamespace.exec( types[ t ] ) || [];
        type = origType = tmp[ 1 ];
        namespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();
  
        // Unbind all events (on this namespace, if provided) for the element
        if ( !type ) {
          for ( type in events ) {
            jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
          }
          continue;
        }
  
        special = jQuery.event.special[ type ] || {};
        type = ( selector ? special.delegateType : special.bindType ) || type;
        handlers = events[ type ] || [];
        tmp = tmp[ 2 ] &&
          new RegExp( "(^|\\.)" + namespaces.join( "\\.(?:.*\\.|)" ) + "(\\.|$)" );
  
        // Remove matching events
        origCount = j = handlers.length;
        while ( j-- ) {
          handleObj = handlers[ j ];
  
          if ( ( mappedTypes || origType === handleObj.origType ) &&
            ( !handler || handler.guid === handleObj.guid ) &&
            ( !tmp || tmp.test( handleObj.namespace ) ) &&
            ( !selector || selector === handleObj.selector ||
              selector === "**" && handleObj.selector ) ) {
            handlers.splice( j, 1 );
  
            if ( handleObj.selector ) {
              handlers.delegateCount--;
            }
            if ( special.remove ) {
              special.remove.call( elem, handleObj );
            }
          }
        }
  
        // Remove generic event handler if we removed something and no more handlers exist
        // (avoids potential for endless recursion during removal of special event handlers)
        if ( origCount && !handlers.length ) {
          if ( !special.teardown ||
            special.teardown.call( elem, namespaces, elemData.handle ) === false ) {
  
            jQuery.removeEvent( elem, type, elemData.handle );
          }
  
          delete events[ type ];
        }
      }
  
      // Remove data and the expando if it's no longer used
      if ( jQuery.isEmptyObject( events ) ) {
        dataPriv.remove( elem, "handle events" );
      }
    },
  
    dispatch: function( nativeEvent ) {
  
      var i, j, ret, matched, handleObj, handlerQueue,
        args = new Array( arguments.length ),
  
        // Make a writable jQuery.Event from the native event object
        event = jQuery.event.fix( nativeEvent ),
  
        handlers = (
            dataPriv.get( this, "events" ) || Object.create( null )
          )[ event.type ] || [],
        special = jQuery.event.special[ event.type ] || {};
  
      // Use the fix-ed jQuery.Event rather than the (read-only) native event
      args[ 0 ] = event;
  
      for ( i = 1; i < arguments.length; i++ ) {
        args[ i ] = arguments[ i ];
      }
  
      event.delegateTarget = this;
  
      // Call the preDispatch hook for the mapped type, and let it bail if desired
      if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
        return;
      }
  
      // Determine handlers
      handlerQueue = jQuery.event.handlers.call( this, event, handlers );
  
      // Run delegates first; they may want to stop propagation beneath us
      i = 0;
      while ( ( matched = handlerQueue[ i++ ] ) && !event.isPropagationStopped() ) {
        event.currentTarget = matched.elem;
  
        j = 0;
        while ( ( handleObj = matched.handlers[ j++ ] ) &&
          !event.isImmediatePropagationStopped() ) {
  
          // If the event is namespaced, then each handler is only invoked if it is
          // specially universal or its namespaces are a superset of the event's.
          if ( !event.rnamespace || handleObj.namespace === false ||
            event.rnamespace.test( handleObj.namespace ) ) {
  
            event.handleObj = handleObj;
            event.data = handleObj.data;
  
            ret = ( ( jQuery.event.special[ handleObj.origType ] || {} ).handle ||
              handleObj.handler ).apply( matched.elem, args );
  
            if ( ret !== undefined ) {
              if ( ( event.result = ret ) === false ) {
                event.preventDefault();
                event.stopPropagation();
              }
            }
          }
        }
      }
  
      // Call the postDispatch hook for the mapped type
      if ( special.postDispatch ) {
        special.postDispatch.call( this, event );
      }
  
      return event.result;
    },
  
    handlers: function( event, handlers ) {
      var i, handleObj, sel, matchedHandlers, matchedSelectors,
        handlerQueue = [],
        delegateCount = handlers.delegateCount,
        cur = event.target;
  
      // Find delegate handlers
      if ( delegateCount &&
  
        // Support: IE <=9
        // Black-hole SVG <use> instance trees (trac-13180)
        cur.nodeType &&
  
        // Support: Firefox <=42
        // Suppress spec-violating clicks indicating a non-primary pointer button (trac-3861)
        // https://www.w3.org/TR/DOM-Level-3-Events/#event-type-click
        // Support: IE 11 only
        // ...but not arrow key "clicks" of radio inputs, which can have `button` -1 (gh-2343)
        !( event.type === "click" && event.button >= 1 ) ) {
  
        for ( ; cur !== this; cur = cur.parentNode || this ) {
  
          // Don't check non-elements (#13208)
          // Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
          if ( cur.nodeType === 1 && !( event.type === "click" && cur.disabled === true ) ) {
            matchedHandlers = [];
            matchedSelectors = {};
            for ( i = 0; i < delegateCount; i++ ) {
              handleObj = handlers[ i ];
  
              // Don't conflict with Object.prototype properties (#13203)
              sel = handleObj.selector + " ";
  
              if ( matchedSelectors[ sel ] === undefined ) {
                matchedSelectors[ sel ] = handleObj.needsContext ?
                  jQuery( sel, this ).index( cur ) > -1 :
                  jQuery.find( sel, this, null, [ cur ] ).length;
              }
              if ( matchedSelectors[ sel ] ) {
                matchedHandlers.push( handleObj );
              }
            }
            if ( matchedHandlers.length ) {
              handlerQueue.push( { elem: cur, handlers: matchedHandlers } );
            }
          }
        }
      }
  
      // Add the remaining (directly-bound) handlers
      cur = this;
      if ( delegateCount < handlers.length ) {
        handlerQueue.push( { elem: cur, handlers: handlers.slice( delegateCount ) } );
      }
  
      return handlerQueue;
    },
  
    addProp: function( name, hook ) {
      Object.defineProperty( jQuery.Event.prototype, name, {
        enumerable: true,
        configurable: true,
  
        get: isFunction( hook ) ?
          function() {
            if ( this.originalEvent ) {
                return hook( this.originalEvent );
            }
          } :
          function() {
            if ( this.originalEvent ) {
                return this.originalEvent[ name ];
            }
          },
  
        set: function( value ) {
          Object.defineProperty( this, name, {
            enumerable: true,
            configurable: true,
            writable: true,
            value: value
          } );
        }
      } );
    },
  
    fix: function( originalEvent ) {
      return originalEvent[ jQuery.expando ] ?
        originalEvent :
        new jQuery.Event( originalEvent );
    },
  
    special: {
      load: {
  
        // Prevent triggered image.load events from bubbling to window.load
        noBubble: true
      },
      click: {
  
        // Utilize native event to ensure correct state for checkable inputs
        setup: function( data ) {
  
          // For mutual compressibility with _default, replace `this` access with a local var.
          // `|| data` is dead code meant only to preserve the variable through minification.
          var el = this || data;
  
          // Claim the first handler
          if ( rcheckableType.test( el.type ) &&
            el.click && nodeName( el, "input" ) ) {
  
            // dataPriv.set( el, "click", ... )
            leverageNative( el, "click", returnTrue );
          }
  
          // Return false to allow normal processing in the caller
          return false;
        },
        trigger: function( data ) {
  
          // For mutual compressibility with _default, replace `this` access with a local var.
          // `|| data` is dead code meant only to preserve the variable through minification.
          var el = this || data;
  
          // Force setup before triggering a click
          if ( rcheckableType.test( el.type ) &&
            el.click && nodeName( el, "input" ) ) {
  
            leverageNative( el, "click" );
          }
  
          // Return non-false to allow normal event-path propagation
          return true;
        },
  
        // For cross-browser consistency, suppress native .click() on links
        // Also prevent it if we're currently inside a leveraged native-event stack
        _default: function( event ) {
          var target = event.target;
          return rcheckableType.test( target.type ) &&
            target.click && nodeName( target, "input" ) &&
            dataPriv.get( target, "click" ) ||
            nodeName( target, "a" );
        }
      },
  
      beforeunload: {
        postDispatch: function( event ) {
  
          // Support: Firefox 20+
          // Firefox doesn't alert if the returnValue field is not set.
          if ( event.result !== undefined && event.originalEvent ) {
            event.originalEvent.returnValue = event.result;
          }
        }
      }
    }
  };
  
  // Ensure the presence of an event listener that handles manually-triggered
  // synthetic events by interrupting progress until reinvoked in response to
  // *native* events that it fires directly, ensuring that state changes have
  // already occurred before other listeners are invoked.
  function leverageNative( el, type, expectSync ) {
  
    // Missing expectSync indicates a trigger call, which must force setup through jQuery.event.add
    if ( !expectSync ) {
      if ( dataPriv.get( el, type ) === undefined ) {
        jQuery.event.add( el, type, returnTrue );
      }
      return;
    }
  
    // Register the controller as a special universal handler for all event namespaces
    dataPriv.set( el, type, false );
    jQuery.event.add( el, type, {
      namespace: false,
      handler: function( event ) {
        var notAsync, result,
          saved = dataPriv.get( this, type );
  
        if ( ( event.isTrigger & 1 ) && this[ type ] ) {
  
          // Interrupt processing of the outer synthetic .trigger()ed event
          // Saved data should be false in such cases, but might be a leftover capture object
          // from an async native handler (gh-4350)
          if ( !saved.length ) {
  
            // Store arguments for use when handling the inner native event
            // There will always be at least one argument (an event object), so this array
            // will not be confused with a leftover capture object.
            saved = slice.call( arguments );
            dataPriv.set( this, type, saved );
  
            // Trigger the native event and capture its result
            // Support: IE <=9 - 11+
            // focus() and blur() are asynchronous
            notAsync = expectSync( this, type );
            this[ type ]();
            result = dataPriv.get( this, type );
            if ( saved !== result || notAsync ) {
              dataPriv.set( this, type, false );
            } else {
              result = {};
            }
            if ( saved !== result ) {
  
              // Cancel the outer synthetic event
              event.stopImmediatePropagation();
              event.preventDefault();
              return result.value;
            }
  
          // If this is an inner synthetic event for an event with a bubbling surrogate
          // (focus or blur), assume that the surrogate already propagated from triggering the
          // native event and prevent that from happening again here.
          // This technically gets the ordering wrong w.r.t. to `.trigger()` (in which the
          // bubbling surrogate propagates *after* the non-bubbling base), but that seems
          // less bad than duplication.
          } else if ( ( jQuery.event.special[ type ] || {} ).delegateType ) {
            event.stopPropagation();
          }
  
        // If this is a native event triggered above, everything is now in order
        // Fire an inner synthetic event with the original arguments
        } else if ( saved.length ) {
  
          // ...and capture the result
          dataPriv.set( this, type, {
            value: jQuery.event.trigger(
  
              // Support: IE <=9 - 11+
              // Extend with the prototype to reset the above stopImmediatePropagation()
              jQuery.extend( saved[ 0 ], jQuery.Event.prototype ),
              saved.slice( 1 ),
              this
            )
          } );
  
          // Abort handling of the native event
          event.stopImmediatePropagation();
        }
      }
    } );
  }
  
  jQuery.removeEvent = function( elem, type, handle ) {
  
    // This "if" is needed for plain objects
    if ( elem.removeEventListener ) {
      elem.removeEventListener( type, handle );
    }
  };
  
  jQuery.Event = function( src, props ) {
  
    // Allow instantiation without the 'new' keyword
    if ( !( this instanceof jQuery.Event ) ) {
      return new jQuery.Event( src, props );
    }
  
    // Event object
    if ( src && src.type ) {
      this.originalEvent = src;
      this.type = src.type;
  
      // Events bubbling up the document may have been marked as prevented
      // by a handler lower down the tree; reflect the correct value.
      this.isDefaultPrevented = src.defaultPrevented ||
          src.defaultPrevented === undefined &&
  
          // Support: Android <=2.3 only
          src.returnValue === false ?
        returnTrue :
        returnFalse;
  
      // Create target properties
      // Support: Safari <=6 - 7 only
      // Target should not be a text node (#504, #13143)
      this.target = ( src.target && src.target.nodeType === 3 ) ?
        src.target.parentNode :
        src.target;
  
      this.currentTarget = src.currentTarget;
      this.relatedTarget = src.relatedTarget;
  
    // Event type
    } else {
      this.type = src;
    }
  
    // Put explicitly provided properties onto the event object
    if ( props ) {
      jQuery.extend( this, props );
    }
  
    // Create a timestamp if incoming event doesn't have one
    this.timeStamp = src && src.timeStamp || Date.now();
  
    // Mark it as fixed
    this[ jQuery.expando ] = true;
  };
  
  // jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
  // https://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
  jQuery.Event.prototype = {
    constructor: jQuery.Event,
    isDefaultPrevented: returnFalse,
    isPropagationStopped: returnFalse,
    isImmediatePropagationStopped: returnFalse,
    isSimulated: false,
  
    preventDefault: function() {
      var e = this.originalEvent;
  
      this.isDefaultPrevented = returnTrue;
  
      if ( e && !this.isSimulated ) {
        e.preventDefault();
      }
    },
    stopPropagation: function() {
      var e = this.originalEvent;
  
      this.isPropagationStopped = returnTrue;
  
      if ( e && !this.isSimulated ) {
        e.stopPropagation();
      }
    },
    stopImmediatePropagation: function() {
      var e = this.originalEvent;
  
      this.isImmediatePropagationStopped = returnTrue;
  
      if ( e && !this.isSimulated ) {
        e.stopImmediatePropagation();
      }
  
      this.stopPropagation();
    }
  };
  
  // Includes all common event props including KeyEvent and MouseEvent specific props
  jQuery.each( {
    altKey: true,
    bubbles: true,
    cancelable: true,
    changedTouches: true,
    ctrlKey: true,
    detail: true,
    eventPhase: true,
    metaKey: true,
    pageX: true,
    pageY: true,
    shiftKey: true,
    view: true,
    "char": true,
    code: true,
    charCode: true,
    key: true,
    keyCode: true,
    button: true,
    buttons: true,
    clientX: true,
    clientY: true,
    offsetX: true,
    offsetY: true,
    pointerId: true,
    pointerType: true,
    screenX: true,
    screenY: true,
    targetTouches: true,
    toElement: true,
    touches: true,
  
    which: function( event ) {
      var button = event.button;
  
      // Add which for key events
      if ( event.which == null && rkeyEvent.test( event.type ) ) {
        return event.charCode != null ? event.charCode : event.keyCode;
      }
  
      // Add which for click: 1 === left; 2 === middle; 3 === right
      if ( !event.which && button !== undefined && rmouseEvent.test( event.type ) ) {
        if ( button & 1 ) {
          return 1;
        }
  
        if ( button & 2 ) {
          return 3;
        }
  
        if ( button & 4 ) {
          return 2;
        }
  
        return 0;
      }
  
      return event.which;
    }
  }, jQuery.event.addProp );
  
  jQuery.each( { focus: "focusin", blur: "focusout" }, function( type, delegateType ) {
    jQuery.event.special[ type ] = {
  
      // Utilize native event if possible so blur/focus sequence is correct
      setup: function() {
  
        // Claim the first handler
        // dataPriv.set( this, "focus", ... )
        // dataPriv.set( this, "blur", ... )
        leverageNative( this, type, expectSync );
  
        // Return false to allow normal processing in the caller
        return false;
      },
      trigger: function() {
  
        // Force setup before trigger
        leverageNative( this, type );
  
        // Return non-false to allow normal event-path propagation
        return true;
      },
  
      delegateType: delegateType
    };
  } );
  
  // Create mouseenter/leave events using mouseover/out and event-time checks
  // so that event delegation works in jQuery.
  // Do the same for pointerenter/pointerleave and pointerover/pointerout
  //
  // Support: Safari 7 only
  // Safari sends mouseenter too often; see:
  // https://bugs.chromium.org/p/chromium/issues/detail?id=470258
  // for the description of the bug (it existed in older Chrome versions as well).
  jQuery.each( {
    mouseenter: "mouseover",
    mouseleave: "mouseout",
    pointerenter: "pointerover",
    pointerleave: "pointerout"
  }, function( orig, fix ) {
    jQuery.event.special[ orig ] = {
      delegateType: fix,
      bindType: fix,
  
      handle: function( event ) {
        var ret,
          target = this,
          related = event.relatedTarget,
          handleObj = event.handleObj;
  
        // For mouseenter/leave call the handler if related is outside the target.
        // NB: No relatedTarget if the mouse left/entered the browser window
        if ( !related || ( related !== target && !jQuery.contains( target, related ) ) ) {
          event.type = handleObj.origType;
          ret = handleObj.handler.apply( this, arguments );
          event.type = fix;
        }
        return ret;
      }
    };
  } );
  
  jQuery.fn.extend( {
  
    on: function( types, selector, data, fn ) {
      return on( this, types, selector, data, fn );
    },
    one: function( types, selector, data, fn ) {
      return on( this, types, selector, data, fn, 1 );
    },
    off: function( types, selector, fn ) {
      var handleObj, type;
      if ( types && types.preventDefault && types.handleObj ) {
  
        // ( event )  dispatched jQuery.Event
        handleObj = types.handleObj;
        jQuery( types.delegateTarget ).off(
          handleObj.namespace ?
            handleObj.origType + "." + handleObj.namespace :
            handleObj.origType,
          handleObj.selector,
          handleObj.handler
        );
        return this;
      }
      if ( typeof types === "object" ) {
  
        // ( types-object [, selector] )
        for ( type in types ) {
          this.off( type, selector, types[ type ] );
        }
        return this;
      }
      if ( selector === false || typeof selector === "function" ) {
  
        // ( types [, fn] )
        fn = selector;
        selector = undefined;
      }
      if ( fn === false ) {
        fn = returnFalse;
      }
      return this.each( function() {
        jQuery.event.remove( this, types, fn, selector );
      } );
    }
  } );
  
  
  var
  
    // Support: IE <=10 - 11, Edge 12 - 13 only
    // In IE/Edge using regex groups here causes severe slowdowns.
    // See https://connect.microsoft.com/IE/feedback/details/1736512/
    rnoInnerhtml = /<script|<style|<link/i,
  
    // checked="checked" or checked
    rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
    rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;
  
  // Prefer a tbody over its parent table for containing new rows
  function manipulationTarget( elem, content ) {
    if ( nodeName( elem, "table" ) &&
      nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ) {
  
      return jQuery( elem ).children( "tbody" )[ 0 ] || elem;
    }
  
    return elem;
  }
  
  // Replace/restore the type attribute of script elements for safe DOM manipulation
  function disableScript( elem ) {
    elem.type = ( elem.getAttribute( "type" ) !== null ) + "/" + elem.type;
    return elem;
  }
  function restoreScript( elem ) {
    if ( ( elem.type || "" ).slice( 0, 5 ) === "true/" ) {
      elem.type = elem.type.slice( 5 );
    } else {
      elem.removeAttribute( "type" );
    }
  
    return elem;
  }
  
  function cloneCopyEvent( src, dest ) {
    var i, l, type, pdataOld, udataOld, udataCur, events;
  
    if ( dest.nodeType !== 1 ) {
      return;
    }
  
    // 1. Copy private data: events, handlers, etc.
    if ( dataPriv.hasData( src ) ) {
      pdataOld = dataPriv.get( src );
      events = pdataOld.events;
  
      if ( events ) {
        dataPriv.remove( dest, "handle events" );
  
        for ( type in events ) {
          for ( i = 0, l = events[ type ].length; i < l; i++ ) {
            jQuery.event.add( dest, type, events[ type ][ i ] );
          }
        }
      }
    }
  
    // 2. Copy user data
    if ( dataUser.hasData( src ) ) {
      udataOld = dataUser.access( src );
      udataCur = jQuery.extend( {}, udataOld );
  
      dataUser.set( dest, udataCur );
    }
  }
  
  // Fix IE bugs, see support tests
  function fixInput( src, dest ) {
    var nodeName = dest.nodeName.toLowerCase();
  
    // Fails to persist the checked state of a cloned checkbox or radio button.
    if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
      dest.checked = src.checked;
  
    // Fails to return the selected option to the default selected state when cloning options
    } else if ( nodeName === "input" || nodeName === "textarea" ) {
      dest.defaultValue = src.defaultValue;
    }
  }
  
  function domManip( collection, args, callback, ignored ) {
  
    // Flatten any nested arrays
    args = flat( args );
  
    var fragment, first, scripts, hasScripts, node, doc,
      i = 0,
      l = collection.length,
      iNoClone = l - 1,
      value = args[ 0 ],
      valueIsFunction = isFunction( value );
  
    // We can't cloneNode fragments that contain checked, in WebKit
    if ( valueIsFunction ||
        ( l > 1 && typeof value === "string" &&
          !support.checkClone && rchecked.test( value ) ) ) {
      return collection.each( function( index ) {
        var self = collection.eq( index );
        if ( valueIsFunction ) {
          args[ 0 ] = value.call( this, index, self.html() );
        }
        domManip( self, args, callback, ignored );
      } );
    }
  
    if ( l ) {
      fragment = buildFragment( args, collection[ 0 ].ownerDocument, false, collection, ignored );
      first = fragment.firstChild;
  
      if ( fragment.childNodes.length === 1 ) {
        fragment = first;
      }
  
      // Require either new content or an interest in ignored elements to invoke the callback
      if ( first || ignored ) {
        scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
        hasScripts = scripts.length;
  
        // Use the original fragment for the last item
        // instead of the first because it can end up
        // being emptied incorrectly in certain situations (#8070).
        for ( ; i < l; i++ ) {
          node = fragment;
  
          if ( i !== iNoClone ) {
            node = jQuery.clone( node, true, true );
  
            // Keep references to cloned scripts for later restoration
            if ( hasScripts ) {
  
              // Support: Android <=4.0 only, PhantomJS 1 only
              // push.apply(_, arraylike) throws on ancient WebKit
              jQuery.merge( scripts, getAll( node, "script" ) );
            }
          }
  
          callback.call( collection[ i ], node, i );
        }
  
        if ( hasScripts ) {
          doc = scripts[ scripts.length - 1 ].ownerDocument;
  
          // Reenable scripts
          jQuery.map( scripts, restoreScript );
  
          // Evaluate executable scripts on first document insertion
          for ( i = 0; i < hasScripts; i++ ) {
            node = scripts[ i ];
            if ( rscriptType.test( node.type || "" ) &&
              !dataPriv.access( node, "globalEval" ) &&
              jQuery.contains( doc, node ) ) {
  
              if ( node.src && ( node.type || "" ).toLowerCase()  !== "module" ) {
  
                // Optional AJAX dependency, but won't run scripts if not present
                if ( jQuery._evalUrl && !node.noModule ) {
                  jQuery._evalUrl( node.src, {
                    nonce: node.nonce || node.getAttribute( "nonce" )
                  }, doc );
                }
              } else {
                DOMEval( node.textContent.replace( rcleanScript, "" ), node, doc );
              }
            }
          }
        }
      }
    }
  
    return collection;
  }
  
  function remove( elem, selector, keepData ) {
    var node,
      nodes = selector ? jQuery.filter( selector, elem ) : elem,
      i = 0;
  
    for ( ; ( node = nodes[ i ] ) != null; i++ ) {
      if ( !keepData && node.nodeType === 1 ) {
        jQuery.cleanData( getAll( node ) );
      }
  
      if ( node.parentNode ) {
        if ( keepData && isAttached( node ) ) {
          setGlobalEval( getAll( node, "script" ) );
        }
        node.parentNode.removeChild( node );
      }
    }
  
    return elem;
  }
  
  jQuery.extend( {
    htmlPrefilter: function( html ) {
      return html;
    },
  
    clone: function( elem, dataAndEvents, deepDataAndEvents ) {
      var i, l, srcElements, destElements,
        clone = elem.cloneNode( true ),
        inPage = isAttached( elem );
  
      // Fix IE cloning issues
      if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
          !jQuery.isXMLDoc( elem ) ) {
  
        // We eschew Sizzle here for performance reasons: https://jsperf.com/getall-vs-sizzle/2
        destElements = getAll( clone );
        srcElements = getAll( elem );
  
        for ( i = 0, l = srcElements.length; i < l; i++ ) {
          fixInput( srcElements[ i ], destElements[ i ] );
        }
      }
  
      // Copy the events from the original to the clone
      if ( dataAndEvents ) {
        if ( deepDataAndEvents ) {
          srcElements = srcElements || getAll( elem );
          destElements = destElements || getAll( clone );
  
          for ( i = 0, l = srcElements.length; i < l; i++ ) {
            cloneCopyEvent( srcElements[ i ], destElements[ i ] );
          }
        } else {
          cloneCopyEvent( elem, clone );
        }
      }
  
      // Preserve script evaluation history
      destElements = getAll( clone, "script" );
      if ( destElements.length > 0 ) {
        setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
      }
  
      // Return the cloned set
      return clone;
    },
  
    cleanData: function( elems ) {
      var data, elem, type,
        special = jQuery.event.special,
        i = 0;
  
      for ( ; ( elem = elems[ i ] ) !== undefined; i++ ) {
        if ( acceptData( elem ) ) {
          if ( ( data = elem[ dataPriv.expando ] ) ) {
            if ( data.events ) {
              for ( type in data.events ) {
                if ( special[ type ] ) {
                  jQuery.event.remove( elem, type );
  
                // This is a shortcut to avoid jQuery.event.remove's overhead
                } else {
                  jQuery.removeEvent( elem, type, data.handle );
                }
              }
            }
  
            // Support: Chrome <=35 - 45+
            // Assign undefined instead of using delete, see Data#remove
            elem[ dataPriv.expando ] = undefined;
          }
          if ( elem[ dataUser.expando ] ) {
  
            // Support: Chrome <=35 - 45+
            // Assign undefined instead of using delete, see Data#remove
            elem[ dataUser.expando ] = undefined;
          }
        }
      }
    }
  } );
  
  jQuery.fn.extend( {
    detach: function( selector ) {
      return remove( this, selector, true );
    },
  
    remove: function( selector ) {
      return remove( this, selector );
    },
  
    text: function( value ) {
      return access( this, function( value ) {
        return value === undefined ?
          jQuery.text( this ) :
          this.empty().each( function() {
            if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
              this.textContent = value;
            }
          } );
      }, null, value, arguments.length );
    },
  
    append: function() {
      return domManip( this, arguments, function( elem ) {
        if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
          var target = manipulationTarget( this, elem );
          target.appendChild( elem );
        }
      } );
    },
  
    prepend: function() {
      return domManip( this, arguments, function( elem ) {
        if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
          var target = manipulationTarget( this, elem );
          target.insertBefore( elem, target.firstChild );
        }
      } );
    },
  
    before: function() {
      return domManip( this, arguments, function( elem ) {
        if ( this.parentNode ) {
          this.parentNode.insertBefore( elem, this );
        }
      } );
    },
  
    after: function() {
      return domManip( this, arguments, function( elem ) {
        if ( this.parentNode ) {
          this.parentNode.insertBefore( elem, this.nextSibling );
        }
      } );
    },
  
    empty: function() {
      var elem,
        i = 0;
  
      for ( ; ( elem = this[ i ] ) != null; i++ ) {
        if ( elem.nodeType === 1 ) {
  
          // Prevent memory leaks
          jQuery.cleanData( getAll( elem, false ) );
  
          // Remove any remaining nodes
          elem.textContent = "";
        }
      }
  
      return this;
    },
  
    clone: function( dataAndEvents, deepDataAndEvents ) {
      dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
      deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;
  
      return this.map( function() {
        return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
      } );
    },
  
    html: function( value ) {
      return access( this, function( value ) {
        var elem = this[ 0 ] || {},
          i = 0,
          l = this.length;
  
        if ( value === undefined && elem.nodeType === 1 ) {
          return elem.innerHTML;
        }
  
        // See if we can take a shortcut and just use innerHTML
        if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
          !wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {
  
          value = jQuery.htmlPrefilter( value );
  
          try {
            for ( ; i < l; i++ ) {
              elem = this[ i ] || {};
  
              // Remove element nodes and prevent memory leaks
              if ( elem.nodeType === 1 ) {
                jQuery.cleanData( getAll( elem, false ) );
                elem.innerHTML = value;
              }
            }
  
            elem = 0;
  
          // If using innerHTML throws an exception, use the fallback method
          } catch ( e ) {}
        }
  
        if ( elem ) {
          this.empty().append( value );
        }
      }, null, value, arguments.length );
    },
  
    replaceWith: function() {
      var ignored = [];
  
      // Make the changes, replacing each non-ignored context element with the new content
      return domManip( this, arguments, function( elem ) {
        var parent = this.parentNode;
  
        if ( jQuery.inArray( this, ignored ) < 0 ) {
          jQuery.cleanData( getAll( this ) );
          if ( parent ) {
            parent.replaceChild( elem, this );
          }
        }
  
      // Force callback invocation
      }, ignored );
    }
  } );
  
  jQuery.each( {
    appendTo: "append",
    prependTo: "prepend",
    insertBefore: "before",
    insertAfter: "after",
    replaceAll: "replaceWith"
  }, function( name, original ) {
    jQuery.fn[ name ] = function( selector ) {
      var elems,
        ret = [],
        insert = jQuery( selector ),
        last = insert.length - 1,
        i = 0;
  
      for ( ; i <= last; i++ ) {
        elems = i === last ? this : this.clone( true );
        jQuery( insert[ i ] )[ original ]( elems );
  
        // Support: Android <=4.0 only, PhantomJS 1 only
        // .get() because push.apply(_, arraylike) throws on ancient WebKit
        push.apply( ret, elems.get() );
      }
  
      return this.pushStack( ret );
    };
  } );
  var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );
  
  var getStyles = function( elem ) {
  
      // Support: IE <=11 only, Firefox <=30 (#15098, #14150)
      // IE throws on elements created in popups
      // FF meanwhile throws on frame elements through "defaultView.getComputedStyle"
      var view = elem.ownerDocument.defaultView;
  
      if ( !view || !view.opener ) {
        view = window;
      }
  
      return view.getComputedStyle( elem );
    };
  
  var swap = function( elem, options, callback ) {
    var ret, name,
      old = {};
  
    // Remember the old values, and insert the new ones
    for ( name in options ) {
      old[ name ] = elem.style[ name ];
      elem.style[ name ] = options[ name ];
    }
  
    ret = callback.call( elem );
  
    // Revert the old values
    for ( name in options ) {
      elem.style[ name ] = old[ name ];
    }
  
    return ret;
  };
  
  
  var rboxStyle = new RegExp( cssExpand.join( "|" ), "i" );
  
  
  
  ( function() {
  
    // Executing both pixelPosition & boxSizingReliable tests require only one layout
    // so they're executed at the same time to save the second computation.
    function computeStyleTests() {
  
      // This is a singleton, we need to execute it only once
      if ( !div ) {
        return;
      }
  
      container.style.cssText = "position:absolute;left:-11111px;width:60px;" +
        "margin-top:1px;padding:0;border:0";
      div.style.cssText =
        "position:relative;display:block;box-sizing:border-box;overflow:scroll;" +
        "margin:auto;border:1px;padding:1px;" +
        "width:60%;top:1%";
      documentElement.appendChild( container ).appendChild( div );
  
      var divStyle = window.getComputedStyle( div );
      pixelPositionVal = divStyle.top !== "1%";
  
      // Support: Android 4.0 - 4.3 only, Firefox <=3 - 44
      reliableMarginLeftVal = roundPixelMeasures( divStyle.marginLeft ) === 12;
  
      // Support: Android 4.0 - 4.3 only, Safari <=9.1 - 10.1, iOS <=7.0 - 9.3
      // Some styles come back with percentage values, even though they shouldn't
      div.style.right = "60%";
      pixelBoxStylesVal = roundPixelMeasures( divStyle.right ) === 36;
  
      // Support: IE 9 - 11 only
      // Detect misreporting of content dimensions for box-sizing:border-box elements
      boxSizingReliableVal = roundPixelMeasures( divStyle.width ) === 36;
  
      // Support: IE 9 only
      // Detect overflow:scroll screwiness (gh-3699)
      // Support: Chrome <=64
      // Don't get tricked when zoom affects offsetWidth (gh-4029)
      div.style.position = "absolute";
      scrollboxSizeVal = roundPixelMeasures( div.offsetWidth / 3 ) === 12;
  
      documentElement.removeChild( container );
  
      // Nullify the div so it wouldn't be stored in the memory and
      // it will also be a sign that checks already performed
      div = null;
    }
  
    function roundPixelMeasures( measure ) {
      return Math.round( parseFloat( measure ) );
    }
  
    var pixelPositionVal, boxSizingReliableVal, scrollboxSizeVal, pixelBoxStylesVal,
      reliableTrDimensionsVal, reliableMarginLeftVal,
      container = document.createElement( "div" ),
      div = document.createElement( "div" );
  
    // Finish early in limited (non-browser) environments
    if ( !div.style ) {
      return;
    }
  
    // Support: IE <=9 - 11 only
    // Style of cloned element affects source element cloned (#8908)
    div.style.backgroundClip = "content-box";
    div.cloneNode( true ).style.backgroundClip = "";
    support.clearCloneStyle = div.style.backgroundClip === "content-box";
  
    jQuery.extend( support, {
      boxSizingReliable: function() {
        computeStyleTests();
        return boxSizingReliableVal;
      },
      pixelBoxStyles: function() {
        computeStyleTests();
        return pixelBoxStylesVal;
      },
      pixelPosition: function() {
        computeStyleTests();
        return pixelPositionVal;
      },
      reliableMarginLeft: function() {
        computeStyleTests();
        return reliableMarginLeftVal;
      },
      scrollboxSize: function() {
        computeStyleTests();
        return scrollboxSizeVal;
      },
  
      // Support: IE 9 - 11+, Edge 15 - 18+
      // IE/Edge misreport `getComputedStyle` of table rows with width/height
      // set in CSS while `offset*` properties report correct values.
      // Behavior in IE 9 is more subtle than in newer versions & it passes
      // some versions of this test; make sure not to make it pass there!
      reliableTrDimensions: function() {
        var table, tr, trChild, trStyle;
        if ( reliableTrDimensionsVal == null ) {
          table = document.createElement( "table" );
          tr = document.createElement( "tr" );
          trChild = document.createElement( "div" );
  
          table.style.cssText = "position:absolute;left:-11111px";
          tr.style.height = "1px";
          trChild.style.height = "9px";
  
          documentElement
            .appendChild( table )
            .appendChild( tr )
            .appendChild( trChild );
  
          trStyle = window.getComputedStyle( tr );
          reliableTrDimensionsVal = parseInt( trStyle.height ) > 3;
  
          documentElement.removeChild( table );
        }
        return reliableTrDimensionsVal;
      }
    } );
  } )();
  
  
  function curCSS( elem, name, computed ) {
    var width, minWidth, maxWidth, ret,
  
      // Support: Firefox 51+
      // Retrieving style before computed somehow
      // fixes an issue with getting wrong values
      // on detached elements
      style = elem.style;
  
    computed = computed || getStyles( elem );
  
    // getPropertyValue is needed for:
    //   .css('filter') (IE 9 only, #12537)
    //   .css('--customProperty) (#3144)
    if ( computed ) {
      ret = computed.getPropertyValue( name ) || computed[ name ];
  
      if ( ret === "" && !isAttached( elem ) ) {
        ret = jQuery.style( elem, name );
      }
  
      // A tribute to the "awesome hack by Dean Edwards"
      // Android Browser returns percentage for some values,
      // but width seems to be reliably pixels.
      // This is against the CSSOM draft spec:
      // https://drafts.csswg.org/cssom/#resolved-values
      if ( !support.pixelBoxStyles() && rnumnonpx.test( ret ) && rboxStyle.test( name ) ) {
  
        // Remember the original values
        width = style.width;
        minWidth = style.minWidth;
        maxWidth = style.maxWidth;
  
        // Put in the new values to get a computed value out
        style.minWidth = style.maxWidth = style.width = ret;
        ret = computed.width;
  
        // Revert the changed values
        style.width = width;
        style.minWidth = minWidth;
        style.maxWidth = maxWidth;
      }
    }
  
    return ret !== undefined ?
  
      // Support: IE <=9 - 11 only
      // IE returns zIndex value as an integer.
      ret + "" :
      ret;
  }
  
  
  function addGetHookIf( conditionFn, hookFn ) {
  
    // Define the hook, we'll check on the first run if it's really needed.
    return {
      get: function() {
        if ( conditionFn() ) {
  
          // Hook not needed (or it's not possible to use it due
          // to missing dependency), remove it.
          delete this.get;
          return;
        }
  
        // Hook needed; redefine it so that the support test is not executed again.
        return ( this.get = hookFn ).apply( this, arguments );
      }
    };
  }
  
  
  var cssPrefixes = [ "Webkit", "Moz", "ms" ],
    emptyStyle = document.createElement( "div" ).style,
    vendorProps = {};
  
  // Return a vendor-prefixed property or undefined
  function vendorPropName( name ) {
  
    // Check for vendor prefixed names
    var capName = name[ 0 ].toUpperCase() + name.slice( 1 ),
      i = cssPrefixes.length;
  
    while ( i-- ) {
      name = cssPrefixes[ i ] + capName;
      if ( name in emptyStyle ) {
        return name;
      }
    }
  }
  
  // Return a potentially-mapped jQuery.cssProps or vendor prefixed property
  function finalPropName( name ) {
    var final = jQuery.cssProps[ name ] || vendorProps[ name ];
  
    if ( final ) {
      return final;
    }
    if ( name in emptyStyle ) {
      return name;
    }
    return vendorProps[ name ] = vendorPropName( name ) || name;
  }
  
  
  var
  
    // Swappable if display is none or starts with table
    // except "table", "table-cell", or "table-caption"
    // See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
    rdisplayswap = /^(none|table(?!-c[ea]).+)/,
    rcustomProp = /^--/,
    cssShow = { position: "absolute", visibility: "hidden", display: "block" },
    cssNormalTransform = {
      letterSpacing: "0",
      fontWeight: "400"
    };
  
  function setPositiveNumber( _elem, value, subtract ) {
  
    // Any relative (+/-) values have already been
    // normalized at this point
    var matches = rcssNum.exec( value );
    return matches ?
  
      // Guard against undefined "subtract", e.g., when used as in cssHooks
      Math.max( 0, matches[ 2 ] - ( subtract || 0 ) ) + ( matches[ 3 ] || "px" ) :
      value;
  }
  
  function boxModelAdjustment( elem, dimension, box, isBorderBox, styles, computedVal ) {
    var i = dimension === "width" ? 1 : 0,
      extra = 0,
      delta = 0;
  
    // Adjustment may not be necessary
    if ( box === ( isBorderBox ? "border" : "content" ) ) {
      return 0;
    }
  
    for ( ; i < 4; i += 2 ) {
  
      // Both box models exclude margin
      if ( box === "margin" ) {
        delta += jQuery.css( elem, box + cssExpand[ i ], true, styles );
      }
  
      // If we get here with a content-box, we're seeking "padding" or "border" or "margin"
      if ( !isBorderBox ) {
  
        // Add padding
        delta += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
  
        // For "border" or "margin", add border
        if ( box !== "padding" ) {
          delta += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
  
        // But still keep track of it otherwise
        } else {
          extra += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
        }
  
      // If we get here with a border-box (content + padding + border), we're seeking "content" or
      // "padding" or "margin"
      } else {
  
        // For "content", subtract padding
        if ( box === "content" ) {
          delta -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
        }
  
        // For "content" or "padding", subtract border
        if ( box !== "margin" ) {
          delta -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
        }
      }
    }
  
    // Account for positive content-box scroll gutter when requested by providing computedVal
    if ( !isBorderBox && computedVal >= 0 ) {
  
      // offsetWidth/offsetHeight is a rounded sum of content, padding, scroll gutter, and border
      // Assuming integer scroll gutter, subtract the rest and round down
      delta += Math.max( 0, Math.ceil(
        elem[ "offset" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -
        computedVal -
        delta -
        extra -
        0.5
  
      // If offsetWidth/offsetHeight is unknown, then we can't determine content-box scroll gutter
      // Use an explicit zero to avoid NaN (gh-3964)
      ) ) || 0;
    }
  
    return delta;
  }
  
  function getWidthOrHeight( elem, dimension, extra ) {
  
    // Start with computed style
    var styles = getStyles( elem ),
  
      // To avoid forcing a reflow, only fetch boxSizing if we need it (gh-4322).
      // Fake content-box until we know it's needed to know the true value.
      boxSizingNeeded = !support.boxSizingReliable() || extra,
      isBorderBox = boxSizingNeeded &&
        jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
      valueIsBorderBox = isBorderBox,
  
      val = curCSS( elem, dimension, styles ),
      offsetProp = "offset" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 );
  
    // Support: Firefox <=54
    // Return a confounding non-pixel value or feign ignorance, as appropriate.
    if ( rnumnonpx.test( val ) ) {
      if ( !extra ) {
        return val;
      }
      val = "auto";
    }
  
  
    // Support: IE 9 - 11 only
    // Use offsetWidth/offsetHeight for when box sizing is unreliable.
    // In those cases, the computed value can be trusted to be border-box.
    if ( ( !support.boxSizingReliable() && isBorderBox ||
  
      // Support: IE 10 - 11+, Edge 15 - 18+
      // IE/Edge misreport `getComputedStyle` of table rows with width/height
      // set in CSS while `offset*` properties report correct values.
      // Interestingly, in some cases IE 9 doesn't suffer from this issue.
      !support.reliableTrDimensions() && nodeName( elem, "tr" ) ||
  
      // Fall back to offsetWidth/offsetHeight when value is "auto"
      // This happens for inline elements with no explicit setting (gh-3571)
      val === "auto" ||
  
      // Support: Android <=4.1 - 4.3 only
      // Also use offsetWidth/offsetHeight for misreported inline dimensions (gh-3602)
      !parseFloat( val ) && jQuery.css( elem, "display", false, styles ) === "inline" ) &&
  
      // Make sure the element is visible & connected
      elem.getClientRects().length ) {
  
      isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";
  
      // Where available, offsetWidth/offsetHeight approximate border box dimensions.
      // Where not available (e.g., SVG), assume unreliable box-sizing and interpret the
      // retrieved value as a content box dimension.
      valueIsBorderBox = offsetProp in elem;
      if ( valueIsBorderBox ) {
        val = elem[ offsetProp ];
      }
    }
  
    // Normalize "" and auto
    val = parseFloat( val ) || 0;
  
    // Adjust for the element's box model
    return ( val +
      boxModelAdjustment(
        elem,
        dimension,
        extra || ( isBorderBox ? "border" : "content" ),
        valueIsBorderBox,
        styles,
  
        // Provide the current computed size to request scroll gutter calculation (gh-3589)
        val
      )
    ) + "px";
  }
  
  jQuery.extend( {
  
    // Add in style property hooks for overriding the default
    // behavior of getting and setting a style property
    cssHooks: {
      opacity: {
        get: function( elem, computed ) {
          if ( computed ) {
  
            // We should always get a number back from opacity
            var ret = curCSS( elem, "opacity" );
            return ret === "" ? "1" : ret;
          }
        }
      }
    },
  
    // Don't automatically add "px" to these possibly-unitless properties
    cssNumber: {
      "animationIterationCount": true,
      "columnCount": true,
      "fillOpacity": true,
      "flexGrow": true,
      "flexShrink": true,
      "fontWeight": true,
      "gridArea": true,
      "gridColumn": true,
      "gridColumnEnd": true,
      "gridColumnStart": true,
      "gridRow": true,
      "gridRowEnd": true,
      "gridRowStart": true,
      "lineHeight": true,
      "opacity": true,
      "order": true,
      "orphans": true,
      "widows": true,
      "zIndex": true,
      "zoom": true
    },
  
    // Add in properties whose names you wish to fix before
    // setting or getting the value
    cssProps: {},
  
    // Get and set the style property on a DOM Node
    style: function( elem, name, value, extra ) {
  
      // Don't set styles on text and comment nodes
      if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
        return;
      }
  
      // Make sure that we're working with the right name
      var ret, type, hooks,
        origName = camelCase( name ),
        isCustomProp = rcustomProp.test( name ),
        style = elem.style;
  
      // Make sure that we're working with the right name. We don't
      // want to query the value if it is a CSS custom property
      // since they are user-defined.
      if ( !isCustomProp ) {
        name = finalPropName( origName );
      }
  
      // Gets hook for the prefixed version, then unprefixed version
      hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];
  
      // Check if we're setting a value
      if ( value !== undefined ) {
        type = typeof value;
  
        // Convert "+=" or "-=" to relative numbers (#7345)
        if ( type === "string" && ( ret = rcssNum.exec( value ) ) && ret[ 1 ] ) {
          value = adjustCSS( elem, name, ret );
  
          // Fixes bug #9237
          type = "number";
        }
  
        // Make sure that null and NaN values aren't set (#7116)
        if ( value == null || value !== value ) {
          return;
        }
  
        // If a number was passed in, add the unit (except for certain CSS properties)
        // The isCustomProp check can be removed in jQuery 4.0 when we only auto-append
        // "px" to a few hardcoded values.
        if ( type === "number" && !isCustomProp ) {
          value += ret && ret[ 3 ] || ( jQuery.cssNumber[ origName ] ? "" : "px" );
        }
  
        // background-* props affect original clone's values
        if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
          style[ name ] = "inherit";
        }
  
        // If a hook was provided, use that value, otherwise just set the specified value
        if ( !hooks || !( "set" in hooks ) ||
          ( value = hooks.set( elem, value, extra ) ) !== undefined ) {
  
          if ( isCustomProp ) {
            style.setProperty( name, value );
          } else {
            style[ name ] = value;
          }
        }
  
      } else {
  
        // If a hook was provided get the non-computed value from there
        if ( hooks && "get" in hooks &&
          ( ret = hooks.get( elem, false, extra ) ) !== undefined ) {
  
          return ret;
        }
  
        // Otherwise just get the value from the style object
        return style[ name ];
      }
    },
  
    css: function( elem, name, extra, styles ) {
      var val, num, hooks,
        origName = camelCase( name ),
        isCustomProp = rcustomProp.test( name );
  
      // Make sure that we're working with the right name. We don't
      // want to modify the value if it is a CSS custom property
      // since they are user-defined.
      if ( !isCustomProp ) {
        name = finalPropName( origName );
      }
  
      // Try prefixed name followed by the unprefixed name
      hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];
  
      // If a hook was provided get the computed value from there
      if ( hooks && "get" in hooks ) {
        val = hooks.get( elem, true, extra );
      }
  
      // Otherwise, if a way to get the computed value exists, use that
      if ( val === undefined ) {
        val = curCSS( elem, name, styles );
      }
  
      // Convert "normal" to computed value
      if ( val === "normal" && name in cssNormalTransform ) {
        val = cssNormalTransform[ name ];
      }
  
      // Make numeric if forced or a qualifier was provided and val looks numeric
      if ( extra === "" || extra ) {
        num = parseFloat( val );
        return extra === true || isFinite( num ) ? num || 0 : val;
      }
  
      return val;
    }
  } );
  
  jQuery.each( [ "height", "width" ], function( _i, dimension ) {
    jQuery.cssHooks[ dimension ] = {
      get: function( elem, computed, extra ) {
        if ( computed ) {
  
          // Certain elements can have dimension info if we invisibly show them
          // but it must have a current display style that would benefit
          return rdisplayswap.test( jQuery.css( elem, "display" ) ) &&
  
            // Support: Safari 8+
            // Table columns in Safari have non-zero offsetWidth & zero
            // getBoundingClientRect().width unless display is changed.
            // Support: IE <=11 only
            // Running getBoundingClientRect on a disconnected node
            // in IE throws an error.
            ( !elem.getClientRects().length || !elem.getBoundingClientRect().width ) ?
              swap( elem, cssShow, function() {
                return getWidthOrHeight( elem, dimension, extra );
              } ) :
              getWidthOrHeight( elem, dimension, extra );
        }
      },
  
      set: function( elem, value, extra ) {
        var matches,
          styles = getStyles( elem ),
  
          // Only read styles.position if the test has a chance to fail
          // to avoid forcing a reflow.
          scrollboxSizeBuggy = !support.scrollboxSize() &&
            styles.position === "absolute",
  
          // To avoid forcing a reflow, only fetch boxSizing if we need it (gh-3991)
          boxSizingNeeded = scrollboxSizeBuggy || extra,
          isBorderBox = boxSizingNeeded &&
            jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
          subtract = extra ?
            boxModelAdjustment(
              elem,
              dimension,
              extra,
              isBorderBox,
              styles
            ) :
            0;
  
        // Account for unreliable border-box dimensions by comparing offset* to computed and
        // faking a content-box to get border and padding (gh-3699)
        if ( isBorderBox && scrollboxSizeBuggy ) {
          subtract -= Math.ceil(
            elem[ "offset" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -
            parseFloat( styles[ dimension ] ) -
            boxModelAdjustment( elem, dimension, "border", false, styles ) -
            0.5
          );
        }
  
        // Convert to pixels if value adjustment is needed
        if ( subtract && ( matches = rcssNum.exec( value ) ) &&
          ( matches[ 3 ] || "px" ) !== "px" ) {
  
          elem.style[ dimension ] = value;
          value = jQuery.css( elem, dimension );
        }
  
        return setPositiveNumber( elem, value, subtract );
      }
    };
  } );
  
  jQuery.cssHooks.marginLeft = addGetHookIf( support.reliableMarginLeft,
    function( elem, computed ) {
      if ( computed ) {
        return ( parseFloat( curCSS( elem, "marginLeft" ) ) ||
          elem.getBoundingClientRect().left -
            swap( elem, { marginLeft: 0 }, function() {
              return elem.getBoundingClientRect().left;
            } )
          ) + "px";
      }
    }
  );
  
  // These hooks are used by animate to expand properties
  jQuery.each( {
    margin: "",
    padding: "",
    border: "Width"
  }, function( prefix, suffix ) {
    jQuery.cssHooks[ prefix + suffix ] = {
      expand: function( value ) {
        var i = 0,
          expanded = {},
  
          // Assumes a single number if not a string
          parts = typeof value === "string" ? value.split( " " ) : [ value ];
  
        for ( ; i < 4; i++ ) {
          expanded[ prefix + cssExpand[ i ] + suffix ] =
            parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
        }
  
        return expanded;
      }
    };
  
    if ( prefix !== "margin" ) {
      jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
    }
  } );
  
  jQuery.fn.extend( {
    css: function( name, value ) {
      return access( this, function( elem, name, value ) {
        var styles, len,
          map = {},
          i = 0;
  
        if ( Array.isArray( name ) ) {
          styles = getStyles( elem );
          len = name.length;
  
          for ( ; i < len; i++ ) {
            map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
          }
  
          return map;
        }
  
        return value !== undefined ?
          jQuery.style( elem, name, value ) :
          jQuery.css( elem, name );
      }, name, value, arguments.length > 1 );
    }
  } );
  
  
  function Tween( elem, options, prop, end, easing ) {
    return new Tween.prototype.init( elem, options, prop, end, easing );
  }
  jQuery.Tween = Tween;
  
  Tween.prototype = {
    constructor: Tween,
    init: function( elem, options, prop, end, easing, unit ) {
      this.elem = elem;
      this.prop = prop;
      this.easing = easing || jQuery.easing._default;
      this.options = options;
      this.start = this.now = this.cur();
      this.end = end;
      this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
    },
    cur: function() {
      var hooks = Tween.propHooks[ this.prop ];
  
      return hooks && hooks.get ?
        hooks.get( this ) :
        Tween.propHooks._default.get( this );
    },
    run: function( percent ) {
      var eased,
        hooks = Tween.propHooks[ this.prop ];
  
      if ( this.options.duration ) {
        this.pos = eased = jQuery.easing[ this.easing ](
          percent, this.options.duration * percent, 0, 1, this.options.duration
        );
      } else {
        this.pos = eased = percent;
      }
      this.now = ( this.end - this.start ) * eased + this.start;
  
      if ( this.options.step ) {
        this.options.step.call( this.elem, this.now, this );
      }
  
      if ( hooks && hooks.set ) {
        hooks.set( this );
      } else {
        Tween.propHooks._default.set( this );
      }
      return this;
    }
  };
  
  Tween.prototype.init.prototype = Tween.prototype;
  
  Tween.propHooks = {
    _default: {
      get: function( tween ) {
        var result;
  
        // Use a property on the element directly when it is not a DOM element,
        // or when there is no matching style property that exists.
        if ( tween.elem.nodeType !== 1 ||
          tween.elem[ tween.prop ] != null && tween.elem.style[ tween.prop ] == null ) {
          return tween.elem[ tween.prop ];
        }
  
        // Passing an empty string as a 3rd parameter to .css will automatically
        // attempt a parseFloat and fallback to a string if the parse fails.
        // Simple values such as "10px" are parsed to Float;
        // complex values such as "rotate(1rad)" are returned as-is.
        result = jQuery.css( tween.elem, tween.prop, "" );
  
        // Empty strings, null, undefined and "auto" are converted to 0.
        return !result || result === "auto" ? 0 : result;
      },
      set: function( tween ) {
  
        // Use step hook for back compat.
        // Use cssHook if its there.
        // Use .style if available and use plain properties where available.
        if ( jQuery.fx.step[ tween.prop ] ) {
          jQuery.fx.step[ tween.prop ]( tween );
        } else if ( tween.elem.nodeType === 1 && (
            jQuery.cssHooks[ tween.prop ] ||
            tween.elem.style[ finalPropName( tween.prop ) ] != null ) ) {
          jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
        } else {
          tween.elem[ tween.prop ] = tween.now;
        }
      }
    }
  };
  
  // Support: IE <=9 only
  // Panic based approach to setting things on disconnected nodes
  Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
    set: function( tween ) {
      if ( tween.elem.nodeType && tween.elem.parentNode ) {
        tween.elem[ tween.prop ] = tween.now;
      }
    }
  };
  
  jQuery.easing = {
    linear: function( p ) {
      return p;
    },
    swing: function( p ) {
      return 0.5 - Math.cos( p * Math.PI ) / 2;
    },
    _default: "swing"
  };
  
  jQuery.fx = Tween.prototype.init;
  
  // Back compat <1.8 extension point
  jQuery.fx.step = {};
  
  
  
  
  var
    fxNow, inProgress,
    rfxtypes = /^(?:toggle|show|hide)$/,
    rrun = /queueHooks$/;
  
  function schedule() {
    if ( inProgress ) {
      if ( document.hidden === false && window.requestAnimationFrame ) {
        window.requestAnimationFrame( schedule );
      } else {
        window.setTimeout( schedule, jQuery.fx.interval );
      }
  
      jQuery.fx.tick();
    }
  }
  
  // Animations created synchronously will run synchronously
  function createFxNow() {
    window.setTimeout( function() {
      fxNow = undefined;
    } );
    return ( fxNow = Date.now() );
  }
  
  // Generate parameters to create a standard animation
  function genFx( type, includeWidth ) {
    var which,
      i = 0,
      attrs = { height: type };
  
    // If we include width, step value is 1 to do all cssExpand values,
    // otherwise step value is 2 to skip over Left and Right
    includeWidth = includeWidth ? 1 : 0;
    for ( ; i < 4; i += 2 - includeWidth ) {
      which = cssExpand[ i ];
      attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
    }
  
    if ( includeWidth ) {
      attrs.opacity = attrs.width = type;
    }
  
    return attrs;
  }
  
  function createTween( value, prop, animation ) {
    var tween,
      collection = ( Animation.tweeners[ prop ] || [] ).concat( Animation.tweeners[ "*" ] ),
      index = 0,
      length = collection.length;
    for ( ; index < length; index++ ) {
      if ( ( tween = collection[ index ].call( animation, prop, value ) ) ) {
  
        // We're done with this property
        return tween;
      }
    }
  }
  
  function defaultPrefilter( elem, props, opts ) {
    var prop, value, toggle, hooks, oldfire, propTween, restoreDisplay, display,
      isBox = "width" in props || "height" in props,
      anim = this,
      orig = {},
      style = elem.style,
      hidden = elem.nodeType && isHiddenWithinTree( elem ),
      dataShow = dataPriv.get( elem, "fxshow" );
  
    // Queue-skipping animations hijack the fx hooks
    if ( !opts.queue ) {
      hooks = jQuery._queueHooks( elem, "fx" );
      if ( hooks.unqueued == null ) {
        hooks.unqueued = 0;
        oldfire = hooks.empty.fire;
        hooks.empty.fire = function() {
          if ( !hooks.unqueued ) {
            oldfire();
          }
        };
      }
      hooks.unqueued++;
  
      anim.always( function() {
  
        // Ensure the complete handler is called before this completes
        anim.always( function() {
          hooks.unqueued--;
          if ( !jQuery.queue( elem, "fx" ).length ) {
            hooks.empty.fire();
          }
        } );
      } );
    }
  
    // Detect show/hide animations
    for ( prop in props ) {
      value = props[ prop ];
      if ( rfxtypes.test( value ) ) {
        delete props[ prop ];
        toggle = toggle || value === "toggle";
        if ( value === ( hidden ? "hide" : "show" ) ) {
  
          // Pretend to be hidden if this is a "show" and
          // there is still data from a stopped show/hide
          if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
            hidden = true;
  
          // Ignore all other no-op show/hide data
          } else {
            continue;
          }
        }
        orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );
      }
    }
  
    // Bail out if this is a no-op like .hide().hide()
    propTween = !jQuery.isEmptyObject( props );
    if ( !propTween && jQuery.isEmptyObject( orig ) ) {
      return;
    }
  
    // Restrict "overflow" and "display" styles during box animations
    if ( isBox && elem.nodeType === 1 ) {
  
      // Support: IE <=9 - 11, Edge 12 - 15
      // Record all 3 overflow attributes because IE does not infer the shorthand
      // from identically-valued overflowX and overflowY and Edge just mirrors
      // the overflowX value there.
      opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];
  
      // Identify a display type, preferring old show/hide data over the CSS cascade
      restoreDisplay = dataShow && dataShow.display;
      if ( restoreDisplay == null ) {
        restoreDisplay = dataPriv.get( elem, "display" );
      }
      display = jQuery.css( elem, "display" );
      if ( display === "none" ) {
        if ( restoreDisplay ) {
          display = restoreDisplay;
        } else {
  
          // Get nonempty value(s) by temporarily forcing visibility
          showHide( [ elem ], true );
          restoreDisplay = elem.style.display || restoreDisplay;
          display = jQuery.css( elem, "display" );
          showHide( [ elem ] );
        }
      }
  
      // Animate inline elements as inline-block
      if ( display === "inline" || display === "inline-block" && restoreDisplay != null ) {
        if ( jQuery.css( elem, "float" ) === "none" ) {
  
          // Restore the original display value at the end of pure show/hide animations
          if ( !propTween ) {
            anim.done( function() {
              style.display = restoreDisplay;
            } );
            if ( restoreDisplay == null ) {
              display = style.display;
              restoreDisplay = display === "none" ? "" : display;
            }
          }
          style.display = "inline-block";
        }
      }
    }
  
    if ( opts.overflow ) {
      style.overflow = "hidden";
      anim.always( function() {
        style.overflow = opts.overflow[ 0 ];
        style.overflowX = opts.overflow[ 1 ];
        style.overflowY = opts.overflow[ 2 ];
      } );
    }
  
    // Implement show/hide animations
    propTween = false;
    for ( prop in orig ) {
  
      // General show/hide setup for this element animation
      if ( !propTween ) {
        if ( dataShow ) {
          if ( "hidden" in dataShow ) {
            hidden = dataShow.hidden;
          }
        } else {
          dataShow = dataPriv.access( elem, "fxshow", { display: restoreDisplay } );
        }
  
        // Store hidden/visible for toggle so `.stop().toggle()` "reverses"
        if ( toggle ) {
          dataShow.hidden = !hidden;
        }
  
        // Show elements before animating them
        if ( hidden ) {
          showHide( [ elem ], true );
        }
  
        /* eslint-disable no-loop-func */
  
        anim.done( function() {
  
        /* eslint-enable no-loop-func */
  
          // The final step of a "hide" animation is actually hiding the element
          if ( !hidden ) {
            showHide( [ elem ] );
          }
          dataPriv.remove( elem, "fxshow" );
          for ( prop in orig ) {
            jQuery.style( elem, prop, orig[ prop ] );
          }
        } );
      }
  
      // Per-property setup
      propTween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );
      if ( !( prop in dataShow ) ) {
        dataShow[ prop ] = propTween.start;
        if ( hidden ) {
          propTween.end = propTween.start;
          propTween.start = 0;
        }
      }
    }
  }
  
  function propFilter( props, specialEasing ) {
    var index, name, easing, value, hooks;
  
    // camelCase, specialEasing and expand cssHook pass
    for ( index in props ) {
      name = camelCase( index );
      easing = specialEasing[ name ];
      value = props[ index ];
      if ( Array.isArray( value ) ) {
        easing = value[ 1 ];
        value = props[ index ] = value[ 0 ];
      }
  
      if ( index !== name ) {
        props[ name ] = value;
        delete props[ index ];
      }
  
      hooks = jQuery.cssHooks[ name ];
      if ( hooks && "expand" in hooks ) {
        value = hooks.expand( value );
        delete props[ name ];
  
        // Not quite $.extend, this won't overwrite existing keys.
        // Reusing 'index' because we have the correct "name"
        for ( index in value ) {
          if ( !( index in props ) ) {
            props[ index ] = value[ index ];
            specialEasing[ index ] = easing;
          }
        }
      } else {
        specialEasing[ name ] = easing;
      }
    }
  }
  
  function Animation( elem, properties, options ) {
    var result,
      stopped,
      index = 0,
      length = Animation.prefilters.length,
      deferred = jQuery.Deferred().always( function() {
  
        // Don't match elem in the :animated selector
        delete tick.elem;
      } ),
      tick = function() {
        if ( stopped ) {
          return false;
        }
        var currentTime = fxNow || createFxNow(),
          remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),
  
          // Support: Android 2.3 only
          // Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)
          temp = remaining / animation.duration || 0,
          percent = 1 - temp,
          index = 0,
          length = animation.tweens.length;
  
        for ( ; index < length; index++ ) {
          animation.tweens[ index ].run( percent );
        }
  
        deferred.notifyWith( elem, [ animation, percent, remaining ] );
  
        // If there's more to do, yield
        if ( percent < 1 && length ) {
          return remaining;
        }
  
        // If this was an empty animation, synthesize a final progress notification
        if ( !length ) {
          deferred.notifyWith( elem, [ animation, 1, 0 ] );
        }
  
        // Resolve the animation and report its conclusion
        deferred.resolveWith( elem, [ animation ] );
        return false;
      },
      animation = deferred.promise( {
        elem: elem,
        props: jQuery.extend( {}, properties ),
        opts: jQuery.extend( true, {
          specialEasing: {},
          easing: jQuery.easing._default
        }, options ),
        originalProperties: properties,
        originalOptions: options,
        startTime: fxNow || createFxNow(),
        duration: options.duration,
        tweens: [],
        createTween: function( prop, end ) {
          var tween = jQuery.Tween( elem, animation.opts, prop, end,
              animation.opts.specialEasing[ prop ] || animation.opts.easing );
          animation.tweens.push( tween );
          return tween;
        },
        stop: function( gotoEnd ) {
          var index = 0,
  
            // If we are going to the end, we want to run all the tweens
            // otherwise we skip this part
            length = gotoEnd ? animation.tweens.length : 0;
          if ( stopped ) {
            return this;
          }
          stopped = true;
          for ( ; index < length; index++ ) {
            animation.tweens[ index ].run( 1 );
          }
  
          // Resolve when we played the last frame; otherwise, reject
          if ( gotoEnd ) {
            deferred.notifyWith( elem, [ animation, 1, 0 ] );
            deferred.resolveWith( elem, [ animation, gotoEnd ] );
          } else {
            deferred.rejectWith( elem, [ animation, gotoEnd ] );
          }
          return this;
        }
      } ),
      props = animation.props;
  
    propFilter( props, animation.opts.specialEasing );
  
    for ( ; index < length; index++ ) {
      result = Animation.prefilters[ index ].call( animation, elem, props, animation.opts );
      if ( result ) {
        if ( isFunction( result.stop ) ) {
          jQuery._queueHooks( animation.elem, animation.opts.queue ).stop =
            result.stop.bind( result );
        }
        return result;
      }
    }
  
    jQuery.map( props, createTween, animation );
  
    if ( isFunction( animation.opts.start ) ) {
      animation.opts.start.call( elem, animation );
    }
  
    // Attach callbacks from options
    animation
      .progress( animation.opts.progress )
      .done( animation.opts.done, animation.opts.complete )
      .fail( animation.opts.fail )
      .always( animation.opts.always );
  
    jQuery.fx.timer(
      jQuery.extend( tick, {
        elem: elem,
        anim: animation,
        queue: animation.opts.queue
      } )
    );
  
    return animation;
  }
  
  jQuery.Animation = jQuery.extend( Animation, {
  
    tweeners: {
      "*": [ function( prop, value ) {
        var tween = this.createTween( prop, value );
        adjustCSS( tween.elem, prop, rcssNum.exec( value ), tween );
        return tween;
      } ]
    },
  
    tweener: function( props, callback ) {
      if ( isFunction( props ) ) {
        callback = props;
        props = [ "*" ];
      } else {
        props = props.match( rnothtmlwhite );
      }
  
      var prop,
        index = 0,
        length = props.length;
  
      for ( ; index < length; index++ ) {
        prop = props[ index ];
        Animation.tweeners[ prop ] = Animation.tweeners[ prop ] || [];
        Animation.tweeners[ prop ].unshift( callback );
      }
    },
  
    prefilters: [ defaultPrefilter ],
  
    prefilter: function( callback, prepend ) {
      if ( prepend ) {
        Animation.prefilters.unshift( callback );
      } else {
        Animation.prefilters.push( callback );
      }
    }
  } );
  
  jQuery.speed = function( speed, easing, fn ) {
    var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
      complete: fn || !fn && easing ||
        isFunction( speed ) && speed,
      duration: speed,
      easing: fn && easing || easing && !isFunction( easing ) && easing
    };
  
    // Go to the end state if fx are off
    if ( jQuery.fx.off ) {
      opt.duration = 0;
  
    } else {
      if ( typeof opt.duration !== "number" ) {
        if ( opt.duration in jQuery.fx.speeds ) {
          opt.duration = jQuery.fx.speeds[ opt.duration ];
  
        } else {
          opt.duration = jQuery.fx.speeds._default;
        }
      }
    }
  
    // Normalize opt.queue - true/undefined/null -> "fx"
    if ( opt.queue == null || opt.queue === true ) {
      opt.queue = "fx";
    }
  
    // Queueing
    opt.old = opt.complete;
  
    opt.complete = function() {
      if ( isFunction( opt.old ) ) {
        opt.old.call( this );
      }
  
      if ( opt.queue ) {
        jQuery.dequeue( this, opt.queue );
      }
    };
  
    return opt;
  };
  
  jQuery.fn.extend( {
    fadeTo: function( speed, to, easing, callback ) {
  
      // Show any hidden elements after setting opacity to 0
      return this.filter( isHiddenWithinTree ).css( "opacity", 0 ).show()
  
        // Animate to the value specified
        .end().animate( { opacity: to }, speed, easing, callback );
    },
    animate: function( prop, speed, easing, callback ) {
      var empty = jQuery.isEmptyObject( prop ),
        optall = jQuery.speed( speed, easing, callback ),
        doAnimation = function() {
  
          // Operate on a copy of prop so per-property easing won't be lost
          var anim = Animation( this, jQuery.extend( {}, prop ), optall );
  
          // Empty animations, or finishing resolves immediately
          if ( empty || dataPriv.get( this, "finish" ) ) {
            anim.stop( true );
          }
        };
        doAnimation.finish = doAnimation;
  
      return empty || optall.queue === false ?
        this.each( doAnimation ) :
        this.queue( optall.queue, doAnimation );
    },
    stop: function( type, clearQueue, gotoEnd ) {
      var stopQueue = function( hooks ) {
        var stop = hooks.stop;
        delete hooks.stop;
        stop( gotoEnd );
      };
  
      if ( typeof type !== "string" ) {
        gotoEnd = clearQueue;
        clearQueue = type;
        type = undefined;
      }
      if ( clearQueue ) {
        this.queue( type || "fx", [] );
      }
  
      return this.each( function() {
        var dequeue = true,
          index = type != null && type + "queueHooks",
          timers = jQuery.timers,
          data = dataPriv.get( this );
  
        if ( index ) {
          if ( data[ index ] && data[ index ].stop ) {
            stopQueue( data[ index ] );
          }
        } else {
          for ( index in data ) {
            if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
              stopQueue( data[ index ] );
            }
          }
        }
  
        for ( index = timers.length; index--; ) {
          if ( timers[ index ].elem === this &&
            ( type == null || timers[ index ].queue === type ) ) {
  
            timers[ index ].anim.stop( gotoEnd );
            dequeue = false;
            timers.splice( index, 1 );
          }
        }
  
        // Start the next in the queue if the last step wasn't forced.
        // Timers currently will call their complete callbacks, which
        // will dequeue but only if they were gotoEnd.
        if ( dequeue || !gotoEnd ) {
          jQuery.dequeue( this, type );
        }
      } );
    },
    finish: function( type ) {
      if ( type !== false ) {
        type = type || "fx";
      }
      return this.each( function() {
        var index,
          data = dataPriv.get( this ),
          queue = data[ type + "queue" ],
          hooks = data[ type + "queueHooks" ],
          timers = jQuery.timers,
          length = queue ? queue.length : 0;
  
        // Enable finishing flag on private data
        data.finish = true;
  
        // Empty the queue first
        jQuery.queue( this, type, [] );
  
        if ( hooks && hooks.stop ) {
          hooks.stop.call( this, true );
        }
  
        // Look for any active animations, and finish them
        for ( index = timers.length; index--; ) {
          if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
            timers[ index ].anim.stop( true );
            timers.splice( index, 1 );
          }
        }
  
        // Look for any animations in the old queue and finish them
        for ( index = 0; index < length; index++ ) {
          if ( queue[ index ] && queue[ index ].finish ) {
            queue[ index ].finish.call( this );
          }
        }
  
        // Turn off finishing flag
        delete data.finish;
      } );
    }
  } );
  
  jQuery.each( [ "toggle", "show", "hide" ], function( _i, name ) {
    var cssFn = jQuery.fn[ name ];
    jQuery.fn[ name ] = function( speed, easing, callback ) {
      return speed == null || typeof speed === "boolean" ?
        cssFn.apply( this, arguments ) :
        this.animate( genFx( name, true ), speed, easing, callback );
    };
  } );
  
  // Generate shortcuts for custom animations
  jQuery.each( {
    slideDown: genFx( "show" ),
    slideUp: genFx( "hide" ),
    slideToggle: genFx( "toggle" ),
    fadeIn: { opacity: "show" },
    fadeOut: { opacity: "hide" },
    fadeToggle: { opacity: "toggle" }
  }, function( name, props ) {
    jQuery.fn[ name ] = function( speed, easing, callback ) {
      return this.animate( props, speed, easing, callback );
    };
  } );
  
  jQuery.timers = [];
  jQuery.fx.tick = function() {
    var timer,
      i = 0,
      timers = jQuery.timers;
  
    fxNow = Date.now();
  
    for ( ; i < timers.length; i++ ) {
      timer = timers[ i ];
  
      // Run the timer and safely remove it when done (allowing for external removal)
      if ( !timer() && timers[ i ] === timer ) {
        timers.splice( i--, 1 );
      }
    }
  
    if ( !timers.length ) {
      jQuery.fx.stop();
    }
    fxNow = undefined;
  };
  
  jQuery.fx.timer = function( timer ) {
    jQuery.timers.push( timer );
    jQuery.fx.start();
  };
  
  jQuery.fx.interval = 13;
  jQuery.fx.start = function() {
    if ( inProgress ) {
      return;
    }
  
    inProgress = true;
    schedule();
  };
  
  jQuery.fx.stop = function() {
    inProgress = null;
  };
  
  jQuery.fx.speeds = {
    slow: 600,
    fast: 200,
  
    // Default speed
    _default: 400
  };
  
  
  // Based off of the plugin by Clint Helfers, with permission.
  // https://web.archive.org/web/20100324014747/http://blindsignals.com/index.php/2009/07/jquery-delay/
  jQuery.fn.delay = function( time, type ) {
    time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
    type = type || "fx";
  
    return this.queue( type, function( next, hooks ) {
      var timeout = window.setTimeout( next, time );
      hooks.stop = function() {
        window.clearTimeout( timeout );
      };
    } );
  };
  
  
  ( function() {
    var input = document.createElement( "input" ),
      select = document.createElement( "select" ),
      opt = select.appendChild( document.createElement( "option" ) );
  
    input.type = "checkbox";
  
    // Support: Android <=4.3 only
    // Default value for a checkbox should be "on"
    support.checkOn = input.value !== "";
  
    // Support: IE <=11 only
    // Must access selectedIndex to make default options select
    support.optSelected = opt.selected;
  
    // Support: IE <=11 only
    // An input loses its value after becoming a radio
    input = document.createElement( "input" );
    input.value = "t";
    input.type = "radio";
    support.radioValue = input.value === "t";
  } )();
  
  
  var boolHook,
    attrHandle = jQuery.expr.attrHandle;
  
  jQuery.fn.extend( {
    attr: function( name, value ) {
      return access( this, jQuery.attr, name, value, arguments.length > 1 );
    },
  
    removeAttr: function( name ) {
      return this.each( function() {
        jQuery.removeAttr( this, name );
      } );
    }
  } );
  
  jQuery.extend( {
    attr: function( elem, name, value ) {
      var ret, hooks,
        nType = elem.nodeType;
  
      // Don't get/set attributes on text, comment and attribute nodes
      if ( nType === 3 || nType === 8 || nType === 2 ) {
        return;
      }
  
      // Fallback to prop when attributes are not supported
      if ( typeof elem.getAttribute === "undefined" ) {
        return jQuery.prop( elem, name, value );
      }
  
      // Attribute hooks are determined by the lowercase version
      // Grab necessary hook if one is defined
      if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
        hooks = jQuery.attrHooks[ name.toLowerCase() ] ||
          ( jQuery.expr.match.bool.test( name ) ? boolHook : undefined );
      }
  
      if ( value !== undefined ) {
        if ( value === null ) {
          jQuery.removeAttr( elem, name );
          return;
        }
  
        if ( hooks && "set" in hooks &&
          ( ret = hooks.set( elem, value, name ) ) !== undefined ) {
          return ret;
        }
  
        elem.setAttribute( name, value + "" );
        return value;
      }
  
      if ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {
        return ret;
      }
  
      ret = jQuery.find.attr( elem, name );
  
      // Non-existent attributes return null, we normalize to undefined
      return ret == null ? undefined : ret;
    },
  
    attrHooks: {
      type: {
        set: function( elem, value ) {
          if ( !support.radioValue && value === "radio" &&
            nodeName( elem, "input" ) ) {
            var val = elem.value;
            elem.setAttribute( "type", value );
            if ( val ) {
              elem.value = val;
            }
            return value;
          }
        }
      }
    },
  
    removeAttr: function( elem, value ) {
      var name,
        i = 0,
  
        // Attribute names can contain non-HTML whitespace characters
        // https://html.spec.whatwg.org/multipage/syntax.html#attributes-2
        attrNames = value && value.match( rnothtmlwhite );
  
      if ( attrNames && elem.nodeType === 1 ) {
        while ( ( name = attrNames[ i++ ] ) ) {
          elem.removeAttribute( name );
        }
      }
    }
  } );
  
  // Hooks for boolean attributes
  boolHook = {
    set: function( elem, value, name ) {
      if ( value === false ) {
  
        // Remove boolean attributes when set to false
        jQuery.removeAttr( elem, name );
      } else {
        elem.setAttribute( name, name );
      }
      return name;
    }
  };
  
  jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( _i, name ) {
    var getter = attrHandle[ name ] || jQuery.find.attr;
  
    attrHandle[ name ] = function( elem, name, isXML ) {
      var ret, handle,
        lowercaseName = name.toLowerCase();
  
      if ( !isXML ) {
  
        // Avoid an infinite loop by temporarily removing this function from the getter
        handle = attrHandle[ lowercaseName ];
        attrHandle[ lowercaseName ] = ret;
        ret = getter( elem, name, isXML ) != null ?
          lowercaseName :
          null;
        attrHandle[ lowercaseName ] = handle;
      }
      return ret;
    };
  } );
  
  
  
  
  var rfocusable = /^(?:input|select|textarea|button)$/i,
    rclickable = /^(?:a|area)$/i;
  
  jQuery.fn.extend( {
    prop: function( name, value ) {
      return access( this, jQuery.prop, name, value, arguments.length > 1 );
    },
  
    removeProp: function( name ) {
      return this.each( function() {
        delete this[ jQuery.propFix[ name ] || name ];
      } );
    }
  } );
  
  jQuery.extend( {
    prop: function( elem, name, value ) {
      var ret, hooks,
        nType = elem.nodeType;
  
      // Don't get/set properties on text, comment and attribute nodes
      if ( nType === 3 || nType === 8 || nType === 2 ) {
        return;
      }
  
      if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
  
        // Fix name and attach hooks
        name = jQuery.propFix[ name ] || name;
        hooks = jQuery.propHooks[ name ];
      }
  
      if ( value !== undefined ) {
        if ( hooks && "set" in hooks &&
          ( ret = hooks.set( elem, value, name ) ) !== undefined ) {
          return ret;
        }
  
        return ( elem[ name ] = value );
      }
  
      if ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {
        return ret;
      }
  
      return elem[ name ];
    },
  
    propHooks: {
      tabIndex: {
        get: function( elem ) {
  
          // Support: IE <=9 - 11 only
          // elem.tabIndex doesn't always return the
          // correct value when it hasn't been explicitly set
          // https://web.archive.org/web/20141116233347/http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/
          // Use proper attribute retrieval(#12072)
          var tabindex = jQuery.find.attr( elem, "tabindex" );
  
          if ( tabindex ) {
            return parseInt( tabindex, 10 );
          }
  
          if (
            rfocusable.test( elem.nodeName ) ||
            rclickable.test( elem.nodeName ) &&
            elem.href
          ) {
            return 0;
          }
  
          return -1;
        }
      }
    },
  
    propFix: {
      "for": "htmlFor",
      "class": "className"
    }
  } );
  
  // Support: IE <=11 only
  // Accessing the selectedIndex property
  // forces the browser to respect setting selected
  // on the option
  // The getter ensures a default option is selected
  // when in an optgroup
  // eslint rule "no-unused-expressions" is disabled for this code
  // since it considers such accessions noop
  if ( !support.optSelected ) {
    jQuery.propHooks.selected = {
      get: function( elem ) {
  
        /* eslint no-unused-expressions: "off" */
  
        var parent = elem.parentNode;
        if ( parent && parent.parentNode ) {
          parent.parentNode.selectedIndex;
        }
        return null;
      },
      set: function( elem ) {
  
        /* eslint no-unused-expressions: "off" */
  
        var parent = elem.parentNode;
        if ( parent ) {
          parent.selectedIndex;
  
          if ( parent.parentNode ) {
            parent.parentNode.selectedIndex;
          }
        }
      }
    };
  }
  
  jQuery.each( [
    "tabIndex",
    "readOnly",
    "maxLength",
    "cellSpacing",
    "cellPadding",
    "rowSpan",
    "colSpan",
    "useMap",
    "frameBorder",
    "contentEditable"
  ], function() {
    jQuery.propFix[ this.toLowerCase() ] = this;
  } );
  
  
  
  
    // Strip and collapse whitespace according to HTML spec
    // https://infra.spec.whatwg.org/#strip-and-collapse-ascii-whitespace
    function stripAndCollapse( value ) {
      var tokens = value.match( rnothtmlwhite ) || [];
      return tokens.join( " " );
    }
  
  
  function getClass( elem ) {
    return elem.getAttribute && elem.getAttribute( "class" ) || "";
  }
  
  function classesToArray( value ) {
    if ( Array.isArray( value ) ) {
      return value;
    }
    if ( typeof value === "string" ) {
      return value.match( rnothtmlwhite ) || [];
    }
    return [];
  }
  
  jQuery.fn.extend( {
    addClass: function( value ) {
      var classes, elem, cur, curValue, clazz, j, finalValue,
        i = 0;
  
      if ( isFunction( value ) ) {
        return this.each( function( j ) {
          jQuery( this ).addClass( value.call( this, j, getClass( this ) ) );
        } );
      }
  
      classes = classesToArray( value );
  
      if ( classes.length ) {
        while ( ( elem = this[ i++ ] ) ) {
          curValue = getClass( elem );
          cur = elem.nodeType === 1 && ( " " + stripAndCollapse( curValue ) + " " );
  
          if ( cur ) {
            j = 0;
            while ( ( clazz = classes[ j++ ] ) ) {
              if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
                cur += clazz + " ";
              }
            }
  
            // Only assign if different to avoid unneeded rendering.
            finalValue = stripAndCollapse( cur );
            if ( curValue !== finalValue ) {
              elem.setAttribute( "class", finalValue );
            }
          }
        }
      }
  
      return this;
    },
  
    removeClass: function( value ) {
      var classes, elem, cur, curValue, clazz, j, finalValue,
        i = 0;
  
      if ( isFunction( value ) ) {
        return this.each( function( j ) {
          jQuery( this ).removeClass( value.call( this, j, getClass( this ) ) );
        } );
      }
  
      if ( !arguments.length ) {
        return this.attr( "class", "" );
      }
  
      classes = classesToArray( value );
  
      if ( classes.length ) {
        while ( ( elem = this[ i++ ] ) ) {
          curValue = getClass( elem );
  
          // This expression is here for better compressibility (see addClass)
          cur = elem.nodeType === 1 && ( " " + stripAndCollapse( curValue ) + " " );
  
          if ( cur ) {
            j = 0;
            while ( ( clazz = classes[ j++ ] ) ) {
  
              // Remove *all* instances
              while ( cur.indexOf( " " + clazz + " " ) > -1 ) {
                cur = cur.replace( " " + clazz + " ", " " );
              }
            }
  
            // Only assign if different to avoid unneeded rendering.
            finalValue = stripAndCollapse( cur );
            if ( curValue !== finalValue ) {
              elem.setAttribute( "class", finalValue );
            }
          }
        }
      }
  
      return this;
    },
  
    toggleClass: function( value, stateVal ) {
      var type = typeof value,
        isValidValue = type === "string" || Array.isArray( value );
  
      if ( typeof stateVal === "boolean" && isValidValue ) {
        return stateVal ? this.addClass( value ) : this.removeClass( value );
      }
  
      if ( isFunction( value ) ) {
        return this.each( function( i ) {
          jQuery( this ).toggleClass(
            value.call( this, i, getClass( this ), stateVal ),
            stateVal
          );
        } );
      }
  
      return this.each( function() {
        var className, i, self, classNames;
  
        if ( isValidValue ) {
  
          // Toggle individual class names
          i = 0;
          self = jQuery( this );
          classNames = classesToArray( value );
  
          while ( ( className = classNames[ i++ ] ) ) {
  
            // Check each className given, space separated list
            if ( self.hasClass( className ) ) {
              self.removeClass( className );
            } else {
              self.addClass( className );
            }
          }
  
        // Toggle whole class name
        } else if ( value === undefined || type === "boolean" ) {
          className = getClass( this );
          if ( className ) {
  
            // Store className if set
            dataPriv.set( this, "__className__", className );
          }
  
          // If the element has a class name or if we're passed `false`,
          // then remove the whole classname (if there was one, the above saved it).
          // Otherwise bring back whatever was previously saved (if anything),
          // falling back to the empty string if nothing was stored.
          if ( this.setAttribute ) {
            this.setAttribute( "class",
              className || value === false ?
              "" :
              dataPriv.get( this, "__className__" ) || ""
            );
          }
        }
      } );
    },
  
    hasClass: function( selector ) {
      var className, elem,
        i = 0;
  
      className = " " + selector + " ";
      while ( ( elem = this[ i++ ] ) ) {
        if ( elem.nodeType === 1 &&
          ( " " + stripAndCollapse( getClass( elem ) ) + " " ).indexOf( className ) > -1 ) {
            return true;
        }
      }
  
      return false;
    }
  } );
  
  
  
  
  var rreturn = /\r/g;
  
  jQuery.fn.extend( {
    val: function( value ) {
      var hooks, ret, valueIsFunction,
        elem = this[ 0 ];
  
      if ( !arguments.length ) {
        if ( elem ) {
          hooks = jQuery.valHooks[ elem.type ] ||
            jQuery.valHooks[ elem.nodeName.toLowerCase() ];
  
          if ( hooks &&
            "get" in hooks &&
            ( ret = hooks.get( elem, "value" ) ) !== undefined
          ) {
            return ret;
          }
  
          ret = elem.value;
  
          // Handle most common string cases
          if ( typeof ret === "string" ) {
            return ret.replace( rreturn, "" );
          }
  
          // Handle cases where value is null/undef or number
          return ret == null ? "" : ret;
        }
  
        return;
      }
  
      valueIsFunction = isFunction( value );
  
      return this.each( function( i ) {
        var val;
  
        if ( this.nodeType !== 1 ) {
          return;
        }
  
        if ( valueIsFunction ) {
          val = value.call( this, i, jQuery( this ).val() );
        } else {
          val = value;
        }
  
        // Treat null/undefined as ""; convert numbers to string
        if ( val == null ) {
          val = "";
  
        } else if ( typeof val === "number" ) {
          val += "";
  
        } else if ( Array.isArray( val ) ) {
          val = jQuery.map( val, function( value ) {
            return value == null ? "" : value + "";
          } );
        }
  
        hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];
  
        // If set returns undefined, fall back to normal setting
        if ( !hooks || !( "set" in hooks ) || hooks.set( this, val, "value" ) === undefined ) {
          this.value = val;
        }
      } );
    }
  } );
  
  jQuery.extend( {
    valHooks: {
      option: {
        get: function( elem ) {
  
          var val = jQuery.find.attr( elem, "value" );
          return val != null ?
            val :
  
            // Support: IE <=10 - 11 only
            // option.text throws exceptions (#14686, #14858)
            // Strip and collapse whitespace
            // https://html.spec.whatwg.org/#strip-and-collapse-whitespace
            stripAndCollapse( jQuery.text( elem ) );
        }
      },
      select: {
        get: function( elem ) {
          var value, option, i,
            options = elem.options,
            index = elem.selectedIndex,
            one = elem.type === "select-one",
            values = one ? null : [],
            max = one ? index + 1 : options.length;
  
          if ( index < 0 ) {
            i = max;
  
          } else {
            i = one ? index : 0;
          }
  
          // Loop through all the selected options
          for ( ; i < max; i++ ) {
            option = options[ i ];
  
            // Support: IE <=9 only
            // IE8-9 doesn't update selected after form reset (#2551)
            if ( ( option.selected || i === index ) &&
  
                // Don't return options that are disabled or in a disabled optgroup
                !option.disabled &&
                ( !option.parentNode.disabled ||
                  !nodeName( option.parentNode, "optgroup" ) ) ) {
  
              // Get the specific value for the option
              value = jQuery( option ).val();
  
              // We don't need an array for one selects
              if ( one ) {
                return value;
              }
  
              // Multi-Selects return an array
              values.push( value );
            }
          }
  
          return values;
        },
  
        set: function( elem, value ) {
          var optionSet, option,
            options = elem.options,
            values = jQuery.makeArray( value ),
            i = options.length;
  
          while ( i-- ) {
            option = options[ i ];
  
            /* eslint-disable no-cond-assign */
  
            if ( option.selected =
              jQuery.inArray( jQuery.valHooks.option.get( option ), values ) > -1
            ) {
              optionSet = true;
            }
  
            /* eslint-enable no-cond-assign */
          }
  
          // Force browsers to behave consistently when non-matching value is set
          if ( !optionSet ) {
            elem.selectedIndex = -1;
          }
          return values;
        }
      }
    }
  } );
  
  // Radios and checkboxes getter/setter
  jQuery.each( [ "radio", "checkbox" ], function() {
    jQuery.valHooks[ this ] = {
      set: function( elem, value ) {
        if ( Array.isArray( value ) ) {
          return ( elem.checked = jQuery.inArray( jQuery( elem ).val(), value ) > -1 );
        }
      }
    };
    if ( !support.checkOn ) {
      jQuery.valHooks[ this ].get = function( elem ) {
        return elem.getAttribute( "value" ) === null ? "on" : elem.value;
      };
    }
  } );
  
  
  
  
  // Return jQuery for attributes-only inclusion
  
  
  support.focusin = "onfocusin" in window;
  
  
  var rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
    stopPropagationCallback = function( e ) {
      e.stopPropagation();
    };
  
  jQuery.extend( jQuery.event, {
  
    trigger: function( event, data, elem, onlyHandlers ) {
  
      var i, cur, tmp, bubbleType, ontype, handle, special, lastElement,
        eventPath = [ elem || document ],
        type = hasOwn.call( event, "type" ) ? event.type : event,
        namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split( "." ) : [];
  
      cur = lastElement = tmp = elem = elem || document;
  
      // Don't do events on text and comment nodes
      if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
        return;
      }
  
      // focus/blur morphs to focusin/out; ensure we're not firing them right now
      if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
        return;
      }
  
      if ( type.indexOf( "." ) > -1 ) {
  
        // Namespaced trigger; create a regexp to match event type in handle()
        namespaces = type.split( "." );
        type = namespaces.shift();
        namespaces.sort();
      }
      ontype = type.indexOf( ":" ) < 0 && "on" + type;
  
      // Caller can pass in a jQuery.Event object, Object, or just an event type string
      event = event[ jQuery.expando ] ?
        event :
        new jQuery.Event( type, typeof event === "object" && event );
  
      // Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
      event.isTrigger = onlyHandlers ? 2 : 3;
      event.namespace = namespaces.join( "." );
      event.rnamespace = event.namespace ?
        new RegExp( "(^|\\.)" + namespaces.join( "\\.(?:.*\\.|)" ) + "(\\.|$)" ) :
        null;
  
      // Clean up the event in case it is being reused
      event.result = undefined;
      if ( !event.target ) {
        event.target = elem;
      }
  
      // Clone any incoming data and prepend the event, creating the handler arg list
      data = data == null ?
        [ event ] :
        jQuery.makeArray( data, [ event ] );
  
      // Allow special events to draw outside the lines
      special = jQuery.event.special[ type ] || {};
      if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
        return;
      }
  
      // Determine event propagation path in advance, per W3C events spec (#9951)
      // Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
      if ( !onlyHandlers && !special.noBubble && !isWindow( elem ) ) {
  
        bubbleType = special.delegateType || type;
        if ( !rfocusMorph.test( bubbleType + type ) ) {
          cur = cur.parentNode;
        }
        for ( ; cur; cur = cur.parentNode ) {
          eventPath.push( cur );
          tmp = cur;
        }
  
        // Only add window if we got to document (e.g., not plain obj or detached DOM)
        if ( tmp === ( elem.ownerDocument || document ) ) {
          eventPath.push( tmp.defaultView || tmp.parentWindow || window );
        }
      }
  
      // Fire handlers on the event path
      i = 0;
      while ( ( cur = eventPath[ i++ ] ) && !event.isPropagationStopped() ) {
        lastElement = cur;
        event.type = i > 1 ?
          bubbleType :
          special.bindType || type;
  
        // jQuery handler
        handle = (
            dataPriv.get( cur, "events" ) || Object.create( null )
          )[ event.type ] &&
          dataPriv.get( cur, "handle" );
        if ( handle ) {
          handle.apply( cur, data );
        }
  
        // Native handler
        handle = ontype && cur[ ontype ];
        if ( handle && handle.apply && acceptData( cur ) ) {
          event.result = handle.apply( cur, data );
          if ( event.result === false ) {
            event.preventDefault();
          }
        }
      }
      event.type = type;
  
      // If nobody prevented the default action, do it now
      if ( !onlyHandlers && !event.isDefaultPrevented() ) {
  
        if ( ( !special._default ||
          special._default.apply( eventPath.pop(), data ) === false ) &&
          acceptData( elem ) ) {
  
          // Call a native DOM method on the target with the same name as the event.
          // Don't do default actions on window, that's where global variables be (#6170)
          if ( ontype && isFunction( elem[ type ] ) && !isWindow( elem ) ) {
  
            // Don't re-trigger an onFOO event when we call its FOO() method
            tmp = elem[ ontype ];
  
            if ( tmp ) {
              elem[ ontype ] = null;
            }
  
            // Prevent re-triggering of the same event, since we already bubbled it above
            jQuery.event.triggered = type;
  
            if ( event.isPropagationStopped() ) {
              lastElement.addEventListener( type, stopPropagationCallback );
            }
  
            elem[ type ]();
  
            if ( event.isPropagationStopped() ) {
              lastElement.removeEventListener( type, stopPropagationCallback );
            }
  
            jQuery.event.triggered = undefined;
  
            if ( tmp ) {
              elem[ ontype ] = tmp;
            }
          }
        }
      }
  
      return event.result;
    },
  
    // Piggyback on a donor event to simulate a different one
    // Used only for `focus(in | out)` events
    simulate: function( type, elem, event ) {
      var e = jQuery.extend(
        new jQuery.Event(),
        event,
        {
          type: type,
          isSimulated: true
        }
      );
  
      jQuery.event.trigger( e, null, elem );
    }
  
  } );
  
  jQuery.fn.extend( {
  
    trigger: function( type, data ) {
      return this.each( function() {
        jQuery.event.trigger( type, data, this );
      } );
    },
    triggerHandler: function( type, data ) {
      var elem = this[ 0 ];
      if ( elem ) {
        return jQuery.event.trigger( type, data, elem, true );
      }
    }
  } );
  
  
  // Support: Firefox <=44
  // Firefox doesn't have focus(in | out) events
  // Related ticket - https://bugzilla.mozilla.org/show_bug.cgi?id=687787
  //
  // Support: Chrome <=48 - 49, Safari <=9.0 - 9.1
  // focus(in | out) events fire after focus & blur events,
  // which is spec violation - http://www.w3.org/TR/DOM-Level-3-Events/#events-focusevent-event-order
  // Related ticket - https://bugs.chromium.org/p/chromium/issues/detail?id=449857
  if ( !support.focusin ) {
    jQuery.each( { focus: "focusin", blur: "focusout" }, function( orig, fix ) {
  
      // Attach a single capturing handler on the document while someone wants focusin/focusout
      var handler = function( event ) {
        jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ) );
      };
  
      jQuery.event.special[ fix ] = {
        setup: function() {
  
          // Handle: regular nodes (via `this.ownerDocument`), window
          // (via `this.document`) & document (via `this`).
          var doc = this.ownerDocument || this.document || this,
            attaches = dataPriv.access( doc, fix );
  
          if ( !attaches ) {
            doc.addEventListener( orig, handler, true );
          }
          dataPriv.access( doc, fix, ( attaches || 0 ) + 1 );
        },
        teardown: function() {
          var doc = this.ownerDocument || this.document || this,
            attaches = dataPriv.access( doc, fix ) - 1;
  
          if ( !attaches ) {
            doc.removeEventListener( orig, handler, true );
            dataPriv.remove( doc, fix );
  
          } else {
            dataPriv.access( doc, fix, attaches );
          }
        }
      };
    } );
  }
  var location = window.location;
  
  var nonce = { guid: Date.now() };
  
  var rquery = ( /\?/ );
  
  
  
  // Cross-browser xml parsing
  jQuery.parseXML = function( data ) {
    var xml;
    if ( !data || typeof data !== "string" ) {
      return null;
    }
  
    // Support: IE 9 - 11 only
    // IE throws on parseFromString with invalid input.
    try {
      xml = ( new window.DOMParser() ).parseFromString( data, "text/xml" );
    } catch ( e ) {
      xml = undefined;
    }
  
    if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
      jQuery.error( "Invalid XML: " + data );
    }
    return xml;
  };
  
  
  var
    rbracket = /\[\]$/,
    rCRLF = /\r?\n/g,
    rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
    rsubmittable = /^(?:input|select|textarea|keygen)/i;
  
  function buildParams( prefix, obj, traditional, add ) {
    var name;
  
    if ( Array.isArray( obj ) ) {
  
      // Serialize array item.
      jQuery.each( obj, function( i, v ) {
        if ( traditional || rbracket.test( prefix ) ) {
  
          // Treat each array item as a scalar.
          add( prefix, v );
  
        } else {
  
          // Item is non-scalar (array or object), encode its numeric index.
          buildParams(
            prefix + "[" + ( typeof v === "object" && v != null ? i : "" ) + "]",
            v,
            traditional,
            add
          );
        }
      } );
  
    } else if ( !traditional && toType( obj ) === "object" ) {
  
      // Serialize object item.
      for ( name in obj ) {
        buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
      }
  
    } else {
  
      // Serialize scalar item.
      add( prefix, obj );
    }
  }
  
  // Serialize an array of form elements or a set of
  // key/values into a query string
  jQuery.param = function( a, traditional ) {
    var prefix,
      s = [],
      add = function( key, valueOrFunction ) {
  
        // If value is a function, invoke it and use its return value
        var value = isFunction( valueOrFunction ) ?
          valueOrFunction() :
          valueOrFunction;
  
        s[ s.length ] = encodeURIComponent( key ) + "=" +
          encodeURIComponent( value == null ? "" : value );
      };
  
    if ( a == null ) {
      return "";
    }
  
    // If an array was passed in, assume that it is an array of form elements.
    if ( Array.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {
  
      // Serialize the form elements
      jQuery.each( a, function() {
        add( this.name, this.value );
      } );
  
    } else {
  
      // If traditional, encode the "old" way (the way 1.3.2 or older
      // did it), otherwise encode params recursively.
      for ( prefix in a ) {
        buildParams( prefix, a[ prefix ], traditional, add );
      }
    }
  
    // Return the resulting serialization
    return s.join( "&" );
  };
  
  jQuery.fn.extend( {
    serialize: function() {
      return jQuery.param( this.serializeArray() );
    },
    serializeArray: function() {
      return this.map( function() {
  
        // Can add propHook for "elements" to filter or add form elements
        var elements = jQuery.prop( this, "elements" );
        return elements ? jQuery.makeArray( elements ) : this;
      } )
      .filter( function() {
        var type = this.type;
  
        // Use .is( ":disabled" ) so that fieldset[disabled] works
        return this.name && !jQuery( this ).is( ":disabled" ) &&
          rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
          ( this.checked || !rcheckableType.test( type ) );
      } )
      .map( function( _i, elem ) {
        var val = jQuery( this ).val();
  
        if ( val == null ) {
          return null;
        }
  
        if ( Array.isArray( val ) ) {
          return jQuery.map( val, function( val ) {
            return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
          } );
        }
  
        return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
      } ).get();
    }
  } );
  
  
  var
    r20 = /%20/g,
    rhash = /#.*$/,
    rantiCache = /([?&])_=[^&]*/,
    rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
  
    // #7653, #8125, #8152: local protocol detection
    rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
    rnoContent = /^(?:GET|HEAD)$/,
    rprotocol = /^\/\//,
  
    /* Prefilters
     * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
     * 2) These are called:
     *    - BEFORE asking for a transport
     *    - AFTER param serialization (s.data is a string if s.processData is true)
     * 3) key is the dataType
     * 4) the catchall symbol "*" can be used
     * 5) execution will start with transport dataType and THEN continue down to "*" if needed
     */
    prefilters = {},
  
    /* Transports bindings
     * 1) key is the dataType
     * 2) the catchall symbol "*" can be used
     * 3) selection will start with transport dataType and THEN go to "*" if needed
     */
    transports = {},
  
    // Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
    allTypes = "*/".concat( "*" ),
  
    // Anchor tag for parsing the document origin
    originAnchor = document.createElement( "a" );
    originAnchor.href = location.href;
  
  // Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
  function addToPrefiltersOrTransports( structure ) {
  
    // dataTypeExpression is optional and defaults to "*"
    return function( dataTypeExpression, func ) {
  
      if ( typeof dataTypeExpression !== "string" ) {
        func = dataTypeExpression;
        dataTypeExpression = "*";
      }
  
      var dataType,
        i = 0,
        dataTypes = dataTypeExpression.toLowerCase().match( rnothtmlwhite ) || [];
  
      if ( isFunction( func ) ) {
  
        // For each dataType in the dataTypeExpression
        while ( ( dataType = dataTypes[ i++ ] ) ) {
  
          // Prepend if requested
          if ( dataType[ 0 ] === "+" ) {
            dataType = dataType.slice( 1 ) || "*";
            ( structure[ dataType ] = structure[ dataType ] || [] ).unshift( func );
  
          // Otherwise append
          } else {
            ( structure[ dataType ] = structure[ dataType ] || [] ).push( func );
          }
        }
      }
    };
  }
  
  // Base inspection function for prefilters and transports
  function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {
  
    var inspected = {},
      seekingTransport = ( structure === transports );
  
    function inspect( dataType ) {
      var selected;
      inspected[ dataType ] = true;
      jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
        var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
        if ( typeof dataTypeOrTransport === "string" &&
          !seekingTransport && !inspected[ dataTypeOrTransport ] ) {
  
          options.dataTypes.unshift( dataTypeOrTransport );
          inspect( dataTypeOrTransport );
          return false;
        } else if ( seekingTransport ) {
          return !( selected = dataTypeOrTransport );
        }
      } );
      return selected;
    }
  
    return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
  }
  
  // A special extend for ajax options
  // that takes "flat" options (not to be deep extended)
  // Fixes #9887
  function ajaxExtend( target, src ) {
    var key, deep,
      flatOptions = jQuery.ajaxSettings.flatOptions || {};
  
    for ( key in src ) {
      if ( src[ key ] !== undefined ) {
        ( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];
      }
    }
    if ( deep ) {
      jQuery.extend( true, target, deep );
    }
  
    return target;
  }
  
  /* Handles responses to an ajax request:
   * - finds the right dataType (mediates between content-type and expected dataType)
   * - returns the corresponding response
   */
  function ajaxHandleResponses( s, jqXHR, responses ) {
  
    var ct, type, finalDataType, firstDataType,
      contents = s.contents,
      dataTypes = s.dataTypes;
  
    // Remove auto dataType and get content-type in the process
    while ( dataTypes[ 0 ] === "*" ) {
      dataTypes.shift();
      if ( ct === undefined ) {
        ct = s.mimeType || jqXHR.getResponseHeader( "Content-Type" );
      }
    }
  
    // Check if we're dealing with a known content-type
    if ( ct ) {
      for ( type in contents ) {
        if ( contents[ type ] && contents[ type ].test( ct ) ) {
          dataTypes.unshift( type );
          break;
        }
      }
    }
  
    // Check to see if we have a response for the expected dataType
    if ( dataTypes[ 0 ] in responses ) {
      finalDataType = dataTypes[ 0 ];
    } else {
  
      // Try convertible dataTypes
      for ( type in responses ) {
        if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[ 0 ] ] ) {
          finalDataType = type;
          break;
        }
        if ( !firstDataType ) {
          firstDataType = type;
        }
      }
  
      // Or just use first one
      finalDataType = finalDataType || firstDataType;
    }
  
    // If we found a dataType
    // We add the dataType to the list if needed
    // and return the corresponding response
    if ( finalDataType ) {
      if ( finalDataType !== dataTypes[ 0 ] ) {
        dataTypes.unshift( finalDataType );
      }
      return responses[ finalDataType ];
    }
  }
  
  /* Chain conversions given the request and the original response
   * Also sets the responseXXX fields on the jqXHR instance
   */
  function ajaxConvert( s, response, jqXHR, isSuccess ) {
    var conv2, current, conv, tmp, prev,
      converters = {},
  
      // Work with a copy of dataTypes in case we need to modify it for conversion
      dataTypes = s.dataTypes.slice();
  
    // Create converters map with lowercased keys
    if ( dataTypes[ 1 ] ) {
      for ( conv in s.converters ) {
        converters[ conv.toLowerCase() ] = s.converters[ conv ];
      }
    }
  
    current = dataTypes.shift();
  
    // Convert to each sequential dataType
    while ( current ) {
  
      if ( s.responseFields[ current ] ) {
        jqXHR[ s.responseFields[ current ] ] = response;
      }
  
      // Apply the dataFilter if provided
      if ( !prev && isSuccess && s.dataFilter ) {
        response = s.dataFilter( response, s.dataType );
      }
  
      prev = current;
      current = dataTypes.shift();
  
      if ( current ) {
  
        // There's only work to do if current dataType is non-auto
        if ( current === "*" ) {
  
          current = prev;
  
        // Convert response if prev dataType is non-auto and differs from current
        } else if ( prev !== "*" && prev !== current ) {
  
          // Seek a direct converter
          conv = converters[ prev + " " + current ] || converters[ "* " + current ];
  
          // If none found, seek a pair
          if ( !conv ) {
            for ( conv2 in converters ) {
  
              // If conv2 outputs current
              tmp = conv2.split( " " );
              if ( tmp[ 1 ] === current ) {
  
                // If prev can be converted to accepted input
                conv = converters[ prev + " " + tmp[ 0 ] ] ||
                  converters[ "* " + tmp[ 0 ] ];
                if ( conv ) {
  
                  // Condense equivalence converters
                  if ( conv === true ) {
                    conv = converters[ conv2 ];
  
                  // Otherwise, insert the intermediate dataType
                  } else if ( converters[ conv2 ] !== true ) {
                    current = tmp[ 0 ];
                    dataTypes.unshift( tmp[ 1 ] );
                  }
                  break;
                }
              }
            }
          }
  
          // Apply converter (if not an equivalence)
          if ( conv !== true ) {
  
            // Unless errors are allowed to bubble, catch and return them
            if ( conv && s.throws ) {
              response = conv( response );
            } else {
              try {
                response = conv( response );
              } catch ( e ) {
                return {
                  state: "parsererror",
                  error: conv ? e : "No conversion from " + prev + " to " + current
                };
              }
            }
          }
        }
      }
    }
  
    return { state: "success", data: response };
  }
  
  jQuery.extend( {
  
    // Counter for holding the number of active queries
    active: 0,
  
    // Last-Modified header cache for next request
    lastModified: {},
    etag: {},
  
    ajaxSettings: {
      url: location.href,
      type: "GET",
      isLocal: rlocalProtocol.test( location.protocol ),
      global: true,
      processData: true,
      async: true,
      contentType: "application/x-www-form-urlencoded; charset=UTF-8",
  
      /*
      timeout: 0,
      data: null,
      dataType: null,
      username: null,
      password: null,
      cache: null,
      throws: false,
      traditional: false,
      headers: {},
      */
  
      accepts: {
        "*": allTypes,
        text: "text/plain",
        html: "text/html",
        xml: "application/xml, text/xml",
        json: "application/json, text/javascript"
      },
  
      contents: {
        xml: /\bxml\b/,
        html: /\bhtml/,
        json: /\bjson\b/
      },
  
      responseFields: {
        xml: "responseXML",
        text: "responseText",
        json: "responseJSON"
      },
  
      // Data converters
      // Keys separate source (or catchall "*") and destination types with a single space
      converters: {
  
        // Convert anything to text
        "* text": String,
  
        // Text to html (true = no transformation)
        "text html": true,
  
        // Evaluate text as a json expression
        "text json": JSON.parse,
  
        // Parse text as xml
        "text xml": jQuery.parseXML
      },
  
      // For options that shouldn't be deep extended:
      // you can add your own custom options here if
      // and when you create one that shouldn't be
      // deep extended (see ajaxExtend)
      flatOptions: {
        url: true,
        context: true
      }
    },
  
    // Creates a full fledged settings object into target
    // with both ajaxSettings and settings fields.
    // If target is omitted, writes into ajaxSettings.
    ajaxSetup: function( target, settings ) {
      return settings ?
  
        // Building a settings object
        ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :
  
        // Extending ajaxSettings
        ajaxExtend( jQuery.ajaxSettings, target );
    },
  
    ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
    ajaxTransport: addToPrefiltersOrTransports( transports ),
  
    // Main method
    ajax: function( url, options ) {
  
      // If url is an object, simulate pre-1.5 signature
      if ( typeof url === "object" ) {
        options = url;
        url = undefined;
      }
  
      // Force options to be an object
      options = options || {};
  
      var transport,
  
        // URL without anti-cache param
        cacheURL,
  
        // Response headers
        responseHeadersString,
        responseHeaders,
  
        // timeout handle
        timeoutTimer,
  
        // Url cleanup var
        urlAnchor,
  
        // Request state (becomes false upon send and true upon completion)
        completed,
  
        // To know if global events are to be dispatched
        fireGlobals,
  
        // Loop variable
        i,
  
        // uncached part of the url
        uncached,
  
        // Create the final options object
        s = jQuery.ajaxSetup( {}, options ),
  
        // Callbacks context
        callbackContext = s.context || s,
  
        // Context for global events is callbackContext if it is a DOM node or jQuery collection
        globalEventContext = s.context &&
          ( callbackContext.nodeType || callbackContext.jquery ) ?
            jQuery( callbackContext ) :
            jQuery.event,
  
        // Deferreds
        deferred = jQuery.Deferred(),
        completeDeferred = jQuery.Callbacks( "once memory" ),
  
        // Status-dependent callbacks
        statusCode = s.statusCode || {},
  
        // Headers (they are sent all at once)
        requestHeaders = {},
        requestHeadersNames = {},
  
        // Default abort message
        strAbort = "canceled",
  
        // Fake xhr
        jqXHR = {
          readyState: 0,
  
          // Builds headers hashtable if needed
          getResponseHeader: function( key ) {
            var match;
            if ( completed ) {
              if ( !responseHeaders ) {
                responseHeaders = {};
                while ( ( match = rheaders.exec( responseHeadersString ) ) ) {
                  responseHeaders[ match[ 1 ].toLowerCase() + " " ] =
                    ( responseHeaders[ match[ 1 ].toLowerCase() + " " ] || [] )
                      .concat( match[ 2 ] );
                }
              }
              match = responseHeaders[ key.toLowerCase() + " " ];
            }
            return match == null ? null : match.join( ", " );
          },
  
          // Raw string
          getAllResponseHeaders: function() {
            return completed ? responseHeadersString : null;
          },
  
          // Caches the header
          setRequestHeader: function( name, value ) {
            if ( completed == null ) {
              name = requestHeadersNames[ name.toLowerCase() ] =
                requestHeadersNames[ name.toLowerCase() ] || name;
              requestHeaders[ name ] = value;
            }
            return this;
          },
  
          // Overrides response content-type header
          overrideMimeType: function( type ) {
            if ( completed == null ) {
              s.mimeType = type;
            }
            return this;
          },
  
          // Status-dependent callbacks
          statusCode: function( map ) {
            var code;
            if ( map ) {
              if ( completed ) {
  
                // Execute the appropriate callbacks
                jqXHR.always( map[ jqXHR.status ] );
              } else {
  
                // Lazy-add the new callbacks in a way that preserves old ones
                for ( code in map ) {
                  statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
                }
              }
            }
            return this;
          },
  
          // Cancel the request
          abort: function( statusText ) {
            var finalText = statusText || strAbort;
            if ( transport ) {
              transport.abort( finalText );
            }
            done( 0, finalText );
            return this;
          }
        };
  
      // Attach deferreds
      deferred.promise( jqXHR );
  
      // Add protocol if not provided (prefilters might expect it)
      // Handle falsy url in the settings object (#10093: consistency with old signature)
      // We also use the url parameter if available
      s.url = ( ( url || s.url || location.href ) + "" )
        .replace( rprotocol, location.protocol + "//" );
  
      // Alias method option to type as per ticket #12004
      s.type = options.method || options.type || s.method || s.type;
  
      // Extract dataTypes list
      s.dataTypes = ( s.dataType || "*" ).toLowerCase().match( rnothtmlwhite ) || [ "" ];
  
      // A cross-domain request is in order when the origin doesn't match the current origin.
      if ( s.crossDomain == null ) {
        urlAnchor = document.createElement( "a" );
  
        // Support: IE <=8 - 11, Edge 12 - 15
        // IE throws exception on accessing the href property if url is malformed,
        // e.g. http://example.com:80x/
        try {
          urlAnchor.href = s.url;
  
          // Support: IE <=8 - 11 only
          // Anchor's host property isn't correctly set when s.url is relative
          urlAnchor.href = urlAnchor.href;
          s.crossDomain = originAnchor.protocol + "//" + originAnchor.host !==
            urlAnchor.protocol + "//" + urlAnchor.host;
        } catch ( e ) {
  
          // If there is an error parsing the URL, assume it is crossDomain,
          // it can be rejected by the transport if it is invalid
          s.crossDomain = true;
        }
      }
  
      // Convert data if not already a string
      if ( s.data && s.processData && typeof s.data !== "string" ) {
        s.data = jQuery.param( s.data, s.traditional );
      }
  
      // Apply prefilters
      inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );
  
      // If request was aborted inside a prefilter, stop there
      if ( completed ) {
        return jqXHR;
      }
  
      // We can fire global events as of now if asked to
      // Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)
      fireGlobals = jQuery.event && s.global;
  
      // Watch for a new set of requests
      if ( fireGlobals && jQuery.active++ === 0 ) {
        jQuery.event.trigger( "ajaxStart" );
      }
  
      // Uppercase the type
      s.type = s.type.toUpperCase();
  
      // Determine if request has content
      s.hasContent = !rnoContent.test( s.type );
  
      // Save the URL in case we're toying with the If-Modified-Since
      // and/or If-None-Match header later on
      // Remove hash to simplify url manipulation
      cacheURL = s.url.replace( rhash, "" );
  
      // More options handling for requests with no content
      if ( !s.hasContent ) {
  
        // Remember the hash so we can put it back
        uncached = s.url.slice( cacheURL.length );
  
        // If data is available and should be processed, append data to url
        if ( s.data && ( s.processData || typeof s.data === "string" ) ) {
          cacheURL += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data;
  
          // #9682: remove data so that it's not used in an eventual retry
          delete s.data;
        }
  
        // Add or update anti-cache param if needed
        if ( s.cache === false ) {
          cacheURL = cacheURL.replace( rantiCache, "$1" );
          uncached = ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + ( nonce.guid++ ) +
            uncached;
        }
  
        // Put hash and anti-cache on the URL that will be requested (gh-1732)
        s.url = cacheURL + uncached;
  
      // Change '%20' to '+' if this is encoded form body content (gh-2658)
      } else if ( s.data && s.processData &&
        ( s.contentType || "" ).indexOf( "application/x-www-form-urlencoded" ) === 0 ) {
        s.data = s.data.replace( r20, "+" );
      }
  
      // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
      if ( s.ifModified ) {
        if ( jQuery.lastModified[ cacheURL ] ) {
          jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
        }
        if ( jQuery.etag[ cacheURL ] ) {
          jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
        }
      }
  
      // Set the correct header, if data is being sent
      if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
        jqXHR.setRequestHeader( "Content-Type", s.contentType );
      }
  
      // Set the Accepts header for the server, depending on the dataType
      jqXHR.setRequestHeader(
        "Accept",
        s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[ 0 ] ] ?
          s.accepts[ s.dataTypes[ 0 ] ] +
            ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
          s.accepts[ "*" ]
      );
  
      // Check for headers option
      for ( i in s.headers ) {
        jqXHR.setRequestHeader( i, s.headers[ i ] );
      }
  
      // Allow custom headers/mimetypes and early abort
      if ( s.beforeSend &&
        ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || completed ) ) {
  
        // Abort if not done already and return
        return jqXHR.abort();
      }
  
      // Aborting is no longer a cancellation
      strAbort = "abort";
  
      // Install callbacks on deferreds
      completeDeferred.add( s.complete );
      jqXHR.done( s.success );
      jqXHR.fail( s.error );
  
      // Get transport
      transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );
  
      // If no transport, we auto-abort
      if ( !transport ) {
        done( -1, "No Transport" );
      } else {
        jqXHR.readyState = 1;
  
        // Send global event
        if ( fireGlobals ) {
          globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
        }
  
        // If request was aborted inside ajaxSend, stop there
        if ( completed ) {
          return jqXHR;
        }
  
        // Timeout
        if ( s.async && s.timeout > 0 ) {
          timeoutTimer = window.setTimeout( function() {
            jqXHR.abort( "timeout" );
          }, s.timeout );
        }
  
        try {
          completed = false;
          transport.send( requestHeaders, done );
        } catch ( e ) {
  
          // Rethrow post-completion exceptions
          if ( completed ) {
            throw e;
          }
  
          // Propagate others as results
          done( -1, e );
        }
      }
  
      // Callback for when everything is done
      function done( status, nativeStatusText, responses, headers ) {
        var isSuccess, success, error, response, modified,
          statusText = nativeStatusText;
  
        // Ignore repeat invocations
        if ( completed ) {
          return;
        }
  
        completed = true;
  
        // Clear timeout if it exists
        if ( timeoutTimer ) {
          window.clearTimeout( timeoutTimer );
        }
  
        // Dereference transport for early garbage collection
        // (no matter how long the jqXHR object will be used)
        transport = undefined;
  
        // Cache response headers
        responseHeadersString = headers || "";
  
        // Set readyState
        jqXHR.readyState = status > 0 ? 4 : 0;
  
        // Determine if successful
        isSuccess = status >= 200 && status < 300 || status === 304;
  
        // Get response data
        if ( responses ) {
          response = ajaxHandleResponses( s, jqXHR, responses );
        }
  
        // Use a noop converter for missing script
        if ( !isSuccess && jQuery.inArray( "script", s.dataTypes ) > -1 ) {
          s.converters[ "text script" ] = function() {};
        }
  
        // Convert no matter what (that way responseXXX fields are always set)
        response = ajaxConvert( s, response, jqXHR, isSuccess );
  
        // If successful, handle type chaining
        if ( isSuccess ) {
  
          // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
          if ( s.ifModified ) {
            modified = jqXHR.getResponseHeader( "Last-Modified" );
            if ( modified ) {
              jQuery.lastModified[ cacheURL ] = modified;
            }
            modified = jqXHR.getResponseHeader( "etag" );
            if ( modified ) {
              jQuery.etag[ cacheURL ] = modified;
            }
          }
  
          // if no content
          if ( status === 204 || s.type === "HEAD" ) {
            statusText = "nocontent";
  
          // if not modified
          } else if ( status === 304 ) {
            statusText = "notmodified";
  
          // If we have data, let's convert it
          } else {
            statusText = response.state;
            success = response.data;
            error = response.error;
            isSuccess = !error;
          }
        } else {
  
          // Extract error from statusText and normalize for non-aborts
          error = statusText;
          if ( status || !statusText ) {
            statusText = "error";
            if ( status < 0 ) {
              status = 0;
            }
          }
        }
  
        // Set data for the fake xhr object
        jqXHR.status = status;
        jqXHR.statusText = ( nativeStatusText || statusText ) + "";
  
        // Success/Error
        if ( isSuccess ) {
          deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
        } else {
          deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
        }
  
        // Status-dependent callbacks
        jqXHR.statusCode( statusCode );
        statusCode = undefined;
  
        if ( fireGlobals ) {
          globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
            [ jqXHR, s, isSuccess ? success : error ] );
        }
  
        // Complete
        completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );
  
        if ( fireGlobals ) {
          globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );
  
          // Handle the global AJAX counter
          if ( !( --jQuery.active ) ) {
            jQuery.event.trigger( "ajaxStop" );
          }
        }
      }
  
      return jqXHR;
    },
  
    getJSON: function( url, data, callback ) {
      return jQuery.get( url, data, callback, "json" );
    },
  
    getScript: function( url, callback ) {
      return jQuery.get( url, undefined, callback, "script" );
    }
  } );
  
  jQuery.each( [ "get", "post" ], function( _i, method ) {
    jQuery[ method ] = function( url, data, callback, type ) {
  
      // Shift arguments if data argument was omitted
      if ( isFunction( data ) ) {
        type = type || callback;
        callback = data;
        data = undefined;
      }
  
      // The url can be an options object (which then must have .url)
      return jQuery.ajax( jQuery.extend( {
        url: url,
        type: method,
        dataType: type,
        data: data,
        success: callback
      }, jQuery.isPlainObject( url ) && url ) );
    };
  } );
  
  jQuery.ajaxPrefilter( function( s ) {
    var i;
    for ( i in s.headers ) {
      if ( i.toLowerCase() === "content-type" ) {
        s.contentType = s.headers[ i ] || "";
      }
    }
  } );
  
  
  jQuery._evalUrl = function( url, options, doc ) {
    return jQuery.ajax( {
      url: url,
  
      // Make this explicit, since user can override this through ajaxSetup (#11264)
      type: "GET",
      dataType: "script",
      cache: true,
      async: false,
      global: false,
  
      // Only evaluate the response if it is successful (gh-4126)
      // dataFilter is not invoked for failure responses, so using it instead
      // of the default converter is kludgy but it works.
      converters: {
        "text script": function() {}
      },
      dataFilter: function( response ) {
        jQuery.globalEval( response, options, doc );
      }
    } );
  };
  
  
  jQuery.fn.extend( {
    wrapAll: function( html ) {
      var wrap;
  
      if ( this[ 0 ] ) {
        if ( isFunction( html ) ) {
          html = html.call( this[ 0 ] );
        }
  
        // The elements to wrap the target around
        wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );
  
        if ( this[ 0 ].parentNode ) {
          wrap.insertBefore( this[ 0 ] );
        }
  
        wrap.map( function() {
          var elem = this;
  
          while ( elem.firstElementChild ) {
            elem = elem.firstElementChild;
          }
  
          return elem;
        } ).append( this );
      }
  
      return this;
    },
  
    wrapInner: function( html ) {
      if ( isFunction( html ) ) {
        return this.each( function( i ) {
          jQuery( this ).wrapInner( html.call( this, i ) );
        } );
      }
  
      return this.each( function() {
        var self = jQuery( this ),
          contents = self.contents();
  
        if ( contents.length ) {
          contents.wrapAll( html );
  
        } else {
          self.append( html );
        }
      } );
    },
  
    wrap: function( html ) {
      var htmlIsFunction = isFunction( html );
  
      return this.each( function( i ) {
        jQuery( this ).wrapAll( htmlIsFunction ? html.call( this, i ) : html );
      } );
    },
  
    unwrap: function( selector ) {
      this.parent( selector ).not( "body" ).each( function() {
        jQuery( this ).replaceWith( this.childNodes );
      } );
      return this;
    }
  } );
  
  
  jQuery.expr.pseudos.hidden = function( elem ) {
    return !jQuery.expr.pseudos.visible( elem );
  };
  jQuery.expr.pseudos.visible = function( elem ) {
    return !!( elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length );
  };
  
  
  
  
  jQuery.ajaxSettings.xhr = function() {
    try {
      return new window.XMLHttpRequest();
    } catch ( e ) {}
  };
  
  var xhrSuccessStatus = {
  
      // File protocol always yields status code 0, assume 200
      0: 200,
  
      // Support: IE <=9 only
      // #1450: sometimes IE returns 1223 when it should be 204
      1223: 204
    },
    xhrSupported = jQuery.ajaxSettings.xhr();
  
  support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
  support.ajax = xhrSupported = !!xhrSupported;
  
  jQuery.ajaxTransport( function( options ) {
    var callback, errorCallback;
  
    // Cross domain only allowed if supported through XMLHttpRequest
    if ( support.cors || xhrSupported && !options.crossDomain ) {
      return {
        send: function( headers, complete ) {
          var i,
            xhr = options.xhr();
  
          xhr.open(
            options.type,
            options.url,
            options.async,
            options.username,
            options.password
          );
  
          // Apply custom fields if provided
          if ( options.xhrFields ) {
            for ( i in options.xhrFields ) {
              xhr[ i ] = options.xhrFields[ i ];
            }
          }
  
          // Override mime type if needed
          if ( options.mimeType && xhr.overrideMimeType ) {
            xhr.overrideMimeType( options.mimeType );
          }
  
          // X-Requested-With header
          // For cross-domain requests, seeing as conditions for a preflight are
          // akin to a jigsaw puzzle, we simply never set it to be sure.
          // (it can always be set on a per-request basis or even using ajaxSetup)
          // For same-domain requests, won't change header if already provided.
          if ( !options.crossDomain && !headers[ "X-Requested-With" ] ) {
            headers[ "X-Requested-With" ] = "XMLHttpRequest";
          }
  
          // Set headers
          for ( i in headers ) {
            xhr.setRequestHeader( i, headers[ i ] );
          }
  
          // Callback
          callback = function( type ) {
            return function() {
              if ( callback ) {
                callback = errorCallback = xhr.onload =
                  xhr.onerror = xhr.onabort = xhr.ontimeout =
                    xhr.onreadystatechange = null;
  
                if ( type === "abort" ) {
                  xhr.abort();
                } else if ( type === "error" ) {
  
                  // Support: IE <=9 only
                  // On a manual native abort, IE9 throws
                  // errors on any property access that is not readyState
                  if ( typeof xhr.status !== "number" ) {
                    complete( 0, "error" );
                  } else {
                    complete(
  
                      // File: protocol always yields status 0; see #8605, #14207
                      xhr.status,
                      xhr.statusText
                    );
                  }
                } else {
                  complete(
                    xhrSuccessStatus[ xhr.status ] || xhr.status,
                    xhr.statusText,
  
                    // Support: IE <=9 only
                    // IE9 has no XHR2 but throws on binary (trac-11426)
                    // For XHR2 non-text, let the caller handle it (gh-2498)
                    ( xhr.responseType || "text" ) !== "text"  ||
                    typeof xhr.responseText !== "string" ?
                      { binary: xhr.response } :
                      { text: xhr.responseText },
                    xhr.getAllResponseHeaders()
                  );
                }
              }
            };
          };
  
          // Listen to events
          xhr.onload = callback();
          errorCallback = xhr.onerror = xhr.ontimeout = callback( "error" );
  
          // Support: IE 9 only
          // Use onreadystatechange to replace onabort
          // to handle uncaught aborts
          if ( xhr.onabort !== undefined ) {
            xhr.onabort = errorCallback;
          } else {
            xhr.onreadystatechange = function() {
  
              // Check readyState before timeout as it changes
              if ( xhr.readyState === 4 ) {
  
                // Allow onerror to be called first,
                // but that will not handle a native abort
                // Also, save errorCallback to a variable
                // as xhr.onerror cannot be accessed
                window.setTimeout( function() {
                  if ( callback ) {
                    errorCallback();
                  }
                } );
              }
            };
          }
  
          // Create the abort callback
          callback = callback( "abort" );
  
          try {
  
            // Do send the request (this may raise an exception)
            xhr.send( options.hasContent && options.data || null );
          } catch ( e ) {
  
            // #14683: Only rethrow if this hasn't been notified as an error yet
            if ( callback ) {
              throw e;
            }
          }
        },
  
        abort: function() {
          if ( callback ) {
            callback();
          }
        }
      };
    }
  } );
  
  
  
  
  // Prevent auto-execution of scripts when no explicit dataType was provided (See gh-2432)
  jQuery.ajaxPrefilter( function( s ) {
    if ( s.crossDomain ) {
      s.contents.script = false;
    }
  } );
  
  // Install script dataType
  jQuery.ajaxSetup( {
    accepts: {
      script: "text/javascript, application/javascript, " +
        "application/ecmascript, application/x-ecmascript"
    },
    contents: {
      script: /\b(?:java|ecma)script\b/
    },
    converters: {
      "text script": function( text ) {
        jQuery.globalEval( text );
        return text;
      }
    }
  } );
  
  // Handle cache's special case and crossDomain
  jQuery.ajaxPrefilter( "script", function( s ) {
    if ( s.cache === undefined ) {
      s.cache = false;
    }
    if ( s.crossDomain ) {
      s.type = "GET";
    }
  } );
  
  // Bind script tag hack transport
  jQuery.ajaxTransport( "script", function( s ) {
  
    // This transport only deals with cross domain or forced-by-attrs requests
    if ( s.crossDomain || s.scriptAttrs ) {
      var script, callback;
      return {
        send: function( _, complete ) {
          script = jQuery( "<script>" )
            .attr( s.scriptAttrs || {} )
            .prop( { charset: s.scriptCharset, src: s.url } )
            .on( "load error", callback = function( evt ) {
              script.remove();
              callback = null;
              if ( evt ) {
                complete( evt.type === "error" ? 404 : 200, evt.type );
              }
            } );
  
          // Use native DOM manipulation to avoid our domManip AJAX trickery
          document.head.appendChild( script[ 0 ] );
        },
        abort: function() {
          if ( callback ) {
            callback();
          }
        }
      };
    }
  } );
  
  
  
  
  var oldCallbacks = [],
    rjsonp = /(=)\?(?=&|$)|\?\?/;
  
  // Default jsonp settings
  jQuery.ajaxSetup( {
    jsonp: "callback",
    jsonpCallback: function() {
      var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce.guid++ ) );
      this[ callback ] = true;
      return callback;
    }
  } );
  
  // Detect, normalize options and install callbacks for jsonp requests
  jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {
  
    var callbackName, overwritten, responseContainer,
      jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
        "url" :
        typeof s.data === "string" &&
          ( s.contentType || "" )
            .indexOf( "application/x-www-form-urlencoded" ) === 0 &&
          rjsonp.test( s.data ) && "data"
      );
  
    // Handle iff the expected data type is "jsonp" or we have a parameter to set
    if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {
  
      // Get callback name, remembering preexisting value associated with it
      callbackName = s.jsonpCallback = isFunction( s.jsonpCallback ) ?
        s.jsonpCallback() :
        s.jsonpCallback;
  
      // Insert callback into url or form data
      if ( jsonProp ) {
        s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
      } else if ( s.jsonp !== false ) {
        s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
      }
  
      // Use data converter to retrieve json after script execution
      s.converters[ "script json" ] = function() {
        if ( !responseContainer ) {
          jQuery.error( callbackName + " was not called" );
        }
        return responseContainer[ 0 ];
      };
  
      // Force json dataType
      s.dataTypes[ 0 ] = "json";
  
      // Install callback
      overwritten = window[ callbackName ];
      window[ callbackName ] = function() {
        responseContainer = arguments;
      };
  
      // Clean-up function (fires after converters)
      jqXHR.always( function() {
  
        // If previous value didn't exist - remove it
        if ( overwritten === undefined ) {
          jQuery( window ).removeProp( callbackName );
  
        // Otherwise restore preexisting value
        } else {
          window[ callbackName ] = overwritten;
        }
  
        // Save back as free
        if ( s[ callbackName ] ) {
  
          // Make sure that re-using the options doesn't screw things around
          s.jsonpCallback = originalSettings.jsonpCallback;
  
          // Save the callback name for future use
          oldCallbacks.push( callbackName );
        }
  
        // Call if it was a function and we have a response
        if ( responseContainer && isFunction( overwritten ) ) {
          overwritten( responseContainer[ 0 ] );
        }
  
        responseContainer = overwritten = undefined;
      } );
  
      // Delegate to script
      return "script";
    }
  } );
  
  
  
  
  // Support: Safari 8 only
  // In Safari 8 documents created via document.implementation.createHTMLDocument
  // collapse sibling forms: the second one becomes a child of the first one.
  // Because of that, this security measure has to be disabled in Safari 8.
  // https://bugs.webkit.org/show_bug.cgi?id=137337
  support.createHTMLDocument = ( function() {
    var body = document.implementation.createHTMLDocument( "" ).body;
    body.innerHTML = "<form></form><form></form>";
    return body.childNodes.length === 2;
  } )();
  
  
  // Argument "data" should be string of html
  // context (optional): If specified, the fragment will be created in this context,
  // defaults to document
  // keepScripts (optional): If true, will include scripts passed in the html string
  jQuery.parseHTML = function( data, context, keepScripts ) {
    if ( typeof data !== "string" ) {
      return [];
    }
    if ( typeof context === "boolean" ) {
      keepScripts = context;
      context = false;
    }
  
    var base, parsed, scripts;
  
    if ( !context ) {
  
      // Stop scripts or inline event handlers from being executed immediately
      // by using document.implementation
      if ( support.createHTMLDocument ) {
        context = document.implementation.createHTMLDocument( "" );
  
        // Set the base href for the created document
        // so any parsed elements with URLs
        // are based on the document's URL (gh-2965)
        base = context.createElement( "base" );
        base.href = document.location.href;
        context.head.appendChild( base );
      } else {
        context = document;
      }
    }
  
    parsed = rsingleTag.exec( data );
    scripts = !keepScripts && [];
  
    // Single tag
    if ( parsed ) {
      return [ context.createElement( parsed[ 1 ] ) ];
    }
  
    parsed = buildFragment( [ data ], context, scripts );
  
    if ( scripts && scripts.length ) {
      jQuery( scripts ).remove();
    }
  
    return jQuery.merge( [], parsed.childNodes );
  };
  
  
  /**
   * Load a url into a page
   */
  jQuery.fn.load = function( url, params, callback ) {
    var selector, type, response,
      self = this,
      off = url.indexOf( " " );
  
    if ( off > -1 ) {
      selector = stripAndCollapse( url.slice( off ) );
      url = url.slice( 0, off );
    }
  
    // If it's a function
    if ( isFunction( params ) ) {
  
      // We assume that it's the callback
      callback = params;
      params = undefined;
  
    // Otherwise, build a param string
    } else if ( params && typeof params === "object" ) {
      type = "POST";
    }
  
    // If we have elements to modify, make the request
    if ( self.length > 0 ) {
      jQuery.ajax( {
        url: url,
  
        // If "type" variable is undefined, then "GET" method will be used.
        // Make value of this field explicit since
        // user can override it through ajaxSetup method
        type: type || "GET",
        dataType: "html",
        data: params
      } ).done( function( responseText ) {
  
        // Save response for use in complete callback
        response = arguments;
  
        self.html( selector ?
  
          // If a selector was specified, locate the right elements in a dummy div
          // Exclude scripts to avoid IE 'Permission Denied' errors
          jQuery( "<div>" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :
  
          // Otherwise use the full result
          responseText );
  
      // If the request succeeds, this function gets "data", "status", "jqXHR"
      // but they are ignored because response was set above.
      // If it fails, this function gets "jqXHR", "status", "error"
      } ).always( callback && function( jqXHR, status ) {
        self.each( function() {
          callback.apply( this, response || [ jqXHR.responseText, status, jqXHR ] );
        } );
      } );
    }
  
    return this;
  };
  
  
  
  
  jQuery.expr.pseudos.animated = function( elem ) {
    return jQuery.grep( jQuery.timers, function( fn ) {
      return elem === fn.elem;
    } ).length;
  };
  
  
  
  
  jQuery.offset = {
    setOffset: function( elem, options, i ) {
      var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
        position = jQuery.css( elem, "position" ),
        curElem = jQuery( elem ),
        props = {};
  
      // Set position first, in-case top/left are set even on static elem
      if ( position === "static" ) {
        elem.style.position = "relative";
      }
  
      curOffset = curElem.offset();
      curCSSTop = jQuery.css( elem, "top" );
      curCSSLeft = jQuery.css( elem, "left" );
      calculatePosition = ( position === "absolute" || position === "fixed" ) &&
        ( curCSSTop + curCSSLeft ).indexOf( "auto" ) > -1;
  
      // Need to be able to calculate position if either
      // top or left is auto and position is either absolute or fixed
      if ( calculatePosition ) {
        curPosition = curElem.position();
        curTop = curPosition.top;
        curLeft = curPosition.left;
  
      } else {
        curTop = parseFloat( curCSSTop ) || 0;
        curLeft = parseFloat( curCSSLeft ) || 0;
      }
  
      if ( isFunction( options ) ) {
  
        // Use jQuery.extend here to allow modification of coordinates argument (gh-1848)
        options = options.call( elem, i, jQuery.extend( {}, curOffset ) );
      }
  
      if ( options.top != null ) {
        props.top = ( options.top - curOffset.top ) + curTop;
      }
      if ( options.left != null ) {
        props.left = ( options.left - curOffset.left ) + curLeft;
      }
  
      if ( "using" in options ) {
        options.using.call( elem, props );
  
      } else {
        if ( typeof props.top === "number" ) {
          props.top += "px";
        }
        if ( typeof props.left === "number" ) {
          props.left += "px";
        }
        curElem.css( props );
      }
    }
  };
  
  jQuery.fn.extend( {
  
    // offset() relates an element's border box to the document origin
    offset: function( options ) {
  
      // Preserve chaining for setter
      if ( arguments.length ) {
        return options === undefined ?
          this :
          this.each( function( i ) {
            jQuery.offset.setOffset( this, options, i );
          } );
      }
  
      var rect, win,
        elem = this[ 0 ];
  
      if ( !elem ) {
        return;
      }
  
      // Return zeros for disconnected and hidden (display: none) elements (gh-2310)
      // Support: IE <=11 only
      // Running getBoundingClientRect on a
      // disconnected node in IE throws an error
      if ( !elem.getClientRects().length ) {
        return { top: 0, left: 0 };
      }
  
      // Get document-relative position by adding viewport scroll to viewport-relative gBCR
      rect = elem.getBoundingClientRect();
      win = elem.ownerDocument.defaultView;
      return {
        top: rect.top + win.pageYOffset,
        left: rect.left + win.pageXOffset
      };
    },
  
    // position() relates an element's margin box to its offset parent's padding box
    // This corresponds to the behavior of CSS absolute positioning
    position: function() {
      if ( !this[ 0 ] ) {
        return;
      }
  
      var offsetParent, offset, doc,
        elem = this[ 0 ],
        parentOffset = { top: 0, left: 0 };
  
      // position:fixed elements are offset from the viewport, which itself always has zero offset
      if ( jQuery.css( elem, "position" ) === "fixed" ) {
  
        // Assume position:fixed implies availability of getBoundingClientRect
        offset = elem.getBoundingClientRect();
  
      } else {
        offset = this.offset();
  
        // Account for the *real* offset parent, which can be the document or its root element
        // when a statically positioned element is identified
        doc = elem.ownerDocument;
        offsetParent = elem.offsetParent || doc.documentElement;
        while ( offsetParent &&
          ( offsetParent === doc.body || offsetParent === doc.documentElement ) &&
          jQuery.css( offsetParent, "position" ) === "static" ) {
  
          offsetParent = offsetParent.parentNode;
        }
        if ( offsetParent && offsetParent !== elem && offsetParent.nodeType === 1 ) {
  
          // Incorporate borders into its offset, since they are outside its content origin
          parentOffset = jQuery( offsetParent ).offset();
          parentOffset.top += jQuery.css( offsetParent, "borderTopWidth", true );
          parentOffset.left += jQuery.css( offsetParent, "borderLeftWidth", true );
        }
      }
  
      // Subtract parent offsets and element margins
      return {
        top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
        left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
      };
    },
  
    // This method will return documentElement in the following cases:
    // 1) For the element inside the iframe without offsetParent, this method will return
    //    documentElement of the parent window
    // 2) For the hidden or detached element
    // 3) For body or html element, i.e. in case of the html node - it will return itself
    //
    // but those exceptions were never presented as a real life use-cases
    // and might be considered as more preferable results.
    //
    // This logic, however, is not guaranteed and can change at any point in the future
    offsetParent: function() {
      return this.map( function() {
        var offsetParent = this.offsetParent;
  
        while ( offsetParent && jQuery.css( offsetParent, "position" ) === "static" ) {
          offsetParent = offsetParent.offsetParent;
        }
  
        return offsetParent || documentElement;
      } );
    }
  } );
  
  // Create scrollLeft and scrollTop methods
  jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
    var top = "pageYOffset" === prop;
  
    jQuery.fn[ method ] = function( val ) {
      return access( this, function( elem, method, val ) {
  
        // Coalesce documents and windows
        var win;
        if ( isWindow( elem ) ) {
          win = elem;
        } else if ( elem.nodeType === 9 ) {
          win = elem.defaultView;
        }
  
        if ( val === undefined ) {
          return win ? win[ prop ] : elem[ method ];
        }
  
        if ( win ) {
          win.scrollTo(
            !top ? val : win.pageXOffset,
            top ? val : win.pageYOffset
          );
  
        } else {
          elem[ method ] = val;
        }
      }, method, val, arguments.length );
    };
  } );
  
  // Support: Safari <=7 - 9.1, Chrome <=37 - 49
  // Add the top/left cssHooks using jQuery.fn.position
  // Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
  // Blink bug: https://bugs.chromium.org/p/chromium/issues/detail?id=589347
  // getComputedStyle returns percent when specified for top/left/bottom/right;
  // rather than make the css module depend on the offset module, just check for it here
  jQuery.each( [ "top", "left" ], function( _i, prop ) {
    jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
      function( elem, computed ) {
        if ( computed ) {
          computed = curCSS( elem, prop );
  
          // If curCSS returns percentage, fallback to offset
          return rnumnonpx.test( computed ) ?
            jQuery( elem ).position()[ prop ] + "px" :
            computed;
        }
      }
    );
  } );
  
  
  // Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
  jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
    jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name },
      function( defaultExtra, funcName ) {
  
      // Margin is only for outerHeight, outerWidth
      jQuery.fn[ funcName ] = function( margin, value ) {
        var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
          extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );
  
        return access( this, function( elem, type, value ) {
          var doc;
  
          if ( isWindow( elem ) ) {
  
            // $( window ).outerWidth/Height return w/h including scrollbars (gh-1729)
            return funcName.indexOf( "outer" ) === 0 ?
              elem[ "inner" + name ] :
              elem.document.documentElement[ "client" + name ];
          }
  
          // Get document width or height
          if ( elem.nodeType === 9 ) {
            doc = elem.documentElement;
  
            // Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
            // whichever is greatest
            return Math.max(
              elem.body[ "scroll" + name ], doc[ "scroll" + name ],
              elem.body[ "offset" + name ], doc[ "offset" + name ],
              doc[ "client" + name ]
            );
          }
  
          return value === undefined ?
  
            // Get width or height on the element, requesting but not forcing parseFloat
            jQuery.css( elem, type, extra ) :
  
            // Set width or height on the element
            jQuery.style( elem, type, value, extra );
        }, type, chainable ? margin : undefined, chainable );
      };
    } );
  } );
  
  
  jQuery.each( [
    "ajaxStart",
    "ajaxStop",
    "ajaxComplete",
    "ajaxError",
    "ajaxSuccess",
    "ajaxSend"
  ], function( _i, type ) {
    jQuery.fn[ type ] = function( fn ) {
      return this.on( type, fn );
    };
  } );
  
  
  
  
  jQuery.fn.extend( {
  
    bind: function( types, data, fn ) {
      return this.on( types, null, data, fn );
    },
    unbind: function( types, fn ) {
      return this.off( types, null, fn );
    },
  
    delegate: function( selector, types, data, fn ) {
      return this.on( types, selector, data, fn );
    },
    undelegate: function( selector, types, fn ) {
  
      // ( namespace ) or ( selector, types [, fn] )
      return arguments.length === 1 ?
        this.off( selector, "**" ) :
        this.off( types, selector || "**", fn );
    },
  
    hover: function( fnOver, fnOut ) {
      return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
    }
  } );
  
  jQuery.each( ( "blur focus focusin focusout resize scroll click dblclick " +
    "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
    "change select submit keydown keypress keyup contextmenu" ).split( " " ),
    function( _i, name ) {
  
      // Handle event binding
      jQuery.fn[ name ] = function( data, fn ) {
        return arguments.length > 0 ?
          this.on( name, null, data, fn ) :
          this.trigger( name );
      };
    } );
  
  
  
  
  // Support: Android <=4.0 only
  // Make sure we trim BOM and NBSP
  var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
  
  // Bind a function to a context, optionally partially applying any
  // arguments.
  // jQuery.proxy is deprecated to promote standards (specifically Function#bind)
  // However, it is not slated for removal any time soon
  jQuery.proxy = function( fn, context ) {
    var tmp, args, proxy;
  
    if ( typeof context === "string" ) {
      tmp = fn[ context ];
      context = fn;
      fn = tmp;
    }
  
    // Quick check to determine if target is callable, in the spec
    // this throws a TypeError, but we will just return undefined.
    if ( !isFunction( fn ) ) {
      return undefined;
    }
  
    // Simulated bind
    args = slice.call( arguments, 2 );
    proxy = function() {
      return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
    };
  
    // Set the guid of unique handler to the same of original handler, so it can be removed
    proxy.guid = fn.guid = fn.guid || jQuery.guid++;
  
    return proxy;
  };
  
  jQuery.holdReady = function( hold ) {
    if ( hold ) {
      jQuery.readyWait++;
    } else {
      jQuery.ready( true );
    }
  };
  jQuery.isArray = Array.isArray;
  jQuery.parseJSON = JSON.parse;
  jQuery.nodeName = nodeName;
  jQuery.isFunction = isFunction;
  jQuery.isWindow = isWindow;
  jQuery.camelCase = camelCase;
  jQuery.type = toType;
  
  jQuery.now = Date.now;
  
  jQuery.isNumeric = function( obj ) {
  
    // As of jQuery 3.0, isNumeric is limited to
    // strings and numbers (primitives or objects)
    // that can be coerced to finite numbers (gh-2662)
    var type = jQuery.type( obj );
    return ( type === "number" || type === "string" ) &&
  
      // parseFloat NaNs numeric-cast false positives ("")
      // ...but misinterprets leading-number strings, particularly hex literals ("0x...")
      // subtraction forces infinities to NaN
      !isNaN( obj - parseFloat( obj ) );
  };
  
  jQuery.trim = function( text ) {
    return text == null ?
      "" :
      ( text + "" ).replace( rtrim, "" );
  };
  
  
  
  // Register as a named AMD module, since jQuery can be concatenated with other
  // files that may use define, but not via a proper concatenation script that
  // understands anonymous AMD modules. A named AMD is safest and most robust
  // way to register. Lowercase jquery is used because AMD module names are
  // derived from file names, and jQuery is normally delivered in a lowercase
  // file name. Do this after creating the global so that if an AMD module wants
  // to call noConflict to hide this version of jQuery, it will work.
  
  // Note that for maximum portability, libraries that are not jQuery should
  // declare themselves as anonymous modules, and avoid setting a global if an
  // AMD loader is present. jQuery is a special case. For more information, see
  // https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon
  
  if ( true ) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function() {
      return jQuery;
    }).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
          __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  }
  
  
  
  
  var
  
    // Map over jQuery in case of overwrite
    _jQuery = window.jQuery,
  
    // Map over the $ in case of overwrite
    _$ = window.$;
  
  jQuery.noConflict = function( deep ) {
    if ( window.$ === jQuery ) {
      window.$ = _$;
    }
  
    if ( deep && window.jQuery === jQuery ) {
      window.jQuery = _jQuery;
    }
  
    return jQuery;
  };
  
  // Expose jQuery and $ identifiers, even in AMD
  // (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
  // and CommonJS for browser emulators (#13566)
  if ( typeof noGlobal === "undefined" ) {
    window.jQuery = window.$ = jQuery;
  }
  
  
  
  
  return jQuery;
  } );
  
  
  /***/ }),
  
  /***/ "./node_modules/jquery/dist/jquery.js-exposed":
  /*!****************************************************!*\
    !*** ./node_modules/jquery/dist/jquery.js-exposed ***!
    \****************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global) {module.exports = global["jQuery"] = __webpack_require__(/*! -!./node_modules/expose-loader?$!./jquery.js */ "./node_modules/expose-loader/index.js?$!./node_modules/jquery/dist/jquery.js-exposed");
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "./node_modules/process/browser.js":
  /*!*****************************************!*\
    !*** ./node_modules/process/browser.js ***!
    \*****************************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  // shim for using process in browser
  var process = module.exports = {}; // cached from whatever global is present so that test runners that stub it
  // don't break things.  But we need to wrap it in a try catch in case it is
  // wrapped in strict mode code which doesn't define any globals.  It's inside a
  // function because try/catches deoptimize in certain engines.
  
  var cachedSetTimeout;
  var cachedClearTimeout;
  
  function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
  }
  
  function defaultClearTimeout() {
    throw new Error('clearTimeout has not been defined');
  }
  
  (function () {
    try {
      if (typeof setTimeout === 'function') {
        cachedSetTimeout = setTimeout;
      } else {
        cachedSetTimeout = defaultSetTimout;
      }
    } catch (e) {
      cachedSetTimeout = defaultSetTimout;
    }
  
    try {
      if (typeof clearTimeout === 'function') {
        cachedClearTimeout = clearTimeout;
      } else {
        cachedClearTimeout = defaultClearTimeout;
      }
    } catch (e) {
      cachedClearTimeout = defaultClearTimeout;
    }
  })();
  
  function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
      //normal enviroments in sane situations
      return setTimeout(fun, 0);
    } // if setTimeout wasn't available but was latter defined
  
  
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
      cachedSetTimeout = setTimeout;
      return setTimeout(fun, 0);
    }
  
    try {
      // when when somebody has screwed with setTimeout but no I.E. maddness
      return cachedSetTimeout(fun, 0);
    } catch (e) {
      try {
        // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
        return cachedSetTimeout.call(null, fun, 0);
      } catch (e) {
        // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
        return cachedSetTimeout.call(this, fun, 0);
      }
    }
  }
  
  function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
      //normal enviroments in sane situations
      return clearTimeout(marker);
    } // if clearTimeout wasn't available but was latter defined
  
  
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
      cachedClearTimeout = clearTimeout;
      return clearTimeout(marker);
    }
  
    try {
      // when when somebody has screwed with setTimeout but no I.E. maddness
      return cachedClearTimeout(marker);
    } catch (e) {
      try {
        // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
        return cachedClearTimeout.call(null, marker);
      } catch (e) {
        // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
        // Some versions of I.E. have different rules for clearTimeout vs setTimeout
        return cachedClearTimeout.call(this, marker);
      }
    }
  }
  
  var queue = [];
  var draining = false;
  var currentQueue;
  var queueIndex = -1;
  
  function cleanUpNextTick() {
    if (!draining || !currentQueue) {
      return;
    }
  
    draining = false;
  
    if (currentQueue.length) {
      queue = currentQueue.concat(queue);
    } else {
      queueIndex = -1;
    }
  
    if (queue.length) {
      drainQueue();
    }
  }
  
  function drainQueue() {
    if (draining) {
      return;
    }
  
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;
    var len = queue.length;
  
    while (len) {
      currentQueue = queue;
      queue = [];
  
      while (++queueIndex < len) {
        if (currentQueue) {
          currentQueue[queueIndex].run();
        }
      }
  
      queueIndex = -1;
      len = queue.length;
    }
  
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
  }
  
  process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
  
    if (arguments.length > 1) {
      for (var i = 1; i < arguments.length; i++) {
        args[i - 1] = arguments[i];
      }
    }
  
    queue.push(new Item(fun, args));
  
    if (queue.length === 1 && !draining) {
      runTimeout(drainQueue);
    }
  }; // v8 likes predictible objects
  
  
  function Item(fun, array) {
    this.fun = fun;
    this.array = array;
  }
  
  Item.prototype.run = function () {
    this.fun.apply(null, this.array);
  };
  
  process.title = 'browser';
  process.browser = true;
  process.env = {};
  process.argv = [];
  process.version = ''; // empty string to avoid regexp issues
  
  process.versions = {};
  
  function noop() {}
  
  process.on = noop;
  process.addListener = noop;
  process.once = noop;
  process.off = noop;
  process.removeListener = noop;
  process.removeAllListeners = noop;
  process.emit = noop;
  process.prependListener = noop;
  process.prependOnceListener = noop;
  
  process.listeners = function (name) {
    return [];
  };
  
  process.binding = function (name) {
    throw new Error('process.binding is not supported');
  };
  
  process.cwd = function () {
    return '/';
  };
  
  process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
  };
  
  process.umask = function () {
    return 0;
  };
  
  /***/ }),
  
  /***/ "./node_modules/setimmediate/setImmediate.js":
  /*!***************************************************!*\
    !*** ./node_modules/setimmediate/setImmediate.js ***!
    \***************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {
    "use strict";
  
    if (global.setImmediate) {
      return;
    }
  
    var nextHandle = 1; // Spec says greater than zero
  
    var tasksByHandle = {};
    var currentlyRunningATask = false;
    var doc = global.document;
    var registerImmediate;
  
    function setImmediate(callback) {
      // Callback can either be a function or a string
      if (typeof callback !== "function") {
        callback = new Function("" + callback);
      } // Copy function arguments
  
  
      var args = new Array(arguments.length - 1);
  
      for (var i = 0; i < args.length; i++) {
        args[i] = arguments[i + 1];
      } // Store and register the task
  
  
      var task = {
        callback: callback,
        args: args
      };
      tasksByHandle[nextHandle] = task;
      registerImmediate(nextHandle);
      return nextHandle++;
    }
  
    function clearImmediate(handle) {
      delete tasksByHandle[handle];
    }
  
    function run(task) {
      var callback = task.callback;
      var args = task.args;
  
      switch (args.length) {
        case 0:
          callback();
          break;
  
        case 1:
          callback(args[0]);
          break;
  
        case 2:
          callback(args[0], args[1]);
          break;
  
        case 3:
          callback(args[0], args[1], args[2]);
          break;
  
        default:
          callback.apply(undefined, args);
          break;
      }
    }
  
    function runIfPresent(handle) {
      // From the spec: "Wait until any invocations of this algorithm started before this one have completed."
      // So if we're currently running a task, we'll need to delay this invocation.
      if (currentlyRunningATask) {
        // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a
        // "too much recursion" error.
        setTimeout(runIfPresent, 0, handle);
      } else {
        var task = tasksByHandle[handle];
  
        if (task) {
          currentlyRunningATask = true;
  
          try {
            run(task);
          } finally {
            clearImmediate(handle);
            currentlyRunningATask = false;
          }
        }
      }
    }
  
    function installNextTickImplementation() {
      registerImmediate = function registerImmediate(handle) {
        process.nextTick(function () {
          runIfPresent(handle);
        });
      };
    }
  
    function canUsePostMessage() {
      // The test against `importScripts` prevents this implementation from being installed inside a web worker,
      // where `global.postMessage` means something completely different and can't be used for this purpose.
      if (global.postMessage && !global.importScripts) {
        var postMessageIsAsynchronous = true;
        var oldOnMessage = global.onmessage;
  
        global.onmessage = function () {
          postMessageIsAsynchronous = false;
        };
  
        global.postMessage("", "*");
        global.onmessage = oldOnMessage;
        return postMessageIsAsynchronous;
      }
    }
  
    function installPostMessageImplementation() {
      // Installs an event handler on `global` for the `message` event: see
      // * https://developer.mozilla.org/en/DOM/window.postMessage
      // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages
      var messagePrefix = "setImmediate$" + Math.random() + "$";
  
      var onGlobalMessage = function onGlobalMessage(event) {
        if (event.source === global && typeof event.data === "string" && event.data.indexOf(messagePrefix) === 0) {
          runIfPresent(+event.data.slice(messagePrefix.length));
        }
      };
  
      if (global.addEventListener) {
        global.addEventListener("message", onGlobalMessage, false);
      } else {
        global.attachEvent("onmessage", onGlobalMessage);
      }
  
      registerImmediate = function registerImmediate(handle) {
        global.postMessage(messagePrefix + handle, "*");
      };
    }
  
    function installMessageChannelImplementation() {
      var channel = new MessageChannel();
  
      channel.port1.onmessage = function (event) {
        var handle = event.data;
        runIfPresent(handle);
      };
  
      registerImmediate = function registerImmediate(handle) {
        channel.port2.postMessage(handle);
      };
    }
  
    function installReadyStateChangeImplementation() {
      var html = doc.documentElement;
  
      registerImmediate = function registerImmediate(handle) {
        // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
        // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
        var script = doc.createElement("script");
  
        script.onreadystatechange = function () {
          runIfPresent(handle);
          script.onreadystatechange = null;
          html.removeChild(script);
          script = null;
        };
  
        html.appendChild(script);
      };
    }
  
    function installSetTimeoutImplementation() {
      registerImmediate = function registerImmediate(handle) {
        setTimeout(runIfPresent, 0, handle);
      };
    } // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.
  
  
    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
    attachTo = attachTo && attachTo.setTimeout ? attachTo : global; // Don't get fooled by e.g. browserify environments.
  
    if ({}.toString.call(global.process) === "[object process]") {
      // For Node.js before 0.9
      installNextTickImplementation();
    } else if (canUsePostMessage()) {
      // For non-IE10 modern browsers
      installPostMessageImplementation();
    } else if (global.MessageChannel) {
      // For web workers, where supported
      installMessageChannelImplementation();
    } else if (doc && "onreadystatechange" in doc.createElement("script")) {
      // For IE 68
      installReadyStateChangeImplementation();
    } else {
      // For older browsers
      installSetTimeoutImplementation();
    }
  
    attachTo.setImmediate = setImmediate;
    attachTo.clearImmediate = clearImmediate;
  })(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self);
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js"), __webpack_require__(/*! ./../process/browser.js */ "./node_modules/process/browser.js")))
  
  /***/ }),
  
  /***/ "./node_modules/timers-browserify/main.js":
  /*!************************************************!*\
    !*** ./node_modules/timers-browserify/main.js ***!
    \************************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  /* WEBPACK VAR INJECTION */(function(global) {var scope = typeof global !== "undefined" && global || typeof self !== "undefined" && self || window;
  var apply = Function.prototype.apply; // DOM APIs, for completeness
  
  exports.setTimeout = function () {
    return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);
  };
  
  exports.setInterval = function () {
    return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);
  };
  
  exports.clearTimeout = exports.clearInterval = function (timeout) {
    if (timeout) {
      timeout.close();
    }
  };
  
  function Timeout(id, clearFn) {
    this._id = id;
    this._clearFn = clearFn;
  }
  
  Timeout.prototype.unref = Timeout.prototype.ref = function () {};
  
  Timeout.prototype.close = function () {
    this._clearFn.call(scope, this._id);
  }; // Does not start the time, just sets up the members needed.
  
  
  exports.enroll = function (item, msecs) {
    clearTimeout(item._idleTimeoutId);
    item._idleTimeout = msecs;
  };
  
  exports.unenroll = function (item) {
    clearTimeout(item._idleTimeoutId);
    item._idleTimeout = -1;
  };
  
  exports._unrefActive = exports.active = function (item) {
    clearTimeout(item._idleTimeoutId);
    var msecs = item._idleTimeout;
  
    if (msecs >= 0) {
      item._idleTimeoutId = setTimeout(function onTimeout() {
        if (item._onTimeout) item._onTimeout();
      }, msecs);
    }
  }; // setimmediate attaches itself to the global object
  
  
  __webpack_require__(/*! setimmediate */ "./node_modules/setimmediate/setImmediate.js"); // On some exotic environments, it's not clear which object `setimmediate` was
  // able to install onto.  Search each possibility in the same order as the
  // `setimmediate` library.
  
  
  exports.setImmediate = typeof self !== "undefined" && self.setImmediate || typeof global !== "undefined" && global.setImmediate || this && this.setImmediate;
  exports.clearImmediate = typeof self !== "undefined" && self.clearImmediate || typeof global !== "undefined" && global.clearImmediate || this && this.clearImmediate;
  /* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))
  
  /***/ }),
  
  /***/ "./node_modules/webpack/buildin/global.js":
  /*!***********************************!*\
    !*** (webpack)/buildin/global.js ***!
    \***********************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  var _typeof = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "./node_modules/@babel/runtime/helpers/typeof.js");
  
  var g; // This works in non-strict mode
  
  g = function () {
    return this;
  }();
  
  try {
    // This works if eval is allowed (see CSP)
    g = g || new Function("return this")();
  } catch (e) {
    // This works if the window reference is available
    if ((typeof window === "undefined" ? "undefined" : _typeof(window)) === "object") g = window;
  } // g can still be undefined, but nothing to do about it...
  // We return undefined, instead of nothing here, so it's
  // easier to handle this case. if(!global) { ...}
  
  
  module.exports = g;
  
  /***/ }),
  
  /***/ "./node_modules/webpack/buildin/module.js":
  /*!***********************************!*\
    !*** (webpack)/buildin/module.js ***!
    \***********************************/
  /*! no static exports found */
  /***/ (function(module, exports) {
  
  module.exports = function (module) {
    if (!module.webpackPolyfill) {
      module.deprecate = function () {};
  
      module.paths = []; // module.parent = undefined by default
  
      if (!module.children) module.children = [];
      Object.defineProperty(module, "loaded", {
        enumerable: true,
        get: function get() {
          return module.l;
        }
      });
      Object.defineProperty(module, "id", {
        enumerable: true,
        get: function get() {
          return module.i;
        }
      });
      module.webpackPolyfill = 1;
    }
  
    return module;
  };
  
  /***/ }),
  
  /***/ 0:
  /*!******************************************!*\
    !*** multi ./js/all.js ./js/sourceJs.js ***!
    \******************************************/
  /*! no static exports found */
  /***/ (function(module, exports, __webpack_require__) {
  
  __webpack_require__(/*! ./js/all.js */"./js/all.js");
  module.exports = __webpack_require__(/*! /home/irahhal/ui-products/sbn/js/sourceJs.js */"./js/sourceJs.js");
  
  
  /***/ })
  
  /******/ });
  //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianMvbWFpbi5idW5kbGUtYmRlODhmNWIxYjc3YjliMzQwYjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9iYXNpYy9iYXNlL2pzL2Jhc2UuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9iYXNpYy9iYXNlL2pzL3BhZ2VCb2R5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvYmFzaWMvaW5wdXRzL2pzL2lucHV0cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2Jhc2ljL2xpc3RzL2pzL2xpc3QuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL2FjY29yZGlvbi9qcy9hY2NvcmRpb24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL2FydGljbGUtYWN0aW9ucy1iYXIvanMvYXJ0aWNsZS1hY3Rpb24tYmFyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9hdXRvc2F2ZS1mb3JtL2pzL2F1dG9zYXZlLWZvcm0uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL2JhY2stdG8tdG9wL2pzL2JhY2stdG8tdG9wLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9jbGllbnQtcGFnaW5hdGlvbi9qcy9jbGllbnQtcGFnaW5hdGlvbi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2NvbXBvbmVudHMvY29vbGJhci9qcy9jb29sYmFyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9jb3VudGVyL2pzL2NvdW50ZXIuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL2RhdGVwaWNrZXIvanMvZGF0ZXBpY2tlci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2NvbXBvbmVudHMvZHJvcC1ibG9jay9qcy9kcm9wLWJsb2NrLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9lZGl0LWluLXBsYWNlL2pzL2VkaXQtaW4tcGxhY2UuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL2ZhY2V0LWRhdGUtY2hhcnQvanMvZmFjZXQtZGF0ZS1jaGFydC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2NvbXBvbmVudHMvZmFjZXQtZGF0ZS9qcy9mYWNldC1kYXRlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9maWd1cmUtdmlld2VyL2pzL2ZpZ3VyZS12aWV3ZXItc2NyaXB0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy9tb2RhbC9qcy9tb2RhbC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2NvbXBvbmVudHMvcHJvZ3Jlc3MtYmFyL2pzL3Byb2dyZXNzLWJhci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL2NvbXBvbmVudHMvcmVmaW5lLXNlYXJjaC9qcy9yZWZpbmUtc2VhcmNoLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy90YWJsZXMvanMvc29ydGFibGUtdGFibGUtcm93LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy90YWJsZXMvanMvdGFibGVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvY29tcG9uZW50cy90YWJzL2pzL3RhYnMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9jb21wb25lbnRzL3RydW5jYXRlci9qcy90cnVuY2F0ZXIuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hcnJheUxpa2VUb0FycmF5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXJyYXlXaXRob3V0SG9sZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjay5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pdGVyYWJsZVRvQXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9ub25JdGVyYWJsZVNwcmVhZC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3RvQ29uc3VtYWJsZUFycmF5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvYS1mdW5jdGlvbi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9hLXBvc3NpYmxlLXByb3RvdHlwZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9hbi1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvYXJyYXktZnJvbS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9hcnJheS1pbmNsdWRlcy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9jYWxsLXdpdGgtc2FmZS1pdGVyYXRpb24tY2xvc2luZy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9jaGVjay1jb3JyZWN0bmVzcy1vZi1pdGVyYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY2xhc3NvZi1yYXcuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY2xhc3NvZi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9jb3B5LWNvbnN0cnVjdG9yLXByb3BlcnRpZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY29ycmVjdC1wcm90b3R5cGUtZ2V0dGVyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2NyZWF0ZS1pdGVyYXRvci1jb25zdHJ1Y3Rvci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9jcmVhdGUtbm9uLWVudW1lcmFibGUtcHJvcGVydHkuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY3JlYXRlLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY3JlYXRlLXByb3BlcnR5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2RlZmluZS1pdGVyYXRvci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9kZXNjcmlwdG9ycy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9kb2N1bWVudC1jcmVhdGUtZWxlbWVudC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9lbnVtLWJ1Zy1rZXlzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2V4cG9ydC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9mYWlscy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9mdW5jdGlvbi1iaW5kLWNvbnRleHQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvZ2V0LWJ1aWx0LWluLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2dldC1pdGVyYXRvci1tZXRob2QuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvZ2xvYmFsLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2hhcy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9oaWRkZW4ta2V5cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9odG1sLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2llOC1kb20tZGVmaW5lLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2luZGV4ZWQtb2JqZWN0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2luc3BlY3Qtc291cmNlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2ludGVybmFsLXN0YXRlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2lzLWFycmF5LWl0ZXJhdG9yLW1ldGhvZC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9pcy1mb3JjZWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvaXMtb2JqZWN0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2lzLXB1cmUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvaXRlcmF0b3ItY2xvc2UuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvaXRlcmF0b3JzLWNvcmUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvaXRlcmF0b3JzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL25hdGl2ZS1zeW1ib2wuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvbmF0aXZlLXdlYWstbWFwLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL29iamVjdC1hc3NpZ24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWNyZWF0ZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9vYmplY3QtZGVmaW5lLXByb3BlcnRpZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9vYmplY3QtZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL29iamVjdC1nZXQtb3duLXByb3BlcnR5LW5hbWVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL29iamVjdC1nZXQtb3duLXByb3BlcnR5LXN5bWJvbHMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWdldC1wcm90b3R5cGUtb2YuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWtleXMtaW50ZXJuYWwuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWtleXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LXByb3BlcnR5LWlzLWVudW1lcmFibGUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LXNldC1wcm90b3R5cGUtb2YuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb3duLWtleXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvcGF0aC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9yZWRlZmluZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9yZXF1aXJlLW9iamVjdC1jb2VyY2libGUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvc2V0LWdsb2JhbC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9zZXQtdG8tc3RyaW5nLXRhZy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9zaGFyZWQta2V5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL3NoYXJlZC1zdG9yZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9zaGFyZWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvc3RyaW5nLW11bHRpYnl0ZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy90by1hYnNvbHV0ZS1pbmRleC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy90by1pbmRleGVkLW9iamVjdC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy90by1pbnRlZ2VyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL3RvLWxlbmd0aC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy90by1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvdG8tcHJpbWl0aXZlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL3RvLXN0cmluZy10YWctc3VwcG9ydC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy91aWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvdXNlLXN5bWJvbC1hcy11aWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvd2VsbC1rbm93bi1zeW1ib2wuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL25vZGVfbW9kdWxlcy9lbGVtZW50LWNsb3Nlc3QtcG9seWZpbGwvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvZm9udGZhY2VvYnNlcnZlci9mb250ZmFjZW9ic2VydmVyLnN0YW5kYWxvbmUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9ub2RlX21vZHVsZXMvdW5mZXRjaC9wb2x5ZmlsbC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvQWpheFVwbG9hZGVyL1VwbG9hZGVyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9BamF4VXBsb2FkZXIvbGliL1VwbG9hZGVyRmlsZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvQWpheFVwbG9hZGVyL2xpYi9WYWxpZGF0aW9uRXhjZXB0aW9uLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9BamF4VXBsb2FkZXIvbGliL3BvbHlmaWxscy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvQWpheFVwbG9hZGVyL2xpYi91dGlscy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvYWNjb3JkaW9uL2pzL2FjY29yZGlvbi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvY29udHJvbGxlci9qcy9jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9jb29raWVzL2pzL2Nvb2tpZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL2NvcHktdGV4dC9qcy9jb3B5LXRleHQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL2N1c3RvbS1mb3JtL2pzL2pjZi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvY3VzdG9tLWZvcm0vanMvamNmLnJhbmdlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9kcmF3ZXIvanMvZHJhd2VyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9kcmF3ZXIvanMvbWVudS1hY2Nlc3NhYmlsaXR5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9lbnF1aXJlSnMvanMvZW5xdWlyZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvanF1ZXJ5LXVpL2pxdWVyeS11aS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvanF1ZXJ5LXVpL2pxdWVyeS51aS50b3VjaC1wdW5jaC5taW4uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL2pxdWVyeS9qcXVlcnktbWlncmF0ZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvbGF6eWxvYWQvanMvanF1ZXJ5Lmxhenlsb2FkLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9saXRlcmF0dW0vZXZlbnRzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9saXRlcmF0dW0vaW1wb3J0cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvbGl0ZXJhdHVtL2xpdGVyYXR1bS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvbGl0ZXJhdHVtL2xvYWRpbmcvZnVsbFBhZ2VMb2FkaW5nLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9saXRlcmF0dW0vbG9hZGluZy9sb2FkaW5nLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9saXRlcmF0dW0vd2lkZ2V0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9saXRlcmF0dW0vd2lkZ2V0cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvbWFnaWNTZWFyY2gvanMvbWFnaWNzdWdnZXN0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9tb2RhbC9qcy9tb2RhbC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvb3dsLWNhcm91c2VsL2pzL293bC5jYXJvdXNlbC5taW4uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3Bhbnpvb20vanF1ZXJ5LnBhbnpvb20uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3BvbHlmaWxscy9qcy9DdXN0b21FdmVudC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL0VsZW1lbnQvY2xvc2VzdC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL0VsZW1lbnQvbWF0Y2hlcy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL0VsZW1lbnQvcmVtb3ZlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9wb2x5ZmlsbHMvanMvTm9kZUxpc3QvZm9yRWFjaC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL09iamVjdC5hc3NpZ24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3BvbHlmaWxscy9qcy9Qcm9taXNlL2VzNi1wcm9taXNlLmF1dG8ubWluLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9wb2x5ZmlsbHMvanMvUHJvbWlzZS9lczYtcHJvbWlzZS5taW4uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3BvbHlmaWxscy9qcy9Qcm9taXNlL2luZGV4LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9wb2x5ZmlsbHMvanMvUHJvbWlzZS9wcm9taXNlLXBvbHlmaWxsLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9wb2x5ZmlsbHMvanMvUHJvbWlzZS9zZXRBc2FwLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9wb2x5ZmlsbHMvanMvU3RyaW5nL2Zvcm1hdC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL1N0cmluZy9pbmNsdWRlcy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvcG9seWZpbGxzL2pzL3BvbHlmaWxsLm9iamVjdC52YWx1ZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3BvbHlmaWxscy9qcy9yZXNpemVPYnNlcnZlclBvbHlmaWxsL2Rpc3QvUmVzaXplT2JzZXJ2ZXIuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3NsaWRlL2pzL3NsaWRlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy9zdGlja3liaXRzL2pzL3N0aWNreWJpdHMuZXMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS9wbHVnaW5zL3RhYnMvanMvdGFicy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvdG91Y2hTd2lwZS9qcXVlcnkudG91Y2hTd2lwZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3BsdWdpbnMvdHJhbnNwbGFudC9qcy90cmFuc3BsYW50LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy90cnVuY2F0ZS9qcy9pbml0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvcGx1Z2lucy90cnVuY2F0ZS9qcy90cnVuY2F0ZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3V0aWxpdHkvYWItbG9nZ2VyL2pzL2FiLWxvZ2dlci5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3V0aWxpdHkvanMvYWRkVGhpc0VuaGFuY2VtZW50LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvdXRpbGl0eS9qcy9ib290c3RyYXAtdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS91dGlsaXR5L2pzL2pxdWVyeS5zZWxlY3Rvci5mb2N1c2FibGUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS91dGlsaXR5L2pzL25hbWVzcGFjZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3V0aWxpdHkvanMvbm8tZm9jdXNhYmxlLXN2Zy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3V0aWxpdHkvanMvb2JzZXJ2ZS1kb20uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS91dGlsaXR5L2pzL3Rlc3RzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvdXRpbGl0eS9qcy91dGlscy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3V0aWxpdHkvbG9hZC1mb250cy9qcy9sb2FkLWZvbnRzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvdXRpbGl0eS9yZXNpemVkLWV2ZW50L2pzL3Jlc2l6ZWQtZXZlbnQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL2FkLXBsYWNlaG9sZGVyL2pzL2FkLXBsYWNlaG9sZGVyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9hZG1pbmlzdHJhdG9ycy9qcy9hZG1pbmlzdHJhdG9ycy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvYWR2YW5jZWQtc2VhcmNoL2pzL2FkdmFuY2VkLXNlYXJjaC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvYWR2aXNvci1hY3Rpb24tcmVjb3Jkcy9qcy9hZHZpc29yLWFjdGlvbi1yZWNvcmRzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9hcnRpY2xlLXRvb2xzL2pzL2FydGljbGUtdG9vbHMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL2F1dGhvci1oaXN0b3J5L2pzL2F1dGhvci1oaXN0b3J5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9hdXRob3ItaGlzdG9yeS9qcy9taW1pY2tlZC1hdXRob3ItaGlzdG9yeS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvYXV0aG9yLWluZGV4L2pzL2F1dGhvci1pbmRleC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvY29va2llLXBvbGljeS1wb3B1cC9qcy9jb29raWUtcG9saWN5LXBvcHVwLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9kZXZpY2UtcGFpcmluZy9qcy9kZXZpY2UtcGFpcmluZy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvZGlzYWJsZS1hZGJsb2NrZXIvanMvZGlzYWJsZS1hZGJsb2NrZXIuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL2V4YW0tY2VydGlmaWNhdGUvanMvZXhhbS1jZXJ0aWZpY2F0ZS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvZXhwb3J0LWNpdGF0aW9ucy9qcy9leHBvcnQtY2l0YXRpb25zLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9mYXZvcml0ZXMvanMvZmF2b3JpdGVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9saXN0LW9mLWlzc3Vlcy1kZXRhaWxlZC9qcy9saXN0LW9mLWlzc3Vlcy1hY2NvcmRpb24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL2xpc3Qtb2YtaXNzdWVzL2pzL2xvaS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvbWFuYWdlLWFsZXJ0cy9qcy9tYW5hZ2UtYWxlcnRzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9tZW51L2pzL3Jlc3BvbnNpdmUtbWVudS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvbXVsdGktc2VhcmNoL2pzL211bHRpLXNlYXJjaC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvcGFpcmluZy1tYW5hZ2VtZW50L2pzL3BhaXJpbmctbWFuYWdlbWVudC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvcGNtLWFkZC1saWJyYXJ5L2pzL3BjbS1hZGQtbGlicmFyeS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvcGQtYWN0aW9uLWJhci9qcy9taW1pY2tlZC1wZC1hY3Rpb24tYmFyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1hY3Rpb24tYmFyL2pzL3BkLWFjdGlvbi1iYXIuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3BkLWF1dGhvcnMvanMvbWltaWNrZWQtcGQtYXV0aG9zLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1hdXRob3JzL2pzL3BkLWF1dGhvcnMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3BkLWJhc2ljLW1ldGFkYXRhL2pzL21pbWlja2VkLXBkLWJhc2ljLW1ldGFkYXRhLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1iYXNpYy1tZXRhZGF0YS9qcy9wZC1iYXNpYy1tZXRhZGF0YS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvcGQtZ3JhbnRzL2pzL2Z1bmRlcnMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3BkLWdyYW50cy9qcy9taW1pY2tlZC1mdW5kZXJzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1tZXRhZGF0YS1mb3JtL2pzL3BkLW1ldGFkYXRhLWZvcm0uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3BkLXBkZi9qcy9wZC1wZGYuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3BkLXNlYXJjaC1jYXRlZ29yaWVzL2pzL3BkLXNlYXJjaC1jYXRlZ29yaWVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1zdWJtaXNzaW9uLWxpc3QvanMvcGQtc3VibWlzc2lvbi1saXN0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1zdXBwbGVtZW50YWwtZmlsZXMvanMvcGQtc3VwcGxlbWVudGFsLWZpbGVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wZC1zdXBwbGVtZW50YWwtbGlua3MvanMvcGQtc3VwcGxlbWVudGFsLWxpbmtzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wcm9maWxlLW1haW4vanMvcHJvZmlsZS1tYWluLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wcm9maWxlLW1lbnUvanMvcHJvZmlsZS1tZW51LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wdWJsaWNhdGlvbi1jb250ZW50L2pzL2Nyb3NzcmVmLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9wdWJsaWNhdGlvbi1jb250ZW50L2pzL3B1YmxpY2F0aW9uLWNvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3F1aWNrLXNlYXJjaC9qcy9xdWljay1zZWFyY2guanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3JhYS9qcy9yYWEuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3JhYS9qcy90d28tZmFjdG9ycy1hdXRoZW50aWNhdGlvbi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvcmVtb3RlLWFjY2Vzcy1lbWFpbC1kb21haW5zL2pzL3JlbW90ZS1hY2Nlc3MtZW1haWwtZG9tYWlucy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvc2VhcmNoLXJlc3VsdC9qcy9zZWFyY2gtcmVzdWx0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy9zaG93LXJlY29tbWVuZGVkL2pzL3Nob3ctcmVjb21tZW5kZWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3NsaWRlc2hvdy9qcy9zaG93Y2FzZS1zbGlkZXNob3cuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3RhYmxlLW9mLWNvbnRlbnQvanMvdGFibGUtb2YtY29udGVudC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS1jb3JlL3dpZGdldHMvdHJ1c3RlZC1wcm94eS9qcy90cnVzdGVkLXByb3h5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLWNvcmUvd2lkZ2V0cy90d28tZmFjdG9yLWF1dGhlbnRpY2F0aW9uL2pzL3R3by1mYWN0b3ItYXV0aGVudGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktY29yZS93aWRnZXRzL3VzYWdlLXJlcG9ydHMvanMvdXNhZ2UtcmVwb3J0cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL2pzL18uZGVib3VuY2UuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9fZGVwcmVjYXRlZC5wb2x5ZmlsbC0talF1ZXJ5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvX2RlcHJlY2F0ZWQucG9seWZpbGwuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9fZW5xdWlyZUl0LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvX2ZpbGwtcG9seWZpbGwuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9fbG9hZC1mb250cy5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL2pzL19zdGlja3kuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9hbGwuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9jb21wb25lbnRzL19hY2NvcmRpb24uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9jb21wb25lbnRzL190b2dnbGUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9jb21wb25lbnRzL2FydGljbGUuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9jb21wb25lbnRzL2Zvcm0uanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy9jb21wb25lbnRzL3NsaWRlLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvY29tcG9uZW50cy90YWJzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvY29tcG9uZW50cy90cmFuc3BsYW50LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvc291cmNlSnMuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL19ib29rLXByb2R1Y3QuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL19jb2xsYXBzaWJsZS1tZW51LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvd2lkZ2V0cy9fZHJhd2VyLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvanMvd2lkZ2V0cy9fZHJvcEJsb2NrVWwuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL19vdmVycmlkZS1sb2ktYWpheC5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL2pzL3dpZGdldHMvX3B1YmxpY2F0aW9uLWNvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL19xdWljay1zZWFyY2guanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL19zbGlkZXNob3cuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9qcy93aWRnZXRzL190YWJsZS1vZi1jb250ZW50LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXJyYXlMaWtlVG9BcnJheS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2FycmF5V2l0aG91dEhvbGVzLmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaXRlcmFibGVUb0FycmF5LmpzIiwid2VicGFjazovLy8vaG9tZS9pcmFoaGFsL3VpLXRoZW1lLWNsYXNzaWMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvbm9uSXRlcmFibGVTcHJlYWQuanMiLCJ3ZWJwYWNrOi8vLy9ob21lL2lyYWhoYWwvdWktdGhlbWUtY2xhc3NpYy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90b0NvbnN1bWFibGVBcnJheS5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3R5cGVvZi5qcyIsIndlYnBhY2s6Ly8vL2hvbWUvaXJhaGhhbC91aS10aGVtZS1jbGFzc2ljL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5LmpzIiwid2VicGFjazovLy8uL2pzL2FsbC5qcyIsIndlYnBhY2s6Ly8vLi9qcy9jb21wb25lbnRzL2ZhY2V0LWRhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vanMvc291cmNlSnMuanMiLCJ3ZWJwYWNrOi8vLy4vanMvdGVtcGxhdGVzL3B1Ymxpc2hlci5qcyIsIndlYnBhY2s6Ly8vLi9qcy93aWRnZXRzL2FsZXJ0cy5qcyIsIndlYnBhY2s6Ly8vLi9qcy93aWRnZXRzL2Zvcm0tYWN0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi9qcy93aWRnZXRzL3B1YmxpY2F0aW9uLWNvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9qcXVlcnkvZGlzdC9qcXVlcnkuanMtZXhwb3NlZCIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvanF1ZXJ5L2Rpc3QvanF1ZXJ5LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3NldGltbWVkaWF0ZS9zZXRJbW1lZGlhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3RpbWVycy1icm93c2VyaWZ5L21haW4uanMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuXG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdH07XG5cblxuIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3NcbiBcdC8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuIFx0Ly8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiBcdHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG4gXHRcdFwibWFpbi5idW5kbGVcIjogMFxuIFx0fTtcblxuXG5cbiBcdC8vIHNjcmlwdCBwYXRoIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBqc29ucFNjcmlwdFNyYyhjaHVua0lkKSB7XG4gXHRcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBcImpzL1wiICsgKHt9W2NodW5rSWRdfHxjaHVua0lkKSArIFwiLVwiICsge1wiMFwiOlwiZDk3ZmUwNGYwODFjMGE4MTIzYWVcIn1bY2h1bmtJZF0gKyBcIi5qc1wiXG4gXHR9XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuIFx0Ly8gVGhpcyBmaWxlIGNvbnRhaW5zIG9ubHkgdGhlIGVudHJ5IGNodW5rLlxuIFx0Ly8gVGhlIGNodW5rIGxvYWRpbmcgZnVuY3Rpb24gZm9yIGFkZGl0aW9uYWwgY2h1bmtzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmUgPSBmdW5jdGlvbiByZXF1aXJlRW5zdXJlKGNodW5rSWQpIHtcbiBcdFx0dmFyIHByb21pc2VzID0gW107XG5cblxuIFx0XHQvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG5cbiBcdFx0dmFyIGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcbiBcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7IC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG4gXHRcdFx0Ly8gYSBQcm9taXNlIG1lYW5zIFwiY3VycmVudGx5IGxvYWRpbmdcIi5cbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcbiBcdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdKTtcbiBcdFx0XHR9IGVsc2Uge1xuIFx0XHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuIFx0XHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiBcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF07XG4gXHRcdFx0XHR9KTtcbiBcdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSk7XG5cbiBcdFx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcbiBcdFx0XHRcdHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiBcdFx0XHRcdHZhciBvblNjcmlwdENvbXBsZXRlO1xuXG4gXHRcdFx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG4gXHRcdFx0XHRzY3JpcHQudGltZW91dCA9IDEyMDtcbiBcdFx0XHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKSB7XG4gXHRcdFx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcbiBcdFx0XHRcdH1cbiBcdFx0XHRcdHNjcmlwdC5zcmMgPSBqc29ucFNjcmlwdFNyYyhjaHVua0lkKTtcblxuIFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuIFx0XHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG4gXHRcdFx0XHRvblNjcmlwdENvbXBsZXRlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gXHRcdFx0XHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cbiBcdFx0XHRcdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcbiBcdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuIFx0XHRcdFx0XHR2YXIgY2h1bmsgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF07XG4gXHRcdFx0XHRcdGlmKGNodW5rICE9PSAwKSB7XG4gXHRcdFx0XHRcdFx0aWYoY2h1bmspIHtcbiBcdFx0XHRcdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG4gXHRcdFx0XHRcdFx0XHR2YXIgcmVhbFNyYyA9IGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuc3JjO1xuIFx0XHRcdFx0XHRcdFx0ZXJyb3IubWVzc2FnZSA9ICdMb2FkaW5nIGNodW5rICcgKyBjaHVua0lkICsgJyBmYWlsZWQuXFxuKCcgKyBlcnJvclR5cGUgKyAnOiAnICsgcmVhbFNyYyArICcpJztcbiBcdFx0XHRcdFx0XHRcdGVycm9yLm5hbWUgPSAnQ2h1bmtMb2FkRXJyb3InO1xuIFx0XHRcdFx0XHRcdFx0ZXJyb3IudHlwZSA9IGVycm9yVHlwZTtcbiBcdFx0XHRcdFx0XHRcdGVycm9yLnJlcXVlc3QgPSByZWFsU3JjO1xuIFx0XHRcdFx0XHRcdFx0Y2h1bmtbMV0oZXJyb3IpO1xuIFx0XHRcdFx0XHRcdH1cbiBcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG4gXHRcdFx0XHRcdH1cbiBcdFx0XHRcdH07XG4gXHRcdFx0XHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiBcdFx0XHRcdFx0b25TY3JpcHRDb21wbGV0ZSh7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSk7XG4gXHRcdFx0XHR9LCAxMjAwMDApO1xuIFx0XHRcdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gb25TY3JpcHRDb21wbGV0ZTtcbiBcdFx0XHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0cmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbiBcdH07XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gb24gZXJyb3IgZnVuY3Rpb24gZm9yIGFzeW5jIGxvYWRpbmdcbiBcdF9fd2VicGFja19yZXF1aXJlX18ub2UgPSBmdW5jdGlvbihlcnIpIHsgY29uc29sZS5lcnJvcihlcnIpOyB0aHJvdyBlcnI7IH07XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wXCJdID0gd2luZG93W1wid2VicGFja0pzb25wXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiXG4oZnVuY3Rpb24gKCkge1xuICAgIHZhciBpT1MgPSAvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAhd2luZG93Lk1TU3RyZWFtO1xuXG4gICAgaWYgKGlPUykge1xuICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ2lPUycpO1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkXG4gICAgICovXG4gICAgVVgucGFnZUJvZHkgPSB7XG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0cmFDb250cm9scygpO1xuICAgICAgICB9LFxuICAgICAgICBleHRyYUNvbnRyb2xzKCkge1xuICAgICAgICB9LFxuICAgICAgICB1cmxQYXJhbSA6IHtcbiAgICAgICAgICAgIHJlcGxhY2U6ICh1cmwsIHBhcmFtTmFtZSwgcGFyYW1WYWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbVZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1WYWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgcGF0dGVybiA9IG5ldyBSZWdFeHAoJ1xcXFxiKCcgKyBwYXJhbU5hbWUgKyAnPSkuKj8oJnwjfCQpJyk7XG4gICAgICAgICAgICAgICAgaWYgKHVybC5zZWFyY2gocGF0dGVybikgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsLnJlcGxhY2UocGF0dGVybiwgJyQxJyArIHBhcmFtVmFsdWUgKyAnJDInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoL1s/I10kLywgJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAodXJsLmluZGV4T2YoJz8nKSA+IDAgPyAnJicgOiAnPycpICsgcGFyYW1OYW1lICsgJz0nICsgcGFyYW1WYWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZW1vdmU6ICh1cmwsIHBhcmFtTmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBwYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXFxcXGIoJyArIHBhcmFtTmFtZSArICc9KS4qPygmfCN8JCknKTtcbiAgICAgICAgICAgICAgICBpZiAodXJsLnNlYXJjaChwYXR0ZXJuKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKHBhdHRlcm4sICcnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybC5yZXBsYWNlKC9cXCYrJC9nLCAnJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGVzdDogKHVybCwgcGFyYW1OYW1lLCBwYXJhbVZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHBhdHRlcm47XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtVmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXFxcXGIoJyArIHBhcmFtTmFtZSArICc9JyArIHBhcmFtVmFsdWUrICcpLio/KCZ8I3wkKScpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBuZXcgUmVnRXhwKCdcXFxcYignICsgcGFyYW1OYW1lICsgJykuKj8oJnwjfCQpJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm4udGVzdCh1cmwpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0UGFyYW1WYWw6IGZ1bmN0aW9uICh1cmwsIHBhcmFtTmFtZSkge1xuICAgICAgICAgICAgICAgIGxldCB2YXJzID0ge307XG4gICAgICAgICAgICAgICAgdXJsLnJlcGxhY2UoL1s/Jl0rKFtePSZdKyk9KFteJl0qKS9naSwgZnVuY3Rpb24gKG0sIGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhcnNbcGFyYW1OYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGJvZHkgPSAkKCdib2R5JyksXG4gICAgICAgIGlzTW9iaWxlID0gZmFsc2U7XG5cbiAgICB2YXIgZmllbGRzQ3RybCA9IHtcbiAgICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgICAkd3JhcHBlcjogbnVsbCxcbiAgICAgICAgJHRvZ2dsZTogbnVsbCxcbiAgICAgICAgJGZvcm06IG51bGwsXG4gICAgICAgICR0ZXJtczogbnVsbCxcbiAgICAgICAgJG1hcmtBbGw6IG51bGwsXG4gICAgICAgIG1heENsb25lOiAyLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgZmllbGRzQ3RybC4kdG9nZ2xlID0gJCgnLnJlcHJvZHVjaWJsZScpO1xuICAgICAgICAgICAgZmllbGRzQ3RybC4kd3JhcHBlciA9ICQoJy5yZXByb2R1Y2libGVfX3dyYXBwZXInKTtcbiAgICAgICAgICAgIGZpZWxkc0N0cmwuY29udGFpbmVyID0gJy5yZXByb2R1Y2libGVfX2NvbnRhaW5lcic7IC8vIFN1cHBvcnQgZm9yIHRoZSBsZWdhY3kgZW1haWxzIGFuZCBwaG9uZXMgdXNlZCBpbiBhY2NvdW50IHBhZ2VcblxuICAgICAgICAgICAgLy9maWVsZHNDdHJsLmNoZWNrLnRlcm1zKCk7XG4gICAgICAgICAgICBmaWVsZHNDdHJsLmNvbnRyb2woKTtcblxuICAgICAgICAgICAgdmFyICRsYXN0VGVybSA9IGZpZWxkc0N0cmwuJHdyYXBwZXIuY2hpbGRyZW4oJy5yZXByb2R1Y2libGUnKS5sZW5ndGg7XG4gICAgICAgICAgICBmaWVsZHNDdHJsLmNoZWNrLmxhc3RDbG9uZSgkbGFzdFRlcm0pO1xuXG5cbiAgICAgICAgICAgIGZpZWxkc0N0cmwuYWNjZXNzaWJpbGl0eS5pbml0KCk7XG4gICAgICAgICAgICBmaWVsZHNDdHJsLmFkZGl0aW9uYWxDb250cm9scygpO1xuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NpYmlsaXR5OiB7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yYWRpb0NoZWNrYm94KCk7XG4gICAgICAgICAgICAgICAgaWYoJCgnLmZvcmNlLS1kaXNhYmxlZCcpLmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RCb3goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5idXR0b25zLmluaXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmFkaW9DaGVja2JveDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByYWRpb0NoZWNrYm94U2VsZWN0b3IgPSAnLnJhZGlvLS1wcmltYXJ5LCAucmFkaW8tLXNlY29uZGFyeSwgLmNoZWNrYm94LS1wcmltYXJ5LCAuY2hlY2tib3gtLXNlY29uZGFyeSc7XG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ21vdXNlZG93bicsIHJhZGlvQ2hlY2tib3hTZWxlY3RvciwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmF0dHIoe3RhYmluZGV4OiAwfSk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfSkub24oJ21vdXNldXAnLCByYWRpb0NoZWNrYm94U2VsZWN0b3IsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVBdHRyKCd0YWJpbmRleCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3dpdGhJbnB1dCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCdpbnB1dFt0eXBlPWVtYWlsXSwgaW5wdXRbdHlwZT10ZXh0XScpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCdpbnB1dFt0eXBlPXJhZGlvXSwgaW5wdXRbdHlwZT1jaGVja2JveF0nKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0Qm94OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gSkNGIHNlbGVjdGJveFxuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWRvd24nLCAnLmpjZi1zZWxlY3QnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuYXR0cih7dGFiaW5kZXg6IDB9KTtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuc2libGluZ3MoJy5qY2YtaGlkZGVuJykuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9KS5vbignbW91c2V1cCcsICcuamNmLXNlbGVjdCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVBdHRyKCd0YWJpbmRleCcpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5zaWJsaW5ncygnLmpjZi1oaWRkZW4nKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5zaWJsaW5ncygnLmpjZi1oaWRkZW4nKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgJ3NlbGVjdC5qY2YtaGlkZGVuJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGV2ZW50LndoaWNoID09PSAyNyAmJiAkKHRoaXMpLnNpYmxpbmdzKCcuamNmLWRyb3AtYWN0aXZlJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQud2hpY2ggPSAxMztcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykudHJpZ2dlcihldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIEhpZGUgb24gYmx1clxuICAgICAgICAgICAgICAgIC8vIG5vdGUgaXQgZG9lc24ndCB3b3JrIG92ZXIgZG9jdW1lbnQgc2VsZWN0b3IsIGV2ZW50IGlzIG5vdCBmaXJlZFxuICAgICAgICAgICAgICAgICQoJ3NlbGVjdC5qY2YtaGlkZGVuJykub24oJ2JsdXInLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBrZXkgd2FzIHByZXNzZWQsIHRoYW4gd2UgbmVlZCB0byBvcGVyYXRlIHdpdGggcmVsYXRlZCB0YXJnZXQsIG5vdCBvcmlnaW5hbCB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgaWYoZXZlbnQucmVsYXRlZFRhcmdldCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZXZlbnQucmVsYXRlZFRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGpjZi5nZXRJbnN0YW5jZSgkdGhpc1swXSkuaW5zdGFuY2U7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzSW5zaWRlU2VsZWN0ID0gdGFyZ2V0LmZpbHRlcihpbnN0YW5jZS5yZWFsRWxlbWVudCkubGVuZ3RoIHx8IHRhcmdldC5jbG9zZXN0KGluc3RhbmNlLmZha2VFbGVtZW50KS5sZW5ndGggfHwgdGFyZ2V0LmNsb3Nlc3QoaW5zdGFuY2UuZHJvcGRvd24pLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZvY3VzSW5zaWRlU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5oaWRlRHJvcGRvd24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYnV0dG9uczoge1xuICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEVuYWJsZSBTY3JlZW4gcmVhZGVyIHN0YW5kYXJkIGJlaGF2aW9yIG9uIHNwYWNlIGFuZCBlbnRlciBmb3IgW3JvbGU9YnV0dG9uc10gdG8gYmUgY29uc2lzdGVudCB3aXRoIG5vcm1hbCBidXR0b24gZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsICdhW3JvbGU9YnV0dG9uXScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXZlbnQud2hpY2ggPT09IDMyIHx8IGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHByZXBhcmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIEhSRUY9IyBvbiBhW3JvbGU9YnV0dG9uXSBhcyBzY3JlZW4tcmVhZGVyIHdvdWxkIHJlYWQgd2hvbGUgcGFnZSBVUkwgb3RoZXJ3aXNlIG9uIGZvY3VzXG4gICAgICAgICAgICAgICAgICAgICQoJ2Fbcm9sZT1idXR0b25dJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhyZWYgPSAkdGhpcy5hdHRyKCdocmVmJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBocmVmID0gaHJlZiA9PT0gJyMnID8gbnVsbCA6IGhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJHRoaXMuZGF0YSgndGFyZ2V0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5hdHRyKHsnZGF0YS10YXJnZXQnOiB0YXJnZXQgfHwgaHJlZiwgJ3RhYmluZGV4JzogMH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWhyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVBdHRyKCdocmVmJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByYW5nZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIHJhbmdlIHNsaWRlciBhY2Nlc3NpYmxlIGJ5IGtleWJvYXJkIGV2ZW4gaWYgaXQncyBpbiBzbGlkZXNob3csIHdlIHdhbnQgdG8gY2F0Y2gga2V5IGFycm93cyBhbmQgc3RvcCBldmVudCBwcm9wYWdhdGlvblxuICAgICAgICAgICAgICAgICQoJ2lucHV0W3R5cGU9XCJyYW5nZVwiXScpLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIERPV046IDQwLFxuICAgICAgICAgICAgICAgICAgICAgICAgRU5EOiAzNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIEhPTUU6IDM2LFxuICAgICAgICAgICAgICAgICAgICAgICAgTEVGVDogMzcsXG4gICAgICAgICAgICAgICAgICAgICAgICBSSUdIVDogMzksXG4gICAgICAgICAgICAgICAgICAgICAgICBVUDogMzhcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nIGZvciBub3QgYWxsb3dlZCBrZXlzXG4gICAgICAgICAgICAgICAgICAgIGlmKCEoT2JqZWN0LnZhbHVlcyhrZXlDb2RlcykuaW5kZXhPZihldmVudC5rZXlDb2RlKSA+IC0xKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGNhdGNoIGRyYWdnaW5nXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb250cm9sOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkYm9keS5vbigna2V5cHJlc3MgY2xpY2snLCAnW2NsYXNzKj1cIi1jdHJsLWZpZWxkXCJdJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMgfHwgZS50eXBlID09PSAnY2xpY2snKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzQ3RybC4kd3JhcHBlciA9ICQodGhpcykuY2xvc2VzdCgnLnJlcHJvZHVjaWJsZV9fd3JhcHBlcicpO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiR0b2dnbGUgPSAkKHRoaXMpLmNsb3Nlc3QoJy5yZXByb2R1Y2libGUnKTtcblxuICAgICAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiR0ZXJtcyA9ICQodGhpcykuY2xvc2VzdCgnLnJlcHJvZHVjaWJsZV9fd3JhcHBlcicpLmZpbmQoJy5yZXByb2R1Y2libGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBMSVQtMTYxNzc4IFN1cHBvcnQgZm9yIHRoZSBsZWdhY3kgZW1haWxzIGFuZCBwaG9uZXMgdXNlZCBpbiBhY2NvdW50IHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoZmllbGRzQ3RybC5jb250YWluZXIpLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5pcygnLmFkZC1jdHJsLWZpZWxkJykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZHNDdHJsLiR0ZXJtcy5sZW5ndGggPCAoZmllbGRzQ3RybC5tYXhDbG9uZSArIDEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkc0N0cmwub24uY2xvbmUoJCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkc0N0cmwuJHRlcm1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzQ3RybC5vbi5yZW1vdmUoJCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJ1tuYW1lPVwibWFya2FsbFwiXScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLm9uLm1hcmtBbGwoJCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuICAgICAgICBhZGRpdGlvbmFsQ29udHJvbHM6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB9LFxuICAgICAgICBvbjoge1xuICAgICAgICAgICAgY2xvbmU6IGZ1bmN0aW9uICgkdGhpcykge1xuICAgICAgICAgICAgICAgIGpjZi5kZXN0cm95KCQoJy5yZXByb2R1Y2libGUgLmpjZicpKTtcblxuICAgICAgICAgICAgICAgIGZpZWxkc0N0cmwuJHRvZ2dsZS5jbG9uZSh0cnVlLCB0cnVlKS5maW5kKCdpbnB1dCcpLnZhbCgnJykuZW5kKCkuYXBwZW5kVG8oZmllbGRzQ3RybC4kd3JhcHBlcik7XG5cbiAgICAgICAgICAgICAgICAkKCcucmVwcm9kdWNpYmxlIC5qY2YnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgamNmLnJlcGxhY2UoJCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLmNoZWNrLnRlcm1zKCR0aGlzKTtcblxuICAgICAgICAgICAgICAgIHZhciAkbGFzdFRlcm0gPSBmaWVsZHNDdHJsLiR3cmFwcGVyLmNoaWxkcmVuKCcucmVwcm9kdWNpYmxlJykubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZpZWxkc0N0cmwuY2hlY2subGFzdENsb25lKCRsYXN0VGVybSk7XG5cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKCR0aGlzKSB7XG5cbiAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiR0b2dnbGUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgZmllbGRzQ3RybC5jaGVjay50ZXJtcygkdGhpcyk7XG4gICAgICAgICAgICAgICAgdmFyICRsYXN0VGVybSA9IGZpZWxkc0N0cmwuJHdyYXBwZXIuY2hpbGRyZW4oJy5yZXByb2R1Y2libGUnKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZmllbGRzQ3RybC5jaGVjay5sYXN0Q2xvbmUoJGxhc3RUZXJtKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG1hcmtBbGw6IGZ1bmN0aW9uICgkZWwpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiRtYXJrQWxsID0gJGVsLmNsb3Nlc3QoJy5tYXJrQWxsJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJGVsLnByb3AoJ2NoZWNrZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiRtYXJrQWxsLmZpbmQoJ1t0eXBlPVwiY2hlY2tib3hcIl0nKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiRtYXJrQWxsLmZpbmQoJ1t0eXBlPVwiY2hlY2tib3hcIl0nKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgfSxcbiAgICAgICAgY2hlY2s6IHtcbiAgICAgICAgICAgIHRlcm1zIDogZnVuY3Rpb24gKCR0aGlzKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgbmFtZUlucHV0ID0gJHRoaXMuY2xvc2VzdCgnLnJlcHJvZHVjaWJsZScpLmZpbmQoJ2lucHV0JykuYXR0cignbmFtZScpO1xuXG4gICAgICAgICAgICAgICBpZihuYW1lSW5wdXQpe1xuICAgICAgICAgICAgICAgICAgIHZhciBiZWZvcmUgPSBuYW1lSW5wdXQuc3BsaXQoXCJbXCIpO1xuICAgICAgICAgICAgICAgICAgIHZhciBhZnRlciA9IGJlZm9yZVsxXS5zcGxpdChcIl1cIik7XG4gICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIC8qdmFyIG1hdGNoZXMgPSBuYW1lSW5wdXQubWF0Y2goL1xcWyguKj8pXFxdLyk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Ym1hdGNoID0gbWF0Y2hlc1sxXTtcbiAgICAgICAgICAgICAgICB9Ki9cblxuICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQgZm9yIHRoZSBsZWdhY3kgZW1haWxzIGFuZCBwaG9uZXMgdXNlZCBpbiBhY2NvdW50IHBhZ2VcbiAgICAgICAgICAgICAgICBpZiAoJChmaWVsZHNDdHJsLmNvbnRhaW5lcikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzQ3RybC4kdGVybXMgPSAkKCcucmVwcm9kdWNpYmxlJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzQ3RybC4kdGVybXMgPSAkdGhpcy5wYXJlbnRzKGZpZWxkc0N0cmwuY29udGFpbmVyKS5maW5kKCcucmVwcm9kdWNpYmxlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb3B5X2Zyb21fdGVtcGxhdGUgPSAwO1xuICAgICAgICAgICAgICAgIGZpZWxkc0N0cmwuJHRlcm1zLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkZWwgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgkZWwucGFyZW50cygnLnRlbXBsYXRlJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3B5X2Zyb21fdGVtcGxhdGUgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG51bWJlciA9IGluZGV4IC0gY29weV9mcm9tX3RlbXBsYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdpbnB1dCcpLmF0dHIoJ25hbWUnLCBiZWZvcmVbMF0gKyBcIltcIiArIG51bWJlciArIFwiXVwiICsgYWZ0ZXJbMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBmaWVsZHNDdHJsLiR0ZXJtcyA9ICQoJy5yZXByb2R1Y2libGUnKTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIGZpZWxkc0N0cmwuJHRlcm1zLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciBudW1iZXIgPSBpbmRleDtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vICAgICAkKHRoaXMpLmZpbmQoJ2lucHV0JykuYXR0cignbmFtZScsIGJlZm9yZVswXSArIFwiW1wiICsgaW5kZXggKyBcIl1cIiArIGFmdGVyWzFdKTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxhc3RDbG9uZTogZnVuY3Rpb24gKCR0aGlzKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMgPT0gZmllbGRzQ3RybC5tYXhDbG9uZSkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHNDdHJsLiR3cmFwcGVyLmNoaWxkcmVuKCcucmVwcm9kdWNpYmxlOmxhc3QtY2hpbGQnKS5jaGlsZHJlbignLmFkZC1jdHJsLWZpZWxkJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzQ3RybC4kd3JhcHBlci5jaGlsZHJlbignLnJlcHJvZHVjaWJsZTpsYXN0LWNoaWxkJykuY2hpbGRyZW4oJy5hZGQtY3RybC1maWVsZCcpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgVVguZmllbGRzQ3RybCA9IGZpZWxkc0N0cmw7IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpO1xuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgIGxldCAkYm9keSA9ICQoJ2JvZHknKSxcbiAgICAgICAgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7XG5cbiAgICBsZXQgbGlzdCA9IHtcbiAgICAgICAgZXhwYW5kSWNvbjogJ2ljb24tYWRkX2JveCcsXG4gICAgICAgIGNvbGxhcHNlSWNvbjogJ2ljb24tc3F1YXJlZC1taW51cycsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGlzdC5vbi5idWlsZCgpO1xuICAgICAgICAgICAgbGlzdC5jb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJy5leHBhbmRhYmxlLWxpc3RfX3RvZ2dsZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGxpc3Qub24udG9nZ2xlTGlzdCgkKHRoaXMpKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgICBidWlsZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCAkd3JhcHBlciA9ICQoJy5leHBhbmRhYmxlLWxpc3QnKTtcbiAgICAgICAgICAgICAgICBsZXQgJHRvZ2dsZSA9ICQoJy5leHBhbmRhYmxlLWxpc3RfX3RvZ2dsZScpO1xuXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCAkdGFyZ2V0ID0gJCh0aGlzKS5maW5kKCcuZXhwYW5kYWJsZS1saXN0X19ib2R5Jyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCAkdG9nZ2xlID0gJCh0aGlzKS5maW5kKCcuZXhwYW5kYWJsZS1saXN0X190b2dnbGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0LmhpZGUoKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdG9nZ2xlTGlzdDogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICBsZXQgJHRvZ2dsZSA9IGVsZW0sXG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyID0gJHRvZ2dsZS5jbG9zZXN0KCcuZXhwYW5kYWJsZS1saXN0JyksXG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQgPSAkd3JhcHBlci5jaGlsZHJlbignLmV4cGFuZGFibGUtbGlzdF9fYm9keScpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGxpc3QuZGVmaW5lVG9nZ2xlSWNvbnMoJHdyYXBwZXIpO1xuXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIudG9nZ2xlQ2xhc3MoJ2pzLS1vcGVuJyk7XG4gICAgICAgICAgICAgICAgJHRvZ2dsZS5maW5kKCdpJykudG9nZ2xlQ2xhc3MobGlzdC5leHBhbmRJY29uICsgJyAnICsgbGlzdC5jb2xsYXBzZUljb24pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCR3cmFwcGVyLmhhc0NsYXNzKCdqcy0tb3BlbicpKSB7XG4gICAgICAgICAgICAgICAgICAgICR0b2dnbGUuYXR0cignYXJpYS1leHBhbmRlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0LmF0dHIoJ2FyaWEtaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICR0b2dnbGUuYXR0cignYXJpYS1leHBhbmRlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgJHRhcmdldC5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsb3NlTGlzdDogZnVuY3Rpb24gKGVsZW0pIHtcblxuICAgICAgICAgICAgICAgIGxldCAkd3JhcHBlciA9ICQoJy5leHBhbmRhYmxlLWxpc3QnKTtcbiAgICAgICAgICAgICAgICBsaXN0LmRlZmluZVRvZ2dsZUljb25zKCR3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAkd3JhcHBlci5yZW1vdmVDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICBsZXQgJHRhcmdldCA9ICR3cmFwcGVyLmNoaWxkcmVuKCcuZXhwYW5kYWJsZS1saXN0X19ib2R5JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGxldCAkdG9nZ2xlID0gJCgnLmV4cGFuZGFibGUtbGlzdF9fdG9nZ2xlJyk7XG5cbiAgICAgICAgICAgICAgICAkdG9nZ2xlLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKS5maW5kKCdpJykuYWRkQ2xhc3MobGlzdC5leHBhbmRJY29uKS5yZW1vdmVDbGFzcyhsaXN0LmNvbGxhcHNlSWNvbik7XG4gICAgICAgICAgICAgICAgJHRhcmdldC5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlZmluZVRvZ2dsZUljb25zKCRleHBhbmRhYmxlTGlzdCkge1xuXG4gICAgICAgICAgICBpZiAoJGV4cGFuZGFibGVMaXN0LmRhdGEoJ2V4cGFuZC1pY29uJykgIT09IHVuZGVmaW5lZCAmJiAkZXhwYW5kYWJsZUxpc3QuZGF0YSgnZXhwYW5kLWljb24nKSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBsaXN0LmV4cGFuZEljb24gPSAkZXhwYW5kYWJsZUxpc3QuZGF0YSgnZXhwYW5kLWljb24nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCRleHBhbmRhYmxlTGlzdC5kYXRhKCdjb2xsYXBzZS1pY29uJykgIT09IHVuZGVmaW5lZCAmJiAkZXhwYW5kYWJsZUxpc3QuZGF0YSgnY29sbGFwc2UtaWNvbicpICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGxpc3QuY29sbGFwc2VJY29uID0gJGV4cGFuZGFibGVMaXN0LmRhdGEoJ2NvbGxhcHNlLWljb24nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVYLmxpc3QgPSBsaXN0OyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRib2R5ID0gJCgnYm9keScpLFxuICAgICAgICBpc01vYmlsZSA9IGZhbHNlO1xuXG4gICAgdmFyIGFjY29yZGlvbiA9IHtcbiAgICAgICAgJGVsZW1lbnRzOiAkKCcuYWNjb3JkaW9uJyksXG4gICAgICAgICR0YWJiZWRFbGVtZW50czogJCgnLmFjY29yZGlvbi10YWJiZWQnKSxcbiAgICAgICAgJGNvbnRyb2xsZXJzOiAkKCcuYWNjb3JkaW9uX19jb250cm9sJyksIC8vQHRvZG86IHJlbW92ZSBhbWJpZ3VvdXMgRE9NIHNlYXJjaGVzIGZvciBlbGVtZW50cyB0aGF0IGFyZSB1bnVzZWQgYW5kIG1vdmUgb3RoZXIgaW50byBpbml0IGZ1bmN0aW9uXG4gICAgICAgICR0YWJiZWRDb250cm9sbGVyczogJCgnLmFjY29yZGlvbi10YWJiZWRfX2NvbnRyb2wnKSxcbiAgICAgICAgaXNNb2JpbGU6IGZhbHNlLFxuICAgICAgICBpc1N0aWNreUJvZHk6IGZhbHNlLFxuICAgICAgICB2UG9ydDogXCJzY3JlZW4tc21cIixcbiAgICAgICAgJHJlc3BvbnNpdmVFbGVtZW50czogJCgnW2RhdGEtYWNjb3JkaW9uLXZwb3J0XScpLFxuICAgICAgICBhY2NWcG9ydDogW10sXG4gICAgICAgICRyZXNwb25zaXZlVGFyZ2V0OiBbXSxcbiAgICAgICAgY29sbGFwc2VUYWJzOiBmYWxzZSxcbiAgICAgICAgY29sbGFwc2VBY2NvcmRpb246IHRydWUsIC8vIGNvbGxhcHNlIGFjY29yZGlvbiBvbiBvcGVuIG5ldyBhY2NvcmRpb25cbiAgICAgICAgZGVmYXVsdENvbGxhcHNlZDogdHJ1ZSwgLy8gY29sbGFwc2UgYWNjb3JkaW9uIG9uIHBhZ2Vsb2FkXG4gICAgICAgIGhpZGVBbGxCb29sZWFuOiB0cnVlLFxuICAgICAgICBvcGVuZWRBY2NvcmRpb246IDAsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWNjb3JkaW9uLmluaXRSZXNwb25zaXZlKCk7XG4gICAgICAgICAgICBhY2NvcmRpb24ubG9naWMoJCgnLmFjY29yZGlvbi10YWJiZWQnKSk7IC8vIGNvbGxhcHNlIGFsbCBhY2NvcmRpb25zIG9uIHBhZ2UgbG9hZFxuICAgICAgICAgICAgYWNjb3JkaW9uLmNvbnRyb2woKTtcbiAgICAgICAgICAgIGFjY29yZGlvbi5hZGRpdGlvbmFsQ29udHJvbHMoKTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkaXRpb25hbENvbnRyb2xzOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJy5hY2NvcmRpb25fX2NvbnRyb2wnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHIgPSAkKHRoaXMpLmlzKCdbZGF0YS1zbGlkZS10YXJnZXRdJyk7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXRzIGV4dGVybmFsIGxpbmsgb3IgaWYgaXRzIHNsaWRlIGNvbnRyb2xsIGFuZCBtb2JpbGUgdmlldyBwb3J0XG4gICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJleHRlcm5hbFwiKSB8fCAodHlwZW9mIGF0dHIgIT09IHR5cGVvZiB1bmRlZmluZWQgJiYgYXR0ciAhPT0gZmFsc2UgJiYgaXNNb2JpbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLm9uLnRvZ2dsZS5zaW5nbGUoJHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICQodGhpcykudHJpZ2dlcignYWNjb3JkaW9uOmNvbnRyb2xDbGljaycpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcuYWNjb3JkaW9uLXRhYmJlZF9fY29udHJvbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHIgPSAkKHRoaXMpLmlzKCdbZGF0YS1zbGlkZS10YXJnZXRdJyk7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXRzIGV4dGVybmFsIGxpbmsgb3IgaWYgaXRzIHNsaWRlIGNvbnRyb2xsIGFuZCBtb2JpbGUgdmlldyBwb3J0IG9yIHByZXZlbnQgYWNjb3JkaW9uIGJlaGF2aW9yXG4gICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJleHRlcm5hbFwiKSB8fCAodHlwZW9mIGF0dHIgIT09IHR5cGVvZiB1bmRlZmluZWQgJiYgYXR0ciAhPT0gZmFsc2UgJiYgaXNNb2JpbGUgfHwgYWNjb3JkaW9uLnByZXZlbnRBY2NvcmRpb25CZWhhdmlvcigkKHRoaXMpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24ub24udG9nZ2xlLnRhYmJlZCgkdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcuZXhwYW5kLWFsbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgYWNjb3JkaW9uLm9uLnRvZ2dsZS5hbGwoJHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKGFjY29yZGlvbi52UG9ydCArICctb24nLCBmdW5jdGlvbiAoKSB7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgaXNNb2JpbGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKGFjY29yZGlvbi52UG9ydCArICctb2ZmJywgZnVuY3Rpb24gKCkgeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGRlYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgaXNNb2JpbGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG4gICAgICAgIGxvZ2ljOiBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgaWYgKGFjY29yZGlvbi5oaWRlQWxsQm9vbGVhbikge1xuICAgICAgICAgICAgICAgIGFjY29yZGlvbi5oaWRlQWxsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFjY29yZGlvbi4kdGFiYmVkRWxlbWVudHMgPSBlbGVtO1xuICAgICAgICAgICAgdmFyIHBhcmVudEFjY29yZGlvbiA9IGFjY29yZGlvbi4kdGFiYmVkRWxlbWVudHMuY2xvc2VzdCgnLmFjY29yZGlvbicpO1xuXG4gICAgICAgICAgICBpZiAocGFyZW50QWNjb3JkaW9uLnBhcmVudCgnW2RhdGEtZGVmYXVsdC1jb2xsYXBzZWRdJykubGVuZ3RoKVxuICAgICAgICAgICAgICAgIGFjY29yZGlvbi5kZWZhdWx0Q29sbGFwc2VkID0gcGFyZW50QWNjb3JkaW9uLnBhcmVudCgpLmRhdGEoJ2RlZmF1bHQtY29sbGFwc2VkJyk7XG5cbiAgICAgICAgICAgIGlmIChhY2NvcmRpb24uZGVmYXVsdENvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIGFjY29yZGlvbi4kdGFiYmVkRWxlbWVudHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoXCIuYWNjb3JkaW9uLXRhYmJlZF9fdGFiXCIpLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWNjb3JkaW9uLnByZXZlbnRBY2NvcmRpb25CZWhhdmlvcigkdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjY29yZGlvbi5jb2xsYXBzZVRhYnNCeURlZmF1bHQodGhpcykgJiYgaW5kZXggPT0gYWNjb3JkaW9uLm9wZW5lZEFjY29yZGlvbiAmJiAhJHRoaXMuaGFzQ2xhc3MoJ2FjY29yZGlvbl9fY2xvc2VkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udHJvbCcpLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX19jb250ZW50Jykuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdGhpcy5maW5kKCcuYWNjb3JkaW9uLWxhenknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLmdldEFjY29yZGlvbkNvbnRlbnQoJHRoaXMuZmluZCgnLmFjY29yZGlvbi1sYXp5JykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udHJvbCcpLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudCcpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgYWNjb3JkaW9uLiR0YWJiZWRFbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKFwiW2NsYXNzKj0nYWNjb3JkaW9uLXRhYmJlZF9fdGFiJ11cIikuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX19jb250cm9sJykuYXR0cignYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudCcpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbGxhcHNlVGFic0J5RGVmYXVsdDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBhY2NvcmRpb24uY29sbGFwc2VUYWJzO1xuICAgICAgICB9LFxuICAgICAgICBhZGRpdGlvbmFsQWpheFN1Y2Nlc3M6IGZ1bmN0aW9uKCRlbGVtKXtcblxuICAgICAgICB9LFxuICAgICAgICBnZXRDdXN0b21BamF4VXJsOiBmdW5jdGlvbigkZWxlbSl7fSxcbiAgICAgICAgYnVpbGRBamF4VXJsOiBmdW5jdGlvbigkZWxlbSl7XG4gICAgICAgICAgICB2YXIgYWpheFVybDtcbiAgICAgICAgICAgIHZhciBoYXNDdXN0b21VcmwgPSB0eXBlb2YgJGVsZW0uYXR0cignZGF0YS1jdXN0b20tdXJsJykgIT09ICd1bmRlZmluZWQnICYmICRlbGVtLmF0dHIoJ2RhdGEtY3VzdG9tLXVybCcpID09J3RydWUnO1xuICAgICAgICAgICAgaWYoaGFzQ3VzdG9tVXJsKXtcbiAgICAgICAgICAgICAgICBhamF4VXJsID0gYWNjb3JkaW9uLmdldEN1c3RvbUFqYXhVcmwoJGVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICB2YXIgd2lkZ2V0SWQgPSAkZWxlbS5hdHRyKCdkYXRhLXdpZGdldGlkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGRyb3B6b25lSWQgPSAkZWxlbS5hdHRyKCdkYXRhLWRyb3B6b25laWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgcGJDb250ZXh0ID0gZW5jb2RlVVJJQ29tcG9uZW50KCQoJ21ldGFbbmFtZT1wYkNvbnRleHRdJykuYXR0cihcImNvbnRlbnRcIikpO1xuICAgICAgICAgICAgICAgIGFqYXhVcmwgPSAnL3BiL3dpZGdldHMvYWNjb3JkaW9uL2xvYWRUYWI/cGJDb250ZXh0PScgKyBwYkNvbnRleHQgKyAnJndpZGdldElkPScgKyB3aWRnZXRJZCArICcmZHJvcFpvbmVJZD0nICsgZHJvcHpvbmVJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFqYXhVcmw7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEFjY29yZGlvbkNvbnRlbnQ6IGZ1bmN0aW9uICgkZWxlbSkge1xuICAgICAgICAgICAgdmFyIGFqYXhVcmwgPSBhY2NvcmRpb24uYnVpbGRBamF4VXJsKCRlbGVtKTtcbiAgICAgICAgICAgIHZhciAkcGFyZW50VGFiID0gJGVsZW0ucGFyZW50KCk7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogYWpheFVybCxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkZWxlbS5jbG9zZXN0KCcuYWNjb3JkaW9uLXRhYmJlZF9fdGFiJykuYXR0cignZGF0YS1hamF4TG9hZGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW0ucmVwbGFjZVdpdGgoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKCRwYXJlbnRUYWIuZmluZCgnLmFjY29yZGlvbi10YWJiZWQnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY29yZGlvbi5sb2dpYygkcGFyZW50VGFiLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRwYXJlbnRUYWIuZmluZCgnLmFjY29yZGlvbl9fc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24uYWRkaXRpb25hbEFqYXhTdWNjZXNzKCRwYXJlbnRUYWIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICAgIHRvZ2dsZToge1xuICAgICAgICAgICAgICAgIHNpbmdsZTogZnVuY3Rpb24gKCR0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkYWNjb3JkaW9uQ29udGVudCA9ICR0aGlzLm5leHQoJy5hY2NvcmRpb25fX2NvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mICR0aGlzLmF0dHIoJ2RhdGEtY29udGVudC10YXJnZXQnKSAhPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRUYXJnZXQgPSAkdGhpcy5hdHRyKCdkYXRhLWNvbnRlbnQtdGFyZ2V0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkYWNjb3JkaW9uQ29udGVudCA9ICQoY29udGVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJGFjY29yZGlvbkNvbnRlbnQuc2xpZGVUb2dnbGUoMjAwLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdGhpcy5wYXJlbnQoKS5oYXNDbGFzcygnYXJ0aWNsZS1hY2NvcmRpb24nKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmFydGljbGUtcm93LWxlZnQnKS5oZWlnaHQoJ2F1dG8nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24uaXNTdGlja3lCb2R5ID0gc3RhdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLnRvZ2dsZUNsYXNzKCdqcy0tb3BlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciAkd3JhcHBlciA9ICR0aGlzLmNsb3Nlc3QoXCIuZXhwYW5kYWJsZS1hY2NvcmRpb25cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gISgkdGhpcy5hdHRyKCdhcmlhLWV4cGFuZGVkJykgPT0gJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuYXR0cignYXJpYS1leHBhbmRlZCcsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjY29yZGlvbkV4cGFuZGVkU2luZ2xlID0gJC5FdmVudChcImFjY29yZGlvbjpleHBhbmRlZFNpbmdsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcihhY2NvcmRpb25FeHBhbmRlZFNpbmdsZSwgWyR0aGlzLCAkYWNjb3JkaW9uQ29udGVudF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHdyYXBwZXIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLm9uLmNoZWNrRXhwYW5kQWxsKCR0aGlzLCBzdGF0ZSwgJHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGFiYmVkOiBmdW5jdGlvbiAoJHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRwYXJlbnQgPSAkdGhpcy5jbG9zZXN0KFwiLmFjY29yZGlvbi10YWJiZWRfX3RhYlwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRvcGVuZWQgPSAkdGhpcy5jbG9zZXN0KCcuYWNjb3JkaW9uLXRhYmJlZCcpLmNoaWxkcmVuKCcuanMtLW9wZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSAhKCR0aGlzLmF0dHIoJ2FyaWEtZXhwYW5kZWQnKSA9PSAndHJ1ZScpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5hdHRyKCdhcmlhLWV4cGFuZGVkJywgc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHdyYXBwZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmV4cGFuZGFibGUtYWNjb3JkaW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHdyYXBwZXIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLm9uLmNoZWNrRXhwYW5kQWxsKCR0aGlzLCBzdGF0ZSwgJHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRwYXJlbnQuaGFzQ2xhc3MoJ2pzLS1vcGVuJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY2NvcmRpb24uY29sbGFwc2VBY2NvcmRpb24gfHwgYWNjb3JkaW9uLmV4dHJhQ29sbGFwc2VBY2NvcmRpb25DaGVjaygkcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvcGVuZWQuY2hpbGRyZW4oJy5hY2NvcmRpb24tdGFiYmVkX19jb250ZW50Jykuc2xpZGVVcCgyMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAkcGFyZW50LmNoaWxkcmVuKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudCcpLnNsaWRlRG93bigyMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWNjb3JkaW9uLmNvbGxhcHNlQWNjb3JkaW9uIHx8IGFjY29yZGlvbi5leHRyYUNvbGxhcHNlQWNjb3JkaW9uQ2hlY2soJHBhcmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9wZW5lZC5yZW1vdmVDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcGFyZW50LmFkZENsYXNzKCdqcy0tb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcGFyZW50LmF0dHIoJ2RhdGEtYWpheExvYWRlZCcpICE9ICd0cnVlJyAmJiAkcGFyZW50LmZpbmQoJy5hY2NvcmRpb24tbGF6eScpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24uZ2V0QWNjb3JkaW9uQ29udGVudCgkcGFyZW50LmZpbmQoJy5hY2NvcmRpb24tbGF6eScpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLm9uLmV4cGFuZGVkKCR0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjb3JkaW9uRXhwYW5kZWRUYWJiZWQgPSAkLkV2ZW50KFwiYWNjb3JkaW9uOmV4cGFuZGVkVGFiYmVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoYWNjb3JkaW9uRXhwYW5kZWRUYWJiZWQsIFskdGhpc10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcGFyZW50LmNoaWxkcmVuKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudCcpLnNsaWRlVXAoMjAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMucmVtb3ZlQ2xhc3MoJ2pzLS1vcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHBhcmVudC5yZW1vdmVDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBAZml4bWU6IHdvcmsgd2l0aCBhcmlhLWV4cGFuZGVkIGlzIG1pc3NpbmcgaGVyZSwgc28gaXQgZG9lc24ndCB3b3JrIGNvcnJlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhbGw6IGZ1bmN0aW9uICgkdGhpcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHdyYXBwZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmV4cGFuZGFibGUtYWNjb3JkaW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSAhKCR0aGlzLmF0dHIoJ2FyaWEtZXhwYW5kZWQnKSA9PSAndHJ1ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbi10YWJiZWRfX3RhYicpLmFkZENsYXNzKCdqcy0tb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbl9fY29udHJvbCwgLmFjY29yZGlvbi10YWJiZWRfX2NvbnRyb2wnKS5hZGRDbGFzcygnanMtLW9wZW4nKS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbl9fY29udGVudCwgLmFjY29yZGlvbi10YWJiZWRfX2NvbnRlbnQnKS5zbGlkZURvd24oMjAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMudGV4dCgnSGlkZSBBbGwnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRsYXp5ID0gJHdyYXBwZXIuZmluZCgnW2RhdGEtYWpheExvYWRlZF0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsYXp5LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkbGF6eS5hdHRyKCdbZGF0YS1hamF4TG9hZGVkXScpICE9ICd0cnVlJyAmJiAkbGF6eS5maW5kKCcuYWNjb3JkaW9uLWxhenknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLmdldEFjY29yZGlvbkNvbnRlbnQoJGxhenkuZmluZCgnLmFjY29yZGlvbi1sYXp5JykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbi10YWJiZWRfX3RhYicpLnJlbW92ZUNsYXNzKCdqcy0tb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbl9fY29udHJvbCwgLmFjY29yZGlvbi10YWJiZWRfX2NvbnRyb2wnKS5yZW1vdmVDbGFzcygnanMtLW9wZW4nKS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnLmFjY29yZGlvbl9fY29udGVudCwgLmFjY29yZGlvbi10YWJiZWRfX2NvbnRlbnQnKS5zbGlkZVVwKDIwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnRleHQoJ0V4cGFuZCBBbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGV4cGFuZGVkOiBmdW5jdGlvbigkdGhpcykge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2hlY2tFeHBhbmRBbGw6IGZ1bmN0aW9uICgkdGhpcywgc3RhdGUsICR3cmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCR3cmFwcGVyLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgdmFyICRleHBhbmRFbGVtID0gJHdyYXBwZXIuZmluZCgnLmV4cGFuZC1hbGwnKTtcblxuICAgICAgICAgICAgICAgIGlmICgkZXhwYW5kRWxlbS5sZW5ndGggJiYgJGV4cGFuZEVsZW0uYXR0cignYXJpYS1leHBhbmRlZCcpID09ICd0cnVlJykge1xuXG4gICAgICAgICAgICAgICAgICAgICRleHBhbmRFbGVtLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICRleHBhbmRFbGVtLnRleHQoJ0hpZGUgQWxsJyk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICRleHBhbmRFbGVtLnRleHQoJ0V4cGFuZCBBbGwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGhpZGVBbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vSGlkZSBhY2NvcmRpb24gY29udGVudCBvbiBsb2FkIChpbiBjYXNlIG9mIGRpc2FibGVkIEpTLCB0aGUgYWNjb3JkaW9uIHNob3VsZCBiZSBvcGVuKVxuICAgICAgICAgICAgYWNjb3JkaW9uLiRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJy5hY2NvcmRpb25fX2NvbnRyb2wnKS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgaWYgKCEkdGhpcy5maW5kKCcuYWNjb3JkaW9uX19jb250ZW50JykuaGFzQ2xhc3MoXCJqcy0tb3BlblwiKSkge1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uX19jb250ZW50JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKCR0aGlzLmZpbmQoJy5hY2NvcmRpb25fX2NvbnRlbnQnKS5oYXNDbGFzcyhcImpzLS1vcGVuXCIpKSkge1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCcuYWNjb3JkaW9uX19jb250cm9sJykuYXR0cignYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuZmluZCgnLmFjY29yZGlvbl9fY29udGVudCcpLnJlbW92ZUNsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGluaXRSZXNwb25zaXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoYWNjb3JkaW9uLiRyZXNwb25zaXZlRWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgYWNjb3JkaW9uLiRyZXNwb25zaXZlRWxlbWVudHMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uLiRyZXNwb25zaXZlVGFyZ2V0W2luZGV4XSA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIGFjY29yZGlvbi5hY2NWcG9ydFtpbmRleF0gPSAkKHRoaXMpLmRhdGEoJ2FjY29yZGlvbi12cG9ydCcpO1xuICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24uc2V0Vmlld3BvcnRzKGluZGV4KTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwcmV2ZW50QWNjb3JkaW9uQmVoYXZpb3I6IGZ1bmN0aW9uICgkdGhpcykge1xuICAgICAgICAgICAgaWYgKCR0aGlzLnBhcmVudHMoJ1tkYXRhLWFjY29yZGlvbi12cG9ydF06bm90KC5hY2NvcmRpb24tdnBvcnQtLXJlcyknKS5sZW5ndGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhQ29sbGFwc2VBY2NvcmRpb25DaGVjazogZnVuY3Rpb24gKCRwYXJlbnQpIHtcbiAgICAgICAgICAgIGlmIChhY2NvcmRpb24uY29sbGFwc2VBY2NvcmRpb24pXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldFZpZXdwb3J0czogZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbihhY2NvcmRpb24uYWNjVnBvcnRbaW5kZXhdICsgJy1vbicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gYWNjb3JkaW9uLiRyZXNwb25zaXZlVGFyZ2V0W2luZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmRhdGEoJ2FjY29yZGlvbi12cG9ydCcpID09IGFjY29yZGlvbi5hY2NWcG9ydFtpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKFwiYWNjb3JkaW9uLXZwb3J0LS1yZXNcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuZGF0YSgnYWNjb3JkaW9uLW9wdGlvbicpID09IFwid2l0aC1hcnJvd1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuYWRkQ2xhc3MoXCJhY2NvcmRpb24td2l0aC1hcnJvd1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhY2NvcmRpb24ubG9naWMoYWNjb3JkaW9uLiRyZXNwb25zaXZlVGFyZ2V0W2luZGV4XS5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZCcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oYWNjb3JkaW9uLmFjY1Zwb3J0W2luZGV4XSArICctb2ZmJywgZnVuY3Rpb24gKCkgeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGFjdGl2YXRlIHJlc3BvbnNpdmUgZWZmZWN0c1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBhY2NvcmRpb24uJHJlc3BvbnNpdmVUYXJnZXRbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuZGF0YSgnYWNjb3JkaW9uLXZwb3J0JykgPT0gYWNjb3JkaW9uLmFjY1Zwb3J0W2luZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoXCJhY2NvcmRpb24tdnBvcnQtLXJlcyBhY2NvcmRpb24td2l0aC1hcnJvd1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX19jb250ZW50Jykuc2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVguYWNjb3JkaW9uID0gYWNjb3JkaW9uOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYXJ0aWNsZUFjdGlvbnNiYXIgPSB7XG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5zZXQudmFyaWFibGVzKCk7XG4gICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5zaG93SGlkZUFjdGlvbkJ0bnMoKTtcbiAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLmNvbnRyb2xzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDoge1xuICAgICAgICAgICAgdmFyaWFibGVzKCkge1xuICAgICAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZnJtSXNzdWVJdGVtcycpO1xuICAgICAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLmNoZWNrYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXNzdWUtSXRlbV9fY2hlY2tib3gnKTtcbiAgICAgICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5idG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFydGljbGUtYWN0aW9uYmFyX19idG4nKTtcbiAgICAgICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5idG5zQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUtYWN0aW9uYmFyX19idG5zJyk7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUFjdGlvbnNiYXIuc2VsZWN0QWxsQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFydGljbGUtYWN0aW9uYmFyX19jaGVjay1hbGwgaW5wdXQnKTtcbiAgICAgICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5oaWRlQWN0aW9uc0NsYXNzID0gJ2FydGljbGUtYWN0aW9uYmFyX19idG5zLS1oaWRlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbHMoKSB7XG4gICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5zZWxlY3RBbGxCb3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNDaGVja2VkID0gdGhpcy5jaGVja2VkO1xuICAgICAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLmNoZWNrYm94ZXMuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2hlY2tlZCA9IGlzQ2hlY2tlZCk7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUFjdGlvbnNiYXIuc2hvd0hpZGVBY3Rpb25CdG5zKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXJ0aWNsZUFjdGlvbnNiYXIuY2hlY2tib3hlcy5mb3JFYWNoKGVsZW0gPT4ge1xuICAgICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLnNlbGVjdEFsbEJveC5jaGVja2VkID0gYXJ0aWNsZUFjdGlvbnNiYXIuYWxsSXRlbXNTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5zaG93SGlkZUFjdGlvbkJ0bnMoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5idG5zLmZvckVhY2goZWxlbSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzLmhhc0F0dHJpYnV0ZSgnZGF0YS10b2dnbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZUFjdGlvbnNiYXIuZm9ybS5hY3Rpb24gPSBfdGhpcy5ocmVmO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZUFjdGlvbnNiYXIuZm9ybS5zdWJtaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGFsbEl0ZW1zU2VsZWN0ZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShhcnRpY2xlQWN0aW9uc2Jhci5jaGVja2JveGVzKS5ldmVyeShpdGVtID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5jaGVja2VkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhc1NlbGVjdGVkSXRlbXMoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShhcnRpY2xlQWN0aW9uc2Jhci5jaGVja2JveGVzKS5zb21lKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmNoZWNrZWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgc2hvd0hpZGVBY3Rpb25CdG5zKCkge1xuICAgICAgICAgICAgaWYgKCFhcnRpY2xlQWN0aW9uc2Jhci5oYXNTZWxlY3RlZEl0ZW1zKCkpIHtcbiAgICAgICAgICAgICAgICBhcnRpY2xlQWN0aW9uc2Jhci5idG5zQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoYXJ0aWNsZUFjdGlvbnNiYXIuaGlkZUFjdGlvbnNDbGFzcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFydGljbGVBY3Rpb25zYmFyLmJ0bnNDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShhcnRpY2xlQWN0aW9uc2Jhci5oaWRlQWN0aW9uc0NsYXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVWC5hcnRpY2xlQWN0aW9uc2JhciA9IGFydGljbGVBY3Rpb25zYmFyO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZS1hY3Rpb25iYXInKSkge1xuICAgICAgICAgICAgVVguYXJ0aWNsZUFjdGlvbnNiYXIuaW5pdCgpO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBwZEF1dG9TYXZlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNaW5pbXVtIHBlcmlvZCBiZXR3ZWVuIGFueSB0d28gYXV0by1zYXZlc1xuICAgICAgICAgKiBUaGUgdmFsdWUgaXMgaW4gc2Vjb25kc1xuICAgICAgICAgKi9cbiAgICAgICAgcGVyaW9kOiAzLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDdXJyZW50IHN0YXRlIG9mIHRoZSB3aWRnZXRcbiAgICAgICAgICogUG9zc2libGUgdmFsdWVzIFsgaW5pdCB8IHNhdmluZyB8IHNhdmVkIHwgZXJyb3IgXVxuICAgICAgICAgKi9cbiAgICAgICAgc3RhdGU6IG51bGwsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhdXRvLXNhdmUgdXJsIHVzZWQgaW4gdGhlIGFqYXggcmVxdWVzdFxuICAgICAgICAgKi9cbiAgICAgICAgdXJsOiBudWxsLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMYXN0IHNhdmUgdGltZSBpbiB0aW1lc3RhbXAgZm9ybWF0XG4gICAgICAgICAqL1xuICAgICAgICBsYXN0U2F2ZWQ6IG51bGwsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZvcm0gdG8gYmUgYXV0by1zYXZlZFxuICAgICAgICAgKi9cbiAgICAgICAgJGZvcm06IG51bGwsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGxhYmVsIHRvIHNob3cgdGhlIGN1cnJlbnQgc3RhdHVzXG4gICAgICAgICAqL1xuICAgICAgICAkc3RhdHVzOiBudWxsLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZWxlY3RvciBmb3IgdGhlIGZpZWxkcyB0aGF0IHlvdSB3YW50IHRvIGRldGVjdCB0aGVpciBjaGFuZ2VzIGFuZCBhdXRvc2F2ZVxuICAgICAgICAgKi9cbiAgICAgICAgZGV0ZWN0Q2hhbmdlc09uOiBcIi5hdXRvc2F2ZS1maWVsZFwiLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuJGZvcm0gPSAkKCcuYXV0b3NhdmUtZm9ybScpO1xuICAgICAgICAgICAgdGhpcy4kc3RhdHVzID0gdGhpcy4kZm9ybS5maW5kKCcuYXV0b3NhdmUtc3RhdHVzJyk7XG4gICAgICAgICAgICB0aGlzLnVybCA9IHRoaXMuJGZvcm0uZGF0YSgnYXV0b3NhdmUtdXJsJyk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdHVzKCdpbml0Jyk7XG5cbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlcigpO1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLiRmb3JtLm9uKCdjaGFuZ2UnLCBwZEF1dG9TYXZlLmRldGVjdENoYW5nZXNPbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuY2hlY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2F1dG9zYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuY2hlY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2F1dG9zYXZlOm5vdycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBwZEF1dG9TYXZlLnNhdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjaGVjazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBpZiAoIXBkQXV0b1NhdmUubGFzdFNhdmVkIHx8IChub3cgLSBwZEF1dG9TYXZlLmxhc3RTYXZlZCkvMTAwMCA+IHRoaXMucGVyaW9kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNhdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMub24uc2F2aW5nKCk7XG4gICAgICAgICAgICBwZEF1dG9TYXZlLmxhc3RTYXZlZCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogcGRBdXRvU2F2ZS51cmwsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YTogcGRBdXRvU2F2ZS4kZm9ybS5zZXJpYWxpemUoKSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUub24uc2F2ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgcGRBdXRvU2F2ZS4kZm9ybS50cmlnZ2VyKCdhdXRvc2F2ZTpzYXZlZCcpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcGRBdXRvU2F2ZS5vbi5lcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICBwZEF1dG9TYXZlLiRmb3JtLnRyaWdnZXIoJ2F1dG9zYXZlOmVycm9yJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwZEF1dG9TYXZlLiRmb3JtLnRyaWdnZXIoJ2F1dG9zYXZlOmNvbXBsZXRlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCBjdXJyZW50IHN0YXRlIGNsYXNzIHRvIHRoZSBzdGF0dXMgZWxlbWVudFxuICAgICAgICAgKi9cbiAgICAgICAgc2V0U3RhdHVzOiBmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gc3RhdHVzO1xuICAgICAgICAgICAgcGRBdXRvU2F2ZS4kc3RhdHVzLnJlbW92ZUNsYXNzKFwiYXV0b3NhdmUtaW5pdFwiKTtcbiAgICAgICAgICAgIHBkQXV0b1NhdmUuJHN0YXR1cy5yZW1vdmVDbGFzcyhcImF1dG9zYXZlLXNhdmluZ1wiKTtcbiAgICAgICAgICAgIHBkQXV0b1NhdmUuJHN0YXR1cy5yZW1vdmVDbGFzcyhcImF1dG9zYXZlLXNhdmVkXCIpO1xuICAgICAgICAgICAgcGRBdXRvU2F2ZS4kc3RhdHVzLnJlbW92ZUNsYXNzKFwiYXV0b3NhdmUtZXJyb3JcIik7XG4gICAgICAgICAgICBwZEF1dG9TYXZlLiRzdGF0dXMuYWRkQ2xhc3MoXCJhdXRvc2F2ZS1cIiArIHBkQXV0b1NhdmUuc3RhdGUpO1xuICAgICAgICB9LFxuICAgICAgICBvbjoge1xuICAgICAgICAgICAgc2F2aW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcGRBdXRvU2F2ZS5zZXRTdGF0dXMoJ3NhdmluZycpO1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuJHN0YXR1cy5maW5kKCdzcGFuJykudGV4dCgnU2F2aW5nLi4uJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYXZlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuc2V0U3RhdHVzKCdzYXZlZCcpO1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuJHN0YXR1cy5maW5kKCdzcGFuJykudGV4dCgnTGFzdCBzYXZlZCBhdCAnICsgcGRBdXRvU2F2ZS5nZXREYXRlVGltZUZyb21UaW1lc3RhbXAocGRBdXRvU2F2ZS5sYXN0U2F2ZWQpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuc2V0U3RhdHVzKCdlcnJvcicpO1xuICAgICAgICAgICAgICAgIHBkQXV0b1NhdmUuJHN0YXR1cy5maW5kKCdzcGFuJykudGV4dCgnRXJyb3Igd2hpbGUgc2F2aW5nIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnZXREYXRlVGltZUZyb21UaW1lc3RhbXA6IGZ1bmN0aW9uKHRpbWVzdGFtcCkge1xuICAgICAgICAgICAgdmFyIHRpbWUgPSBuZXcgRGF0ZSh0aW1lc3RhbXApO1xuICAgICAgICAgICAgdmFyIGhvdXIgPSB0aW1lLmdldEhvdXJzKCk7XG4gICAgICAgICAgICB2YXIgbWludXRlID0gdGltZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICB2YXIgc2Vjb25kID0gdGltZS5nZXRTZWNvbmRzKCk7XG4gICAgICAgICAgICB2YXIgdGVtcCA9ICcnICsgKChob3VyID4gMTIpID8gaG91ciAtIDEyIDogaG91cik7XG4gICAgICAgICAgICBpZiAoaG91ciA9PSAwKVxuICAgICAgICAgICAgICAgIHRlbXAgPSAnMTInO1xuICAgICAgICAgICAgdGVtcCArPSAoKG1pbnV0ZSA8IDEwKSA/ICc6MCcgOiAnOicpICsgbWludXRlO1xuICAgICAgICAgICAgdGVtcCArPSAoKHNlY29uZCA8IDEwKSA/ICc6MCcgOiAnOicpICsgc2Vjb25kO1xuICAgICAgICAgICAgdGVtcCArPSAoaG91ciA+PSAxMikgPyAnIFBNJyA6ICcgQU0nO1xuICAgICAgICAgICAgcmV0dXJuIHRlbXA7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVgucGRBdXRvU2F2ZSA9IHBkQXV0b1NhdmU7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAkYm9keSA9ICQoJ2JvZHknKTtcblxuICAgIHZhciBiYWNrVG9Ub3AgPSB7XG4gICAgICAgIGVsZW1lbnQ6ICcuYmFjay10by10b3AnLFxuICAgICAgICBmb290ZXJCYWNrVG9Ub3A6ICdmb290ZXIgLmJhY2stdG8tdG9wJyxcblxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGJhY2tUb1RvcC5jb250cm9sbGVyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsIGJhY2tUb1RvcC5lbGVtZW50LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogMFxuICAgICAgICAgICAgICAgIH0sIDYwMCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHdpbmRvdy5vbihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYoJChiYWNrVG9Ub3AuZm9vdGVyQmFja1RvVG9wKS5sZW5ndGgpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+ICQoJ2hlYWRlcicpLmhlaWdodCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKGJhY2tUb1RvcC5mb290ZXJCYWNrVG9Ub3ApLmFkZENsYXNzKCdiYWNrLXRvLXRvcF9faXMtdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChiYWNrVG9Ub3AuZm9vdGVyQmFja1RvVG9wKS5yZW1vdmVDbGFzcygnYmFjay10by10b3BfX2lzLXZpc2libGUgYmFjay10by10b3BfX2ZhZGUtb3V0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+IDQwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChiYWNrVG9Ub3AuZm9vdGVyQmFja1RvVG9wKS5hZGRDbGFzcygnYmFjay10by10b3BfX2ZhZGUtb3V0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChiYWNrVG9Ub3AuY2hlY2suaXNmb290ZXJWaXNpYmxlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYmFja1RvVG9wLmZvb3RlckJhY2tUb1RvcCkuYWRkQ2xhc3MoJ2JhY2stdG8tdG9wX19zdGF0aWMnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYmFja1RvVG9wLmZvb3RlckJhY2tUb1RvcCkucmVtb3ZlQ2xhc3MoJ2JhY2stdG8tdG9wX19zdGF0aWMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgY2hlY2s6IHtcbiAgICAgICAgICAgIGlzZm9vdGVyVmlzaWJsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkb2NWaWV3Qm90dG9tID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpICsgJCh3aW5kb3cpLmhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHZhciBiYWNrVG9Ub3BQb3MgPSAkKCdmb290ZXInKS5vZmZzZXQoKS50b3AgO1xuICAgICAgICAgICAgICAgIHJldHVybiAoYmFja1RvVG9wUG9zIDw9IGRvY1ZpZXdCb3R0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgIH1cblxuICAgIFVYLmJhY2tUb1RvcCA9IGJhY2tUb1RvcDtcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICRib2R5ID0gJCgnYm9keScpO1xuXG4gICAgdmFyIGNsaWVudFBhZ2luYXRpb24gPSB7XG4gICAgICAgIGNvbnRhaW5lck5hbWU6IFwiLmNsaWVudC1wYWdpbmF0aW9uXCIsXG4gICAgICAgIHNob3dQZXJQYWdlOiBudWxsLFxuICAgICAgICAkY3VycmVudFBhZ2U6IG51bGwsXG4gICAgICAgICRwYWdlc2Rpc3BseWVkOiBudWxsLFxuICAgICAgICB0YWJsZVJvdzogXCIuY2xpZW50LXBhZ2luYXRpb24tdGFibGUgLnRhYmxlcm93XCIsXG5cblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjbGllbnRQYWdpbmF0aW9uLnNob3dQZXJQYWdlID0gcGFyc2VJbnQoJChjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUpLmZpbmQoJy5zaG93X3Blcl9wYWdlJykudmFsKCksIDApO1xuICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi4kY3VycmVudFBhZ2UgPSAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuZmluZCgnLmN1cnJlbnRfcGFnZScpO1xuICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi4kcGFnZXNkaXNwbHllZCA9IHBhcnNlSW50KCQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcucGFnZXMtZGlzcGx5ZWQnKS52YWwoKSwgMCk7XG4gICAgICAgICAgICBjbGllbnRQYWdpbmF0aW9uLmJ1aWxkUGFnaW5hdGlvbigpO1xuICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi5jb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDoge1xuICAgICAgICAgICAgY29udGFpbmVyTmFtZTogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRhYmxlUm93TmFtZTogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBjbGllbnRQYWdpbmF0aW9uLnRhYmxlUm93ID0gbmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lICsgJyAucGFnaW5hdGlvbl9fYnRuLS1wcmV2JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi5wcmV2aW91cygpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lICsgJyAucGFnaW5hdGlvbl9fYnRuLS1uZXh0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi5uZXh0KCk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCBjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUgKyAnIC5wYWdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi5nb1RvUGFnZSgkKHRoaXMpLmRhdGEoJ3BhZ2UtaW5kZXgnKSk7XG4gICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgYnVpbGRQYWdpbmF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbnVtYmVyX29mX2l0ZW1zID0gJChjbGllbnRQYWdpbmF0aW9uLnRhYmxlUm93KS5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgbnVtYmVyX29mX3BhZ2VzID0gTWF0aC5jZWlsKG51bWJlcl9vZl9pdGVtcyAvIGNsaWVudFBhZ2luYXRpb24uc2hvd1BlclBhZ2UpO1xuICAgICAgICAgICAgJChjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUpLnJlbW92ZSgnLnBhZ2UnKTtcblxuXG4gICAgICAgICAgICBpZiAobnVtYmVyX29mX2l0ZW1zID4gY2xpZW50UGFnaW5hdGlvbi5zaG93UGVyUGFnZSkge1xuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi50YWJsZVJvdykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi50YWJsZVJvdykuc2xpY2UoMCwgY2xpZW50UGFnaW5hdGlvbi5zaG93UGVyUGFnZSkuY3NzKCdkaXNwbGF5JywgJ3RhYmxlLXJvdycpO1xuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcucHJldicpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuZmluZCgnLm5leHQnKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcucGFnZXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgIHdoaWxlIChpIDwgbnVtYmVyX29mX3BhZ2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID49IGNsaWVudFBhZ2luYXRpb24uJHBhZ2VzZGlzcGx5ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcucGFnZXMnKS5hcHBlbmQoJzxhIGNsYXNzPVwicGFnZSBoaWRkZW5cIiBocmVmPVwiI1wiIHRpdGxlPVwicGFnZSAnICsgKGkgKyAxKSArICdcIiBkYXRhLXBhZ2UtaW5kZXg9XCInICsgKGkpICsgJ1wiPicgKyAoaSArIDEpICsgJzwvYT4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcucGFnZXMnKS5hcHBlbmQoJzxhIGNsYXNzPVwicGFnZVwiIGhyZWY9XCIjXCIgdGl0bGU9XCJwYWdlICcgKyAoaSArIDEpICsgJ1wiIGRhdGEtcGFnZS1pbmRleD1cIicgKyAoaSkgKyAnXCI+JyArIChpICsgMSkgKyAnPC9hPicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJChjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUpLmZpbmQoJ1tkYXRhLXBhZ2UtaW5kZXg9XCIwXCJdJykuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnb1RvUGFnZTogZnVuY3Rpb24gKHBhZ2VfbnVtKSB7XG5cbiAgICAgICAgICAgIHZhciBudW1iZXJfb2ZfaXRlbXMgPSAkKGNsaWVudFBhZ2luYXRpb24udGFibGVSb3cpLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBudW1iZXJfb2ZfcGFnZXMgPSBNYXRoLmNlaWwobnVtYmVyX29mX2l0ZW1zIC8gY2xpZW50UGFnaW5hdGlvbi5zaG93UGVyUGFnZSk7XG5cbiAgICAgICAgICAgIHZhciBzdGFydF9mcm9tID0gcGFnZV9udW0gKiBjbGllbnRQYWdpbmF0aW9uLnNob3dQZXJQYWdlO1xuICAgICAgICAgICAgdmFyIGVuZF9vbiA9IHN0YXJ0X2Zyb20gKyBjbGllbnRQYWdpbmF0aW9uLnNob3dQZXJQYWdlO1xuICAgICAgICAgICAgdmFyICRjdXJyZW50UGFnZSA9ICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCdbZGF0YS1wYWdlLWluZGV4PVwiJyArIHBhZ2VfbnVtICsgJ1wiXScpO1xuXG5cbiAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi50YWJsZVJvdykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKS5zbGljZShzdGFydF9mcm9tLCBlbmRfb24pLmNzcygnZGlzcGxheScsICd0YWJsZS1yb3cnKTtcbiAgICAgICAgICAgIGNsaWVudFBhZ2luYXRpb24uJGN1cnJlbnRQYWdlLnZhbChwYWdlX251bSk7XG4gICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuZmluZCgnLnBhZ2UnKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICRjdXJyZW50UGFnZS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcblxuXG4gICAgICAgICAgICB2YXIgc2hvd3BhZ2VzQmVmb3JlQWZ0ZXIgPSBNYXRoLmNlaWwoY2xpZW50UGFnaW5hdGlvbi4kcGFnZXNkaXNwbHllZCAvIDIpO1xuICAgICAgICAgICAgJChjbGllbnRQYWdpbmF0aW9uLmNvbnRhaW5lck5hbWUpLmZpbmQoJy5wYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgaWYgKHBhZ2VfbnVtICsgMSA+IHNob3dwYWdlc0JlZm9yZUFmdGVyKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gcGFnZV9udW0gKyAxIC0gc2hvd3BhZ2VzQmVmb3JlQWZ0ZXI7IGkgPCBwYWdlX251bSArIHNob3dwYWdlc0JlZm9yZUFmdGVyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoIGk8PW51bWJlcl9vZl9wYWdlcylcbiAgICAgICAgICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCdbZGF0YS1wYWdlLWluZGV4PVwiJyArIGkgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8ICBjbGllbnRQYWdpbmF0aW9uLiRwYWdlc2Rpc3BseWVkOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCdbZGF0YS1wYWdlLWluZGV4PVwiJyArIGkgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAocGFnZV9udW0gPT0gMClcbiAgICAgICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuZmluZCgnLnByZXYnKS5oaWRlKClcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAkKGNsaWVudFBhZ2luYXRpb24uY29udGFpbmVyTmFtZSkuZmluZCgnLnByZXYnKS5zaG93KCk7XG5cbiAgICAgICAgICAgIGlmIChwYWdlX251bSA9PSBudW1iZXJfb2ZfcGFnZXMgLSAxKVxuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcubmV4dCcpLmhpZGUoKVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICQoY2xpZW50UGFnaW5hdGlvbi5jb250YWluZXJOYW1lKS5maW5kKCcubmV4dCcpLnNob3coKTtcblxuICAgICAgICB9LFxuICAgICAgICBwcmV2aW91czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5ld19wYWdlID0gcGFyc2VJbnQoY2xpZW50UGFnaW5hdGlvbi4kY3VycmVudFBhZ2UudmFsKCksIDApIC0gMTtcbiAgICAgICAgICAgIGlmIChuZXdfcGFnZSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgY2xpZW50UGFnaW5hdGlvbi5nb1RvUGFnZShuZXdfcGFnZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5ld19wYWdlID0gcGFyc2VJbnQoY2xpZW50UGFnaW5hdGlvbi4kY3VycmVudFBhZ2UudmFsKCksIDApICsgMTtcbiAgICAgICAgICAgIHZhciBudW1iZXJfb2ZfaXRlbXMgPSAkKGNsaWVudFBhZ2luYXRpb24udGFibGVSb3cpLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBudW1iZXJfb2ZfcGFnZXMgPSBNYXRoLmNlaWwobnVtYmVyX29mX2l0ZW1zIC8gY2xpZW50UGFnaW5hdGlvbi5zaG93UGVyUGFnZSk7XG5cbiAgICAgICAgICAgIGlmIChuZXdfcGFnZSA8IG51bWJlcl9vZl9wYWdlcykge1xuICAgICAgICAgICAgICAgIGNsaWVudFBhZ2luYXRpb24uZ29Ub1BhZ2UobmV3X3BhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgIH1cblxuXG4gICAgVVguY2xpZW50UGFnaW5hdGlvbiA9IGNsaWVudFBhZ2luYXRpb247IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNvb2xiYXIgPSB7XG4gICAgICAgIHNlY3Rpb25zOiBudWxsLFxuICAgICAgICBob2xkZXI6ICQoJy5jb29sQmFyLS1zZWN0aW9ucyAuY29vbEJhcl9fZHJvcCcpLFxuICAgICAgICB2UG9ydDogXCJzY3JlZW4tc21cIixcbiAgICAgICAgaXNNb2JpbGU6IGZhbHNlLFxuICAgICAgICBjb29sYmFyRWxlbWVudDogbnVsbCxcbiAgICAgICAgaGVhZGVySGVpZ2h0OiAwLFxuICAgICAgICBpc1N0aWNreUJhcjogZmFsc2UsXG4gICAgICAgIGxvY2s6IHRydWUsIC8vIGRlZmluZSBsb2NrIGFuZCBzZXQgZGVmYXVsdCB2YWx1ZSwgdGhpcyBsb2NrIHdpbGwgYmUgdXNlZCB0byBtYWtlIHN1cmUgdG8gcnVuIGNlcnRhaW4gZnVuY3Rpb25hbGl0eSBhbmQgdG8gcnVuIG9uIGV2ZXJ5IHNjcm9sbCBldmVudFxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgY29vbGJhci5jb29sYmFyRWxlbWVudCA9ICQoXCIuY29vbEJhclwiKTtcbiAgICAgICAgICAgIGNvb2xiYXIuaXNTdGlja3lCYXIgPSBjb29sYmFyLmNvb2xiYXJFbGVtZW50Lmhhc0NsYXNzKFwic3RpY2t5YmFyXCIpO1xuICAgICAgICAgICAgY29vbGJhci5nZXQuc2VjdGlvbnMoKTtcbiAgICAgICAgICAgIGNvb2xiYXIuZmlsbC5zZWN0aW9ucygpO1xuICAgICAgICAgICAgY29vbGJhci5jb250cm9sKCk7XG4gICAgICAgICAgICBjb29sYmFyLmFkZHRpb25hbENvbnRyb2xzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZiAoICQoJy5qb3VybmFsLWhvbWUnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb29sYmFyLnZQb3J0PSBcInNjcmVlbi1tZFwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbihjb29sYmFyLnZQb3J0ICsgJy1vbicsZnVuY3Rpb24oKSB7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgJCgnLmNvb2xCYXInKS5hZGRDbGFzcyhcImNvb2xCYXItLXJlc1wiKTsgLy8gY2xhc3Mgd2lsbCBiZSB1c2VkIGluIG91ciBzY3NzICh0byByZXBsYWNlIG1lZGlhIHF1ZXJpZXMpXG5cbiAgICAgICAgICAgICAgICBjb29sYmFyLmlzTW9iaWxlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIGlmICgkKFwiLnN0aWNreWJhci5jb29sQmFyLS1yZXMsLmNvb2xCYXIuY29vbEJhci0tcmVzXCIpLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICQoXCIuY29udGVudD5hcnRpY2xlLmNvbnRhaW5lclwiKS5hZGRDbGFzcyhcImFydGljbGUtLXJlc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oY29vbGJhci52UG9ydCArICctb2ZmJyxmdW5jdGlvbigpeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGRlYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgJCgnLmNvb2xCYXInKS5yZW1vdmVDbGFzcyhcImNvb2xCYXItLXJlc1wiKTtcbiAgICAgICAgICAgICAgICAkKFwiLmNvbnRlbnQgYXJ0aWNsZS5jb250YWluZXJcIikucmVtb3ZlQ2xhc3MoXCJhcnRpY2xlLS1yZXNcIik7XG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlciggXCJldmVudFNldENvbnRlbnRQYWRkaW5nXCIgKTtcbiAgICAgICAgICAgICAgICBjb29sYmFyLmlzTW9iaWxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZihVWC5jb250cm9sbGVyKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgVVguY29udHJvbGxlci5jaGVjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhZGR0aW9uYWxDb250cm9sczogZnVuY3Rpb24oKXtcblxuICAgICAgICB9LFxuICAgICAgICBnZXQ6IHtcbiAgICAgICAgICAgIHNlY3Rpb25zOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGNvb2xiYXIuc2VjdGlvbnMgPSAkKCcuYXJ0aWNsZV9fY29udGVudCAuc2VjdGlvbl9fdGl0bGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmlsbDoge1xuICAgICAgICAgICAgc2VjdGlvbnM6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCQoJy5jb29sQmFyLS1zZWN0aW9ucycpLmxlbmd0aCAmJiBjb29sYmFyLnNlY3Rpb25zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnLmNvb2xCYXItLXNlY3Rpb25zJykucmVtb3ZlQ2xhc3MoXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1bCA9ICQoJzx1bCBjbGFzcz1cInJsaXN0IHctc2xpZGUtLWxpc3RcIi8+JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb29sYmFyLmhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgIGNvb2xiYXIuc2VjdGlvbnMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaSA9ICQoJzxsaS8+JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigncm9sZScsICdtZW51aXRlbScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKHVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gJCgnPGEgY2xhc3M9XCJ3LXNsaWRlX19oaWRlXCIvPicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hyZWYnLFwiI1wiICsgJHRoaXMuYXR0cignaWQnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8obGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYW5lciA9ICQoJzxzcGFuLz4nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KCQodGhpcykudGV4dCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhsaW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnLmNvb2xCYXItLXNlY3Rpb25zJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkKCcuYXV0aG9yQXJ0aWNsZUluZm9Db24nKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJChcIi5jb29sQmFyLS1zZWN0aW9ucyAuY29vbEJhcl9fZHJvcFwiKS5hcHBlbmQoJzxsaSByb2xlPVwibWVudWl0ZW1cIj48YSBjbGFzcz1cInctc2xpZGVfX2hpZGVcIiBocmVmPVwiI19hY19hdXRob3JBcnRpY2xlSW5mb0NvblwiIHRhcmdldD1cIl9zZWxmXCI+PHNwYW4+QXV0aG9yIGFuZCBBcnRpY2xlIEluZm9ybWF0aW9uPC9zcGFuPjwvYT48L2xpPicpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBVWC5jb29sYmFyID0gY29vbGJhcjsgLy8gYWRkIHRvIGdsb2JhbCBuYW1lc3BhY2Vcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2hhckNvdW50ZXIgPSAge1xuICAgICAgICAkY291bnRlcnM6IG51bGwsXG4gICAgICAgIGNvdW50ZXI6IG51bGwsXG4gICAgICAgIGNvdW50ZXJJbnB1dDogbnVsbCxcbiAgICAgICAgY291bnRlck91dHB1dDogbnVsbCxcbiAgICAgICAgJHRhcmdldDogbnVsbCxcbiAgICAgICAgJHRhcmdldElucHV0OiBudWxsLFxuICAgICAgICAkYXJnZXRPdXRwdXQ6IG51bGwsXG4gICAgICAgIG1heGxlbmd0aDogbnVsbCxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXIgPSBcIi5qcy1jb3VudGVyXCI7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXJJbnB1dCA9IFwiLmpzLWNvdW50ZXJfX2lucHV0XCI7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXJPdXRwdXQgPSBcIi5qcy1jb3VudGVyX19vdXRwdXRcIjtcbiAgICAgICAgICAgIHRoaXMuJGNvdW50ZXJzID0gJCh0aGlzLmNvdW50ZXJJbnB1dCk7XG5cbiAgICAgICAgICAgIGNoYXJDb3VudGVyLmNvbnRyb2xsZXIoKTtcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJC5lYWNoKHRoaXMuJGNvdW50ZXJzLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICAgICAgICAgICQoaXRlbSkuY2xvc2VzdChjaGFyQ291bnRlci5jb3VudGVyKS5maW5kKGNoYXJDb3VudGVyLmNvdW50ZXJPdXRwdXQpLmh0bWwoICQoaXRlbSkuYXR0cihcImRhdGEtbWF4Y2hhcnNcIikgLSAkKGl0ZW0pLnZhbCgpLmxlbmd0aCApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjaGFyQ291bnRlci4kY291bnRlcnMub24oJ2ZvY3VzJywgY2hhckNvdW50ZXIub24uZm9jdXMpO1xuICAgICAgICB9LFxuICAgICAgICBvbjogIHtcbiAgICAgICAgICAgIGZvY3VzOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGNoYXJDb3VudGVyLiR0YXJnZXRJbnB1dCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIuJHRhcmdldE91dHB1dCA9IGNoYXJDb3VudGVyLiR0YXJnZXRJbnB1dC5jbG9zZXN0KGNoYXJDb3VudGVyLmNvdW50ZXIpLmZpbmQoY2hhckNvdW50ZXIuY291bnRlck91dHB1dCk7XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIuJHRhcmdldElucHV0Lm9uKCdrZXl1cCBjaGFuZ2UnLCBjaGFyQ291bnRlci5vbi5jb3VudCk7XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIuJHRhcmdldElucHV0Lm9uKCdibHVyJywgY2hhckNvdW50ZXIub24uYmx1cik7XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIubWF4bGVuZ3RoID0gY2hhckNvdW50ZXIuJHRhcmdldElucHV0LmF0dHIoXCJkYXRhLW1heGNoYXJzXCIpO1xuICAgICAgICAgICAgICAgIGNoYXJDb3VudGVyLm9uLmNvdW50KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYmx1cjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIuJHRhcmdldElucHV0Lm9mZigna2V5dXAnLCBjaGFyQ291bnRlci5vbi5jb3VudCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dFZhbCA9IGNoYXJDb3VudGVyLiR0YXJnZXRJbnB1dC52YWwoKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRMZW5ndGggPSBpbnB1dFZhbC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBjaGFyQ291bnRlci5tYXhsZW5ndGggLSBpbnB1dExlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAoIGlucHV0TGVuZ3RoID4gY2hhckNvdW50ZXIubWF4bGVuZ3RoICkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyQ291bnRlci4kdGFyZ2V0SW5wdXQudmFsKGlucHV0VmFsLnN1YnN0cigwLGNoYXJDb3VudGVyLm1heGxlbmd0aCkpO1xuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hhckNvdW50ZXIuJHRhcmdldE91dHB1dC50ZXh0KGxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBVWC5jaGFyQ291bnRlciA9IGNoYXJDb3VudGVyOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBkYXRlcGlja2VyID0ge1xuICAgICAgICBkYXRlRm9ybWF0OiBcInl5LW1tLWRkXCIsXG4gICAgICAgICRkYXRlcGlja2VyOiAkKFwiLmRhdGVwaWNrZXJcIiksXG4gICAgICAgICRib2R5OiAkKCdib2R5JyksXG4gICAgICAgIGxhc3RNb2RmaWVkOiAnJyxcbiAgICAgICAgdlBvcnQ6ICcnLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLy8gSUYgbmF0aXZlIHN1cHBvcnQgaXMgbm90IHByZXNlbnQsIHVzZSBqUXVlcnkgZGF0ZXBpY2tlciBvbiBldmVyeSB0eXBlPWRhdGUgaW5wdXRcbiAgICAgICAgICAgIGlmICghVVgudGVzdC5pbnB1dERhdGUoKSkge1xuICAgICAgICAgICAgICAgIGRhdGVwaWNrZXIuJGRhdGVwaWNrZXIgPSBkYXRlcGlja2VyLiRkYXRlcGlja2VyLmFkZCgkKCdbdHlwZT1kYXRlXScpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGF0ZXBpY2tlci4kZGF0ZXBpY2tlci5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJGVsZW1lbnQuZGF0YSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAkZWxlbWVudC5kYXRlcGlja2VyICE9PSAndW5kZWZpbmVkJykge1xuXG4gICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmRhdGVwaWNrZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdDogZGF0YS5kYXRlRm9ybWF0ID8gZGF0YS5kYXRlRm9ybWF0IDogZGF0ZXBpY2tlci5kYXRlRm9ybWF0IC8vIGN1c3RvbSBkYXRlIGZvcm1hdCBmcm9tIGRhdGEtYXR0ciBvciBkZWZhdWx0IG9uZVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvL3NldCB0aGUgYWx0IGZpZWxkICYgdGhlIGFsdCBmb3JtYXQgaWYgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5hbHRGaWVsZE5hbWUpICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmRhdGVwaWNrZXIoIFwib3B0aW9uXCIsIFwiYWx0RmllbGRcIiwgJ1tuYW1lPVwiJyArIGRhdGEuYWx0RmllbGROYW1lICsgJ1wiXScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmRhdGVwaWNrZXIoIFwib3B0aW9uXCIsIFwiYWx0Rm9ybWF0XCIsIGRhdGVwaWNrZXIuZGF0ZUZvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVguZGF0ZXBpY2tlciA9IGRhdGVwaWNrZXI7IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpO1xuIiwiLy8gdGFicy5qcyBjYWxscyBVWC5kcm9wQmxvY2suaW5pdCgpOyBvbiBsaW5lIDI2MFxuLy8gcHJvZmlsZS1tZW51LmpzIGNhbGxzIFVYLmRyb3BCbG9jay5pbml0KCk7IG9uIGxpbmUgNTNcblxuKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHdpbmRvdyAgPSAkKHdpbmRvdyksXG4gICAgICAgICRib2R5ICAgID0gJCgnYm9keScpO1xuXG4gICAgdmFyIGRyb3BCbG9jayA9IHtcbiAgICAgICAgJGNvbnRyb2xsZXJzOiAkKFwiW2RhdGEtZGItdGFyZ2V0LWZvcl1cIiksXG4gICAgICAgICR0YXJnZXRzOiBudWxsLCAvLyBIb2xkcyBhbGwgdGFyZ2V0cyBpbiBEb21cbiAgICAgICAgJGNvbnRyb2xsZXI6IG51bGwsIC8vIEN1cnJlbnQgZHJvcCBkb3duIGNvbnRyb2xsZXJcbiAgICAgICAgJHRhcmdldDogbnVsbCwgLy8gQ3VycmVudCB0YXJnZXQgZG93biBjb250cm9sbGVyIGVsZW1lbnRcbiAgICAgICAgJHBhcmVudHM6IG51bGwsIC8vIEhvZGxzIGFsbCBwYXJlbnRzIGluIERvbVxuICAgICAgICAkcGFyZW50OiBudWxsLCAvLyBDdXJyZW50IHBhcmVudCBlbGVtZW50XG4gICAgICAgIGVzY2FwZTogMjcsXG4gICAgICAgICRjb250YWluZXI6ICQoXCIuY29udGFpbmVyXCIpLFxuICAgICAgICBzd2l0Y2hWYWw6IG51bGwsXG4gICAgICAgICRzZWN0aW9uOiAkKFwiLmRyb3BCbG9ja19faG9sZGVyXCIpLFxuICAgICAgICB2UG9ydDogXCJzY3JlZW4tc21cIixcbiAgICAgICAgaXNNb2JpbGU6IGZhbHNlLFxuICAgICAgICBpbml0aWFsaXplZDogZmFsc2UsXG4gICAgICAgIGRpcmVjdGlvbjogJ2xlZnQnLCAvLyBsZWZ0ICwgcmlnaHRcbiAgICAgICAgcG9wOiAnZG93bicsIC8vIHVwICwgZG93blxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRyb3BCbG9jay5jb250cm9sKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGRyb3BCbG9jay5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRyb3BCbG9jay5pbml0aWFsaXplZCA9IHRydWU7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1kYi10YXJnZXQtZm9yXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGlzT3BlbiAgICAgICAgICAgID0gJCh0aGlzKS5oYXNDbGFzcyhcImpzLS1vcGVuXCIpLFxuICAgICAgICAgICAgICAgICAgICBpc0RhdGFTbGlkZVRhcmdldCA9ICQodGhpcykuaXMoJ1tkYXRhLXNsaWRlLXRhcmdldF0nKSxcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZU9uTW9iaWxlICAgPSAkKHRoaXMpLmRhdGEoJ2RiLXNtLWRpc2FibGUnKSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kY29udHJvbGxlciA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgZHJvcEJsb2NrLmZpbmQudGFyZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5vbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZHJvcEJsb2NrLmlzTW9iaWxlICYmIChpc0RhdGFTbGlkZVRhcmdldCAhPT0gZmFsc2UgfHwgZGlzYWJsZU9uTW9iaWxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLm9uLnNob3coZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jb29sQmFyOm5vdCgubG9pX19iYW5uZXIpIFtkYXRhLWRiLXRhcmdldC1vZl0gYTpub3QoW2RhdGEtc2xpZGUtdGFyZ2V0XSknLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGRyb3BCbG9jay5vbi5oaWRlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHdpbmRvdy5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suJHBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5maW5kLmRpbWVuc2lvbnMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oZHJvcEJsb2NrLnZQb3J0ICsgJy1vbicsIGZ1bmN0aW9uICgpIHsgLy8gV2FpdGluZyBmb3IgY3VzdG9tIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgYnkgY29udHJvbGxlci5qcyB0byBhY3RpdmF0ZSByZXNwb25zaXZlIGVmZmVjdHNcbiAgICAgICAgICAgICAgICBkcm9wQmxvY2suaXNNb2JpbGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbihkcm9wQmxvY2sudlBvcnQgKyAnLW9mZicsIGZ1bmN0aW9uICgpIHsgLy8gV2FpdGluZyBmb3IgY3VzdG9tIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgYnkgY29udHJvbGxlci5qcyB0byBkZWFjdGl2YXRlIHJlc3BvbnNpdmUgZWZmZWN0c1xuICAgICAgICAgICAgICAgIGRyb3BCbG9jay5pc01vYmlsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIChlKSB7IC8vIHNob3cgIHRhcmdldCBlbGVtZW50XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRyb3BCbG9jay4kY29udHJvbGxlci5jbG9zZXN0KFwiLmRyb3BCbG9ja19faG9sZGVyXCIpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mKFVYLmNvbnRyb2xsZXIpICE9IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFVYLmNvbnRyb2xsZXIuY2hlY2soZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZHJvcEJsb2NrLiR0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRjb250cm9sbGVyLnRyaWdnZXIoJ2Ryb3BCbG9jazpvcGVuJywgW2Ryb3BCbG9ja10pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kdGFyZ2V0LmFkZENsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kY29udHJvbGxlci5hZGRDbGFzcyhcImpzLS1vcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICAkYm9keS5hdHRyKCdkYXRhLWFjdGl2ZScsICdkcm9wQmxvY2snKTtcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQuY2xvc2VzdChcIltjbGFzcyo9J3N0aWNrbyddXCIpLmFkZENsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5zd2l0Y2guaWNvbigpO1xuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIGZvY3VzIHRvIGFjdGl2ZSBpbm5lciBjb21wb25lbnQsIG9yIGxlYXZlIGZvY3VzIG9uIGNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQuZmluZCgnLmFjdGl2ZSA6dGFiYmFibGUnKS5maXJzdCgpLmZvY3VzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWNjZXNzaWJpbGl0eVxuICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJGNvbnRyb2xsZXIuYXR0cih7J2FyaWEtZXhwYW5kZWQnOiAndHJ1ZSd9KTtcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQucmVtb3ZlQXR0cignYXJpYS1oaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBAZml4bWUgLSB0aGlzIHNob3VsZCBub3QgYmUgaGVyZSBhdCBhbGwgLSBpdCBzaG91bGQgYmUgbW92ZWQgdG8gcHJvcGVyIGNvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICB2YXIgaXNMb2kgPSBkcm9wQmxvY2suJHRhcmdldC5maW5kKCcubG9pJykubGVuZ3RoID4gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTG9pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHRhcmdldC5maW5kKCcubG9pX19saXN0JykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVVgubG9pLm9uLnJlY2FsY3VsYXRlKCQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRjb250cm9sbGVyLnRyaWdnZXIoJ2Ryb3BCbG9jazpvcGVuZWQnLCBbZHJvcEJsb2NrXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRyb3BCbG9jay5hZGRpdGlvbmFsT25TaG93KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gKCkgeyAvLyBoaWRlIHRhcmdldCBlbGVtZW50XG4gICAgICAgICAgICAgICAgaWYgKGRyb3BCbG9jay4kdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kY29udHJvbGxlci50cmlnZ2VyKCdkcm9wQmxvY2s6Y2xvc2UnLCBbZHJvcEJsb2NrXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgY3VycmVudCB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRjb250cm9sbGVyLnJlbW92ZUNsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kdGFyZ2V0LnJlbW92ZUNsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBsYXkgbmljZWx5IHdpdGggb3RoZXJzIC4uLlxuICAgICAgICAgICAgICAgICAgICAvLyBGb3IgcGx1Z2lucyB3aGljaCBkb24ndCB1c2UganMtLW9wZW4gY2xhc3MgYnV0IHVzZXMgLmhpZGUgLnNob3cgbWV0aG9kcyBpbnN0ZWFkLCByZXNldCB0aGVtIC4uLlxuICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZXhhbXBsZSBMT0EgYWNjb3JkaW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suJHRhcmdldC5hdHRyKCdzdHlsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHRhcmdldC5yZW1vdmVBdHRyKCdzdHlsZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEV4cGxpY2l0bHkgZm9yIG91ciBhY2NvcmRpb24gd29ya2luZyBhcyBhIGRyb3AtYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQuY2xvc2VzdChcIltjbGFzcyo9J2FjY29yZGlvbi10YWJiZWRfX3RhYiddXCIpLnJlbW92ZUNsYXNzKFwianMtLW9wZW5cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQuY2xvc2VzdChcIltjbGFzcyo9J3N0aWNrbyddXCIpLnJlbW92ZUNsYXNzKFwianMtLW9wZW5cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLnN3aXRjaC5iYWNrKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWNjZXNzaWJpbGl0eSAtIEluZm9ybSBzY3JlZW4gcmVhZGVyc1xuICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJGNvbnRyb2xsZXIuYXR0cih7J2FyaWEtZXhwYW5kZWQnOiAnZmFsc2UnfSk7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kdGFyZ2V0LmF0dHIoeydhcmlhLWhpZGRlbic6ICd0cnVlJ30pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE5lc3RlZCBkcm9wQmxvY2tzIGNsb3NlIGhhbmRsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suJHBhcmVudFNlY3Rpb24gJiYgZHJvcEJsb2NrLiRwYXJlbnRTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVzdGVkIG9uZXMgLSBzZXQgcGFyZW50IGFmdGVyIGNsb3Npbmcgc2VsZiAtIHdpbGwgY2xvc2UgcGFyZW50IGluIHNlY29uZCByb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRjb250cm9sbGVyID0gJCgnW2RhdGEtZGItdGFyZ2V0LWZvcj1cIicgKyBkcm9wQmxvY2suJHBhcmVudFNlY3Rpb24uYXR0cignZGF0YS1kYi10YXJnZXQtb2YnKSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5maW5kLnRhcmdldCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2Ugd2FudCB0byBjbG9zZSBsYXN0IGRyb3AgYmxvY2ssIHRoYW4gdGhlcmUgaXMgbm8gbW9yZSBhY3RpdmUgY29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKSA9PT0gXCJkcm9wQmxvY2tcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRib2R5LnJlbW92ZUF0dHIoJ2RhdGEtYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnYm9keSwgaHRtbCcpLnJlbW92ZUNsYXNzKCdsb2NrLXNjcmVlbicpOyAvLyBAdG9kbyBpbnZlc3RpZ2F0ZSBpZiB0aGlzIGlzIG5lZWRlZCBmb3IgZHJvcCBCbG9ja3Mgb3Igd2FzIGNvcGllZCBvdXQgb2Ygb3RoZXIgY29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyb3BCbG9jay4kdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHRhcmdldC5maW5kKCdpbnB1dDpmb2N1cycpLmJsdXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJGNvbnRyb2xsZXIudHJpZ2dlcignZHJvcEJsb2NrOmNsb3NlZCcsIFtkcm9wQmxvY2tdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZHJvcEJsb2NrLmFkZGl0aW9uYWxPbkhpZGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlc2NhcGU6IGZ1bmN0aW9uICgpIHsgLy8gaGlkZSB0YXJnZXQgaWYgdXNlciBjbGlja3MgZXNjYXBlIGtleVxuICAgICAgICAgICAgICAgIC8vIEBmaXhtZSB0aGlzIHNlZW1zIHVudXNlZCBhbmQgZGVwcmVjYXRlZCBieSBjb250cm9sbGVyLmpzXG4gICAgICAgICAgICAgICAgaWYgKGRyb3BCbG9jay4kdGFyZ2V0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLm9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZpbmQ6IHtcbiAgICAgICAgICAgIHRhcmdldDogZnVuY3Rpb24gKCkgeyAvLyBnZXQgdGhlIHRhcmdldCBlbGVtZW50IGlmIGV4aXN0ZWRcbiAgICAgICAgICAgICAgICBpZiAoJChcIltkYXRhLWRiLXRhcmdldC1vZl1cIikubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kdGFyZ2V0cyA9ICQoXCJbZGF0YS1kYi10YXJnZXQtb2ZdXCIpO1xuICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHRhcmdldCAgPSAkKFwiW2RhdGEtZGItdGFyZ2V0LW9mPVwiICsgZHJvcEJsb2NrLiRjb250cm9sbGVyLmF0dHIoXCJkYXRhLWRiLXRhcmdldC1mb3JcIikgKyBcIl1cIik7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kc2VjdGlvbiA9IGRyb3BCbG9jay4kdGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgJG5lc3RlZCAgICAgICAgPSBkcm9wQmxvY2suJHNlY3Rpb24ucGFyZW50cygnLmRyb3BCbG9ja19faG9sZGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkbmVzdGVkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRwYXJlbnRTZWN0aW9uID0gJG5lc3RlZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kcGFyZW50U2VjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZHJvcEJsb2NrLmZpbmQucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBhcmVudDogZnVuY3Rpb24gKCkgeyAvLyBnZXQgdGhlIHBhcmVudCBlbGVtZW50IGlmIGV4aXN0ZWRcblxuICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kcGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHBhcmVudHMgPSAkKFwiW2RhdGEtZGItcGFyZW50LW9mXVwiKTtcblxuICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suJHBhcmVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kcGFyZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBkcm9wQmxvY2suJGNvbnRyb2xsZXIuYXR0cihcImRhdGEtZGItdGFyZ2V0LWZvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnRGb3IgPSAkKHRoaXMpLmRhdGEoXCJkYi1wYXJlbnQtb2ZcIikuc3BsaXQoJywnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudEZvci5pbmRleE9mKGN1cnJlbnQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kcGFyZW50ID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyb3BCbG9jay4kcGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5maW5kLmRpbWVuc2lvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay5maW5kLmlmQ29udGFpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGlmQ29udGFpbmQ6IGZ1bmN0aW9uICgpIHsgLy8gY2hlY2sgaWYgaXQgcGFyZW50IG9yIHRhcmdldCBoYXMgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBpZiAoZHJvcEJsb2NrLiRwYXJlbnQuZmluZChcIi5jb250YWluZXJcIikubGVuZ3RoICYmICEoZHJvcEJsb2NrLiR0YXJnZXQuZmluZChcIi5jb250YWluZXJcIikubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJHRhcmdldC53cmFwSW5uZXIoXCI8ZGl2IGNsYXNzPSdjb250YWluZXInPjwvZGl2PlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGltZW5zaW9uczogZnVuY3Rpb24gKCkgeyAvLyBjb3VudCB0aGUgdG9wIGFuZCBsZWZ0IHBvc2l0aW9uIG9mIHRoZSB0YXJnZXQgZWxlbWVudCBiYXNlZCBvbiB0ZWggcGFyZW50IGVsZW1lbnRcblxuICAgICAgICAgICAgICAgIHZhciBuSGVpZ2h0ICAgICAgICAgID0gZHJvcEJsb2NrLiRwYXJlbnQub3V0ZXJIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgcE9mZnNldCAgICAgICAgICA9IGRyb3BCbG9jay4kcGFyZW50Lm9mZnNldCgpLFxuICAgICAgICAgICAgICAgICAgICBwTGVmdCAgICAgICAgICAgID0gcE9mZnNldC5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICBuV2lkdGggICAgICAgICAgID0gZHJvcEJsb2NrLiRwYXJlbnQuaW5uZXJXaWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZXMgICAgICAgICAgID0ge30sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcl9vZmZzZXQgPSBwT2Zmc2V0O1xuXG4gICAgICAgICAgICAgICAgZHJvcEJsb2NrLiRjb250YWluZXIgPSAkKFwiLmNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgICAgICBpZiAoZHJvcEJsb2NrLiRjb250YWluZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcl9vZmZzZXQgPSBkcm9wQmxvY2suJGNvbnRhaW5lci5vZmZzZXQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyX2xlZnQgPSBjb250YWluZXJfb2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcl9iYXNlID0gY29udGFpbmVyX2xlZnQgKyBkcm9wQmxvY2suJGNvbnRhaW5lci53aWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRfYmFzZSAgICA9IG5XaWR0aCArIHBMZWZ0O1xuXG4gICAgICAgICAgICAgICAgaWYgKGRyb3BCbG9jay4kcGFyZW50LmZpbmQoXCIuc2Nyb2xsVGhlbkZpeFwiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbkhlaWdodCA9IGRyb3BCbG9jay4kcGFyZW50LmZpbmQoXCIuc2Nyb2xsVGhlbkZpeFwiKS5vdXRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suJHBhcmVudC5pbm5lcldpZHRoKCkgPT0gZHJvcEJsb2NrLiRjb250cm9sbGVyLmlubmVyV2lkdGgoKSkge1xuICAgICAgICAgICAgICAgICAgICBuV2lkdGggPSBkcm9wQmxvY2suJHBhcmVudC5oYXNDbGFzcygnbm8tYXV0by13aWR0aCcpID8gXCJcIiA6XCJhdXRvXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkcm9wQmxvY2suaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5XaWR0aCA9IGRyb3BCbG9jay4kcGFyZW50Lmhhc0NsYXNzKCduby1hdXRvLXdpZHRoJykgPyBcIlwiIDpcIjEwMCVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRfYmFzZSA+IGNvbnRhaW5lcl9iYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogbkhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBcIjBweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IG5XaWR0aFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlcyAgICAgICAgICAgID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBuSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IG5XaWR0aFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGlyZWN0aW9uICAgICA9IGRyb3BCbG9jay4kcGFyZW50LmRhdGEoJ2RiLWRpcmVjdGlvbicpIHx8IGRyb3BCbG9jay5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZXNbZGlyZWN0aW9uXSA9ICcwcHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2VudGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0ID0gKGRyb3BCbG9jay4kdGFyZ2V0LmlubmVyV2lkdGgoKSAvIDIpIC0gZHJvcEJsb2NrLiRwYXJlbnQuaW5uZXJXaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlc1snbGVmdCddID0gYGNhbGMoLTUwJSAtICR7b2Zmc2V0fXB4KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZHJvcEJsb2NrLiR0YXJnZXQuY3NzKHN0eWxlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHN3aXRjaDoge1xuICAgICAgICAgICAgaWNvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRyb3BCbG9jay5zd2l0Y2hWYWwgPSBkcm9wQmxvY2suJGNvbnRyb2xsZXIuYXR0cihcImRhdGEtZGItc3dpdGNoXCIpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZHJvcEJsb2NrLnN3aXRjaFZhbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJyb3RhdGVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BCbG9jay4kY29udHJvbGxlci5maW5kKFwiaVwiKS5hZGRDbGFzcyhcImpzLS1yb3RhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wQmxvY2suJGNvbnRyb2xsZXIuZmluZChcImlcIikuYWRkQ2xhc3MoZHJvcEJsb2NrLnN3aXRjaFZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkcm9wQmxvY2suJGNvbnRyb2xsZXJzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9ICQodGhpcykuYXR0cihcImRhdGEtZGItc3dpdGNoXCIpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHRlbXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicm90YXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwiaVwiKS5yZW1vdmVDbGFzcyhcImpzLS1yb3RhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJpXCIpLnJlbW92ZUNsYXNzKHRlbXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGFkZGl0aW9uYWxPblNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRpdGlvbmFsT25IaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVguZHJvcEJsb2NrID0gZHJvcEJsb2NrOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZWRpdEluUGxhY2UgPSB7XG4gICAgICAgICRlZGl0YWJsZXM6IG51bGwsXG4gICAgICAgIGVkaXRhYmxlOiBudWxsLFxuICAgICAgICBlZGl0YWJsZUlucHV0OiBudWxsLFxuICAgICAgICBlZGl0YWJsZVRleHQ6IG51bGwsXG4gICAgICAgIHRhcmdldDogbnVsbCxcbiAgICAgICAgdGFyZ2V0SW5wdXQ6IG51bGwsXG4gICAgICAgIHRhcmdldFRleHQ6IG51bGwsXG4gICAgICAgIENMQVNTX0hJRERFTjogXCJfX2hpZGRlblwiLFxuICAgICAgICB2UG9ydDogJ2FsbCcsIC8vIHRoZSB2aWV3IHBvcnQgdG8gbWFrZSB0aGUgZWRpdCBpbiBwbGFjZSB3b3JrIGFib3ZlXG4gICAgICAgIGlzTW9iaWxlOiBudWxsLFxuXG4gICAgICAgIGVtcHR5UGxhY2Vob2xkZXI6IFwiQ2xpY2sgdG8gZWRpdFwiLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdGFibGUgICAgICA9IFwiLmpzLWVkaXRhYmxlXCI7XG4gICAgICAgICAgICB0aGlzLmVkaXRhYmxlSW5wdXQgPSBcIi5qcy1lZGl0YWJsZV9faW5wdXRcIjtcbiAgICAgICAgICAgIHRoaXMuZWRpdGFibGVUZXh0ICA9IFwiLmpzLWVkaXRhYmxlX190ZXh0XCI7XG4gICAgICAgICAgICB0aGlzLiRlZGl0YWJsZXMgICAgPSAkKHRoaXMuZWRpdGFibGUpO1xuXG4gICAgICAgICAgICAkLmVhY2godGhpcy4kZWRpdGFibGVzLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmICgkKGl0ZW0pLmZpbmQoZWRpdEluUGxhY2UuZWRpdGFibGVUZXh0KS50ZXh0KCkgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAkKGl0ZW0pLmZpbmQoZWRpdEluUGxhY2UuZWRpdGFibGVUZXh0KS50ZXh0KGVkaXRJblBsYWNlLmVtcHR5UGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZWRpdEluUGxhY2UuY29udHJvbGxlcigpO1xuICAgICAgICAgICAgZWRpdEluUGxhY2UucmVzcG9uc2l2ZSgpO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zaXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoZWRpdEluUGxhY2UudlBvcnQgIT09IFwiYWxsXCIpIHtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihlZGl0SW5QbGFjZS52UG9ydCArICctb2ZmJywgZnVuY3Rpb24gKCkgeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGRlYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgICAgIGlmKGVkaXRJblBsYWNlLmlzTW9iaWxlID09PSBudWxsIHx8IGVkaXRJblBsYWNlLmlzTW9iaWxlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS5jb250cm9sbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2UuaXNNb2JpbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihlZGl0SW5QbGFjZS52UG9ydCArICctb24nLCBmdW5jdGlvbiAoKSB7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgICAgIGlmKGVkaXRJblBsYWNlLmlzTW9iaWxlID09PSBudWxsIHx8IGVkaXRJblBsYWNlLmlzTW9iaWxlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2UuZGlzYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLmlzTW9iaWxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWRpdEluUGxhY2UuJGVkaXRhYmxlcy5vbignY2xpY2snLCBlZGl0SW5QbGFjZS5lZGl0YWJsZVRleHQsIGVkaXRJblBsYWNlLm9uLnNob3cpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGVkaXRJblBsYWNlLiRlZGl0YWJsZXMub2ZmKCdjbGljaycsIGVkaXRJblBsYWNlLmVkaXRhYmxlVGV4dCwgZWRpdEluUGxhY2Uub24uc2hvdyk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgICBzaG93OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLm9uLmhpZGVBbGwoKTtcblxuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldCAgICAgICAgICAgICAgID0gJChldmVudC5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KGVkaXRJblBsYWNlLmVkaXRhYmxlKTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRUZXh0ICAgICAgICAgICA9IGVkaXRJblBsYWNlLnRhcmdldC5maW5kKGVkaXRJblBsYWNlLmVkaXRhYmxlVGV4dCk7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXRDb250YWluZXIgPSBlZGl0SW5QbGFjZS50YXJnZXQuZmluZChlZGl0SW5QbGFjZS5lZGl0YWJsZUlucHV0KTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dCAgICAgICAgICA9IGVkaXRJblBsYWNlLnRhcmdldElucHV0Q29udGFpbmVyLmlzKFwiaW5wdXQsIHRleHRhcmVhXCIpID8gZWRpdEluUGxhY2UudGFyZ2V0SW5wdXRDb250YWluZXIgOiBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dENvbnRhaW5lci5maW5kKFwiaW5wdXQsIHRleHRhcmVhXCIpO1xuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldFRleHQuYWRkQ2xhc3MoZWRpdEluUGxhY2UuQ0xBU1NfSElEREVOKTtcblxuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldC5hZGRDbGFzcygnanMtLW9wZW4nKTtcblxuICAgICAgICAgICAgICAgIC8vIGF1dG8gaGVpZ2h0IGZvciB0ZXh0IGFyZWFcbiAgICAgICAgICAgICAgICBpZiAoZWRpdEluUGxhY2UudGFyZ2V0SW5wdXQuaXMoXCJ0ZXh0YXJlYVwiKSkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC5oZWlnaHQoNSk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldElucHV0LmhlaWdodChlZGl0SW5QbGFjZS50YXJnZXRJbnB1dFswXS5zY3JvbGxIZWlnaHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gaGFjayB0byBoYXZlIGN1cnNvciBhdCB0aGUgZW5kIG9mIHRleHQgaW4gaW5wdXRcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBXSFkgVEhJUyBIQUNLISBJIGRvbid0IGtub3dcbiAgICAgICAgICAgICAgICAgdmFyIHRtcFN0ciA9IGVkaXRJblBsYWNlLnRhcmdldElucHV0LnZhbCgpO1xuICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC52YWwoJycpO1xuICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC52YWwodG1wU3RyKTtcbiAgICAgICAgICAgICAgICAgKiovXG4gICAgICAgICAgICAgICAgLy8gZW5kIG9mIGhhY2tcblxuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldElucHV0Lm9uKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleWNvZGUgPSBldmVudC5rZXlDb2RlO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGtleWNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2Uub24uc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS5vbi5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXV0byBoZWlnaHQgZm9yIHRleHQgYXJlYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC5pcyhcInRleHRhcmVhXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldElucHV0LmhlaWdodCg1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXQuaGVpZ2h0KGVkaXRJblBsYWNlLnRhcmdldElucHV0WzBdLnNjcm9sbEhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vZWRpdEluUGxhY2UudGFyZ2V0SW5wdXQub24oJ2JsdXInLCBlZGl0SW5QbGFjZS5vbi5zYXZlKTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dENvbnRhaW5lci5vbignY2xpY2snLCBcIi5idG4tc2F2ZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLm9uLnNhdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBlZGl0SW5QbGFjZS5vbi5jbGlja091dHNpZGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldElucHV0LnZhbChlZGl0SW5QbGFjZS50YXJnZXRUZXh0LnRleHQoKSk7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2Uub24uaGlkZSgpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2F2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBldnQgPSAkLkV2ZW50KCdlZGl0SW5QbGFjZTpvblNhdmUnKTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXQudHJpZ2dlcihldnQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV2dC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0VGV4dC50ZXh0KGVkaXRJblBsYWNlLnRhcmdldElucHV0LnZhbCgpKTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRUZXh0LmF0dHIoXCJ0aXRsZVwiLCBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dC52YWwoKSk7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2Uub24uaGlkZSgpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldC5yZW1vdmVDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXRUZXh0LnJlbW92ZUNsYXNzKGVkaXRJblBsYWNlLkNMQVNTX0hJRERFTik7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXQub2ZmKCdibHVyJywgZWRpdEluUGxhY2Uub24uYmx1cik7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXRDb250YWluZXIub2ZmKCdjbGljaycpO1xuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9mZignY2xpY2snLCBlZGl0SW5QbGFjZS5vbi5jbGlja091dHNpZGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmNsb3Nlc3QoZWRpdEluUGxhY2UuZWRpdGFibGUgKyBcIi5qcy0tb3BlblwiKS5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLm9uLmhpZGVBbGwoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlQWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZWRpdEluUGxhY2UuJGVkaXRhYmxlcy5maWx0ZXIoJy5qcy0tb3BlbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0SW5QbGFjZS50YXJnZXQgICAgICAgICAgICAgICA9ICQodGhpcykuY2xvc2VzdChlZGl0SW5QbGFjZS5lZGl0YWJsZSk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRJblBsYWNlLnRhcmdldFRleHQgICAgICAgICAgID0gJChlZGl0SW5QbGFjZS50YXJnZXQpLmZpbmQoZWRpdEluUGxhY2UuZWRpdGFibGVUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXRDb250YWluZXIgPSAkKGVkaXRJblBsYWNlLnRhcmdldCkuZmluZChlZGl0SW5QbGFjZS5lZGl0YWJsZUlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2UudGFyZ2V0SW5wdXQgICAgICAgICAgPSBlZGl0SW5QbGFjZS50YXJnZXRJbnB1dENvbnRhaW5lci5pcyhcImlucHV0LCB0ZXh0YXJlYVwiKSA/IGVkaXRJblBsYWNlLnRhcmdldElucHV0Q29udGFpbmVyIDogZWRpdEluUGxhY2UudGFyZ2V0SW5wdXRDb250YWluZXIuZmluZChcImlucHV0LCB0ZXh0YXJlYVwiKTtcbiAgICAgICAgICAgICAgICAgICAgZWRpdEluUGxhY2Uub24uc2F2ZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH07XG4gICAgVVguZWRpdEluUGxhY2UgID0gZWRpdEluUGxhY2U7IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpO1xuXG4iLCIkLndpZGdldCggXCJ1aS5zbGlkZXJcIiwgJC51aS5zbGlkZXIsIHtcbiAgICBvcHRpb25zOiB7XG4gICAgICAgIGNoYXJ0OiBmYWxzZSxcbiAgICB9LFxuICAgIF9yZWZyZXNoVmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbGFzdFZhbFBlcmNlbnQsIHZhbFBlcmNlbnQsIHZhbHVlLCB2YWx1ZU1pbiwgdmFsdWVNYXgsXG4gICAgICAgICAgICBvUmFuZ2UgPSB0aGlzLm9wdGlvbnMucmFuZ2UsXG4gICAgICAgICAgICBvQ2hhcnQgPSB0aGlzLm9wdGlvbnMuY2hhcnQsXG4gICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBhbmltYXRlID0gKCAhdGhpcy5fYW5pbWF0ZU9mZiApID8gby5hbmltYXRlIDogZmFsc2UsXG4gICAgICAgICAgICBfc2V0ID0ge307XG5cbiAgICAgICAgaWYgKCB0aGlzLl9oYXNNdWx0aXBsZVZhbHVlcygpICkge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVzLmVhY2goIGZ1bmN0aW9uKCBpICkge1xuXG4gICAgICAgICAgICAgICAgaWYgKG9DaGFydCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGkgPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxQZXJjZW50ID0gKHRoYXQudmFsdWVzKGkpIC0gdGhhdC5fdmFsdWVNaW4oKSkgLyAodGhhdC5fdmFsdWVNYXgoKSAtIHRoYXQuX3ZhbHVlTWluKCkgKyAxKSAqIDEwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIGkgPT09IDEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxQZXJjZW50ID0gKHRoYXQudmFsdWVzKGkpIC0gdGhhdC5fdmFsdWVNaW4oKSArIDEpIC8gKHRoYXQuX3ZhbHVlTWF4KCkgLSB0aGF0Ll92YWx1ZU1pbigpICsgMSkgKiAxMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbFBlcmNlbnQgPSAoIHRoYXQudmFsdWVzKCBpICkgLSB0aGF0Ll92YWx1ZU1pbigpICkgLyAoIHRoYXQuX3ZhbHVlTWF4KCkgLSB0aGF0Ll92YWx1ZU1pbigpICkgKiAxMDA7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICBfc2V0WyB0aGF0Lm9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIiA/IFwibGVmdFwiIDogXCJib3R0b21cIiBdID0gdmFsUGVyY2VudCArIFwiJVwiO1xuICAgICAgICAgICAgICAgICQoIHRoaXMgKS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyBcImFuaW1hdGVcIiA6IFwiY3NzXCIgXSggX3NldCwgby5hbmltYXRlICk7XG4gICAgICAgICAgICAgICAgaWYgKCB0aGF0Lm9wdGlvbnMucmFuZ2UgPT09IHRydWUgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggdGhhdC5vcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGkgPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yYW5nZS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyBcImFuaW1hdGVcIiA6IFwiY3NzXCIgXSgge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB2YWxQZXJjZW50ICsgXCIlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBvLmFuaW1hdGUgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaSA9PT0gMSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnJhbmdlWyBhbmltYXRlID8gXCJhbmltYXRlXCIgOiBcImNzc1wiIF0oIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICggdmFsUGVyY2VudCAtIGxhc3RWYWxQZXJjZW50ICkgKyBcIiVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVldWU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogby5hbmltYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpID09PSAwICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmFuZ2Uuc3RvcCggMSwgMSApWyBhbmltYXRlID8gXCJhbmltYXRlXCIgOiBcImNzc1wiIF0oIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAoIHZhbFBlcmNlbnQgKSArIFwiJVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5hbmltYXRlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGkgPT09IDEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yYW5nZVsgYW5pbWF0ZSA/IFwiYW5pbWF0ZVwiIDogXCJjc3NcIiBdKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogKCB2YWxQZXJjZW50IC0gbGFzdFZhbFBlcmNlbnQgKSArIFwiJVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBvLmFuaW1hdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdFZhbFBlcmNlbnQgPSB2YWxQZXJjZW50O1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlKCk7XG4gICAgICAgICAgICB2YWx1ZU1pbiA9IHRoaXMuX3ZhbHVlTWluKCk7XG4gICAgICAgICAgICB2YWx1ZU1heCA9IHRoaXMuX3ZhbHVlTWF4KCk7XG4gICAgICAgICAgICB2YWxQZXJjZW50ID0gKCB2YWx1ZU1heCAhPT0gdmFsdWVNaW4gKSA/XG4gICAgICAgICAgICAgICAgKCB2YWx1ZSAtIHZhbHVlTWluICkgLyAoIHZhbHVlTWF4IC0gdmFsdWVNaW4gKSAqIDEwMCA6XG4gICAgICAgICAgICAgICAgMDtcbiAgICAgICAgICAgIF9zZXRbIHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gXCJsZWZ0XCIgOiBcImJvdHRvbVwiIF0gPSB2YWxQZXJjZW50ICsgXCIlXCI7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyBcImFuaW1hdGVcIiA6IFwiY3NzXCIgXSggX3NldCwgby5hbmltYXRlICk7XG5cbiAgICAgICAgICAgIGlmICggb1JhbmdlID09PSBcIm1pblwiICYmIHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiICkge1xuICAgICAgICAgICAgICAgIHRoaXMucmFuZ2Uuc3RvcCggMSwgMSApWyBhbmltYXRlID8gXCJhbmltYXRlXCIgOiBcImNzc1wiIF0oIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHZhbFBlcmNlbnQgKyBcIiVcIlxuICAgICAgICAgICAgICAgIH0sIG8uYW5pbWF0ZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCBvUmFuZ2UgPT09IFwibWF4XCIgJiYgdGhpcy5vcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yYW5nZS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyBcImFuaW1hdGVcIiA6IFwiY3NzXCIgXSgge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogKCAxMDAgLSB2YWxQZXJjZW50ICkgKyBcIiVcIlxuICAgICAgICAgICAgICAgIH0sIG8uYW5pbWF0ZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCBvUmFuZ2UgPT09IFwibWluXCIgJiYgdGhpcy5vcmllbnRhdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiICkge1xuICAgICAgICAgICAgICAgIHRoaXMucmFuZ2Uuc3RvcCggMSwgMSApWyBhbmltYXRlID8gXCJhbmltYXRlXCIgOiBcImNzc1wiIF0oIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB2YWxQZXJjZW50ICsgXCIlXCJcbiAgICAgICAgICAgICAgICB9LCBvLmFuaW1hdGUgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggb1JhbmdlID09PSBcIm1heFwiICYmIHRoaXMub3JpZW50YXRpb24gPT09IFwidmVydGljYWxcIiApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlLnN0b3AoIDEsIDEgKVsgYW5pbWF0ZSA/IFwiYW5pbWF0ZVwiIDogXCJjc3NcIiBdKCB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogKCAxMDAgLSB2YWxQZXJjZW50ICkgKyBcIiVcIlxuICAgICAgICAgICAgICAgIH0sIG8uYW5pbWF0ZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbn0pO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKTtcbiAgICB2YXIgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7XG5cbiAgICB2YXIgZmFjZXREYXRlQ2hhcnQgPSB7XG4gICAgICAgICRlbGVtZW50OiAkKCcuZmFjZXREYXRlQ2hhcnQnKSxcbiAgICAgICAgcmFuZ2VTdGFydFZhbDogbnVsbCxcbiAgICAgICAgcmFuZ2VFbmRWYWw6IG51bGwsXG4gICAgICAgIHllYXJXZWlnaHRzOiBudWxsLFxuICAgICAgICBxdWVyeUlEOiBudWxsLFxuICAgICAgICBoZWlnaHQ6IDIwMCxcbiAgICAgICAgYW1wbGlmaWVyUmF0aW86IG51bGwsXG4gICAgICAgIHVybDogbG9jYXRpb24uaHJlZixcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmYWNldERhdGVDaGFydC5yYW5nZVN0YXJ0VmFsID0gcGFyc2VJbnQoZmFjZXREYXRlQ2hhcnQuJGVsZW1lbnQuZGF0YSgnbWluJykpO1xuICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQucmFuZ2VFbmRWYWwgPSBwYXJzZUludChmYWNldERhdGVDaGFydC4kZWxlbWVudC5kYXRhKCdtYXgnKSk7XG4gICAgICAgICAgICBmYWNldERhdGVDaGFydC55ZWFyV2VpZ2h0cyA9IGZhY2V0RGF0ZUNoYXJ0LiRlbGVtZW50LmRhdGEoJ3llYXJ3ZWlnaHRzJyk7XG4gICAgICAgICAgICBmYWNldERhdGVDaGFydC5xdWVyeUlEID0gZmFjZXREYXRlQ2hhcnQuJGVsZW1lbnQuZGF0YSgncXVlcnlpZCcpO1xuICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQuYW1wbGlmaWVyUmF0aW8gPSBwYXJzZUludChmYWNldERhdGVDaGFydC4kZWxlbWVudC5kYXRhKCdhbXBsaWZpZXJyYXRpbycpKTtcblxuICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQuY2hhcnQuaW5pdCgpO1xuICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQuY29udHJvbCgpO1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sOmZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdzbGlkZTpvcGVuZWQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAkKCcudWktc2xpZGVyLWhhbmRsZV9faW5kaWNhdG9yLCAudWktc2xpZGVyLWhhbmRsZV9fbGFiZWwnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5pbml0KCk7XG4gICAgICAgICAgICAgICAgJCggdGhpcyApLm9mZiggZXZlbnQgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTZWxlY3RlZFJhbmdlOiBmdW5jdGlvbiAoc2xpZGVyUmFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBiYXNlVXJsID0gZmFjZXREYXRlQ2hhcnQudXJsLnNwbGl0KCc/JylbMF07XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHJpbmcgPSAoZmFjZXREYXRlQ2hhcnQudXJsLmluZGV4T2YoJz8nKSAhPT0gLTEpID8gZmFjZXREYXRlQ2hhcnQudXJsLnNwbGl0KCc/JylbMV0gOiAnJztcbiAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZ09iaiA9IHt9O1xuXG4gICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVN0cmluZy5zcGxpdCgnJicpLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVZhbCA9IHZhbHVlLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nT2JqW2tleVZhbFswXV0gPSBrZXlWYWxbMV07XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmdPYmouQWZ0ZXJZZWFyICYmIHF1ZXJ5U3RyaW5nT2JqLkJlZm9yZVllYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtxdWVyeVN0cmluZ09iai5BZnRlclllYXIsIHF1ZXJ5U3RyaW5nT2JqLkJlZm9yZVllYXJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFtwYXJzZUludChmYWNldERhdGVDaGFydC5yYW5nZVN0YXJ0VmFsKSwgcGFyc2VJbnQoZmFjZXREYXRlQ2hhcnQucmFuZ2VFbmRWYWwpXTtcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlVXJsOiBmdW5jdGlvbiAoc3RhcnRZZWFyLCBlbmRZZWFyKSB7XG4gICAgICAgICAgICBmYWNldERhdGVDaGFydC5yZW1vdmVQYXJhbSgnQWZ0ZXJZZWFyJyk7XG4gICAgICAgICAgICBmYWNldERhdGVDaGFydC5yZW1vdmVQYXJhbSgnQmVmb3JlWWVhcicpO1xuICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQucmVtb3ZlUGFyYW0oJ3F1ZXJ5SUQnKTtcbiAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LnVybCArPSAoZmFjZXREYXRlQ2hhcnQudXJsLmluZGV4T2YoJz8nKSA+IC0xID8gJyYnIDogJz8nKSArICdBZnRlclllYXI9JyArIHN0YXJ0WWVhciArICcmQmVmb3JlWWVhcj0nICsgZW5kWWVhciArICcmcXVlcnlJRD0nICsgZmFjZXREYXRlQ2hhcnQucXVlcnlJRDtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGZhY2V0RGF0ZUNoYXJ0LnVybDtcbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlUGFyYW06IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIHZhciBiYXNlVXJsID0gZmFjZXREYXRlQ2hhcnQudXJsLnNwbGl0KCc/JylbMF07XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHJpbmcgPSAoZmFjZXREYXRlQ2hhcnQudXJsLmluZGV4T2YoJz8nKSAhPT0gLTEpID8gZmFjZXREYXRlQ2hhcnQudXJsLnNwbGl0KCc/JylbMV0gOiAnJztcbiAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZ09iaiA9IHt9O1xuXG4gICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVN0cmluZy5zcGxpdCgnJicpLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVZhbCA9IHZhbHVlLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nT2JqW2tleVZhbFswXV0gPSBrZXlWYWxbMV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5U3RyaW5nT2JqW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHF1ZXJ5U3RyaW5nT2JqW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nID0gT2JqZWN0LmtleXMocXVlcnlTdHJpbmdPYmopLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICsgJz0nICsgcXVlcnlTdHJpbmdPYmpbdmFsdWVdO1xuICAgICAgICAgICAgICAgIH0pLmpvaW4oJyYnKTtcbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC51cmwgPSBiYXNlVXJsICsgKHF1ZXJ5U3RyaW5nID8gJz8nICsgcXVlcnlTdHJpbmcgOiAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLFxuICAgICAgICBjaGFydDoge1xuXG4gICAgICAgICAgICAvL21vcmUgaW5mbyBodHRwczovL3d3dy5qcXVlcnlzY3JpcHQubmV0L2NoYXJ0LWdyYXBoL0hpc3RvZ3JhbS1TbGlkZXItUGx1Z2luLWpRdWVyeS5odG1sXG5cbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LnNldE9wdGlvbnMoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gZmFjZXREYXRlQ2hhcnQuJGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtcyA9IHNlbGYub3B0aW9ucy5kYXRhLml0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBiaW5zID0gbmV3IEFycmF5KHNlbGYub3B0aW9ucy5udW1iZXJPZkJpbnMpLmZpbGwoMCksXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gc2VsZi5vcHRpb25zLm51bWJlck9mQmlucyxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VQZXJCaW4gPSByYW5nZSAvIHNlbGYub3B0aW9ucy5udW1iZXJPZkJpbnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YUl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHBhcnNlSW50KGRhdGFJdGVtc1tpXS52YWx1ZSAvIHJhbmdlUGVyQmluKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluY3JlbWVudCA9IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFJdGVtc1tpXS5jb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGdyb3VwZWQgZGF0YSBzdHJ1Y3R1cmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGluY3JlbWVudCA9IHBhcnNlSW50KGRhdGFJdGVtc1tpXS5jb3VudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBiaW5zW2luZGV4XSArPSBpbmNyZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoYXJ0TmFtZSA9IHNlbGYuYXR0cignbmFtZScpICsgXCJfX2NoYXJ0XCIsXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlck5hbWUgPSBzZWxmLmF0dHIoJ25hbWUnKSArIFwiX19zbGlkZXJcIjtcblxuICAgICAgICAgICAgICAgIHZhciB3cmFwSHRtbCA9IFwiPGRpdiBjbGFzcz0nXCIgKyBjaGFydE5hbWUgKyBcIicgc3R5bGU9J2hlaWdodDpcIiArIHNlbGYub3B0aW9ucy5oZWlnaHQgKyBcInB4OyBvdmVyZmxvdzogaGlkZGVuOyc+PC9kaXY+XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J1wiICsgc2xpZGVyTmFtZSArIFwiJz48L2Rpdj5cIjtcblxuICAgICAgICAgICAgICAgIHNlbGYuaHRtbCh3cmFwSHRtbCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0UmF0aW8gPSBmYWNldERhdGVDaGFydC5jaGFydC5jYWxjdWxhdGVIZWlnaHRSYXRpbyhiaW5zLCBzZWxmLm9wdGlvbnMuaGVpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGhQZXJCaW4gPSAxMDAgLyBzZWxmLm9wdGlvbnMubnVtYmVyT2ZCaW5zO1xuXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGJpbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJpblJhbmdlID0gZmFjZXREYXRlQ2hhcnQuY2hhcnQuZ2V0QmluUmFuZ2UocmFuZ2VQZXJCaW4sIGksIGZhY2V0RGF0ZUNoYXJ0LiRlbGVtZW50Lm9wdGlvbnMuc2xpZGVyUmFuZ2VbMF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5SYW5nZUNsYXNzID0gXCJiaW4tY29sb3Itc2VsZWN0ZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dFJhbmdlQ2xhc3MgPSBcImJpbi1jb2xvclwiO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMub3B0aW1hbFJhbmdlWzBdIDw9IGJpblJhbmdlWzBdICYmIGJpblJhbmdlWzBdIDw9IHNlbGYub3B0aW9ucy5vcHRpbWFsUmFuZ2VbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluUmFuZ2VDbGFzcyA9IFwiYmluLWNvbG9yLW9wdGltYWwtc2VsZWN0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dFJhbmdlQ2xhc3MgPSBcImJpbi1jb2xvci1vcHRpbWFsXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbFRpcEh0bWwgPSBzZWxmLm9wdGlvbnMuc2hvd1Rvb2x0aXBzID8gXCI8c3BhbiBjbGFzcz0ndG9vbHRpcHRleHQnPlwiICsgYmluUmFuZ2VbMF0gKyBcIi9cIiArIGJpbnNbaV0gKyBcIjwvc3Bhbj5cIiA6IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxlZFZhbHVlID0gcGFyc2VJbnQoYmluc1tpXSAqIGhlaWdodFJhdGlvKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LmNvbnZlcnRUb0hlaWdodChzY2FsZWRWYWx1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBpblJhbmdlT2Zmc2V0ID0gcGFyc2VJbnQoc2VsZi5vcHRpb25zLmhlaWdodCAtIGhlaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRSYW5nZU9mZnNldCA9IC1wYXJzZUludChzZWxmLm9wdGlvbnMuaGVpZ2h0IC0gaGVpZ2h0ICogMik7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGJpbkh0bWwgPSBcIjxkaXYgY2xhc3M9J3Rvb2x0aXAnIHN0eWxlPSdmbG9hdDpsZWZ0IWltcG9ydGFudDt3aWR0aDpcIiArIHdpZHRoUGVyQmluICsgXCIlOyc+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbFRpcEh0bWwgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdiaW4gaW4tcmFuZ2UgXCIgKyBpblJhbmdlQ2xhc3MgKyBcIicgc3R5bGU9J2hlaWdodDpcIiArIGhlaWdodCArIFwicHg7Ym90dG9tOi1cIiArIGluUmFuZ2VPZmZzZXQgKyBcInB4O3Bvc2l0aW9uOiByZWxhdGl2ZTsnPjwvZGl2PlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nYmluIG91dC1vZi1yYW5nZSBcIiArIG91dFJhbmdlQ2xhc3MgKyBcIicgc3R5bGU9J2hlaWdodDpcIiArIGhlaWdodCArIFwicHg7Ym90dG9tOlwiICsgb3V0UmFuZ2VPZmZzZXQgKyBcInB4O3Bvc2l0aW9uOiByZWxhdGl2ZTsnPjwvZGl2PlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCI7XG5cbiAgICAgICAgICAgICAgICAgICAgJChcIi5cIiArIGNoYXJ0TmFtZSkuYXBwZW5kKGJpbkh0bWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICQoXCIuXCIgKyBzbGlkZXJOYW1lKS5zbGlkZXIoe1xuICAgICAgICAgICAgICAgICAgICByYW5nZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbWluOiBzZWxmLm9wdGlvbnMuc2xpZGVyUmFuZ2VbMF0sXG4gICAgICAgICAgICAgICAgICAgIG1heDogc2VsZi5vcHRpb25zLnNsaWRlclJhbmdlWzFdLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHNlbGYub3B0aW9ucy5zZWxlY3RlZFJhbmdlLFxuICAgICAgICAgICAgICAgICAgICBjaGFydDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc2xpZGU6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LnVwZGF0ZSh1aS52YWx1ZXMsIHNlbGYub3B0aW9ucy5zbGlkZXJSYW5nZVswXSwgcmFuZ2VQZXJCaW4sIGNoYXJ0TmFtZSwgc2xpZGVyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKGV2ZW50LCB1aSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChldmVudC50YXJnZXQpLmZpbmQoJy51aS1zbGlkZXItaGFuZGxlJykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cInVpLXNsaWRlci1oYW5kbGVfX2luZGljYXRvclwiPjwvc3Bhbj4nKS5maXJzdCgpLmFkZENsYXNzKCdmaXJzdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJChldmVudC50YXJnZXQpLmZpbmQoJy51aS1zbGlkZXItaGFuZGxlJykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cInVpLXNsaWRlci1oYW5kbGVfX2xhYmVsXCI+PC9zcGFuPicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJChldmVudC50YXJnZXQpLmZpbmQoJy51aS1zbGlkZXItaGFuZGxlX19pbmRpY2F0b3InKS5oZWlnaHQoZmFjZXREYXRlQ2hhcnQuaGVpZ2h0ICsgMTApO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LnVwZGF0ZVVybCh1aS52YWx1ZXNbMF0sIHVpLnZhbHVlc1sxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5jaGFydC51cGRhdGUoc2VsZi5vcHRpb25zLnNlbGVjdGVkUmFuZ2UsIHNlbGYub3B0aW9ucy5zbGlkZXJSYW5nZVswXSwgcmFuZ2VQZXJCaW4sIGNoYXJ0TmFtZSwgc2xpZGVyTmFtZSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBzZXRPcHRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XCJpdGVtc1wiOiBbXX07XG4gICAgICAgICAgICAgICAgJC5lYWNoKGZhY2V0RGF0ZUNoYXJ0LnllYXJXZWlnaHRzLCBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXRlbXMucHVzaCh7XCJ2YWx1ZVwiOiBpbmRleCwgXCJjb3VudFwiOiB2YWx1ZSAqIGZhY2V0RGF0ZUNoYXJ0LmFtcGxpZmllclJhdGlvfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5jaGFydC5zZXRIZWlnaHQoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVyUmFuZ2U6IFtmYWNldERhdGVDaGFydC5yYW5nZVN0YXJ0VmFsLCBmYWNldERhdGVDaGFydC5yYW5nZUVuZFZhbF0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGltYWxSYW5nZTogW2ZhY2V0RGF0ZUNoYXJ0LnJhbmdlU3RhcnRWYWwsIGZhY2V0RGF0ZUNoYXJ0LnJhbmdlRW5kVmFsXSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSYW5nZTogZmFjZXREYXRlQ2hhcnQuZ2V0U2VsZWN0ZWRSYW5nZSgpLFxuICAgICAgICAgICAgICAgICAgICBudW1iZXJPZkJpbnM6IGRhdGEuaXRlbXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGZhY2V0RGF0ZUNoYXJ0LmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgc2hvd1Rvb2x0aXBzOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC4kZWxlbWVudC5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRIZWlnaHQ6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5oZWlnaHQ9TWF0aC5tYXguYXBwbHkoTWF0aCxkYXRhLml0ZW1zLm1hcChmdW5jdGlvbihvKXtyZXR1cm4gby5jb3VudDt9KSkgKjUgKzIwO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZhY2V0RGF0ZUNoYXJ0LmhlaWdodCA8IDE1MCkge1xuICAgICAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5oZWlnaHQgPSAxNTA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoc2VsZWN0ZWRSYW5nZSwgc2xpZGVyTWluLCByYW5nZVBlckJpbiwgY2hhcnROYW1lLCBzbGlkZXJOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRWYWx1ZSA9IHNlbGVjdGVkUmFuZ2VbMF0sXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0VmFsdWUgPSBzZWxlY3RlZFJhbmdlWzFdLFxuXG4gICAgICAgICAgICAgICAgICAgICRtaW5MYWJlbEhhbmRsZXIgPSAkKFwiLlwiICsgc2xpZGVyTmFtZSkuZmluZCgnLnVpLXNsaWRlci1oYW5kbGUuZmlyc3QgLnVpLXNsaWRlci1oYW5kbGVfX2xhYmVsJykuaHRtbChsZWZ0VmFsdWUpLFxuICAgICAgICAgICAgICAgICAgICAkbWF4TGFiZWxIYW5kbGVyID0gJChcIi5cIiArIHNsaWRlck5hbWUpLmZpbmQoJy51aS1zbGlkZXItaGFuZGxlOm5vdCguZmlyc3QpIC51aS1zbGlkZXItaGFuZGxlX19sYWJlbCcpLmh0bWwocmlnaHRWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgb3BhY2l0eSBwZXIgYmluIGJhc2VkIG9uIHRoZSBzbGlkZXIgdmFsdWVzXG4gICAgICAgICAgICAgICAgJChcIi5cIiArIGNoYXJ0TmFtZSArIFwiIC5pbi1yYW5nZVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYmluKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiaW5SYW5nZSA9IGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LmdldEJpblJhbmdlKHJhbmdlUGVyQmluLCBpbmRleCwgc2xpZGVyTWluKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYmluUmFuZ2VbMV0gPCByaWdodFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgb3BhY2l0eSBiYXNlZCBvbiBsZWZ0IChtaW4pIHNsaWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnRWYWx1ZSA+IGJpblJhbmdlWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQuY2hhcnQuc2V0T3BhY2l0eShiaW4sIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsZWZ0VmFsdWUgPCBiaW5SYW5nZVswXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LnNldE9wYWNpdHkoYmluLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zZXRPcGFjaXR5KGJpbiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZXREYXRlQ2hhcnQuY2hhcnQuc2V0T3BhY2l0eShiaW4sIDEgLSAobGVmdFZhbHVlIC0gYmluUmFuZ2VbMF0pIC8gcmFuZ2VQZXJCaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJpblJhbmdlWzBdID4gbGVmdFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgb3BhY2l0eSBiYXNlZCBvbiByaWdodCAobWF4KSBzbGlkZXIgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyaWdodFZhbHVlID4gYmluUmFuZ2VbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5jaGFydC5zZXRPcGFjaXR5KGJpbiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJpZ2h0VmFsdWUgPCBiaW5SYW5nZVswXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LnNldE9wYWNpdHkoYmluLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5jaGFydC5zZXRPcGFjaXR5KGJpbiwgMSAtIChyaWdodFZhbHVlIC0gYmluUmFuZ2VbMF0pIC8gcmFuZ2VQZXJCaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZhY2V0RGF0ZUNoYXJ0LmNoYXJ0LnNldExhYmVsSGFuZGxlcnNQb3NpdGlvbigkbWluTGFiZWxIYW5kbGVyLCAkbWF4TGFiZWxIYW5kbGVyKTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmYWNldERhdGVDaGFydC5jaGFydC5zZXRMYWJlbEhhbmRsZXJzUG9zaXRpb24oJG1pbkxhYmVsSGFuZGxlciwgJG1heExhYmVsSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfSwgNTAwKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldExhYmVsSGFuZGxlcnNQb3NpdGlvbjogZnVuY3Rpb24gKCRtaW5MYWJlbEhhbmRsZXIsICRtYXhMYWJlbEhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWluT3V0ZXJMZWZ0ID0gJG1pbkxhYmVsSGFuZGxlci5vZmZzZXQoKS5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aCA9ICRtaW5MYWJlbEhhbmRsZXIub3V0ZXJXaWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBtaW5PdXRlclJpZ2h0ID0gbWluT3V0ZXJMZWZ0ICsgbWluV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIG1heE91dGVyTGVmdCA9ICRtYXhMYWJlbEhhbmRsZXIub2Zmc2V0KCkubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VMYWJlbHNQb3NpdGlvbiA9IG1heE91dGVyTGVmdCAtIG1pbk91dGVyUmlnaHQgLSAyLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW5WYWx1ZSA9ICgyIC0gcmFuZ2VMYWJlbHNQb3NpdGlvbikgLyAyO1xuXG5cbiAgICAgICAgICAgICAgICAkbWluTGFiZWxIYW5kbGVyLmNzcygnbGVmdCcsICctPScgKyAgbWFyZ2luVmFsdWUpO1xuICAgICAgICAgICAgICAgICRtYXhMYWJlbEhhbmRsZXIuY3NzKCdsZWZ0JywgJys9JyArIG1hcmdpblZhbHVlKTtcblxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHJhbmdlTGFiZWxzUG9zaXRpb24pID4gMikge1xuICAgICAgICAgICAgICAgICAgICAkbWluTGFiZWxIYW5kbGVyLmNzcygnbGVmdCcsICcwJyk7XG4gICAgICAgICAgICAgICAgICAgICRtYXhMYWJlbEhhbmRsZXIuY3NzKCdsZWZ0JywgJzAnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0QmluUmFuZ2U6IGZ1bmN0aW9uIChyYW5nZVBlckJpbiwgaW5kZXgsIHNsaWRlck1pbikge1xuICAgICAgICAgICAgICAgIHZhciBtaW4gPSAocmFuZ2VQZXJCaW4gKiBpbmRleCkgKyBzbGlkZXJNaW4sXG4gICAgICAgICAgICAgICAgICAgIG1heCA9IHJhbmdlUGVyQmluICogKGluZGV4ICsgMSkgLSAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJhbmdlUGVyQmluID09IDEpXG4gICAgICAgICAgICAgICAgICAgIG1heCA9IG1pbjtcblxuICAgICAgICAgICAgICAgIHJldHVybiBbbWluLCBtYXhdO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc2V0T3BhY2l0eTogZnVuY3Rpb24gKGJpbiwgdmFsKSB7XG4gICAgICAgICAgICAgICAgJChiaW4pLmNzcyhcIm9wYWNpdHlcIiwgdmFsKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNvbnZlcnRUb0hlaWdodDogZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoNSAqIHYgKyAxKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNhbGN1bGF0ZUhlaWdodFJhdGlvOiBmdW5jdGlvbiAoYmlucywgY2hhcnRIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4VmFsdWUgPSBNYXRoLm1heC5hcHBseShudWxsLCBiaW5zKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gZmFjZXREYXRlQ2hhcnQuY2hhcnQuY29udmVydFRvSGVpZ2h0KG1heFZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaGVpZ2h0ID4gY2hhcnRIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoYXJ0SGVpZ2h0IC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVWC5mYWNldERhdGVDaGFydCA9IGZhY2V0RGF0ZUNoYXJ0OyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XG4gICAgdmFyICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuXG4gICAgdmFyIGZhY2V0RGF0ZSA9IHtcbiAgICAgICAgc2xpZGVyUmFuZ2VzOiBbXSxcbiAgICAgICAgc2xpZGVyVmFsdWVzOiBbXSxcbiAgICAgICAgJHJhbmdlU3RhcnQ6ICQoJy5yYW5nZS1zbGlkZXJfX3N0YXJ0JyksXG4gICAgICAgICRyYW5nZUVuZDogJCgnLnJhbmdlLXNsaWRlcl9fZW5kJyksXG4gICAgICAgIHVybDogbG9jYXRpb24uaHJlZixcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmYWNldERhdGUuJHJhbmdlU3RhcnQ9ICQoJy5yYW5nZS1zbGlkZXJfX3N0YXJ0Jyk7XG4gICAgICAgICAgICBmYWNldERhdGUuJHJhbmdlRW5kPSAkKCcucmFuZ2Utc2xpZGVyX19lbmQnKTtcbiAgICAgICAgICAgIGZhY2V0RGF0ZS5pbml0UmFuZ2UoKTtcbiAgICAgICAgICAgIGZhY2V0RGF0ZS5jb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGluaXRSYW5nZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCgnLnJhbmdlLXNsaWRlcicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciAkc2xpZGVyUmFuZ2UgPSAkKHRoaXMpLmZpbmQoJy5yYW5nZS1zbGlkZXJfX3JhbmdlJyk7XG4gICAgICAgICAgICAgICAgaWYgKCEkc2xpZGVyUmFuZ2UuaGFzQ2xhc3MoXCJqY2YtaGlkZGVuXCIpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZyZXF1ZW5jaWVzID0gJHNsaWRlclJhbmdlLmRhdGEoJ2ZyZXF1ZW5jaWVzJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vbkxpbmVhclNsaWRlclN0ZXBzID0gWzEsIDIsIDUsIDEwXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFsbG93ZWRUb3RhbFllYXJzID0gbm9uTGluZWFyU2xpZGVyU3RlcHMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXIpIHsgcmV0dXJuIHByZXYgKyBjdXI7IH0pICogMjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1heFZhbCA9IHBhcnNlSW50KCRzbGlkZXJSYW5nZS5hdHRyKCdtYXgnKSwgMTApO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWluVmFsID0gcGFyc2VJbnQoJHNsaWRlclJhbmdlLmF0dHIoJ21pbicpLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFllYXJzID0gbWF4VmFsIC0gbWluVmFsO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGluZWFyU2xpZGVyID0gJHNsaWRlclJhbmdlLmF0dHIoJ2RhdGEtc2xpZGVyLXR5cGUnKSA9PT0gJ2xpbmVhcic7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsWWVhcnMgPiBhbGxvd2VkVG90YWxZZWFycyAmJiAhbGluZWFyU2xpZGVyKSB7IC8vIG5vbi1saW5lYXIgc2xpZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlzcGxheVN0ZXBzID0gbm9uTGluZWFyU2xpZGVyU3RlcHMuc2xpY2UoKS5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluaW5nID0gdG90YWxZZWFycztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydFllYXIgPSBtaW5WYWw7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRTbGljZSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uIChzdGVwLCBpLCBhbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25lVGhpcmQgPSBNYXRoLmZsb29yKHJlbWFpbmluZyAvIDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0d29UaGlyZHMgPSBNYXRoLmZsb29yKDIgKiBvbmVUaGlyZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbmRlciA9IHR3b1RoaXJkcyAlIHN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbmRlciA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0d29UaGlyZHMgPSB0d29UaGlyZHMgLSByZW1haW5kZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZyA9IHJlbWFpbmluZyAtIHR3b1RoaXJkcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09IGRpc3BsYXlTdGVwcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZS5zbGlkZXJSYW5nZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3RhcnQnOiBzdGFydFllYXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3RvcCc6IG1heFZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5U3RlcCc6IG5vbkxpbmVhclNsaWRlclN0ZXBzW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NsaWRlU3RlcCc6IHN0ZXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZnJlcSc6IGZyZXF1ZW5jaWVzLnNsaWNlKHN0YXJ0U2xpY2UsIGZyZXF1ZW5jaWVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZXREYXRlLnNsaWRlclJhbmdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdGFydCc6IHN0YXJ0WWVhcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdG9wJzogc3RhcnRZZWFyICsgdHdvVGhpcmRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXlTdGVwJzogbm9uTGluZWFyU2xpZGVyU3RlcHNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2xpZGVTdGVwJzogc3RlcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmcmVxJzogZnJlcXVlbmNpZXMuc2xpY2Uoc3RhcnRTbGljZSwgc3RhcnRTbGljZSArIHR3b1RoaXJkcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0U2xpY2UgPSBzdGFydFNsaWNlICsgdHdvVGhpcmRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0WWVhciA9IHN0YXJ0WWVhciArIHR3b1RoaXJkcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWNldERhdGUuc2xpZGVyUmFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWRlclZhbCA9IHJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzbGlkZXJWYWwgPD0gcmFuZ2Uuc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFjZXREYXRlLnNsaWRlclZhbHVlcy5pbmRleE9mKHNsaWRlclZhbCk8MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZXREYXRlLnNsaWRlclZhbHVlcy5wdXNoKHNsaWRlclZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVyVmFsICs9IHJhbmdlLnNsaWRlU3RlcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gbGluZWFyIHNsaWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmYWNldERhdGUuc2xpZGVyVmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gbWluVmFsOyBpIDw9IG1heFZhbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICRzbGlkZXJSYW5nZS5hdHRyKCdtaW4nLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlclJhbmdlLmF0dHIoJ21heCcsIGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0aWFsVmFsdWUgPSBmYWNldERhdGUuZ2V0U2VsZWN0ZWRSYW5nZSgkc2xpZGVyUmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICBmYWNldERhdGUuJHJhbmdlU3RhcnQudmFsKGluaXRpYWxWYWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZS4kcmFuZ2VFbmQudmFsKGluaXRpYWxWYWx1ZVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0aWFsUG9zaXRpb24gPSBmYWNldERhdGUuZ2V0U2VsZWN0ZWRSYW5nZVBvc2l0aW9uKGluaXRpYWxWYWx1ZVswXSwgaW5pdGlhbFZhbHVlWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlclJhbmdlLmF0dHIoJ3ZhbHVlJywgaW5pdGlhbFBvc2l0aW9uLmpvaW4oJywnKSk7XG4gICAgICAgICAgICAgICAgICAgIGpjZi5yZXBsYWNlKCRzbGlkZXJSYW5nZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVuZGVyIGZyZXF1ZW5jaWVzXG4gICAgICAgICAgICAgICAgICAgIGlmIChmcmVxdWVuY2llcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRyYW5nZVdyYXBwZXIgPSAkKHRoaXMpLmZpbmQoJy5qY2YtcmFuZ2Utd3JhcHBlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRyYW5nZUZyZXF1ZW5jaWVzID0gJCgnPHNwYW4gY2xhc3M9XCJqY2YtcmFuZ2UtZnJlcXVlbmNpZXNcIj48L3NwYW4+Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbFllYXJzID4gYWxsb3dlZFRvdGFsWWVhcnMgJiYgIWxpbmVhclNsaWRlcikgeyAvLyBub24tbGluZWFyIHNsaWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2V0RGF0ZS5zbGlkZXJSYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAocmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZS5mcmVxLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHJhbmdlU2xpY2UgPSAkKCc8c3BhbiBjbGFzcz1cImpjZi1yYW5nZS1mcmVxdWVuY2llc19fc2xpY2VcIiBzdHlsZT1cIndpZHRoOiAnICsgKCgxMDAgLyByYW5nZS5mcmVxLmxlbmd0aCkgLyBmYWNldERhdGUuc2xpZGVyUmFuZ2VzLmxlbmd0aCkgKyAnJTsgb3BhY2l0eTogJyArIHJhbmdlLmZyZXFbaV0gKyAnXCI+PC9zcGFuPicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhbmdlRnJlcXVlbmNpZXMuYXBwZW5kKCRyYW5nZVNsaWNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyYW5nZVdyYXBwZXIucHJlcGVuZCgkcmFuZ2VGcmVxdWVuY2llcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyBsaW5lYXIgc2xpZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlU2xpY2VXaWR0aCA9IDEwMCAvIGZyZXF1ZW5jaWVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZyZXF1ZW5jaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkcmFuZ2VTbGljZSA9ICQoJzxzcGFuIGNsYXNzPVwiamNmLXJhbmdlLWZyZXF1ZW5jaWVzX19zbGljZVwiIHN0eWxlPVwid2lkdGg6ICcgKyByYW5nZVNsaWNlV2lkdGggKyAnJTsgb3BhY2l0eTogJyArIGZyZXF1ZW5jaWVzW2ldICsgJ1wiPjwvc3Bhbj4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhbmdlRnJlcXVlbmNpZXMuYXBwZW5kKCRyYW5nZVNsaWNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhbmdlV3JhcHBlci5wcmVwZW5kKCRyYW5nZUZyZXF1ZW5jaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnLmN1c3RvbS1kYXRlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZmFjZXREYXRlLm9uLnRvZ2dsZSgkKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcIlVYLWF0dGFjaFwiLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgZmFjZXREYXRlLmluaXQoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcIlVYLWRldGFjaFwiLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgamNmLmRlc3Ryb3koJChcIi5yYW5nZS1zbGlkZXJfX3JhbmdlXCIpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKCcucmFuZ2Utc2xpZGVyX19yYW5nZScpLmNoYW5nZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmYWNldERhdGUub24uc2V0UmFuZ2UoJCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmFjZXREYXRlLiRyYW5nZVN0YXJ0Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmYWNldERhdGUub24uc2V0U3RhcnQoJCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmFjZXREYXRlLiRyYW5nZUVuZC5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZmFjZXREYXRlLm9uLnNldEVuZCgkKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKCcucmFuZ2Utc2xpZGVyX19yYW5nZScpLm9uKCdjaGFuZ2UgY2hhbmdlOnN0YXJ0ZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZmFjZXREYXRlLnVwZGF0ZVVybCgkKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbjoge1xuICAgICAgICAgICAgdG9nZ2xlOiBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgIHZhciAkdG9nZ2xlID0gZWxlbS5jbG9zZXN0KCcuZmFjZXQnKTtcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9ICR0b2dnbGUuZmluZCgnLmN1c3RvbS1kYXRlLWZvcm0nKS5zbGlkZVRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGVsZW0udG9nZ2xlQ2xhc3MoJ2pzLS1vcGVuJyk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRSYW5nZTogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgJHRvZ2dsZSA9IGVsZW0uY2xvc2VzdCgnLnJhbmdlLXNsaWRlcicpO1xuICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJHRvZ2dsZS5maW5kKCcuamNmLWFjdGl2ZS1oYW5kbGUnKTtcblxuICAgICAgICAgICAgICAgIHZhciB0bXAgPSAkdGFyZ2V0LmF0dHIoXCJjbGFzc1wiKS5tYXRjaCgvamNmLWluZGV4W1xcdy1dKlxcYi8pO1xuICAgICAgICAgICAgICAgIHZhciB0bXAyID0gdG1wLnRvU3RyaW5nKCkuc3BsaXQoJy0nKVsyXTtcbiAgICAgICAgICAgICAgICAkKCdpbnB1dC5pbmRleC0nICsgdG1wMikudmFsKGZhY2V0RGF0ZS5nZXRWYWx1ZShlbGVtKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0U3RhcnQ6IGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyICRzbGlkZXJSYW5nZSA9IGVsZW0uY2xvc2VzdCgnLnJhbmdlLXNsaWRlcicpLmZpbmQoJy5yYW5nZS1zbGlkZXJfX3JhbmdlJyk7XG4gICAgICAgICAgICAgICAgdmFyIG1pblZhbCA9IHBhcnNlSW50KCRzbGlkZXJSYW5nZS5hdHRyKCdtaW4nKSwgMTApO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzVmFsID0gZmFjZXREYXRlLmdldFZhbHVlRnJvbUlucHV0KGVsZW0pO1xuICAgICAgICAgICAgICAgIHZhciBzbGlkZXJJbnN0YW5jZSA9IGpjZi5nZXRJbnN0YW5jZSgkc2xpZGVyUmFuZ2UpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzVmFsID49IG1pblZhbCAmJiB0aGlzVmFsIDw9IHNsaWRlckluc3RhbmNlLnZhbHVlc1sxXSkge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXJJbnN0YW5jZS52YWx1ZXNbMF0gPSB0aGlzVmFsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHNsaWRlckluc3RhbmNlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlclJhbmdlLnRyaWdnZXIoJ2NoYW5nZTpzdGFydGVuZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRFbmQ6IGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyICRzbGlkZXJSYW5nZSA9IGVsZW0uY2xvc2VzdCgnLnJhbmdlLXNsaWRlcicpLmZpbmQoJy5yYW5nZS1zbGlkZXJfX3JhbmdlJyk7XG4gICAgICAgICAgICAgICAgdmFyIG1heFZhbCA9IHBhcnNlSW50KCRzbGlkZXJSYW5nZS5hdHRyKCdtYXgnKSwgMTApO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzVmFsID0gZmFjZXREYXRlLmdldFZhbHVlRnJvbUlucHV0KGVsZW0pO1xuICAgICAgICAgICAgICAgIHZhciBzbGlkZXJJbnN0YW5jZSA9IGpjZi5nZXRJbnN0YW5jZSgkc2xpZGVyUmFuZ2UpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzVmFsIDw9IG1heFZhbCAmJiB0aGlzVmFsID49IHNsaWRlckluc3RhbmNlLnZhbHVlc1swXSkge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXJJbnN0YW5jZS52YWx1ZXNbMV0gPSB0aGlzVmFsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHNsaWRlckluc3RhbmNlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlclJhbmdlLnRyaWdnZXIoJ2NoYW5nZTpzdGFydGVuZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByYW5nZVVwZGF0ZTogZnVuY3Rpb24gKGVsZW0sIGNhbGxiYWNrRm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgJHNsaWRlclJhbmdlID0gJChlbGVtKTtcbiAgICAgICAgICAgICAgICAkc2xpZGVyUmFuZ2Uub24oJ2NoYW5nZSBjaGFuZ2U6c3RhcnRlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrRm4oZmFjZXREYXRlLiRyYW5nZVN0YXJ0LnZhbCgpLCBmYWNldERhdGUuJHJhbmdlRW5kLnZhbCgpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICB2YXIgJHNsaWRlclJhbmdlID0gZWxlbS5jbG9zZXN0KCcucmFuZ2Utc2xpZGVyJykuZmluZCgnLnJhbmdlLXNsaWRlcl9fcmFuZ2UnKTtcbiAgICAgICAgICAgIHZhciB0aGlzVmFsSW5kZXggPSBwYXJzZUludChlbGVtLnZhbCgpLCAxMCk7XG4gICAgICAgICAgICB2YXIgdGhpc1ZhbCA9IGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXNbdGhpc1ZhbEluZGV4XTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXNWYWw7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFZhbHVlRnJvbUlucHV0OiBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgdmFyICRzbGlkZXJSYW5nZSA9IGVsZW0uY2xvc2VzdCgnLnJhbmdlLXNsaWRlcicpLmZpbmQoJy5yYW5nZS1zbGlkZXJfX3JhbmdlJyk7XG4gICAgICAgICAgICB2YXIgY3VzdG9tVmFsID0gcGFyc2VJbnQoZWxlbS52YWwoKSwgMTApO1xuICAgICAgICAgICAgdmFyIG1pblZhbCA9IHBhcnNlSW50KCRzbGlkZXJSYW5nZS5hdHRyKCdkYXRhLW1pbicpLCAxMCk7XG4gICAgICAgICAgICB2YXIgbWF4VmFsID0gcGFyc2VJbnQoJHNsaWRlclJhbmdlLmF0dHIoJ2RhdGEtbWF4JyksIDEwKTtcbiAgICAgICAgICAgIHZhciB0aGlzVmFsO1xuXG4gICAgICAgICAgICBpZiAoY3VzdG9tVmFsIDw9IG1heFZhbCAmJiBjdXN0b21WYWwgPj0gbWluVmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMuaW5kZXhPZihjdXN0b21WYWwpPj0wKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNWYWwgPSBmYWNldERhdGUuc2xpZGVyVmFsdWVzLmluZGV4T2YoY3VzdG9tVmFsKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xvc2VzdCA9IGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKE1hdGguYWJzKGN1cnIgLSBjdXN0b21WYWwpIDwgTWF0aC5hYnMocHJldiAtIGN1c3RvbVZhbCkgPyBjdXJyIDogcHJldik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzVmFsID0gZmFjZXREYXRlLnNsaWRlclZhbHVlcy5pbmRleE9mKGNsb3Nlc3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzVmFsO1xuICAgICAgICB9LFxuICAgICAgICByZW1vdmVQYXJhbTogZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgdmFyIGJhc2VVcmwgPSBmYWNldERhdGUudXJsLnNwbGl0KCc/JylbMF07XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHJpbmcgPSAoZmFjZXREYXRlLnVybC5pbmRleE9mKCc/JykgIT09IC0xKSA/IGZhY2V0RGF0ZS51cmwuc3BsaXQoJz8nKVsxXSA6ICcnO1xuICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nT2JqID0ge307XG5cbiAgICAgICAgICAgIGlmIChxdWVyeVN0cmluZykge1xuICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nLnNwbGl0KCcmJykubWFwKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VmFsID0gdmFsdWUuc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmdPYmpba2V5VmFsWzBdXSA9IGtleVZhbFsxXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmdPYmpba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcXVlcnlTdHJpbmdPYmpba2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcXVlcnlTdHJpbmcgPSBPYmplY3Qua2V5cyhxdWVyeVN0cmluZ09iaikubWFwKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgKyAnPScgKyBxdWVyeVN0cmluZ09ialt2YWx1ZV07XG4gICAgICAgICAgICAgICAgfSkuam9pbignJicpO1xuICAgICAgICAgICAgICAgIGZhY2V0RGF0ZS51cmwgPSBiYXNlVXJsICsgKHF1ZXJ5U3RyaW5nID8gJz8nICsgcXVlcnlTdHJpbmcgOiAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldFNlbGVjdGVkUmFuZ2U6IGZ1bmN0aW9uIChzbGlkZXJSYW5nZSkge1xuICAgICAgICAgICAgdmFyIGJhc2VVcmwgPSBmYWNldERhdGUudXJsLnNwbGl0KCc/JylbMF07XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHJpbmcgPSAoZmFjZXREYXRlLnVybC5pbmRleE9mKCc/JykgIT09IC0xKSA/IGZhY2V0RGF0ZS51cmwuc3BsaXQoJz8nKVsxXSA6ICcnO1xuICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nT2JqID0ge307XG5cbiAgICAgICAgICAgIGlmIChxdWVyeVN0cmluZykge1xuICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nLnNwbGl0KCcmJykubWFwKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VmFsID0gdmFsdWUuc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmdPYmpba2V5VmFsWzBdXSA9IGtleVZhbFsxXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmdPYmouQWZ0ZXJZZWFyICYmIHF1ZXJ5U3RyaW5nT2JqLkJlZm9yZVllYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtxdWVyeVN0cmluZ09iai5BZnRlclllYXIsIHF1ZXJ5U3RyaW5nT2JqLkJlZm9yZVllYXJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFtwYXJzZUludChzbGlkZXJSYW5nZS5hdHRyKCdkYXRhLW1pbicpLCAxMCksIHBhcnNlSW50KHNsaWRlclJhbmdlLmF0dHIoJ2RhdGEtbWF4JyksIDEwKV07XG4gICAgICAgIH0sXG4gICAgICAgIGdldFNlbGVjdGVkUmFuZ2VQb3NpdGlvbjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgICAgIHZhciBjbG9zZXN0U3RhcnQ7XG4gICAgICAgICAgICB2YXIgY2xvc2VzdEVuZDtcblxuICAgICAgICAgICAgaWYgKGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMuaW5kZXhPZihzdGFydCk8MCkge1xuICAgICAgICAgICAgICAgIGNsb3Nlc3RTdGFydCA9IGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoTWF0aC5hYnMoY3VyciAtIHN0YXJ0KSA8IE1hdGguYWJzKHByZXYgLSBzdGFydCkgPyBjdXJyIDogcHJldik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmYWNldERhdGUuc2xpZGVyVmFsdWVzLmluZGV4T2YoZW5kKTwwKSB7XG4gICAgICAgICAgICAgICAgY2xvc2VzdEVuZCA9IGZhY2V0RGF0ZS5zbGlkZXJWYWx1ZXMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoTWF0aC5hYnMoY3VyciAtIGVuZCkgPCBNYXRoLmFicyhwcmV2IC0gZW5kKSA/IGN1cnIgOiBwcmV2KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFtmYWNldERhdGUuc2xpZGVyVmFsdWVzLmluZGV4T2YoY2xvc2VzdFN0YXJ0IHx8IHN0YXJ0KSwgZmFjZXREYXRlLnNsaWRlclZhbHVlcy5pbmRleE9mKGNsb3Nlc3RFbmQgfHwgZW5kKV07XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZVVybDogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgIGZhY2V0RGF0ZS5yZW1vdmVQYXJhbSgnQWZ0ZXJZZWFyJyk7XG4gICAgICAgICAgICBmYWNldERhdGUucmVtb3ZlUGFyYW0oJ0JlZm9yZVllYXInKTtcbiAgICAgICAgICAgIGZhY2V0RGF0ZS5yZW1vdmVQYXJhbSgncXVlcnlJRCcpO1xuICAgICAgICAgICAgZmFjZXREYXRlLnVybCArPSAoZmFjZXREYXRlLnVybC5pbmRleE9mKCc/JykgPiAtMSA/ICcmJyA6ICc/JykgKyAnQWZ0ZXJZZWFyPScgKyBmYWNldERhdGUuJHJhbmdlU3RhcnQudmFsKCkgKyAnJkJlZm9yZVllYXI9JyArIGZhY2V0RGF0ZS4kcmFuZ2VFbmQudmFsKCkgKyAnJnF1ZXJ5SUQ9JyArICQoZWxlbSkuYXR0cignZGF0YS1xdWVyeUlEJyk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBmYWNldERhdGUudXJsO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVYLmZhY2V0RGF0ZSA9IGZhY2V0RGF0ZTsgLy8gYWRkIHRvIGdsb2JhbCBuYW1lc3BhY2Vcbn0pKCk7XG4iLCJfX3dlYnBhY2tfcHVibGljX3BhdGhfXyA9ICcvbGlicmFyaWVzL3VpLWNvcmUvcmVsZWFzZWRBc3NldHMvJztcbmlmIChsb2NhdGlvbi5ocmVmLmluZGV4T2YoJ3NwZWNzJykgPiAtMSkge1xuICAgIF9fd2VicGFja19wdWJsaWNfcGF0aF9fID0gYC9zcGVjcyR7X193ZWJwYWNrX3B1YmxpY19wYXRoX199YFxufVxuKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCAkc2VjdGlvbiA9ICQoJy5maWd1cmUtdmlld2VyJyk7XG4gICAgY29uc3QgJHdpbmRvdyA9ICQod2luZG93KTtcbiAgICBjb25zdCAkaHRtbCA9ICQoJ2h0bWwnKTtcbiAgICBjb25zdCAkZG9jdW1lbnQgPSAkKGRvY3VtZW50KTtcbiAgICBjb25zdCAkYm9keSA9ICQoJ2JvZHknKTtcbiAgICBsZXQgJGlzSGlnaFJlcyA9IGZhbHNlO1xuICAgIGNvbnN0IGZpZ3VyZVZpZXdlciA9IHtcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICogZmFsc2V8Y2xhc3NDb21iaW5hdGlvbnxjbGFzc05hbWV8ZGF0YVJlbFxuICAgICAgICAgICAgKiAqL1xuICAgICAgICAgICAgZmlsdGVyOiBmYWxzZSxcbiAgICAgICAgICAgIGZpbHRlckNsYXNzOiAnYXJ0aWNsZV9fdGFiRmlndXJlJ1xuICAgICAgICB9LFxuICAgICAgICAkdG9wUmVnSGVpZ2h0OiAkKCcuZmlndXJlLXZpZXdlcl9fcmVnX190b3AnKS5pbm5lckhlaWdodCgpLFxuICAgICAgICB2UG9ydDogXCJzY3JlZW4tbWRcIixcbiAgICAgICAgJGZpZ3VyZXM6IG51bGwsXG4gICAgICAgICRmaWd1cmVzVG9TaG93OiBudWxsLFxuICAgICAgICAkZmlndXJlV2lkdGg6IG51bGwsXG4gICAgICAgICRjdXJyZW50SW5kZXg6IG51bGwsXG4gICAgICAgICRmb2N1c2VkRWxlbWVudEJlZm9yZU9wZW5lZDogbnVsbCxcbiAgICAgICAgJHNlY3Rpb246ICRzZWN0aW9uLFxuICAgICAgICAkaG9sZGVyOiAkc2VjdGlvbi5maW5kKCcuZmlndXJlLXZpZXdlcl9faG9sZF9fZmlnJyksXG4gICAgICAgICRob2xkZXJFbGVtZW50OiAkc2VjdGlvbi5maW5kKCcuZmlndXJlLXZpZXdlcl9faG9sZF9fZmlnJykuZmluZCgnZmlndXJlJyksXG4gICAgICAgICRjYXB0aW9uSG9sZGVyOiAkc2VjdGlvbi5maW5kKCcuZmlndXJlLXZpZXdlcl9faG9sZF9fZmlnY2FwJyksXG4gICAgICAgICRsaXN0ZXI6ICRzZWN0aW9uLmZpbmQoJy5maWd1cmUtdmlld2VyX19ob2xkX19saXN0JyksXG4gICAgICAgICRmaWd1cmVSZWdpb25Db250YWluZXI6ICRzZWN0aW9uLmZpbmQoJy5maWd1cmUtdmlld2VyX19yZWdfX2NlbnRlcicpLFxuICAgICAgICAkY2FwdGlvblJlZ2lvbjogJHNlY3Rpb24uZmluZCgnLmZpZ3VyZS12aWV3ZXJfX2NlbnRfX3JpZ2h0JyksXG4gICAgICAgICRjb250ZW50UmVnaW9uOiAkc2VjdGlvbi5maW5kKCcuZmlndXJlLXZpZXdlcl9fY2VudF9fbGVmdCcpLFxuICAgICAgICAkZmlndXJlTmF2OiAkc2VjdGlvbi5maW5kKCcuZmlndXJlLXZpZXdlcl9fY3RybF9fbmV4dCwgLmZpZ3VyZS12aWV3ZXJfX2N0cmxfX3ByZXYnKSxcbiAgICAgICAgJHpvb21pbmJ0bjogJHNlY3Rpb24uZmluZCgnLnpvb20taW4nKSxcbiAgICAgICAgJHpvb21vdXRidG46ICRzZWN0aW9uLmZpbmQoJy56b29tLW91dCcpLFxuICAgICAgICAkem9vbXJhbmdlOiAkc2VjdGlvbi5maW5kKCcuem9vbS1yYW5nZScpLFxuICAgICAgICAkem9vbXJlc2V0OiAkc2VjdGlvbi5maW5kKCcucmVzZXQnKSxcbiAgICAgICAgJGltYWdlOiAkc2VjdGlvbi5maW5kKCdmaWd1cmUnKSxcbiAgICAgICAgJGJyb3dzZWJ0bjogJCgnLmZpZ3VyZS12aWV3ZXJfX2N0cmxfX2Jyb3dzZScpLFxuICAgICAgICAkcmV0dXJuYnRuOiAkKCcuZmlndXJlLXZpZXdlcl9fY3RybF9fcmV0dXJuJyksXG4gICAgICAgIGlzTW9iaWxlOiBmYWxzZSxcbiAgICAgICAgaXNsb2NrZWQ6IGZhbHNlLFxuICAgICAgICBvZmZzZXRZOiB3aW5kb3cucGFnZVlPZmZzZXQsXG4gICAgICAgICRoaWRlTGlzdDogJCgnLnpvb21TbGlkZXIsIC5maWd1cmUtdmlld2VyX19sYWJlbF9fem9vbScpLFxuICAgICAgICAkYnJvd3NlQ29udGFpbmVyOiAkKCcuZmlndXJlLXZpZXdlcl9faG9sZF9fbGlzdCcpLFxuICAgICAgICBvbkhpZ2hSZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGltcG9ydCgnLi9oaWdoLXJlcy1pbWFnZXMnKS50aGVuKCgpID0+IHtcblxuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5vbkhpZ2hSZXNDYWxsYmFjaygpO1xuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9LFxuICAgICAgICBleHBhbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHByZXNlcnZlIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBwcmV2aW91cyBidWdneSB2ZXJzaW9uIC0gaXQgY2FuIGJlIHJlbW92ZWQgaWYgZmlsdGVyQ29udGV4dHMgd291bGQgYmVjb21lIGRlZmF1bHQgYmVoYXZpb3JcbiAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXMgPSAkZG9jdW1lbnQuZmluZCgnOm5vdCguZmlndXJlLXZpZXdlcl9faG9sZF9fbGlzdCkgPiBmaWd1cmU6bm90KC5ob2xkZXIpLCA6bm90KC5maWd1cmUtdmlld2VyX19ob2xkX19saXN0KSA+IC5maWd1cmU6bm90KC5ob2xkZXIpJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlcyA9ICRkb2N1bWVudC5maW5kKCdmaWd1cmU6bm90KC5ob2xkZXIpLCAuZmlndXJlOm5vdCguaG9sZGVyKScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICR0aGlzLmRhdGEoJ2luZGV4JywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoJ2ZpZ3VyZScpOyAvLyBhZGQgY2xhc3MgdG8gYmUgc3VyZSwgdGhhdCBjb3JyZWN0IGdyaWQgc3R5bGluZyB3aWxsIGJlIHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXIgPT09ICdkYXRhUmVsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92ZSBkYXRhLXJlbCB0byBjb250YWluZXIgZnJvbSBjaGlsZFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGFSZWxFbGVtZW50ID0gJHRoaXMuZmluZCgnW2RhdGEtcmVsXScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFSZWxFbGVtZW50Lmxlbmd0aCA+IDAgJiYgZGF0YVJlbEVsZW1lbnQuZGF0YSgpLnJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmF0dHIoJ2RhdGEtcmVsJywgZGF0YVJlbEVsZW1lbnQuZGF0YSgpLnJlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzO1xuICAgICAgICB9LFxuICAgICAgICAvKlxuICAgICAgICAqIEZpbHRlciBncmlkIHZpZXcgYW5kIG5hdmlnYXRpb24gYmFzZWQgb24gaXRlbSBvcGVuZWQgYW5kIG9wdGlvbiBwcm92aWRlZCBieSBmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXJcbiAgICAgICAgKiAqL1xuICAgICAgICBmaWx0ZXI6IGZ1bmN0aW9uICgkdGhpcykge1xuICAgICAgICAgICAgaWYgKGZpZ3VyZVZpZXdlci5vcHRpb25zLmZpbHRlciA9PT0gJ2NsYXNzQ29tYmluYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNsYXNzTmFtZSA9ICR0aGlzLmF0dHIoJ2NsYXNzJyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzLmZpbHRlcignW2NsYXNzPVwiJyArIGNsYXNzTmFtZSArICdcIl0nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlndXJlVmlld2VyLm9wdGlvbnMuZmlsdGVyID09PSAnY2xhc3NOYW1lJykge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdyA9IGZpZ3VyZVZpZXdlci4kZmlndXJlcy5maWx0ZXIoJy4nICsgZmlndXJlVmlld2VyLm9wdGlvbnMuZmlsdGVyQ2xhc3MpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXIgPT09ICdkYXRhUmVsJykge1xuICAgICAgICAgICAgICAgIGxldCBkYXRhUmVsID0gJHRoaXMuZGF0YSgncmVsJyk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGFSZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzLmZpbHRlcignW2RhdGEtcmVsPVwiJyArIGRhdGFSZWwgKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGN1cnJlbnRJbmRleCA9IGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdy5pbmRleCgkdGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oZmlndXJlVmlld2VyLnZQb3J0ICsgJy1vbicsIGZ1bmN0aW9uICgpIHsgLy8gV2FpdGluZyBmb3IgY3VzdG9tIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgYnkgY29udHJvbGxlci5qcyB0byBhY3RpdmF0ZSByZXNwb25zaXZlIGVmZmVjdHNcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuaXNNb2JpbGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKGZpZ3VyZVZpZXdlci52UG9ydCArICctb2ZmJywgZnVuY3Rpb24gKCkgeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGRlYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmlzTW9iaWxlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmlndXJlVmlld2VyLmNsaWNrSGFuZGxlcigpO1xuXG4gICAgICAgICAgICBsZXQgJGZpZ3VyZVZpZXdlciA9ICRib2R5LmZpbmQoJy5maWd1cmUtdmlld2VyJyksXG4gICAgICAgICAgICAgICAgJGNvbnRyb2xsZXJFbGVtZW50ID0gJGZpZ3VyZVZpZXdlci5maW5kKCdhLCBidXR0b24nKTtcblxuICAgICAgICAgICAgJGNvbnRyb2xsZXJFbGVtZW50LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgJHRoaXMub24oe1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2ZpZ3VyZS12aWV3ZXJfX2N0cmxfX2Nsb3NlJykpIHsgLy8gY2xvc2UgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLm9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2ZpZ3VyZS12aWV3ZXJfX2N0cmxfX25leHQnKSkgeyAvLyBOZXh0IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCR0aGlzLmhhc0NsYXNzKCdmaWd1cmUtdmlld2VyX19jdHJsX19wcmV2JykpIHsgLy8gUHJldiBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIucHJldigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5oYXNDbGFzcygnZmlndXJlLXZpZXdlcl9fY3RybF9fY2FwdGlvbicpKSB7IC8vIG9wZW4gLyBjbG9zZSBjYXB0aW9uIEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5jYXB0aW9uVG9nZ2xlKCR0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2ZpZ3VyZS12aWV3ZXJfX2N0cmxfX2Jyb3dzZScpKSB7IC8vIGJyb3dzZSBhbGwgZmlndXJlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5icm93c2UoJCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCR0aGlzLmhhc0NsYXNzKCdmaWd1cmUtdmlld2VyX19jdHJsX19yZXR1cm4nKSkgeyAvLyBicm93c2UgYWxsIGZpZ3VyZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIucmV0dXJuKCQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gcHJlc2VydmUgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHByZXZpb3VzIGJ1Z2d5IHZlcnNpb24gLSBpdCBjYW4gYmUgcmVtb3ZlZCBpZiBmaWx0ZXJDb250ZXh0cyB3b3VsZCBiZWNvbWUgZGVmYXVsdCBiZWhhdmlvclxuICAgICAgICAgICAgaWYgKGZpZ3VyZVZpZXdlci5vcHRpb25zLmZpbHRlcikge1xuICAgICAgICAgICAgICAgICQoXCIuZmlndXJlIGE6bm90KC5vcGVuLWZpZ3VyZS1saW5rKVwiKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgJGltZyA9ICQodGhpcykuZmluZChcImltZ1wiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZERlZmF1bHQgPSAkKHRoaXMpLmhhc0NsYXNzKCdsaW5rQmVoYXZpb3InKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaG91bGREZWZhdWx0IHx8ICRpbWcubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW1nLnRyaWdnZXIoXCJjbGlja1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJChcIi5maWd1cmUgYTpub3QoLm9wZW4tZmlndXJlLWxpbmspIGltZ1wiKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKFwiLmZpZ3VyZSBhOm5vdCgnLnBwdC1maWd1cmUtbGluaycpXCIpLmNsaWNrKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCAkaW1nID0gJCh0aGlzKS5maW5kKFwiaW1nXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkRGVmYXVsdCA9ICQodGhpcykuaGFzQ2xhc3MoJ2xpbmtCZWhhdmlvcicpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3VsZERlZmF1bHQgfHwgJGltZy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGltZy50cmlnZ2VyKFwiY2xpY2tcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKCdib2R5Jykua2V5ZG93bihmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBpcyBmaWd1cmV2aWV3ZXIgb3Blbj8gbm8/IHRoYW4gd2UgZG9uJ3QgZG8gYW55dGhpbmdcbiAgICAgICAgICAgICAgICBpZiAoJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKSAhPT0gJ2ZpZ3VyZVZpZXdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzNykgeyAvLyBsZWZ0XG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5wcmV2KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAzOSkgeyAvLyByaWdodFxuICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuc3VwcGxlbWVudGFyeS5jb250cm9sKCk7XG5cbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5oaWRlT25DbGlja091dHNpZGUoKTtcblxuICAgICAgICAgICAgZmlndXJlVmlld2VyLnJlc2l6ZSgpO1xuICAgICAgICAgICAgJCh3aW5kb3cpLm9uKCdyZXNpemVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5yZXNpemUoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZmlndXJlVmlld2VyLiRmaWd1cmVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVOYXYuaGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBARklYTUUgdGhpcyBpcyBub3Qgd29ya2luZyBmb2N1cyB0cmFwLi4uIC0gY2Fubm90IHdvcmsgaW4gbW9zdCBjYXNlcyBhbmQgZm9yIHNoaWZ0IHRhYlxuICAgICAgICAgICAgJChcIi5maWd1cmUtdmlld2VyX19jdHJsX19jYXB0aW9uXCIpLmZvY3Vzb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKCcuZmlndXJlLXZpZXdlcl9fY3RybF9fY2xvc2UnKS5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhpZGVPbkNsaWNrT3V0c2lkZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRpbWFnZS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGxldCBpc091dHNpZGVDbGljayA9ICEkKGUudGFyZ2V0KS5jbG9zZXN0KCcuZmlndXJlX19pbWFnZScpLmxlbmd0aCAmJiAhJCgnLmZpZ3VyZV9faW1hZ2UnKS5pcyhlLnRhcmdldCkgJiYgISQoJy5zaG9ydGN1dHNWaWV3SGVscFR4dCcpLmlzKGUudGFyZ2V0KSAmJiAhJChlLnRhcmdldCkuY2xvc2VzdCgnLnNob3J0Y3V0c1ZpZXdIZWxwVHh0JykubGVuZ3RoXG4gICAgICAgICAgICAgICAgaWYgKGlzT3V0c2lkZUNsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5vbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGNsaWNrSGFuZGxlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5maWd1cmVfX2ltYWdlLCAub3Blbi1maWd1cmUtbGluaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgJHNlbGYgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICgkc2VsZi5wYXJlbnQoKS5oYXNDbGFzcygnZmlndXJlLXZpZXdlcl9fdGh1bWJuYWlsLWl0ZW0nKSB8fCAkc2VsZi5pcygnLmZpZ3VyZV9fYXVkaW8nKSB8fCAkc2VsZi5pcygnLmZpZ3VyZV9fdmlkZW8nKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0ICR0aGlzID0gJHNlbGYuY2xvc2VzdCgnZmlndXJlLCAuZmlndXJlLCAuaW1hZ2VUYWJsZScpO1xuICAgICAgICAgICAgICAgIGlmICghJHRoaXMuaGFzQ2xhc3MoJ3VpLWRpc2FibGVkJykgJiYgISR0aGlzLmNsb3Nlc3QoJy5maWd1cmUtdmlld2VyX19ob2xkX19maWcnKS5sZW5ndGgpIHsgLy8gY2hlY2sgaWYgZXhwbGljaXRseSBkaXNhYmxlZCBvciB0aGUgZmlndXJlIGlzIGFscmVhZHkgaW4gdGhlIHZpZXdlciBzbyB0aGUgZXZlbnQgaXMgdXNlbGVzcyBhdCB0aGlzIHN0YXRlLiBJdCBhbHNvIGdldHMgaW4gdGhlIHdheSBvZiBkcmFnIGFuZCBkcm9wIGZ1bmN0aW9uYWxpdHkgaW4gdGhlIGZpZ3VyZSB2aWV3ZXIuXG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5vbi5zaG93KCR0aGlzLCAkdGhpcy5kYXRhKCdpbmRleCcpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWZpZ3VyZVZpZXdlci5pc01vYmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAkKCcuc2hvcnRjdXRzVmlld0hlbHBUeHQnKS5sZW5ndGggP1xuICAgICAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkuZmluZCgnLmZpZ3VyZS12aWV3ZXJfX2NlbnRfX2xlZnQgLnNob3J0Y3V0c1ZpZXdIZWxwVHh0JykucmVtb3ZlKCkgOiBVWC5oaWdoUmVzSW1nLnNob3J0Y3V0c1ZpZXcoJHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjYXB0aW9uVG9nZ2xlOiBmdW5jdGlvbiAoJGVsZW0pIHtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci50b2dnbGUoJGVsZW0uY2xvc2VzdCgnLmZpZ3VyZS12aWV3ZXJfX2NlbnRfX3JpZ2h0JykpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLnRvZ2dsZSgkKCcuZmlndXJlLXZpZXdlcl9fY2VudF9fbGVmdCcpKTtcbiAgICAgICAgICAgICRlbGVtLnRvZ2dsZUNsYXNzKCdqcy1vcGVuJyk7XG4gICAgICAgICAgICBpZiAoZmlndXJlVmlld2VyLiRob2xkZXIuZmluZCgnLmZpZ3VyZV9faGlnaFJlc0ltZ1JlcGxhY2VyJykubGVuZ3RoID09PSAxICYmICRlbGVtLmhhc0NsYXNzKCdqcy1vcGVuJykpIHtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGhvbGRlci5maW5kKCcuZmlndXJlX19oaWdoUmVzSW1nUmVwbGFjZXInKS5jc3Moeyd3aWR0aCc6ICc5NyUnfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyLmZpbmQoJy5maWd1cmVfX2hpZ2hSZXNJbWdSZXBsYWNlcicpLmNzcyh7J3dpZHRoJzogJzEwMCUnfSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGZpZ3VyZVZpZXdlci4kY3VycmVudEluZGV4IDwgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdy5lcShmaWd1cmVWaWV3ZXIuJGN1cnJlbnRJbmRleCArIDEpLmNsb3Nlc3QoJy5maWd1cmUtdmlld2VyJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kY3VycmVudEluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIGxldCAkbmV4dCA9IGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdy5lcShmaWd1cmVWaWV3ZXIuJGN1cnJlbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5yZXBsYWNlKCRuZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgJGlzSGlnaFJlcyAmJiBVWC5oaWdoUmVzSW1nLnNob3J0Y3V0c1ZpZXcoJG5leHQpO1xuICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5yZXNldCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIGxldCAkbmV4dCA9IGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdy5lcShmaWd1cmVWaWV3ZXIuJGN1cnJlbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnJlcGxhY2UoJG5leHQpO1xuICAgICAgICAgICAgICAgICRpc0hpZ2hSZXMgJiYgVVguaGlnaFJlc0ltZy5zaG9ydGN1dHNWaWV3KCRuZXh0KTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5yZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwcmV2OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXggPj0gMSkge1xuICAgICAgICAgICAgICAgIGlmICghZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93LmVxKGZpZ3VyZVZpZXdlci4kY3VycmVudEluZGV4IC0gMSkuY2xvc2VzdCgnLmZpZ3VyZS12aWV3ZXInKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgbGV0ICRwcmV2ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93LmVxKGZpZ3VyZVZpZXdlci4kY3VycmVudEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnJlcGxhY2UoJHByZXYpO1xuICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5yZXNldCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXggPSBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXNUb1Nob3cubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBsZXQgJHByZXYgPSBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXNUb1Nob3cuZXEoZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5yZXBsYWNlKCRwcmV2KTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5yZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlOiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgbGV0ICRmaWd1cmU7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIucGF1c2VPcmlnaW5hbFN0cmVhbShlbGVtZW50KTtcbiAgICAgICAgICAgICRpc0hpZ2hSZXMgPSBlbGVtZW50LmZpbmQoJy5maWd1cmVfX2ltYWdlJykubGVuZ3RoICYmIGVsZW1lbnQuZmluZCgnLmZpZ3VyZV9faGlnaFJlc0ltZ1JlcGxhY2VyJykubGVuZ3RoO1xuICAgICAgICAgICAgJGlzSGlnaFJlcyA/ICRmaWd1cmUgPSBlbGVtZW50LmZpbmQoJy5maWd1cmVfX2hpZ2hSZXNJbWdSZXBsYWNlcicpLmNsb25lKCkgOiAkZmlndXJlID0gZWxlbWVudC5maW5kKCcuZmlndXJlX19pbWFnZScpLmNsb25lKCk7XG5cbiAgICAgICAgICAgICRmaWd1cmUuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAkdGhpcy5hdHRyKCdzcmMnLCAkdGhpcy5hdHRyKCdkYXRhLWxnLXNyYycpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gaGFuZGxlIG11bHRpcGxlIGltYWdlcyBpbiBvbmUgZmlndXJlXG4gICAgICAgICAgICBpZiAoJGZpZ3VyZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIG9uZSB0byBpbWFnZSB2aWV3ZXIgYW5kIGNyZWF0ZSBuYXZpZ2F0aW9uXG4gICAgICAgICAgICAgICAgJGZpZ3VyZSA9IGZpZ3VyZVZpZXdlci5zdXBwbGVtZW50YXJ5LnNob3coZWxlbWVudCwgJGZpZ3VyZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5zdXBwbGVtZW50YXJ5LmhpZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmlndXJlVmlld2VyLnN0cmVhbVJlc2V0KGZpZ3VyZVZpZXdlci4kaG9sZGVyLCBlbGVtZW50KTtcbiAgICAgICAgICAgIGlmICgkaXNIaWdoUmVzKSB7XG5cbiAgICAgICAgICAgICAgICBVWC5oaWdoUmVzSW1nLnNob3coZmlndXJlVmlld2VyLiRob2xkZXIsIGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyLmZpbmQoJy5maWd1cmVfX2hpZ2hSZXNJbWdSZXBsYWNlcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlV2lkdGggPSBmaWd1cmVWaWV3ZXIuJGhvbGRlci5maW5kKCcuZmlndXJlX19oaWdoUmVzSW1nUmVwbGFjZXInKS53aWR0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRob2xkZXIuZmluZCgnLmZpZ3VyZV9faW1hZ2UnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyLmZpbmQoJ2ZpZ3VyZScpLmFwcGVuZCgkZmlndXJlLmdldCgwKS5vdXRlckhUTUwpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjYXB0aW9uSG9sZGVyLmVtcHR5KCk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuc2hvd0NhcHRpb25UaXRsZShlbGVtZW50KTtcbiAgICAgICAgICAgIGNvbnN0ICRjYXB0aW9uID0gZmlndXJlVmlld2VyLmFkZGl0aW9uYWxCZWhhdmlvck9uU2hvdyhlbGVtZW50KTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5zaG93Q2FwdGlvbigkY2FwdGlvbik7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIucmVtb3ZlRmlndXJlVGl0bGUoKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlV2lkdGggPSBmaWd1cmVWaWV3ZXIuJGhvbGRlci5maW5kKCcuZmlndXJlX19pbWFnZScpLndpZHRoKCk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5jaGVjaygpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLmhlYWRlck9wdGlvbnMoZWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN1cHBsZW1lbnRhcnk6IHtcbiAgICAgICAgICAgIG5hdjogbnVsbCxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICAgICAgICAgKiBAcGFyYW0gJGZpZ3VyZVxuICAgICAgICAgICAgICogQHB1YmxpY1xuICAgICAgICAgICAgICogQHJldHVybnMge2pRdWVyeX0gY3VycmVudCBpbWFnZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzaG93OiBmdW5jdGlvbiAoZWxlbWVudCwgJGZpZ3VyZSkge1xuICAgICAgICAgICAgICAgIC8vIGdldCBjdXJyZW50IGluZGV4XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jaGVjayhlbGVtZW50KSxcbiAgICAgICAgICAgICAgICAgICAgJHRodW1ibmFpbHMgPSAkZmlndXJlLmNsb25lKCksXG4gICAgICAgICAgICAgICAgICAgIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIHN1cHBsZW1lbnRhcnkgbmF2aWdhdGlvblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5uYXYpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXYgPSAkKCc8dWwgY2xhc3M9XCJmaWd1cmUtdmlld2VyX19ob2xkX19zdXBwbGVtZW50YXJ5LW5hdlwiPjwvdWw+Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2LmFwcGVuZFRvKGZpZ3VyZVZpZXdlci4kc2VjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuYXZpZ2F0aW9uIGl0ZW1zXG4gICAgICAgICAgICAgICAgdGhpcy5uYXYuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICAkdGh1bWJuYWlscy5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgJHRodW1iID0gJCgnPGxpPjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJHbyB0byBmaWd1cmUgaW1hZ2UgJyArIChpbmRleCArIDEpICsgJy4gb2YgY3VycmVudCBmaWd1cmUuXCIgY2xhc3M9XCJmaWd1cmUtdmlld2VyX190aHVtYm5haWwtaXRlbVwiPjwvYT48L2xpPicpO1xuICAgICAgICAgICAgICAgICAgICAkdGh1bWIuZmluZCgnYScpLmFwcGVuZCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgJHRodW1iLmZpbmQoJ2EnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRvSW5kZXgoZWxlbWVudCwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRvIG5hdlxuICAgICAgICAgICAgICAgICAgICBzZWxmLm5hdi5hcHBlbmQoJHRodW1iKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBzZXQgaW5pdGlhbCBhY3RpdmUgY2xhc3NcbiAgICAgICAgICAgICAgICB0aGlzLm5hdi5maW5kKCdsaScpLmVxKGluZGV4KS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gY3VycmVudCBpbnRvIHZpZXdcbiAgICAgICAgICAgICAgICByZXR1cm4gJGZpZ3VyZS5lcShpbmRleCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHB1YmxpY1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBoaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmF2KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2LmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNhdmU6IGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YSgnZmlndXJlLXZpZXdlci1kaXNwbGF5JywgaW5kZXgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmRhdGEoJ2ZpZ3VyZS12aWV3ZXItZGlzcGxheScpIHx8IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9JbmRleDogZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgbGV0ICRpbWFnZXMgPSBlbGVtZW50LmZpbmQoJy5maWd1cmVfX2ltYWdlJyk7XG4gICAgICAgICAgICAgICAgaWYgKCRpbWFnZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRvbid0IGRvIGFueXRoaW5nIGZvciBvbmUgaW1hZ2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBsb29wIG9uIGVkZ2VzXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49ICRpbWFnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9ICRpbWFnZXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gYXBwZW5kIGluZGV4IGltYWdlXG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRob2xkZXIuZmluZCgnLmZpZ3VyZV9faW1hZ2UnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCAkaW1hZ2UgPSAkaW1hZ2VzLmVxKGluZGV4KS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgY29ycmVjdCBzaXplIG9mIHRoZSBpbWFnZSBpZiBpdCdzIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgIGlmICgkaW1hZ2UuZGF0YSgnbGctc3JjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgJGltYWdlLmF0dHIoJ3NyYycsICRpbWFnZS5kYXRhKCdsZy1zcmMnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyRWxlbWVudC5hcHBlbmQoJGltYWdlKTtcbiAgICAgICAgICAgICAgICAvLyB0b2dnbGUgYWN0aXZlIGNsYXNzXG4gICAgICAgICAgICAgICAgdGhpcy5uYXYuZmluZCgnbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXYuZmluZCgnbGknKS5lcShpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIC8vIHNhdmUgc3RhdGVcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmUoZWxlbWVudCwgaW5kZXgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jaGVjayhlbGVtZW50KSArIDE7XG4gICAgICAgICAgICAgICAgdGhpcy50b0luZGV4KGVsZW1lbnQsIGluZGV4KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcmV2OiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuY2hlY2soZWxlbWVudCkgLSAxO1xuICAgICAgICAgICAgICAgIHRoaXMudG9JbmRleChlbGVtZW50LCBpbmRleCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHB1YmxpY1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb250cm9sOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJCgnYm9keScpLm9uKCdrZXlkb3duIGtleXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlzIGZpZ3VyZXZpZXdlciBvcGVuPyBubz8gdGhhbiB3ZSBkb24ndCBkbyBhbnl0aGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKSAhPT0gJ2ZpZ3VyZVZpZXdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBpcyB0aGVyZSBhbnkgZmlndXJlIHRvIHNob3c/XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIuJGZpZ3VyZXNUb1Nob3cgJiYgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93Lmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGxldCBlbGVtZW50ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93LmVxKGZpZ3VyZVZpZXdlci4kY3VycmVudEluZGV4KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzgpIHsgLy8gdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5zdXBwbGVtZW50YXJ5LnByZXYoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gNDApIHsgLy8gZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnN1cHBsZW1lbnRhcnkubmV4dChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBicm93c2U6IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGhvbGRlci5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGZpZ3VyZU5hdi5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGJyb3dzZWJ0bi5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJHJldHVybmJ0bi5yZW1vdmVDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGNhcHRpb25SZWdpb24ucmVtb3ZlQ2xhc3MoJ2pzLW9wZW4nKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kY29udGVudFJlZ2lvbi5yZW1vdmVDbGFzcygnanMtb3BlbicpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVSZWdpb25Db250YWluZXIuYWRkQ2xhc3MoJ3Njcm9sbGFibGUnKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kY2FwdGlvblJlZ2lvbi5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGhpZGVMaXN0LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGxpc3Rlci5yZW1vdmVDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuc3VwcGxlbWVudGFyeS5oaWRlKCk7XG5cbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kYnJvd3NlQ29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgICAvLyBwcmVzZXJ2ZSBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggcHJldmlvdXMgYnVnZ3kgdmVyc2lvbiAtIGl0IGNhbiBiZSByZW1vdmVkIGlmIGZpbHRlciB3b3VsZCBiZWNvbWUgZGVmYXVsdCBiZWhhdmlvclxuICAgICAgICAgICAgaWYgKGZpZ3VyZVZpZXdlci5vcHRpb25zLmZpbHRlcikge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0ICRmaWcgPSAkKHRoaXMpLmNsb25lKHRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgJGZpZ3VyZUV4dHJhID0gJGZpZy5maW5kKFwiLmZpZ3VyZS1leHRyYVwiKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJGZpZ3VyZUV4dHJhLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGZpZ3VyZUV4dHJhLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kYnJvd3NlQ29udGFpbmVyLmFwcGVuZCgkZmlnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYXJ0aWNsZV9faW5saW5lRmlndXJlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCAkZmlnID0gJCh0aGlzKS5jbG9uZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICRmaWdJbWFnZSA9ICRmaWcuY2hpbGRyZW4oJ2ltZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGZpZ0ltYWdlLmF0dHIoJ3NyYycsICRmaWdJbWFnZS5kYXRhKCdzcmMnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCAkZmlndXJlTGlua3MgPSAkZmlnLmZpbmQoXCIuZmlndXJlLWxpbmtzXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGZpZ3VyZUxpbmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmaWd1cmVMaW5rcy5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kYnJvd3NlQ29udGFpbmVyLmFwcGVuZCgkZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmlndXJlVmlld2VyLmFkZGl0aW9uYWxCcm93c2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkaXRpb25hbEJyb3dzZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB9LFxuICAgICAgICByZXR1cm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlTmF2LnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kYnJvd3NlYnRuLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kcmV0dXJuYnRuLmFkZENsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIC8vZmlndXJlVmlld2VyLiRjb250ZW50UmVnaW9uLmFkZENsYXNzKCdqcy1vcGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGNhcHRpb25SZWdpb24ucmVtb3ZlQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRoaWRlTGlzdC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRsaXN0ZXIuYWRkQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgY29uc3QgJGZpZ3VyZVZpZXdUZXh0ID0gJCgnLmZpZ3VyZS12aWV3ZXJfX3RpdGxlX190ZXh0Jyk7XG4gICAgICAgICAgICAkZmlndXJlVmlld1RleHQucmVtb3ZlQ2xhc3MoJ2ZpZ3VyZS12aWV3ZXJfX3RpdGxlX190ZXh0X19hbGxmaWd1cmVzJyk7XG4gICAgICAgICAgICAkZmlndXJlVmlld1RleHQucGFyZW50KCcuZmlndXJlLXZpZXdlcl9fY3RybCcpLnJlbW92ZUNsYXNzKCdhbGxmaWd1cmVzX19pc19fZGlzcGxheWVkJyk7XG4gICAgICAgICAgICAkKCcuZmlndXJlLXZpZXdlcl9fY3RybF9fY2FwdGlvbicpLnBhcmVudChcIi5maWd1cmUtdmlld2VyX19jdHJsXCIpLnNob3coKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kYnJvd3NlQ29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuYWRkaXRpb25hbFJldHVybigpO1xuICAgICAgICB9LFxuICAgICAgICBhZGRpdGlvbmFsUmV0dXJuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH0sXG4gICAgICAgIGhlaWdodDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGxldCAkd2luZG93c0hlaWdodCA9ICQod2luZG93KS5pbm5lckhlaWdodCgpO1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiR0b3BSZWdIZWlnaHQgPSAkKCcuZmlndXJlLXZpZXdlcl9fcmVnX190b3AnKS5pbm5lckhlaWdodCgpO1xuICAgICAgICAgICAgbGV0ICRoZWlnaHQgPSAkd2luZG93c0hlaWdodCAtIGZpZ3VyZVZpZXdlci4kdG9wUmVnSGVpZ2h0IC0gJCgnLmZpZ3VyZS12aWV3ZXJfX2NhcHRpb25fX2xhYmVsJykuaW5uZXJIZWlnaHQoKTtcbiAgICAgICAgICAgICQoJy5maWd1cmUtdmlld2VyX19jZW50X19sZWZ0JykuZmluZCgnZmlndXJlJykuaGVpZ2h0KCRoZWlnaHQpO1xuICAgICAgICB9LFxuICAgICAgICB0b2dnbGU6IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50LnRvZ2dsZUNsYXNzKCdqcy1vcGVuJyk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuZmlnY2FwdGlvblNpemUoKTsgLy9MSVQtMTYxODE4XG4gICAgICAgIH0sXG4gICAgICAgIGRpc3BsYXlWaWV3ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJy5maWd1cmUtdmlld2VyJykuc2hvdygpO1xuICAgICAgICB9LFxuICAgICAgICBhZGRpdGlvbmFsU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIH0sXG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgICBzaG93OiBmdW5jdGlvbiAoJHRoaXMsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmlzTW9iaWxlICYmICRodG1sLmFkZENsYXNzKCdsb2NrLXNjcmVlbicpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5oZWFkZXJPcHRpb25zKCR0aGlzKTtcblxuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5vZmZzZXRZID0gJGJvZHkuZGF0YSgneW9mZnNldCcpIHx8IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgICAgICAgICAgICAkYm9keS5kYXRhKCd5b2Zmc2V0JywgZmlndXJlVmlld2VyLm9mZnNldFkpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKFVYLmNvbnRyb2xsZXIpICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKSAhPT0gJ3NsaWRlJykgeyAvLyBrZWVwIGRyb3AgYmxvY2sgb3BlbiBpbiBwdWJsaWNhdGlvbiBjb250ZW50IHdpZGdldFxuICAgICAgICAgICAgICAgICAgICAgICAgVVguY29udHJvbGxlci5jaGVjaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRib2R5LmF0dHIoJ2RhdGEtYWN0aXZlJywgJ2ZpZ3VyZVZpZXdlcicpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5pc2xvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjdXJyZW50SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIucmVwbGFjZSgkdGhpcyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmb2N1c2VkRWxlbWVudEJlZm9yZU9wZW5lZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmRpc3BsYXlWaWV3ZXIoKTtcbiAgICAgICAgICAgICAgICAkYm9keS5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpOyAvLyBMSVQtMTUyNzA3XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmhlaWdodCgpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci56b29tLmNoZWNrKCk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnJlc2l6ZSgpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaG9sZGVyLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGJyb3dzZWJ0bi5yZW1vdmVDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRyZXR1cm5idG4uYWRkQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlTmF2LnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGhpZGVMaXN0LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGxpc3Rlci5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVSZWdpb25Db250YWluZXIucmVtb3ZlQ2xhc3MoJ3Njcm9sbGFibGUnKTtcbiAgICAgICAgICAgICAgICAkKCcuZmlndXJlLXZpZXdlcl9fY3RybF9fY2xvc2UnKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIub3B0aW9ucy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmZpbHRlcigkdGhpcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnNldEZpZ3VlcnNUb1Nob3coJHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuYWRkaXRpb25hbFNob3coKTtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuc3RyZWFtUmVzZXQoZmlndXJlVmlld2VyLiRob2xkZXIsICR0aGlzLmNsb3Nlc3QoJ2ZpZ3VyZScpKTtcbiAgICAgICAgICAgICAgICAgJGlzSGlnaFJlcyAmJiBVWC5oaWdoUmVzSW1nLnNob3coZmlndXJlVmlld2VyLiRob2xkZXIsICR0aGlzLmNsb3Nlc3QoJ2ZpZ3VyZScpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLmlzTW9iaWxlICYmICRodG1sLmhhc0NsYXNzKCdsb2NrLXNjcmVlbicpICYmICRodG1sLnJlbW92ZUNsYXNzKCdsb2NrLXNjcmVlbicpO1xuICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIuaXNsb2NrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJGJvZHkucmVtb3ZlQXR0cignZGF0YS1hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkYm9keS5yZW1vdmVDbGFzcygnbG9jay1zY3JlZW4nKS5yZW1vdmVBdHRyKCdkYXRhLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICQoJy5maWd1cmUtdmlld2VyJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5wYXVzZUNsb25lZFN0cmVhbShmaWd1cmVWaWV3ZXIuJGhvbGRlcik7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmb2N1c2VkRWxlbWVudEJlZm9yZU9wZW5lZC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICRib2R5LmNzcygnb3ZlcmZsb3cnLCAnJyk7Ly8gTElULTE1MjcwN1xuICAgICAgICAgICAgICAgICQod2luZG93KS5zY3JvbGxUb3AoZmlndXJlVmlld2VyLm9mZnNldFkpO1xuICAgICAgICAgICAgICAgICRib2R5LnJlbW92ZURhdGEoJ3lvZmZzZXQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2V0RmlndWVyc1RvU2hvdygkdGhpcykge1xuICAgICAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdhcnRpY2xlX190YWJGaWd1cmUnKSkge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kZmlndXJlc1RvU2hvdyA9IGZpZ3VyZVZpZXdlci4kZmlndXJlcy5maWx0ZXIoJy5hcnRpY2xlX190YWJGaWd1cmUnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2FydGljbGVfX2lubGluZUZpZ3VyZScpKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVzVG9TaG93ID0gZmlndXJlVmlld2VyLiRmaWd1cmVzLmZpbHRlcignLmFydGljbGVfX2lubGluZUZpZ3VyZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXNUb1Nob3cgPSBmaWd1cmVWaWV3ZXIuJGZpZ3VyZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFkZGl0aW9uYWxCZWhhdmlvck9uU2hvdzogZnVuY3Rpb24gKCRlbCkge1xuICAgICAgICAgICAgcmV0dXJuICRlbC5maW5kKCdmaWdjYXB0aW9uLCAuZmlnY2FwdGlvbicpLmNsb25lKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHpvb206IHtcbiAgICAgICAgICAgIC8qaW5pdDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICBsZXQgZmlndXJlVmlld2VyLiRzZWN0aW9uID0gJCgnLmZpZ3VyZS12aWV3ZXInKTtcbiAgICAgICAgICAgICB9LCovXG4gICAgICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRlbGVtID0gJCgnLmZpZ3VyZS12aWV3ZXInKS5maW5kKCdmaWd1cmUnKTtcbiAgICAgICAgICAgICAgICAkZWxlbS5wYW56b29tKCdyZXNldCcpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLnpvb20ucGFuem9vbS5pbml0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCR3aW5kb3cud2lkdGgoKSA8IDk5Mikge1xuICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuem9vbS5zd2FwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBhbnpvb206IHsgLy8gem9vbSBpbiBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mICgkLmZuLnBhbnpvb20pICE9ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWd1cmVWaWV3ZXIuJGltYWdlLnBhbnpvb20oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR6b29tSW46IGZpZ3VyZVZpZXdlci4kem9vbWluYnRuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR6b29tT3V0OiBmaWd1cmVWaWV3ZXIuJHpvb21vdXRidG4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHpvb21SYW5nZTogZmlndXJlVmlld2VyLiR6b29tcmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlc2V0OiBmaWd1cmVWaWV3ZXIuJHpvb21yZXNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5Pbmx5V2hlblpvb21lZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5TY2FsZTogMVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaW1hZ2Uub24oJ3Bhbnpvb21jaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWd1cmVWaWV3ZXIuJHpvb21yYW5nZS52YWwoKSA9PT0gJzEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kaW1hZ2UuY3NzKCd0cmFuc2Zvcm0nLCAnbWF0cml4KDEsIDAsIDAsIDEsIDAsIDApJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3pvb21lZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ3pvb21lZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN3YXA6IGZ1bmN0aW9uICgpIHsgLy8gc3dhcCBmdW5jdGlvbmFsaXR5IGZvciBtb2JpbGUgZGV2aWNlc1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kc2VjdGlvbi5maW5kKCdpbWcnKS5zd2lwZSh7XG4gICAgICAgICAgICAgICAgICAgIC8vR2VuZXJpYyBzd2lwZSBoYW5kbGVyIGZvciBhbGwgZGlyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24sIGRpc3RhbmNlLCBkdXJhdGlvbiwgZmluZ2VyQ291bnQsIGZpbmdlckRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyAmJiAhZmlndXJlVmlld2VyLiRzZWN0aW9uLmZpbmQoJ2ZpZ3VyZScpLmhhc0NsYXNzKCd6b29tZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyAmJiAhZmlndXJlVmlld2VyLiRzZWN0aW9uLmZpbmQoJ2ZpZ3VyZScpLmhhc0NsYXNzKCd6b29tZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5wcmV2KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2xpZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCAkdGFyZ2V0ID0gJGJvZHkuZmluZCgnZGl2LnV4My1pbi1zbGlkZScpO1xuICAgICAgICAgICAgJGJvZHkucmVtb3ZlQXR0cignZGF0YS11eDMtc2hvdycpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHRhcmdldC5hcHBlbmQoJHNsaWRlLmNoaWxkcmVuKCdkaXYnKSk7XG4gICAgICAgICAgICAgICAgJHRhcmdldC5yZW1vdmVDbGFzcygndXgzLWluLXNsaWRlJyk7XG4gICAgICAgICAgICB9LCAyNTApO1xuICAgICAgICB9LFxuICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCB3SGVpZ2h0ID0gJHdpbmRvdy5pbm5lckhlaWdodCgpO1xuICAgICAgICAgICAgY29uc3QgdG9wSGVpZ2h0ID0gZmlndXJlVmlld2VyLiR0b3BSZWdIZWlnaHQgfHwgNTY7XG4gICAgICAgICAgICBpZiAoZmlndXJlVmlld2VyLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVSZWdpb25Db250YWluZXIuY3NzKCdoZWlnaHQnLCB3SGVpZ2h0IC0gdG9wSGVpZ2h0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRmaWd1cmVSZWdpb25Db250YWluZXIuY3NzKCdoZWlnaHQnLCBgY2FsYygxMDB2aCAtICR7dG9wSGVpZ2h0fXB4KWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmaWdjYXB0aW9uU2l6ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0ICRmaWdjYXB0aW9uID0gJCgnLmZpZ3VyZS12aWV3ZXJfX2hvbGRfX2ZpZ2NhcCcpLmZpbmQoJ2ZpZ2NhcHRpb24nKSxcbiAgICAgICAgICAgICAgICBmaWd1cmVfYXJlYV9oZWlnaHQgPSBmaWd1cmVWaWV3ZXIuJGZpZ3VyZVJlZ2lvbkNvbnRhaW5lci5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBmaWd1cmVfdGl0bGVfaGVpZ2h0ID0gJCgnLmZpZ3VyZS12aWV3ZXJfX3RpdGxlJykuaGVpZ2h0KCkgKyAzMCxcbiAgICAgICAgICAgICAgICBwYWRkaW5nID0gMzA7XG5cbiAgICAgICAgICAgICRmaWdjYXB0aW9uLmNzcygnbWF4LWhlaWdodCcsIGZpZ3VyZV9hcmVhX2hlaWdodCAtIDIgKiBwYWRkaW5nIC0gZmlndXJlX3RpdGxlX2hlaWdodCk7XG4gICAgICAgIH0sXG4gICAgICAgIGRvdWJsZVRhcDogZnVuY3Rpb24gKCkgeyAvLyBkaXNhYmxlIGRvdWJsZSB0YXAgem9vbWluZyBmdW5jdGlvbmFsaXR5IG9uIG1vYmlsZSBkZXZpY2VzXG4gICAgICAgICAgICAoZnVuY3Rpb24gKCQpIHtcbiAgICAgICAgICAgICAgICAkLmZuLm5vZG91YmxldGFwem9vbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5iaW5kKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gcHJldmVudFpvb20oZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHQyID0gZS50aW1lU3RhbXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdDEgPSAkKHRoaXMpLmRhdGEoJ2xhc3RUb3VjaCcpIHx8IHQyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR0ID0gdDIgLSB0MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5nZXJzID0gZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCdsYXN0VG91Y2gnLCB0Mik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWR0IHx8IGR0ID4gNTAwIHx8IGZpbmdlcnMgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBub3QgZG91YmxlLXRhcFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBkb3VibGUgdGFwIC0gcHJldmVudCB0aGUgem9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxzbyBzeW50aGVzaXplIGNsaWNrIGV2ZW50cyB3ZSBqdXN0IHN3YWxsb3dlZCB1cFxuICAgICAgICAgICAgICAgICAgICAgICAgJChlLnRhcmdldCkudHJpZ2dlcignY2xpY2snKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pKGpRdWVyeSk7XG4gICAgICAgIH0sXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5leHBhbmQoKTtcbiAgICAgICAgICAgIGZpZ3VyZVZpZXdlci5jb250cm9sKCk7XG4gICAgICAgICAgICBmaWd1cmVWaWV3ZXIuZG91YmxlVGFwKCk7XG4gICAgICAgICAgICAkKCdib2R5Jykubm9kb3VibGV0YXB6b29tKCk7XG4gICAgICAgICAgICAkKCcuZmlndXJlX19oaWdoUmVzSW1nUmVwbGFjZXInKS5sZW5ndGggJiYgZmlndXJlVmlld2VyLm9uSGlnaFJlcygpO1xuICAgICAgICB9LFxuICAgICAgICBzaG93Q2FwdGlvbjogZnVuY3Rpb24gKCRjYXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAoJGNhcHRpb24ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjYXB0aW9uSG9sZGVyLmFwcGVuZCgkY2FwdGlvbik7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjYXB0aW9uSG9sZGVyLmZpbmQoJ2ZpZ2NhcHRpb24nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjYXB0aW9uUmVnaW9uLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAvLyBoZXJlIHdlIGNoZWNrIGlmIHRoZSBjYXB0aW9uIHJlZ2lvbiBoYXMgdGhlIGpzLW9wZW4gb3Igbm90IHRvIHRvZ2dsZSB0aGUgJGNvbnRlbnRSZWdpb24gYWdhaW5cbiAgICAgICAgICAgICAgICAvLyB0aGlzIGJlaGF2aW9yIG9ubHkgaGFwcGVuIHdoZW4geW91IHRvZ2dsZSB0aGUgY2FwdGlvbiBob2xkZXIgdGhlbiB5b3UgY2xpY2sgb24gYSBmaWd1cmUgdGhhdCBkb2VzIG5vdFxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBjYXB0aW9uIHRoZW4gYWdhaW4gbW92ZSB0byBhIGZpZ3VyZSB3aXRoIGNhcHRpb25cbiAgICAgICAgICAgICAgICBpZiAoZmlndXJlVmlld2VyLiRjYXB0aW9uUmVnaW9uLmhhc0NsYXNzKCdqcy1vcGVuJykpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjb250ZW50UmVnaW9uLmFkZENsYXNzKCdqcy1vcGVuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICghZmlndXJlVmlld2VyLiRjYXB0aW9uSG9sZGVyLmhhc0NsYXNzKCdpcy1oaWRkZW4nKSkge1xuICAgICAgICAgICAgICAgIGZpZ3VyZVZpZXdlci4kY2FwdGlvblJlZ2lvbi5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjb250ZW50UmVnaW9uLnJlbW92ZUNsYXNzKCdqcy1vcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNob3dDYXB0aW9uVGl0bGU6IGZ1bmN0aW9uICgkZWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgJGNhcHRpb24gPSAkZWxlbWVudC5maW5kKCcuZmlndXJlX190aXRsZSwgLmNhcHRpb25MYWJlbCcpLmNsb25lKCk7XG4gICAgICAgICAgICAkKCcuZmlndXJlLXZpZXdlcl9fdGl0bGVfX3RleHQnKS50ZXh0KCRjYXB0aW9uLnRleHQoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlck9wdGlvbnM6IGZ1bmN0aW9uICgkdGhpcykge1xuICAgICAgICAgICAgbGV0ICRmaWd1cmVFeHRyYSA9ICR0aGlzLmZpbmQoJy5maWd1cmUtZXh0cmEnKSxcbiAgICAgICAgICAgICAgICBmaWd1cmVFeHRyYUNvbnRlbnQgPSAkZmlndXJlRXh0cmEuY2xvbmUoKTtcblxuICAgICAgICAgICAgJGJvZHkuZmluZCgnLmZpZ3VyZUV4dHJhJykubGVuZ3RoID8gJGJvZHkuZmluZCgnLmZpZ3VyZUV4dHJhJykucmVtb3ZlKCkgOiAnJztcblxuICAgICAgICAgICAgaWYgKCR0aGlzLmZpbmQoJy5maWd1cmVfX2ltYWdlJykuaXMoJy5maWd1cmVfX2F1ZGlvJykgfHwgJHRoaXMuZmluZCgnLmZpZ3VyZV9faW1hZ2UnKS5pcygnLmZpZ3VyZV9fdmlkZW8nKSkge1xuICAgICAgICAgICAgICAgICRib2R5LmZpbmQoJy5maWd1cmUtdmlld2VyX190b3BfX2xlZnQnKS5hZGRDbGFzcygnaGlkZGVuJykuYWZ0ZXIoJzxkaXYgY2xhc3M9XCJmaWd1cmUtdmlld2VyX190b3BfX2xlZnQgZmlndXJlRXh0cmFcIj4nKTtcbiAgICAgICAgICAgICAgICAkYm9keS5maW5kKCcuZmlndXJlRXh0cmEnKS5hcHBlbmQoZmlndXJlRXh0cmFDb250ZW50KTtcbiAgICAgICAgICAgICAgICBmaWd1cmVFeHRyYUNvbnRlbnQuYXBwZW5kVG8oJGJvZHkuZmluZCgnLmZpZ3VyZUV4dHJhJykpO1xuICAgICAgICAgICAgICAgICRib2R5LmZpbmQoJy5maWd1cmVFeHRyYScpLmZpbmQoJy5vcGVuLWZpZ3VyZS1saW5rJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRib2R5LmZpbmQoJy5maWd1cmUtdmlld2VyX190b3BfX2xlZnQnKS5oYXNDbGFzcygnaGlkZGVuJykpIHtcbiAgICAgICAgICAgICAgICAkYm9keS5maW5kKCcuZmlndXJlLXZpZXdlcl9fdG9wX19sZWZ0JykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzdHJlYW1SZXNldDogZnVuY3Rpb24gKCRob2xkZXIsICRvcmlnaW5hbEZpZ3VyZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRob2xkZXIuZmluZCgnc3RyZWFtJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICRob2xkZXIuZmluZCgnc3RyZWFtJykuaHRtbCgnJyk7XG4gICAgICAgICAgICAgICAgICAgICQuZ2V0U2NyaXB0KFVYLmxvYWRlci5jbG91ZEZsYXJlU2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgJGhvbGRlci5maW5kKCdzdHJlYW0nKS5nZXQoMCkuY3VycmVudFRpbWUgPSAkb3JpZ2luYWxGaWd1cmUuZmluZCgnc3RyZWFtJykuZ2V0KDApLmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJGhvbGRlci5maW5kKCdhdWRpbycpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAkaG9sZGVyLmZpbmQoJ2F1ZGlvJykuZ2V0KDApLmN1cnJlbnRUaW1lID0gJG9yaWdpbmFsRmlndXJlLmZpbmQoJ2F1ZGlvJykuZ2V0KDApLmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlT3JpZ2luYWxTdHJlYW06IGZ1bmN0aW9uICgkZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKCRlbGVtZW50LmZpbmQoJ3N0cmVhbSwgYXVkaW8nKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5maW5kKCdzdHJlYW0sIGF1ZGlvJykuZ2V0KDApLnBhdXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlQ2xvbmVkU3RyZWFtOiBmdW5jdGlvbiAoJGhvbGRlcikge1xuICAgICAgICAgICAgaWYgKCRob2xkZXIuZmluZCgnc3RyZWFtLCBhdWRpbycpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRob2xkZXIuZmluZCgnc3RyZWFtLCBhdWRpbycpLmdldCgwKS5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZW1vdmVGaWd1cmVUaXRsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZmlndXJlVmlld2VyLiRjYXB0aW9uSG9sZGVyLmZpbmQoJy5maWd1cmVfX3RpdGxlJykucmVtb3ZlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uSGlnaFJlc0NhbGxiYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVguZmlndXJlVmlld2VyID0gZmlndXJlVmlld2VyOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGJvZHkgICA9ICQoJ2JvZHknKSxcbiAgICAgICAgJHdpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgdGFiS2V5ICA9IDksXG4gICAgICAgIHNoaWZ0ICAgPSAxNjtcblxuICAgIHZhciBtb2RhbCA9IHtcbiAgICAgICAgJHRvZ2dsZTogJCgnW2RhdGEtdG9nZ2xlPVwibW9kYWxcIl0nKSxcbiAgICAgICAgJHRhcmdldDogbnVsbCxcbiAgICAgICAgcmV2ZXJzOiBmYWxzZSxcbiAgICAgICAgbGFzdEl0ZW06IG51bGwsXG4gICAgICAgIGl0ZW1zOiBudWxsLFxuICAgICAgICAkY2xvc2U6IG51bGwsXG4gICAgICAgIGFjY2Vzc2liaWxpdHlFbmFibGVkOiB0cnVlLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjY2Vzc2liaWxpdHlFbmFibGVkKVxuICAgICAgICAgICAgICAgIG1vZGFsLmFjY2Vzc2liaWxpdHkuaW5pdCgpO1xuICAgICAgICAgICAgbW9kYWwuJHRhcmdldCA9ICQobW9kYWwuJHRvZ2dsZS5kYXRhKCd0YXJnZXQnKSk7XG4gICAgICAgICAgICBtb2RhbC5jb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc2liaWxpdHk6IHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBNb3ZlIGV2ZXJ5IG1vZGFsIG91dHNpZGUgb2YgY29udGVudCBpbiBvcmRlciB0byBiZSBhYmxlIGhpZGUgYW5kIHNob3cgcGFnZSBjb250ZW50IGZvciBzY3JlZW4gcmVhZGVyc1xuICAgICAgICAgICAgICAgIC8vIEBub3RlOiBmb3Igc29tZSByZWFzb24sIGl0IGlzIG5vdCB3b3JraW5nIHdpdGggdGFiIHRyYXAgY29ycmVjdGx5LCB3aGVuIHdlIGFwcGVuZCBpdCB0byBib2R5IC0gYWZ0ZXIoLmNvbnRlbnQpIHdvcmtzIGZpbmVcbiAgICAgICAgICAgICAgICB2YXIgJGNvbnRlbnQgPSAkKCdtYWluLmNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICBpZiAoJGNvbnRlbnQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICRjb250ZW50LmFmdGVyKCQoJy51eC1tb2RhbC1jb250YWluZXInKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRleHQgZm9yIGNsb3NlIGJ1dHRvbnNcbiAgICAgICAgICAgICAgICAkKCdbZGF0YS1kaXNtaXNzPVwibW9kYWxcIl0nKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwic3Itb25seVwiPkNsb3NlIG1vZGFsPC9zcGFuPicpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKCcuY29udGVudCwgLmZvb3RlciwgLmhlYWRlcicpLmF0dHIoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoJy5jb250ZW50LCAuZm9vdGVyLCAuaGVhZGVyJykucmVtb3ZlQXR0cignYXJpYS1oaWRkZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJ1tkYXRhLXRvZ2dsZT1cIm1vZGFsXCJdJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgbW9kYWwuJHRvZ2dsZSA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgbW9kYWwuJHRhcmdldCA9ICQobW9kYWwuJHRvZ2dsZS5kYXRhKCd0YXJnZXQnKSk7XG4gICAgICAgICAgICAgICAgbW9kYWwuJGNsb3NlICA9IG1vZGFsLiR0YXJnZXQuZmluZCgnLmNsb3NlJyk7XG4gICAgICAgICAgICAgICAgbW9kYWwuaXRlbXMgICA9IG1vZGFsLiR0YXJnZXQuZmluZCgnYSwgYnV0dG9uLCBpbnB1dCcpO1xuICAgICAgICAgICAgICAgIG1vZGFsLml0ZW1zLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gbW9kYWwuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwubGFzdEl0ZW0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbW9kYWwub24uc2hvdygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcubW9kYWwnLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpO1xuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0LmlzKCcubW9kYWxfX2RpYWxvZycpICYmICF0YXJnZXQuY2xvc2VzdCgnLm1vZGFsX19kaWFsb2cnKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJ1tkYXRhLWRpc21pc3M9XCJtb2RhbFwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgbW9kYWwub24uaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoJy5tb2RhbCcpLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSBzaGlmdCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5yZXZlcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgoZS5rZXlDb2RlIHx8IGUud2hpY2gpID09PSB0YWJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtb2RhbC5yZXZlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9uLnRhYigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub24udGFiUmV2ZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHdpbmRvdy5vbigna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IHNoaWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLnJldmVycyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbjoge1xuICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mKFVYLmNvbnRyb2xsZXIpICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIFVYLmNvbnRyb2xsZXIuY2hlY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRib2R5LmF0dHIoJ2RhdGEtYWN0aXZlJywgJ21vZGFsJyk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLmFjY2Vzc2liaWxpdHkuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGF1dG9mb2N1cyA9IG1vZGFsLiR0YXJnZXQuZmluZCgnW2F1dG9mb2N1c10nKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRhdXRvZm9jdXMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgJGF1dG9mb2N1cy5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC4kY2xvc2UuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9LCAyNTApO1xuICAgICAgICAgICAgICAgIG1vZGFsLiR0YXJnZXQuY2xvc2VzdChcIltjbGFzcyo9J3N0aWNrbyddXCIpLmFkZENsYXNzKFwianMtLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgJChcIiNleHRlcm5hbEVtYWlsRGlhbG9nRm9ybVwiKS5hZGRDbGFzcyhcInBhaXJpbmctbWFuYWdlbWVudC1tb2RhbFwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGJvZHkucmVtb3ZlQXR0cignZGF0YS1hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5hY2Nlc3NpYmlsaXR5LmhpZGUoKTtcbiAgICAgICAgICAgICAgICBtb2RhbC4kdGFyZ2V0LmNsb3Nlc3QoXCJbY2xhc3MqPSdzdGlja28nXVwiKS5yZW1vdmVDbGFzcyhcImpzLS1vcGVuXCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRhYjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG1vZGFsLiRjbG9zZS5vZmYoJ2ZvY3Vzb3V0Jyk7XG4gICAgICAgICAgICAgICAgbW9kYWwubGFzdEl0ZW0ub2ZmKCdmb2N1c291dCcpO1xuICAgICAgICAgICAgICAgIG1vZGFsLmxhc3RJdGVtLm9uKCdmb2N1c291dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuJGNsb3NlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGFiUmV2ZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbW9kYWwubGFzdEl0ZW0ub2ZmKCdmb2N1c291dCcpO1xuICAgICAgICAgICAgICAgIG1vZGFsLiRjbG9zZS5vZmYoJ2ZvY3Vzb3V0Jyk7XG4gICAgICAgICAgICAgICAgbW9kYWwuJGNsb3NlLm9uKCdmb2N1c291dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwubGFzdEl0ZW0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVWC5tb2RhbCA9IG1vZGFsOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgJHdpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgJGRvY3VtZW50ID0gJChkb2N1bWVudCksXG4gICAgICAgICRib2R5ID0gJCgnYm9keScpO1xuXG4gICAgdmFyIHByb2dyZXNzQmFyID0ge1xuICAgICAgICAkYmFyV3JhcHBlcjogJCgnLnByb2dyZXNzLWJhci0td3JhcHBlcicpLFxuICAgICAgICAkYmFyOiAkKCcucHJvZ3Jlc3MtYmFyJyksXG4gICAgICAgIHNjcm9sbFBlcmNlbnQ6IG51bGwsXG4gICAgICAgIGxvY2s6IHRydWUsXG5cblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwcm9ncmVzc0Jhci5jb250cm9sbGVyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgJHdpbmRvdy5vbihcInNjcm9sbCBsb2FkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzc0Jhci5zY3JvbGxQZXJjZW50ID0gMTAwICogJHdpbmRvdy5zY3JvbGxUb3AoKSAvICgkZG9jdW1lbnQuaGVpZ2h0KCkgLSAkd2luZG93LmhlaWdodCgpIC0gJCgnZm9vdGVyJykub3V0ZXJIZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgaWYgKChwcm9ncmVzc0Jhci5zY3JvbGxQZXJjZW50ID4gMTAwKSB8fCAoJHdpbmRvdy5oZWlnaHQoKSA+PSAkKCdtYWluJykuaGVpZ2h0KCkgKyAkKCdoZWFkZXInKS5vdXRlckhlaWdodCgpKSlcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc2Nyb2xsUGVyY2VudCA9IDEwMDtcblxuICAgICAgICAgICAgICAgIGlmIChwcm9ncmVzc0Jhci5sb2NrKVxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0Jhci4kYmFyLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBwcm9ncmVzc0Jhci5zY3JvbGxQZXJjZW50ICsgXCIlXCJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuXG4gICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVWC5wcm9ncmVzc0JhciA9IHByb2dyZXNzQmFyO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRib2R5ID0gJCgnYm9keScpO1xuXG4gICAgdmFyIHJlZmluZSA9IHtcbiAgICAgICAgJHRhcmdldDogbnVsbCxcbiAgICAgICAgJHRhcmdldHM6ICQoJy5yZWZpbmVTZWFyY2gnKSxcbiAgICAgICAgJHNob3dDb250cm9sbGVyOiAkKCcucXVpY2stc2VhcmNoX19jdHJsX19yZWZpbmUnKSxcbiAgICAgICAgJGhpZGVDb250cm9sbGVyOiAkKCcucXVpY2stc2VhcmNoX19jdHJsX19yZWZpbmUtLWhpZGUnKSxcbiAgICAgICAgJGVsZW1lbnRzOiAkKCcucmVmaW5lU2VhcmNoX19yb3cnKSxcbiAgICAgICAgJHdyYXBwZXI6IG51bGwsXG4gICAgICAgIGVzY2FwZSA6IDI3LFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlZmluZS5jb250cm9sKCk7XG4gICAgICAgICAgICBpZiAoJCgnLnF1aWNrLXNlYXJjaCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJlZmluZS5vbi5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcucmVmaW5lU2VhcmNoX19jdHJsX19yZW1vdmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIHJlZmluZS4kdGFyZ2V0ID0gJHRoaXMuY2xvc2VzdCgnLnJlZmluZVNlYXJjaCcpO1xuICAgICAgICAgICAgICAgIHJlZmluZS4kd3JhcHBlciA9IHJlZmluZS4kdGFyZ2V0LmZpbmQoJy5yZWZpbmVTZWFyY2hfX3RleHRzJyk7XG4gICAgICAgICAgICAgICAgcmVmaW5lLm9uLnJlbW92ZSgkdGhpcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJy5yZWZpbmVTZWFyY2hfX2N0cmxfX2FkZCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgcmVmaW5lLiR0YXJnZXQgPSAkdGhpcy5jbG9zZXN0KCcucmVmaW5lU2VhcmNoJyk7XG4gICAgICAgICAgICAgICAgcmVmaW5lLiR3cmFwcGVyID0gcmVmaW5lLiR0YXJnZXQuZmluZCgnLnJlZmluZVNlYXJjaF9fdGV4dHMnKTtcbiAgICAgICAgICAgICAgICByZWZpbmUub24uY2xvbmUoJHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcucXVpY2stc2VhcmNoX19jdHJsX19yZWZpbmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAocmVmaW5lLiR0YXJnZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZWZpbmUub24uc2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnLnF1aWNrLXNlYXJjaF9fY3RybF9fcmVmaW5lLS1oaWRlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgcmVmaW5lLm9uLmhpZGUoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmICghcmVmaW5lLiR0YXJnZXRzLmlzKGUudGFyZ2V0KSAvLyBpZiB0aGUgdGFyZ2V0IG9mIHRoZSBjbGljayBpc24ndCB0aGUgY29udGFpbmVyLi4uXG4gICAgICAgICAgICAgICAgICAgICYmIHJlZmluZS4kdGFyZ2V0cy5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCAvLyAuLi4gbm9yIGEgZGVzY2VuZGFudCBvZiB0aGUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgICYmICFyZWZpbmUuJHNob3dDb250cm9sbGVyLmlzKGUudGFyZ2V0KSAvLyBpZiB0aGUgdGFyZ2V0IG9mIHRoZSBjbGljayBpc24ndCB0aGUgY29udHJvbGxlci4uLlxuICAgICAgICAgICAgICAgICAgICAmJiByZWZpbmUuJHNob3dDb250cm9sbGVyLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwIC8vIC4uLiBub3IgYSBkZXNjZW5kYW50IG9mIHRoZSBjb250cm9sbGVyXG4gICAgICAgICAgICAgICAgICAgICYmICEkKGUudGFyZ2V0KS5jbG9zZXN0KCcuamNmLXNlbGVjdC1kcm9wJykubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICYmICFyZWZpbmUuJHRhcmdldHMuY2xvc2VzdCgnLnNlYXJjaC1yZXN1bHRfX3JlZmluZS1zZWFyY2gnKS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgJiYgISQoZS50YXJnZXQpLmNsb3Nlc3QoJy5yZWZpbmVTZWFyY2hfX2N0cmxfX3JlbW92ZScpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZWZpbmUub24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKChlLmtleUNvZGUgfHwgZS53aGljaCkgPT09IHJlZmluZS5lc2NhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVmaW5lLm9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICAgIGNsb25lOiBmdW5jdGlvbiAoJHRoaXMpIHtcbiAgICAgICAgICAgICAgICBqY2YuZGVzdHJveUFsbCgpO1xuICAgICAgICAgICAgICAgICR0aGlzLmNsb3Nlc3QoJy5yZWZpbmVTZWFyY2hfX3JvdycpLmNsb25lKHRydWUsIHRydWUpLmZpbmQoJ2lucHV0JykuYXR0cihcIm5hbWVcIixcInRleHRcIiArICgkKFwiLnJlZmluZVNlYXJjaF9fcm93XCIpLmxlbmd0aCArIDEpLnRvU3RyaW5nKCkpLnZhbCgnJykuZW5kKCkuYXBwZW5kVG8ocmVmaW5lLiR3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgJHRoaXMuc2libGluZ3MoJy5yZWZpbmVTZWFyY2hfX2N0cmxfX3JlbW92ZScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAkKCcuamNmJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGpjZi5yZXBsYWNlKCQodGhpcykpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKCR0aGlzKSB7XG4gICAgICAgICAgICAgICAgJHRoaXMuY2xvc2VzdCgnLnJlZmluZVNlYXJjaF9fcm93JykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlZmluZS4kc2hvd0NvbnRyb2xsZXIuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIHJlZmluZS4kaGlkZUNvbnRyb2xsZXIucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIHJlZmluZS4kdGFyZ2V0cy5hZGRDbGFzcygnanMtLW9wZW4nKTtcbiAgICAgICAgICAgICAgICByZWZpbmUuJHRhcmdldHMuc2hvdygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhpZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZWZpbmUuJHRhcmdldHMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKSA9PT0gJ3JlZmluZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRib2R5LnJlbW92ZUF0dHIoJ2RhdGEtYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVmaW5lLiRoaWRlQ29udHJvbGxlci5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlZmluZS4kc2hvd0NvbnRyb2xsZXIucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICByZWZpbmUuJHRhcmdldHMucmVtb3ZlQ2xhc3MoJ2pzLS1vcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlZmluZS4kdGFyZ2V0cy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVgucmVmaW5lID0gcmVmaW5lOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNvcnRhYmxlVGFibGVSb3cgPSB7XG4gICAgICAgICR0YWJsZUJvZHk6ICQoXCIuc29ydGFibGUtdGFibGUgdGJvZHlcIiksXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNvcnRhYmxlVGFibGVSb3cuJHRhYmxlQm9keS5zb3J0YWJsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBzb3J0YWJsZVRhYmxlUm93LiR0YWJsZUJvZHkuc29ydGFibGUoe1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICcuYnRuLS1oYW5kbGUnLFxuICAgICAgICAgICAgICAgICAgICBpdGVtczogJ3RyLnNvcnRhYmxlLXJvdycsXG4gICAgICAgICAgICAgICAgICAgIHN0b3A6IHNvcnRhYmxlVGFibGVSb3cuYWZ0ZXJTdG9wU29ydFJvdyxcbiAgICAgICAgICAgICAgICAgICAgYXhpczogJ3knXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB9LFxuICAgICAgICBhZnRlclN0b3BTb3J0Um93OiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG4gICAgICAgICAgICBpZiAoJChcIi5zdWJtaXNzaW9uLWF1dGhvcnNcIikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciAkYXV0aG9yc1Jvd3MgPSB1aS5pdGVtLmNsb3Nlc3QoXCIuYXV0aG9yc19fdGFibGVcIikuZmluZChcIi5hdXRob3JfX3Jvd1wiKTtcbiAgICAgICAgICAgICAgICAkYXV0aG9yc1Jvd3MuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwiaW5wdXQuYXV0aG9yX19vcmRlclwiKS52YWwoaW5kZXgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG5cbiAgICB9O1xuXG4gICAgVVguc29ydGFibGVUYWJsZVJvdyA9IHNvcnRhYmxlVGFibGVSb3c7IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG5cbn0pKCk7IiwiXG4oZnVuY3Rpb24gKCkge1xuICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKSxcbiAgICAgICAgJHdpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgJGRvY3VtZW50ID0gJChkb2N1bWVudCksXG4gICAgICAgIGlzTW9iaWxlID0gZmFsc2U7IC8vIHZhcmlhYmxlIHVzZSB0byBkZXRlcm1pbmUgaWYgcmVzcG9uc2l2ZSBtb2RlIGlzIG9uIG9yIG9mZlxuXG4gICAgdmFyIHRvZ2dsZVRhYmxlID0ge1xuXG4gICAgICAgIHZQb3J0OiBcInNjcmVlbi14c1wiLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRvZ2dsZVRhYmxlLm9uLmJ1aWxkKCk7XG4gICAgICAgICAgICB0b2dnbGVUYWJsZS5jb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcuZXhwYW5kYWJsZSAudGFibGVfX2NvbnRyb2xfX2J1dHRvbicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQodGhpcykuY2xvc2VzdCgndHInKS5oYXNDbGFzcygnanMtLWV4cGFuZGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlVGFibGUub24uaGlkZSgkKHRoaXMpLmNsb3Nlc3QoJ3RyJykpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZVRhYmxlLm9uLnNob3coJCh0aGlzKS5jbG9zZXN0KCd0cicpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHdpbmRvdy5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRvZ2dsZVRhYmxlLm9uLmJ1aWxkKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24odG9nZ2xlVGFibGUudlBvcnQgKyAnLW9uJyxmdW5jdGlvbigpeyAvLyBXYWl0aW5nIGZvciBjdXN0b20gZXZlbnQgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSBjb250cm9sbGVyLmpzIHRvIGFjdGl2YXRlIHJlc3BvbnNpdmUgZWZmZWN0c1xuICAgICAgICAgICAgICAgIGlzTW9iaWxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0b2dnbGVUYWJsZS5vbi5idWlsZCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKHRvZ2dsZVRhYmxlLnZQb3J0ICsgJy1vZmYnLGZ1bmN0aW9uKCl7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gZGVhY3RpdmF0ZSByZXNwb25zaXZlIGVmZmVjdHNcbiAgICAgICAgICAgICAgICBpc01vYmlsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9LFxuICAgICAgICBvbjoge1xuICAgICAgICAgICAgYnVpbGQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciAkdG9nZ2xlID0gJCgnLmV4cGFuZGFibGUnKTtcbiAgICAgICAgICAgICAgICAkdG9nZ2xlLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9ICQodGhpcykuZmluZCgndHInKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvX2hpZGUgPSAkdGFyZ2V0LmZpbmQoJy50b19oaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQucmVtb3ZlQ2xhc3MoJ2pzLS1leHBhbmRlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc01vYmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0b19oaWRlKS5oaWRlKDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0b19oaWRlKS5zaG93KDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9IGVsZW0uZmluZCgnLnRvX2hpZGUnKTtcblxuICAgICAgICAgICAgICAgICR0YXJnZXQuc2xpZGVEb3duKDIwMCk7XG4gICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnanMtLWV4cGFuZGVkJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9IGVsZW0uZmluZCgnLnRvX2hpZGUnKTtcblxuICAgICAgICAgICAgICAgICR0YXJnZXQuc2xpZGVVcCgyMDApO1xuICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoJ2pzLS1leHBhbmRlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVYLnRvZ2dsZVRhYmxlID0gdG9nZ2xlVGFibGU7IC8vIGFkZCB0byBnbG9iYWwgbmFtZXNwYWNlXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAkYm9keSA9ICQoJ2JvZHknKTtcblxuICAgIHZhciB0YWIgPSB7XG4gICAgICAgICR0YXJnZXQ6IG51bGwsXG4gICAgICAgICR0b2dnbGU6IG51bGwsXG4gICAgICAgICRsaTogbnVsbCxcbiAgICAgICAgJHNwaW5uZXI6bnVsbCxcbiAgICAgICAgJHVsOiAkKCcudGFiX19uYXYnKSxcbiAgICAgICAgJHByZXZpb3VzOiBudWxsLFxuICAgICAgICAkY29udGVudDogbnVsbCxcbiAgICAgICAgaXNUb3VjaGVkOiBmYWxzZSxcbiAgICAgICAgZXh0cmFNYXJnaW46IDI1LFxuICAgICAgICBlbGVtZW50dlBvcnQ6IG51bGwsXG4gICAgICAgICRjb250cm9sczogbnVsbCxcbiAgICAgICAgcG9pbnRlclBvc2l0aW9uOiAwLjAsXG4gICAgICAgIGN1bXVsYXRpdmVTaGlmdDogMC4wLFxuICAgICAgICB2UG9ydDogJ3NjcmVlbi1zbScsIC8vIGRlZmF1bHQgcmVzcG9uc2l2ZSBicmVhayBwb2ludFxuICAgICAgICBpc1NsaWRlOiBmYWxzZSxcbiAgICAgICAgaXNNb2JpbGU6IFtdLCAvLyB2YXJpYWJsZSB1c2UgdG8gZGV0ZXJtaW5lIGlmIHJlc3BvbnNpdmUgbW9kZSBpcyBvbiBvciBvZmZcbiAgICAgICAgYmFja1RvQWNjZXNzaWJpbGl0eTogdHJ1ZSwgLy8gdmFyaWFibGUgdXNlIHRvIGRldGVybWluZSBpZiB3ZSB3YW50IHRvIGFkZCBiYWNrIGJ0biB0byBuYXZpZ2F0ZSBiZXR3ZWVuIGNvbnRlbnQgYW5kIGFzaWRlXG4gICAgICAgIHN3aXBlRGlzYWJsZUNsYXNzOiAnYXJyb3dzLXNsaWRlX19zaW5nbGUtLWRpc2FibGVkJyxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0YWIuJHNwaW5uZXIgPSAkKCcudGFiX19zcGlubmVyJyk7XG4gICAgICAgICAgICB0YWIucHJlc2VsZWN0VGFiKCk7XG4gICAgICAgICAgICB0YWIuZWxlbWVudHZQb3J0ID0gdGFiLnZQb3J0O1xuICAgICAgICAgICAgdGFiLnZQb3J0ID0gW107XG4gICAgICAgICAgICB2YXIgdGFiRWxtID0gJCgnLnRhYjpub3QoLnRhYiAudGFiKScpOyAvLyBpbiBjYXNlIGhpZXJhcmNoaWNhbCB0YWJzLCB3aGljaCBpcyBsb29waW5nIGluc2lkZSBuZXN0ZWQgdGFicyB0aGF0IGhhdmUgdGhlIHNhbWUgbWFpbiB0YWIgYmVoYXZpb3IgZXg6IGxvaVxuICAgICAgICAgICAgdGFiRWxtLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0YWIuY2hlY2sudmlld1BvcnQoaW5kZXgsIF90aGlzKTsvLyBnZXQgY3VycmVudCB2aWV3IHBvcnQgYWN0aXZhdG9yIGJyZWFrIHBvaW50XG4gICAgICAgICAgICAgICAgdGFiLnJlc3BvbnNpdmUoaW5kZXgsIF90aGlzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB0YWIuJGNvbnRyb2xzID0gJzxsaSBjbGFzcz1cXCdhcnJvd3Mtc2xpZGVcXCc+PGkgY2xhc3M9XFwnaWNvbi1hcnJvd19sIGFycm93cy1zbGlkZV9fc2luZ2xlIHByZXZcXCc+PC9pPiA8aSBjbGFzcz1cXCdpY29uLWFycm93X3IgYXJyb3dzLXNsaWRlX19zaW5nbGUgbmV4dFxcJz48L2k+PC9saT4nO1xuICAgICAgICAgICAgdGFiLm9uLmJ1aWxkKCk7XG4gICAgICAgICAgICB0YWIuY29udHJvbCgpO1xuICAgICAgICAgICAgJCgnLnRhYl9fbmF2IGEnKS5lYWNoKGZ1bmN0aW9uICgpIHsgLy8gZ28gdGhyb3VnaCBhbGwgdGFiIG5hdiBpdGVtc1xuICAgICAgICAgICAgICAgIHRhYi5jaGVjay5lbXB0eSgkKHRoaXMpKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSxcblxuICAgICAgICBwcmVzZWxlY3RUYWI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIFRoZSBwcmVzZWxlY3RUYWIgZnVuY3Rpb24gc2hvdWxkIGJlIGNsZWFudXBcbiAgICAgICAgICAgIC8vIEl0cyBiZXR0ZXIgdG8gdXNlIHF1ZXJ5IHN0cmluZyBpbiB1cmwgaW5zdGVhZCBzZXNzaW9uIHN0b3JhZ2UgZm9yIHNlbGVjdCBhY3RpdmUgdGFiXG4gICAgICAgICAgICAvLyBXZSBzaG91bGQgZGVwZW5kIG9uIGRhdGEtdGFyZ2V0IGFsd2F5cyBpbnN0ZWFkIG9mIGhyZWYgYmVjYXVzZSBocmVmIG1heSBjb250YWluIHVybCBub3QgdGFiLXBhbmUgc2VsZWN0b3JcbiAgICAgICAgICAgIC8vIHNlbGVjdGlvbiBvZiBhY3RpdmUgdGFiIHNob3VsZCB0ZXN0ZWQgb24gbmVzdGVkIHRhYnMgYW5kIG11bHRpIHRhYnMgb24gcGFnZVxuXG4gICAgICAgICAgICAkKFwiLnRhYlwiKS5lYWNoKGZ1bmN0aW9uICgpIHsgLy90aGUgcmVzdCBvZiB0aGlzIGNvZGUgZG9lc250IHNlZW0gdG8gc3VwcG9ydCBtdWx0aXBsZSB0YWJzIG9uIHRoZSBwYWdlLi4gYnV0IHRoaXMgZG9lc1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZGF0YSgnanMtcHJlc2VsZWN0JykgPT0gZmFsc2UpLy9JZiB5b3UgZG9uJ3QgbmVlZCBqcyB0byBzZWxlY3QgdGhlIGFjdGl2ZSB0YWJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgJGFjdGl2ZVRhYiA9IF90aGlzLmZpbmQoJy50YWJfX25hdicpLmZpbmQoJ2xpLmFjdGl2ZSBhJyk7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVRhYiA9IHRhYi5nZXRQYW5lVGFyZ2V0KCRhY3RpdmVUYWIpO1xuICAgICAgICAgICAgICAgIHZhciBzZXNzaW9uQWN0aXZlVGFiID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmICghYWN0aXZlVGFiICYmIHNlc3Npb25TdG9yYWdlLmFjdGl2ZVRhYikgeyAvLyBjaGVjayBcInNlc3Npb25TdG9yYWdlLmFjdGl2ZVRhYlwiIGlzIHNvbHV0aW9uIGZvciBMSVQtMTg5MjkyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2FjdGl2ZVRhYicpO1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uQWN0aXZlVGFiID0gYWN0aXZlVGFiO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENoZWNraW5nIGlmIGFjdGl2ZVRhYiBjb250YWlucyBoYXNoLCBpZiBub3QgaXQgaXMgbm90ICd0YWInXG4gICAgICAgICAgICAgICAgdmFyIGhhc2ggPSBhY3RpdmVUYWIgPyBhY3RpdmVUYWIubWF0Y2goLyMvKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVRhYiAmJiAoIWhhc2ggfHwgaGFzaC5pbmRleCAhPSAwKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmZpbmQoYWN0aXZlVGFiKS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYWIgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2Vzc2lvbkFjdGl2ZVRhYikge1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVUYWInLCAnJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uLnNlYXJjaCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlRXhwID0gL2FjdGl2ZVRhYj1cXGJbXFx3LV0rJC9nO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZUV4cC50ZXN0KGxvY2F0aW9uLnNlYXJjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVQYXJhbWV0ZXIgPSBsb2NhdGlvbi5zZWFyY2gubWF0Y2gocmVFeHApWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoJyMnICsgYWN0aXZlUGFyYW1ldGVyLnNwbGl0KCc9JylbMV0pLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYiA9ICcjJyArIGFjdGl2ZVBhcmFtZXRlci5zcGxpdCgnPScpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGV0ICRmaXJzdEl0ZW0gPSBfdGhpcy5maW5kKCcudGFiX19uYXYnKS5maW5kKCdsaTpmaXJzdC1vZi10eXBlIGEnKTtcbiAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZVRhYikgYWN0aXZlVGFiID0gdGFiLmdldFBhbmVUYXJnZXQoJGZpcnN0SXRlbSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlVGFiICYmIGFjdGl2ZVRhYi5zcGxpdCgnIycpLmxlbmd0aCA8IDIgfHwgYWN0aXZlVGFiID09ICcnKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHZhciB0cmlnZ2VyVGFyZ2V0ID0gJCgnW2RhdGEtdGFyZ2V0PVxcJycgKyBhY3RpdmVUYWIgKyAnXFwnXSwgW2hyZWY9XFwnJyArIGFjdGl2ZVRhYiArICdcXCddJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRyaWdnZXJUYXJnZXQuY2xvc2VzdCgnLnctc2xpZGVfX2J0bicpLmxlbmd0aCkgeyAvLyBAVE9ETyBhZGQgY29uZGl0aW9uIHRvIGFwcGx5IG9uIHdoaWxlIG9uIG1vYmlsZSBvbmx5LCB0aGluazogaXMgdGhlIGNsb3Nlc3QoKSBtZXRob2QgcmVhbGx5IGJlc3QgZm9yIHRoZSBqb2I/XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJUYXJnZXQuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmluZChhY3RpdmVUYWIpLmFkZENsYXNzKCdhY3RpdmUnKTsgLy8gaW4gc29tZSBjYXNlcyB0byBkaXNwbGF5IHRhYiBjb250ZW50IHRoZSAuYWN0aXZlIGNsYXNzIGhhcyB0byB0aWdnZXJlZC4gS25vd24gY2FzZTogYWxlcnRzIG1hbmFnZW1lbnQgaW4gcHJvZmlsZSwgd2hlbiBkaXJlY3RlZCB0byBhIHNwZWNpZmljIHRhYi5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBjb250cm9sOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcudGFiLWxpbmsnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ2RhdGEtc2Nyb2xsLWJhY2stdG8nLCAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSk7XG4gICAgICAgICAgICAgICAgdGFiLm9uLnNlbGVjdC5leHRlcm5hbCgkKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnW2RhdGEtbW9iaWxlLXRvZ2dsZT1cImRyb3Bkb3duXCJdIGEsIC5kcm9wYmxvY2stLXRhYiBhJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB0YWIub24uc2VsZWN0LmRyb3Bkb3duKCQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoJy5qcy0tb3BlbltkYXRhLWRiLXRhcmdldC1mb3JdJykubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBVWC5kcm9wQmxvY2sub24uaGlkZSgpO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICcudGFiX19uYXYgYScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIHZhciB0YWJJZCA9IHRhYi5nZXRQYW5lVGFyZ2V0KF90aGlzKTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS50cmlnZ2VyKCd0YWJzOmNoYW5nZUFjdGl2ZVRhYicsIHt0YWJJZDogdGFiSWR9KTtcbiAgICAgICAgICAgICAgICB2YXIgJHBhcmVudCA9IF90aGlzLnBhcmVudHMoJy50YWInKTtcbiAgICAgICAgICAgICAgICBpZiAoJHBhcmVudC5oYXNDbGFzcygndGFiLS1sYXp5LWxvYWQnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0YWJJZCkuYXR0cignZGF0YS1hamF4bG9hZGVkJykgIT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWIuZ2V0Q29udGVudCgkKHRhYklkKS5maW5kKCcudGFiLWxhenknKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrIHRvdWNoZW5kJywgJy5hcnJvd3Mtc2xpZGUgLm5leHQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBsZXQgJGFjdGl2ZU5hdiA9ICQodGhpcykuY2xvc2VzdCgnLnRhYl9fbmF2JykuZmluZCgnLmFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIGxldCAkYWN0aXZlUGFuZSA9ICQodGhpcykuY2xvc2VzdCgnLnRhYicpLmZpbmQoXCIudGFiX19jb250ZW50IGxpLmFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoJGFjdGl2ZU5hdi5uZXh0KCkubm90KCcuYXJyb3dzLXNsaWRlJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCAkbmV3QWN0aXZlRWwgPSAkYWN0aXZlTmF2LnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5uZXh0KCkubm90KCcuYXJyb3dzLXNsaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgICRuZXdBY3RpdmVFbC5hZGRDbGFzcygnYWN0aXZlJykuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICAkYWN0aXZlUGFuZS5yZW1vdmVDbGFzcygnYWN0aXZlJykubmV4dCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgdGFiLm5hdlRvRXh0ZXJuYWwoJG5ld0FjdGl2ZUVsKVxuICAgICAgICAgICAgICAgICAgICBpZiAoISRhY3RpdmVOYXYubmV4dCgpLm5vdCgnLmFycm93cy1zbGlkZScpLm5leHQoKS5ub3QoJy5hcnJvd3Mtc2xpZGUnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3ModGFiLnN3aXBlRGlzYWJsZUNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5hcnJvd3Mtc2xpZGUnKS5maW5kKCcucHJldicpLnJlbW92ZUNsYXNzKHRhYi5zd2lwZURpc2FibGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljayB0b3VjaGVuZCcsICcuYXJyb3dzLXNsaWRlIC5wcmV2JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgbGV0ICRhY3RpdmVOYXYgPSAkKHRoaXMpLmNsb3Nlc3QoJy50YWJfX25hdicpLmZpbmQoJy5hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBsZXQgJGFjdGl2ZVBhbmUgPSAkKHRoaXMpLmNsb3Nlc3QoJy50YWInKS5maW5kKFwiLnRhYl9fY29udGVudCBsaS5hY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgaWYgKCRhY3RpdmVOYXYucHJldigpLm5vdCgnLmFycm93cy1zbGlkZScpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJG5ld0FjdGl2ZUVsID0gJGFjdGl2ZU5hdi5yZW1vdmVDbGFzcygnYWN0aXZlJykucHJldigpLm5vdCgnLmFycm93cy1zbGlkZScpO1xuICAgICAgICAgICAgICAgICAgICAkbmV3QWN0aXZlRWwuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgJGFjdGl2ZVBhbmUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLnByZXYoKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5uYXZUb0V4dGVybmFsKCRuZXdBY3RpdmVFbClcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkYWN0aXZlTmF2LnByZXYoKS5ub3QoJy5hcnJvd3Mtc2xpZGUnKS5wcmV2KCkubm90KCcuYXJyb3dzLXNsaWRlJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKHRhYi5zd2lwZURpc2FibGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuYXJyb3dzLXNsaWRlJykuZmluZCgnLm5leHQnKS5yZW1vdmVDbGFzcyh0YWIuc3dpcGVEaXNhYmxlQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIC8vIEdldCBwb3N0YmFjayBhY3RpdmUgdGFiXG4gICAgICAgICAgICB0YWIuc2V0UG9zdGJhY2tBY3RpdmVUYWIodGFiLmdldFBvc3RiYWNrQWN0aXZlVGFiKCkpO1xuICAgICAgICAgICAgdGFiLmFkZGl0aW9uYWxDb250cm9sKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGFkZGl0aW9uYWxDb250cm9sOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgfSxcbiAgICAgICAgbmF2VG9FeHRlcm5hbCgkYWN0aXZlTmF2KXtcbiAgICAgICAgICAgIGNvbnN0ICRleHRlcm5hbExpbmsgPSAkYWN0aXZlTmF2LmZpbmQoJy5leHRlcm5hbCcpO1xuICAgICAgICAgICAgaWYgKCRleHRlcm5hbExpbmsubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICRleHRlcm5hbExpbmsuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zaXZlOiBmdW5jdGlvbiAoaW5kZXgsIHRhYkVsZW0pIHtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24odGFiLnZQb3J0W2luZGV4XSArICctb24nLCBmdW5jdGlvbiAoKSB7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gYWN0aXZhdGUgcmVzcG9uc2l2ZSBlZmZlY3RzXG4gICAgICAgICAgICAgICAgdGFiLmlzTW9iaWxlW2luZGV4XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8kKCdbZGF0YS1zbGlkZS10YXJnZXRdJykuYWRkQ2xhc3MoJ3ctc2xpZGVfX2J0bicpO1xuXG4gICAgICAgICAgICAgICAgLy8gJCgnLnRhYicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICh0YWJFbGVtLmRhdGEoJ2N0cmwtcmVzJykgPT0gdGFiLnZQb3J0W2luZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICB0YWJFbGVtLmFkZENsYXNzKCd0YWItLXJlcycpOyAvLyBjbGFzcyB3aWxsIGJlIHVzZWQgaW4gb3VyIHNjc3MgKHRvIHJlcGxhY2UgbWVkaWEgcXVlcmllcylcbiAgICAgICAgICAgICAgICAgICAgdGFiLmFkZGl0aW9uYWxDb250cm9sKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5vbi5yZWJ1aWxkLnJlc3BvbnNpdmUodGFiRWxlbSk7IC8vIHJlYnVpbGQgdGFicyB0byBiZSByZXNwb25zaXZlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gd2l0aEFycm93cy5lYWNoKGZ1bmN0aW9uIChpLCBvKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhYkVsZW0uY2xvc2VzdCgnLnN3aXBlLXdpdGgtYXJyb3dzJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YWJOYXYgPSB0YWJFbGVtLmZpbmQoJy50YWJfX25hdicpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFiTmF2LmNoaWxkcmVuKCdsaScpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NJbmRleCA9IHRhYk5hdi5jaGlsZHJlbignbGkuYWN0aXZlJykuaW5kZXgoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSB0YWJOYXYuY2hpbGRyZW4oJ2xpJykubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzID0gJCh0YWIuJGNvbnRyb2xzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYk5hdi5jaGlsZHJlbignbGk6bm90KC5hY3RpdmUpJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc0luZGV4ICsgMSA9PSBsZW5ndGgpIHsgLy8gZGVjaWRlIHdoaWNoIGFycm93IHRvIGRpc2FibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9scy5maW5kKCcubmV4dCcpLmFkZENsYXNzKHRhYi5zd2lwZURpc2FibGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zSW5kZXggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzLmZpbmQoJy5wcmV2JykuYWRkQ2xhc3ModGFiLnN3aXBlRGlzYWJsZUNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYk5hdi5hcHBlbmQoY29udHJvbHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKHRhYi52UG9ydFtpbmRleF0gKyAnLW9mZicsIGZ1bmN0aW9uICgpIHsgLy8gV2FpdGluZyBmb3IgY3VzdG9tIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgYnkgY29udHJvbGxlci5qcyB0byBkZWFjdGl2YXRlIHJlc3BvbnNpdmUgZWZmZWN0c1xuICAgICAgICAgICAgICAgIHRhYi5pc01vYmlsZVtpbmRleF0gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vICQoJy50YWInKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFiRWxlbS5kYXRhKCdjdHJsLXJlcycpID09IHRhYi52UG9ydFtpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiRWxlbS5yZW1vdmVDbGFzcyhcInRhYi0tcmVzXCIpOyAvLyBjbGFzcyB3aWxsIGJlIHVzZWQgaW4gb3VyIHNjc3MgKHRvIHJlcGxhY2UgbWVkaWEgcXVlcmllcylcbiAgICAgICAgICAgICAgICAgICAgdGFiLm9uLnJlYnVpbGQub3JpZ2luYWwoJCh0aGlzKSk7IC8vIHJldHVybiB0YWJzIGFzIGRlZmF1bHRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2l0aEFycm93cyA9ICQoJy5zd2lwZS13aXRoLWFycm93cycpLmZpbmQoJy50YWJfX25hdicpO1xuICAgICAgICAgICAgICAgIHdpdGhBcnJvd3MuY2hpbGRyZW4oJ2xpJykuY3NzKFwiZGlzcGxheVwiLCBcImlubGluZS1ibG9ja1wiKTtcbiAgICAgICAgICAgICAgICB3aXRoQXJyb3dzLmZpbmQoJy5hcnJvd3Mtc2xpZGUnKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGFuaW1hdGU6IHtcbiAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCRjb250ZW50LCAkdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCR0YXJnZXQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTY3JvbGxUb3AgPSAkY29udGVudC5zY3JvbGxUb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudFRvcCA9ICRjb250ZW50LnBvc2l0aW9uKCkudG9wO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRUb3AgPSAkdGFyZ2V0LnBvc2l0aW9uKCkudG9wO1xuICAgICAgICAgICAgICAgICAgICAkY29udGVudC5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogdGFyZ2V0VG9wIC0gY29udGVudFRvcCArIGNvbnRlbnRTY3JvbGxUb3BcbiAgICAgICAgICAgICAgICAgICAgfSwgNjAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNldDoge1xuICAgICAgICAgICAgdGFyZ2V0OiBmdW5jdGlvbiAoJGNvbnRlbnQsIHRhcmdldCwgdGVtcCkge1xuICAgICAgICAgICAgICAgIGlmICghJGNvbnRlbnQuZmluZCh0YXJnZXQpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0YWIuJHRhcmdldCA9ICRjb250ZW50LmZpbmQoJ1tkYXRhLWZpZ3VyZS1pZD1cXCcnICsgdGVtcCArICdcXCddJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQgPSAkY29udGVudC5maW5kKHRhcmdldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NpYmlsaXR5OiB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEFjY2Vzc2liaWxpdHkgLSBuYXZpZ2F0ZSBiZXR3ZWVuIGNvbnRlbnQgYW5kIGFzaWRlXG4gICAgICAgICAgICAgKiBAcGFyYW0gZWxlbVxuICAgICAgICAgICAgICogQHBhcmFtIHRhYlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBleHRlcm5hbExpbms6IGZ1bmN0aW9uIChlbGVtLCB0YWIpIHtcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgZm9jdXNhYmxlIG9wdGlvbiBmb3IgdGFyZ2V0XG4gICAgICAgICAgICAgICAgdmFyIHRhYmluZGV4ID0gdGFiLiR0YXJnZXQuYXR0cigndGFiaW5kZXgnKTtcbiAgICAgICAgICAgICAgICB0YWIuJHRhcmdldC5hdHRyKCd0YWJpbmRleCcsICh0eXBlb2YgdGFiaW5kZXggPT09ICd1bmRlZmluZWQnID8gLTEgOiB0YWJpbmRleCkpO1xuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhbmQgYXBwZW5kIGJhY2sgYnV0dG9uIHRvIGNvbnRlbnRcbiAgICAgICAgICAgICAgICB2YXIgYmFja0xpbmsgPSAkKCc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi0ta2V5Ym9hcmQtYWNjZXNzaWJsZVwiPkdvIGJhY2sgdG8gY29udGVudDwvYnV0dG9uPicpO1xuICAgICAgICAgICAgICAgIGlmICh0YWIuYmFja1RvQWNjZXNzaWJpbGl0eSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFiLiR0YXJnZXQuaXMoJ2EsIHVsLCBvbCwgaW1nLCB0YWJsZScpIHx8IHRhYi4kdGFyZ2V0LmlzKCc6aW5wdXQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQuYWZ0ZXIoYmFja0xpbmspO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQuYXBwZW5kKGJhY2tMaW5rKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGdvIGJhY2sgdG8gb3JpZ2luYWwgZWxlbWVudCBpZiBiYWNrYnV0dG9uIGlzIGFjdGl2YXRlZFxuICAgICAgICAgICAgICAgICAgICBiYWNrTGluay5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLm9uKCdmb2N1c291dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyByZXZlcnQgb3JpZ2luYWwgc3RhdGUgb24gZm9jdXMgb3V0XG4gICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQub24oJ2ZvY3Vzb3V0LnRhYmxpbmsnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAvLyByZXZlcnQgdGFiaW5kZXggdG8gb3JpZ2luYWwgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YWJpbmRleCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUF0dHIoJ3RhYmluZGV4Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGJhY2tidXR0b24gaWYgdXNlciB0YWJiZWQgb3V0IG9mIHRhcmdldCBieSBzb21lIG90aGVyIG1lYW5zIHRoYW4gdGFiYmluZyB0byBiYWNrbGlua1xuICAgICAgICAgICAgICAgICAgICBpZiAoISQoZXZlbnQucmVsYXRlZFRhcmdldCkuaXMoYmFja0xpbmspICYmICEkKGV2ZW50LnJlbGF0ZWRUYXJnZXQpLnBhcmVudHMoKS5maWx0ZXIodGFiLiR0YXJnZXQpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhY2tMaW5rLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrTGluay5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLm9mZignZm9jdXNvdXQudGFibGluaycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJvdmlkZSBFU0Mgc3VwcG9ydCBmb3IgcmV0dXJuIHRvIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgLm9uKCdrZXlkb3duLnRhYmxpbmsnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICR0aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uIGVzY2FwZSwgcmV0dXJuIHRvIGNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5vZmYoJ2tleWRvd24udGFibGluaycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmFja0xpbmsubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrTGluay5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgZm9jdXMgdG8gdGFyZ2V0XG4gICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgIGV4dGVybmFsOiBmdW5jdGlvbiAoJGVsZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICRlbGVtLmF0dHIoJ2hyZWYnKTsgLy8gZ2V0IHRhcmdldCBpZFxuXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5zcGxpdChcIiBcIilbMF07IC8vTElULTE2MjYzNlxuXG4gICAgICAgICAgICAgICAgICAgIHRhYi4kdG9nZ2xlID0gJyMnICsgJGVsZW0uZGF0YSgndGFiJyk7IC8vZ2V0IHRhcmdldCBwYW5lXG4gICAgICAgICAgICAgICAgICAgIHRhYi4kbGkgPSAkKCcudGFiX19uYXYgW2hyZWY9XCInICsgdGFiLiR0b2dnbGUgKyAnXCJdJyk7IC8vIGdldCB0YXJnZXQgdGFicyBuYXZcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB0YXJnZXQuc3BsaXQoXCIjXCIpWzFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50VGFiID0gJCh0YWIuJHRvZ2dsZSkuY2xvc2VzdCgnLnRhYicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0ZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYi4kY29udGVudCA9ICQodGFiLiR0b2dnbGUpLnBhcmVudHMoXCIudGFiX19jb250ZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWIuJGNvbnRlbnQubGVuZ3RoICYmICRlbGVtLmlzKCdbZGF0YS1zbGlkZS10YXJnZXRdJykgJiYgJGVsZW0uaGFzQ2xhc3MoJ3NsaWRlLWFjdGl2ZScpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi4kY29udGVudCA9ICQoJy53LXNsaWRlX19jb250ZW50Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRUYWIuaGFzQ2xhc3MoJ3RhYi0tcmVzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIuaXNTbGlkZSA9IHBhcmVudFRhYi5oYXNDbGFzcyhcInRhYi0tc2xpZGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYi5pc1NsaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi5zZXQudGFyZ2V0KCQoJy53LXNsaWRlX19jb250ZW50JyksIHRhcmdldCwgdGVtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWIuJHRhcmdldC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi5hbmltYXRlLnNjcm9sbCgkKFwiLnctc2xpZGVfX2NvbnRlbnRcIiksIHRhYi4kdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi4kdGFyZ2V0LmF0dHIoXCJ0YWItaW5kZXhcIiwgXCIxXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLiR0YXJnZXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLnNldC50YXJnZXQodGFiLiRjb250ZW50LCB0YXJnZXQsIHRlbXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi5hbmltYXRlLnNjcm9sbCh0YWIuJGNvbnRlbnQsIHRhYi4kdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIuYWNjZXNzaWJpbGl0eS5leHRlcm5hbExpbmsoJGVsZW0sIHRhYik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCQodGFiLiR0b2dnbGUpLmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWIuJGxpLmNsaWNrKCk7IC8vIG9wZW4gdGFyZ2V0IHRhYlxuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZVNjcm9sbCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGFiLiR0b2dnbGUpLmhhc0NsYXNzKCdlbXB0eScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0YWIuJHRvZ2dsZSkub24oJ2NvbnRlbnQtbG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlU2Nyb2xsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLiRsaS5jbGljaygpOyAvLyBvcGVuIHRhcmdldCB0YWJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLiRsaS5jbGljaygpOyAvLyBvcGVuIHRhcmdldCB0YWJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlU2Nyb2xsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRyb3Bkb3duOiBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUF0dHIgPSBlbGVtLmNsb3Nlc3QoJ3VsJykuZGF0YSgnbW9iaWxlLXRvZ2dsZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YUF0dHIgPT09ICdkcm9wZG93bicgfHwgZWxlbS5jbG9zZXN0KCd1bCcpLmhhc0NsYXNzKCdkcm9wYmxvY2stLXRhYicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHJvcGRvd25Db250YWluZXIgPSBlbGVtLmNsb3Nlc3QoJy5kcm9wQmxvY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQ29udGFpbmVyLmNoaWxkcmVuKCdhJykuZmluZCgnc3BhbicpLnRleHQoZWxlbS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBidWlsZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRhYi4kdWwuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaXMoJy5zd2lwZV9fbGlzdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uc3dpcGVCdWlsZCgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5pcygnLmRyb3BibG9jay0tdGFiJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYi5vbi5kcm9wZG93bkJ1aWxkKCQodGhpcyksIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vfSwgMjAwKTtcbiAgICAgICAgICAgICAgICAkKCcudGFiLS1sYXp5LWxvYWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiLmdldENvbnRlbnQoJCh0aGlzKS5maW5kKCcudGFiX19wYW5lLmFjdGl2ZScpLmZpbmQoJy50YWItbGF6eScpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhbGN1bGF0ZTogZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbVBhcmVudCA9IGVsZW0ucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYk5hdldpZHRoID0gdGFiLmV4dHJhTWFyZ2luO1xuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnbGknKS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJOYXZXaWR0aCArPSAkKHRoaXMpLmlubmVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbVBhcmVudFdpZHRoID0gZWxlbVBhcmVudC53aWR0aCgpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtUGFyZW50V2lkdGggPCB0YWJOYXZXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVsZW0ucGFyZW50KCkuaXMoJy5zY3JvbGwnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLm9uLnN3aXBlQnVpbGQoZWxlbSwgdGFiTmF2V2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiLm9uLnN3aXBlRGVzdHJveShlbGVtKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzd2lwZUJ1aWxkOiBmdW5jdGlvbiAoZWxlbSwgdGFiTmF2V2lkdGgpIHsgLy8gcmVidWlsZCB0YWJzIHRvIHN3aXBlXG5cbiAgICAgICAgICAgICAgICBlbGVtLndyYXAoJzxkaXYgY2xhc3M9XCJzd2lwZV9fd3JhcHBlclwiPjxkaXYgY2xhc3M9XCJzY3JvbGxcIj48L2Rpdj48L2Rpdj4nKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGFiTmF2V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYk5hdldpZHRoID0gdGFiLmV4dHJhTWFyZ2luO1xuICAgICAgICAgICAgICAgICAgICBlbGVtLmNsb3Nlc3QoXCIudGFiX19wYW5lXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5maW5kKCdsaScpLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJOYXZXaWR0aCArPSAkKHRoaXMpLmlubmVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW0uY2xvc2VzdChcIi50YWJfX3BhbmVcIikuY3NzKFwiZGlzcGxheVwiLCBcIlwiKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGVsZW0ud2lkdGgodGFiTmF2V2lkdGgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN3aXBlRGVzdHJveTogZnVuY3Rpb24gKGVsZW0pIHsgLy8gcmV0dXJuIHRhYnMgdG8gZGVmYXVsdFxuXG4gICAgICAgICAgICAgICAgZWxlbS5yZW1vdmVBdHRyKCdzdHlsZScpO1xuICAgICAgICAgICAgICAgIGVsZW0udW53cmFwKCcuc2Nyb2xsJykudW53cmFwKCcuc3dpcGVfX3dyYXBwZXInKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkcm9wZG93bkJ1aWxkOiBmdW5jdGlvbiAoZWxlbSwgaW5kZXgpIHsgLy8gcmVidWlsZCB0YWJzIHRvIGJlIGFzIGRyb3AgZG93blxuICAgICAgICAgICAgICAgIGlmIChVWC5kcm9wQmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgVVguZHJvcEJsb2NrLmluaXQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlbGVtLndyYXAoJzxkaXYgY2xhc3M9XCJkcm9wQmxvY2tcIiBkYXRhLWRiLXBhcmVudC1vZj1cImRiVGFiLScgKyBpbmRleCArICdcIj48L2Rpdj4nKTtcblxuICAgICAgICAgICAgICAgIHZhciAkZHJvcGRvd25Db250YWluZXIgPSBlbGVtLmNsb3Nlc3QoJy5kcm9wQmxvY2snKTtcbiAgICAgICAgICAgICAgICB2YXIgJGFjdGl2ZVRhYiA9IGVsZW0uZmluZCgnLmFjdGl2ZSBhJyk7XG5cbiAgICAgICAgICAgICAgICAkZHJvcGRvd25Db250YWluZXIucHJlcGVuZCgnPGEgaHJlZj1cIiNcImNsYXNzPVwiZHJvcEJsb2NrX19saW5rXCIgZGF0YS1kYi10YXJnZXQtZm9yPVwiZGJUYWItJyArIGluZGV4ICsgJ1wiPjxzcGFuPicgKyAkYWN0aXZlVGFiLnRleHQoKSArICc8L3NwYW4+PGkgY2xhc3M9XCJpY29uLWFycm93X2RfblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT48L2E+JylcbiAgICAgICAgICAgICAgICBlbGVtLmF0dHIoJ2RhdGEtZGItdGFyZ2V0LW9mJywgJ2RiVGFiLScgKyBpbmRleCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZHJvcGRvd25EZXN0cm95OiBmdW5jdGlvbiAoZWxlbSkgeyAvLyByZXR1cm4gdGFicyB0byBkZWZhdWx0XG5cbiAgICAgICAgICAgICAgICB2YXIgZHJvcGRvd25Db250YWluZXIgPSBlbGVtLmNsb3Nlc3QoJy5kcm9wQmxvY2snKTtcbiAgICAgICAgICAgICAgICBkcm9wZG93bkNvbnRhaW5lci5jaGlsZHJlbignYScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQXR0cignZGF0YS1kYi10YXJnZXQtb2YnKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2pzLS1vcGVuJylcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ3N0eWxlJylcbiAgICAgICAgICAgICAgICAgICAgLnVud3JhcCgnLmRyb3BCbG9jaycpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFjY29yZGlvbkJ1aWxkOiBmdW5jdGlvbiAoZWxlbSkgeyAvLyByZWJ1aWxkIHRhYnMgdG8gYmUgYXMgYWNjb3JkaW9uXG5cbiAgICAgICAgICAgICAgICB2YXIgJGFjY291cmRpb25FbGVtID0gZWxlbS5uZXh0KCcudGFiX19jb250ZW50Jyk7XG4gICAgICAgICAgICAgICAgJGFjY291cmRpb25FbGVtLmFkZENsYXNzKCdhY2NvcmRpb24tdGFiYmVkJylcbiAgICAgICAgICAgICAgICAgICAgLndyYXAoJzxkaXYgY2xhc3M9XCJhY2NvcmRpb25cIj48L2Rpdj4nKTtcblxuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnYScpLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkbGlkaXYgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlDb250cm9sbGVyID0gdGFiLmdldFBhbmVUYXJnZXQoJGxpZGl2KTtcblxuICAgICAgICAgICAgICAgICAgICAkKGxpQ29udHJvbGxlcikuYWRkQ2xhc3MoJ2FjY29yZGlvbi10YWJiZWRfX3RhYicpIC8vIHRyYW5zZm9ybSB0YWJzIHN0cnVjdHVyZSB0byBhY2NvcmRpb24gc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ3RhYl9fcGFuZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAud3JhcElubmVyKCc8ZGl2IGNsYXNzPVwiYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudFwiPjwvZGl2PicpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY2NvcmRpb25Db250cmwgPSAkbGlkaXYuY2xvbmUoKS5wcmVwZW5kVG8obGlDb250cm9sbGVyKS5hZGRDbGFzcygnYWNjb3JkaW9uLXRhYmJlZF9fY29udHJvbCcpOyAgLy8gY2xvbmUgdGFicyBjb250cm9sbGVyIGFzIGFjY29yZGlvbiBjb250cm9sbGVyXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGVsZW0uaGlkZSgpO1xuICAgICAgICAgICAgICAgIFVYLmFjY29yZGlvbi5pbml0KCk7XG5cbiAgICAgICAgICAgICAgICAkKCcudGFiX19jb250ZW50LmFjY29yZGlvbi10YWJiZWQgLmFjY29yZGlvbi10YWJiZWRfX3RhYicpLnJlbW92ZUNsYXNzKCdqcy0tb3BlbicpLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX19jb250ZW50JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQoJy50YWJfX2NvbnRlbnQuYWNjb3JkaW9uLXRhYmJlZCAuYWNjb3JkaW9uLXRhYmJlZF9fdGFiLmFjdGl2ZScpLmFkZENsYXNzKCdqcy0tb3BlbicpLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX19jb250ZW50Jykuc2hvdygpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWNjb3JkaW9uRGVzdHJveTogZnVuY3Rpb24gKGVsZW0pIHsgLy8gcmV0dXJuIHRhYnMgdG8gZGVmYXVsdFxuICAgICAgICAgICAgICAgIGVsZW0ubmV4dCgnLmFjY29yZGlvbicpLmZpbmQoJy50YWJfX2NvbnRlbnQnKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2FjY29yZGlvbi10YWJiZWQnKVxuICAgICAgICAgICAgICAgICAgICAudW53cmFwKCcuYWNjb3JkaW9uJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5hY2NvcmRpb24tdGFiYmVkX190YWInKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbGlEaXYgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxpRGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCd0YWJfX3BhbmUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnYWNjb3JkaW9uLXRhYmJlZF9fdGFiIGpzLS1vcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9ICRsaURpdi5maW5kKCcuYWNjb3JkaW9uLXRhYmJlZF9fY29udGVudCcpLnRleHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsaURpdi5odG1sKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVUYXAgPSBlbGVtLm5leHQoJy50YWJfX2NvbnRlbnQnKS5maW5kKCcuYWN0aXZlJykuYXR0cignaWQnKTtcblxuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgICQoJ1tocmVmPVwiIycgKyBhY3RpdmVUYXAgKyAnXCJdJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2xpZGVEZXN0cm95OiBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnW2RhdGEtc2xpZGUtdGFyZ2V0XScpLnJlbW92ZUNsYXNzKCd3LXNsaWRlX19idG4gc2xpZGUtYWN0aXZlJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVidWlsZDoge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiBmdW5jdGlvbiAoJGVsZW0pIHsgLy8gcmV0dXJuIHRhYnMgdG8gYmUgYXMgZGVmYXVsdFxuICAgICAgICAgICAgICAgICAgICAvLyQoJ1tkYXRhLXNsaWRlLXRhcmdldF0nKS5yZW1vdmVDbGFzcygndy1zbGlkZV9fYnRuIHNsaWRlLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICB0YWIuJHVsID0gJGVsZW0uZmluZCgnLnRhYl9fbmF2Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRhYi4kdWwuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJCh0aGlzKS5kYXRhKCdtb2JpbGUtdG9nZ2xlJykgfHwgJCh0aGlzKS5jbG9zZXN0KCdbZGF0YS1tb2JpbGUtdG9nZ2xlXScpLmRhdGEoJ21vYmlsZS10b2dnbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N3aXBlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLm9uLnN3aXBlRGVzdHJveSgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZHJvcGRvd24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uZHJvcGRvd25EZXN0cm95KCQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhY2NvcmRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uYWNjb3JkaW9uRGVzdHJveSgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xpZGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uc2xpZGVEZXN0cm95KCQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qaWYgKCAkKHRoaXMpLmNsb3Nlc3QoJy50YWInKS5oYXNDbGFzcygndGFiLS1mbGV4JykgfHwgICQodGhpcykuY2xvc2VzdCgnLnRhYicpLmhhc0NsYXNzKCdsb2knKSB8fCAgJCh0aGlzKS5oYXNDbGFzcygnZHJvcGJsb2NrLS10YWInKSB8fCAkKHRoaXMpLmNsb3Nlc3QoXCIuYWR2YW5jZWRTZWFyY2hfX3RhYnNcIikubGVuZ3RoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uY2FsY3VsYXRlKCQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ2luaXQuYnMudGFiJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNwb25zaXZlOiBmdW5jdGlvbiAoJGVsZW0pIHsgLy8gcmVidWlsZCB0YWJzIHRvIGJlIGluIHNlbGVjdGVkIHJlc3BvbnNpdmUgbW9kZVxuICAgICAgICAgICAgICAgICAgICB0YWIuJHVsID0gJGVsZW0uZmluZCgnLnRhYl9fbmF2Jyk7XG4gICAgICAgICAgICAgICAgICAgICQoJy50YWJfX25hdicpLmZpbmQoJ1tkYXRhLXNsaWRlLXRhcmdldF0nKS5hZGRDbGFzcygndy1zbGlkZV9fYnRuIHNsaWRlLWFjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRhYi4kdWwuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJCh0aGlzKS5kYXRhKCdtb2JpbGUtdG9nZ2xlJykgfHwgJCh0aGlzKS5jbG9zZXN0KCdbZGF0YS1tb2JpbGUtdG9nZ2xlXScpLmRhdGEoJ21vYmlsZS10b2dnbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N3aXBlJzogLy8gcmVidWlsZCB0YWJzIHRvIHN3aXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJCh0aGlzKS5wYXJlbnQoKS5pcygnLnNjcm9sbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWIub24uc3dpcGVCdWlsZCgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkcm9wZG93bic6IC8vIHJlYnVpbGQgdGFicyBiZSBhcyBkcm9wZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISQodGhpcykucGFyZW50KCkuaXMoJy5kcm9wQmxvY2snKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLm9uLmRyb3Bkb3duQnVpbGQoJCh0aGlzKSwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FjY29yZGlvbic6IC8vIHJlYnVpbGQgdGFicyBiZSBhcyBhY2NvcmRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEkKHRoaXMpLm5leHQoKS5oYXNDbGFzcygnYWNjb3JkaW9uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYi5vbi5hY2NvcmRpb25CdWlsZCgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbGlkZSc6IC8vIHJlYnVpbGQgdGFicyBiZSBhcyBhY2NvcmRpb25cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiAvLyByZWJ1aWxkIHRhYnMgdG8gZmxleFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qaWYgKCAkKHRoaXMpLmNsb3Nlc3QoJy50YWInKS5oYXNDbGFzcygndGFiLS1mbGV4JykgfHwgICQodGhpcykuY2xvc2VzdCgnLnRhYicpLmhhc0NsYXNzKCdsb2knKSB8fCAgJCh0aGlzKS5oYXNDbGFzcygnZHJvcGJsb2NrLS10YWInKSB8fCAkKHRoaXMpLmNsb3Nlc3QoXCIuYWR2YW5jZWRTZWFyY2hfX3RhYnNcIikubGVuZ3RoICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiLm9uLmNhbGN1bGF0ZSgkKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ki9cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcignaW5pdC5icy50YWInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNoZWNrOiB7XG4gICAgICAgICAgICBlbXB0eTogZnVuY3Rpb24gKCR0YWJJdGVtKSB7IC8vIGNoZWNrIGlmIHRhYiBwYW5lIGlzIGVtcHR5IGFuZCBoaWRlIGl0XG4gICAgICAgICAgICAgICAgbGV0IHBhbmUgPSB0YWIuZ2V0UGFuZVRhcmdldCgkdGFiSXRlbSk7IC8vIGdldCBpdCdzIHJlbGF0ZWQgcGFuZVxuXG4gICAgICAgICAgICAgICAgaWYgKCR0YWJJdGVtLmlzKCdhOm5vdChbaHJlZl49XCIjXCJdKScpIHx8ICR0YWJJdGVtLmhhc0NsYXNzKCdleHRlcm5hbCcpKSAvLyBpdCBpcyBsaW5rIGFuZCBoYXMgbm8gcGFuZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBpZiAoISQocGFuZSkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICR0YWJJdGVtLmFkZENsYXNzKFwiZW1wdHlcIik7IC8vIGRpc2FibGUgdGFiIG5hdiBiZWNhdXNlIGl0IGhhcyBubyBwYW5lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCAkcGFuZSA9ICQocGFuZSksXG4gICAgICAgICAgICAgICAgICAgIGhhc05vQ29udGVudCA9ICEkcGFuZS50ZXh0KCkudHJpbSgpLmxlbmd0aCB8fCAkcGFuZS5maW5kKCcuZW1wdHlUYWInKS5sZW5ndGggfHwgJHBhbmUuaXMoJzplbXB0eScpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCRwYW5lLmxlbmd0aCAmJiAoaGFzTm9Db250ZW50KSkgeyAvLyBpZiB0YWIgbmF2IGl0ZW0gaXMgbm90IGFuIGV4dGVybmFsIGxpbmsgYW5kIGNoZWNrIGlmIHBhbmUgaXMgZW1wdHlcbiAgICAgICAgICAgICAgICAgICAgJHBhbmUuYWRkQ2xhc3MoJ2VtcHR5Jyk7IC8vIGFkZCBjbGFzcyB0byBlbXB0eSBwYW5lXG4gICAgICAgICAgICAgICAgICAgICR0YWJJdGVtLmFkZENsYXNzKCdlbXB0eScpOyAvLyBhZGQgY2xhc3MgdG8gZW1wdHkgbmF2IGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGFib3J0XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHBhbmUucmVtb3ZlQ2xhc3MoJ2VtcHR5Jyk7IC8vIGFkZCBjbGFzcyB0byBlbXB0eSBwYW5lXG4gICAgICAgICAgICAgICAgICAgICR0YWJJdGVtLnJlbW92ZUNsYXNzKCdlbXB0eScpOyAvLyBhZGQgY2xhc3MgdG8gZW1wdHkgbmF2IGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBhYm9ydFxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmlld1BvcnQ6IGZ1bmN0aW9uIChpbmRleCwgJGVsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAkZWwuZGF0YSgnY3RybC1yZXMnKSAhPSAndW5kZWZpbmVkJyB8fCAkZWwuZGF0YSgnY3RybC1yZXMnKSA9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICB0YWIudlBvcnRbaW5kZXhdID0gJGVsLmRhdGEoJ2N0cmwtcmVzJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJGVsLmRhdGEoJ2N0cmwtcmVzJywgdGFiLmVsZW1lbnR2UG9ydCk7XG4gICAgICAgICAgICAgICAgICAgIHRhYi52UG9ydFtpbmRleF0gPSB0YWIuZWxlbWVudHZQb3J0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0UGFuZVRhcmdldDogZnVuY3Rpb24gKCRlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gJGVsZW0uZGF0YSgndGFyZ2V0JykgfHwgJGVsZW0uYXR0cignaHJlZicpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRQb3N0YmFja0FjdGl2ZVRhYjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gJ3RhYkFjdGl2ZVBhbmUnO1xuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbS5yZXBsYWNlKC9bXFxbXS8sIFwiXFxcXFxcW1wiKS5yZXBsYWNlKC9bXFxdXS8sIFwiXFxcXFxcXVwiKTtcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJbXFxcXD8mXVwiICsgcGFyYW0gKyBcIj0oW14mI10qKVwiKTtcbiAgICAgICAgICAgIHZhciByZXN1bHRzID0gcmVnZXguZXhlYyhsb2NhdGlvbi5zZWFyY2gpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHMgPT0gbnVsbCA/ICcnIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMV0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xuICAgICAgICB9LFxuICAgICAgICBzZXRQb3N0YmFja0FjdGl2ZVRhYjogZnVuY3Rpb24gKHRhYklEKSB7XG4gICAgICAgICAgICBpZiAodGFiSUQgIT0gJycpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGFjdGl2ZVRhYnMgPSAkKCdhW2RhdGEtc2ltcGxlLXRhYi1pZD1cXCcnICsgdGFiSUQgKyAnXFwnXScpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCRhY3RpdmVUYWJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgJGFjdGl2ZVRhYnMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkYWN0aXZlVGFicy50cmlnZ2VyKCdjbGljaycpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFkZGl0aW9uYWxBamF4U3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB9LFxuICAgICAgICBnZXRDb250ZW50OiBmdW5jdGlvbiAoJGVsZW0pIHtcbiAgICAgICAgICAgIHZhciB0YWJJZCA9ICRlbGVtLmF0dHIoJ2RhdGEtdGFiSWQnKTtcbiAgICAgICAgICAgIHZhciB3aWRnZXRJZCA9ICRlbGVtLmF0dHIoJ2RhdGEtd2lkZ2V0SWQnKTtcbiAgICAgICAgICAgIHZhciBwYkNvbnRleHQgPSBlbmNvZGVVUklDb21wb25lbnQoJCgnbWV0YVtuYW1lPXBiQ29udGV4dF0nKS5hdHRyKCdjb250ZW50JykpO1xuICAgICAgICAgICAgdmFyICR0YWJCb2R5ID0gJGVsZW0ucGFyZW50cygnLnRhYl9fcGFuZScpO1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcGIvd2lkZ2V0cy91eDMvbGF6eVRhYnMvbG9hZFRhYj9wYkNvbnRleHQ9JyArIHBiQ29udGV4dCArICcmdGFiSWQ9JyArIHRhYklkICsgJyZ3aWRnZXRJZD0nICsgd2lkZ2V0SWQsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHRhYkJvZHkuYXR0cignZGF0YS1hamF4TG9hZGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW0ucmVwbGFjZVdpdGgoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkdGFiQm9keS5maW5kKCcudGFiX19wYW5lLmFjdGl2ZScpLmZpbmQoJy50YWItbGF6eScpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLmdldENvbnRlbnQoJHRhYkJvZHkuZmluZCgnLnRhYl9fcGFuZS5hY3RpdmUnKS5maW5kKCcudGFiLWxhenknKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHRhYkJvZHkuZmluZCh0YWIuJHNwaW5uZXIpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgZGlkIG5vdCB1c2UgJChkYXRhKS5maW5kKCkgYmVjYXVzZSB0aGUgZGF0YSBpcyBub3QgYSBET01FbGVtZW50IHRodXMsXG4gICAgICAgICAgICAgICAgICAgIC8vIGFueSBsb2dpYyB3aWxsIGJlIGFkZGVkIC5qcy1zaG93Y2FzZS1zbGlkZXNob3cgd2l0aGluIHRoZSBkYXRhIG5vdCB3aXRoaW4gRE9NLFxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGdldCB0aGUgZWxlbWVudCBmcm9tIHRoZSBET00gdGhhdCdzXG4gICAgICAgICAgICAgICAgICAgIHRhYi5zaG93Y2FzZVNsaWRlc2hvd0NoZWNrKCR0YWJCb2R5LmZpbmQoJy5qcy1zaG93Y2FzZS1zbGlkZXNob3cnKSk7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5hZGRpdGlvbmFsQWpheFN1Y2Nlc3MoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBzaG93Y2FzZVNsaWRlc2hvd0NoZWNrKCRzaG93Q2FzZSl7XG4gICAgICAgICAgICBpZiAoISRzaG93Q2FzZS5sZW5ndGggfHwgIVVYLnNob3djYXNlU2xpZGVzaG93KSB7XG4gICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBVWC5zaG93Y2FzZVNsaWRlc2hvdy5pbml0SW5zdGFuY2UoJHNob3dDYXNlLFVYLnNob3djYXNlU2xpZGVzaG93LmRlZmF1bHRPcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVVgudGFiID0gdGFiOyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRydW5jYXRlciA9IHtcbiAgICAgICAgJHRhcmdldDogJCgnLmpzLS10cnVuY2F0ZScpLFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRydW5jYXRlci50cnVuY2F0ZSgpO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgdHJ1bmNhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRydW5jYXRlci4kdGFyZ2V0LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykudHJ1bmNhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVYLnRydW5jYXRlciA9IHRydW5jYXRlcjtcbn0pKCk7XG4iLCJmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikge1xuICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHtcbiAgICBhcnIyW2ldID0gYXJyW2ldO1xuICB9XG5cbiAgcmV0dXJuIGFycjI7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2FycmF5TGlrZVRvQXJyYXk7IiwidmFyIGFycmF5TGlrZVRvQXJyYXkgPSByZXF1aXJlKFwiLi9hcnJheUxpa2VUb0FycmF5XCIpO1xuXG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnJheUxpa2VUb0FycmF5KGFycik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2FycmF5V2l0aG91dEhvbGVzOyIsImZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2NsYXNzQ2FsbENoZWNrOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gIHJldHVybiBDb25zdHJ1Y3Rvcjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfY3JlYXRlQ2xhc3M7IiwiZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkge1xuICBpZiAoa2V5IGluIG9iaikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwge1xuICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2RlZmluZVByb3BlcnR5OyIsImZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikge1xuICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfaXRlcmFibGVUb0FycmF5OyIsImZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX25vbkl0ZXJhYmxlU3ByZWFkOyIsInZhciBhcnJheVdpdGhvdXRIb2xlcyA9IHJlcXVpcmUoXCIuL2FycmF5V2l0aG91dEhvbGVzXCIpO1xuXG52YXIgaXRlcmFibGVUb0FycmF5ID0gcmVxdWlyZShcIi4vaXRlcmFibGVUb0FycmF5XCIpO1xuXG52YXIgdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkgPSByZXF1aXJlKFwiLi91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheVwiKTtcblxudmFyIG5vbkl0ZXJhYmxlU3ByZWFkID0gcmVxdWlyZShcIi4vbm9uSXRlcmFibGVTcHJlYWRcIik7XG5cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHtcbiAgcmV0dXJuIGFycmF5V2l0aG91dEhvbGVzKGFycikgfHwgaXRlcmFibGVUb0FycmF5KGFycikgfHwgdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBub25JdGVyYWJsZVNwcmVhZCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF90b0NvbnN1bWFibGVBcnJheTsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikge1xuICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cbiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xuICAgIH07XG4gIH1cblxuICByZXR1cm4gX3R5cGVvZihvYmopO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF90eXBlb2Y7IiwidmFyIGFycmF5TGlrZVRvQXJyYXkgPSByZXF1aXJlKFwiLi9hcnJheUxpa2VUb0FycmF5XCIpO1xuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7XG4gIGlmICghbykgcmV0dXJuO1xuICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBhcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG4gIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcbiAgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTtcbiAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7XG4gIGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoU3RyaW5nKGl0KSArICcgaXMgbm90IGEgZnVuY3Rpb24nKTtcbiAgfSByZXR1cm4gaXQ7XG59O1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLW9iamVjdCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoIWlzT2JqZWN0KGl0KSAmJiBpdCAhPT0gbnVsbCkge1xuICAgIHRocm93IFR5cGVFcnJvcihcIkNhbid0IHNldCBcIiArIFN0cmluZyhpdCkgKyAnIGFzIGEgcHJvdG90eXBlJyk7XG4gIH0gcmV0dXJuIGl0O1xufTtcbiIsInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pcy1vYmplY3QnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKCFpc09iamVjdChpdCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoU3RyaW5nKGl0KSArICcgaXMgbm90IGFuIG9iamVjdCcpO1xuICB9IHJldHVybiBpdDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgYmluZCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mdW5jdGlvbi1iaW5kLWNvbnRleHQnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1vYmplY3QnKTtcbnZhciBjYWxsV2l0aFNhZmVJdGVyYXRpb25DbG9zaW5nID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NhbGwtd2l0aC1zYWZlLWl0ZXJhdGlvbi1jbG9zaW5nJyk7XG52YXIgaXNBcnJheUl0ZXJhdG9yTWV0aG9kID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLWFycmF5LWl0ZXJhdG9yLW1ldGhvZCcpO1xudmFyIHRvTGVuZ3RoID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3RvLWxlbmd0aCcpO1xudmFyIGNyZWF0ZVByb3BlcnR5ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NyZWF0ZS1wcm9wZXJ0eScpO1xudmFyIGdldEl0ZXJhdG9yTWV0aG9kID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dldC1pdGVyYXRvci1tZXRob2QnKTtcblxuLy8gYEFycmF5LmZyb21gIG1ldGhvZCBpbXBsZW1lbnRhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5mcm9tXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGZyb20oYXJyYXlMaWtlIC8qICwgbWFwZm4gPSB1bmRlZmluZWQsIHRoaXNBcmcgPSB1bmRlZmluZWQgKi8pIHtcbiAgdmFyIE8gPSB0b09iamVjdChhcnJheUxpa2UpO1xuICB2YXIgQyA9IHR5cGVvZiB0aGlzID09ICdmdW5jdGlvbicgPyB0aGlzIDogQXJyYXk7XG4gIHZhciBhcmd1bWVudHNMZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICB2YXIgbWFwZm4gPSBhcmd1bWVudHNMZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICB2YXIgbWFwcGluZyA9IG1hcGZuICE9PSB1bmRlZmluZWQ7XG4gIHZhciBpdGVyYXRvck1ldGhvZCA9IGdldEl0ZXJhdG9yTWV0aG9kKE8pO1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIgbGVuZ3RoLCByZXN1bHQsIHN0ZXAsIGl0ZXJhdG9yLCBuZXh0LCB2YWx1ZTtcbiAgaWYgKG1hcHBpbmcpIG1hcGZuID0gYmluZChtYXBmbiwgYXJndW1lbnRzTGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZCwgMik7XG4gIC8vIGlmIHRoZSB0YXJnZXQgaXMgbm90IGl0ZXJhYmxlIG9yIGl0J3MgYW4gYXJyYXkgd2l0aCB0aGUgZGVmYXVsdCBpdGVyYXRvciAtIHVzZSBhIHNpbXBsZSBjYXNlXG4gIGlmIChpdGVyYXRvck1ldGhvZCAhPSB1bmRlZmluZWQgJiYgIShDID09IEFycmF5ICYmIGlzQXJyYXlJdGVyYXRvck1ldGhvZChpdGVyYXRvck1ldGhvZCkpKSB7XG4gICAgaXRlcmF0b3IgPSBpdGVyYXRvck1ldGhvZC5jYWxsKE8pO1xuICAgIG5leHQgPSBpdGVyYXRvci5uZXh0O1xuICAgIHJlc3VsdCA9IG5ldyBDKCk7XG4gICAgZm9yICg7IShzdGVwID0gbmV4dC5jYWxsKGl0ZXJhdG9yKSkuZG9uZTsgaW5kZXgrKykge1xuICAgICAgdmFsdWUgPSBtYXBwaW5nID8gY2FsbFdpdGhTYWZlSXRlcmF0aW9uQ2xvc2luZyhpdGVyYXRvciwgbWFwZm4sIFtzdGVwLnZhbHVlLCBpbmRleF0sIHRydWUpIDogc3RlcC52YWx1ZTtcbiAgICAgIGNyZWF0ZVByb3BlcnR5KHJlc3VsdCwgaW5kZXgsIHZhbHVlKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHJlc3VsdCA9IG5ldyBDKGxlbmd0aCk7XG4gICAgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHtcbiAgICAgIHZhbHVlID0gbWFwcGluZyA/IG1hcGZuKE9baW5kZXhdLCBpbmRleCkgOiBPW2luZGV4XTtcbiAgICAgIGNyZWF0ZVByb3BlcnR5KHJlc3VsdCwgaW5kZXgsIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmVzdWx0Lmxlbmd0aCA9IGluZGV4O1xuICByZXR1cm4gcmVzdWx0O1xufTtcbiIsInZhciB0b0luZGV4ZWRPYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8taW5kZXhlZC1vYmplY3QnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1sZW5ndGgnKTtcbnZhciB0b0Fic29sdXRlSW5kZXggPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8tYWJzb2x1dGUtaW5kZXgnKTtcblxuLy8gYEFycmF5LnByb3RvdHlwZS57IGluZGV4T2YsIGluY2x1ZGVzIH1gIG1ldGhvZHMgaW1wbGVtZW50YXRpb25cbnZhciBjcmVhdGVNZXRob2QgPSBmdW5jdGlvbiAoSVNfSU5DTFVERVMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgZWwsIGZyb21JbmRleCkge1xuICAgIHZhciBPID0gdG9JbmRleGVkT2JqZWN0KCR0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IHRvQWJzb2x1dGVJbmRleChmcm9tSW5kZXgsIGxlbmd0aCk7XG4gICAgdmFyIHZhbHVlO1xuICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgaWYgKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKSB3aGlsZSAobGVuZ3RoID4gaW5kZXgpIHtcbiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICAgIGlmICh2YWx1ZSAhPSB2YWx1ZSkgcmV0dXJuIHRydWU7XG4gICAgLy8gQXJyYXkjaW5kZXhPZiBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdFxuICAgIH0gZWxzZSBmb3IgKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKykge1xuICAgICAgaWYgKChJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKSAmJiBPW2luZGV4XSA9PT0gZWwpIHJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwO1xuICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTtcbiAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAvLyBgQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzYCBtZXRob2RcbiAgLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUuaW5jbHVkZXNcbiAgaW5jbHVkZXM6IGNyZWF0ZU1ldGhvZCh0cnVlKSxcbiAgLy8gYEFycmF5LnByb3RvdHlwZS5pbmRleE9mYCBtZXRob2RcbiAgLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUuaW5kZXhvZlxuICBpbmRleE9mOiBjcmVhdGVNZXRob2QoZmFsc2UpXG59O1xuIiwidmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIGl0ZXJhdG9yQ2xvc2UgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXRlcmF0b3ItY2xvc2UnKTtcblxuLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmF0b3IsIGZuLCB2YWx1ZSwgRU5UUklFUykge1xuICB0cnkge1xuICAgIHJldHVybiBFTlRSSUVTID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7XG4gIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaXRlcmF0b3JDbG9zZShpdGVyYXRvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG4iLCJ2YXIgd2VsbEtub3duU3ltYm9sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3dlbGwta25vd24tc3ltYm9sJyk7XG5cbnZhciBJVEVSQVRPUiA9IHdlbGxLbm93blN5bWJvbCgnaXRlcmF0b3InKTtcbnZhciBTQUZFX0NMT1NJTkcgPSBmYWxzZTtcblxudHJ5IHtcbiAgdmFyIGNhbGxlZCA9IDA7XG4gIHZhciBpdGVyYXRvcldpdGhSZXR1cm4gPSB7XG4gICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHsgZG9uZTogISFjYWxsZWQrKyB9O1xuICAgIH0sXG4gICAgJ3JldHVybic6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFNBRkVfQ0xPU0lORyA9IHRydWU7XG4gICAgfVxuICB9O1xuICBpdGVyYXRvcldpdGhSZXR1cm5bSVRFUkFUT1JdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdGhyb3ctbGl0ZXJhbFxuICBBcnJheS5mcm9tKGl0ZXJhdG9yV2l0aFJldHVybiwgZnVuY3Rpb24gKCkgeyB0aHJvdyAyOyB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7IC8qIGVtcHR5ICovIH1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZXhlYywgU0tJUF9DTE9TSU5HKSB7XG4gIGlmICghU0tJUF9DTE9TSU5HICYmICFTQUZFX0NMT1NJTkcpIHJldHVybiBmYWxzZTtcbiAgdmFyIElURVJBVElPTl9TVVBQT1JUID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgdmFyIG9iamVjdCA9IHt9O1xuICAgIG9iamVjdFtJVEVSQVRPUl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHsgZG9uZTogSVRFUkFUSU9OX1NVUFBPUlQgPSB0cnVlIH07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfTtcbiAgICBleGVjKG9iamVjdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7IC8qIGVtcHR5ICovIH1cbiAgcmV0dXJuIElURVJBVElPTl9TVVBQT1JUO1xufTtcbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpO1xufTtcbiIsInZhciBUT19TVFJJTkdfVEFHX1NVUFBPUlQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8tc3RyaW5nLXRhZy1zdXBwb3J0Jyk7XG52YXIgY2xhc3NvZlJhdyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jbGFzc29mLXJhdycpO1xudmFyIHdlbGxLbm93blN5bWJvbCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy93ZWxsLWtub3duLXN5bWJvbCcpO1xuXG52YXIgVE9fU1RSSU5HX1RBRyA9IHdlbGxLbm93blN5bWJvbCgndG9TdHJpbmdUYWcnKTtcbi8vIEVTMyB3cm9uZyBoZXJlXG52YXIgQ09SUkVDVF9BUkdVTUVOVFMgPSBjbGFzc29mUmF3KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJztcblxuLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3JcbnZhciB0cnlHZXQgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICB0cnkge1xuICAgIHJldHVybiBpdFtrZXldO1xuICB9IGNhdGNoIChlcnJvcikgeyAvKiBlbXB0eSAqLyB9XG59O1xuXG4vLyBnZXR0aW5nIHRhZyBmcm9tIEVTNisgYE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdgXG5tb2R1bGUuZXhwb3J0cyA9IFRPX1NUUklOR19UQUdfU1VQUE9SVCA/IGNsYXNzb2ZSYXcgOiBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIE8sIHRhZywgcmVzdWx0O1xuICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCdcbiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2VcbiAgICA6IHR5cGVvZiAodGFnID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUT19TVFJJTkdfVEFHKSkgPT0gJ3N0cmluZycgPyB0YWdcbiAgICAvLyBidWlsdGluVGFnIGNhc2VcbiAgICA6IENPUlJFQ1RfQVJHVU1FTlRTID8gY2xhc3NvZlJhdyhPKVxuICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2tcbiAgICA6IChyZXN1bHQgPSBjbGFzc29mUmF3KE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogcmVzdWx0O1xufTtcbiIsInZhciBoYXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGFzJyk7XG52YXIgb3duS2V5cyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vd24ta2V5cycpO1xudmFyIGdldE93blByb3BlcnR5RGVzY3JpcHRvck1vZHVsZSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vYmplY3QtZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7XG52YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0YXJnZXQsIHNvdXJjZSkge1xuICB2YXIga2V5cyA9IG93bktleXMoc291cmNlKTtcbiAgdmFyIGRlZmluZVByb3BlcnR5ID0gZGVmaW5lUHJvcGVydHlNb2R1bGUuZjtcbiAgdmFyIGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGdldE93blByb3BlcnR5RGVzY3JpcHRvck1vZHVsZS5mO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICBpZiAoIWhhcyh0YXJnZXQsIGtleSkpIGRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTtcbiAgfVxufTtcbiIsInZhciBmYWlscyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mYWlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9ICFmYWlscyhmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEYoKSB7IC8qIGVtcHR5ICovIH1cbiAgRi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBudWxsO1xuICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKG5ldyBGKCkpICE9PSBGLnByb3RvdHlwZTtcbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIEl0ZXJhdG9yUHJvdG90eXBlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2l0ZXJhdG9ycy1jb3JlJykuSXRlcmF0b3JQcm90b3R5cGU7XG52YXIgY3JlYXRlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1jcmVhdGUnKTtcbnZhciBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvY3JlYXRlLXByb3BlcnR5LWRlc2NyaXB0b3InKTtcbnZhciBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9zZXQtdG8tc3RyaW5nLXRhZycpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pdGVyYXRvcnMnKTtcblxudmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChJdGVyYXRvckNvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KSB7XG4gIHZhciBUT19TVFJJTkdfVEFHID0gTkFNRSArICcgSXRlcmF0b3InO1xuICBJdGVyYXRvckNvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwgeyBuZXh0OiBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMSwgbmV4dCkgfSk7XG4gIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yQ29uc3RydWN0b3IsIFRPX1NUUklOR19UQUcsIGZhbHNlLCB0cnVlKTtcbiAgSXRlcmF0b3JzW1RPX1NUUklOR19UQUddID0gcmV0dXJuVGhpcztcbiAgcmV0dXJuIEl0ZXJhdG9yQ29uc3RydWN0b3I7XG59O1xuIiwidmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2Rlc2NyaXB0b3JzJyk7XG52YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eScpO1xudmFyIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jcmVhdGUtcHJvcGVydHktZGVzY3JpcHRvcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERFU0NSSVBUT1JTID8gZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICByZXR1cm4gZGVmaW5lUHJvcGVydHlNb2R1bGUuZihvYmplY3QsIGtleSwgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDEsIHZhbHVlKSk7XG59IDogZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICByZXR1cm4gb2JqZWN0O1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJpdG1hcCwgdmFsdWUpIHtcbiAgcmV0dXJuIHtcbiAgICBlbnVtZXJhYmxlOiAhKGJpdG1hcCAmIDEpLFxuICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSxcbiAgICB3cml0YWJsZTogIShiaXRtYXAgJiA0KSxcbiAgICB2YWx1ZTogdmFsdWVcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8tcHJpbWl0aXZlJyk7XG52YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eScpO1xudmFyIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jcmVhdGUtcHJvcGVydHktZGVzY3JpcHRvcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgdmFyIHByb3BlcnR5S2V5ID0gdG9QcmltaXRpdmUoa2V5KTtcbiAgaWYgKHByb3BlcnR5S2V5IGluIG9iamVjdCkgZGVmaW5lUHJvcGVydHlNb2R1bGUuZihvYmplY3QsIHByb3BlcnR5S2V5LCBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMCwgdmFsdWUpKTtcbiAgZWxzZSBvYmplY3RbcHJvcGVydHlLZXldID0gdmFsdWU7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyICQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZXhwb3J0Jyk7XG52YXIgY3JlYXRlSXRlcmF0b3JDb25zdHJ1Y3RvciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jcmVhdGUtaXRlcmF0b3ItY29uc3RydWN0b3InKTtcbnZhciBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vYmplY3QtZ2V0LXByb3RvdHlwZS1vZicpO1xudmFyIHNldFByb3RvdHlwZU9mID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1zZXQtcHJvdG90eXBlLW9mJyk7XG52YXIgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2V0LXRvLXN0cmluZy10YWcnKTtcbnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvY3JlYXRlLW5vbi1lbnVtZXJhYmxlLXByb3BlcnR5Jyk7XG52YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvcmVkZWZpbmUnKTtcbnZhciB3ZWxsS25vd25TeW1ib2wgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvd2VsbC1rbm93bi1zeW1ib2wnKTtcbnZhciBJU19QVVJFID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLXB1cmUnKTtcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXRlcmF0b3JzJyk7XG52YXIgSXRlcmF0b3JzQ29yZSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pdGVyYXRvcnMtY29yZScpO1xuXG52YXIgSXRlcmF0b3JQcm90b3R5cGUgPSBJdGVyYXRvcnNDb3JlLkl0ZXJhdG9yUHJvdG90eXBlO1xudmFyIEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgPSBJdGVyYXRvcnNDb3JlLkJVR0dZX1NBRkFSSV9JVEVSQVRPUlM7XG52YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7XG52YXIgS0VZUyA9ICdrZXlzJztcbnZhciBWQUxVRVMgPSAndmFsdWVzJztcbnZhciBFTlRSSUVTID0gJ2VudHJpZXMnO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEl0ZXJhYmxlLCBOQU1FLCBJdGVyYXRvckNvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCkge1xuICBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yKEl0ZXJhdG9yQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpO1xuXG4gIHZhciBnZXRJdGVyYXRpb25NZXRob2QgPSBmdW5jdGlvbiAoS0lORCkge1xuICAgIGlmIChLSU5EID09PSBERUZBVUxUICYmIGRlZmF1bHRJdGVyYXRvcikgcmV0dXJuIGRlZmF1bHRJdGVyYXRvcjtcbiAgICBpZiAoIUJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgJiYgS0lORCBpbiBJdGVyYWJsZVByb3RvdHlwZSkgcmV0dXJuIEl0ZXJhYmxlUHJvdG90eXBlW0tJTkRdO1xuICAgIHN3aXRjaCAoS0lORCkge1xuICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsgcmV0dXJuIG5ldyBJdGVyYXRvckNvbnN0cnVjdG9yKHRoaXMsIEtJTkQpOyB9O1xuICAgICAgY2FzZSBWQUxVRVM6IHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKSB7IHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsgfTtcbiAgICAgIGNhc2UgRU5UUklFUzogcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKSB7IHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsgfTtcbiAgICB9IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzKTsgfTtcbiAgfTtcblxuICB2YXIgVE9fU1RSSU5HX1RBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJztcbiAgdmFyIElOQ09SUkVDVF9WQUxVRVNfTkFNRSA9IGZhbHNlO1xuICB2YXIgSXRlcmFibGVQcm90b3R5cGUgPSBJdGVyYWJsZS5wcm90b3R5cGU7XG4gIHZhciBuYXRpdmVJdGVyYXRvciA9IEl0ZXJhYmxlUHJvdG90eXBlW0lURVJBVE9SXVxuICAgIHx8IEl0ZXJhYmxlUHJvdG90eXBlWydAQGl0ZXJhdG9yJ11cbiAgICB8fCBERUZBVUxUICYmIEl0ZXJhYmxlUHJvdG90eXBlW0RFRkFVTFRdO1xuICB2YXIgZGVmYXVsdEl0ZXJhdG9yID0gIUJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgJiYgbmF0aXZlSXRlcmF0b3IgfHwgZ2V0SXRlcmF0aW9uTWV0aG9kKERFRkFVTFQpO1xuICB2YXIgYW55TmF0aXZlSXRlcmF0b3IgPSBOQU1FID09ICdBcnJheScgPyBJdGVyYWJsZVByb3RvdHlwZS5lbnRyaWVzIHx8IG5hdGl2ZUl0ZXJhdG9yIDogbmF0aXZlSXRlcmF0b3I7XG4gIHZhciBDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUsIG1ldGhvZHMsIEtFWTtcblxuICAvLyBmaXggbmF0aXZlXG4gIGlmIChhbnlOYXRpdmVJdGVyYXRvcikge1xuICAgIEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKGFueU5hdGl2ZUl0ZXJhdG9yLmNhbGwobmV3IEl0ZXJhYmxlKCkpKTtcbiAgICBpZiAoSXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUgJiYgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHtcbiAgICAgIGlmICghSVNfUFVSRSAmJiBnZXRQcm90b3R5cGVPZihDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUpICE9PSBJdGVyYXRvclByb3RvdHlwZSkge1xuICAgICAgICBpZiAoc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgICAgICBzZXRQcm90b3R5cGVPZihDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUsIEl0ZXJhdG9yUHJvdG90eXBlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5KEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzXG4gICAgICBzZXRUb1N0cmluZ1RhZyhDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUsIFRPX1NUUklOR19UQUcsIHRydWUsIHRydWUpO1xuICAgICAgaWYgKElTX1BVUkUpIEl0ZXJhdG9yc1tUT19TVFJJTkdfVEFHXSA9IHJldHVyblRoaXM7XG4gICAgfVxuICB9XG5cbiAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRlxuICBpZiAoREVGQVVMVCA9PSBWQUxVRVMgJiYgbmF0aXZlSXRlcmF0b3IgJiYgbmF0aXZlSXRlcmF0b3IubmFtZSAhPT0gVkFMVUVTKSB7XG4gICAgSU5DT1JSRUNUX1ZBTFVFU19OQU1FID0gdHJ1ZTtcbiAgICBkZWZhdWx0SXRlcmF0b3IgPSBmdW5jdGlvbiB2YWx1ZXMoKSB7IHJldHVybiBuYXRpdmVJdGVyYXRvci5jYWxsKHRoaXMpOyB9O1xuICB9XG5cbiAgLy8gZGVmaW5lIGl0ZXJhdG9yXG4gIGlmICgoIUlTX1BVUkUgfHwgRk9SQ0VEKSAmJiBJdGVyYWJsZVByb3RvdHlwZVtJVEVSQVRPUl0gIT09IGRlZmF1bHRJdGVyYXRvcikge1xuICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShJdGVyYWJsZVByb3RvdHlwZSwgSVRFUkFUT1IsIGRlZmF1bHRJdGVyYXRvcik7XG4gIH1cbiAgSXRlcmF0b3JzW05BTUVdID0gZGVmYXVsdEl0ZXJhdG9yO1xuXG4gIC8vIGV4cG9ydCBhZGRpdGlvbmFsIG1ldGhvZHNcbiAgaWYgKERFRkFVTFQpIHtcbiAgICBtZXRob2RzID0ge1xuICAgICAgdmFsdWVzOiBnZXRJdGVyYXRpb25NZXRob2QoVkFMVUVTKSxcbiAgICAgIGtleXM6IElTX1NFVCA/IGRlZmF1bHRJdGVyYXRvciA6IGdldEl0ZXJhdGlvbk1ldGhvZChLRVlTKSxcbiAgICAgIGVudHJpZXM6IGdldEl0ZXJhdGlvbk1ldGhvZChFTlRSSUVTKVxuICAgIH07XG4gICAgaWYgKEZPUkNFRCkgZm9yIChLRVkgaW4gbWV0aG9kcykge1xuICAgICAgaWYgKEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgfHwgSU5DT1JSRUNUX1ZBTFVFU19OQU1FIHx8ICEoS0VZIGluIEl0ZXJhYmxlUHJvdG90eXBlKSkge1xuICAgICAgICByZWRlZmluZShJdGVyYWJsZVByb3RvdHlwZSwgS0VZLCBtZXRob2RzW0tFWV0pO1xuICAgICAgfVxuICAgIH0gZWxzZSAkKHsgdGFyZ2V0OiBOQU1FLCBwcm90bzogdHJ1ZSwgZm9yY2VkOiBCVUdHWV9TQUZBUklfSVRFUkFUT1JTIHx8IElOQ09SUkVDVF9WQUxVRVNfTkFNRSB9LCBtZXRob2RzKTtcbiAgfVxuXG4gIHJldHVybiBtZXRob2RzO1xufTtcbiIsInZhciBmYWlscyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mYWlscycpO1xuXG4vLyBEZXRlY3QgSUU4J3MgaW5jb21wbGV0ZSBkZWZpbmVQcm9wZXJ0eSBpbXBsZW1lbnRhdGlvblxubW9kdWxlLmV4cG9ydHMgPSAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAxLCB7IGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gNzsgfSB9KVsxXSAhPSA3O1xufSk7XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLW9iamVjdCcpO1xuXG52YXIgZG9jdW1lbnQgPSBnbG9iYWwuZG9jdW1lbnQ7XG4vLyB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JyBpbiBvbGQgSUVcbnZhciBFWElTVFMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBFWElTVFMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9O1xufTtcbiIsIi8vIElFOC0gZG9uJ3QgZW51bSBidWcga2V5c1xubW9kdWxlLmV4cG9ydHMgPSBbXG4gICdjb25zdHJ1Y3RvcicsXG4gICdoYXNPd25Qcm9wZXJ0eScsXG4gICdpc1Byb3RvdHlwZU9mJyxcbiAgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcbiAgJ3RvTG9jYWxlU3RyaW5nJyxcbiAgJ3RvU3RyaW5nJyxcbiAgJ3ZhbHVlT2YnXG5dO1xuIiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9nbG9iYWwnKTtcbnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcicpLmY7XG52YXIgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NyZWF0ZS1ub24tZW51bWVyYWJsZS1wcm9wZXJ0eScpO1xudmFyIHJlZGVmaW5lID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3JlZGVmaW5lJyk7XG52YXIgc2V0R2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3NldC1nbG9iYWwnKTtcbnZhciBjb3B5Q29uc3RydWN0b3JQcm9wZXJ0aWVzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NvcHktY29uc3RydWN0b3ItcHJvcGVydGllcycpO1xudmFyIGlzRm9yY2VkID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLWZvcmNlZCcpO1xuXG4vKlxuICBvcHRpb25zLnRhcmdldCAgICAgIC0gbmFtZSBvZiB0aGUgdGFyZ2V0IG9iamVjdFxuICBvcHRpb25zLmdsb2JhbCAgICAgIC0gdGFyZ2V0IGlzIHRoZSBnbG9iYWwgb2JqZWN0XG4gIG9wdGlvbnMuc3RhdCAgICAgICAgLSBleHBvcnQgYXMgc3RhdGljIG1ldGhvZHMgb2YgdGFyZ2V0XG4gIG9wdGlvbnMucHJvdG8gICAgICAgLSBleHBvcnQgYXMgcHJvdG90eXBlIG1ldGhvZHMgb2YgdGFyZ2V0XG4gIG9wdGlvbnMucmVhbCAgICAgICAgLSByZWFsIHByb3RvdHlwZSBtZXRob2QgZm9yIHRoZSBgcHVyZWAgdmVyc2lvblxuICBvcHRpb25zLmZvcmNlZCAgICAgIC0gZXhwb3J0IGV2ZW4gaWYgdGhlIG5hdGl2ZSBmZWF0dXJlIGlzIGF2YWlsYWJsZVxuICBvcHRpb25zLmJpbmQgICAgICAgIC0gYmluZCBtZXRob2RzIHRvIHRoZSB0YXJnZXQsIHJlcXVpcmVkIGZvciB0aGUgYHB1cmVgIHZlcnNpb25cbiAgb3B0aW9ucy53cmFwICAgICAgICAtIHdyYXAgY29uc3RydWN0b3JzIHRvIHByZXZlbnRpbmcgZ2xvYmFsIHBvbGx1dGlvbiwgcmVxdWlyZWQgZm9yIHRoZSBgcHVyZWAgdmVyc2lvblxuICBvcHRpb25zLnVuc2FmZSAgICAgIC0gdXNlIHRoZSBzaW1wbGUgYXNzaWdubWVudCBvZiBwcm9wZXJ0eSBpbnN0ZWFkIG9mIGRlbGV0ZSArIGRlZmluZVByb3BlcnR5XG4gIG9wdGlvbnMuc2hhbSAgICAgICAgLSBhZGQgYSBmbGFnIHRvIG5vdCBjb21wbGV0ZWx5IGZ1bGwgcG9seWZpbGxzXG4gIG9wdGlvbnMuZW51bWVyYWJsZSAgLSBleHBvcnQgYXMgZW51bWVyYWJsZSBwcm9wZXJ0eVxuICBvcHRpb25zLm5vVGFyZ2V0R2V0IC0gcHJldmVudCBjYWxsaW5nIGEgZ2V0dGVyIG9uIHRhcmdldFxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9wdGlvbnMsIHNvdXJjZSkge1xuICB2YXIgVEFSR0VUID0gb3B0aW9ucy50YXJnZXQ7XG4gIHZhciBHTE9CQUwgPSBvcHRpb25zLmdsb2JhbDtcbiAgdmFyIFNUQVRJQyA9IG9wdGlvbnMuc3RhdDtcbiAgdmFyIEZPUkNFRCwgdGFyZ2V0LCBrZXksIHRhcmdldFByb3BlcnR5LCBzb3VyY2VQcm9wZXJ0eSwgZGVzY3JpcHRvcjtcbiAgaWYgKEdMT0JBTCkge1xuICAgIHRhcmdldCA9IGdsb2JhbDtcbiAgfSBlbHNlIGlmIChTVEFUSUMpIHtcbiAgICB0YXJnZXQgPSBnbG9iYWxbVEFSR0VUXSB8fCBzZXRHbG9iYWwoVEFSR0VULCB7fSk7XG4gIH0gZWxzZSB7XG4gICAgdGFyZ2V0ID0gKGdsb2JhbFtUQVJHRVRdIHx8IHt9KS5wcm90b3R5cGU7XG4gIH1cbiAgaWYgKHRhcmdldCkgZm9yIChrZXkgaW4gc291cmNlKSB7XG4gICAgc291cmNlUHJvcGVydHkgPSBzb3VyY2Vba2V5XTtcbiAgICBpZiAob3B0aW9ucy5ub1RhcmdldEdldCkge1xuICAgICAgZGVzY3JpcHRvciA9IGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSk7XG4gICAgICB0YXJnZXRQcm9wZXJ0eSA9IGRlc2NyaXB0b3IgJiYgZGVzY3JpcHRvci52YWx1ZTtcbiAgICB9IGVsc2UgdGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRba2V5XTtcbiAgICBGT1JDRUQgPSBpc0ZvcmNlZChHTE9CQUwgPyBrZXkgOiBUQVJHRVQgKyAoU1RBVElDID8gJy4nIDogJyMnKSArIGtleSwgb3B0aW9ucy5mb3JjZWQpO1xuICAgIC8vIGNvbnRhaW5lZCBpbiB0YXJnZXRcbiAgICBpZiAoIUZPUkNFRCAmJiB0YXJnZXRQcm9wZXJ0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAodHlwZW9mIHNvdXJjZVByb3BlcnR5ID09PSB0eXBlb2YgdGFyZ2V0UHJvcGVydHkpIGNvbnRpbnVlO1xuICAgICAgY29weUNvbnN0cnVjdG9yUHJvcGVydGllcyhzb3VyY2VQcm9wZXJ0eSwgdGFyZ2V0UHJvcGVydHkpO1xuICAgIH1cbiAgICAvLyBhZGQgYSBmbGFnIHRvIG5vdCBjb21wbGV0ZWx5IGZ1bGwgcG9seWZpbGxzXG4gICAgaWYgKG9wdGlvbnMuc2hhbSB8fCAodGFyZ2V0UHJvcGVydHkgJiYgdGFyZ2V0UHJvcGVydHkuc2hhbSkpIHtcbiAgICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShzb3VyY2VQcm9wZXJ0eSwgJ3NoYW0nLCB0cnVlKTtcbiAgICB9XG4gICAgLy8gZXh0ZW5kIGdsb2JhbFxuICAgIHJlZGVmaW5lKHRhcmdldCwga2V5LCBzb3VyY2VQcm9wZXJ0eSwgb3B0aW9ucyk7XG4gIH1cbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChleGVjKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuICEhZXhlYygpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuIiwidmFyIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hLWZ1bmN0aW9uJyk7XG5cbi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZ1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZm4sIHRoYXQsIGxlbmd0aCkge1xuICBhRnVuY3Rpb24oZm4pO1xuICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZm47XG4gIHN3aXRjaCAobGVuZ3RoKSB7XG4gICAgY2FzZSAwOiByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCk7XG4gICAgfTtcbiAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7XG4gICAgfTtcbiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7XG4gICAgfTtcbiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gKC8qIC4uLmFyZ3MgKi8pIHtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgfTtcbn07XG4iLCJ2YXIgcGF0aCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9wYXRoJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xuXG52YXIgYUZ1bmN0aW9uID0gZnVuY3Rpb24gKHZhcmlhYmxlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFyaWFibGUgPT0gJ2Z1bmN0aW9uJyA/IHZhcmlhYmxlIDogdW5kZWZpbmVkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZXNwYWNlLCBtZXRob2QpIHtcbiAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gYUZ1bmN0aW9uKHBhdGhbbmFtZXNwYWNlXSkgfHwgYUZ1bmN0aW9uKGdsb2JhbFtuYW1lc3BhY2VdKVxuICAgIDogcGF0aFtuYW1lc3BhY2VdICYmIHBhdGhbbmFtZXNwYWNlXVttZXRob2RdIHx8IGdsb2JhbFtuYW1lc3BhY2VdICYmIGdsb2JhbFtuYW1lc3BhY2VdW21ldGhvZF07XG59O1xuIiwidmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvY2xhc3NvZicpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pdGVyYXRvcnMnKTtcbnZhciB3ZWxsS25vd25TeW1ib2wgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvd2VsbC1rbm93bi1zeW1ib2wnKTtcblxudmFyIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCdpdGVyYXRvcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgIT0gdW5kZWZpbmVkKSByZXR1cm4gaXRbSVRFUkFUT1JdXG4gICAgfHwgaXRbJ0BAaXRlcmF0b3InXVxuICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07XG59O1xuIiwidmFyIGNoZWNrID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCAmJiBpdC5NYXRoID09IE1hdGggJiYgaXQ7XG59O1xuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxubW9kdWxlLmV4cG9ydHMgPVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgY2hlY2sodHlwZW9mIGdsb2JhbFRoaXMgPT0gJ29iamVjdCcgJiYgZ2xvYmFsVGhpcykgfHxcbiAgY2hlY2sodHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cpIHx8XG4gIGNoZWNrKHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIHNlbGYpIHx8XG4gIGNoZWNrKHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsKSB8fFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmNcbiAgKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pKCkgfHwgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbiIsInZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwga2V5KSB7XG4gIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0ge307XG4iLCJ2YXIgZ2V0QnVpbHRJbiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9nZXQtYnVpbHQtaW4nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRCdWlsdEluKCdkb2N1bWVudCcsICdkb2N1bWVudEVsZW1lbnQnKTtcbiIsInZhciBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9kZXNjcmlwdG9ycycpO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2ZhaWxzJyk7XG52YXIgY3JlYXRlRWxlbWVudCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9kb2N1bWVudC1jcmVhdGUtZWxlbWVudCcpO1xuXG4vLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5XG5tb2R1bGUuZXhwb3J0cyA9ICFERVNDUklQVE9SUyAmJiAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGNyZWF0ZUVsZW1lbnQoJ2RpdicpLCAnYScsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH1cbiAgfSkuYSAhPSA3O1xufSk7XG4iLCJ2YXIgZmFpbHMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZmFpbHMnKTtcbnZhciBjbGFzc29mID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NsYXNzb2YtcmF3Jyk7XG5cbnZhciBzcGxpdCA9ICcnLnNwbGl0O1xuXG4vLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5nc1xubW9kdWxlLmV4cG9ydHMgPSBmYWlscyhmdW5jdGlvbiAoKSB7XG4gIC8vIHRocm93cyBhbiBlcnJvciBpbiByaGlubywgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL3JoaW5vL2lzc3Vlcy8zNDZcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xuICByZXR1cm4gIU9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApO1xufSkgPyBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGNsYXNzb2YoaXQpID09ICdTdHJpbmcnID8gc3BsaXQuY2FsbChpdCwgJycpIDogT2JqZWN0KGl0KTtcbn0gOiBPYmplY3Q7XG4iLCJ2YXIgc3RvcmUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2hhcmVkLXN0b3JlJyk7XG5cbnZhciBmdW5jdGlvblRvU3RyaW5nID0gRnVuY3Rpb24udG9TdHJpbmc7XG5cbi8vIHRoaXMgaGVscGVyIGJyb2tlbiBpbiBgMy40LjEtMy40LjRgLCBzbyB3ZSBjYW4ndCB1c2UgYHNoYXJlZGAgaGVscGVyXG5pZiAodHlwZW9mIHN0b3JlLmluc3BlY3RTb3VyY2UgIT0gJ2Z1bmN0aW9uJykge1xuICBzdG9yZS5pbnNwZWN0U291cmNlID0gZnVuY3Rpb24gKGl0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uVG9TdHJpbmcuY2FsbChpdCk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RvcmUuaW5zcGVjdFNvdXJjZTtcbiIsInZhciBOQVRJVkVfV0VBS19NQVAgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvbmF0aXZlLXdlYWstbWFwJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLW9iamVjdCcpO1xudmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jcmVhdGUtbm9uLWVudW1lcmFibGUtcHJvcGVydHknKTtcbnZhciBvYmplY3RIYXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGFzJyk7XG52YXIgc2hhcmVkID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3NoYXJlZC1zdG9yZScpO1xudmFyIHNoYXJlZEtleSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9zaGFyZWQta2V5Jyk7XG52YXIgaGlkZGVuS2V5cyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9oaWRkZW4ta2V5cycpO1xuXG52YXIgV2Vha01hcCA9IGdsb2JhbC5XZWFrTWFwO1xudmFyIHNldCwgZ2V0LCBoYXM7XG5cbnZhciBlbmZvcmNlID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBoYXMoaXQpID8gZ2V0KGl0KSA6IHNldChpdCwge30pO1xufTtcblxudmFyIGdldHRlckZvciA9IGZ1bmN0aW9uIChUWVBFKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoaXQpIHtcbiAgICB2YXIgc3RhdGU7XG4gICAgaWYgKCFpc09iamVjdChpdCkgfHwgKHN0YXRlID0gZ2V0KGl0KSkudHlwZSAhPT0gVFlQRSkge1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCdJbmNvbXBhdGlibGUgcmVjZWl2ZXIsICcgKyBUWVBFICsgJyByZXF1aXJlZCcpO1xuICAgIH0gcmV0dXJuIHN0YXRlO1xuICB9O1xufTtcblxuaWYgKE5BVElWRV9XRUFLX01BUCkge1xuICB2YXIgc3RvcmUgPSBzaGFyZWQuc3RhdGUgfHwgKHNoYXJlZC5zdGF0ZSA9IG5ldyBXZWFrTWFwKCkpO1xuICB2YXIgd21nZXQgPSBzdG9yZS5nZXQ7XG4gIHZhciB3bWhhcyA9IHN0b3JlLmhhcztcbiAgdmFyIHdtc2V0ID0gc3RvcmUuc2V0O1xuICBzZXQgPSBmdW5jdGlvbiAoaXQsIG1ldGFkYXRhKSB7XG4gICAgbWV0YWRhdGEuZmFjYWRlID0gaXQ7XG4gICAgd21zZXQuY2FsbChzdG9yZSwgaXQsIG1ldGFkYXRhKTtcbiAgICByZXR1cm4gbWV0YWRhdGE7XG4gIH07XG4gIGdldCA9IGZ1bmN0aW9uIChpdCkge1xuICAgIHJldHVybiB3bWdldC5jYWxsKHN0b3JlLCBpdCkgfHwge307XG4gIH07XG4gIGhhcyA9IGZ1bmN0aW9uIChpdCkge1xuICAgIHJldHVybiB3bWhhcy5jYWxsKHN0b3JlLCBpdCk7XG4gIH07XG59IGVsc2Uge1xuICB2YXIgU1RBVEUgPSBzaGFyZWRLZXkoJ3N0YXRlJyk7XG4gIGhpZGRlbktleXNbU1RBVEVdID0gdHJ1ZTtcbiAgc2V0ID0gZnVuY3Rpb24gKGl0LCBtZXRhZGF0YSkge1xuICAgIG1ldGFkYXRhLmZhY2FkZSA9IGl0O1xuICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShpdCwgU1RBVEUsIG1ldGFkYXRhKTtcbiAgICByZXR1cm4gbWV0YWRhdGE7XG4gIH07XG4gIGdldCA9IGZ1bmN0aW9uIChpdCkge1xuICAgIHJldHVybiBvYmplY3RIYXMoaXQsIFNUQVRFKSA/IGl0W1NUQVRFXSA6IHt9O1xuICB9O1xuICBoYXMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgICByZXR1cm4gb2JqZWN0SGFzKGl0LCBTVEFURSk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzZXQ6IHNldCxcbiAgZ2V0OiBnZXQsXG4gIGhhczogaGFzLFxuICBlbmZvcmNlOiBlbmZvcmNlLFxuICBnZXR0ZXJGb3I6IGdldHRlckZvclxufTtcbiIsInZhciB3ZWxsS25vd25TeW1ib2wgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvd2VsbC1rbm93bi1zeW1ib2wnKTtcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXRlcmF0b3JzJyk7XG5cbnZhciBJVEVSQVRPUiA9IHdlbGxLbm93blN5bWJvbCgnaXRlcmF0b3InKTtcbnZhciBBcnJheVByb3RvdHlwZSA9IEFycmF5LnByb3RvdHlwZTtcblxuLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b3R5cGVbSVRFUkFUT1JdID09PSBpdCk7XG59O1xuIiwidmFyIGZhaWxzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2ZhaWxzJyk7XG5cbnZhciByZXBsYWNlbWVudCA9IC8jfFxcLnByb3RvdHlwZVxcLi87XG5cbnZhciBpc0ZvcmNlZCA9IGZ1bmN0aW9uIChmZWF0dXJlLCBkZXRlY3Rpb24pIHtcbiAgdmFyIHZhbHVlID0gZGF0YVtub3JtYWxpemUoZmVhdHVyZSldO1xuICByZXR1cm4gdmFsdWUgPT0gUE9MWUZJTEwgPyB0cnVlXG4gICAgOiB2YWx1ZSA9PSBOQVRJVkUgPyBmYWxzZVxuICAgIDogdHlwZW9mIGRldGVjdGlvbiA9PSAnZnVuY3Rpb24nID8gZmFpbHMoZGV0ZWN0aW9uKVxuICAgIDogISFkZXRlY3Rpb247XG59O1xuXG52YXIgbm9ybWFsaXplID0gaXNGb3JjZWQubm9ybWFsaXplID0gZnVuY3Rpb24gKHN0cmluZykge1xuICByZXR1cm4gU3RyaW5nKHN0cmluZykucmVwbGFjZShyZXBsYWNlbWVudCwgJy4nKS50b0xvd2VyQ2FzZSgpO1xufTtcblxudmFyIGRhdGEgPSBpc0ZvcmNlZC5kYXRhID0ge307XG52YXIgTkFUSVZFID0gaXNGb3JjZWQuTkFUSVZFID0gJ04nO1xudmFyIFBPTFlGSUxMID0gaXNGb3JjZWQuUE9MWUZJTEwgPSAnUCc7XG5cbm1vZHVsZS5leHBvcnRzID0gaXNGb3JjZWQ7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZmFsc2U7XG4iLCJ2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvYW4tb2JqZWN0Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhdG9yKSB7XG4gIHZhciByZXR1cm5NZXRob2QgPSBpdGVyYXRvclsncmV0dXJuJ107XG4gIGlmIChyZXR1cm5NZXRob2QgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBhbk9iamVjdChyZXR1cm5NZXRob2QuY2FsbChpdGVyYXRvcikpLnZhbHVlO1xuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2ZhaWxzJyk7XG52YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWdldC1wcm90b3R5cGUtb2YnKTtcbnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvY3JlYXRlLW5vbi1lbnVtZXJhYmxlLXByb3BlcnR5Jyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2hhcycpO1xudmFyIHdlbGxLbm93blN5bWJvbCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy93ZWxsLWtub3duLXN5bWJvbCcpO1xudmFyIElTX1BVUkUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXMtcHVyZScpO1xuXG52YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7XG52YXIgQlVHR1lfU0FGQVJJX0lURVJBVE9SUyA9IGZhbHNlO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG5cbi8vIGAlSXRlcmF0b3JQcm90b3R5cGUlYCBvYmplY3Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtJWl0ZXJhdG9ycHJvdG90eXBlJS1vYmplY3RcbnZhciBJdGVyYXRvclByb3RvdHlwZSwgUHJvdG90eXBlT2ZBcnJheUl0ZXJhdG9yUHJvdG90eXBlLCBhcnJheUl0ZXJhdG9yO1xuXG5pZiAoW10ua2V5cykge1xuICBhcnJheUl0ZXJhdG9yID0gW10ua2V5cygpO1xuICAvLyBTYWZhcmkgOCBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGBcbiAgaWYgKCEoJ25leHQnIGluIGFycmF5SXRlcmF0b3IpKSBCVUdHWV9TQUZBUklfSVRFUkFUT1JTID0gdHJ1ZTtcbiAgZWxzZSB7XG4gICAgUHJvdG90eXBlT2ZBcnJheUl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoZ2V0UHJvdG90eXBlT2YoYXJyYXlJdGVyYXRvcikpO1xuICAgIGlmIChQcm90b3R5cGVPZkFycmF5SXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUpIEl0ZXJhdG9yUHJvdG90eXBlID0gUHJvdG90eXBlT2ZBcnJheUl0ZXJhdG9yUHJvdG90eXBlO1xuICB9XG59XG5cbnZhciBORVdfSVRFUkFUT1JfUFJPVE9UWVBFID0gSXRlcmF0b3JQcm90b3R5cGUgPT0gdW5kZWZpbmVkIHx8IGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRlc3QgPSB7fTtcbiAgLy8gRkY0NC0gbGVnYWN5IGl0ZXJhdG9ycyBjYXNlXG4gIHJldHVybiBJdGVyYXRvclByb3RvdHlwZVtJVEVSQVRPUl0uY2FsbCh0ZXN0KSAhPT0gdGVzdDtcbn0pO1xuXG5pZiAoTkVXX0lURVJBVE9SX1BST1RPVFlQRSkgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcblxuLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKClcbmlmICgoIUlTX1BVUkUgfHwgTkVXX0lURVJBVE9SX1BST1RPVFlQRSkgJiYgIWhhcyhJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IpKSB7XG4gIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgSXRlcmF0b3JQcm90b3R5cGU6IEl0ZXJhdG9yUHJvdG90eXBlLFxuICBCVUdHWV9TQUZBUklfSVRFUkFUT1JTOiBCVUdHWV9TQUZBUklfSVRFUkFUT1JTXG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7fTtcbiIsInZhciBmYWlscyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mYWlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9ICEhT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAmJiAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICAvLyBDaHJvbWUgMzggU3ltYm9sIGhhcyBpbmNvcnJlY3QgdG9TdHJpbmcgY29udmVyc2lvblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgcmV0dXJuICFTdHJpbmcoU3ltYm9sKCkpO1xufSk7XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIGluc3BlY3RTb3VyY2UgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaW5zcGVjdC1zb3VyY2UnKTtcblxudmFyIFdlYWtNYXAgPSBnbG9iYWwuV2Vha01hcDtcblxubW9kdWxlLmV4cG9ydHMgPSB0eXBlb2YgV2Vha01hcCA9PT0gJ2Z1bmN0aW9uJyAmJiAvbmF0aXZlIGNvZGUvLnRlc3QoaW5zcGVjdFNvdXJjZShXZWFrTWFwKSk7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZGVzY3JpcHRvcnMnKTtcbnZhciBmYWlscyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mYWlscycpO1xudmFyIG9iamVjdEtleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWtleXMnKTtcbnZhciBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWdldC1vd24tcHJvcGVydHktc3ltYm9scycpO1xudmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1wcm9wZXJ0eS1pcy1lbnVtZXJhYmxlJyk7XG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8tb2JqZWN0Jyk7XG52YXIgSW5kZXhlZE9iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pbmRleGVkLW9iamVjdCcpO1xuXG52YXIgbmF0aXZlQXNzaWduID0gT2JqZWN0LmFzc2lnbjtcbnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxuLy8gYE9iamVjdC5hc3NpZ25gIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3QuYXNzaWduXG5tb2R1bGUuZXhwb3J0cyA9ICFuYXRpdmVBc3NpZ24gfHwgZmFpbHMoZnVuY3Rpb24gKCkge1xuICAvLyBzaG91bGQgaGF2ZSBjb3JyZWN0IG9yZGVyIG9mIG9wZXJhdGlvbnMgKEVkZ2UgYnVnKVxuICBpZiAoREVTQ1JJUFRPUlMgJiYgbmF0aXZlQXNzaWduKHsgYjogMSB9LCBuYXRpdmVBc3NpZ24oZGVmaW5lUHJvcGVydHkoe30sICdhJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAnYicsIHtcbiAgICAgICAgdmFsdWU6IDMsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gIH0pLCB7IGI6IDIgfSkpLmIgIT09IDEpIHJldHVybiB0cnVlO1xuICAvLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZylcbiAgdmFyIEEgPSB7fTtcbiAgdmFyIEIgPSB7fTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBzeW1ib2wgPSBTeW1ib2woKTtcbiAgdmFyIGFscGhhYmV0ID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JztcbiAgQVtzeW1ib2xdID0gNztcbiAgYWxwaGFiZXQuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24gKGNocikgeyBCW2Nocl0gPSBjaHI7IH0pO1xuICByZXR1cm4gbmF0aXZlQXNzaWduKHt9LCBBKVtzeW1ib2xdICE9IDcgfHwgb2JqZWN0S2V5cyhuYXRpdmVBc3NpZ24oe30sIEIpKS5qb2luKCcnKSAhPSBhbHBoYWJldDtcbn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgdmFyIFQgPSB0b09iamVjdCh0YXJnZXQpO1xuICB2YXIgYXJndW1lbnRzTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgdmFyIGluZGV4ID0gMTtcbiAgdmFyIGdldE93blByb3BlcnR5U3ltYm9scyA9IGdldE93blByb3BlcnR5U3ltYm9sc01vZHVsZS5mO1xuICB2YXIgcHJvcGVydHlJc0VudW1lcmFibGUgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZU1vZHVsZS5mO1xuICB3aGlsZSAoYXJndW1lbnRzTGVuZ3RoID4gaW5kZXgpIHtcbiAgICB2YXIgUyA9IEluZGV4ZWRPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKTtcbiAgICB2YXIga2V5cyA9IGdldE93blByb3BlcnR5U3ltYm9scyA/IG9iamVjdEtleXMoUykuY29uY2F0KGdldE93blByb3BlcnR5U3ltYm9scyhTKSkgOiBvYmplY3RLZXlzKFMpO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgaiA9IDA7XG4gICAgdmFyIGtleTtcbiAgICB3aGlsZSAobGVuZ3RoID4gaikge1xuICAgICAga2V5ID0ga2V5c1tqKytdO1xuICAgICAgaWYgKCFERVNDUklQVE9SUyB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKFMsIGtleSkpIFRba2V5XSA9IFNba2V5XTtcbiAgICB9XG4gIH0gcmV0dXJuIFQ7XG59IDogbmF0aXZlQXNzaWduO1xuIiwidmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIGRlZmluZVByb3BlcnRpZXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0aWVzJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZW51bS1idWcta2V5cycpO1xudmFyIGhpZGRlbktleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGlkZGVuLWtleXMnKTtcbnZhciBodG1sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2h0bWwnKTtcbnZhciBkb2N1bWVudENyZWF0ZUVsZW1lbnQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZG9jdW1lbnQtY3JlYXRlLWVsZW1lbnQnKTtcbnZhciBzaGFyZWRLZXkgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2hhcmVkLWtleScpO1xuXG52YXIgR1QgPSAnPic7XG52YXIgTFQgPSAnPCc7XG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG52YXIgU0NSSVBUID0gJ3NjcmlwdCc7XG52YXIgSUVfUFJPVE8gPSBzaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG5cbnZhciBFbXB0eUNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9O1xuXG52YXIgc2NyaXB0VGFnID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgcmV0dXJuIExUICsgU0NSSVBUICsgR1QgKyBjb250ZW50ICsgTFQgKyAnLycgKyBTQ1JJUFQgKyBHVDtcbn07XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBBY3RpdmVYIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlXG52YXIgTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWCA9IGZ1bmN0aW9uIChhY3RpdmVYRG9jdW1lbnQpIHtcbiAgYWN0aXZlWERvY3VtZW50LndyaXRlKHNjcmlwdFRhZygnJykpO1xuICBhY3RpdmVYRG9jdW1lbnQuY2xvc2UoKTtcbiAgdmFyIHRlbXAgPSBhY3RpdmVYRG9jdW1lbnQucGFyZW50V2luZG93Lk9iamVjdDtcbiAgYWN0aXZlWERvY3VtZW50ID0gbnVsbDsgLy8gYXZvaWQgbWVtb3J5IGxlYWtcbiAgcmV0dXJuIHRlbXA7XG59O1xuXG4vLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlXG52YXIgTnVsbFByb3RvT2JqZWN0VmlhSUZyYW1lID0gZnVuY3Rpb24gKCkge1xuICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1Z1xuICB2YXIgaWZyYW1lID0gZG9jdW1lbnRDcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgdmFyIEpTID0gJ2phdmEnICsgU0NSSVBUICsgJzonO1xuICB2YXIgaWZyYW1lRG9jdW1lbnQ7XG4gIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICBodG1sLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy80NzVcbiAgaWZyYW1lLnNyYyA9IFN0cmluZyhKUyk7XG4gIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIGlmcmFtZURvY3VtZW50Lm9wZW4oKTtcbiAgaWZyYW1lRG9jdW1lbnQud3JpdGUoc2NyaXB0VGFnKCdkb2N1bWVudC5GPU9iamVjdCcpKTtcbiAgaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTtcbiAgcmV0dXJuIGlmcmFtZURvY3VtZW50LkY7XG59O1xuXG4vLyBDaGVjayBmb3IgZG9jdW1lbnQuZG9tYWluIGFuZCBhY3RpdmUgeCBzdXBwb3J0XG4vLyBObyBuZWVkIHRvIHVzZSBhY3RpdmUgeCBhcHByb2FjaCB3aGVuIGRvY3VtZW50LmRvbWFpbiBpcyBub3Qgc2V0XG4vLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VzLXNoaW1zL2VzNS1zaGltL2lzc3Vlcy8xNTBcbi8vIHZhcmlhdGlvbiBvZiBodHRwczovL2dpdGh1Yi5jb20va2l0Y2FtYnJpZGdlL2VzNS1zaGltL2NvbW1pdC80ZjczOGFjMDY2MzQ2XG4vLyBhdm9pZCBJRSBHQyBidWdcbnZhciBhY3RpdmVYRG9jdW1lbnQ7XG52YXIgTnVsbFByb3RvT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIC8qIGdsb2JhbCBBY3RpdmVYT2JqZWN0ICovXG4gICAgYWN0aXZlWERvY3VtZW50ID0gZG9jdW1lbnQuZG9tYWluICYmIG5ldyBBY3RpdmVYT2JqZWN0KCdodG1sZmlsZScpO1xuICB9IGNhdGNoIChlcnJvcikgeyAvKiBpZ25vcmUgKi8gfVxuICBOdWxsUHJvdG9PYmplY3QgPSBhY3RpdmVYRG9jdW1lbnQgPyBOdWxsUHJvdG9PYmplY3RWaWFBY3RpdmVYKGFjdGl2ZVhEb2N1bWVudCkgOiBOdWxsUHJvdG9PYmplY3RWaWFJRnJhbWUoKTtcbiAgdmFyIGxlbmd0aCA9IGVudW1CdWdLZXlzLmxlbmd0aDtcbiAgd2hpbGUgKGxlbmd0aC0tKSBkZWxldGUgTnVsbFByb3RvT2JqZWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbbGVuZ3RoXV07XG4gIHJldHVybiBOdWxsUHJvdG9PYmplY3QoKTtcbn07XG5cbmhpZGRlbktleXNbSUVfUFJPVE9dID0gdHJ1ZTtcblxuLy8gYE9iamVjdC5jcmVhdGVgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3QuY3JlYXRlXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKE8gIT09IG51bGwpIHtcbiAgICBFbXB0eUNvbnN0cnVjdG9yW1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTtcbiAgICByZXN1bHQgPSBuZXcgRW1wdHlDb25zdHJ1Y3RvcigpO1xuICAgIEVtcHR5Q29uc3RydWN0b3JbUFJPVE9UWVBFXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gTnVsbFByb3RvT2JqZWN0KCk7XG4gIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkZWZpbmVQcm9wZXJ0aWVzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuIiwidmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2Rlc2NyaXB0b3JzJyk7XG52YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eScpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIG9iamVjdEtleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWtleXMnKTtcblxuLy8gYE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzYCBtZXRob2Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtb2JqZWN0LmRlZmluZXByb3BlcnRpZXNcbm1vZHVsZS5leHBvcnRzID0gREVTQ1JJUFRPUlMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykge1xuICBhbk9iamVjdChPKTtcbiAgdmFyIGtleXMgPSBvYmplY3RLZXlzKFByb3BlcnRpZXMpO1xuICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gIHZhciBpbmRleCA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChsZW5ndGggPiBpbmRleCkgZGVmaW5lUHJvcGVydHlNb2R1bGUuZihPLCBrZXkgPSBrZXlzW2luZGV4KytdLCBQcm9wZXJ0aWVzW2tleV0pO1xuICByZXR1cm4gTztcbn07XG4iLCJ2YXIgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZGVzY3JpcHRvcnMnKTtcbnZhciBJRThfRE9NX0RFRklORSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pZTgtZG9tLWRlZmluZScpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3RvLXByaW1pdGl2ZScpO1xuXG52YXIgbmF0aXZlRGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG5cbi8vIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3QuZGVmaW5lcHJvcGVydHlcbmV4cG9ydHMuZiA9IERFU0NSSVBUT1JTID8gbmF0aXZlRGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKSB7XG4gIGFuT2JqZWN0KE8pO1xuICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7XG4gIGFuT2JqZWN0KEF0dHJpYnV0ZXMpO1xuICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7XG4gICAgcmV0dXJuIG5hdGl2ZURlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpO1xuICB9IGNhdGNoIChlcnJvcikgeyAvKiBlbXB0eSAqLyB9XG4gIGlmICgnZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpIHRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQnKTtcbiAgaWYgKCd2YWx1ZScgaW4gQXR0cmlidXRlcykgT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7XG4gIHJldHVybiBPO1xufTtcbiIsInZhciBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9kZXNjcmlwdG9ycycpO1xudmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1wcm9wZXJ0eS1pcy1lbnVtZXJhYmxlJyk7XG52YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NyZWF0ZS1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7XG52YXIgdG9JbmRleGVkT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3RvLWluZGV4ZWQtb2JqZWN0Jyk7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8tcHJpbWl0aXZlJyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2hhcycpO1xudmFyIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2llOC1kb20tZGVmaW5lJyk7XG5cbnZhciBuYXRpdmVHZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuXG4vLyBgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcmAgbWV0aG9kXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLW9iamVjdC5nZXRvd25wcm9wZXJ0eWRlc2NyaXB0b3JcbmV4cG9ydHMuZiA9IERFU0NSSVBUT1JTID8gbmF0aXZlR2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHtcbiAgTyA9IHRvSW5kZXhlZE9iamVjdChPKTtcbiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7XG4gICAgcmV0dXJuIG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoaGFzKE8sIFApKSByZXR1cm4gY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKCFwcm9wZXJ0eUlzRW51bWVyYWJsZU1vZHVsZS5mLmNhbGwoTywgUCksIE9bUF0pO1xufTtcbiIsInZhciBpbnRlcm5hbE9iamVjdEtleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWtleXMtaW50ZXJuYWwnKTtcbnZhciBlbnVtQnVnS2V5cyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9lbnVtLWJ1Zy1rZXlzJyk7XG5cbnZhciBoaWRkZW5LZXlzID0gZW51bUJ1Z0tleXMuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7XG5cbi8vIGBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lc2AgbWV0aG9kXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLW9iamVjdC5nZXRvd25wcm9wZXJ0eW5hbWVzXG5leHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pIHtcbiAgcmV0dXJuIGludGVybmFsT2JqZWN0S2V5cyhPLCBoaWRkZW5LZXlzKTtcbn07XG4iLCJleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuIiwidmFyIGhhcyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9oYXMnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1vYmplY3QnKTtcbnZhciBzaGFyZWRLZXkgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2hhcmVkLWtleScpO1xudmFyIENPUlJFQ1RfUFJPVE9UWVBFX0dFVFRFUiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jb3JyZWN0LXByb3RvdHlwZS1nZXR0ZXInKTtcblxudmFyIElFX1BST1RPID0gc2hhcmVkS2V5KCdJRV9QUk9UTycpO1xudmFyIE9iamVjdFByb3RvdHlwZSA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8vIGBPYmplY3QuZ2V0UHJvdG90eXBlT2ZgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3QuZ2V0cHJvdG90eXBlb2Zcbm1vZHVsZS5leHBvcnRzID0gQ09SUkVDVF9QUk9UT1RZUEVfR0VUVEVSID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gKE8pIHtcbiAgTyA9IHRvT2JqZWN0KE8pO1xuICBpZiAoaGFzKE8sIElFX1BST1RPKSkgcmV0dXJuIE9bSUVfUFJPVE9dO1xuICBpZiAodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvdHlwZSA6IG51bGw7XG59O1xuIiwidmFyIGhhcyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9oYXMnKTtcbnZhciB0b0luZGV4ZWRPYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8taW5kZXhlZC1vYmplY3QnKTtcbnZhciBpbmRleE9mID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FycmF5LWluY2x1ZGVzJykuaW5kZXhPZjtcbnZhciBoaWRkZW5LZXlzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2hpZGRlbi1rZXlzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iamVjdCwgbmFtZXMpIHtcbiAgdmFyIE8gPSB0b0luZGV4ZWRPYmplY3Qob2JqZWN0KTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBrZXk7XG4gIGZvciAoa2V5IGluIE8pICFoYXMoaGlkZGVuS2V5cywga2V5KSAmJiBoYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpO1xuICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzXG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSBpZiAoaGFzKE8sIGtleSA9IG5hbWVzW2krK10pKSB7XG4gICAgfmluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJ2YXIgaW50ZXJuYWxPYmplY3RLZXlzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1rZXlzLWludGVybmFsJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZW51bS1idWcta2V5cycpO1xuXG4vLyBgT2JqZWN0LmtleXNgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3Qua2V5c1xubW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pIHtcbiAgcmV0dXJuIGludGVybmFsT2JqZWN0S2V5cyhPLCBlbnVtQnVnS2V5cyk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIG5hdGl2ZVByb3BlcnR5SXNFbnVtZXJhYmxlID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG52YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcblxuLy8gTmFzaG9ybiB+IEpESzggYnVnXG52YXIgTkFTSE9STl9CVUcgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgJiYgIW5hdGl2ZVByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoeyAxOiAyIH0sIDEpO1xuXG4vLyBgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZWAgbWV0aG9kIGltcGxlbWVudGF0aW9uXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLW9iamVjdC5wcm90b3R5cGUucHJvcGVydHlpc2VudW1lcmFibGVcbmV4cG9ydHMuZiA9IE5BU0hPUk5fQlVHID8gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoVikge1xuICB2YXIgZGVzY3JpcHRvciA9IGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0aGlzLCBWKTtcbiAgcmV0dXJuICEhZGVzY3JpcHRvciAmJiBkZXNjcmlwdG9yLmVudW1lcmFibGU7XG59IDogbmF0aXZlUHJvcGVydHlJc0VudW1lcmFibGU7XG4iLCJ2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvYW4tb2JqZWN0Jyk7XG52YXIgYVBvc3NpYmxlUHJvdG90eXBlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2EtcG9zc2libGUtcHJvdG90eXBlJyk7XG5cbi8vIGBPYmplY3Quc2V0UHJvdG90eXBlT2ZgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3Quc2V0cHJvdG90eXBlb2Zcbi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLlxuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IGZ1bmN0aW9uICgpIHtcbiAgdmFyIENPUlJFQ1RfU0VUVEVSID0gZmFsc2U7XG4gIHZhciB0ZXN0ID0ge307XG4gIHZhciBzZXR0ZXI7XG4gIHRyeSB7XG4gICAgc2V0dGVyID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0O1xuICAgIHNldHRlci5jYWxsKHRlc3QsIFtdKTtcbiAgICBDT1JSRUNUX1NFVFRFUiA9IHRlc3QgaW5zdGFuY2VvZiBBcnJheTtcbiAgfSBjYXRjaCAoZXJyb3IpIHsgLyogZW1wdHkgKi8gfVxuICByZXR1cm4gZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pIHtcbiAgICBhbk9iamVjdChPKTtcbiAgICBhUG9zc2libGVQcm90b3R5cGUocHJvdG8pO1xuICAgIGlmIChDT1JSRUNUX1NFVFRFUikgc2V0dGVyLmNhbGwoTywgcHJvdG8pO1xuICAgIGVsc2UgTy5fX3Byb3RvX18gPSBwcm90bztcbiAgICByZXR1cm4gTztcbiAgfTtcbn0oKSA6IHVuZGVmaW5lZCk7XG4iLCJ2YXIgZ2V0QnVpbHRJbiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9nZXQtYnVpbHQtaW4nKTtcbnZhciBnZXRPd25Qcm9wZXJ0eU5hbWVzTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1nZXQtb3duLXByb3BlcnR5LW5hbWVzJyk7XG52YXIgZ2V0T3duUHJvcGVydHlTeW1ib2xzTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1nZXQtb3duLXByb3BlcnR5LXN5bWJvbHMnKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hbi1vYmplY3QnKTtcblxuLy8gYWxsIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBub24tZW51bWVyYWJsZSBhbmQgc3ltYm9sc1xubW9kdWxlLmV4cG9ydHMgPSBnZXRCdWlsdEluKCdSZWZsZWN0JywgJ293bktleXMnKSB8fCBmdW5jdGlvbiBvd25LZXlzKGl0KSB7XG4gIHZhciBrZXlzID0gZ2V0T3duUHJvcGVydHlOYW1lc01vZHVsZS5mKGFuT2JqZWN0KGl0KSk7XG4gIHZhciBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUuZjtcbiAgcmV0dXJuIGdldE93blByb3BlcnR5U3ltYm9scyA/IGtleXMuY29uY2F0KGdldE93blByb3BlcnR5U3ltYm9scyhpdCkpIDoga2V5cztcbn07XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdsb2JhbDtcbiIsInZhciBnbG9iYWwgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZ2xvYmFsJyk7XG52YXIgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NyZWF0ZS1ub24tZW51bWVyYWJsZS1wcm9wZXJ0eScpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9oYXMnKTtcbnZhciBzZXRHbG9iYWwgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2V0LWdsb2JhbCcpO1xudmFyIGluc3BlY3RTb3VyY2UgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaW5zcGVjdC1zb3VyY2UnKTtcbnZhciBJbnRlcm5hbFN0YXRlTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2ludGVybmFsLXN0YXRlJyk7XG5cbnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXQ7XG52YXIgZW5mb3JjZUludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmVuZm9yY2U7XG52YXIgVEVNUExBVEUgPSBTdHJpbmcoU3RyaW5nKS5zcGxpdCgnU3RyaW5nJyk7XG5cbihtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChPLCBrZXksIHZhbHVlLCBvcHRpb25zKSB7XG4gIHZhciB1bnNhZmUgPSBvcHRpb25zID8gISFvcHRpb25zLnVuc2FmZSA6IGZhbHNlO1xuICB2YXIgc2ltcGxlID0gb3B0aW9ucyA/ICEhb3B0aW9ucy5lbnVtZXJhYmxlIDogZmFsc2U7XG4gIHZhciBub1RhcmdldEdldCA9IG9wdGlvbnMgPyAhIW9wdGlvbnMubm9UYXJnZXRHZXQgOiBmYWxzZTtcbiAgdmFyIHN0YXRlO1xuICBpZiAodHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicpIHtcbiAgICBpZiAodHlwZW9mIGtleSA9PSAnc3RyaW5nJyAmJiAhaGFzKHZhbHVlLCAnbmFtZScpKSB7XG4gICAgICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkodmFsdWUsICduYW1lJywga2V5KTtcbiAgICB9XG4gICAgc3RhdGUgPSBlbmZvcmNlSW50ZXJuYWxTdGF0ZSh2YWx1ZSk7XG4gICAgaWYgKCFzdGF0ZS5zb3VyY2UpIHtcbiAgICAgIHN0YXRlLnNvdXJjZSA9IFRFTVBMQVRFLmpvaW4odHlwZW9mIGtleSA9PSAnc3RyaW5nJyA/IGtleSA6ICcnKTtcbiAgICB9XG4gIH1cbiAgaWYgKE8gPT09IGdsb2JhbCkge1xuICAgIGlmIChzaW1wbGUpIE9ba2V5XSA9IHZhbHVlO1xuICAgIGVsc2Ugc2V0R2xvYmFsKGtleSwgdmFsdWUpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmICghdW5zYWZlKSB7XG4gICAgZGVsZXRlIE9ba2V5XTtcbiAgfSBlbHNlIGlmICghbm9UYXJnZXRHZXQgJiYgT1trZXldKSB7XG4gICAgc2ltcGxlID0gdHJ1ZTtcbiAgfVxuICBpZiAoc2ltcGxlKSBPW2tleV0gPSB2YWx1ZTtcbiAgZWxzZSBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoTywga2V5LCB2YWx1ZSk7XG4vLyBhZGQgZmFrZSBGdW5jdGlvbiN0b1N0cmluZyBmb3IgY29ycmVjdCB3b3JrIHdyYXBwZWQgbWV0aG9kcyAvIGNvbnN0cnVjdG9ycyB3aXRoIG1ldGhvZHMgbGlrZSBMb0Rhc2ggaXNOYXRpdmVcbn0pKEZ1bmN0aW9uLnByb3RvdHlwZSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gIHJldHVybiB0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nICYmIGdldEludGVybmFsU3RhdGUodGhpcykuc291cmNlIHx8IGluc3BlY3RTb3VyY2UodGhpcyk7XG59KTtcbiIsIi8vIGBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlYCBhYnN0cmFjdCBvcGVyYXRpb25cbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtcmVxdWlyZW9iamVjdGNvZXJjaWJsZVxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKGl0ID09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gXCIgKyBpdCk7XG4gIHJldHVybiBpdDtcbn07XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jcmVhdGUtbm9uLWVudW1lcmFibGUtcHJvcGVydHknKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICB0cnkge1xuICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShnbG9iYWwsIGtleSwgdmFsdWUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGdsb2JhbFtrZXldID0gdmFsdWU7XG4gIH0gcmV0dXJuIHZhbHVlO1xufTtcbiIsInZhciBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vYmplY3QtZGVmaW5lLXByb3BlcnR5JykuZjtcbnZhciBoYXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGFzJyk7XG52YXIgd2VsbEtub3duU3ltYm9sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3dlbGwta25vd24tc3ltYm9sJyk7XG5cbnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgVEFHLCBTVEFUSUMpIHtcbiAgaWYgKGl0ICYmICFoYXMoaXQgPSBTVEFUSUMgPyBpdCA6IGl0LnByb3RvdHlwZSwgVE9fU1RSSU5HX1RBRykpIHtcbiAgICBkZWZpbmVQcm9wZXJ0eShpdCwgVE9fU1RSSU5HX1RBRywgeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiBUQUcgfSk7XG4gIH1cbn07XG4iLCJ2YXIgc2hhcmVkID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3NoYXJlZCcpO1xudmFyIHVpZCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy91aWQnKTtcblxudmFyIGtleXMgPSBzaGFyZWQoJ2tleXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiBrZXlzW2tleV0gfHwgKGtleXNba2V5XSA9IHVpZChrZXkpKTtcbn07XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIHNldEdsb2JhbCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9zZXQtZ2xvYmFsJyk7XG5cbnZhciBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJztcbnZhciBzdG9yZSA9IGdsb2JhbFtTSEFSRURdIHx8IHNldEdsb2JhbChTSEFSRUQsIHt9KTtcblxubW9kdWxlLmV4cG9ydHMgPSBzdG9yZTtcbiIsInZhciBJU19QVVJFID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLXB1cmUnKTtcbnZhciBzdG9yZSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9zaGFyZWQtc3RvcmUnKTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB7fSk7XG59KSgndmVyc2lvbnMnLCBbXSkucHVzaCh7XG4gIHZlcnNpb246ICczLjguMycsXG4gIG1vZGU6IElTX1BVUkUgPyAncHVyZScgOiAnZ2xvYmFsJyxcbiAgY29weXJpZ2h0OiAnwqkgMjAyMSBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KSdcbn0pO1xuIiwidmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1pbnRlZ2VyJyk7XG52YXIgcmVxdWlyZU9iamVjdENvZXJjaWJsZSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9yZXF1aXJlLW9iamVjdC1jb2VyY2libGUnKTtcblxuLy8gYFN0cmluZy5wcm90b3R5cGUueyBjb2RlUG9pbnRBdCwgYXQgfWAgbWV0aG9kcyBpbXBsZW1lbnRhdGlvblxudmFyIGNyZWF0ZU1ldGhvZCA9IGZ1bmN0aW9uIChDT05WRVJUX1RPX1NUUklORykge1xuICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBwb3MpIHtcbiAgICB2YXIgUyA9IFN0cmluZyhyZXF1aXJlT2JqZWN0Q29lcmNpYmxlKCR0aGlzKSk7XG4gICAgdmFyIHBvc2l0aW9uID0gdG9JbnRlZ2VyKHBvcyk7XG4gICAgdmFyIHNpemUgPSBTLmxlbmd0aDtcbiAgICB2YXIgZmlyc3QsIHNlY29uZDtcbiAgICBpZiAocG9zaXRpb24gPCAwIHx8IHBvc2l0aW9uID49IHNpemUpIHJldHVybiBDT05WRVJUX1RPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkO1xuICAgIGZpcnN0ID0gUy5jaGFyQ29kZUF0KHBvc2l0aW9uKTtcbiAgICByZXR1cm4gZmlyc3QgPCAweEQ4MDAgfHwgZmlyc3QgPiAweERCRkYgfHwgcG9zaXRpb24gKyAxID09PSBzaXplXG4gICAgICB8fCAoc2Vjb25kID0gUy5jaGFyQ29kZUF0KHBvc2l0aW9uICsgMSkpIDwgMHhEQzAwIHx8IHNlY29uZCA+IDB4REZGRlxuICAgICAgICA/IENPTlZFUlRfVE9fU1RSSU5HID8gUy5jaGFyQXQocG9zaXRpb24pIDogZmlyc3RcbiAgICAgICAgOiBDT05WRVJUX1RPX1NUUklORyA/IFMuc2xpY2UocG9zaXRpb24sIHBvc2l0aW9uICsgMikgOiAoZmlyc3QgLSAweEQ4MDAgPDwgMTApICsgKHNlY29uZCAtIDB4REMwMCkgKyAweDEwMDAwO1xuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIC8vIGBTdHJpbmcucHJvdG90eXBlLmNvZGVQb2ludEF0YCBtZXRob2RcbiAgLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1zdHJpbmcucHJvdG90eXBlLmNvZGVwb2ludGF0XG4gIGNvZGVBdDogY3JlYXRlTWV0aG9kKGZhbHNlKSxcbiAgLy8gYFN0cmluZy5wcm90b3R5cGUuYXRgIG1ldGhvZFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWF0aGlhc2J5bmVucy9TdHJpbmcucHJvdG90eXBlLmF0XG4gIGNoYXJBdDogY3JlYXRlTWV0aG9kKHRydWUpXG59O1xuIiwidmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1pbnRlZ2VyJyk7XG5cbnZhciBtYXggPSBNYXRoLm1heDtcbnZhciBtaW4gPSBNYXRoLm1pbjtcblxuLy8gSGVscGVyIGZvciBhIHBvcHVsYXIgcmVwZWF0aW5nIGNhc2Ugb2YgdGhlIHNwZWM6XG4vLyBMZXQgaW50ZWdlciBiZSA/IFRvSW50ZWdlcihpbmRleCkuXG4vLyBJZiBpbnRlZ2VyIDwgMCwgbGV0IHJlc3VsdCBiZSBtYXgoKGxlbmd0aCArIGludGVnZXIpLCAwKTsgZWxzZSBsZXQgcmVzdWx0IGJlIG1pbihpbnRlZ2VyLCBsZW5ndGgpLlxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaW5kZXgsIGxlbmd0aCkge1xuICB2YXIgaW50ZWdlciA9IHRvSW50ZWdlcihpbmRleCk7XG4gIHJldHVybiBpbnRlZ2VyIDwgMCA/IG1heChpbnRlZ2VyICsgbGVuZ3RoLCAwKSA6IG1pbihpbnRlZ2VyLCBsZW5ndGgpO1xufTtcbiIsIi8vIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzXG52YXIgSW5kZXhlZE9iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pbmRleGVkLW9iamVjdCcpO1xudmFyIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvcmVxdWlyZS1vYmplY3QtY29lcmNpYmxlJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBJbmRleGVkT2JqZWN0KHJlcXVpcmVPYmplY3RDb2VyY2libGUoaXQpKTtcbn07XG4iLCJ2YXIgY2VpbCA9IE1hdGguY2VpbDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG5cbi8vIGBUb0ludGVnZXJgIGFic3RyYWN0IG9wZXJhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy10b2ludGVnZXJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG4gIHJldHVybiBpc05hTihhcmd1bWVudCA9ICthcmd1bWVudCkgPyAwIDogKGFyZ3VtZW50ID4gMCA/IGZsb29yIDogY2VpbCkoYXJndW1lbnQpO1xufTtcbiIsInZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvdG8taW50ZWdlcicpO1xuXG52YXIgbWluID0gTWF0aC5taW47XG5cbi8vIGBUb0xlbmd0aGAgYWJzdHJhY3Qgb3BlcmF0aW9uXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLXRvbGVuZ3RoXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkge1xuICByZXR1cm4gYXJndW1lbnQgPiAwID8gbWluKHRvSW50ZWdlcihhcmd1bWVudCksIDB4MUZGRkZGRkZGRkZGRkYpIDogMDsgLy8gMiAqKiA1MyAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MVxufTtcbiIsInZhciByZXF1aXJlT2JqZWN0Q29lcmNpYmxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3JlcXVpcmUtb2JqZWN0LWNvZXJjaWJsZScpO1xuXG4vLyBgVG9PYmplY3RgIGFic3RyYWN0IG9wZXJhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy10b29iamVjdFxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHtcbiAgcmV0dXJuIE9iamVjdChyZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KSk7XG59O1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLW9iamVjdCcpO1xuXG4vLyBgVG9QcmltaXRpdmVgIGFic3RyYWN0IG9wZXJhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy10b3ByaW1pdGl2ZVxuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbnB1dCwgUFJFRkVSUkVEX1NUUklORykge1xuICBpZiAoIWlzT2JqZWN0KGlucHV0KSkgcmV0dXJuIGlucHV0O1xuICB2YXIgZm4sIHZhbDtcbiAgaWYgKFBSRUZFUlJFRF9TVFJJTkcgJiYgdHlwZW9mIChmbiA9IGlucHV0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGlucHV0KSkpIHJldHVybiB2YWw7XG4gIGlmICh0eXBlb2YgKGZuID0gaW5wdXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpbnB1dCkpKSByZXR1cm4gdmFsO1xuICBpZiAoIVBSRUZFUlJFRF9TVFJJTkcgJiYgdHlwZW9mIChmbiA9IGlucHV0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGlucHV0KSkpIHJldHVybiB2YWw7XG4gIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKTtcbn07XG4iLCJ2YXIgd2VsbEtub3duU3ltYm9sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3dlbGwta25vd24tc3ltYm9sJyk7XG5cbnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpO1xudmFyIHRlc3QgPSB7fTtcblxudGVzdFtUT19TVFJJTkdfVEFHXSA9ICd6JztcblxubW9kdWxlLmV4cG9ydHMgPSBTdHJpbmcodGVzdCkgPT09ICdbb2JqZWN0IHpdJztcbiIsInZhciBpZCA9IDA7XG52YXIgcG9zdGZpeCA9IE1hdGgucmFuZG9tKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gJ1N5bWJvbCgnICsgU3RyaW5nKGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXkpICsgJylfJyArICgrK2lkICsgcG9zdGZpeCkudG9TdHJpbmcoMzYpO1xufTtcbiIsInZhciBOQVRJVkVfU1lNQk9MID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL25hdGl2ZS1zeW1ib2wnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBOQVRJVkVfU1lNQk9MXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuICAmJiAhU3ltYm9sLnNoYW1cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCc7XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dsb2JhbCcpO1xudmFyIHNoYXJlZCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9zaGFyZWQnKTtcbnZhciBoYXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGFzJyk7XG52YXIgdWlkID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3VpZCcpO1xudmFyIE5BVElWRV9TWU1CT0wgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvbmF0aXZlLXN5bWJvbCcpO1xudmFyIFVTRV9TWU1CT0xfQVNfVUlEID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3VzZS1zeW1ib2wtYXMtdWlkJyk7XG5cbnZhciBXZWxsS25vd25TeW1ib2xzU3RvcmUgPSBzaGFyZWQoJ3drcycpO1xudmFyIFN5bWJvbCA9IGdsb2JhbC5TeW1ib2w7XG52YXIgY3JlYXRlV2VsbEtub3duU3ltYm9sID0gVVNFX1NZTUJPTF9BU19VSUQgPyBTeW1ib2wgOiBTeW1ib2wgJiYgU3ltYm9sLndpdGhvdXRTZXR0ZXIgfHwgdWlkO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gIGlmICghaGFzKFdlbGxLbm93blN5bWJvbHNTdG9yZSwgbmFtZSkpIHtcbiAgICBpZiAoTkFUSVZFX1NZTUJPTCAmJiBoYXMoU3ltYm9sLCBuYW1lKSkgV2VsbEtub3duU3ltYm9sc1N0b3JlW25hbWVdID0gU3ltYm9sW25hbWVdO1xuICAgIGVsc2UgV2VsbEtub3duU3ltYm9sc1N0b3JlW25hbWVdID0gY3JlYXRlV2VsbEtub3duU3ltYm9sKCdTeW1ib2wuJyArIG5hbWUpO1xuICB9IHJldHVybiBXZWxsS25vd25TeW1ib2xzU3RvcmVbbmFtZV07XG59O1xuIiwidmFyICQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZXhwb3J0Jyk7XG52YXIgZnJvbSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hcnJheS1mcm9tJyk7XG52YXIgY2hlY2tDb3JyZWN0bmVzc09mSXRlcmF0aW9uID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NoZWNrLWNvcnJlY3RuZXNzLW9mLWl0ZXJhdGlvbicpO1xuXG52YXIgSU5DT1JSRUNUX0lURVJBVElPTiA9ICFjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24oZnVuY3Rpb24gKGl0ZXJhYmxlKSB7XG4gIEFycmF5LmZyb20oaXRlcmFibGUpO1xufSk7XG5cbi8vIGBBcnJheS5mcm9tYCBtZXRob2Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtYXJyYXkuZnJvbVxuJCh7IHRhcmdldDogJ0FycmF5Jywgc3RhdDogdHJ1ZSwgZm9yY2VkOiBJTkNPUlJFQ1RfSVRFUkFUSU9OIH0sIHtcbiAgZnJvbTogZnJvbVxufSk7XG4iLCJ2YXIgJCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9leHBvcnQnKTtcbnZhciBhc3NpZ24gPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWFzc2lnbicpO1xuXG4vLyBgT2JqZWN0LmFzc2lnbmAgbWV0aG9kXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLW9iamVjdC5hc3NpZ25cbiQoeyB0YXJnZXQ6ICdPYmplY3QnLCBzdGF0OiB0cnVlLCBmb3JjZWQ6IE9iamVjdC5hc3NpZ24gIT09IGFzc2lnbiB9LCB7XG4gIGFzc2lnbjogYXNzaWduXG59KTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjaGFyQXQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc3RyaW5nLW11bHRpYnl0ZScpLmNoYXJBdDtcbnZhciBJbnRlcm5hbFN0YXRlTW9kdWxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2ludGVybmFsLXN0YXRlJyk7XG52YXIgZGVmaW5lSXRlcmF0b3IgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZGVmaW5lLWl0ZXJhdG9yJyk7XG5cbnZhciBTVFJJTkdfSVRFUkFUT1IgPSAnU3RyaW5nIEl0ZXJhdG9yJztcbnZhciBzZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5zZXQ7XG52YXIgZ2V0SW50ZXJuYWxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuZ2V0dGVyRm9yKFNUUklOR19JVEVSQVRPUik7XG5cbi8vIGBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdYCBtZXRob2Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtc3RyaW5nLnByb3RvdHlwZS1AQGl0ZXJhdG9yXG5kZWZpbmVJdGVyYXRvcihTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbiAoaXRlcmF0ZWQpIHtcbiAgc2V0SW50ZXJuYWxTdGF0ZSh0aGlzLCB7XG4gICAgdHlwZTogU1RSSU5HX0lURVJBVE9SLFxuICAgIHN0cmluZzogU3RyaW5nKGl0ZXJhdGVkKSxcbiAgICBpbmRleDogMFxuICB9KTtcbi8vIGAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHRgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy0lc3RyaW5naXRlcmF0b3Jwcm90b3R5cGUlLm5leHRcbn0sIGZ1bmN0aW9uIG5leHQoKSB7XG4gIHZhciBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUodGhpcyk7XG4gIHZhciBzdHJpbmcgPSBzdGF0ZS5zdHJpbmc7XG4gIHZhciBpbmRleCA9IHN0YXRlLmluZGV4O1xuICB2YXIgcG9pbnQ7XG4gIGlmIChpbmRleCA+PSBzdHJpbmcubGVuZ3RoKSByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XG4gIHBvaW50ID0gY2hhckF0KHN0cmluZywgaW5kZXgpO1xuICBzdGF0ZS5pbmRleCArPSBwb2ludC5sZW5ndGg7XG4gIHJldHVybiB7IHZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2UgfTtcbn0pO1xuIiwiaWYgKCFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKSB7XHJcbiAgICBFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xyXG59XHJcblxyXG5pZiAoIUVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QpIHtcclxuICAgIEVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgIHZhciBlbCA9IHRoaXM7XHJcblxyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgaWYgKGVsLm1hdGNoZXMocykpIHJldHVybiBlbDtcclxuICAgICAgICAgICAgZWwgPSBlbC5wYXJlbnRFbGVtZW50IHx8IGVsLnBhcmVudE5vZGU7XHJcbiAgICAgICAgfSB3aGlsZSAoZWwgIT09IG51bGwgJiYgZWwubm9kZVR5cGUgPT09IDEpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxufVxyXG4iLCIvKiBGb250IEZhY2UgT2JzZXJ2ZXIgdjIuMS4wIC0gwqkgQnJhbSBTdGVpbi4gTGljZW5zZTogQlNELTMtQ2xhdXNlICovKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gbChhLGIpe2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI/YS5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsYiwhMSk6YS5hdHRhY2hFdmVudChcInNjcm9sbFwiLGIpfWZ1bmN0aW9uIG0oYSl7ZG9jdW1lbnQuYm9keT9hKCk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGZ1bmN0aW9uIGMoKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGMpO2EoKX0pOmRvY3VtZW50LmF0dGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZnVuY3Rpb24gaygpe2lmKFwiaW50ZXJhY3RpdmVcIj09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8XCJjb21wbGV0ZVwiPT1kb2N1bWVudC5yZWFkeVN0YXRlKWRvY3VtZW50LmRldGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsayksYSgpfSl9O2Z1bmN0aW9uIHQoYSl7dGhpcy5hPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5hLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsXCJ0cnVlXCIpO3RoaXMuYS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShhKSk7dGhpcy5iPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMuYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLmg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5mPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMuZz0tMTt0aGlzLmIuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMuYy5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtvdmVyZmxvdzpzY3JvbGw7Zm9udC1zaXplOjE2cHg7XCI7XG50aGlzLmYuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMuaC5zdHlsZS5jc3NUZXh0PVwiZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MjAwJTtoZWlnaHQ6MjAwJTtmb250LXNpemU6MTZweDttYXgtd2lkdGg6bm9uZTtcIjt0aGlzLmIuYXBwZW5kQ2hpbGQodGhpcy5oKTt0aGlzLmMuYXBwZW5kQ2hpbGQodGhpcy5mKTt0aGlzLmEuYXBwZW5kQ2hpbGQodGhpcy5iKTt0aGlzLmEuYXBwZW5kQ2hpbGQodGhpcy5jKX1cbmZ1bmN0aW9uIHUoYSxiKXthLmEuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO21pbi13aWR0aDoyMHB4O21pbi1oZWlnaHQ6MjBweDtkaXNwbGF5OmlubGluZS1ibG9jaztvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6YXV0bzttYXJnaW46MDtwYWRkaW5nOjA7dG9wOi05OTlweDt3aGl0ZS1zcGFjZTpub3dyYXA7Zm9udC1zeW50aGVzaXM6bm9uZTtmb250OlwiK2IrXCI7XCJ9ZnVuY3Rpb24geihhKXt2YXIgYj1hLmEub2Zmc2V0V2lkdGgsYz1iKzEwMDthLmYuc3R5bGUud2lkdGg9YytcInB4XCI7YS5jLnNjcm9sbExlZnQ9YzthLmIuc2Nyb2xsTGVmdD1hLmIuc2Nyb2xsV2lkdGgrMTAwO3JldHVybiBhLmchPT1iPyhhLmc9YiwhMCk6ITF9ZnVuY3Rpb24gQShhLGIpe2Z1bmN0aW9uIGMoKXt2YXIgYT1rO3ooYSkmJmEuYS5wYXJlbnROb2RlJiZiKGEuZyl9dmFyIGs9YTtsKGEuYixjKTtsKGEuYyxjKTt6KGEpfTtmdW5jdGlvbiBCKGEsYil7dmFyIGM9Ynx8e307dGhpcy5mYW1pbHk9YTt0aGlzLnN0eWxlPWMuc3R5bGV8fFwibm9ybWFsXCI7dGhpcy53ZWlnaHQ9Yy53ZWlnaHR8fFwibm9ybWFsXCI7dGhpcy5zdHJldGNoPWMuc3RyZXRjaHx8XCJub3JtYWxcIn12YXIgQz1udWxsLEQ9bnVsbCxFPW51bGwsRj1udWxsO2Z1bmN0aW9uIEcoKXtpZihudWxsPT09RClpZihKKCkmJi9BcHBsZS8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnZlbmRvcikpe3ZhciBhPS9BcHBsZVdlYktpdFxcLyhbMC05XSspKD86XFwuKFswLTldKykpKD86XFwuKFswLTldKykpLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtEPSEhYSYmNjAzPnBhcnNlSW50KGFbMV0sMTApfWVsc2UgRD0hMTtyZXR1cm4gRH1mdW5jdGlvbiBKKCl7bnVsbD09PUYmJihGPSEhZG9jdW1lbnQuZm9udHMpO3JldHVybiBGfVxuZnVuY3Rpb24gSygpe2lmKG51bGw9PT1FKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RyeXthLnN0eWxlLmZvbnQ9XCJjb25kZW5zZWQgMTAwcHggc2Fucy1zZXJpZlwifWNhdGNoKGIpe31FPVwiXCIhPT1hLnN0eWxlLmZvbnR9cmV0dXJuIEV9ZnVuY3Rpb24gTChhLGIpe3JldHVyblthLnN0eWxlLGEud2VpZ2h0LEsoKT9hLnN0cmV0Y2g6XCJcIixcIjEwMHB4XCIsYl0uam9pbihcIiBcIil9XG5CLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxrPWF8fFwiQkVTYnN3eVwiLHI9MCxuPWJ8fDNFMyxIPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhLGIpe2lmKEooKSYmIUcoKSl7dmFyIE09bmV3IFByb21pc2UoZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBlKCl7KG5ldyBEYXRlKS5nZXRUaW1lKCktSD49bj9iKEVycm9yKFwiXCIrbitcIm1zIHRpbWVvdXQgZXhjZWVkZWRcIikpOmRvY3VtZW50LmZvbnRzLmxvYWQoTChjLCdcIicrYy5mYW1pbHkrJ1wiJyksaykudGhlbihmdW5jdGlvbihjKXsxPD1jLmxlbmd0aD9hKCk6c2V0VGltZW91dChlLDI1KX0sYil9ZSgpfSksTj1uZXcgUHJvbWlzZShmdW5jdGlvbihhLGMpe3I9c2V0VGltZW91dChmdW5jdGlvbigpe2MoRXJyb3IoXCJcIituK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSl9LG4pfSk7UHJvbWlzZS5yYWNlKFtOLE1dKS50aGVuKGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHIpO2EoYyl9LFxuYil9ZWxzZSBtKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdigpe3ZhciBiO2lmKGI9LTEhPWYmJi0xIT1nfHwtMSE9ZiYmLTEhPWh8fC0xIT1nJiYtMSE9aCkoYj1mIT1nJiZmIT1oJiZnIT1oKXx8KG51bGw9PT1DJiYoYj0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCksQz0hIWImJig1MzY+cGFyc2VJbnQoYlsxXSwxMCl8fDUzNj09PXBhcnNlSW50KGJbMV0sMTApJiYxMT49cGFyc2VJbnQoYlsyXSwxMCkpKSxiPUMmJihmPT13JiZnPT13JiZoPT13fHxmPT14JiZnPT14JiZoPT14fHxmPT15JiZnPT15JiZoPT15KSksYj0hYjtiJiYoZC5wYXJlbnROb2RlJiZkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZCksY2xlYXJUaW1lb3V0KHIpLGEoYykpfWZ1bmN0aW9uIEkoKXtpZigobmV3IERhdGUpLmdldFRpbWUoKS1IPj1uKWQucGFyZW50Tm9kZSYmZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGQpLGIoRXJyb3IoXCJcIitcbm4rXCJtcyB0aW1lb3V0IGV4Y2VlZGVkXCIpKTtlbHNle3ZhciBhPWRvY3VtZW50LmhpZGRlbjtpZighMD09PWF8fHZvaWQgMD09PWEpZj1lLmEub2Zmc2V0V2lkdGgsZz1wLmEub2Zmc2V0V2lkdGgsaD1xLmEub2Zmc2V0V2lkdGgsdigpO3I9c2V0VGltZW91dChJLDUwKX19dmFyIGU9bmV3IHQoaykscD1uZXcgdChrKSxxPW5ldyB0KGspLGY9LTEsZz0tMSxoPS0xLHc9LTEseD0tMSx5PS0xLGQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtkLmRpcj1cImx0clwiO3UoZSxMKGMsXCJzYW5zLXNlcmlmXCIpKTt1KHAsTChjLFwic2VyaWZcIikpO3UocSxMKGMsXCJtb25vc3BhY2VcIikpO2QuYXBwZW5kQ2hpbGQoZS5hKTtkLmFwcGVuZENoaWxkKHAuYSk7ZC5hcHBlbmRDaGlsZChxLmEpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZCk7dz1lLmEub2Zmc2V0V2lkdGg7eD1wLmEub2Zmc2V0V2lkdGg7eT1xLmEub2Zmc2V0V2lkdGg7SSgpO0EoZSxmdW5jdGlvbihhKXtmPWE7digpfSk7dShlLFxuTChjLCdcIicrYy5mYW1pbHkrJ1wiLHNhbnMtc2VyaWYnKSk7QShwLGZ1bmN0aW9uKGEpe2c9YTt2KCl9KTt1KHAsTChjLCdcIicrYy5mYW1pbHkrJ1wiLHNlcmlmJykpO0EocSxmdW5jdGlvbihhKXtoPWE7digpfSk7dShxLEwoYywnXCInK2MuZmFtaWx5KydcIixtb25vc3BhY2UnKSl9KX0pfTtcIm9iamVjdFwiPT09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1COih3aW5kb3cuRm9udEZhY2VPYnNlcnZlcj1CLHdpbmRvdy5Gb250RmFjZU9ic2VydmVyLnByb3RvdHlwZS5sb2FkPUIucHJvdG90eXBlLmxvYWQpO30oKSk7XG4iLCJzZWxmLmZldGNofHwoc2VsZi5mZXRjaD1mdW5jdGlvbihlLG4pe3JldHVybiBuPW58fHt9LG5ldyBQcm9taXNlKGZ1bmN0aW9uKHQscyl7dmFyIHI9bmV3IFhNTEh0dHBSZXF1ZXN0LG89W10sdT1bXSxpPXt9LGE9ZnVuY3Rpb24oKXtyZXR1cm57b2s6Mj09KHIuc3RhdHVzLzEwMHwwKSxzdGF0dXNUZXh0OnIuc3RhdHVzVGV4dCxzdGF0dXM6ci5zdGF0dXMsdXJsOnIucmVzcG9uc2VVUkwsdGV4dDpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoci5yZXNwb25zZVRleHQpfSxqc29uOmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZShyLnJlc3BvbnNlVGV4dCkudGhlbihKU09OLnBhcnNlKX0sYmxvYjpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3IucmVzcG9uc2VdKSl9LGNsb25lOmEsaGVhZGVyczp7a2V5czpmdW5jdGlvbigpe3JldHVybiBvfSxlbnRyaWVzOmZ1bmN0aW9uKCl7cmV0dXJuIHV9LGdldDpmdW5jdGlvbihlKXtyZXR1cm4gaVtlLnRvTG93ZXJDYXNlKCldfSxoYXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGUudG9Mb3dlckNhc2UoKWluIGl9fX19O2Zvcih2YXIgYyBpbiByLm9wZW4obi5tZXRob2R8fFwiZ2V0XCIsZSwhMCksci5vbmxvYWQ9ZnVuY3Rpb24oKXtyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLnJlcGxhY2UoL14oLio/KTpbXlxcU1xcbl0qKFtcXHNcXFNdKj8pJC9nbSxmdW5jdGlvbihlLG4sdCl7by5wdXNoKG49bi50b0xvd2VyQ2FzZSgpKSx1LnB1c2goW24sdF0pLGlbbl09aVtuXT9pW25dK1wiLFwiK3Q6dH0pLHQoYSgpKX0sci5vbmVycm9yPXMsci53aXRoQ3JlZGVudGlhbHM9XCJpbmNsdWRlXCI9PW4uY3JlZGVudGlhbHMsbi5oZWFkZXJzKXIuc2V0UmVxdWVzdEhlYWRlcihjLG4uaGVhZGVyc1tjXSk7ci5zZW5kKG4uYm9keXx8bnVsbCl9KX0pO1xuIiwiaW1wb3J0IFwiLi9saWIvcG9seWZpbGxzXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcIi4vbGliL3V0aWxzXCI7XG5pbXBvcnQgVmFsaWRhdGlvbkV4Y2VwdGlvbiBmcm9tIFwiLi9saWIvVmFsaWRhdGlvbkV4Y2VwdGlvblwiO1xuaW1wb3J0IFVwbG9hZGVyRmlsZSBmcm9tIFwiLi9saWIvVXBsb2FkZXJGaWxlXCI7XG5cbi8qKlxuICogRGVmYXVsdCBwbHVnaW4gb3B0aW9uc1xuICogQHR5cGUge29iamVjdH1cbiAqL1xudmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgIGlucHV0OiAnaW5wdXRbdHlwZT1maWxlXScsXG4gICAgbXVsdGlwbGU6IGZhbHNlLFxuICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgIHNraXBNdHlwZUNoZWNrOiBbXSxcbiAgICBtYXhGaWxlczogMSxcbiAgICBtYXhTaXplOiBmYWxzZSxcbiAgICBkcm9wem9uZTogJy51cGxvYWRlcl9fZHJvcHpvbmUnLFxuICAgIHByZXZpb3VzRmlsZXNDb3VudDogMCxcbiAgICBoYW5kbGVyczoge30sXG4gICAgc3RyaW5nczoge1xuICAgICAgICBmaWxlVHlwZUVycm9yOiBcIkZpbGUgdHlwZSBpcyBub3Qgc3VwcG9ydGVkLiBQbGVhc2UgY2FuY2VsIGFuZCB0cnkgYWdhaW4uXCIsXG4gICAgICAgIHVwbG9hZEVycm9yOiBcIkVycm9yIHVwbG9hZGluZyBmaWxlLiBQbGVhc2UgY2FuY2VsIGFuZCB0cnkgYWdhaW4uXCIsXG4gICAgICAgIHVwbG9hZExpbWl0RXJyb3I6IFwiTm8gbW9yZSB0aGFuIHswfSBjYW4gYmUgdXBsb2FkZWQuXCIsXG4gICAgICAgIGZpbGVTaXplRXJyb3I6IFwiRmlsZSBzaXplIGV4Y2VlZHMgezB9IGxpbWl0LiBQbGVhc2UgY2FuY2VsIGFuZCB0cnkgYWdhaW4uXCIsXG4gICAgfVxufTtcblxuXG4vKipcbiAqIFByZWZpeCBmb3IgY29uc29sZSBlcnJvcnMgaW4gdGhpcyBwbHVnaW5zXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG52YXIgZXJyb3JzUHJlZml4ICAgPSBcIkFqYXhVcGxvYWRlciBFcnJvcjogXCI7XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGxvZyBlcnJvcnMgd2l0aCBwcmVmaXhcbiAqIEBwYXJhbSB7c3RyaW5nfSBtc2dcbiAqL1xuZnVuY3Rpb24gZGllKG1zZykge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JzUHJlZml4ICsgbXNnKTtcbn1cblxuXG4vKipcbiAqIHdvcmthcm91bmQgZm9yIGV4Y2VwdGlvbnNcbiAqL1xudmFyIEJyZWFrRXhjZXB0aW9uID0ge307XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7RWxlbWVudHxzdHJpbmd8alF1ZXJ5fSBlbGVtZW50XG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gQWpheFVwbG9hZGVyKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICBpZiAoIWVsZW1lbnQpXG4gICAgICAgIHJldHVybiBkaWUoJ05vIGVsZW1lbnQgaXMgcHJvdmlkZWQnKTtcblxuICAgIHRoaXMuZWxlbWVudCA9IHRoaXMucGFyc2VFbGVtZW50KGVsZW1lbnQpO1xuXG4gICAgaWYgKCF0aGlzLmVsZW1lbnQpXG4gICAgICAgIHJldHVybiBkaWUoJ05vIGVsZW1lbnQgaXMgcHJvdmlkZWQnKTtcblxuICAgIC8vIEJ1aWxkIHBsdWdpbiBvcHRpb25zXG4gICAgaWYgKCF0aGlzLmJ1aWxkT3B0aW9ucyhvcHRpb25zKSlcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgdGhpcy51cGxvYWRlZEZpbGVzID0gW107XG5cbiAgICB0aGlzLmluaXRpYWxpemUoKTtcbn1cblxuQWpheFVwbG9hZGVyLnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQWpheFVwbG9hZGVyLFxuXG4gICAgLyoqXG4gICAgICogR2V0IERPTSBFbGVtZW50IGZyb20gY3NzIHNlbGVjdG9yIG9yIGpRdWVyeSBvciBET00gZWxlbWVudFxuICAgICAqIEBwYXJhbSB7RWxlbWVudHxzdHJpbmd8alF1ZXJ5fSBlbGVtZW50XG4gICAgICogQHJldHVybnMge0VsZW1lbnR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwYXJzZUVsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIC8vIEVsZW1lbnQgaXMgcHJvdmlkZWRcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICBlbHNlIGlmIChlbGVtZW50IGluc3RhbmNlb2YgalF1ZXJ5KSAvLyBqUXVlcnkgb2JqZWN0IGlzIHByb3ZpZGVkXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFswXTtcblxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gXCJzdHJpbmdcIikgLy8gU2VsZWN0b3IgcHJvdmlkZWRcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIFBsdWdpbiBhdHRyaWJ1dGVzXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7dm9pZHxib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgYnVpbGRPcHRpb25zOiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbihkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIGlucHV0IGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICh0aGlzLmdldElucHV0RnJvbU9wdGlvbnMob3B0aW9ucykgIT09IHRydWUpIHJldHVybiBmYWxzZTtcblxuICAgICAgICAvLyBNYWtlIHN1cmUgYWpheCB1cmwgaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKHRoaXMuZ2V0QWpheFVybEZyb21PcHRpb25zKG9wdGlvbnMpICE9PSB0cnVlKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgLy8gR2V0IGRyb3Agem9uZVxuICAgICAgICB0aGlzLmdldERyb3BBcmVhRnJvbU9wdGlvbnMob3B0aW9ucyk7XG5cbiAgICAgICAgdmFyIGRhdGFzZXQgICAgID0gdGhpcy5pbnB1dC5kYXRhc2V0O1xuICAgICAgICB0aGlzLm11bHRpcGxlICAgPSB0aGlzLmlucHV0Lm11bHRpcGxlIHx8IG9wdGlvbnMubXVsdGlwbGU7XG4gICAgICAgIHRoaXMubWF4RmlsZXMgICA9IGRhdGFzZXQubWF4RmlsZXMgfHwgb3B0aW9ucy5tYXhGaWxlcyA/IHBhcnNlSW50KGRhdGFzZXQubWF4RmlsZXMgfHwgb3B0aW9ucy5tYXhGaWxlcykgOiBmYWxzZTtcbiAgICAgICAgdGhpcy5tYXhTaXplICAgID0gZGF0YXNldC5tYXhTaXplIHx8IG9wdGlvbnMubWF4U2l6ZSA/IHBhcnNlSW50KGRhdGFzZXQubWF4U2l6ZSB8fCBvcHRpb25zLm1heFNpemUpIDogZmFsc2U7XG4gICAgICAgIHRoaXMuZmlsZXNDb3VudCA9IHBhcnNlSW50KGRhdGFzZXQucHJldmlvdXNGaWxlc0NvdW50IHx8IG9wdGlvbnMucHJldmlvdXNGaWxlc0NvdW50KTtcblxuICAgICAgICB2YXIgYWxsb3dlZCA9IGRhdGFzZXQuYWxsb3dlZCB8fCBvcHRpb25zLmFsbG93ZWQ7XG4gICAgICAgIGlmICh0eXBlb2YgYWxsb3dlZCA9PT0gXCJzdHJpbmdcIikgdGhpcy5hbGxvd2VkVHlwZXMgPSBhbGxvd2VkLnNwbGl0KCcsJyk7XG4gICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYWxsb3dlZCkpIHRoaXMuYWxsb3dlZFR5cGVzID0gYWxsb3dlZDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2tpcCBtaW1lIHR5cGUgY2hlY2tzXG4gICAgICAgICAqIEFuIGFycmF5IG9mIGZpbGUgdHlwZXMgdG8gYmUgdmFsaWRhdGVkIGJ5IGV4dGVuc2lvbiBvbmx5LCB3aXRob3V0IG1pbWUgdHlwZSBjaGVja1xuICAgICAgICAgKi9cbiAgICAgICAgdmFyIHNraXBNdHlwZUNoZWNrID0gZGF0YXNldC5za2lwTXR5cGVDaGVjayB8fCBvcHRpb25zLnNraXBNdHlwZUNoZWNrO1xuICAgICAgICBpZiAodHlwZW9mIHNraXBNdHlwZUNoZWNrID09PSBcInN0cmluZ1wiKSB0aGlzLnNraXBNdHlwZUNoZWNrID0gc2tpcE10eXBlQ2hlY2suc3BsaXQoJywnKTtcbiAgICAgICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShza2lwTXR5cGVDaGVjaykpIHRoaXMuc2tpcE10eXBlQ2hlY2sgPSBza2lwTXR5cGVDaGVjaztcblxuICAgICAgICAvLyBzZXQgaGFuZGxlcnNcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IG9wdGlvbnMuaGFuZGxlcnM7XG5cbiAgICAgICAgdGhpcy5zdHJpbmdzID0gb3B0aW9ucy5zdHJpbmdzO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybnMge3ZvaWR8Ym9vbGVhbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGdldElucHV0RnJvbU9wdGlvbnM6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuaW5wdXQgPSB0aGlzLnBhcnNlRWxlbWVudChvcHRpb25zLmlucHV0KTtcblxuICAgICAgICAvLyBpZiBzdGlsbCBjYW5ub3QgZmluZCB0aGUgaW5wdXQgdGhlbiBwbHVnaW4gYnJlYWtzXG4gICAgICAgIGlmICghdGhpcy5pbnB1dCB8fCAhKHRoaXMuaW5wdXQubWF0Y2hlcyhcImlucHV0W3R5cGU9ZmlsZV1cIikpKVxuICAgICAgICAgICAgcmV0dXJuIGRpZSgnSW52YWxpZCBpbnB1dCBwcm92aWRlZCcpO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybnMge3ZvaWR8Ym9vbGVhbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGdldEFqYXhVcmxGcm9tT3B0aW9uczogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlucHV0LmRhdGFzZXQuYWpheFVybCAmJiAhb3B0aW9ucy5hamF4KSByZXR1cm4gZGllKCdBamF4IHVybCBpcyBub3QgcHJvdmlkZWQnKTtcbiAgICAgICAgdGhpcy5hamF4ID0ge307XG4gICAgICAgIGlmICh0aGlzLmlucHV0LmRhdGFzZXQuYWpheFVybCkge1xuICAgICAgICAgICAgdGhpcy5hamF4LnVybCA9IHRoaXMuaW5wdXQuZGF0YXNldC5hamF4VXJsO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmFqYXggPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYWpheC51cmwgPSBvcHRpb25zLmFqYXg7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMuYWpheCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zLmFqYXgudXJsKSByZXR1cm4gZGllKCdBamF4IHVybCBpcyBub3QgcHJvdmlkZWQnKTtcbiAgICAgICAgICAgIHRoaXMuYWpheCA9IG9wdGlvbnMuYWpheDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlucHV0LmRhdGFzZXQuYWpheERhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuYWpheC5kYXRhID0gSlNPTi5wYXJzZSh0aGlzLmlucHV0LmRhdGFzZXQuYWpheERhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZ2V0RHJvcEFyZWFGcm9tT3B0aW9uczogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5kcm9wQXJlYSA9IHRoaXMucGFyc2VFbGVtZW50KG9wdGlvbnMuZHJvcHpvbmUpO1xuICAgICAgICBpZiAoIXRoaXMuZHJvcEFyZWEpIHtcbiAgICAgICAgICAgIHRoaXMuZHJvcEFyZWEgPSB0aGlzLmVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHVwbG9hZGVyIGV2ZW50c1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgLy8gYXV0b21hdGljYWxseSBzdWJtaXQgdGhlIHVwbG9hZGVyIG9uIGZpbGUgc2VsZWN0XG4gICAgICAgIHRoaXMuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIF90aGlzLnByb2Nlc3NGaWxlcyhlLnRhcmdldC5maWxlcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLmRyb3BBcmVhKSB7XG4gICAgICAgICAgICAvLyBkcmFnJmRyb3AgZmlsZXMgaWYgdGhlIGZlYXR1cmUgaXMgYXZhaWxhYmxlXG4gICAgICAgICAgICBbJ2RyYWcnLCAnZHJhZ3N0YXJ0JywgJ2RyYWdlbmQnLCAnZHJhZ292ZXInLCAnZHJhZ2VudGVyJywgJ2RyYWdsZWF2ZScsICdkcm9wJ10uZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5kcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBwcmV2ZW50aW5nIHRoZSB1bndhbnRlZCBiZWhhdmlvdXJzXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgWydkcmFnb3ZlcicsICdkcmFnZW50ZXInXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmRyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHJvcEFyZWEuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ292ZXInKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgWydkcmFnbGVhdmUnLCAnZHJhZ2VuZCcsICdkcm9wJ10uZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5kcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRyb3BBcmVhLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdvdmVyJyk7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmRyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnByb2Nlc3NGaWxlcyhlLmRhdGFUcmFuc2Zlci5maWxlcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE9uIHNlbGVjdGluZy9kcm9wcGluZyBmaWxlc1xuICAgICAqIEBwYXJhbSB7RmlsZUxpc3R9IGZpbGVzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb2Nlc3NGaWxlczogZnVuY3Rpb24gKGZpbGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5oYW5kbGVycy5zdGFydCA9PT0gXCJmdW5jdGlvblwiKSB0aGlzLmhhbmRsZXJzLnN0YXJ0KHRoaXMpO1xuICAgICAgICB0aGlzLmN1cnJlbnRRdWV1ZUxlbmd0aCA9IDA7XG4gICAgICAgIHZhciBzdGFydEluZGV4V2l0aCAgICAgID0gX3RoaXMuZmlsZXNDb3VudDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBmaWxlcyBsaW1pdCBmaXJzdFxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVldWVMZW5ndGggPSBmaWxlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZmlsZXMsIGZ1bmN0aW9uIChmaWxlLCBpbmRleCkge1xuXG4gICAgICAgICAgICAgICAgX3RoaXMudmFsaWRhdGVOdW1iZXJPZkZpbGVzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgb2JqZWN0IGZvciB0aGUgZmlsZVxuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gbmV3IFVwbG9hZGVyRmlsZShmaWxlLCBzdGFydEluZGV4V2l0aCArIGluZGV4KTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIF90aGlzLmhhbmRsZXJzLmJlZm9yZVVwbG9hZCA9PT0gXCJmdW5jdGlvblwiKSBfdGhpcy5oYW5kbGVycy5iZWZvcmVVcGxvYWQoX3RoaXMsIGl0ZW0pO1xuXG4gICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgdGhlIGZpbGVcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy52YWxpZGF0ZUZpbGUoaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbGVzQ291bnQrKzsgLy8gaW5jcmVtZW50IGZpbGVzIGNvdW50IGlmIGZpbGUgaXMgdmFsaWRhdGVkXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBfdGhpcy5oYW5kbGVycy52YWxpZGF0aW9uRXJyb3IgPT09IFwiZnVuY3Rpb25cIikgX3RoaXMuaGFuZGxlcnMudmFsaWRhdGlvbkVycm9yKF90aGlzLCBleCwgaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMuaGFuZGxlcnMuY29tcGxldGUgID09PSBcImZ1bmN0aW9uXCIpIF90aGlzLmhhbmRsZXJzLmNvbXBsZXRlKF90aGlzLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFVwbG9hZCB0aGUgZmlsZVxuICAgICAgICAgICAgICAgIF90aGlzLnVwbG9hZEZpbGUoaXRlbSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuY3VycmVudFF1ZXVlTGVuZ3RoLS07XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXhjZXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBfdGhpcy5oYW5kbGVycy52YWxpZGF0aW9uRXJyb3IgPT09IFwiZnVuY3Rpb25cIikgX3RoaXMuaGFuZGxlcnMudmFsaWRhdGlvbkVycm9yKF90aGlzLCBleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChleCAhPT0gQnJlYWtFeGNlcHRpb24pIHRocm93IGV4O1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIHRoZSBkcm9wcGVkIGZpbGVzIGFyZSBsZXNzIHRoYW4gbWF4aW11bSBhbGxvd2VkXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHZhbGlkYXRlTnVtYmVyT2ZGaWxlczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5tYXhGaWxlcyAmJiAodGhpcy5maWxlc0NvdW50ICsgMSA+IHRoaXMubWF4RmlsZXMpKSB7XG4gICAgICAgICAgICB2YXIgc3RyO1xuICAgICAgICAgICAgaWYgKHRoaXMubWF4RmlsZXMgPT09IDEpIHN0ciA9IHRoaXMubWF4RmlsZXMgKyBcIiBmaWxlXCI7XG4gICAgICAgICAgICBlbHNlIHN0ciA9IHRoaXMubWF4RmlsZXMgKyBcIiBmaWxlc1wiO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FeGNlcHRpb24odGhpcy5zdHJpbmdzLnVwbG9hZExpbWl0RXJyb3IuZm9ybWF0KHN0ciksIHV0aWxzLmNvbnN0YW50cy5HTE9CQUxfRVJSKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBGaWxlIGJlZm9yZSBxdWV1ZWluZyBpdFxuICAgICAqIEBwYXJhbSB7VXBsb2FkZXJGaWxlfSBpdGVtXG4gICAgICogQHRocm93cyBWYWxpZGF0aW9uRXhjZXB0aW9uXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHZhbGlkYXRlRmlsZTogZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAvLyBjaGVjayB1cGxvYWQgbGltaXQgKGFnYWluKVxuICAgICAgICBpZiAodGhpcy5tYXhGaWxlcyA+IDAgJiYgKHRoaXMuZmlsZXNDb3VudCA+PSB0aGlzLm1heEZpbGVzKSkge1xuICAgICAgICAgICAgdmFyIHN0cjtcbiAgICAgICAgICAgIGlmICh0aGlzLm1heEZpbGVzID09PSAxKSBzdHIgPSB0aGlzLm1heEZpbGVzICsgXCIgZmlsZVwiO1xuICAgICAgICAgICAgZWxzZSBzdHIgPSB0aGlzLm1heEZpbGVzICsgXCIgZmlsZXNcIjtcbiAgICAgICAgICAgIGl0ZW0uc2V0U3RhdGUoJ3VwbG9hZC1lcnJvcicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FeGNlcHRpb24odGhpcy5zdHJpbmdzLnVwbG9hZExpbWl0RXJyb3IuZm9ybWF0KHN0ciksIHV0aWxzLmNvbnN0YW50cy5HTE9CQUxfRVJSKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNoZWNrIGZpbGUgdHlwZVxuICAgICAgICB0aGlzLnZhbGlkYXRlVHlwZShpdGVtKTtcblxuICAgICAgICAvLyBjaGVjayBmaWxlIHNpemVcbiAgICAgICAgdGhpcy52YWxpZGF0ZVNpemUoaXRlbSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1VwbG9hZGVyRmlsZX0gaXRlbVxuICAgICAqIEB0aHJvd3MgVmFsaWRhdGlvbkV4Y2VwdGlvblxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZVR5cGUoaXRlbSkge1xuICAgICAgICAvLyBpZiBleGlzdCBpbiBza2lwIG1pbWUgdHlwZSBjaGVjayB0aGVuIHJldHVyblxuICAgICAgICBjb25zdCBleHRlbnNpb24gPSBpdGVtLmZpbGVFeHRlbnNpb24oKTtcbiAgICAgICAgaWYodGhpcy5za2lwTXR5cGVDaGVjay5sZW5ndGggJiYgdGhpcy5za2lwTXR5cGVDaGVjay5pbmRleE9mKGV4dGVuc2lvbikgIT09IC0xKSByZXR1cm47XG5cbiAgICAgICAgLy8gY2hlY2sgbWltZSB0eXBlXG4gICAgICAgIGNvbnN0IHR5cGUgPSBpdGVtLmdldFR5cGUoKTtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dlZFR5cGVzICYmIHRoaXMuYWxsb3dlZFR5cGVzLmluZGV4T2YodHlwZSkgPT09IC0xKSB7XG4gICAgICAgICAgICBpdGVtLnNldFN0YXRlKCdmaWxlcy1lcnJvcicpO1xuICAgICAgICAgICAgY29uc3QgYWxsb3dlZCA9IHRoaXMuYWxsb3dlZFR5cGVzLmpvaW4oJywgJyk7XG4gICAgICAgICAgICBjb25zdCBlcnJUeXBlID0gdGhpcy5tdWx0aXBsZSA/IHV0aWxzLmNvbnN0YW50cy5GSUxFU19FUlIgOiB1dGlscy5jb25zdGFudHMuR0xPQkFMX0VSUjtcbiAgICAgICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXhjZXB0aW9uKHRoaXMuc3RyaW5ncy5maWxlVHlwZUVycm9yLmZvcm1hdChhbGxvd2VkKSwgZXJyVHlwZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7VXBsb2FkZXJGaWxlfSBpdGVtXG4gICAgICogQHRocm93cyBWYWxpZGF0aW9uRXhjZXB0aW9uXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHZhbGlkYXRlU2l6ZShpdGVtKSB7XG4gICAgICAgIGNvbnN0IGZpbGVTaXplID0gaXRlbS5maWxlU2l6ZSgpO1xuICAgICAgICBpZiAodGhpcy5tYXhTaXplICYmIGZpbGVTaXplID4gdGhpcy5tYXhTaXplKSB7XG4gICAgICAgICAgICBjb25zdCBtYXhTaXplSHVtYW4gPSB1dGlscy5tZXRob2RzLmZpbGVTaXplSHVtYW4odGhpcy5tYXhTaXplKTtcbiAgICAgICAgICAgIGl0ZW0uc2V0U3RhdGUoJ2ZpbGVzLWVycm9yJyk7XG4gICAgICAgICAgICBjb25zdCBlcnJUeXBlID0gdGhpcy5tdWx0aXBsZSA/IHV0aWxzLmNvbnN0YW50cy5GSUxFU19FUlIgOiB1dGlscy5jb25zdGFudHMuR0xPQkFMX0VSUjtcbiAgICAgICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXhjZXB0aW9uKHRoaXMuc3RyaW5ncy5maWxlU2l6ZUVycm9yLmZvcm1hdChtYXhTaXplSHVtYW4pLCBlcnJUeXBlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBVcGxvYWQgRmlsZVxuICAgICAqIEBwYXJhbSB7VXBsb2FkZXJGaWxlfSBpdGVtXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHVwbG9hZEZpbGU6IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgLy8gY3JlYXRlIFhIUiBvYmplY3RcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgd2luZG93LlhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgICAgLy8gYWRkIHByb2dyZXNzIGV2ZW50c1xuICAgICAgICByZXF1ZXN0LnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgX3RoaXMub25YaHJQcm9ncmVzcyhldnQsIGl0ZW0pO1xuICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIF90aGlzLm9uWGhyUHJvZ3Jlc3MoZXZ0LCBpdGVtKTtcbiAgICAgICAgfSwgZmFsc2UpO1xuXG4gICAgICAgIC8vIG9wZW4gY29ubmVjdGlvblxuICAgICAgICByZXF1ZXN0Lm9wZW4oJ1BPU1QnLCBfdGhpcy5hamF4LnVybCwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gc2V0IHJlcXVlc3QgaGVhZGVyc1xuICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XG5cbiAgICAgICAgLy8gZGVhbCB3aXRoIHJlc3BvbnNlXG4gICAgICAgIHJlcXVlc3Qub25sb2FkICA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIVxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBsb2FkU3VjY2VzcyhkYXRhLCBpdGVtKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JhcCFcbiAgICAgICAgICAgICAgICBfdGhpcy51cGxvYWRFcnJvcihpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMuaGFuZGxlcnMuY29tcGxldGUgID09PSBcImZ1bmN0aW9uXCIpIF90aGlzLmhhbmRsZXJzLmNvbXBsZXRlKF90aGlzLCBpdGVtKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gQ3JhcCBhZ2FpbiFcbiAgICAgICAgICAgIF90aGlzLnVwbG9hZEVycm9yKGl0ZW0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGl0ZW0uc2V0UmVxdWVzdChyZXF1ZXN0KTtcblxuICAgICAgICAvLyBnYXRoZXJpbmcgdGhlIGZvcm0gZGF0YVxuICAgICAgICB2YXIgYWpheERhdGEgPSB0aGlzLmdlbmVyYXRlRm9ybURhdGEoaXRlbSk7XG4gICAgICAgIC8vIHNlbmQgaXRcbiAgICAgICAgcmVxdWVzdC5zZW5kKGFqYXhEYXRhKTtcblxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHYXRoZXIgRm9ybSBkYXRhIHRvIGJlIHNlbnQgaW4gdGhlIEFKQVggcmVxdWVzdFxuICAgICAqIEBwYXJhbSB7VXBsb2FkZXJGaWxlfSBpdGVtXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGdlbmVyYXRlRm9ybURhdGE6IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBhamF4RGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICBpZiAodGhpcy5hamF4LmRhdGEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmFqYXguZGF0YSkge1xuICAgICAgICAgICAgICAgIGFqYXhEYXRhLmFwcGVuZChrZXksIHRoaXMuYWpheC5kYXRhW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFqYXhEYXRhLmFwcGVuZChcImZpbGVzXCIsIGl0ZW0uZ2V0RmlsZSgpKTtcbiAgICAgICAgcmV0dXJuIGFqYXhEYXRhO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldnRcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvblhoclByb2dyZXNzOiBmdW5jdGlvbiAoZXZ0LCBpdGVtKSB7XG4gICAgICAgIGlmIChldnQubGVuZ3RoQ29tcHV0YWJsZSkge1xuICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSAoZXZ0LmxvYWRlZCAvIGV2dC50b3RhbCkgKiAxMDA7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuaGFuZGxlcnMucHJvZ3Jlc3MgPT09IFwiZnVuY3Rpb25cIikgdGhpcy5oYW5kbGVycy5wcm9ncmVzcyh0aGlzLCBwZXJjZW50YWdlLCBpdGVtKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayBmb3IgWEhSIFN1Y2Nlc3Mgc3RhdHVzXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gaXRlbVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB1cGxvYWRTdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSwgaXRlbSkge1xuICAgICAgICAvLyBjaGVjayByZXN1bHQgZnJvbSBiYWNrZW5kXG4gICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MgPT09IHRydWUpIHsgLy8gRmlsZSBpcyB1cGxvYWRlZFxuICAgICAgICAgICAgaXRlbS5zZXRTdGF0ZShcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLnVwbG9hZGVkRmlsZXMucHVzaChpdGVtKTtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmhhbmRsZXJzLnN1Y2Nlc3MgPT09IFwiZnVuY3Rpb25cIikgdGhpcy5oYW5kbGVycy5zdWNjZXNzKHRoaXMsIGl0ZW0sIGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5maXJlKFwic3VjY2Vzczp1cGxvYWRlclwiLCB7aXRlbTogaXRlbSwgaW5zdGFuY2U6IHRoaXN9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsgLy8gRmlsZSBpcyByZWZ1c2VkXG4gICAgICAgICAgICBpdGVtLnNldFN0YXRlKFwiZmlsZXMtZXJyb3JcIik7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuaGFuZGxlcnMuZXJyb3IgPT09IFwiZnVuY3Rpb25cIikgdGhpcy5oYW5kbGVycy5lcnJvcih0aGlzLCBpdGVtLCBkYXRhLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGZvciBYSFIgRmFpbCBzdGF0dXNcbiAgICAgKiBAcGFyYW0ge1VwbG9hZGVyRmlsZX0gaXRlbVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB1cGxvYWRFcnJvcjogZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5zZXRTdGF0ZShcInVwbG9hZC1lcnJvclwiKTtcbiAgICAgICAgdGhpcy5maWxlc0NvdW50LS07IC8vIGlmIHRoZSBmaWxlIGNvdWxkbid0IGJlIHVwbG9hZGVkIHRoZW4gZGVjcmVhc2UgZmlsZXMgY291bnRcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmhhbmRsZXJzLmVycm9yID09PSBcImZ1bmN0aW9uXCIpIHRoaXMuaGFuZGxlcnMuZXJyb3IodGhpcywgaXRlbSwgdGhpcy5zdHJpbmdzLnVwbG9hZEVycm9yKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVzZXQgdXBsb2FkZXJcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51cGxvYWRlZEZpbGVzID0gW107XG4gICAgICAgIHRoaXMuZmlsZXNDb3VudCAgICA9IDA7XG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWUgICA9IFwiXCI7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5oYW5kbGVycy5yZXNldCA9PT0gXCJmdW5jdGlvblwiKSB0aGlzLmhhbmRsZXJzLnJlc2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiByZW1vdmUgZmlsZSBmcm9tIHVwbG9hZGVkIGZpbGVzXG4gICAgICogQHBhcmFtIGluZGV4XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHJlbW92ZUZpbGU6IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0aGlzLnVwbG9hZGVkRmlsZXMgPSB0aGlzLnVwbG9hZGVkRmlsZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5pbmRleCA9PT0gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuZmlsZXNDb3VudC0tOyAvLyBkZWNyZW1lbnQgZmlsZXMgY291bnRcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogYWJvcnQgdXBsb2FkaW5nIHRoZSBmaWxlXG4gICAgICogQHBhcmFtIHtVcGxvYWRlckZpbGV9IGl0ZW1cbiAgICAgKi9cbiAgICBhYm9ydEZpbGU6IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGl0ZW0uYWJvcnQoKTtcbiAgICAgICAgdGhpcy5maWxlc0NvdW50LS07IC8vIGRlY3JlbWVudCBmaWxlcyBjb3VudFxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBGaWxsIFVwbG9hZGVkIEZpbGVzIGFycmF5IHdpdGggdGhlIHNhdmVkIGZpbGVzXG4gICAgICogQHBhcmFtIHthcnJheX0gZmlsZXNcbiAgICAgKi9cbiAgICByZWZyZXNoUHJldmlvdXNVcGxvYWRlZEZpbGVzOiBmdW5jdGlvbihmaWxlcykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHRoaXMudXBsb2FkZWRGaWxlcyA9IFtdO1xuICAgICAgICBmaWxlcy5mb3JFYWNoKGZ1bmN0aW9uKGZpbGUsIGkpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gbmV3IFVwbG9hZGVyRmlsZShmaWxlLCBpKTtcbiAgICAgICAgICAgIHRoYXQudXBsb2FkZWRGaWxlcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5maWxlc0NvdW50ID0gdGhpcy51cGxvYWRlZEZpbGVzLmxlbmd0aDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRmlyZSBjdXN0b20ganMgZXZlbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBmaXJlOiBmdW5jdGlvbiAobmFtZSwgZGF0YSkge1xuICAgICAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQobmFtZSwgeyBkZXRhaWw6IGRhdGEgfSk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG59O1xuXG5cbmV4cG9ydCBkZWZhdWx0IEFqYXhVcGxvYWRlcjsiLCJpbXBvcnQgdXRpbHMgZnJvbSBcIi4vdXRpbHNcIjtcblxuLyoqXG4gKiBVcGxvYWRlciBGaWxlIEl0ZW1cbiAqIEBwYXJhbSB7RmlsZXxzdHJpbmd9IGZpbGVcbiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFVwbG9hZGVyRmlsZShmaWxlLCBpbmRleCkge1xuXG4gICAgLyoqXG4gICAgICogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoaXMgZmlsZVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5pbmRleCA9IGluZGV4O1xuXG4gICAgLyoqXG4gICAgICogRmlsZSBPYmplY3QgdG8gYmUgdXBsb2FkZWRcbiAgICAgKiBAdHlwZSB7RmlsZXxzdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5maWxlID0gZmlsZTtcblxuXG4gICAgLyoqXG4gICAgICogQ3VycmVudCBzdGF0ZVxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5zdGF0ZSA9ICd1cGxvYWRpbmcnO1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAdHlwZSB7WE1MSHR0cFJlcXVlc3R8bnVsbH1cbiAgICAgKi9cbiAgICB0aGlzLnJlcXVlc3QgPSBudWxsO1xufVxuXG5VcGxvYWRlckZpbGUucHJvdG90eXBlID0ge1xuXG4gICAgY29uc3RydWN0b3I6IFVwbG9hZGVyRmlsZSxcblxuICAgIC8qKlxuICAgICAqIEdldCBpbmRleCBvZiB0aGUgZmlsZVxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0SW5kZXg6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBmaWxlIG9iamVjdCBpdHNlbGZcbiAgICAgKiBAcmV0dXJucyB7RmlsZX1cbiAgICAgKi9cbiAgICBnZXRGaWxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZ2V0IHRoZSBmaWxlIHNpemVcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIGZpbGVTaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbGUuc2l6ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZ2V0IGZpbGUgc2l6ZSBpbiBodW1hbiByZWFkYWJsZSBmb3JtYXRcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBmaWxlU2l6ZUh1bWFuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1dGlscy5tZXRob2RzLmZpbGVTaXplSHVtYW4odGhpcy5maWxlLnNpemUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBnZXQgdGhlIGZpbGUgbmFtZVxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgICovXG4gICAgZmlsZU5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZpbGUgPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maWxlO1xuICAgICAgICByZXR1cm4gdGhpcy5maWxlLm5hbWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IFtudW1iZXJPZkNoYXJdXG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKi9cbiAgICBmaWxlTmFtZVRydW5jYXRlZDogZnVuY3Rpb24gKG51bWJlck9mQ2hhcikge1xuICAgICAgICByZXR1cm4gdXRpbHMubWV0aG9kcy50cnVuY2F0ZSh0aGlzLmZpbGUubmFtZSwgbnVtYmVyT2ZDaGFyIHx8IDUzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBleHRlbnNpb24gb2YgdGhlIGZpbGVcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIGZpbGVFeHRlbnNpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdXRpbHMubWV0aG9kcy5maWxlRXh0ZW5zaW9uKHRoaXMuZmlsZS5uYW1lKVxuICAgIH0sXG5cbiAgICBnZXRUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWxlLnR5cGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCB1cGxvYWQgQUpBWCByZXF1ZXN0XG4gICAgICogQHBhcmFtIHtYTUxIdHRwUmVxdWVzdH0geGhyXG4gICAgICovXG4gICAgc2V0UmVxdWVzdDogZnVuY3Rpb24gKHhocikge1xuICAgICAgICB0aGlzLnJlcXVlc3QgPSB4aHI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB1cGxvYWQgQUpBWCByZXF1ZXN0XG4gICAgICogQHJldHVybnMge1hNTEh0dHBSZXF1ZXN0fVxuICAgICAqL1xuICAgIGdldFJlcXVlc3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU3RvcCB1cGxvYWRpbmcgb3BlcmF0aW9uLCBjYW5jZWxzIHRoZSBIVFRQIHJlcXVlc3RcbiAgICAgKi9cbiAgICBhYm9ydDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0KVxuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFib3J0KClcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSB1cGxvYWRpbmcgZmlsZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuZXdTdGF0ZVxuICAgICAqL1xuICAgIHNldFN0YXRlOiBmdW5jdGlvbiAobmV3U3RhdGUpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IG5ld1N0YXRlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHVwbG9hZGluZyBmaWxlXG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXRTdGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZTtcbiAgICB9XG59O1xuXG5cbmV4cG9ydCBkZWZhdWx0IFVwbG9hZGVyRmlsZTsiLCJpbXBvcnQge2NvbnN0YW50c30gZnJvbSBcIi4vdXRpbHNcIjtcblxuLyoqXG4gKiBVcGxvYWRlZCBGaWxlIFZhbGlkYXRpb24gRXhjZXB0aW9uXG4gKlxuICogQHBhcmFtIG1lc3NhZ2VcbiAqIEBwYXJhbSB0eXBlXG4gKiBAcGFyYW0gaXRlbVxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFZhbGlkYXRpb25FeGNlcHRpb24obWVzc2FnZSwgdHlwZSwgaXRlbSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLml0ZW0gPSBpdGVtO1xufVxuXG5WYWxpZGF0aW9uRXhjZXB0aW9uLnByb3RvdHlwZS5pc0dsb2JhbEVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnR5cGUgPT09IGNvbnN0YW50cy5HTE9CQUxfRVJSO1xufTtcblxuIiwiLy9cbi8vIFBvbHlmaWxsc1xuLy9cblxuaW1wb3J0ICcuLi8uLi9wb2x5ZmlsbHMvanMvRWxlbWVudC9jbG9zZXN0J1xuaW1wb3J0ICcuLi8uLi9wb2x5ZmlsbHMvanMvRWxlbWVudC9yZW1vdmUnXG5pbXBvcnQgJy4uLy4uL3BvbHlmaWxscy9qcy9TdHJpbmcvZm9ybWF0J1xuaW1wb3J0ICcuLi8uLi9wb2x5ZmlsbHMvanMvT2JqZWN0LmFzc2lnbidcbmltcG9ydCAnLi4vLi4vcG9seWZpbGxzL2pzL0N1c3RvbUV2ZW50J1xuIiwiZXhwb3J0IHZhciBjb25zdGFudHMgPSB7XG4gICAgR0xPQkFMX0VSUjogMCxcbiAgICBGSUxFU19FUlI6IDEsXG4gICAgVVBMT0FEX0VSUjogMlxufTtcblxuZXhwb3J0IHZhciBtZXRob2RzID0ge1xuICAgIHRyaWdnZXI6IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudCkge1xuICAgICAgICB2YXIgdGhlRXZlbnQ7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoZUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcbiAgICAgICAgICAgIHRoZUV2ZW50LmluaXRFdmVudChldmVudCwgZmFsc2UsIHRydWUpO1xuICAgICAgICB9IGVsc2UgaWYoZXZlbnQgaW5zdGFuY2VvZiBFdmVudCkge1xuICAgICAgICAgICAgdGhlRXZlbnQgPSBldmVudDtcbiAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBlbGVtZW50LmRpc3BhdGNoRXZlbnQodGhlRXZlbnQpO1xuICAgIH0sXG4gICAgZmFkZU91dDogZnVuY3Rpb24gKGVsLCBjYWxsYmFjaykge1xuICAgICAgICBlbC5zdHlsZS5vcGFjaXR5ID0gMTtcblxuICAgICAgICB2YXIgbGFzdCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgdGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVsLnN0eWxlLm9wYWNpdHkgPSArZWwuc3R5bGUub3BhY2l0eSAtIChuZXcgRGF0ZSgpIC0gbGFzdCkgLyA0MDA7XG4gICAgICAgICAgICBsYXN0ID0gK25ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgIGlmICgrZWwuc3R5bGUub3BhY2l0eSA+IDApIHtcbiAgICAgICAgICAgICAgICAod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSAmJiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljaykpIHx8IHNldFRpbWVvdXQodGljaywgMTYpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHRpY2soKTtcbiAgICB9LFxuICAgIHRydW5jYXRlOiBmdW5jdGlvbiAoZnVsbFN0ciwgc3RyTGVuLCBzZXBhcmF0b3IpIHtcbiAgICAgICAgaWYgKGZ1bGxTdHIubGVuZ3RoIDw9IHN0ckxlbikgcmV0dXJuIGZ1bGxTdHI7XG5cbiAgICAgICAgc2VwYXJhdG9yID0gc2VwYXJhdG9yIHx8ICcuLi4nO1xuXG4gICAgICAgIHZhciBzZXBMZW4gPSBzZXBhcmF0b3IubGVuZ3RoLFxuICAgICAgICAgICAgY2hhcnNUb1Nob3cgPSBzdHJMZW4gLSBzZXBMZW4sXG4gICAgICAgICAgICBmcm9udENoYXJzID0gY2hhcnNUb1Nob3cgLSA3LFxuICAgICAgICAgICAgYmFja0NoYXJzID0gNztcblxuICAgICAgICByZXR1cm4gZnVsbFN0ci5zdWJzdHIoMCwgZnJvbnRDaGFycykgK1xuICAgICAgICAgICAgc2VwYXJhdG9yICtcbiAgICAgICAgICAgIGZ1bGxTdHIuc3Vic3RyKGZ1bGxTdHIubGVuZ3RoIC0gYmFja0NoYXJzKTtcbiAgICB9LFxuICAgIGZpbGVFeHRlbnNpb246IGZ1bmN0aW9uIChmaWxlbmFtZSkge1xuICAgICAgICB2YXIgcGFydHMgPSBmaWxlbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICByZXR1cm4gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gICAgfSxcbiAgICBmaWxlTmFtZVRydW5jYXRlZDogZnVuY3Rpb24gKGZpbGVuYW1lKSB7XG4gICAgICAgIHJldHVybiBtZXRob2RzLnRydW5jYXRlKHRoaXMuZmlsZS5uYW1lLCA1Myk7XG4gICAgfSxcbiAgICBmaWxlU2l6ZUh1bWFuOiBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICB2YXIgZSA9IChNYXRoLmxvZyhzaXplKSAvIE1hdGgubG9nKDFlMykpIHwgMDtcbiAgICAgICAgcmV0dXJuICsoc2l6ZSAvIE1hdGgucG93KDEwMjQsIGUpKS50b0ZpeGVkKDEpICsgJyAnICsgKCdrTUdUUEVaWSdbZSAtIDFdIHx8ICcnKSArICdCJztcbiAgICB9LFxuICAgIGRlbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgIHdoaWxlIChEYXRlLm5vdygpIDwgc3RhcnQgKyA1MDAwKSB7fVxuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBjb25zdGFudHM6IGNvbnN0YW50cyxcbiAgICBtZXRob2RzOiBtZXRob2RzXG59IiwiaW1wb3J0ICdjb3JlLWpzL2VzL2FycmF5L2Zyb20nO1xuaW1wb3J0ICdjb3JlLWpzL2VzL29iamVjdC9hc3NpZ24nO1xuXG5jbGFzcyBBY2NvcmRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGVsLCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9XG4gICAgICAgICAgICB0eXBlb2YgZWwgPT09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbCkgOiBlbDtcbiAgICAgICAgaWYgKGNvbnRhaW5lciA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkZWZhdWx0cyA9IHtcbiAgICAgICAgICAgIGhlYWRlckNsYXNzOiAnanMtYWNjb3JkaW9uX190cmlnZ2VyJyxcbiAgICAgICAgICAgIHBhbmVsQ2xhc3M6ICdqcy1hY2NvcmRpb25fX3BhbmVsJyxcbiAgICAgICAgICAgIGluaXRpYWxpemVkQ2xhc3M6ICdqcy1hY2NvcmRpb24tLWluaXRpYWxpemVkJyxcbiAgICAgICAgICAgIHVzaW5nQW5jaG9yVGFnQXNUcmlnZ2VyOiBmYWxzZSxcbiAgICAgICAgICAgIG9wZW5NdWx0aXBsZVBhbmVsczogZmFsc2UsXG4gICAgICAgICAgICBvcGVuSGVhZGVyc09uTG9hZDogW10sXG4gICAgICAgICAgICBhZGRMaXN0ZW5lcnNPbkluaXQ6IHRydWUsXG4gICAgICAgICAgICBjc3NTdGF0ZXNDbGFzc2VzOiB7XG4gICAgICAgICAgICAgICAgT1BFTkVEOiAnb3BlbmVkJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9wZW5QcmVmaXhDYWxsYmFjazogKCkgPT4ge31cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnRvZ2dsaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IEFycmF5LmZyb20odGhpcy5jb250YWluZXIuY2hpbGRyZW4pO1xuICAgICAgICBjb25zdCBoZWFkZXJzUGFyZW50cyA9IGNoaWxkcmVuLmZpbHRlcihcbiAgICAgICAgICAgIGhlYWRlciA9PiAhaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLnNldHRpbmdzLnBhbmVsQ2xhc3MpXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5oZWFkZXJzID0gaGVhZGVyc1BhcmVudHMucmVkdWNlKChhY2MsIGhlYWRlcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgYSA9IEFycmF5LmZyb20oaGVhZGVyLmNoaWxkcmVuKS5maWx0ZXIoY2hpbGQgPT5cbiAgICAgICAgICAgICAgICBjaGlsZC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5zZXR0aW5ncy5oZWFkZXJDbGFzcylcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gYWNjLmNvbmNhdChhKTtcbiAgICAgICAgfSwgW10pO1xuXG4gICAgICAgIHRoaXMucGFuZWxzID0gY2hpbGRyZW4uZmlsdGVyKHBhbmVsID0+XG4gICAgICAgICAgICBwYW5lbC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5zZXR0aW5ncy5wYW5lbENsYXNzKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc3RhdGVzID0gdGhpcy5oZWFkZXJzLm1hcCgoKSA9PiAoeyBzdGF0ZTogJ2Nsb3NlZCcgfSkpO1xuXG4gICAgICAgIGlmICh0aGlzLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU29tZXRoaW5nIGlzIHdyb25nIHdpdGggeW91IG1hcmt1cC4uLicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgdGhpcy5faW5pdGlhbFN0YXRlKCk7XG5cbiAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgdGhpcy5fZmluaXNoSW5pdGlhbGl6YXRpb24oKTtcbiAgICB9XG5cbiAgICBfaW5pdGlhbFN0YXRlKCkge1xuICAgICAgICBjb25zdCBoZWFkZXJzVG9PcGVuID0gdGhpcy5zZXR0aW5ncy5vcGVuSGVhZGVyc09uTG9hZDtcbiAgICAgICAgaWYgKGhlYWRlcnNUb09wZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLl9vcGVuSGVhZGVyc09uTG9hZChoZWFkZXJzVG9PcGVuKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZW5kZXJEb20oKTtcbiAgICB9XG5cbiAgICBfZmluaXNoSW5pdGlhbGl6YXRpb24oKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQodGhpcy5zZXR0aW5ncy5pbml0aWFsaXplZENsYXNzKTtcbiAgICB9XG5cbiAgICBfYWRkTGlzdGVuZXJzKCkge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuYWRkTGlzdGVuZXJzT25Jbml0KSByZXR1cm47XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHRoaXMuaGFuZGxlS2V5RG93bihlKSk7XG4gICAgICAgIHRoaXMuaGVhZGVycy5mb3JFYWNoKChoZWFkZXIsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDbGljayhoZWFkZXIsIGluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgaGFuZGxlS2V5RG93bihldmVudCkge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGxldCBrZXkgPSBldmVudC53aGljaC50b1N0cmluZygpO1xuICAgICAgICAvLyAzMyA9IFBhZ2UgVXAsIDM0ID0gUGFnZSBEb3duXG4gICAgICAgIGNvbnN0IGN0cmxNb2RpZmllciA9IGV2ZW50LmN0cmxLZXkgJiYga2V5Lm1hdGNoKC8zM3wzNC8pO1xuXG4gICAgICAgIC8vIElzIHRoaXMgY29taW5nIGZyb20gYW4gYWNjb3JkaW9uIGhlYWRlcj9cbiAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5zZXR0aW5ncy5oZWFkZXJDbGFzcykpIHtcbiAgICAgICAgICAgIC8vIFVwLyBEb3duIGFycm93IGFuZCBDb250cm9sICsgUGFnZSBVcC8gUGFnZSBEb3duIGtleWJvYXJkIG9wZXJhdGlvbnNcbiAgICAgICAgICAgIC8vIDM4ID0gVXAsIDQwID0gRG93blxuICAgICAgICAgICAgaWYgKGtleS5tYXRjaCgvMzh8NDAvKSB8fCBjdHJsTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmhlYWRlcnMuaW5kZXhPZih0YXJnZXQpO1xuICAgICAgICAgICAgICAgIGxldCBkaXJlY3Rpb24gPSBrZXkubWF0Y2goLzM0fDQwLykgPyAxIDogLTE7XG4gICAgICAgICAgICAgICAgbGV0IGxlbmd0aCA9IHRoaXMuaGVhZGVycy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGV0IG5ld0luZGV4ID0gKGluZGV4ICsgbGVuZ3RoICsgZGlyZWN0aW9uKSAlIGxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyc1tuZXdJbmRleF0uZm9jdXMoKTtcblxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleS5tYXRjaCgvMzV8MzYvKSkge1xuICAgICAgICAgICAgICAgIC8vIDM1ID0gRW5kLCAzNiA9IEhvbWUga2V5Ym9hcmQgb3BlcmF0aW9uc1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEdvIHRvIGZpcnN0IGFjY29yZGlvblxuICAgICAgICAgICAgICAgICAgICBjYXNlICczNic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlcnNbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvLyBHbyB0byBsYXN0IGFjY29yZGlvblxuICAgICAgICAgICAgICAgICAgICBjYXNlICczNSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlcnNbdGhpcy5oZWFkZXJzLmxlbmd0aCAtIDFdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy51c2luZ0FuY2hvclRhZ0FzVHJpZ2dlciAmJlxuICAgICAgICAgICAgICAgIGtleS5tYXRjaCgvMzIvKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgLy8gMzIgPSBTcGFjZVxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5oZWFkZXJzLmluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNsaWNrKHRhcmdldCwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEBwYXJhbSB7b2JqZWN0fSB0YXJnZXRIZWFkZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVhZGVySW5kZXhcbiAgICAgKi9cbiAgICBoYW5kbGVDbGljayh0YXJnZXRIZWFkZXIsIGhlYWRlckluZGV4KSB7XG4gICAgICAgIGNvbnN0IHRhcmdldEhlYWRlckNsYXNzID0gdGhpcy5zZXR0aW5ncy5oZWFkZXJDbGFzcztcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGFyZ2V0SGVhZGVyLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXRIZWFkZXJDbGFzcykgJiZcbiAgICAgICAgICAgICF0aGlzLnRvZ2dsaW5nXG4gICAgICAgICkge1xuICAgICAgICAgICAgLy8gdGhpcy5jb250YWluZXIuZGlzcGF0Y2hFdmVudCh0aGlzLnNldHRpbmdzLmV2ZW50cy50b2dnbGVTdGFydGVkKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoaGVhZGVySW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyRG9tKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgQHBhcmFtIHtvYmplY3R9IHRhcmdldEhlYWRlcklkXG4gICAgICovXG4gICAgc2V0U3RhdGUodGFyZ2V0SGVhZGVySWQpIHtcbiAgICAgICAgY29uc3Qgc3RhdGVzID0gdGhpcy5nZXRTdGF0ZSgpO1xuXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5vcGVuTXVsdGlwbGVQYW5lbHMpIHtcbiAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKChzdGF0ZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IHRhcmdldEhlYWRlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLnN0YXRlID0gJ2Nsb3NlZCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdGFyZ2V0U3RhdGUgPSBzdGF0ZXMuZmlsdGVyKFxuICAgICAgICAgICAgKHN0YXRlLCBpbmRleCkgPT4gaW5kZXggPT09IHRhcmdldEhlYWRlcklkXG4gICAgICAgIClbMF07XG4gICAgICAgIHRhcmdldFN0YXRlLnN0YXRlID0gdGhpcy50b2dnbGVTdGF0ZSh0YXJnZXRTdGF0ZS5zdGF0ZSk7XG4gICAgfVxuXG4gICAgX3JlbmRlckRvbSgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZXMuZm9yRWFjaCgoc3RhdGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoc3RhdGUuc3RhdGUgPT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgIHRoaXMub3BlbihpbmRleCwgZmFsc2UpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zdGF0ZSA9PT0gJ2Nsb3NlZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKGluZGV4LCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqICBAcGFyYW0ge251bWJlcn0gaGVhZGVySW5kZXhcbiAgICAgKiBAcGFyYW0gc2V0U3RhdGVcbiAgICAgKi9cbiAgICBvcGVuKGhlYWRlckluZGV4LCBzZXRTdGF0ZSA9IHRydWUpIHtcbiAgICAgICAgaWYgKHNldFN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKGhlYWRlckluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudG9nZ2xlUGFuZWwoJ29wZW4nLCBoZWFkZXJJbmRleCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEBwYXJhbSB7bnVtYmVyfSBoZWFkZXJJbmRleFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2V0U3RhdGVcbiAgICAgKi9cbiAgICBjbG9zZShoZWFkZXJJbmRleCwgc2V0U3RhdGUgPSB0cnVlKSB7XG4gICAgICAgIGlmIChzZXRTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShoZWFkZXJJbmRleCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRvZ2dsZVBhbmVsKCdjbG9zZWQnLCBoZWFkZXJJbmRleCk7XG4gICAgfVxuXG4gICAgb3BlbkFsbCgpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLmZvckVhY2goKGhlYWRlciwgaGVhZGVySW5kZXgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUGFuZWwoJ29wZW4nLCBoZWFkZXJJbmRleCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNsb3NlQWxsKCkge1xuICAgICAgICB0aGlzLmhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBoZWFkZXJJbmRleCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQYW5lbCgnY2xvc2VkJywgaGVhZGVySW5kZXgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgQHBhcmFtIHtzdHJpbmd9IGFjdGlvblxuICAgICAqICBAcGFyYW0ge251bWJlcn0gaGVhZGVySW5kZXhcbiAgICAgKi9cbiAgICB0b2dnbGVQYW5lbChhY3Rpb24sIGhlYWRlckluZGV4KSB7XG4gICAgICAgIGlmIChhY3Rpb24gIT09IHVuZGVmaW5lZCAmJiBoZWFkZXJJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY2xvc2VkJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuaGVhZGVyc1toZWFkZXJJbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3QgcGFuZWxUb0Nsb3NlID0gdGhpcy5wYW5lbHNbaGVhZGVySW5kZXhdO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VBY3Rpb24oaGVhZGVyLCBwYW5lbFRvQ2xvc2UpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuaGVhZGVyc1toZWFkZXJJbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3QgcGFuZWxUb09wZW4gPSB0aGlzLnBhbmVsc1toZWFkZXJJbmRleF07XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuQWN0aW9uKGhlYWRlciwgcGFuZWxUb09wZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGhlYWRlclxuICAgICAqICBAcGFyYW0ge0hUTUxFbGVtZW50fSBwYW5lbFxuICAgICAqL1xuICAgIGNsb3NlQWN0aW9uKGhlYWRlciwgcGFuZWwpIHtcbiAgICAgICAgaWYgKHBhbmVsLmdldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKSA9PT0gJ3RydWUnKSByZXR1cm47XG4gICAgICAgIGhlYWRlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSk7XG4gICAgICAgIHBhbmVsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgcGFuZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnNldHRpbmdzLmNzc1N0YXRlc0NsYXNzZXMuT1BFTkVEKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgQHBhcmFtIHtIVE1MRWxlbWVudH0gaGVhZGVyXG4gICAgICogIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHBhbmVsXG4gICAgICovXG4gICAgb3BlbkFjdGlvbihoZWFkZXIsIHBhbmVsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5zZXR0aW5ncy5vcGVuUHJlZml4Q2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub3BlblByZWZpeENhbGxiYWNrKHRoaXMuY29udGFpbmVyLCBoZWFkZXIsIHBhbmVsKTtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXIuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSk7XG4gICAgICAgIHBhbmVsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgIHBhbmVsLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAndHJhbnNpdGlvbmVuZCcsXG4gICAgICAgICAgICAoKSA9PiBwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuY3NzU3RhdGVzQ2xhc3Nlcy5PUEVORUQpLFxuICAgICAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgQHBhcmFtIHthcnJheX0gaGVhZGVyc0luZGljZXMgLSBBcnJheSBvZiBpbmRpY2VzIG9mIHRoZSBoZWFkZXJzXG4gICAgICovXG4gICAgZ2V0U3RhdGUoaGVhZGVyc0luZGljZXMgPSBbXSkge1xuICAgICAgICBpZiAoaGVhZGVyc0luZGljZXMubGVuZ3RoICYmIEFycmF5LmlzQXJyYXkoaGVhZGVyc0luZGljZXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyc0luZGljZXMubWFwKGhlYWRlciA9PiB0aGlzLnN0YXRlc1toZWFkZXJdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXRlcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqICBAcGFyYW0ge3N0cmluZ30gY3VycmVudFN0YXRlXG4gICAgICovXG4gICAgdG9nZ2xlU3RhdGUoY3VycmVudFN0YXRlKSB7XG4gICAgICAgIGlmIChjdXJyZW50U3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRTdGF0ZSA9PT0gJ2Nsb3NlZCcgPyAnb3BlbicgOiAnY2xvc2VkJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqICBAcGFyYW0ge2FycmF5fSBoZWFkZXJzVG9PcGVuIC0gQXJyYXkgb2YgaW5kaWNlcyBvZiB0aGUgaGVhZGVyc1xuICAgICAqL1xuICAgIF9vcGVuSGVhZGVyc09uTG9hZChoZWFkZXJzVG9PcGVuID0gW10pIHtcbiAgICAgICAgLy8gVE9ETzogZmlsdGVyLW91dCB0aGUgbm9uLW51bWVyaWMgdmFsdWVzIHRoZW4gY2hlY2suXG4gICAgICAgIGlmIChoZWFkZXJzVG9PcGVuLmxlbmd0aCAmJiBBcnJheS5pc0FycmF5KGhlYWRlcnNUb09wZW4pKSB7XG4gICAgICAgICAgICBsZXQgaGVhZGVycyA9IGhlYWRlcnNUb09wZW4uZmlsdGVyKGhlYWRlciA9PiBoZWFkZXIgIT09IHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgIGhlYWRlcnMuZm9yRWFjaChoZWFkZXIgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoaGVhZGVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBY2NvcmRpb247XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb250cm9sbGVyID0ge1xuICAgICAgICAkYm9keTogJCgnYm9keScpLFxuICAgICAgICBhY3RpdmU6IG51bGwsXG4gICAgICAgIGVzY2FwZSA6IDI3LFxuICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgJGFjdGl2ZUNvbXBvbmVudDogbnVsbCxcbiAgICAgICAgJGNvbnRhaW5lcjogbnVsbCxcbiAgICAgICAgJHRhcmdldDogbnVsbCxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmNvbnRyb2woKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZXh0cmEoKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuY2hlY2soKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZXh0cmEoKTtcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkgeyAvLyBoaWRlIC8gY2xvc2Ugd2hlbiBlc2Mga2V5IGlzIHByZXNzZWRcbiAgICAgICAgICAgICAgICBpZiAoKGUua2V5Q29kZSB8fCBlLndoaWNoKSA9PT0gY29udHJvbGxlci5lc2NhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5jaGVjayhlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChlKSB7IC8vIGNoZWNrIGlmIHRoZXJlIGlzIG9wZW4gLyBhY3RpdmUgY29tcG9uZW50XG4gICAgICAgICAgICBjb250cm9sbGVyLmFjdGl2ZSA9IGNvbnRyb2xsZXIuJGJvZHkuYXR0cignZGF0YS1hY3RpdmUnKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyLmFjdGl2ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5kaXNhYmxlKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbiAoZSkgeyAvLyBoaWRlIC8gY2xvc2UgYWN0aXZlIGNvbXBvbmVudFxuICAgICAgICAgICAgLy8gcmV0dXJuIGZvY3VzIHRvIGNvbnRyb2xsZXIgaWYgY29tcG9uZW50IHdhcyBjbG9zZWQgYnkgY2hlY2soKVxuICAgICAgICAgICAgaWYodHlwZW9mIChVWFtjb250cm9sbGVyLmFjdGl2ZV0uJGNvbnRyb2xsZXIpICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIFVYW2NvbnRyb2xsZXIuYWN0aXZlXS4kY29udHJvbGxlci5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVVhbY29udHJvbGxlci5hY3RpdmVdLm9uLmhpZGUoZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuJGJvZHkub24oXCJjbGljayBmb2N1c291dFwiLCBmdW5jdGlvbiAoZSkgeyAvLyBoaWRlIC8gY2xvc2Ugb3BlbmVkIGNvbXBvbmVudHMgd2hlbiBjbGljayBvdXQgc2lkZSBpdFxuICAgICAgICAgICAgICAgIC8vIEB0b2RvOiB0aGlzIGNhbiBiZSBzdGlsbCBpbXByb3ZlZCBmb3IgbmVzdGVkIGNvbXBvZW50bnMsIHdoZW4gY2xpY2sgaXMgb3V0c2lkZSBvZiBhbGwgb2YgdGhlbSwgY2xvc2UgYWxsLCBub3Qgb25seSBjdXJyZW50IG9uZSAtIGJ1dCBpdCBpcyBhIGZlYXR1cmVcbiAgICAgICAgICAgICAgICAvLyBpZiBrZXkgd2FzIHByZXNzZWQsIHRoYW4gd2UgbmVlZCB0byBvcGVyYXRlIHdpdGggcmVsYXRlZCB0YXJnZXQsIG5vdCBvcmlnaW5hbCB0YXJnZXRcbiAgICAgICAgICAgICAgICBpZihlLnR5cGUgPT09ICdmb2N1c291dCcgJiYgZS50YXJnZXQgIT09IGUucmVsYXRlZFRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBpZihlLnJlbGF0ZWRUYXJnZXQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0ID0gZS5yZWxhdGVkVGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuYWN0aXZlID0gY29udHJvbGxlci4kYm9keS5hdHRyKCdkYXRhLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJGFjdGl2ZUNvbXBvbmVudCA9IHR5cGVvZihVWFtjb250cm9sbGVyLmFjdGl2ZV0pICE9PSBcInVuZGVmaW5lZFwiID8gVVhbY29udHJvbGxlci5hY3RpdmVdIDogXCJ1bmRlZmluZWRcIjtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YoY29udHJvbGxlci4kYWN0aXZlQ29tcG9uZW50KSAhPT0gXCJ1bmRlZmluZWRcIlxuICAgICAgICAgICAgICAgICAgICAmJiB0eXBlb2YoY29udHJvbGxlci4kYWN0aXZlQ29tcG9uZW50LiRzZWN0aW9uKSAhPT0gXCJ1bmRlZmluZWRcIlxuICAgICAgICAgICAgICAgICAgICAmJiB0eXBlb2YoY29udHJvbGxlci4kYWN0aXZlQ29tcG9uZW50LiRjb250cm9sbGVyKSAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJGNvbnRhaW5lciA9IGNvbnRyb2xsZXIuJGFjdGl2ZUNvbXBvbmVudC4kc2VjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci4kdGFyZ2V0ID0gY29udHJvbGxlci4kYWN0aXZlQ29tcG9uZW50LiRjb250cm9sbGVyO1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmNoZWNrVG9IaWRlKGUpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGNoZWNrVG9IaWRlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAoIWNvbnRyb2xsZXIuJGNvbnRhaW5lci5pcyhlLnRhcmdldCkgLy8gaWYgdGhlIHRhcmdldCBvZiB0aGUgY2xpY2sgaXNuJ3QgdGhlIGNvbnRhaW5lci4uLlxuICAgICAgICAgICAgICAgICYmIGNvbnRyb2xsZXIuJGNvbnRhaW5lci5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgICAgICYmICFjb250cm9sbGVyLiR0YXJnZXQuaXMoZS50YXJnZXQpIC8vIGlmIHRoZSB0YXJnZXQgb2YgdGhlIGNsaWNrIGlzbid0IHRoZSBjb250cm9sbGVyLi4uXG4gICAgICAgICAgICAgICAgJiYgY29udHJvbGxlci4kdGFyZ2V0LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwIC8vIC4uLiBub3IgYSBkZXNjZW5kYW50IG9mIHRoZSBjb250cm9sbGVyXG4gICAgICAgICAgICAgICAgJiYgISQoZS50YXJnZXQpLmNsb3Nlc3QoXCIudWktYXV0b2NvbXBsZXRlXCIpLmxlbmd0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLiRhY3RpdmVDb21wb25lbnQub24uaGlkZShlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVWC5jb250cm9sbGVyID0gY29udHJvbGxlcjsgLy8gYWRkIHRvIGdsb2JhbCBuYW1lc3BhY2Vcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgLypcXFxuICAgIHwqfFxuICAgIHwqfCAgOjogY29va2llcy5qcyA6OlxuICAgIHwqfFxuICAgIHwqfCAgQSBjb21wbGV0ZSBjb29raWVzIHJlYWRlci93cml0ZXIgZnJhbWV3b3JrIHdpdGggZnVsbCB1bmljb2RlIHN1cHBvcnQuXG4gICAgfCp8XG4gICAgfCp8ICBSZXZpc2lvbiAjMSAtIFNlcHRlbWJlciA0LCAyMDE0XG4gICAgfCp8XG4gICAgfCp8ICBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvZG9jdW1lbnQuY29va2llXG4gICAgfCp8ICBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9Vc2VyOmZ1c2lvbmNoZXNzXG4gICAgfCp8ICBodHRwczovL2dpdGh1Yi5jb20vbWFkbXVycGh5L2Nvb2tpZXMuanNcbiAgICB8KnxcbiAgICB8KnwgIFRoaXMgZnJhbWV3b3JrIGlzIHJlbGVhc2VkIHVuZGVyIHRoZSBHTlUgUHVibGljIExpY2Vuc2UsIHZlcnNpb24gMyBvciBsYXRlci5cbiAgICB8KnwgIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLXN0YW5kYWxvbmUuaHRtbFxuICAgIHwqfFxuICAgIHwqfCAgU3ludGF4ZXM6XG4gICAgfCp8XG4gICAgfCp8ICAqIGRvY0Nvb2tpZXMuc2V0SXRlbShuYW1lLCB2YWx1ZVssIGVuZFssIHBhdGhbLCBkb21haW5bLCBzZWN1cmVdXV1dKVxuICAgIHwqfCAgKiBkb2NDb29raWVzLmdldEl0ZW0obmFtZSlcbiAgICB8KnwgICogZG9jQ29va2llcy5yZW1vdmVJdGVtKG5hbWVbLCBwYXRoWywgZG9tYWluXV0pXG4gICAgfCp8ICAqIGRvY0Nvb2tpZXMuaGFzSXRlbShuYW1lKVxuICAgIHwqfCAgKiBkb2NDb29raWVzLmtleXMoKVxuICAgIHwqfFxuICAgIFxcKi9cblxuICAgIHZhciBjb29raWVzID0ge1xuICAgICAgICBnZXRJdGVtOiBmdW5jdGlvbiAoc0tleSkge1xuICAgICAgICAgICAgaWYgKCFzS2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmNvb2tpZS5yZXBsYWNlKG5ldyBSZWdFeHAoXCIoPzooPzpefC4qOylcXFxccypcIiArIGVuY29kZVVSSUNvbXBvbmVudChzS2V5KS5yZXBsYWNlKC9bXFwtXFwuXFwrXFwqXS9nLCBcIlxcXFwkJlwiKSArIFwiXFxcXHMqXFxcXD1cXFxccyooW147XSopLiokKXxeLiokXCIpLCBcIiQxXCIpKSB8fCBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBzZXRJdGVtOiBmdW5jdGlvbiAoc0tleSwgc1ZhbHVlLCB2RW5kLCBzUGF0aCwgc0RvbWFpbiwgYlNlY3VyZSkge1xuICAgICAgICAgICAgaWYgKCFzS2V5IHx8IC9eKD86ZXhwaXJlc3xtYXhcXC1hZ2V8cGF0aHxkb21haW58c2VjdXJlKSQvaS50ZXN0KHNLZXkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNFeHBpcmVzID0gXCJcIjtcbiAgICAgICAgICAgIGlmICh2RW5kKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh2RW5kLmNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTnVtYmVyOlxuICAgICAgICAgICAgICAgICAgICAgICAgc0V4cGlyZXMgPSB2RW5kID09PSBJbmZpbml0eSA/IFwiOyBleHBpcmVzPUZyaSwgMzEgRGVjIDk5OTkgMjM6NTk6NTkgR01UXCIgOiBcIjsgbWF4LWFnZT1cIiArIHZFbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBTdHJpbmc6XG4gICAgICAgICAgICAgICAgICAgICAgICBzRXhwaXJlcyA9IFwiOyBleHBpcmVzPVwiICsgdkVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGU6XG4gICAgICAgICAgICAgICAgICAgICAgICBzRXhwaXJlcyA9IFwiOyBleHBpcmVzPVwiICsgdkVuZC50b1VUQ1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KHNLZXkpICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoc1ZhbHVlKSArIHNFeHBpcmVzICsgKHNEb21haW4gPyBcIjsgZG9tYWluPVwiICsgc0RvbWFpbiA6IFwiXCIpICsgKHNQYXRoID8gXCI7IHBhdGg9XCIgKyBzUGF0aCA6IFwiXCIpICsgKGJTZWN1cmUgPyBcIjsgc2VjdXJlXCIgOiBcIlwiKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICByZW1vdmVJdGVtOiBmdW5jdGlvbiAoc0tleSwgc1BhdGgsIHNEb21haW4pIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5oYXNJdGVtKHNLZXkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KHNLZXkpICsgXCI9OyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDAgR01UXCIgKyAoc0RvbWFpbiA/IFwiOyBkb21haW49XCIgKyBzRG9tYWluIDogXCJcIikgKyAoc1BhdGggPyBcIjsgcGF0aD1cIiArIHNQYXRoIDogXCJcIik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgaGFzSXRlbTogZnVuY3Rpb24gKHNLZXkpIHtcbiAgICAgICAgICAgIGlmICghc0tleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAobmV3IFJlZ0V4cChcIig/Ol58O1xcXFxzKilcIiArIGVuY29kZVVSSUNvbXBvbmVudChzS2V5KS5yZXBsYWNlKC9bXFwtXFwuXFwrXFwqXS9nLCBcIlxcXFwkJlwiKSArIFwiXFxcXHMqXFxcXD1cIikpLnRlc3QoZG9jdW1lbnQuY29va2llKTtcbiAgICAgICAgfSxcbiAgICAgICAga2V5czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFLZXlzID0gZG9jdW1lbnQuY29va2llLnJlcGxhY2UoLygoPzpefFxccyo7KVteXFw9XSspKD89O3wkKXxeXFxzKnxcXHMqKD86XFw9W147XSopPyg/OlxcMXwkKS9nLCBcIlwiKS5zcGxpdCgvXFxzKig/OlxcPVteO10qKT87XFxzKi8pO1xuICAgICAgICAgICAgZm9yICh2YXIgbkxlbiA9IGFLZXlzLmxlbmd0aCwgbklkeCA9IDA7IG5JZHggPCBuTGVuOyBuSWR4KyspIHtcbiAgICAgICAgICAgICAgICBhS2V5c1tuSWR4XSA9IGRlY29kZVVSSUNvbXBvbmVudChhS2V5c1tuSWR4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYUtleXM7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVVguY29va2llcyA9IGNvb2tpZXM7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHdpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgJGJvZHkgPSAkKCdib2R5Jyk7XG5cbiAgICB2YXIgY29weVRleHQgPSB7XG4gICAgICAgICR0YXJnZXQ6IG51bGwsXG4gICAgICAgICR0b2dnbGU6IG51bGwsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29weVRleHQuJHRvZ2dsZSA9ICQoJy5jb3B5X19idG4nKTtcbiAgICAgICAgICAgIGNvcHlUZXh0LiR0YXJnZXQgPSAkKCcuY29weV9fdGV4dCcpO1xuXG4gICAgICAgICAgICBjb3B5VGV4dC5jb250cm9sKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY29udHJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrIHRvdWNoc3RhcnQnLCAnLmNvcHlfX2J0bicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb3B5VGV4dC4kdG9nZ2xlID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBjb3B5VGV4dC4kdG9nZ2xlLm9mZihcImZvY3Vzb3V0XCIpO1xuICAgICAgICAgICAgICAgIGNvcHlUZXh0LmNvcHlMaW5rKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBjb3B5TGluazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyICR3cmFwcGVyID0gY29weVRleHQuJHRvZ2dsZS5jbG9zZXN0KCcuY29weV9fdGV4dC13cmFwcGVyJyk7XG4gICAgICAgICAgICBpZiAoJHdyYXBwZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29weVRleHQuJHRhcmdldCA9ICR3cmFwcGVyLmZpbmQoJy5jb3B5X190ZXh0Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29weVRleHQuJHRhcmdldC5pcygnLmNzbC1yZXNwb25zZScpICYmICR3cmFwcGVyLmZpbmQoJy5jc2wtcmlnaHQtaW5saW5lJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvcHlUZXh0LiR0YXJnZXQgPSAkd3JhcHBlci5maW5kKCcuY3NsLXJpZ2h0LWlubGluZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcbiAgICAgICAgICAgIHRleHRhcmVhLmlkID0gJ3RlbXBfZWxlbWVudCc7XG4gICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5oZWlnaHQgPSAwO1xuICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSBjb3B5VGV4dC4kdGFyZ2V0Lmh0bWwoKTtcbiAgICAgICAgICAgIGlmICgvPFxcLz9bYS16XVtcXHNcXFNdKj4vaS50ZXN0KGNvcHlUZXh0LiR0YXJnZXQudGV4dCgpKSkge1xuICAgICAgICAgICAgICAgIHRleHRhcmVhLnZhbHVlID0gY29weVRleHQuJHRhcmdldC50ZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRleHRhcmVhKTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0ZW1wX2VsZW1lbnQnKTtcblxuICAgICAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lwYWR8aXBvZHxpcGhvbmUvaSkpIHtcblxuICAgICAgICAgICAgICAgIHNlbGVjdG9yLnNldEF0dHJpYnV0ZSgncmVhZG9ubHknLCAnJyk7XG5cbiAgICAgICAgICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3Iuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgOTk5OTk5KTtcblxuICAgICAgICAgICAgICAgIHNlbGVjdG9yLnJlbW92ZUF0dHJpYnV0ZSgncmVhZG9ubHknKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3Iuc2VsZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZXh0YXJlYSk7XG4gICAgICAgICAgICBjb3B5VGV4dC4kdG9nZ2xlLmZvY3VzKCk7XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBVWC5jb3B5VGV4dCA9IGNvcHlUZXh0OyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsIi8qIVxuICogSmF2YVNjcmlwdCBDdXN0b20gRm9ybXNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxNC0yMDE1IFBTRDJIVE1MIC0gaHR0cDovL3BzZDJodG1sLmNvbS9qY2ZcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSAoTElDRU5TRS50eHQpXG4gKlxuICogVmVyc2lvbjogMS4yLjNcbiAqL1xuOyhmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdCd1c2Ugc3RyaWN0Jztcblx0LyppZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0ZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7XG5cdH0gZWxzZSB7XG5cdFx0cm9vdC5qY2YgPSBmYWN0b3J5KGpRdWVyeSk7XG5cdH0qL1xuXHRyb290LmpjZiA9IGZhY3RvcnkoalF1ZXJ5KTtcbn0odGhpcywgZnVuY3Rpb24oJCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0Ly8gZGVmaW5lIHZlcnNpb25cblx0dmFyIHZlcnNpb24gPSAnMS4yLjMnO1xuXG5cdC8vIHByaXZhdGUgdmFyaWFibGVzXG5cdHZhciBjdXN0b21JbnN0YW5jZXMgPSBbXTtcblxuXHQvLyBkZWZhdWx0IGdsb2JhbCBvcHRpb25zXG5cdHZhciBjb21tb25PcHRpb25zID0ge1xuXHRcdG9wdGlvbnNLZXk6ICdqY2YnLFxuXHRcdGRhdGFLZXk6ICdqY2YtaW5zdGFuY2UnLFxuXHRcdHJ0bENsYXNzOiAnamNmLXJ0bCcsXG5cdFx0Zm9jdXNDbGFzczogJ2pjZi1mb2N1cycsXG5cdFx0cHJlc3NlZENsYXNzOiAnamNmLXByZXNzZWQnLFxuXHRcdGRpc2FibGVkQ2xhc3M6ICdqY2YtZGlzYWJsZWQnLFxuXHRcdGhpZGRlbkNsYXNzOiAnamNmLWhpZGRlbicsXG5cdFx0cmVzZXRBcHBlYXJhbmNlQ2xhc3M6ICdqY2YtcmVzZXQtYXBwZWFyYW5jZScsXG5cdFx0dW5zZWxlY3RhYmxlQ2xhc3M6ICdqY2YtdW5zZWxlY3RhYmxlJ1xuXHR9O1xuXG5cdC8vIGRldGVjdCBkZXZpY2UgdHlwZVxuXHR2YXIgaXNUb3VjaERldmljZSA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2gsXG5cdFx0aXNXaW5QaG9uZURldmljZSA9IC9XaW5kb3dzIFBob25lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXHRjb21tb25PcHRpb25zLmlzTW9iaWxlRGV2aWNlID0gISEoaXNUb3VjaERldmljZSB8fCBpc1dpblBob25lRGV2aWNlKTtcblxuXHQvLyBjcmVhdGUgZ2xvYmFsIHN0eWxlc2hlZXQgaWYgY3VzdG9tIGZvcm1zIGFyZSB1c2VkXG5cdHZhciBjcmVhdGVTdHlsZVNoZWV0ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHN0eWxlVGFnID0gJCgnPHN0eWxlPicpLmFwcGVuZFRvKCdoZWFkJyksXG5cdFx0XHRzdHlsZVNoZWV0ID0gc3R5bGVUYWcucHJvcCgnc2hlZXQnKSB8fCBzdHlsZVRhZy5wcm9wKCdzdHlsZVNoZWV0Jyk7XG5cblx0XHQvLyBjcm9zc2Jyb3dzZXIgc3R5bGUgaGFuZGxpbmdcblx0XHR2YXIgYWRkQ1NTUnVsZSA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBydWxlcywgaW5kZXgpIHtcblx0XHRcdGluZGV4ID0gaW5kZXggfHwgMDtcblx0XHRcdGlmIChzdHlsZVNoZWV0Lmluc2VydFJ1bGUpIHtcblx0XHRcdFx0c3R5bGVTaGVldC5pbnNlcnRSdWxlKHNlbGVjdG9yICsgJ3snICsgcnVsZXMgKyAnfScsIGluZGV4KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHN0eWxlU2hlZXQuYWRkUnVsZShzZWxlY3RvciwgcnVsZXMsIGluZGV4KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gYWRkIHNwZWNpYWwgcnVsZXNcblx0XHRhZGRDU1NSdWxlKCcuJyArIGNvbW1vbk9wdGlvbnMuaGlkZGVuQ2xhc3MsICdwb3NpdGlvbjphYnNvbHV0ZSAhaW1wb3J0YW50O2xlZnQ6LTk5OTlweCAhaW1wb3J0YW50O2hlaWdodDoxcHggIWltcG9ydGFudDt3aWR0aDoxcHggIWltcG9ydGFudDttYXJnaW46MCAhaW1wb3J0YW50O2JvcmRlci13aWR0aDowICFpbXBvcnRhbnQ7LXdlYmtpdC1hcHBlYXJhbmNlOm5vbmU7LW1vei1hcHBlYXJhbmNlOm5vbmU7YXBwZWFyYW5jZTpub25lJyk7XG5cdFx0YWRkQ1NTUnVsZSgnLicgKyBjb21tb25PcHRpb25zLnJ0bENsYXNzICsgJyAuJyArIGNvbW1vbk9wdGlvbnMuaGlkZGVuQ2xhc3MsICdyaWdodDotOTk5OXB4ICFpbXBvcnRhbnQ7IGxlZnQ6IGF1dG8gIWltcG9ydGFudCcpO1xuXHRcdGFkZENTU1J1bGUoJy4nICsgY29tbW9uT3B0aW9ucy51bnNlbGVjdGFibGVDbGFzcywgJy13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7IC1tcy11c2VyLXNlbGVjdDogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjogcmdiYSgwLDAsMCwwKTsnKTtcblx0XHRhZGRDU1NSdWxlKCcuJyArIGNvbW1vbk9wdGlvbnMucmVzZXRBcHBlYXJhbmNlQ2xhc3MsICdiYWNrZ3JvdW5kOiBub25lOyBib3JkZXI6IG5vbmU7IC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsgYXBwZWFyYW5jZTogbm9uZTsgb3BhY2l0eTogMDsgZmlsdGVyOiBhbHBoYShvcGFjaXR5PTApOycpO1xuXG5cdFx0Ly8gZGV0ZWN0IHJ0bCBwYWdlc1xuXHRcdHZhciBodG1sID0gJCgnaHRtbCcpLCBib2R5ID0gJCgnYm9keScpO1xuXHRcdGlmIChodG1sLmNzcygnZGlyZWN0aW9uJykgPT09ICdydGwnIHx8IGJvZHkuY3NzKCdkaXJlY3Rpb24nKSA9PT0gJ3J0bCcpIHtcblx0XHRcdGh0bWwuYWRkQ2xhc3MoY29tbW9uT3B0aW9ucy5ydGxDbGFzcyk7XG5cdFx0fVxuXG5cdFx0Ly8gaGFuZGxlIGZvcm0gcmVzZXQgZXZlbnRcblx0XHRodG1sLm9uKCdyZXNldCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0YXBpLnJlZnJlc2hBbGwoKTtcblx0XHRcdH0sIDApO1xuXHRcdH0pO1xuXG5cdFx0Ly8gbWFyayBzdHlsZXNoZWV0IGFzIGNyZWF0ZWRcblx0XHRjb21tb25PcHRpb25zLnN0eWxlU2hlZXRDcmVhdGVkID0gdHJ1ZTtcblx0fTtcblxuXHQvLyBzaW1wbGlmaWVkIHBvaW50ZXIgZXZlbnRzIGhhbmRsZXJcblx0KGZ1bmN0aW9uKCkge1xuXHRcdHZhciBwb2ludGVyRXZlbnRzU3VwcG9ydGVkID0gbmF2aWdhdG9yLnBvaW50ZXJFbmFibGVkIHx8IG5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkLFxuXHRcdFx0dG91Y2hFdmVudHNTdXBwb3J0ZWQgPSAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KSB8fCB3aW5kb3cuRG9jdW1lbnRUb3VjaCAmJiBkb2N1bWVudCBpbnN0YW5jZW9mIHdpbmRvdy5Eb2N1bWVudFRvdWNoLFxuXHRcdFx0ZXZlbnRMaXN0LCBldmVudE1hcCA9IHt9LCBldmVudFByZWZpeCA9ICdqY2YtJztcblxuXHRcdC8vIGRldGVjdCBldmVudHMgdG8gYXR0YWNoXG5cdFx0aWYgKHBvaW50ZXJFdmVudHNTdXBwb3J0ZWQpIHtcblx0XHRcdGV2ZW50TGlzdCA9IHtcblx0XHRcdFx0cG9pbnRlcm92ZXI6IG5hdmlnYXRvci5wb2ludGVyRW5hYmxlZCA/ICdwb2ludGVyb3ZlcicgOiAnTVNQb2ludGVyT3ZlcicsXG5cdFx0XHRcdHBvaW50ZXJkb3duOiBuYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgPyAncG9pbnRlcmRvd24nIDogJ01TUG9pbnRlckRvd24nLFxuXHRcdFx0XHRwb2ludGVybW92ZTogbmF2aWdhdG9yLnBvaW50ZXJFbmFibGVkID8gJ3BvaW50ZXJtb3ZlJyA6ICdNU1BvaW50ZXJNb3ZlJyxcblx0XHRcdFx0cG9pbnRlcnVwOiBuYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgPyAncG9pbnRlcnVwJyA6ICdNU1BvaW50ZXJVcCdcblx0XHRcdH07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGV2ZW50TGlzdCA9IHtcblx0XHRcdFx0cG9pbnRlcm92ZXI6ICdtb3VzZW92ZXInLFxuXHRcdFx0XHRwb2ludGVyZG93bjogJ21vdXNlZG93bicgKyAodG91Y2hFdmVudHNTdXBwb3J0ZWQgPyAnIHRvdWNoc3RhcnQnIDogJycpLFxuXHRcdFx0XHRwb2ludGVybW92ZTogJ21vdXNlbW92ZScgKyAodG91Y2hFdmVudHNTdXBwb3J0ZWQgPyAnIHRvdWNobW92ZScgOiAnJyksXG5cdFx0XHRcdHBvaW50ZXJ1cDogJ21vdXNldXAnICsgKHRvdWNoRXZlbnRzU3VwcG9ydGVkID8gJyB0b3VjaGVuZCcgOiAnJylcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Ly8gY3JlYXRlIGV2ZW50IG1hcFxuXHRcdCQuZWFjaChldmVudExpc3QsIGZ1bmN0aW9uKHRhcmdldEV2ZW50TmFtZSwgZmFrZUV2ZW50TGlzdCkge1xuXHRcdFx0JC5lYWNoKGZha2VFdmVudExpc3Quc3BsaXQoJyAnKSwgZnVuY3Rpb24oaW5kZXgsIGZha2VFdmVudE5hbWUpIHtcblx0XHRcdFx0ZXZlbnRNYXBbZmFrZUV2ZW50TmFtZV0gPSB0YXJnZXRFdmVudE5hbWU7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIGpRdWVyeSBldmVudCBob29rc1xuXHRcdCQuZWFjaChldmVudExpc3QsIGZ1bmN0aW9uKGV2ZW50TmFtZSwgZXZlbnRIYW5kbGVycykge1xuXHRcdFx0ZXZlbnRIYW5kbGVycyA9IGV2ZW50SGFuZGxlcnMuc3BsaXQoJyAnKTtcblx0XHRcdCQuZXZlbnQuc3BlY2lhbFtldmVudFByZWZpeCArIGV2ZW50TmFtZV0gPSB7XG5cdFx0XHRcdHNldHVwOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0JC5lYWNoKGV2ZW50SGFuZGxlcnMsIGZ1bmN0aW9uKGluZGV4LCBmYWxsYmFja0V2ZW50KSB7XG5cdFx0XHRcdFx0XHRpZiAoc2VsZi5hZGRFdmVudExpc3RlbmVyKSBzZWxmLmFkZEV2ZW50TGlzdGVuZXIoZmFsbGJhY2tFdmVudCwgZml4RXZlbnQsIGZhbHNlKTtcblx0XHRcdFx0XHRcdGVsc2Ugc2VsZlsnb24nICsgZmFsbGJhY2tFdmVudF0gPSBmaXhFdmVudDtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSxcblx0XHRcdFx0dGVhcmRvd246IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHQkLmVhY2goZXZlbnRIYW5kbGVycywgZnVuY3Rpb24oaW5kZXgsIGZhbGxiYWNrRXZlbnQpIHtcblx0XHRcdFx0XHRcdGlmIChzZWxmLmFkZEV2ZW50TGlzdGVuZXIpIHNlbGYucmVtb3ZlRXZlbnRMaXN0ZW5lcihmYWxsYmFja0V2ZW50LCBmaXhFdmVudCwgZmFsc2UpO1xuXHRcdFx0XHRcdFx0ZWxzZSBzZWxmWydvbicgKyBmYWxsYmFja0V2ZW50XSA9IG51bGw7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fSk7XG5cblx0XHQvLyBjaGVjayB0aGF0IG1vdXNlIGV2ZW50IGFyZSBub3Qgc2ltdWxhdGVkIGJ5IG1vYmlsZSBicm93c2Vyc1xuXHRcdHZhciBsYXN0VG91Y2ggPSBudWxsO1xuXHRcdHZhciBtb3VzZUV2ZW50U2ltdWxhdGVkID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0dmFyIGR4ID0gTWF0aC5hYnMoZS5wYWdlWCAtIGxhc3RUb3VjaC54KSxcblx0XHRcdFx0ZHkgPSBNYXRoLmFicyhlLnBhZ2VZIC0gbGFzdFRvdWNoLnkpLFxuXHRcdFx0XHRyYW5nZURpc3RhbmNlID0gMjU7XG5cblx0XHRcdGlmIChkeCA8PSByYW5nZURpc3RhbmNlICYmIGR5IDw9IHJhbmdlRGlzdGFuY2UpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIG5vcm1hbGl6ZSBldmVudFxuXHRcdHZhciBmaXhFdmVudCA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdHZhciBvcmlnRXZlbnQgPSBlIHx8IHdpbmRvdy5ldmVudCxcblx0XHRcdFx0dG91Y2hFdmVudERhdGEgPSBudWxsLFxuXHRcdFx0XHR0YXJnZXRFdmVudE5hbWUgPSBldmVudE1hcFtvcmlnRXZlbnQudHlwZV07XG5cblx0XHRcdGUgPSAkLmV2ZW50LmZpeChvcmlnRXZlbnQpO1xuXHRcdFx0ZS50eXBlID0gZXZlbnRQcmVmaXggKyB0YXJnZXRFdmVudE5hbWU7XG5cblx0XHRcdGlmIChvcmlnRXZlbnQucG9pbnRlclR5cGUpIHtcblx0XHRcdFx0c3dpdGNoIChvcmlnRXZlbnQucG9pbnRlclR5cGUpIHtcblx0XHRcdFx0XHRjYXNlIDI6IGUucG9pbnRlclR5cGUgPSAndG91Y2gnOyBicmVhaztcblx0XHRcdFx0XHRjYXNlIDM6IGUucG9pbnRlclR5cGUgPSAncGVuJzsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSA0OiBlLnBvaW50ZXJUeXBlID0gJ21vdXNlJzsgYnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDogZS5wb2ludGVyVHlwZSA9IG9yaWdFdmVudC5wb2ludGVyVHlwZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZS5wb2ludGVyVHlwZSA9IG9yaWdFdmVudC50eXBlLnN1YnN0cigwLCA1KTsgLy8gXCJtb3VzZVwiIG9yIFwidG91Y2hcIiB3b3JkIGxlbmd0aFxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIWUucGFnZVggJiYgIWUucGFnZVkpIHtcblx0XHRcdFx0dG91Y2hFdmVudERhdGEgPSBvcmlnRXZlbnQuY2hhbmdlZFRvdWNoZXMgPyBvcmlnRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0gOiBvcmlnRXZlbnQ7XG5cdFx0XHRcdGUucGFnZVggPSB0b3VjaEV2ZW50RGF0YS5wYWdlWDtcblx0XHRcdFx0ZS5wYWdlWSA9IHRvdWNoRXZlbnREYXRhLnBhZ2VZO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAob3JpZ0V2ZW50LnR5cGUgPT09ICd0b3VjaGVuZCcpIHtcblx0XHRcdFx0bGFzdFRvdWNoID0geyB4OiBlLnBhZ2VYLCB5OiBlLnBhZ2VZIH07XG5cdFx0XHR9XG5cdFx0XHRpZiAoZS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJyAmJiBsYXN0VG91Y2ggJiYgbW91c2VFdmVudFNpbXVsYXRlZChlKSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gKCQuZXZlbnQuZGlzcGF0Y2ggfHwgJC5ldmVudC5oYW5kbGUpLmNhbGwodGhpcywgZSk7XG5cdFx0XHR9XG5cdFx0fTtcblx0fSgpKTtcblxuXHQvLyBjdXN0b20gbW91c2V3aGVlbC90cmFja3BhZCBoYW5kbGVyXG5cdChmdW5jdGlvbigpIHtcblx0XHR2YXIgd2hlZWxFdmVudHMgPSAoJ29ud2hlZWwnIGluIGRvY3VtZW50IHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA+PSA5ID8gJ3doZWVsJyA6ICdtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsJykuc3BsaXQoJyAnKSxcblx0XHRcdHNoaW1FdmVudE5hbWUgPSAnamNmLW1vdXNld2hlZWwnO1xuXG5cdFx0JC5ldmVudC5zcGVjaWFsW3NoaW1FdmVudE5hbWVdID0ge1xuXHRcdFx0c2V0dXA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdCQuZWFjaCh3aGVlbEV2ZW50cywgZnVuY3Rpb24oaW5kZXgsIGZhbGxiYWNrRXZlbnQpIHtcblx0XHRcdFx0XHRpZiAoc2VsZi5hZGRFdmVudExpc3RlbmVyKSBzZWxmLmFkZEV2ZW50TGlzdGVuZXIoZmFsbGJhY2tFdmVudCwgZml4RXZlbnQsIGZhbHNlKTtcblx0XHRcdFx0XHRlbHNlIHNlbGZbJ29uJyArIGZhbGxiYWNrRXZlbnRdID0gZml4RXZlbnQ7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdHRlYXJkb3duOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHQkLmVhY2god2hlZWxFdmVudHMsIGZ1bmN0aW9uKGluZGV4LCBmYWxsYmFja0V2ZW50KSB7XG5cdFx0XHRcdFx0aWYgKHNlbGYuYWRkRXZlbnRMaXN0ZW5lcikgc2VsZi5yZW1vdmVFdmVudExpc3RlbmVyKGZhbGxiYWNrRXZlbnQsIGZpeEV2ZW50LCBmYWxzZSk7XG5cdFx0XHRcdFx0ZWxzZSBzZWxmWydvbicgKyBmYWxsYmFja0V2ZW50XSA9IG51bGw7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgZml4RXZlbnQgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIgb3JpZ0V2ZW50ID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG5cdFx0XHRlID0gJC5ldmVudC5maXgob3JpZ0V2ZW50KTtcblx0XHRcdGUudHlwZSA9IHNoaW1FdmVudE5hbWU7XG5cblx0XHRcdC8vIG9sZCB3aGVlbCBldmVudHMgaGFuZGxlclxuXHRcdFx0aWYgKCdkZXRhaWwnICAgICAgaW4gb3JpZ0V2ZW50KSB7IGUuZGVsdGFZID0gLW9yaWdFdmVudC5kZXRhaWw7ICAgICAgfVxuXHRcdFx0aWYgKCd3aGVlbERlbHRhJyAgaW4gb3JpZ0V2ZW50KSB7IGUuZGVsdGFZID0gLW9yaWdFdmVudC53aGVlbERlbHRhOyAgfVxuXHRcdFx0aWYgKCd3aGVlbERlbHRhWScgaW4gb3JpZ0V2ZW50KSB7IGUuZGVsdGFZID0gLW9yaWdFdmVudC53aGVlbERlbHRhWTsgfVxuXHRcdFx0aWYgKCd3aGVlbERlbHRhWCcgaW4gb3JpZ0V2ZW50KSB7IGUuZGVsdGFYID0gLW9yaWdFdmVudC53aGVlbERlbHRhWDsgfVxuXG5cdFx0XHQvLyBtb2Rlcm4gd2hlZWwgZXZlbnQgaGFuZGxlclxuXHRcdFx0aWYgKCdkZWx0YVknIGluIG9yaWdFdmVudCkge1xuXHRcdFx0XHRlLmRlbHRhWSA9IG9yaWdFdmVudC5kZWx0YVk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoJ2RlbHRhWCcgaW4gb3JpZ0V2ZW50KSB7XG5cdFx0XHRcdGUuZGVsdGFYID0gb3JpZ0V2ZW50LmRlbHRhWDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaGFuZGxlIGRlbHRhTW9kZSBmb3IgbW91c2Ugd2hlZWxcblx0XHRcdGUuZGVsdGEgPSBlLmRlbHRhWSB8fCBlLmRlbHRhWDtcblx0XHRcdGlmIChvcmlnRXZlbnQuZGVsdGFNb2RlID09PSAxKSB7XG5cdFx0XHRcdHZhciBsaW5lSGVpZ2h0ID0gMTY7XG5cdFx0XHRcdGUuZGVsdGEgKj0gbGluZUhlaWdodDtcblx0XHRcdFx0ZS5kZWx0YVkgKj0gbGluZUhlaWdodDtcblx0XHRcdFx0ZS5kZWx0YVggKj0gbGluZUhlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuICgkLmV2ZW50LmRpc3BhdGNoIHx8ICQuZXZlbnQuaGFuZGxlKS5jYWxsKHRoaXMsIGUpO1xuXHRcdH07XG5cdH0oKSk7XG5cblx0Ly8gZXh0cmEgbW9kdWxlIG1ldGhvZHNcblx0dmFyIG1vZHVsZU1peGluID0ge1xuXHRcdC8vIHByb3ZpZGUgZnVuY3Rpb24gZm9yIGZpcmluZyBuYXRpdmUgZXZlbnRzXG5cdFx0ZmlyZU5hdGl2ZUV2ZW50OiBmdW5jdGlvbihlbGVtZW50cywgZXZlbnROYW1lKSB7XG5cdFx0XHQkKGVsZW1lbnRzKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZWxlbWVudCA9IHRoaXMsIGV2ZW50T2JqZWN0O1xuXHRcdFx0XHRpZiAoZWxlbWVudC5kaXNwYXRjaEV2ZW50KSB7XG5cdFx0XHRcdFx0ZXZlbnRPYmplY3QgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnSFRNTEV2ZW50cycpO1xuXHRcdFx0XHRcdGV2ZW50T2JqZWN0LmluaXRFdmVudChldmVudE5hbWUsIHRydWUsIHRydWUpO1xuXHRcdFx0XHRcdGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudE9iamVjdCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QpIHtcblx0XHRcdFx0XHRldmVudE9iamVjdCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG5cdFx0XHRcdFx0ZXZlbnRPYmplY3QudGFyZ2V0ID0gZWxlbWVudDtcblx0XHRcdFx0XHRlbGVtZW50LmZpcmVFdmVudCgnb24nICsgZXZlbnROYW1lLCBldmVudE9iamVjdCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0Ly8gYmluZCBldmVudCBoYW5kbGVycyBmb3IgbW9kdWxlIGluc3RhbmNlIChmdW5jdGlvbnMgYmVnZ2luaW5nIHdpdGggXCJvblwiKVxuXHRcdGJpbmRIYW5kbGVyczogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHQkLmVhY2goc2VsZiwgZnVuY3Rpb24ocHJvcE5hbWUsIHByb3BWYWx1ZSkge1xuXHRcdFx0XHRpZiAocHJvcE5hbWUuaW5kZXhPZignb24nKSA9PT0gMCAmJiAkLmlzRnVuY3Rpb24ocHJvcFZhbHVlKSkge1xuXHRcdFx0XHRcdC8vIGRvbnQgdXNlICQucHJveHkgaGVyZSBiZWNhdXNlIGl0IGRvZXNuJ3QgY3JlYXRlIHVuaXF1ZSBoYW5kbGVyXG5cdFx0XHRcdFx0c2VsZltwcm9wTmFtZV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHJldHVybiBwcm9wVmFsdWUuYXBwbHkoc2VsZiwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0Ly8gcHVibGljIEFQSVxuXHR2YXIgYXBpID0ge1xuXHRcdHZlcnNpb246IHZlcnNpb24sXG5cdFx0bW9kdWxlczoge30sXG5cdFx0Z2V0T3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoe30sIGNvbW1vbk9wdGlvbnMpO1xuXHRcdH0sXG5cdFx0c2V0T3B0aW9uczogZnVuY3Rpb24obW9kdWxlTmFtZSwgbW9kdWxlT3B0aW9ucykge1xuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdC8vIHNldCBtb2R1bGUgb3B0aW9uc1xuXHRcdFx0XHRpZiAodGhpcy5tb2R1bGVzW21vZHVsZU5hbWVdKSB7XG5cdFx0XHRcdFx0JC5leHRlbmQodGhpcy5tb2R1bGVzW21vZHVsZU5hbWVdLnByb3RvdHlwZS5vcHRpb25zLCBtb2R1bGVPcHRpb25zKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gc2V0IGNvbW1vbiBvcHRpb25zXG5cdFx0XHRcdCQuZXh0ZW5kKGNvbW1vbk9wdGlvbnMsIG1vZHVsZU5hbWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0YWRkTW9kdWxlOiBmdW5jdGlvbihwcm90bykge1xuXHRcdFx0Ly8gcHJvdG8gaXMgZmFjdG9yeSBmdW5jdGlvblxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihwcm90bykpIHtcblx0XHRcdFx0cHJvdG8gPSBwcm90bygkLCB3aW5kb3cpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBhZGQgbW9kdWxlIHRvIGxpc3Rcblx0XHRcdHZhciBNb2R1bGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdC8vIHNhdmUgaW5zdGFuY2UgdG8gY29sbGVjdGlvblxuXHRcdFx0XHRpZiAoIW9wdGlvbnMuZWxlbWVudC5kYXRhKGNvbW1vbk9wdGlvbnMuZGF0YUtleSkpIHtcblx0XHRcdFx0XHRvcHRpb25zLmVsZW1lbnQuZGF0YShjb21tb25PcHRpb25zLmRhdGFLZXksIHRoaXMpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGN1c3RvbUluc3RhbmNlcy5wdXNoKHRoaXMpO1xuXG5cdFx0XHRcdC8vIHNhdmUgb3B0aW9uc1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgY29tbW9uT3B0aW9ucywgdGhpcy5vcHRpb25zLCBnZXRJbmxpbmVPcHRpb25zKG9wdGlvbnMuZWxlbWVudCksIG9wdGlvbnMpO1xuXG5cdFx0XHRcdC8vIGJpbmQgZXZlbnQgaGFuZGxlcnMgdG8gaW5zdGFuY2Vcblx0XHRcdFx0dGhpcy5iaW5kSGFuZGxlcnMoKTtcblxuXHRcdFx0XHQvLyBjYWxsIGNvbnN0cnVjdG9yXG5cdFx0XHRcdHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblxuXHRcdFx0Ly8gcGFyc2Ugb3B0aW9ucyBmcm9tIEhUTUwgYXR0cmlidXRlXG5cdFx0XHR2YXIgZ2V0SW5saW5lT3B0aW9ucyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRcdFx0dmFyIGRhdGFPcHRpb25zID0gZWxlbWVudC5kYXRhKGNvbW1vbk9wdGlvbnMub3B0aW9uc0tleSksXG5cdFx0XHRcdFx0YXR0ck9wdGlvbnMgPSBlbGVtZW50LmF0dHIoY29tbW9uT3B0aW9ucy5vcHRpb25zS2V5KTtcblxuXHRcdFx0XHRpZiAoZGF0YU9wdGlvbnMpIHtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YU9wdGlvbnM7XG5cdFx0XHRcdH0gZWxzZSBpZiAoYXR0ck9wdGlvbnMpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0cmV0dXJuICQucGFyc2VKU09OKGF0dHJPcHRpb25zKTtcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHQvLyBpZ25vcmUgaW52YWxpZCBhdHRyaWJ1dGVzXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBzZXQgcHJvdG8gYXMgcHJvdG90eXBlIGZvciBuZXcgbW9kdWxlXG5cdFx0XHRNb2R1bGUucHJvdG90eXBlID0gcHJvdG87XG5cblx0XHRcdC8vIGFkZCBtaXhpbiBtZXRob2RzIHRvIG1vZHVsZSBwcm90b1xuXHRcdFx0JC5leHRlbmQocHJvdG8sIG1vZHVsZU1peGluKTtcblx0XHRcdGlmIChwcm90by5wbHVnaW5zKSB7XG5cdFx0XHRcdCQuZWFjaChwcm90by5wbHVnaW5zLCBmdW5jdGlvbihwbHVnaW5OYW1lLCBwbHVnaW4pIHtcblx0XHRcdFx0XHQkLmV4dGVuZChwbHVnaW4ucHJvdG90eXBlLCBtb2R1bGVNaXhpbik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBvdmVycmlkZSBkZXN0cm95IG1ldGhvZFxuXHRcdFx0dmFyIG9yaWdpbmFsRGVzdHJveSA9IE1vZHVsZS5wcm90b3R5cGUuZGVzdHJveTtcblx0XHRcdE1vZHVsZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuZWxlbWVudC5yZW1vdmVEYXRhKHRoaXMub3B0aW9ucy5kYXRhS2V5KTtcblxuXHRcdFx0XHRmb3IgKHZhciBpID0gY3VzdG9tSW5zdGFuY2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRcdFx0aWYgKGN1c3RvbUluc3RhbmNlc1tpXSA9PT0gdGhpcykge1xuXHRcdFx0XHRcdFx0Y3VzdG9tSW5zdGFuY2VzLnNwbGljZShpLCAxKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChvcmlnaW5hbERlc3Ryb3kpIHtcblx0XHRcdFx0XHRvcmlnaW5hbERlc3Ryb3kuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0Ly8gc2F2ZSBtb2R1bGUgdG8gbGlzdFxuXHRcdFx0dGhpcy5tb2R1bGVzW3Byb3RvLm5hbWVdID0gTW9kdWxlO1xuXHRcdH0sXG5cdFx0Z2V0SW5zdGFuY2U6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRcdHJldHVybiAkKGVsZW1lbnQpLmRhdGEoY29tbW9uT3B0aW9ucy5kYXRhS2V5KTtcblx0XHR9LFxuXHRcdHJlcGxhY2U6IGZ1bmN0aW9uKGVsZW1lbnRzLCBtb2R1bGVOYW1lLCBjdXN0b21PcHRpb25zKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdGluc3RhbmNlO1xuXG5cdFx0XHRpZiAoIWNvbW1vbk9wdGlvbnMuc3R5bGVTaGVldENyZWF0ZWQpIHtcblx0XHRcdFx0Y3JlYXRlU3R5bGVTaGVldCgpO1xuXHRcdFx0fVxuXG5cdFx0XHQkKGVsZW1lbnRzKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgbW9kdWxlT3B0aW9ucyxcblx0XHRcdFx0XHRlbGVtZW50ID0gJCh0aGlzKTtcblxuXHRcdFx0XHRpbnN0YW5jZSA9IGVsZW1lbnQuZGF0YShjb21tb25PcHRpb25zLmRhdGFLZXkpO1xuXHRcdFx0XHRpZiAoaW5zdGFuY2UpIHtcblx0XHRcdFx0XHRpbnN0YW5jZS5yZWZyZXNoKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKCFtb2R1bGVOYW1lKSB7XG5cdFx0XHRcdFx0XHQkLmVhY2goc2VsZi5tb2R1bGVzLCBmdW5jdGlvbihjdXJyZW50TW9kdWxlTmFtZSwgbW9kdWxlKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChtb2R1bGUucHJvdG90eXBlLm1hdGNoRWxlbWVudC5jYWxsKG1vZHVsZS5wcm90b3R5cGUsIGVsZW1lbnQpKSB7XG5cdFx0XHRcdFx0XHRcdFx0bW9kdWxlTmFtZSA9IGN1cnJlbnRNb2R1bGVOYW1lO1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChtb2R1bGVOYW1lKSB7XG5cdFx0XHRcdFx0XHRtb2R1bGVPcHRpb25zID0gJC5leHRlbmQoeyBlbGVtZW50OiBlbGVtZW50IH0sIGN1c3RvbU9wdGlvbnMpO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2UgPSBuZXcgc2VsZi5tb2R1bGVzW21vZHVsZU5hbWVdKG1vZHVsZU9wdGlvbnMpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gaW5zdGFuY2U7XG5cdFx0fSxcblx0XHRyZWZyZXNoOiBmdW5jdGlvbihlbGVtZW50cykge1xuXHRcdFx0JChlbGVtZW50cykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJCh0aGlzKS5kYXRhKGNvbW1vbk9wdGlvbnMuZGF0YUtleSk7XG5cdFx0XHRcdGlmIChpbnN0YW5jZSkge1xuXHRcdFx0XHRcdGluc3RhbmNlLnJlZnJlc2goKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRkZXN0cm95OiBmdW5jdGlvbihlbGVtZW50cykge1xuXHRcdFx0JChlbGVtZW50cykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJCh0aGlzKS5kYXRhKGNvbW1vbk9wdGlvbnMuZGF0YUtleSk7XG5cdFx0XHRcdGlmIChpbnN0YW5jZSkge1xuXHRcdFx0XHRcdGluc3RhbmNlLmRlc3Ryb3koKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRyZXBsYWNlQWxsOiBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHQkLmVhY2godGhpcy5tb2R1bGVzLCBmdW5jdGlvbihtb2R1bGVOYW1lLCBtb2R1bGUpIHtcblx0XHRcdFx0JChtb2R1bGUucHJvdG90eXBlLnNlbGVjdG9yLCBjb250ZXh0KS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLmNsYXNzTmFtZS5pbmRleE9mKCdqY2YtaWdub3JlJykgPCAwKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnJlcGxhY2UodGhpcywgbW9kdWxlTmFtZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0cmVmcmVzaEFsbDogZnVuY3Rpb24oY29udGV4dCkge1xuXHRcdFx0aWYgKGNvbnRleHQpIHtcblx0XHRcdFx0JC5lYWNoKHRoaXMubW9kdWxlcywgZnVuY3Rpb24obW9kdWxlTmFtZSwgbW9kdWxlKSB7XG5cdFx0XHRcdFx0JChtb2R1bGUucHJvdG90eXBlLnNlbGVjdG9yLCBjb250ZXh0KS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0dmFyIGluc3RhbmNlID0gJCh0aGlzKS5kYXRhKGNvbW1vbk9wdGlvbnMuZGF0YUtleSk7XG5cdFx0XHRcdFx0XHRpZiAoaW5zdGFuY2UpIHtcblx0XHRcdFx0XHRcdFx0aW5zdGFuY2UucmVmcmVzaCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAodmFyIGkgPSBjdXN0b21JbnN0YW5jZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRjdXN0b21JbnN0YW5jZXNbaV0ucmVmcmVzaCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRkZXN0cm95QWxsOiBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFx0XHRpZiAoY29udGV4dCkge1xuXHRcdFx0XHQkLmVhY2godGhpcy5tb2R1bGVzLCBmdW5jdGlvbihtb2R1bGVOYW1lLCBtb2R1bGUpIHtcblx0XHRcdFx0XHQkKG1vZHVsZS5wcm90b3R5cGUuc2VsZWN0b3IsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpIHtcblx0XHRcdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQoZWxlbWVudCkuZGF0YShjb21tb25PcHRpb25zLmRhdGFLZXkpO1xuXHRcdFx0XHRcdFx0aWYgKGluc3RhbmNlKSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbmNlLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3aGlsZSAoY3VzdG9tSW5zdGFuY2VzLmxlbmd0aCkge1xuXHRcdFx0XHRcdGN1c3RvbUluc3RhbmNlc1swXS5kZXN0cm95KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0Ly8gd2UgbmVlZCB0byBtYWtlIEpDRiBhdmFpbGFibGUgZ2xvYmFsbHkgaWYgd2UncmUgaW4gQU1EIGVudmlyb25tZW50XG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHR3aW5kb3cuamNmID0gYXBpO1xuXHR9XG5cblx0cmV0dXJuIGFwaTtcbn0pKTtcbiIsIi8qIVxuICogSmF2YVNjcmlwdCBDdXN0b20gRm9ybXMgOiBSYW5nZSBNb2R1bGVcbiAqXG4gKiBDb3B5cmlnaHQgMjAxNC0yMDE1IFBTRDJIVE1MIC0gaHR0cDovL3BzZDJodG1sLmNvbS9qY2ZcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSAoTElDRU5TRS50eHQpXG4gKlxuICogVmVyc2lvbjogMS4yLjNcbiAqL1xuXG4oZnVuY3Rpb24oamNmKSB7XG5cbmpjZi5hZGRNb2R1bGUoZnVuY3Rpb24oJCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0cmV0dXJuIHtcblx0XHRuYW1lOiAnUmFuZ2UnLFxuXHRcdHNlbGVjdG9yOiAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJyxcblx0XHRvcHRpb25zOiB7XG5cdFx0XHRyZWFsRWxlbWVudENsYXNzOiAnamNmLXJlYWwtZWxlbWVudCcsXG5cdFx0XHRmYWtlU3RydWN0dXJlOiAnPHNwYW4gY2xhc3M9XCJqY2YtcmFuZ2VcIj48c3BhbiBjbGFzcz1cImpjZi1yYW5nZS13cmFwcGVyXCI+PHNwYW4gY2xhc3M9XCJqY2YtcmFuZ2UtdHJhY2tcIj48c3BhbiBjbGFzcz1cImpjZi1yYW5nZS1oYW5kbGVcIj48L3NwYW4+PC9zcGFuPjwvc3Bhbj48L3NwYW4+Jyxcblx0XHRcdGRhdGFMaXN0TWFyazogJzxzcGFuIGNsYXNzPVwiamNmLXJhbmdlLW1hcmtcIj48L3NwYW4+Jyxcblx0XHRcdHJhbmdlRGlzcGxheVdyYXBwZXI6ICc8c3BhbiBjbGFzcz1cImpjZi1yYW5nZS1kaXNwbGF5LXdyYXBwZXJcIj48L3NwYW4+Jyxcblx0XHRcdHJhbmdlRGlzcGxheTogJzxzcGFuIGNsYXNzPVwiamNmLXJhbmdlLWRpc3BsYXlcIj48L3NwYW4+Jyxcblx0XHRcdGhhbmRsZVNlbGVjdG9yOiAnLmpjZi1yYW5nZS1oYW5kbGUnLFxuXHRcdFx0dHJhY2tTZWxlY3RvcjogJy5qY2YtcmFuZ2UtdHJhY2snLFxuXHRcdFx0YWN0aXZlSGFuZGxlQ2xhc3M6ICdqY2YtYWN0aXZlLWhhbmRsZScsXG5cdFx0XHR2ZXJ0aWNhbENsYXNzOiAnamNmLXZlcnRpY2FsJyxcblx0XHRcdG9yaWVudGF0aW9uOiAnaG9yaXpvbnRhbCcsXG5cdFx0XHRyYW5nZTogZmFsc2UsIC8vIG9yIFwibWluXCIsIFwibWF4XCIsIFwiYWxsXCJcblx0XHRcdGRyYWdIYW5kbGVDZW50ZXI6IHRydWUsXG5cdFx0XHRzbmFwVG9NYXJrczogdHJ1ZSxcblx0XHRcdHNuYXBSYWRpdXM6IDUsXG5cdFx0XHRtaW5SYW5nZTogMFxuXHRcdH0sXG5cdFx0bWF0Y2hFbGVtZW50OiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0XHRyZXR1cm4gZWxlbWVudC5pcyh0aGlzLnNlbGVjdG9yKTtcblx0XHR9LFxuXHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5pbml0U3RydWN0dXJlKCk7XG5cdFx0XHR0aGlzLmF0dGFjaEV2ZW50cygpO1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fSxcblx0XHRpbml0U3RydWN0dXJlOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMucGFnZSA9ICQoJ2h0bWwnKTtcblx0XHRcdHRoaXMucmVhbEVsZW1lbnQgPSAkKHRoaXMub3B0aW9ucy5lbGVtZW50KS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaGlkZGVuQ2xhc3MpO1xuXHRcdFx0dGhpcy5mYWtlRWxlbWVudCA9ICQodGhpcy5vcHRpb25zLmZha2VTdHJ1Y3R1cmUpLmluc2VydEJlZm9yZSh0aGlzLnJlYWxFbGVtZW50KS5wcmVwZW5kKHRoaXMucmVhbEVsZW1lbnQpO1xuXHRcdFx0dGhpcy50cmFjayA9IHRoaXMuZmFrZUVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMudHJhY2tTZWxlY3Rvcik7XG5cdFx0XHR0aGlzLnRyYWNrSG9sZGVyID0gdGhpcy50cmFjay5wYXJlbnQoKTtcblx0XHRcdHRoaXMuaGFuZGxlID0gdGhpcy5mYWtlRWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5oYW5kbGVTZWxlY3Rvcik7XG5cdFx0XHR0aGlzLmNyZWF0ZWRIYW5kbGVDb3VudCA9IDA7XG5cdFx0XHR0aGlzLmFjdGl2ZURyYWdIYW5kbGVJbmRleCA9IDA7XG5cdFx0XHR0aGlzLmlzTXVsdGlwbGUgPSB0aGlzLnJlYWxFbGVtZW50LnByb3AoJ211bHRpcGxlJykgfHwgdHlwZW9mIHRoaXMucmVhbEVsZW1lbnQuYXR0cignbXVsdGlwbGUnKSA9PT0gJ3N0cmluZyc7XG5cdFx0XHR0aGlzLnZhbHVlcyA9IHRoaXMuaXNNdWx0aXBsZSA/IHRoaXMucmVhbEVsZW1lbnQuYXR0cigndmFsdWUnKS5zcGxpdCgnLCcpIDogW3RoaXMucmVhbEVsZW1lbnQudmFsKCldO1xuXHRcdFx0dGhpcy5oYW5kbGVDb3VudCA9IHRoaXMuaXNNdWx0aXBsZSA/IHRoaXMudmFsdWVzLmxlbmd0aCA6IDE7XG5cblx0XHRcdC8vIGNyZWF0ZSByYW5nZSBkaXNwbGF5XG5cdFx0XHR0aGlzLnJhbmdlRGlzcGxheVdyYXBwZXIgPSAkKHRoaXMub3B0aW9ucy5yYW5nZURpc3BsYXlXcmFwcGVyKS5pbnNlcnRCZWZvcmUodGhpcy50cmFjayk7XG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnJhbmdlID09PSAnbWluJyB8fCB0aGlzLm9wdGlvbnMucmFuZ2UgPT09ICdhbGwnKSB7XG5cdFx0XHRcdHRoaXMucmFuZ2VNaW4gPSAkKHRoaXMub3B0aW9ucy5yYW5nZURpc3BsYXkpLmFkZENsYXNzKCdqY2YtcmFuZ2UtbWluJykucHJlcGVuZFRvKHRoaXMucmFuZ2VEaXNwbGF5V3JhcHBlcik7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnJhbmdlID09PSAnbWF4JyB8fCB0aGlzLm9wdGlvbnMucmFuZ2UgPT09ICdhbGwnKSB7XG5cdFx0XHRcdHRoaXMucmFuZ2VNYXggPSAkKHRoaXMub3B0aW9ucy5yYW5nZURpc3BsYXkpLmFkZENsYXNzKCdqY2YtcmFuZ2UtbWF4JykucHJlcGVuZFRvKHRoaXMucmFuZ2VEaXNwbGF5V3JhcHBlcik7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNsb25lIGhhbmRsZXMgaWYgbmVlZGVkXG5cdFx0XHR3aGlsZSAodGhpcy5jcmVhdGVkSGFuZGxlQ291bnQgPCB0aGlzLmhhbmRsZUNvdW50KSB7XG5cdFx0XHRcdHRoaXMuY3JlYXRlZEhhbmRsZUNvdW50Kys7XG5cdFx0XHRcdHRoaXMuaGFuZGxlLmNsb25lKCkuYWRkQ2xhc3MoJ2pjZi1pbmRleC0nICsgdGhpcy5jcmVhdGVkSGFuZGxlQ291bnQpLmluc2VydEJlZm9yZSh0aGlzLmhhbmRsZSk7XG5cblx0XHRcdFx0Ly8gY3JlYXRlIG1pZCByYW5nZXNcblx0XHRcdFx0aWYgKHRoaXMuY3JlYXRlZEhhbmRsZUNvdW50ID4gMSkge1xuXHRcdFx0XHRcdGlmICghdGhpcy5yYW5nZU1pZCkge1xuXHRcdFx0XHRcdFx0dGhpcy5yYW5nZU1pZCA9ICQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5yYW5nZU1pZCA9IHRoaXMucmFuZ2VNaWQuYWRkKCQodGhpcy5vcHRpb25zLnJhbmdlRGlzcGxheSkuYWRkQ2xhc3MoJ2pjZi1yYW5nZS1taWQnKS5wcmVwZW5kVG8odGhpcy5yYW5nZURpc3BsYXlXcmFwcGVyKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ3JhYiBhbGwgaGFuZGxlc1xuXHRcdFx0dGhpcy5oYW5kbGUuZGV0YWNoKCk7XG5cdFx0XHR0aGlzLmhhbmRsZSA9IG51bGw7XG5cdFx0XHR0aGlzLmhhbmRsZXMgPSB0aGlzLmZha2VFbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLmhhbmRsZVNlbGVjdG9yKTtcblx0XHRcdHRoaXMuaGFuZGxlcy5lcSgwKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlSGFuZGxlQ2xhc3MpO1xuXG5cdFx0XHQvLyBoYW5kbGUgb3JpZW50YXRpb25cblx0XHRcdHRoaXMuaXNWZXJ0aWNhbCA9ICh0aGlzLm9wdGlvbnMub3JpZW50YXRpb24gPT09ICd2ZXJ0aWNhbCcpO1xuXHRcdFx0dGhpcy5kaXJlY3Rpb25Qcm9wZXJ0eSA9IHRoaXMuaXNWZXJ0aWNhbCA/ICd0b3AnIDogJ2xlZnQnO1xuXHRcdFx0dGhpcy5vZmZzZXRQcm9wZXJ0eSA9IHRoaXMuaXNWZXJ0aWNhbCA/ICdib3R0b20nIDogJ2xlZnQnO1xuXHRcdFx0dGhpcy5ldmVudFByb3BlcnR5ID0gdGhpcy5pc1ZlcnRpY2FsID8gJ3BhZ2VZJyA6ICdwYWdlWCc7XG5cdFx0XHR0aGlzLnNpemVQcm9wZXJ0eSA9IHRoaXMuaXNWZXJ0aWNhbCA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblx0XHRcdHRoaXMuc2l6ZU1ldGhvZCA9IHRoaXMuaXNWZXJ0aWNhbCA/ICdpbm5lckhlaWdodCcgOiAnaW5uZXJXaWR0aCc7XG5cdFx0XHR0aGlzLmZha2VFbGVtZW50LmNzcygndG91Y2hBY3Rpb24nLCB0aGlzLmlzVmVydGljYWwgPyAncGFuLXgnIDogJ3Bhbi15Jyk7XG5cdFx0XHRpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG5cdFx0XHRcdHRoaXMuZmFrZUVsZW1lbnQuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnZlcnRpY2FsQ2xhc3MpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzZXQgaW5pdGlhbCB2YWx1ZXNcblx0XHRcdHRoaXMubWluVmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMucmVhbEVsZW1lbnQuYXR0cignbWluJykpO1xuXHRcdFx0dGhpcy5tYXhWYWx1ZSA9IHBhcnNlRmxvYXQodGhpcy5yZWFsRWxlbWVudC5hdHRyKCdtYXgnKSk7XG5cdFx0XHR0aGlzLnN0ZXBWYWx1ZSA9IHBhcnNlRmxvYXQodGhpcy5yZWFsRWxlbWVudC5hdHRyKCdzdGVwJykpIHx8IDE7XG5cblx0XHRcdC8vIGNoZWNrIGF0dHJpYnV0ZSB2YWx1ZXNcblx0XHRcdHRoaXMubWluVmFsdWUgPSBpc05hTih0aGlzLm1pblZhbHVlKSA/IDAgOiB0aGlzLm1pblZhbHVlO1xuXHRcdFx0dGhpcy5tYXhWYWx1ZSA9IGlzTmFOKHRoaXMubWF4VmFsdWUpID8gMTAwIDogdGhpcy5tYXhWYWx1ZTtcblxuXHRcdFx0Ly8gaGFuZGxlIHJhbmdlXG5cdFx0XHRpZiAodGhpcy5zdGVwVmFsdWUgIT09IDEpIHtcblx0XHRcdFx0dGhpcy5tYXhWYWx1ZSAtPSAodGhpcy5tYXhWYWx1ZSAtIHRoaXMubWluVmFsdWUpICUgdGhpcy5zdGVwVmFsdWU7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnN0ZXBzQ291bnQgPSAodGhpcy5tYXhWYWx1ZSAtIHRoaXMubWluVmFsdWUpIC8gdGhpcy5zdGVwVmFsdWU7XG5cdFx0XHR0aGlzLmNyZWF0ZURhdGFMaXN0KCk7XG5cdFx0fSxcblx0XHRhdHRhY2hFdmVudHM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5yZWFsRWxlbWVudC5vbih7XG5cdFx0XHRcdGZvY3VzOiB0aGlzLm9uRm9jdXNcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy50cmFja0hvbGRlci5vbignamNmLXBvaW50ZXJkb3duJywgdGhpcy5vblRyYWNrUHJlc3MpO1xuXHRcdFx0dGhpcy5oYW5kbGVzLm9uKCdqY2YtcG9pbnRlcmRvd24nLCB0aGlzLm9uSGFuZGxlUHJlc3MpO1xuXHRcdH0sXG5cdFx0Y3JlYXRlRGF0YUxpc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHRkYXRhVmFsdWVzID0gW10sXG5cdFx0XHRcdGRhdGFMaXN0SWQgPSB0aGlzLnJlYWxFbGVtZW50LmF0dHIoJ2xpc3QnKTtcblxuXHRcdFx0aWYgKGRhdGFMaXN0SWQpIHtcblx0XHRcdFx0JCgnIycgKyBkYXRhTGlzdElkKS5maW5kKCdvcHRpb24nKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBpdGVtVmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMudmFsdWUgfHwgdGhpcy5pbm5lckhUTUwpLFxuXHRcdFx0XHRcdFx0bWFyaywgbWFya09mZnNldDtcblxuXHRcdFx0XHRcdGlmICghaXNOYU4oaXRlbVZhbHVlKSkge1xuXHRcdFx0XHRcdFx0bWFya09mZnNldCA9IHNlbGYudmFsdWVUb09mZnNldChpdGVtVmFsdWUpO1xuXHRcdFx0XHRcdFx0ZGF0YVZhbHVlcy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0dmFsdWU6IGl0ZW1WYWx1ZSxcblx0XHRcdFx0XHRcdFx0b2Zmc2V0OiBtYXJrT2Zmc2V0XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdG1hcmsgPSAkKHNlbGYub3B0aW9ucy5kYXRhTGlzdE1hcmspLnRleHQoaXRlbVZhbHVlKS5hdHRyKHtcblx0XHRcdFx0XHRcdFx0J2RhdGEtbWFyay12YWx1ZSc6IGl0ZW1WYWx1ZVxuXHRcdFx0XHRcdFx0fSkuY3NzKHNlbGYub2Zmc2V0UHJvcGVydHksIG1hcmtPZmZzZXQgKyAnJScpLmFwcGVuZFRvKHNlbGYudHJhY2spO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmIChkYXRhVmFsdWVzLmxlbmd0aCkge1xuXHRcdFx0XHRcdHNlbGYuZGF0YVZhbHVlcyA9IGRhdGFWYWx1ZXM7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdGdldERyYWdIYW5kbGVSYW5nZTogZnVuY3Rpb24oaGFuZGxlSW5kZXgpIHtcblx0XHRcdC8vIGNhbGN1bGF0ZSByYW5nZSBmb3Igc2xpZGVyIHdpdGggbXVsdGlwbGUgaGFuZGxlc1xuXHRcdFx0dmFyIG1pblN0ZXAgPSAtSW5maW5pdHksXG5cdFx0XHRcdG1heFN0ZXAgPSBJbmZpbml0eTtcblxuXHRcdFx0aWYgKGhhbmRsZUluZGV4ID4gMCkge1xuXHRcdFx0XHRtaW5TdGVwID0gdGhpcy52YWx1ZVRvU3RlcEluZGV4KHBhcnNlRmxvYXQodGhpcy52YWx1ZXNbaGFuZGxlSW5kZXggLSAxXSkgKyB0aGlzLm9wdGlvbnMubWluUmFuZ2UpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGhhbmRsZUluZGV4IDwgdGhpcy5oYW5kbGVDb3VudCAtIDEpIHtcblx0XHRcdFx0bWF4U3RlcCA9IHRoaXMudmFsdWVUb1N0ZXBJbmRleChwYXJzZUZsb2F0KHRoaXMudmFsdWVzW2hhbmRsZUluZGV4ICsgMV0pIC0gdGhpcy5vcHRpb25zLm1pblJhbmdlKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0bWluU3RlcEluZGV4OiBtaW5TdGVwLFxuXHRcdFx0XHRtYXhTdGVwSW5kZXg6IG1heFN0ZXBcblx0XHRcdH07XG5cdFx0fSxcblx0XHRnZXROZWFyZXN0SGFuZGxlOiBmdW5jdGlvbihwZXJjZW50KSB7XG5cdFx0XHQvLyBoYW5kbGUgdmVydGljYWwgc2xpZGVyc1xuXHRcdFx0aWYgKHRoaXMuaXNWZXJ0aWNhbCkge1xuXHRcdFx0XHRwZXJjZW50ID0gMSAtIHBlcmNlbnQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGRldGVjdCBjbG9zZXN0IGhhbmRsZSB3aGVuIHRyYWNrIGlzIHByZXNzZWRcblx0XHRcdHZhciBjbG9zZXN0SGFuZGxlID0gdGhpcy5oYW5kbGVzLmVxKDApLFxuXHRcdFx0XHRjbG9zZXN0RGlzdGFuY2UgPSBJbmZpbml0eSxcblx0XHRcdFx0c2VsZiA9IHRoaXM7XG5cblx0XHRcdGlmICh0aGlzLmhhbmRsZUNvdW50ID4gMSkge1xuXHRcdFx0XHR0aGlzLmhhbmRsZXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgaGFuZGxlT2Zmc2V0ID0gcGFyc2VGbG9hdCh0aGlzLnN0eWxlW3NlbGYub2Zmc2V0UHJvcGVydHldKSAvIDEwMCxcblx0XHRcdFx0XHRcdGhhbmRsZURpc3RhbmNlID0gTWF0aC5hYnMoaGFuZGxlT2Zmc2V0IC0gcGVyY2VudCk7XG5cblx0XHRcdFx0XHRpZiAoaGFuZGxlRGlzdGFuY2UgPCBjbG9zZXN0RGlzdGFuY2UpIHtcblx0XHRcdFx0XHRcdGNsb3Nlc3REaXN0YW5jZSA9IGhhbmRsZURpc3RhbmNlO1xuXHRcdFx0XHRcdFx0Y2xvc2VzdEhhbmRsZSA9ICQodGhpcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBjbG9zZXN0SGFuZGxlO1xuXHRcdH0sXG5cdFx0b25UcmFja1ByZXNzOiBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIgdHJhY2tTaXplLCB0cmFja09mZnNldCwgaW5uZXJPZmZzZXQ7XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGlmICghdGhpcy5yZWFsRWxlbWVudC5pcygnOmRpc2FibGVkJykgJiYgIXRoaXMuYWN0aXZlRHJhZ0hhbmRsZSkge1xuXHRcdFx0XHR0cmFja1NpemUgPSB0aGlzLnRyYWNrW3RoaXMuc2l6ZU1ldGhvZF0oKTtcblx0XHRcdFx0dHJhY2tPZmZzZXQgPSB0aGlzLnRyYWNrLm9mZnNldCgpW3RoaXMuZGlyZWN0aW9uUHJvcGVydHldO1xuXHRcdFx0XHR0aGlzLmFjdGl2ZURyYWdIYW5kbGUgPSB0aGlzLmdldE5lYXJlc3RIYW5kbGUoKGVbdGhpcy5ldmVudFByb3BlcnR5XSAtIHRyYWNrT2Zmc2V0KSAvIHRoaXMudHJhY2tIb2xkZXJbdGhpcy5zaXplTWV0aG9kXSgpKTtcblx0XHRcdFx0dGhpcy5hY3RpdmVEcmFnSGFuZGxlSW5kZXggPSB0aGlzLmhhbmRsZXMuaW5kZXgodGhpcy5hY3RpdmVEcmFnSGFuZGxlKTtcblx0XHRcdFx0dGhpcy5oYW5kbGVzLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVIYW5kbGVDbGFzcykuZXEodGhpcy5hY3RpdmVEcmFnSGFuZGxlSW5kZXgpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVIYW5kbGVDbGFzcyk7XG5cdFx0XHRcdGlubmVyT2Zmc2V0ID0gdGhpcy5hY3RpdmVEcmFnSGFuZGxlW3RoaXMuc2l6ZU1ldGhvZF0oKSAvIDI7XG5cblx0XHRcdFx0dGhpcy5kcmFnRGF0YSA9IHtcblx0XHRcdFx0XHR0cmFja1NpemU6IHRyYWNrU2l6ZSxcblx0XHRcdFx0XHRpbm5lck9mZnNldDogaW5uZXJPZmZzZXQsXG5cdFx0XHRcdFx0dHJhY2tPZmZzZXQ6IHRyYWNrT2Zmc2V0LFxuXHRcdFx0XHRcdG1pbjogdHJhY2tPZmZzZXQsXG5cdFx0XHRcdFx0bWF4OiB0cmFja09mZnNldCArIHRyYWNrU2l6ZVxuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGlzLnBhZ2Uub24oe1xuXHRcdFx0XHRcdCdqY2YtcG9pbnRlcm1vdmUnOiB0aGlzLm9uSGFuZGxlTW92ZSxcblx0XHRcdFx0XHQnamNmLXBvaW50ZXJ1cCc6IHRoaXMub25IYW5kbGVSZWxlYXNlXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChlLnBvaW50ZXJUeXBlID09PSAnbW91c2UnKSB7XG5cdFx0XHRcdFx0dGhpcy5yZWFsRWxlbWVudC5mb2N1cygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5vbkhhbmRsZU1vdmUoZSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRvbkhhbmRsZVByZXNzOiBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIgdHJhY2tTaXplLCB0cmFja09mZnNldCwgaW5uZXJPZmZzZXQ7XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGlmICghdGhpcy5yZWFsRWxlbWVudC5pcygnOmRpc2FibGVkJykgJiYgIXRoaXMuYWN0aXZlRHJhZ0hhbmRsZSkge1xuXHRcdFx0XHR0aGlzLmFjdGl2ZURyYWdIYW5kbGUgPSAkKGUuY3VycmVudFRhcmdldCk7XG5cdFx0XHRcdHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4ID0gdGhpcy5oYW5kbGVzLmluZGV4KHRoaXMuYWN0aXZlRHJhZ0hhbmRsZSk7XG5cdFx0XHRcdHRoaXMuaGFuZGxlcy5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlSGFuZGxlQ2xhc3MpLmVxKHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4KS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlSGFuZGxlQ2xhc3MpO1xuXHRcdFx0XHR0cmFja1NpemUgPSB0aGlzLnRyYWNrW3RoaXMuc2l6ZU1ldGhvZF0oKTtcblx0XHRcdFx0dHJhY2tPZmZzZXQgPSB0aGlzLnRyYWNrLm9mZnNldCgpW3RoaXMuZGlyZWN0aW9uUHJvcGVydHldO1xuXHRcdFx0XHRpbm5lck9mZnNldCA9IHRoaXMub3B0aW9ucy5kcmFnSGFuZGxlQ2VudGVyID8gdGhpcy5hY3RpdmVEcmFnSGFuZGxlW3RoaXMuc2l6ZU1ldGhvZF0oKSAvIDIgOiBlW3RoaXMuZXZlbnRQcm9wZXJ0eV0gLSB0aGlzLmhhbmRsZS5vZmZzZXQoKVt0aGlzLmRpcmVjdGlvblByb3BlcnR5XTtcblxuXHRcdFx0XHR0aGlzLmRyYWdEYXRhID0ge1xuXHRcdFx0XHRcdHRyYWNrU2l6ZTogdHJhY2tTaXplLFxuXHRcdFx0XHRcdGlubmVyT2Zmc2V0OiBpbm5lck9mZnNldCxcblx0XHRcdFx0XHR0cmFja09mZnNldDogdHJhY2tPZmZzZXQsXG5cdFx0XHRcdFx0bWluOiB0cmFja09mZnNldCxcblx0XHRcdFx0XHRtYXg6IHRyYWNrT2Zmc2V0ICsgdHJhY2tTaXplXG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoaXMucGFnZS5vbih7XG5cdFx0XHRcdFx0J2pjZi1wb2ludGVybW92ZSc6IHRoaXMub25IYW5kbGVNb3ZlLFxuXHRcdFx0XHRcdCdqY2YtcG9pbnRlcnVwJzogdGhpcy5vbkhhbmRsZVJlbGVhc2Vcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKGUucG9pbnRlclR5cGUgPT09ICdtb3VzZScpIHtcblx0XHRcdFx0XHR0aGlzLnJlYWxFbGVtZW50LmZvY3VzKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdG9uSGFuZGxlTW92ZTogZnVuY3Rpb24oZSkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHRuZXdPZmZzZXQsIGRyYWdQZXJjZW50LCBzdGVwSW5kZXgsIHZhbHVlUGVyY2VudCwgaGFuZGxlRHJhZ1JhbmdlO1xuXG5cdFx0XHQvLyBjYWxjdWxhdGUgb2Zmc2V0XG5cdFx0XHRpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG5cdFx0XHRcdG5ld09mZnNldCA9IHRoaXMuZHJhZ0RhdGEubWF4ICsgKHRoaXMuZHJhZ0RhdGEubWluIC0gZVt0aGlzLmV2ZW50UHJvcGVydHldKSAtIHRoaXMuZHJhZ0RhdGEuaW5uZXJPZmZzZXQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXdPZmZzZXQgPSBlW3RoaXMuZXZlbnRQcm9wZXJ0eV0gLSB0aGlzLmRyYWdEYXRhLmlubmVyT2Zmc2V0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBmaXQgaW4gcmFuZ2Vcblx0XHRcdGlmIChuZXdPZmZzZXQgPCB0aGlzLmRyYWdEYXRhLm1pbikge1xuXHRcdFx0XHRuZXdPZmZzZXQgPSB0aGlzLmRyYWdEYXRhLm1pbjtcblx0XHRcdH0gZWxzZSBpZiAobmV3T2Zmc2V0ID4gdGhpcy5kcmFnRGF0YS5tYXgpIHtcblx0XHRcdFx0bmV3T2Zmc2V0ID0gdGhpcy5kcmFnRGF0YS5tYXg7XG5cdFx0XHR9XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc25hcFRvTWFya3MgJiYgdGhpcy5kYXRhVmFsdWVzKSB7XG5cdFx0XHRcdC8vIHNuYXAgaGFuZGxlIHRvIG1hcmtzXG5cdFx0XHRcdHZhciBkcmFnT2Zmc2V0ID0gbmV3T2Zmc2V0IC0gdGhpcy5kcmFnRGF0YS50cmFja09mZnNldDtcblx0XHRcdFx0ZHJhZ1BlcmNlbnQgPSAobmV3T2Zmc2V0IC0gdGhpcy5kcmFnRGF0YS50cmFja09mZnNldCkgLyB0aGlzLmRyYWdEYXRhLnRyYWNrU2l6ZSAqIDEwMDtcblxuXHRcdFx0XHQkLmVhY2godGhpcy5kYXRhVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgaXRlbSkge1xuXHRcdFx0XHRcdHZhciBtYXJrT2Zmc2V0ID0gaXRlbS5vZmZzZXQgLyAxMDAgKiBzZWxmLmRyYWdEYXRhLnRyYWNrU2l6ZSxcblx0XHRcdFx0XHRcdG1hcmtNaW4gPSBtYXJrT2Zmc2V0IC0gc2VsZi5vcHRpb25zLnNuYXBSYWRpdXMsXG5cdFx0XHRcdFx0XHRtYXJrTWF4ID0gbWFya09mZnNldCArIHNlbGYub3B0aW9ucy5zbmFwUmFkaXVzO1xuXG5cdFx0XHRcdFx0aWYgKGRyYWdPZmZzZXQgPj0gbWFya01pbiAmJiBkcmFnT2Zmc2V0IDw9IG1hcmtNYXgpIHtcblx0XHRcdFx0XHRcdGRyYWdQZXJjZW50ID0gaXRlbS5vZmZzZXQ7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHNuYXAgaGFuZGxlIHRvIHN0ZXBzXG5cdFx0XHRcdGRyYWdQZXJjZW50ID0gKG5ld09mZnNldCAtIHRoaXMuZHJhZ0RhdGEudHJhY2tPZmZzZXQpIC8gdGhpcy5kcmFnRGF0YS50cmFja1NpemUgKiAxMDA7XG5cdFx0XHR9XG5cblx0XHRcdC8vIG1vdmUgaGFuZGxlIG9ubHkgaW4gcmFuZ2Vcblx0XHRcdHN0ZXBJbmRleCA9IE1hdGgucm91bmQoZHJhZ1BlcmNlbnQgKiB0aGlzLnN0ZXBzQ291bnQgLyAxMDApO1xuXHRcdFx0aWYgKHRoaXMuaGFuZGxlQ291bnQgPiAxKSB7XG5cdFx0XHRcdGhhbmRsZURyYWdSYW5nZSA9IHRoaXMuZ2V0RHJhZ0hhbmRsZVJhbmdlKHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4KTtcblx0XHRcdFx0aWYgKHN0ZXBJbmRleCA8IGhhbmRsZURyYWdSYW5nZS5taW5TdGVwSW5kZXgpIHtcblx0XHRcdFx0XHRzdGVwSW5kZXggPSBNYXRoLm1heChoYW5kbGVEcmFnUmFuZ2UubWluU3RlcEluZGV4LCBzdGVwSW5kZXgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHN0ZXBJbmRleCA+IGhhbmRsZURyYWdSYW5nZS5tYXhTdGVwSW5kZXgpIHtcblx0XHRcdFx0XHRzdGVwSW5kZXggPSBNYXRoLm1pbihoYW5kbGVEcmFnUmFuZ2UubWF4U3RlcEluZGV4LCBzdGVwSW5kZXgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YWx1ZVBlcmNlbnQgPSBzdGVwSW5kZXggKiAoMTAwIC8gdGhpcy5zdGVwc0NvdW50KTtcblxuXHRcdFx0aWYgKHRoaXMuZHJhZ0RhdGEuc3RlcEluZGV4ICE9PSBzdGVwSW5kZXgpIHtcblx0XHRcdFx0dGhpcy5kcmFnRGF0YS5zdGVwSW5kZXggPSBzdGVwSW5kZXg7XG5cdFx0XHRcdHRoaXMuZHJhZ0RhdGEub2Zmc2V0ID0gdmFsdWVQZXJjZW50O1xuXHRcdFx0XHR0aGlzLmFjdGl2ZURyYWdIYW5kbGUuY3NzKHRoaXMub2Zmc2V0UHJvcGVydHksIHRoaXMuZHJhZ0RhdGEub2Zmc2V0ICsgJyUnKTtcblxuXHRcdFx0XHQvLyB1cGRhdGUgdmFsdWUocykgYW5kIHRyaWdnZXIgXCJpbnB1dFwiIGV2ZW50XG5cdFx0XHRcdHRoaXMudmFsdWVzW3RoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4XSA9ICcnICsgdGhpcy5zdGVwSW5kZXhUb1ZhbHVlKHN0ZXBJbmRleCk7XG5cdFx0XHRcdHRoaXMudXBkYXRlVmFsdWVzKCk7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQudHJpZ2dlcignaW5wdXQnKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG9uSGFuZGxlUmVsZWFzZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3VmFsdWU7XG5cdFx0XHRpZiAodHlwZW9mIHRoaXMuZHJhZ0RhdGEub2Zmc2V0ID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRuZXdWYWx1ZSA9IHRoaXMuc3RlcEluZGV4VG9WYWx1ZSh0aGlzLmRyYWdEYXRhLnN0ZXBJbmRleCk7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQudmFsKG5ld1ZhbHVlKS50cmlnZ2VyKCdjaGFuZ2UnKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5wYWdlLm9mZih7XG5cdFx0XHRcdCdqY2YtcG9pbnRlcm1vdmUnOiB0aGlzLm9uSGFuZGxlTW92ZSxcblx0XHRcdFx0J2pjZi1wb2ludGVydXAnOiB0aGlzLm9uSGFuZGxlUmVsZWFzZVxuXHRcdFx0fSk7XG5cdFx0XHRkZWxldGUgdGhpcy5hY3RpdmVEcmFnSGFuZGxlO1xuXHRcdFx0ZGVsZXRlIHRoaXMuZHJhZ0RhdGE7XG5cdFx0fSxcblx0XHRvbkZvY3VzOiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICghdGhpcy5mYWtlRWxlbWVudC5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuZm9jdXNDbGFzcykpIHtcblx0XHRcdFx0dGhpcy5mYWtlRWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuZm9jdXNDbGFzcyk7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQub24oe1xuXHRcdFx0XHRcdGJsdXI6IHRoaXMub25CbHVyLFxuXHRcdFx0XHRcdGtleWRvd246IHRoaXMub25LZXlQcmVzc1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG9uQmx1cjogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmZha2VFbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5mb2N1c0NsYXNzKTtcblx0XHRcdHRoaXMucmVhbEVsZW1lbnQub2ZmKHtcblx0XHRcdFx0Ymx1cjogdGhpcy5vbkJsdXIsXG5cdFx0XHRcdGtleWRvd246IHRoaXMub25LZXlQcmVzc1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRvbktleVByZXNzOiBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIgaW5jVmFsdWUgPSAoZS53aGljaCA9PT0gMzggfHwgZS53aGljaCA9PT0gMzkpLFxuXHRcdFx0XHRkZWNWYWx1ZSA9IChlLndoaWNoID09PSAzNyB8fCBlLndoaWNoID09PSA0MCk7XG5cblx0XHRcdC8vIGhhbmRsZSBUQUIga2V5IGluIHNsaWRlciB3aXRoIG11bHRpcGxlIGhhbmRsZXNcblx0XHRcdGlmIChlLndoaWNoID09PSA5ICYmIHRoaXMuaGFuZGxlQ291bnQgPiAxKSB7XG5cdFx0XHRcdGlmIChlLnNoaWZ0S2V5ICYmIHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4ID4gMCkge1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4LS07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIWUuc2hpZnRLZXkgJiYgdGhpcy5hY3RpdmVEcmFnSGFuZGxlSW5kZXggPCB0aGlzLmhhbmRsZUNvdW50IC0gMSkge1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4Kys7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5oYW5kbGVzLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVIYW5kbGVDbGFzcykuZXEodGhpcy5hY3RpdmVEcmFnSGFuZGxlSW5kZXgpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVIYW5kbGVDbGFzcyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGhhbmRsZSBjdXJzb3Iga2V5c1xuXHRcdFx0aWYgKGRlY1ZhbHVlIHx8IGluY1ZhbHVlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5zdGVwKGluY1ZhbHVlID8gdGhpcy5zdGVwVmFsdWUgOiAtdGhpcy5zdGVwVmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dXBkYXRlVmFsdWVzOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB2YWx1ZSA9IHRoaXMudmFsdWVzLmpvaW4oJywnKTtcblx0XHRcdGlmICh0aGlzLnZhbHVlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQucHJvcCgndmFsdWVMb3cnLCB0aGlzLnZhbHVlc1swXSk7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQucHJvcCgndmFsdWVIaWdoJywgdGhpcy52YWx1ZXNbdGhpcy52YWx1ZXMubGVuZ3RoIC0gMV0pO1xuXHRcdFx0XHR0aGlzLnJlYWxFbGVtZW50LnZhbCh2YWx1ZSk7XG5cblx0XHRcdFx0Ly8gaWYgYnJvd3NlciBkb2VzIG5vdCBhY2NlcHQgbXVsdGlwbGUgdmFsdWVzIHNldCBvbmx5IG9uZVxuXHRcdFx0XHRpZiAodGhpcy5yZWFsRWxlbWVudC52YWwoKSAhPT0gdmFsdWUpIHtcblx0XHRcdFx0XHR0aGlzLnJlYWxFbGVtZW50LnZhbCh0aGlzLnZhbHVlc1t0aGlzLnZhbHVlcy5sZW5ndGggLSAxXSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMucmVhbEVsZW1lbnQudmFsKHZhbHVlKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy51cGRhdGVSYW5nZXMoKTtcblx0XHR9LFxuXHRcdHVwZGF0ZVJhbmdlczogZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyB1cGRhdGUgZGlzcGxheSByYW5nZXNcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0aGFuZGxlO1xuXG5cdFx0XHRpZiAodGhpcy5yYW5nZU1pbikge1xuXHRcdFx0XHRoYW5kbGUgPSB0aGlzLmhhbmRsZXNbMF07XG5cdFx0XHRcdHRoaXMucmFuZ2VNaW4uY3NzKHRoaXMub2Zmc2V0UHJvcGVydHksIDApLmNzcyh0aGlzLnNpemVQcm9wZXJ0eSwgaGFuZGxlLnN0eWxlW3RoaXMub2Zmc2V0UHJvcGVydHldKTtcblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLnJhbmdlTWF4KSB7XG5cdFx0XHRcdGhhbmRsZSA9IHRoaXMuaGFuZGxlc1t0aGlzLmhhbmRsZXMubGVuZ3RoIC0gMV07XG5cdFx0XHRcdHRoaXMucmFuZ2VNYXguY3NzKHRoaXMub2Zmc2V0UHJvcGVydHksIGhhbmRsZS5zdHlsZVt0aGlzLm9mZnNldFByb3BlcnR5XSkuY3NzKHRoaXMuc2l6ZVByb3BlcnR5LCAxMDAgLSBwYXJzZUZsb2F0KGhhbmRsZS5zdHlsZVt0aGlzLm9mZnNldFByb3BlcnR5XSkgKyAnJScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMucmFuZ2VNaWQpIHtcblx0XHRcdFx0dGhpcy5oYW5kbGVzLmVhY2goZnVuY3Rpb24oaW5kZXgsIGN1ckhhbmRsZSkge1xuXHRcdFx0XHRcdHZhciBwcmV2SGFuZGxlLCBtaWRCb3g7XG5cdFx0XHRcdFx0aWYgKGluZGV4ID4gMCkge1xuXHRcdFx0XHRcdFx0cHJldkhhbmRsZSA9IHNlbGYuaGFuZGxlc1tpbmRleCAtIDFdO1xuXHRcdFx0XHRcdFx0bWlkQm94ID0gc2VsZi5yYW5nZU1pZFtpbmRleCAtIDFdO1xuXHRcdFx0XHRcdFx0bWlkQm94LnN0eWxlW3NlbGYub2Zmc2V0UHJvcGVydHldID0gcHJldkhhbmRsZS5zdHlsZVtzZWxmLm9mZnNldFByb3BlcnR5XTtcblx0XHRcdFx0XHRcdG1pZEJveC5zdHlsZVtzZWxmLnNpemVQcm9wZXJ0eV0gPSBwYXJzZUZsb2F0KGN1ckhhbmRsZS5zdHlsZVtzZWxmLm9mZnNldFByb3BlcnR5XSkgLSBwYXJzZUZsb2F0KHByZXZIYW5kbGUuc3R5bGVbc2VsZi5vZmZzZXRQcm9wZXJ0eV0pICsgJyUnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzdGVwOiBmdW5jdGlvbihjaGFuZ2VWYWx1ZSkge1xuXHRcdFx0dmFyIG9yaWdpbmFsVmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMudmFsdWVzW3RoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4IHx8IDBdKSxcblx0XHRcdFx0bmV3VmFsdWUgPSBvcmlnaW5hbFZhbHVlLFxuXHRcdFx0XHRtaW5WYWx1ZSA9IHRoaXMubWluVmFsdWUsXG5cdFx0XHRcdG1heFZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcblxuXHRcdFx0aWYgKGlzTmFOKG9yaWdpbmFsVmFsdWUpKSB7XG5cdFx0XHRcdG5ld1ZhbHVlID0gMDtcblx0XHRcdH1cblxuXHRcdFx0bmV3VmFsdWUgKz0gY2hhbmdlVmFsdWU7XG5cblx0XHRcdGlmICh0aGlzLmhhbmRsZUNvdW50ID4gMSkge1xuXHRcdFx0XHRpZiAodGhpcy5hY3RpdmVEcmFnSGFuZGxlSW5kZXggPiAwKSB7XG5cdFx0XHRcdFx0bWluVmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMudmFsdWVzW3RoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4IC0gMV0pICsgdGhpcy5vcHRpb25zLm1pblJhbmdlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLmFjdGl2ZURyYWdIYW5kbGVJbmRleCA8IHRoaXMuaGFuZGxlQ291bnQgLSAxKSB7XG5cdFx0XHRcdFx0bWF4VmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMudmFsdWVzW3RoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4ICsgMV0pIC0gdGhpcy5vcHRpb25zLm1pblJhbmdlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChuZXdWYWx1ZSA+IG1heFZhbHVlKSB7XG5cdFx0XHRcdG5ld1ZhbHVlID0gbWF4VmFsdWU7XG5cdFx0XHR9IGVsc2UgaWYgKG5ld1ZhbHVlIDwgbWluVmFsdWUpIHtcblx0XHRcdFx0bmV3VmFsdWUgPSBtaW5WYWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG5ld1ZhbHVlICE9PSBvcmlnaW5hbFZhbHVlKSB7XG5cdFx0XHRcdHRoaXMudmFsdWVzW3RoaXMuYWN0aXZlRHJhZ0hhbmRsZUluZGV4IHx8IDBdID0gJycgKyBuZXdWYWx1ZTtcblx0XHRcdFx0dGhpcy51cGRhdGVWYWx1ZXMoKTtcblx0XHRcdFx0dGhpcy5yZWFsRWxlbWVudC50cmlnZ2VyKCdpbnB1dCcpLnRyaWdnZXIoJ2NoYW5nZScpO1xuXHRcdFx0XHR0aGlzLnNldFNsaWRlclZhbHVlKHRoaXMudmFsdWVzKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHZhbHVlVG9TdGVwSW5kZXg6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRyZXR1cm4gKHZhbHVlIC0gdGhpcy5taW5WYWx1ZSkgLyB0aGlzLnN0ZXBWYWx1ZTtcblx0XHR9LFxuXHRcdHN0ZXBJbmRleFRvVmFsdWU6IGZ1bmN0aW9uKHN0ZXBJbmRleCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubWluVmFsdWUgKyB0aGlzLnN0ZXBWYWx1ZSAqIHN0ZXBJbmRleDtcblx0XHR9LFxuXHRcdHZhbHVlVG9PZmZzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHR2YXIgcmFuZ2UgPSB0aGlzLm1heFZhbHVlIC0gdGhpcy5taW5WYWx1ZSxcblx0XHRcdFx0cGVyY2VudCA9ICh2YWx1ZSAtIHRoaXMubWluVmFsdWUpIC8gcmFuZ2U7XG5cblx0XHRcdHJldHVybiBwZXJjZW50ICogMTAwO1xuXHRcdH0sXG5cdFx0Z2V0U2xpZGVyVmFsdWU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuICQubWFwKHRoaXMudmFsdWVzLCBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgfHwgMDtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0c2V0U2xpZGVyVmFsdWU6IGZ1bmN0aW9uKHZhbHVlcykge1xuXHRcdFx0Ly8gc2V0IGhhbmRsZSBwb3NpdGlvbiBhY2NvcmRpb24gYWNjb3JkaW5nIHRvIHZhbHVlXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHR0aGlzLmhhbmRsZXMuZWFjaChmdW5jdGlvbihpbmRleCwgaGFuZGxlKSB7XG5cdFx0XHRcdGhhbmRsZS5zdHlsZVtzZWxmLm9mZnNldFByb3BlcnR5XSA9IHNlbGYudmFsdWVUb09mZnNldCh2YWx1ZXNbaW5kZXhdKSArICclJztcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0cmVmcmVzaDogZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBoYW5kbGUgZGlzYWJsZWQgc3RhdGVcblx0XHRcdHZhciBpc0Rpc2FibGVkID0gdGhpcy5yZWFsRWxlbWVudC5pcygnOmRpc2FibGVkJyk7XG5cdFx0XHR0aGlzLmZha2VFbGVtZW50LnRvZ2dsZUNsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzLCBpc0Rpc2FibGVkKTtcblxuXHRcdFx0Ly8gcmVmcmVzaCBoYW5kbGUgcG9zaXRpb24gYWNjb3JkaW5nIHRvIGN1cnJlbnQgdmFsdWVcblx0XHRcdHRoaXMuc2V0U2xpZGVyVmFsdWUodGhpcy5nZXRTbGlkZXJWYWx1ZSgpKTtcblx0XHRcdHRoaXMudXBkYXRlUmFuZ2VzKCk7XG5cdFx0fSxcblx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMucmVhbEVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmhpZGRlbkNsYXNzKS5pbnNlcnRCZWZvcmUodGhpcy5mYWtlRWxlbWVudCk7XG5cdFx0XHR0aGlzLmZha2VFbGVtZW50LnJlbW92ZSgpO1xuXG5cdFx0XHR0aGlzLnJlYWxFbGVtZW50Lm9mZih7XG5cdFx0XHRcdGtleWRvd246IHRoaXMub25LZXlQcmVzcyxcblx0XHRcdFx0Zm9jdXM6IHRoaXMub25Gb2N1cyxcblx0XHRcdFx0Ymx1cjogdGhpcy5vbkJsdXJcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcbn0pO1xuXG59KGpjZikpO1xuIiwiaW1wb3J0ICcuL21lbnUtYWNjZXNzYWJpbGl0eS5qcyc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLy9kb2N1bWVudC5hY3RpdmVFbGVtZW50XG5cbiAgICB2YXIgJGJvZHkgPSAkKCdib2R5JyksXG4gICAgICAgICR3aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgIHRhYktleSA9IDksXG4gICAgICAgIHNoaWZ0ID0gMTYsXG4gICAgICAgIGVzY0tleSA9IDI3LFxuICAgICAgICBuZXN0ZWRNZW51O1xuXG5cbiAgICB2YXIgbWVudSA9IHtcbiAgICAgICAgJHRvZ2dsZTogJCgnW2RhdGEtdG9nZ2xlPVwibmF2XCJdJyksXG4gICAgICAgICR0YXJnZXQ6IG51bGwsXG4gICAgICAgIHJldmVyczogZmFsc2UsXG4gICAgICAgIGxhc3RJdGVtOiBudWxsLFxuICAgICAgICBpdGVtczogbnVsbCxcbiAgICAgICAgdlBvcnQ6IFtcInNjcmVlbi1zbVwiXSxcbiAgICAgICAgaXNNb2JpbGU6IGZhbHNlLCAvLyB2YXJpYWJsZSB1c2UgdG8gZGV0ZXJtaW5lIGlmIHJlc3BvbnNpdmUgbW9kZSBpcyBvbiBvciBvZmZcbiAgICAgICAgbWVudUhlYWRlck1haW5UaXRsZTogJycsXG4gICAgICAgIHJlZGlyZWN0UGF0aDogZmFsc2UsXG4gICAgICAgIGRpc3BsYXllZE5lc3RlZEl0ZW1zOiBmYWxzZSxcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG1lbnUxID0gbmV3IG1lbnViYXIoJ21lbnViYXInLCBmYWxzZSk7XG4gICAgICAgICAgICAkKCcubWFpbi1uYXYnKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgbWVudS4kdGFyZ2V0ID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBjb25zdCAkaGVhZGVyID0gbWVudS4kdGFyZ2V0LmZpbmQoJy5tZW51LWhlYWRlcicpO1xuICAgICAgICAgICAgICAgIG1lbnUubWVudUhlYWRlck1haW5UaXRsZSA9ICRoZWFkZXIudGV4dCgpO1xuICAgICAgICAgICAgICAgIG1lbnUucmVkaXJlY3RQYXRoID0gJGhlYWRlci5kYXRhKCdyZWRpcmVjdC10bycpO1xuICAgICAgICAgICAgICAgIG1lbnUuY2hlY2sudmlld1BvcnQoaW5kZXgpO1xuICAgICAgICAgICAgICAgIG1lbnUucmVzcG9uc2l2ZShpbmRleCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1lbnUuaXRlbXMgPSAkKCcubWFpbi1uYXYnKS5maW5kKCdhLCBidXR0b24sIGlucHV0Jyk7ICAvLyQoXCIuaGVhZGVyX19uYXYgYSwgLmhlYWRlcl9fbmF2IGJ1dHRvbiwgLmhlYWRlcl9fbmF2IGlucHV0XCIpO1xuICAgICAgICAgICAgbWVudS5jb250cm9sKCk7XG4gICAgICAgICAgICBtZW51LmFkZGl0aW9uYWxDb250cm9sKCk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICByZXNwb25zaXZlOiBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKG1lbnUudlBvcnRbaW5kZXhdICsgJy1vbicsIGZ1bmN0aW9uICgpIHsgLy8gV2FpdGluZyBmb3IgY3VzdG9tIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgYnkgY29udHJvbGxlci5qcyB0byBhY3RpdmF0ZSByZXNwb25zaXZlIGVmZmVjdHNcbiAgICAgICAgICAgICAgICBtZW51LmlzTW9iaWxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcubWFpbi1uYXYnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5maW5kKCcuZHJhd2VyX19uYXYnKS5kYXRhKCdjdHJsLXJlcycpID09ICBtZW51LnZQb3J0W2luZGV4XSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwibWVudS0tcmVzXCIpOyAvLyBjbGFzcyB3aWxsIGJlIHVzZWQgaW4gb3VyIHNjc3MgKHRvIHJlcGxhY2UgbWVkaWEgcXVlcmllcylcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tYWluLW5hdl9fdG9nZ2xlX19jb250cm9sbGVyJykuYWRkQ2xhc3MoXCJtYWluLW5hdl9fdG9nZ2xlX19jb250cm9sbGVyX19yZXNcIik7IC8vIGNsYXNzIHdpbGwgYmUgdXNlZCBpbiBvdXIgc2NzcyAodG8gcmVwbGFjZSBtZWRpYSBxdWVyaWVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5vbi5yZWJ1aWxkLnJlc3BvbnNpdmUoKTsgLy8gcmVidWlsZCBtZW51IHRvIGJlIHJlc3BvbnNpdmUgLSBkcmF3ZXJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKG1lbnUudlBvcnRbaW5kZXhdICsgJy1vZmYnLCBmdW5jdGlvbiAoKSB7IC8vIFdhaXRpbmcgZm9yIGN1c3RvbSBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIGJ5IGNvbnRyb2xsZXIuanMgdG8gZGVhY3RpdmF0ZSByZXNwb25zaXZlIGVmZmVjdHNcbiAgICAgICAgICAgICAgICBtZW51LmlzTW9iaWxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJCgnLm1haW4tbmF2JykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuZmluZCgnLmRyYXdlcl9fbmF2JykuZGF0YSgnY3RybC1yZXMnKSA9PSAgbWVudS52UG9ydFtpbmRleF0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcIm1lbnUtLXJlc1wiKTsgLy8gY2xhc3Mgd2lsbCBiZSB1c2VkIGluIG91ciBzY3NzICh0byByZXBsYWNlIG1lZGlhIHF1ZXJpZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcubWFpbi1uYXZfX3RvZ2dsZV9fY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKFwibWFpbi1uYXZfX3RvZ2dsZV9fY29udHJvbGxlcl9fcmVzXCIpOyAvLyBjbGFzcyB3aWxsIGJlIHVzZWQgaW4gb3VyIHNjc3MgKHRvIHJlcGxhY2UgbWVkaWEgcXVlcmllcylcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUub24ucmVidWlsZC5vcmlnaW5hbCgpOyAvLyByZXR1cm4gbWVudSBhcyBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNvbnRyb2w6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgJ1tkYXRhLXRvZ2dsZT1cIm5hdlwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIG1lbnUuJHRvZ2dsZSA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgbWVudS4kdGFyZ2V0ID0gJCgnIycgKyBtZW51LiR0b2dnbGUuZGF0YSgndGFyZ2V0JykpO1xuXG4gICAgICAgICAgICAgICAgbWVudS5pdGVtcyA9IG1lbnUuJHRhcmdldC5maW5kKCdhLCBidXR0b24sIGlucHV0Jyk7ICAvLyQoXCIuaGVhZGVyX19uYXYgYSwgLmhlYWRlcl9fbmF2IGJ1dHRvbiwgLmhlYWRlcl9fbmF2IGlucHV0XCIpO1xuICAgICAgICAgICAgICAgIG1lbnUuaXRlbXMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSBtZW51Lml0ZW1zLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUubGFzdEl0ZW0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIG1lbnUub24uc2hvdyhlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnLmpzLS1vcGVuW2RhdGEtdG9nZ2xlPVwibmF2XCJdJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgbWVudS5vbi5oaWRlKGUpO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgJGJvZHkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoISggJChlLnRhcmdldCkuY2xvc2VzdCgnLmRyb3Bkb3duX190b2dnbGUnKS5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICQoXCJhLmRyb3Bkb3duX190b2dnbGUuaG92ZXJcIikucmVtb3ZlQ2xhc3MoXCJob3ZlclwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImljb24tYXJyb3dfclwiKSAmJiAhJChlLnRhcmdldCkucGFyZW50cyhcIi5tYWluLW5hdl9fdG9nZ2xlX19jb250cm9sbGVyXCIpICYmICEkKGUudGFyZ2V0KS5wYXJlbnRzKCcubWFpbi1uYXYubWVudS0tcmVzJykubGVuZ3RoICYmICQoJy5sb2NrLXNjcmVlbltkYXRhLWFjdGl2ZT1cIm1lbnVcIl0nKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5vbi5oaWRlKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnLm1haW4tbmF2IGEnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmKCQodGhpcykuYXR0cignaHJlZicpPT1cIiNcIikge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRib2R5Lm9uKCdjbGljaycsICdbZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIG5lc3RlZE1lbnUgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIG1lbnUub24ubmVzdGVkKGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkYm9keS5vbignY2xpY2snLCAnLm1lbnUtaGVhZGVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVudS5pc01vYmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBtZW51Lm9uLmhpZGVOZXN0ZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOyAgLy8gcHJldmVudCBjbG9zaW5nIG1lbnUgd2hlbiBnZXR0aW5nIGJhY2sgZnJvbSBuZXN0ZWQgbWVudVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkYm9keS5vbigna2V5ZG93bicsICcuZHJhd2VyX19uYXYsIFtkYXRhLXRvZ2dsZT1cIm5hdlwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1lbnUuaXNNb2JpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoKGUua2V5Q29kZSB8fCBlLndoaWNoKSA9PT0gdGFiS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbnUucmV2ZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5vbi50YWIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5vbi50YWJSZXZlcnMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgJHdpbmRvdy5vbigna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIG1lbnUucmV2ZXJzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkgJiYgZS5rZXlDb2RlID09PSB0YWJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5yZXZlcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIW1lbnUuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChlLmtleUNvZGUgfHwgZS53aGljaCkgPT09IHRhYktleSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbnUucmV2ZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5vbi50YWJEZXNrdG9wKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51Lm9uLnRhYlJldmVyc0Rlc2t0b3AoZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoZS5rZXlDb2RlIHx8IGUud2hpY2gpID09PSBlc2NLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUub24uZXNjRGVza3RvcChlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgYWRkaXRpb25hbENvbnRyb2wgOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgfSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mKFVYLmNvbnRyb2xsZXIpICE9IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgVVguY29udHJvbGxlci5jaGVjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkYm9keS5hZGRDbGFzcygnbG9jay1zY3JlZW4nKS5hdHRyKCdkYXRhLWFjdGl2ZScsICdtZW51Jyk7XG4gICAgICAgICAgICAgICAgbWVudS4kdG9nZ2xlLmFkZENsYXNzKCdqcy0tb3BlbicpO1xuXG4gICAgICAgICAgICAgICAgbWVudS4kdGFyZ2V0LmNsb3Nlc3QoJy5tYWluLW5hdicpLmNzcygndG9wJywgJHdpbmRvdy5zY3JvbGxUb3AoKSk7XG4gICAgICAgICAgICAgICAgJCgnLmNvb2xCYXItLXJlcycpLnJlbW92ZUNsYXNzKCd0cmFucycpLmNzcygndG9wJywgJHdpbmRvdy5zY3JvbGxUb3AoKSArICQoJ2hlYWRlcicpLmhlaWdodCgpKTtcbiAgICAgICAgICAgICAgICAkKCcubG9pX19iYW5uZXIubG9pLS1yZXMnKS5jc3MoJ3RvcCcsICR3aW5kb3cuc2Nyb2xsVG9wKCkgKyAkKCdoZWFkZXInKS5oZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgbWVudS4kdGFyZ2V0LmF0dHIoXCJzdHlsZVwiLCBcImRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnRcIik7XG4gICAgICAgICAgICAgICAgbWVudS4kdG9nZ2xlLmZvY3VzKCk7XG5cbiAgICAgICAgICAgICAgICBtZW51Lm9uLnNob3dBZGRpdGlvbmFsKCk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzaG93QWRkaXRpb25hbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2hvd05lc3RlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG5lc3RlZE1lbnUubmV4dCgnLmRyb3Bkb3duX19tZW51JykudG9nZ2xlQ2xhc3MoJ3N1Yi1tZW51X19vcGVuZWQnKTtcbiAgICAgICAgICAgICAgICBuZXN0ZWRNZW51LnBhcmVudCgpLnRvZ2dsZUNsYXNzKCdtZW51LXBhcmVudF9fb3BlbmVkJyk7XG4gICAgICAgICAgICAgICAgbmVzdGVkTWVudS5maW5kKCdpJykudG9nZ2xlQ2xhc3MoJ29wcG9zaXRlLWFycm93Jyk7XG4gICAgICAgICAgICAgICAgbmVzdGVkTWVudS5wYXJlbnQoKS5zaWJsaW5ncygnbGknKS50b2dnbGVDbGFzcygncHJldi1pdGVtcycpO1xuICAgICAgICAgICAgICAgIG5lc3RlZE1lbnUudG9nZ2xlQ2xhc3MoJ3ByZXYtaXRlbXMnKTtcbiAgICAgICAgICAgICAgICAkKFwiW2RhdGEtdG9nZ2xlPSduYXYnXVwiKS5hZGRDbGFzcyhcImpzLS1uZXN0ZWQtb3BlblwiKTsgLy8gcmVwbGFjZSBDbG9zZSBidXR0b24gd2l0aCBiYWNrIGJ1dHRvbiBhZnRlciBuZXN0ZWQgbWVudSBnZXQgb3BlbmVkXG4gICAgICAgICAgICAgICAgdmFyICRtZW51VGl0bGUgPSBuZXN0ZWRNZW51Lmh0bWwoKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcubWVudS1oZWFkZXInKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnLm1lbnUtaGVhZGVyJykuaHRtbCgkbWVudVRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWVudS5kaXNwbGF5ZWROZXN0ZWRJdGVtcyA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBtZW51Lm9uLnNob3dOZXN0ZWRFeHRyYSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3dOZXN0ZWRFeHRyYTogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlTmVzdGVkOiBmdW5jdGlvbiAoc2hvdWxkTmF2aWdhdGUgPSBmYWxzZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyICRtZW51SGVhZGVyID0gJCgnLm1lbnUtaGVhZGVyJyk7XG4gICAgICAgICAgICAgICAgdmFyICRwYXJlbk5lc3RlZE1lbnU7XG5cblxuICAgICAgICAgICAgICAgIGlmKCB0eXBlb2YobmVzdGVkTWVudSkgIT0gJ3VuZGVmaW5lZCcgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJHBhcmVuTmVzdGVkTWVudSA9IG5lc3RlZE1lbnUucGFyZW50KCkucGFyZW50KCk7IC8vIGZpcnN0IHBhcmVudCBsaXN0XG4gICAgICAgICAgICAgICAgICAgIG5lc3RlZE1lbnUgPSAkcGFyZW5OZXN0ZWRNZW51LnBhcmVudCgpLmZpbmQoJy5kcm9wZG93bl9fdG9nZ2xlJyk7IC8vIGZpcnN0IHBhcmVudCBkcm9wZG93biB0b2dnbGUgbGlua1xuXG4gICAgICAgICAgICAgICAgICAgICRwYXJlbk5lc3RlZE1lbnUuZmluZCgnLnN1Yi1tZW51X19vcGVuZWQnKS5yZW1vdmVDbGFzcygnc3ViLW1lbnVfX29wZW5lZCcpO1xuICAgICAgICAgICAgICAgICAgICAkcGFyZW5OZXN0ZWRNZW51LmZpbmQoJy5tZW51LXBhcmVudF9fb3BlbmVkJykucmVtb3ZlQ2xhc3MoJ21lbnUtcGFyZW50X19vcGVuZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgJHBhcmVuTmVzdGVkTWVudS5maW5kKCcucHJldi1pdGVtcycpLnJlbW92ZUNsYXNzKCdwcmV2LWl0ZW1zJyk7XG5cdCAgICAgICAgICAgICAgICAkKFwiW2RhdGEtdG9nZ2xlPSduYXYnXVwiKS5yZW1vdmVDbGFzcyhcImpzLS1uZXN0ZWQtb3BlblwiKTtcblxuXHQgICAgICAgICAgICAgICAgaWYoJHBhcmVuTmVzdGVkTWVudS5oYXNDbGFzcygnc3ViLW1lbnVfX29wZW5lZCcpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZW51SGVhZGVyLmZpbmQoJ3NwYW4nKS5odG1sKG5lc3RlZE1lbnUuZmluZCgnc3BhbicpLmh0bWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVudS5yZWRpcmVjdFBhdGggJiYgc2hvdWxkTmF2aWdhdGUgJiYgIW1lbnUuZGlzcGxheWVkTmVzdGVkSXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbiA9IG1lbnUucmVkaXJlY3RQYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWVudUhlYWRlci5odG1sKG1lbnUubWVudUhlYWRlck1haW5UaXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5kaXNwbGF5ZWROZXN0ZWRJdGVtcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXN0ZWRNZW51ID0gJG1lbnVIZWFkZXI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVudS5vbi5oaWRlTmVzdGVkRXh0cmEoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlTmVzdGVkRXh0cmE6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBpZiAobWVudS5pc01vYmlsZSkgeyAvLyBoaWRlIG5lc3RlZCBtZW51IGJlZm9yZSBjbG9zaW5nXG5cdFx0ICAgICAgICAgICAgbWVudS5vbi5oaWRlTmVzdGVkKCk7XG5cdCAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZW51LiR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2pzLS1vcGVuJyk7XG4gICAgICAgICAgICAgICAgJCgnLm1haW4tbmF2LCBoZWFkZXInKS5jc3MoJ3RvcCcsIDApO1xuICAgICAgICAgICAgICAgICQoJy5jb29sQmFyLS1yZXMnKS5hZGRDbGFzcygndHJhbnMnKS5jc3MoJ3RvcCcsICQoJ2hlYWRlcicpLmhlaWdodCgpKTsgLy8gVGhlIG1hZ2ljIG51bWJlciBjb250YWlucyAxcHggb2YgYm9yZGVyIGFuZFxuICAgICAgICAgICAgICAgICQoJy5sb2lfX2Jhbm5lci5sb2ktLXJlcycpLmNzcygndG9wJywgJCgnaGVhZGVyJykuaGVpZ2h0KCkpO1xuICAgICAgICAgICAgICAgICRib2R5LnJlbW92ZUF0dHIoJ2RhdGEtYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2xvY2stc2NyZWVuJyk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlc2NhcGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtZW51Lm9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBtZW51LiR0b2dnbGUuZm9jdXMoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0YWI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtZW51LiR0b2dnbGUub2ZmKCk7XG4gICAgICAgICAgICAgICAgbWVudS5sYXN0SXRlbS5vZmYoKS5vbignZm9jdXNvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUuJHRvZ2dsZS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGFiUmV2ZXJzOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBtZW51Lmxhc3RJdGVtLm9mZigpO1xuICAgICAgICAgICAgICAgIG1lbnUuJHRvZ2dsZS5vZmYoKS5vbignZm9jdXNvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUubGFzdEl0ZW0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRhYkRlc2t0b3A6IGZ1bmN0aW9uKGUpe1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoZS50YXJnZXQpLmhhc0NsYXNzKFwiZHJvcGRvd25fX3RvZ2dsZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJChlLnRhcmdldCkuY2xvc2VzdChcIi5ob3ZlclwiKS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmRyb3Bkb3duX190b2dnbGUnKS5yZW1vdmVDbGFzcygnaG92ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5kcm9wZG93bicpLnJlbW92ZUNsYXNzKCdqcy0tb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLmNsb3Nlc3QoXCJhXCIpLmFkZENsYXNzKFwiaG92ZXJcIik7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS5jbG9zZXN0KFwidWxcIikuZmluZCgnLmhvdmVyJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdob3ZlcicpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGFiUmV2ZXJzRGVza3RvcDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoJChlLnRhcmdldCkuaGFzQ2xhc3MoXCJkcm9wZG93bl9fdG9nZ2xlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5jbG9zZXN0KFwiLmhvdmVyXCIpLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuZHJvcGRvd25fX3RvZ2dsZScpLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLmNsb3Nlc3QoXCJhXCIpLmFkZENsYXNzKFwiaG92ZXJcIik7XG4gICAgICAgICAgICAgICAgfWVsc2UgaWYgICgkKGUudGFyZ2V0KS5jbG9zZXN0KFwiLmh1YnBhZ2UtbWVudVwiKS5sZW5ndGggPT0gMCAmJiAkKGUudGFyZ2V0KS5jbG9zZXN0KFwiLm1haW4tbmF2XCIpLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5kcm9wZG93bl9fdG9nZ2xlJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXNjRGVza3RvcDogZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgJChlLnRhcmdldCkuY2xvc2VzdChcIi5kcm9wZG93bl9fdG9nZ2xlXCIpLnJlbW92ZUNsYXNzKFwiaG92ZXJcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVidWlsZDoge1xuXG4gICAgICAgICAgICAgICAgcmVzcG9uc2l2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBtZW51Lm9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUub24uaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBtZW51LiR0YXJnZXQuc2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBuZXN0ZWQ6IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmIChtZW51LmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUub24uc2hvd05lc3RlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY2hlY2s6IHtcbiAgICAgICAgICAgIHZpZXdQb3J0OiBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAobWVudS4kdGFyZ2V0LmZpbmQoJy5kcmF3ZXJfX25hdicpLmF0dHIoJ2RhdGEtY3RybC1yZXMnKSkge1xuICAgICAgICAgICAgICAgICAgICBtZW51LnZQb3J0W2luZGV4XSA9IG1lbnUuJHRhcmdldC5maW5kKCcuZHJhd2VyX19uYXYnKS5hdHRyKCdkYXRhLWN0cmwtcmVzJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVYLm1lbnUgPSBtZW51OyAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxufSkoKTtcbiIsImZ1bmN0aW9uIG1lbnViYXIoZSwgdCkge1xuICAgIHRoaXMuJGlkID0gJChcIiNcIiArIGUpLFxuICAgICAgICB0aGlzLiRyb290SXRlbXMgPSB0aGlzLiRpZC5jaGlsZHJlbihcImxpXCIpLFxuICAgICAgICB0aGlzLiRpdGVtcyA9IHRoaXMuJGlkLmZpbmQoXCIubWVudS1pdGVtXCIpLFxuICAgICAgICB0aGlzLiRwYXJlbnRzID0gdGhpcy4kaWQuZmluZChcIi5tZW51LXBhcmVudFwiKSxcbiAgICAgICAgdGhpcy4kYWxsSXRlbXMgPSB0aGlzLiRwYXJlbnRzLmFkZCh0aGlzLiRpdGVtcyksXG4gICAgICAgIHRoaXMuJGFjdGl2ZUl0ZW0gPSBudWxsLFxuICAgICAgICB0aGlzLnZtZW51ID0gdCxcbiAgICAgICAgdGhpcy5iQ2hpbGRPcGVuID0gITEsXG4gICAgICAgIHRoaXMua2V5cyA9IHtcbiAgICAgICAgICAgIHRhYjogOSxcbiAgICAgICAgICAgIGVudGVyOiAxMyxcbiAgICAgICAgICAgIGVzYzogMjcsXG4gICAgICAgICAgICBzcGFjZTogMzIsXG4gICAgICAgICAgICBsZWZ0OiAzNyxcbiAgICAgICAgICAgIHVwOiAzOCxcbiAgICAgICAgICAgIHJpZ2h0OiAzOSxcbiAgICAgICAgICAgIGRvd246IDQwXG4gICAgICAgIH0sXG4gICAgICAgIHRoaXMuYmluZEhhbmRsZXJzKClcbn1cbm1lbnViYXIucHJvdG90eXBlLmJpbmRIYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBlID0gdGhpcztcblxuICAgIHRoaXMuJGFsbEl0ZW1zLmtleWRvd24oZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gZS5oYW5kbGVLZXlEb3duKCQodGhpcyksIHQpXG4gICAgfSksXG4gICAgdGhpcy4kYWxsSXRlbXMua2V5cHJlc3MoZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gZS5oYW5kbGVLZXlQcmVzcygkKHRoaXMpLCB0KVxuICAgIH0pLFxuICAgIHRoaXMuJGFsbEl0ZW1zLmZvY3VzKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIGUuaGFuZGxlRm9jdXMoJCh0aGlzKSwgdClcbiAgICB9KSxcblxuICAgICQoZG9jdW1lbnQpLmNsaWNrKCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBlLmhhbmRsZURvY3VtZW50Q2xpY2sodClcbiAgICB9KVxufTtcblxubWVudWJhci5wcm90b3R5cGUuaGFuZGxlRm9jdXMgPSBmdW5jdGlvbihlLCB0KSB7XG4gICAgaWYgKG51bGwgPT0gdGhpcy4kYWN0aXZlSXRlbSlcbiAgICAgICAgdGhpcy4kYWN0aXZlSXRlbSA9IGU7XG4gICAgZWxzZSBpZiAoZVswXSAhPSB0aGlzLiRhY3RpdmVJdGVtWzBdKVxuICAgICAgICByZXR1cm4gITA7XG4gICAgdmFyIGkgPSB0aGlzLiRhY3RpdmVJdGVtLnBhcmVudHNVbnRpbChcImRpdlwiKS5maWx0ZXIoXCJsaVwiKTtcbiAgICBpZiAodGhpcy4kYWxsSXRlbXMucmVtb3ZlQ2xhc3MoXCJtZW51LWZvY3VzIG1lbnUtZm9jdXMtY2hlY2tlZFwiKSxcbiAgICAgICAgICAgIHRoaXMuJGFjdGl2ZUl0ZW0uaXMoXCIuY2hlY2tlZFwiKSA/IHRoaXMuJGFjdGl2ZUl0ZW0uYWRkQ2xhc3MoXCJtZW51LWZvY3VzLWNoZWNrZWRcIikgOiB0aGlzLiRhY3RpdmVJdGVtLmFkZENsYXNzKFwibWVudS1mb2N1c1wiKSxcbiAgICAgICAgICAgIGkuYWRkQ2xhc3MoXCJtZW51LWZvY3VzXCIpLFxuICAgICAgICAxID09IHRoaXMudm1lbnUpXG4gICAgICAgIGlmICgxID09IHRoaXMuYkNoaWxkT3Blbikge1xuICAgICAgICAgICAgdmFyIHMgPSBlLnBhcmVudCgpO1xuICAgICAgICAgICAgcy5pcyhcIiNtZW51YmFyXCIpICYmIFwidHJ1ZVwiID09IGUuYXR0cihcImFyaWEtaGFzcG9wdXBcIikgJiYgZS5hZGRDbGFzcygnaG92ZXInKS5jaGlsZHJlbihcInVsXCIpLmF0dHIoXCJhcmlhLWhpZGRlblwiLCBcImZhbHNlXCIpXG4gICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgdGhpcy52bWVudSA9ICExO1xuICAgIHJldHVybiAhMFxufTtcblxubWVudWJhci5wcm90b3R5cGUuaGFuZGxlS2V5RG93biA9IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICBpZiAodC5hbHRLZXkgfHwgdC5jdHJsS2V5KVxuICAgICAgICByZXR1cm4gITA7XG4gICAgc3dpdGNoICh0LmtleUNvZGUpIHtcbiAgICAgICAgY2FzZSB0aGlzLmtleXMudGFiOlxuICAgICAgICAgICAgdGhpcy4kaWQuZmluZChcInVsXCIpLmF0dHIoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIiksXG4gICAgICAgICAgICAgICAgdGhpcy4kYWxsSXRlbXMucmVtb3ZlQ2xhc3MoXCJtZW51LWZvY3VzIGhvdmVyXCIpLFxuICAgICAgICAgICAgICAgIHRoaXMuJGFjdGl2ZUl0ZW0gPSBudWxsLFxuICAgICAgICAgICAgMCA9PSB0aGlzLmJDaGlsZE9wZW47XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSB0aGlzLmtleXMuZXNjOlxuICAgICAgICAgICAgaWYgKFVYLm1lbnUuJHRvZ2dsZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy9pZiAoZS5rZXlDb2RlICA9PT0gZXNjS2V5KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9lLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgVVgubWVudS5vbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgVVgubWVudS4kdG9nZ2xlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgLy99XG5cbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IGUucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkuaXMoXCIjbWVudWJhclwiKSA/IChlLnJlbW92ZUNsYXNzKCdob3ZlcicpLmNoaWxkcmVuKFwidWxcIikuZmlyc3QoKS5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZS5mb2N1cygpKSA6ICh0aGlzLiRhY3RpdmVJdGVtID0gaS5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlQ2xhc3MoJ2hvdmVyJyksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJDaGlsZE9wZW4gPSAhMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGFjdGl2ZUl0ZW0uZm9jdXMoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuYXR0cihcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKSksXG4gICAgICAgICAgICAgICAgICAgIHQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgICAgICAgICAgICAgICExO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLmVudGVyOlxuICAgICAgICBjYXNlIHRoaXMua2V5cy5zcGFjZTpcbiAgICAgICAgICAgIHZhciBzID0gZS5wYXJlbnQoKTtcbiAgICAgICAgICAgIHJldHVybiBzLmlzKFwiI21lbnViYXJcIikgPyAoZS5hZGRDbGFzcygnaG92ZXInKS5jaGlsZHJlbihcInVsXCIpLmZpcnN0KCkuYXR0cihcImFyaWEtaGlkZGVuXCIsIFwiZmFsc2VcIiksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYkNoaWxkT3BlbiA9ICEwLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NNZW51Q2hvaWNlKGUpLFxuICAgICAgICAgICAgICAgICAgICBlLmZpbmQoXCJ1bCA+IGxpOmZpcnN0XCIpLmZpbmQoXCJhXCIpLmZvY3VzKCkpIDogKHRoaXMucHJvY2Vzc01lbnVDaG9pY2UoZSksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGFsbEl0ZW1zLnJlbW92ZUNsYXNzKFwibWVudS1ob3ZlciBtZW51LWhvdmVyLWNoZWNrZWQgaG92ZXJcIiksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGFsbEl0ZW1zLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1cyBtZW51LWZvY3VzLWNoZWNrZWQgaG92ZXJcIiksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGlkLmZpbmQoXCJ1bFwiKS5ub3QoXCIjbWVudWJhclwiKS5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLiRhY3RpdmVJdGVtID0gbnVsbCksXG4gICAgICAgICAgICAgICAgdC5zdG9wUHJvcGFnYXRpb24oKSxcbiAgICAgICAgICAgICAgICAhMTtcbiAgICAgICAgY2FzZSB0aGlzLmtleXMubGVmdDpcbiAgICAgICAgICAgIHJldHVybiAxID09IHRoaXMudm1lbnUgJiYgaS5pcyhcIiNtZW51YmFyXCIpID8gdGhpcy4kYWN0aXZlSXRlbSA9IHRoaXMubW92ZVVwKGUpIDogdGhpcy4kYWN0aXZlSXRlbSA9IHRoaXMubW92ZVRvUHJldmlvdXMoZSksXG4gICAgICAgICAgICAgICAgdGhpcy4kYWN0aXZlSXRlbS5mb2N1cygpLFxuICAgICAgICAgICAgICAgIHQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgICAgICAgICAgITE7XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLnJpZ2h0OlxuICAgICAgICAgICAgcmV0dXJuIDEgPT0gdGhpcy52bWVudSAmJiBpLmlzKFwiI21lbnViYXJcIikgPyB0aGlzLiRhY3RpdmVJdGVtID0gdGhpcy5tb3ZlRG93bihlKSA6IHRoaXMuJGFjdGl2ZUl0ZW0gPSB0aGlzLm1vdmVUb05leHQoZSksXG4gICAgICAgICAgICAgICAgdGhpcy4kYWN0aXZlSXRlbS5mb2N1cygpLFxuICAgICAgICAgICAgICAgIHQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgICAgICAgICAgITE7XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLnVwOlxuICAgICAgICAgICAgcmV0dXJuIDEgPT0gdGhpcy52bWVudSAmJiBpLmlzKFwiI21lbnViYXJcIikgPyB0aGlzLiRhY3RpdmVJdGVtID0gdGhpcy5tb3ZlVG9QcmV2aW91cyhlKSA6IHRoaXMuJGFjdGl2ZUl0ZW0gPSB0aGlzLm1vdmVVcChlKSxcbiAgICAgICAgICAgICAgICB0aGlzLiRhY3RpdmVJdGVtLmZvY3VzKCksXG4gICAgICAgICAgICAgICAgdC5zdG9wUHJvcGFnYXRpb24oKSxcbiAgICAgICAgICAgICAgICAhMTtcbiAgICAgICAgY2FzZSB0aGlzLmtleXMuZG93bjpcbiAgICAgICAgICAgIHJldHVybiAxID09IHRoaXMudm1lbnUgJiYgaS5pcyhcIiNtZW51YmFyXCIpID8gdGhpcy4kYWN0aXZlSXRlbSA9IHRoaXMubW92ZVRvTmV4dChlKSA6IHRoaXMuJGFjdGl2ZUl0ZW0gPSB0aGlzLm1vdmVEb3duKGUpLFxuICAgICAgICAgICAgICAgIHRoaXMuJGFjdGl2ZUl0ZW0uZm9jdXMoKSxcbiAgICAgICAgICAgICAgICB0LnN0b3BQcm9wYWdhdGlvbigpLFxuICAgICAgICAgICAgICAgICExXG4gICAgfVxuICAgIHJldHVybiAhMFxufTtcblxubWVudWJhci5wcm90b3R5cGUubW92ZVRvTmV4dCA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgdCA9IGUucGFyZW50KClcbiAgICAgICAgLCBpID0gdC5jaGlsZHJlbihcImxpXCIpXG4gICAgICAgICwgcyA9IGkubGVuZ3RoXG4gICAgICAgICwgciA9IGkuaW5kZXgoZSlcbiAgICAgICAgLCBuID0gbnVsbDtcbiAgICBpZiAodC5pcyhcIiNtZW51YmFyXCIpKSB7XG4gICAgICAgIGlmIChuID0gcyAtIDEgPiByID8gZS5uZXh0KCkgOiBpLmZpcnN0KCksXG4gICAgICAgICAgICBcInRydWVcIiA9PSBlLmF0dHIoXCJhcmlhLWhhc3BvcHVwXCIpKSB7XG4gICAgICAgICAgICBlLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xuICAgICAgICAgICAgdmFyIGEgPSBlLmNoaWxkcmVuKFwidWxcIikuZmlyc3QoKTtcbiAgICAgICAgICAgIFwiZmFsc2VcIiA9PSBhLmF0dHIoXCJhcmlhLWhpZGRlblwiKSAmJiAoYS5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgIHRoaXMuYkNoaWxkT3BlbiA9ICEwKVxuICAgICAgICB9XG4gICAgICAgIGlmIChlLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1c1wiKSxcbiAgICAgICAgICAgIFwidHJ1ZVwiID09IG4uYXR0cihcImFyaWEtaGFzcG9wdXBcIikgJiYgMSA9PSB0aGlzLmJDaGlsZE9wZW4pIHtcbiAgICAgICAgICAgIG4uYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICB2YXIgYSA9IG4uY2hpbGRyZW4oXCJ1bFwiKS5maXJzdCgpO1xuICAgICAgICAgICAgYS5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJmYWxzZVwiKVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChcInRydWVcIiA9PSBlLmF0dHIoXCJhcmlhLWhhc3BvcHVwXCIpKSB7XG4gICAgICAgIGUuYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgIHZhciBhID0gZS5jaGlsZHJlbihcInVsXCIpLmZpcnN0KCk7XG4gICAgICAgIG4gPSBhLmNoaWxkcmVuKFwibGlcIikuZmlyc3QoKSxcbiAgICAgICAgICAgIGEuYXR0cihcImFyaWEtaGlkZGVuXCIsIFwiZmFsc2VcIiksXG4gICAgICAgICAgICB0aGlzLmJDaGlsZE9wZW4gPSAhMFxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICgxID09IHRoaXMudm1lbnUpXG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgdmFyIGggPSBudWxsXG4gICAgICAgICAgICAsIG8gPSBudWxsO1xuICAgICAgICBpZiAoaCA9IGUucGFyZW50c1VudGlsKFwiZGl2XCIpLmZpbHRlcihcInVsXCIpLm5vdChcIiNtZW51YmFyXCIpLFxuICAgICAgICAgICAgICAgIGguYXR0cihcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKSxcbiAgICAgICAgICAgICAgICBoLmZpbmQoXCJsaVwiKS5yZW1vdmVDbGFzcyhcIm1lbnUtZm9jdXMgaG92ZXJcIiksXG4gICAgICAgICAgICAgICAgaC5sYXN0KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJtZW51LWZvY3VzIGhvdmVyXCIpLFxuICAgICAgICAgICAgICAgIG8gPSBoLmxhc3QoKS5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICByID0gdGhpcy4kcm9vdEl0ZW1zLmluZGV4KG8pLFxuICAgICAgICAgICAgICAgIG4gPSByIDwgdGhpcy4kcm9vdEl0ZW1zLmxlbmd0aCAtIDEgPyBvLm5leHQoKSA6IHRoaXMuJHJvb3RJdGVtcy5maXJzdCgpLFxuICAgICAgICAgICAgXCJ0cnVlXCIgPT0gbi5hdHRyKFwiYXJpYS1oYXNwb3B1cFwiKSAmJiBuLmNoaWxkcmVuKFwidWxcIikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbi5hZGRDbGFzcygnaG92ZXInKTtcbiAgICAgICAgICAgIHZhciBhID0gbi5jaGlsZHJlbihcInVsXCIpLmZpcnN0KCk7XG4gICAgICAgICAgICBuID0gYS5jaGlsZHJlbihcImxpXCIpLmZpcnN0KCksXG4gICAgICAgICAgICAgICAgYS5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJmYWxzZVwiKSxcbiAgICAgICAgICAgICAgICB0aGlzLmJDaGlsZE9wZW4gPSAhMFxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuXG59O1xuXG5tZW51YmFyLnByb3RvdHlwZS5tb3ZlVG9QcmV2aW91cyA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgdCA9IGUucGFyZW50KClcbiAgICAgICAgLCBpID0gdC5jaGlsZHJlbihcImxpXCIpXG4gICAgICAgICwgcyA9IChpLmxlbmd0aCxcbiAgICAgICAgaS5pbmRleChlKSlcbiAgICAgICAgLCByID0gbnVsbDtcbiAgICBpZiAodC5pcyhcIiNtZW51YmFyXCIpKSB7XG4gICAgICAgIGlmIChyID0gcyA+IDAgPyBlLnByZXYoKSA6IGkubGFzdCgpLFxuICAgICAgICAgICAgXCJ0cnVlXCIgPT0gZS5hdHRyKFwiYXJpYS1oYXNwb3B1cFwiKSkge1xuICAgICAgICAgICAgdmFyIG4gPSBlLnJlbW92ZUNsYXNzKCdob3ZlcicpLmNoaWxkcmVuKFwidWxcIikuZmlyc3QoKTtcbiAgICAgICAgICAgIFwiZmFsc2VcIiA9PSBuLmF0dHIoXCJhcmlhLWhpZGRlblwiKSAmJiAobi5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgIHRoaXMuYkNoaWxkT3BlbiA9ICEwKVxuICAgICAgICB9XG4gICAgICAgIGlmIChlLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1cyBob3ZlclwiKSxcbiAgICAgICAgICAgIFwidHJ1ZVwiID09IHIuYXR0cihcImFyaWEtaGFzcG9wdXBcIikgJiYgMSA9PSB0aGlzLmJDaGlsZE9wZW4pIHtcbiAgICAgICAgICAgIHIuYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICB2YXIgbiA9IHIuY2hpbGRyZW4oXCJ1bFwiKS5maXJzdCgpO1xuICAgICAgICAgICAgbi5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJmYWxzZVwiKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGEgPSB0LnBhcmVudCgpXG4gICAgICAgICAgICAsIGggPSBhLnBhcmVudCgpO1xuXG4gICAgICAgIGlmICgxICE9IHRoaXMudm1lbnUgJiYgaC5pcyhcIiNtZW51YmFyXCIpKSB7XG4gICAgICAgICAgICBpZiAodC5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgICAgICBlLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1cyBob3ZlclwiKSxcbiAgICAgICAgICAgICAgICAgICAgYS5yZW1vdmVDbGFzcyhcIm1lbnUtZm9jdXMgaG92ZXJcIiksXG4gICAgICAgICAgICAgICAgICAgIHMgPSB0aGlzLiRyb290SXRlbXMuaW5kZXgoYSksXG4gICAgICAgICAgICAgICAgICAgIHIgPSBzID4gMCA/IGEucHJldigpIDogdGhpcy4kcm9vdEl0ZW1zLmxhc3QoKSxcbiAgICAgICAgICAgICAgICAgICAgci5hZGRDbGFzcyhcIm1lbnUtZm9jdXMgaG92ZXJcIiksXG4gICAgICAgICAgICAgICAgXCJ0cnVlXCIgPT0gci5hdHRyKFwiYXJpYS1oYXNwb3B1cFwiKSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBudWxsO1xuICAgICAgICAgICAgICAgIHIuY2hpbGRyZW4oXCJ1bFwiKS5sZW5ndGggPiAwICYmIChuID0gci5hZGRDbGFzcygnaG92ZXInKS5jaGlsZHJlbihcInVsXCIpLmZpcnN0KCksXG4gICAgICAgICAgICAgICAgICAgIG4uYXR0cihcImFyaWEtaGlkZGVuXCIsIFwiZmFsc2VcIiksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYkNoaWxkT3BlbiA9ICEwLFxuICAgICAgICAgICAgICAgICAgICByID0gbi5jaGlsZHJlbihcImxpXCIpLmZpcnN0KCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgciA9IHQucGFyZW50KCksXG4gICAgICAgICAgICAgICAgdC5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgIGUucmVtb3ZlQ2xhc3MoXCJtZW51LWZvY3VzIGhvdmVyXCIpLFxuICAgICAgICAgICAgICAgIHIucmVtb3ZlQ2xhc3MoXCJob3ZlclwiKSxcbiAgICAgICAgICAgIDEgPT0gdGhpcy52bWVudSAmJiAodGhpcy5iQ2hpbGRPcGVuID0gITEpXG4gICAgfVxuICAgIHJldHVybiByXG59O1xuXG5tZW51YmFyLnByb3RvdHlwZS5tb3ZlRG93biA9IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICB2YXIgaSA9IGUucGFyZW50KClcbiAgICAgICAgLCBzID0gaS5jaGlsZHJlbihcImxpXCIpLm5vdChcIi5zZXBhcmF0b3JcIilcbiAgICAgICAgLCByID0gcy5sZW5ndGhcbiAgICAgICAgLCBuID0gcy5pbmRleChlKVxuICAgICAgICAsIGEgPSBudWxsXG4gICAgICAgICwgaCA9IG51bGw7XG4gICAgaWYgKGkuaXMoXCIjbWVudWJhclwiKSlcbiAgICAgICAgcmV0dXJuIFwidHJ1ZVwiICE9IGUuYXR0cihcImFyaWEtaGFzcG9wdXBcIikgPyBlIDogKGggPSBlLmFkZENsYXNzKCdob3ZlcicpLmNoaWxkcmVuKFwidWxcIikuZmlyc3QoKSxcbiAgICAgICAgICAgICAgICBhID0gaC5jaGlsZHJlbihcImxpXCIpLmZpcnN0KCksXG4gICAgICAgICAgICAgICAgaC5hdHRyKFwiYXJpYS1oaWRkZW5cIiwgXCJmYWxzZVwiKSxcbiAgICAgICAgICAgICAgICB0aGlzLmJDaGlsZE9wZW4gPSAhMCxcbiAgICAgICAgICAgICAgICBhKTtcbiAgICBpZiAodCkge1xuICAgICAgICB2YXIgbyA9ICExXG4gICAgICAgICAgICAsIHUgPSBuICsgMTtcbiAgICAgICAgZm9yICh1ID09IHIgJiYgKHUgPSAwKTsgdSAhPSBuOyApIHtcbiAgICAgICAgICAgIHZhciBsID0gcy5lcSh1KS5odG1sKCkuY2hhckF0KDApO1xuICAgICAgICAgICAgaWYgKGwudG9Mb3dlckNhc2UoKSA9PSB0KSB7XG4gICAgICAgICAgICAgICAgbyA9ICEwO1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1ICs9IDEsXG4gICAgICAgICAgICB1ID09IHIgJiYgKHUgPSAwKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAxID09IG8gPyAoYSA9IHMuZXEodSksXG4gICAgICAgICAgICAgICAgZS5yZW1vdmVDbGFzcyhcIm1lbnUtZm9jdXMgbWVudS1mb2N1cy1jaGVja2VkXCIpLFxuICAgICAgICAgICAgICAgIGEpIDogZVxuICAgIH1cbiAgICByZXR1cm4gYSA9IHIgLSAxID4gbiA/IHMuZXEobiArIDEpIDogcy5maXJzdCgpLFxuICAgICAgICBlLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1cyBtZW51LWZvY3VzLWNoZWNrZWRcIiksXG4gICAgICAgIGFcbn07XG5cbm1lbnViYXIucHJvdG90eXBlLm1vdmVVcCA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgdCA9IGUucGFyZW50KClcbiAgICAgICAgLCBpID0gdC5jaGlsZHJlbihcImxpXCIpLm5vdChcIi5zZXBhcmF0b3JcIilcbiAgICAgICAgLCBzID0gKGkubGVuZ3RoLFxuICAgICAgICBpLmluZGV4KGUpKVxuICAgICAgICAsIHIgPSBudWxsO1xuICAgIHJldHVybiB0LmlzKFwiI21lbnViYXJcIikgPyBlIDogKHIgPSBzID4gMCA/IGkuZXEocyAtIDEpIDogaS5sYXN0KCksXG4gICAgICAgICAgICBlLnJlbW92ZUNsYXNzKFwibWVudS1mb2N1cyBtZW51LWZvY3VzLWNoZWNrZWRcIiksXG4gICAgICAgICAgICByKVxufTtcblxubWVudWJhci5wcm90b3R5cGUuaGFuZGxlS2V5UHJlc3MgPSBmdW5jdGlvbihlLCB0KSB7XG4gICAgaWYgKHQuYWx0S2V5IHx8IHQuY3RybEtleSB8fCB0LnNoaWZ0S2V5KVxuICAgICAgICByZXR1cm4gITA7XG4gICAgc3dpdGNoICh0LmtleUNvZGUpIHtcbiAgICAgICAgY2FzZSB0aGlzLmtleXMudGFiOlxuICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICBjYXNlIHRoaXMua2V5cy5lc2M6XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLmVudGVyOlxuICAgICAgICBjYXNlIHRoaXMua2V5cy5zcGFjZTpcbiAgICAgICAgY2FzZSB0aGlzLmtleXMudXA6XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLmRvd246XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLmxlZnQ6XG4gICAgICAgIGNhc2UgdGhpcy5rZXlzLnJpZ2h0OlxuICAgICAgICAgICAgcmV0dXJuIHQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgICAgICAgICAgITE7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YXIgaSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodC53aGljaCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kYWN0aXZlSXRlbSA9IHRoaXMubW92ZURvd24oZSwgaSksXG4gICAgICAgICAgICAgICAgdGhpcy4kYWN0aXZlSXRlbS5mb2N1cygpLFxuICAgICAgICAgICAgICAgIHQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgICAgICAgICAgITFcbiAgICB9XG4gICAgcmV0dXJuICEwXG59O1xuXG5tZW51YmFyLnByb3RvdHlwZS5oYW5kbGVEb2N1bWVudENsaWNrID0gZnVuY3Rpb24oZSkge1xuXG4gICAgdmFyIHQgPSB0aGlzLiRpZC5maW5kKFwidWxcIikubm90KFwiI21lbnViYXJcIik7XG4gICAgcmV0dXJuIHQuYXR0cihcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKSxcbiAgICAgICAgdGhpcy4kYWxsSXRlbXMucmVtb3ZlQ2xhc3MoXCJtZW51LWZvY3VzIG1lbnUtZm9jdXMtY2hlY2tlZCBob3ZlclwiKSxcbiAgICAgICAgdGhpcy4kYWN0aXZlSXRlbSA9IG51bGwsXG4gICAgICAgICEwXG59O1xuXG5tZW51YmFyLnByb3RvdHlwZS5wcm9jZXNzTWVudUNob2ljZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIHQgPSAoZS5wYXJlbnQoKS5hdHRyKFwiaWRcIiksXG4gICAgICAgICAgICBlLmF0dHIoXCJpZFwiKSxcbiAgICAgICAgICAgIGUuZGF0YShcImhyZWZcIikpO1xuICAgICAgICBpZiAobnVsbCAhPSB0KVxuICAgICAgICAgICAgaWYgKHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwibGVnYWN5LlwiKSA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IHdpbmRvdy5vcGVuKHQsIFwiX2JsYW5rXCIpO1xuICAgICAgICAgICAgICAgIGkuZm9jdXMoKVxuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0O1xuICAgICAgICB2YXIgcyA9IGUuZmluZChcImFcIik7XG4gICAgICAgIG51bGwgIT0gcyAmJiAod2luZG93LmxvY2F0aW9uLmhyZWYgPSBzWzBdLmhyZWYpXG4gICAgfVxuO1xuXG53aW5kb3cubWVudWJhciA9IG1lbnViYXI7XG4iLCIvKiFcbiAqIGVucXVpcmUuanMgdjIuMS4yIC0gQXdlc29tZSBNZWRpYSBRdWVyaWVzIGluIEphdmFTY3JpcHRcbiAqIENvcHlyaWdodCAoYykgMjAxNCBOaWNrIFdpbGxpYW1zIC0gaHR0cDovL3dpY2t5Lm5pbGxpYS5tcy9lbnF1aXJlLmpzXG4gKiBMaWNlbnNlOiBNSVQgKGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwKVxuICovXG5cbjsoZnVuY3Rpb24gKG5hbWUsIGNvbnRleHQsIGZhY3RvcnkpIHtcblx0dmFyIG1hdGNoTWVkaWEgPSB3aW5kb3cubWF0Y2hNZWRpYTtcblxuXHQvKmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShtYXRjaE1lZGlhKTtcblx0fVxuXHRlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHRkZWZpbmUoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gKGNvbnRleHRbbmFtZV0gPSBmYWN0b3J5KG1hdGNoTWVkaWEpKTtcblx0XHR9KTtcblx0fVxuXHRlbHNlIHtcblx0XHRjb250ZXh0W25hbWVdID0gZmFjdG9yeShtYXRjaE1lZGlhKTtcblx0fSovXG4gICAgY29udGV4dFtuYW1lXSA9IGZhY3RvcnkobWF0Y2hNZWRpYSk7XG59KCdlbnF1aXJlJywgd2luZG93LCBmdW5jdGlvbiAobWF0Y2hNZWRpYSkge1xuXG5cdCd1c2Ugc3RyaWN0JztcblxuICAgIC8qanNoaW50IHVudXNlZDpmYWxzZSAqL1xuICAgIC8qKlxuICAgICAqIEhlbHBlciBmdW5jdGlvbiBmb3IgaXRlcmF0aW5nIG92ZXIgYSBjb2xsZWN0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvblxuICAgICAqIEBwYXJhbSBmblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVhY2goY29sbGVjdGlvbiwgZm4pIHtcbiAgICAgICAgdmFyIGkgICAgICA9IDAsXG4gICAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aCxcbiAgICAgICAgICAgIGNvbnQ7XG5cbiAgICAgICAgZm9yKGk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29udCA9IGZuKGNvbGxlY3Rpb25baV0sIGkpO1xuICAgICAgICAgICAgaWYoY29udCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBicmVhazsgLy9hbGxvdyBlYXJseSBleGl0XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gZm9yIGRldGVybWluaW5nIHdoZXRoZXIgdGFyZ2V0IG9iamVjdCBpcyBhbiBhcnJheVxuICAgICAqXG4gICAgICogQHBhcmFtIHRhcmdldCB0aGUgb2JqZWN0IHVuZGVyIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIGFycmF5LCBmYWxzZSBvdGhlcndpc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0FycmF5KHRhcmdldCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5hcHBseSh0YXJnZXQpID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhlbHBlciBmdW5jdGlvbiBmb3IgZGV0ZXJtaW5pbmcgd2hldGhlciB0YXJnZXQgb2JqZWN0IGlzIGEgZnVuY3Rpb25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YXJnZXQgdGhlIG9iamVjdCB1bmRlciB0ZXN0XG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBmdW5jdGlvbiwgZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNGdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbic7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZWdhdGUgdG8gaGFuZGxlIGEgbWVkaWEgcXVlcnkgYmVpbmcgbWF0Y2hlZCBhbmQgdW5tYXRjaGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBvcHRpb25zLm1hdGNoIGNhbGxiYWNrIGZvciB3aGVuIHRoZSBtZWRpYSBxdWVyeSBpcyBtYXRjaGVkXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gW29wdGlvbnMudW5tYXRjaF0gY2FsbGJhY2sgZm9yIHdoZW4gdGhlIG1lZGlhIHF1ZXJ5IGlzIHVubWF0Y2hlZFxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IFtvcHRpb25zLnNldHVwXSBvbmUtdGltZSBjYWxsYmFjayB0cmlnZ2VyZWQgdGhlIGZpcnN0IHRpbWUgYSBxdWVyeSBpcyBtYXRjaGVkXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kZWZlclNldHVwPWZhbHNlXSBzaG91bGQgdGhlIHNldHVwIGNhbGxiYWNrIGJlIHJ1biBpbW1lZGlhdGVseSwgcmF0aGVyIHRoYW4gZmlyc3QgdGltZSBxdWVyeSBpcyBtYXRjaGVkP1xuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFF1ZXJ5SGFuZGxlcihvcHRpb25zKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICFvcHRpb25zLmRlZmVyU2V0dXAgJiYgdGhpcy5zZXR1cCgpO1xuICAgIH1cbiAgICBRdWVyeUhhbmRsZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb29yZGluYXRlcyBzZXR1cCBvZiB0aGUgaGFuZGxlclxuICAgICAgICAgKlxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIHNldHVwIDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZih0aGlzLm9wdGlvbnMuc2V0dXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuc2V0dXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGlzZWQgPSB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb29yZGluYXRlcyBzZXR1cCBhbmQgdHJpZ2dlcmluZyBvZiB0aGUgaGFuZGxlclxuICAgICAgICAgKlxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIG9uIDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAhdGhpcy5pbml0aWFsaXNlZCAmJiB0aGlzLnNldHVwKCk7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMubWF0Y2ggJiYgdGhpcy5vcHRpb25zLm1hdGNoKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvb3JkaW5hdGVzIHRoZSB1bm1hdGNoIGV2ZW50IGZvciB0aGUgaGFuZGxlclxuICAgICAgICAgKlxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIG9mZiA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnVubWF0Y2ggJiYgdGhpcy5vcHRpb25zLnVubWF0Y2goKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY2FsbGVkIHdoZW4gYSBoYW5kbGVyIGlzIHRvIGJlIGRlc3Ryb3llZC5cbiAgICAgICAgICogZGVsZWdhdGVzIHRvIHRoZSBkZXN0cm95IG9yIHVubWF0Y2ggY2FsbGJhY2tzLCBkZXBlbmRpbmcgb24gYXZhaWxhYmlsaXR5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIGRlc3Ryb3kgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kZXN0cm95ID8gdGhpcy5vcHRpb25zLmRlc3Ryb3koKSA6IHRoaXMub2ZmKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZXMgZXF1YWxpdHkgYnkgcmVmZXJlbmNlLlxuICAgICAgICAgKiBpZiBvYmplY3QgaXMgc3VwcGxpZWQgY29tcGFyZSBvcHRpb25zLCBpZiBmdW5jdGlvbiwgY29tcGFyZSBtYXRjaCBjYWxsYmFja1xuICAgICAgICAgKlxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3QgfHwgZnVuY3Rpb259IFt0YXJnZXRdIHRoZSB0YXJnZXQgZm9yIGNvbXBhcmlzb25cbiAgICAgICAgICovXG4gICAgICAgIGVxdWFscyA6IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucyA9PT0gdGFyZ2V0IHx8IHRoaXMub3B0aW9ucy5tYXRjaCA9PT0gdGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgYSBzaW5nbGUgbWVkaWEgcXVlcnksIG1hbmFnZXMgaXQncyBzdGF0ZSBhbmQgcmVnaXN0ZXJlZCBoYW5kbGVycyBmb3IgdGhpcyBxdWVyeVxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5IHRoZSBtZWRpYSBxdWVyeSBzdHJpbmdcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc1VuY29uZGl0aW9uYWw9ZmFsc2VdIHdoZXRoZXIgdGhlIG1lZGlhIHF1ZXJ5IHNob3VsZCBydW4gcmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRoZSBjb25kaXRpb25zIGFyZSBtZXQuIFByaW1hcmlseSBmb3IgaGVscGluZyBvbGRlciBicm93c2VycyBkZWFsIHdpdGggbW9iaWxlLWZpcnN0IGRlc2lnblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIE1lZGlhUXVlcnkocXVlcnksIGlzVW5jb25kaXRpb25hbCkge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHRoaXMuaXNVbmNvbmRpdGlvbmFsID0gaXNVbmNvbmRpdGlvbmFsO1xuICAgICAgICB0aGlzLmhhbmRsZXJzID0gW107XG4gICAgICAgIHRoaXMubXFsID0gbWF0Y2hNZWRpYShxdWVyeSk7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmxpc3RlbmVyID0gZnVuY3Rpb24obXFsKSB7XG4gICAgICAgICAgICBzZWxmLm1xbCA9IG1xbDtcbiAgICAgICAgICAgIHNlbGYuYXNzZXNzKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubXFsLmFkZExpc3RlbmVyKHRoaXMubGlzdGVuZXIpO1xuICAgIH1cbiAgICBNZWRpYVF1ZXJ5LnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYWRkIGEgaGFuZGxlciBmb3IgdGhpcyBxdWVyeSwgdHJpZ2dlcmluZyBpZiBhbHJlYWR5IGFjdGl2ZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gaGFuZGxlclxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBoYW5kbGVyLm1hdGNoIGNhbGxiYWNrIGZvciB3aGVuIHF1ZXJ5IGlzIGFjdGl2YXRlZFxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBbaGFuZGxlci51bm1hdGNoXSBjYWxsYmFjayBmb3Igd2hlbiBxdWVyeSBpcyBkZWFjdGl2YXRlZFxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBbaGFuZGxlci5zZXR1cF0gY2FsbGJhY2sgZm9yIGltbWVkaWF0ZSBleGVjdXRpb24gd2hlbiBhIHF1ZXJ5IGhhbmRsZXIgaXMgcmVnaXN0ZXJlZFxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtoYW5kbGVyLmRlZmVyU2V0dXA9ZmFsc2VdIHNob3VsZCB0aGUgc2V0dXAgY2FsbGJhY2sgYmUgZGVmZXJyZWQgdW50aWwgdGhlIGZpcnN0IHRpbWUgdGhlIGhhbmRsZXIgaXMgbWF0Y2hlZD9cbiAgICAgICAgICovXG4gICAgICAgIGFkZEhhbmRsZXIgOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgICB2YXIgcWggPSBuZXcgUXVlcnlIYW5kbGVyKGhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5wdXNoKHFoKTtcblxuICAgICAgICAgICAgdGhpcy5tYXRjaGVzKCkgJiYgcWgub24oKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmVtb3ZlcyB0aGUgZ2l2ZW4gaGFuZGxlciBmcm9tIHRoZSBjb2xsZWN0aW9uLCBhbmQgY2FsbHMgaXQncyBkZXN0cm95IG1ldGhvZHNcbiAgICAgICAgICogXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0IHx8IGZ1bmN0aW9ufSBoYW5kbGVyIHRoZSBoYW5kbGVyIHRvIHJlbW92ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlSGFuZGxlciA6IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnM7XG4gICAgICAgICAgICBlYWNoKGhhbmRsZXJzLCBmdW5jdGlvbihoLCBpKSB7XG4gICAgICAgICAgICAgICAgaWYoaC5lcXVhbHMoaGFuZGxlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgaC5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhaGFuZGxlcnMuc3BsaWNlKGksMSk7IC8vcmVtb3ZlIGZyb20gYXJyYXkgYW5kIGV4aXQgZWFjaCBlYXJseVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZXRlcm1pbmUgd2hldGhlciB0aGUgbWVkaWEgcXVlcnkgc2hvdWxkIGJlIGNvbnNpZGVyZWQgYSBtYXRjaFxuICAgICAgICAgKiBcbiAgICAgICAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBtZWRpYSBxdWVyeSBjYW4gYmUgY29uc2lkZXJlZCBhIG1hdGNoLCBmYWxzZSBvdGhlcndpc2VcbiAgICAgICAgICovXG4gICAgICAgIG1hdGNoZXMgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1xbC5tYXRjaGVzIHx8IHRoaXMuaXNVbmNvbmRpdGlvbmFsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGVhcnMgYWxsIGhhbmRsZXJzIGFuZCB1bmJpbmRzIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgY2xlYXIgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGVhY2godGhpcy5oYW5kbGVycywgZnVuY3Rpb24oaGFuZGxlcikge1xuICAgICAgICAgICAgICAgIGhhbmRsZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm1xbC5yZW1vdmVMaXN0ZW5lcih0aGlzLmxpc3RlbmVyKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnMubGVuZ3RoID0gMDsgLy9jbGVhciBhcnJheVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIEFzc2Vzc2VzIHRoZSBxdWVyeSwgdHVybmluZyBvbiBhbGwgaGFuZGxlcnMgaWYgaXQgbWF0Y2hlcywgdHVybmluZyB0aGVtIG9mZiBpZiBpdCBkb2Vzbid0IG1hdGNoXG4gICAgICAgICAqL1xuICAgICAgICBhc3Nlc3MgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSB0aGlzLm1hdGNoZXMoKSA/ICdvbicgOiAnb2ZmJztcblxuICAgICAgICAgICAgZWFjaCh0aGlzLmhhbmRsZXJzLCBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlclthY3Rpb25dKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQWxsb3dzIGZvciByZWdpc3RyYXRpb24gb2YgcXVlcnkgaGFuZGxlcnMuXG4gICAgICogTWFuYWdlcyB0aGUgcXVlcnkgaGFuZGxlcidzIHN0YXRlIGFuZCBpcyByZXNwb25zaWJsZSBmb3Igd2lyaW5nIHVwIGJyb3dzZXIgZXZlbnRzXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBNZWRpYVF1ZXJ5RGlzcGF0Y2ggKCkge1xuICAgICAgICBpZighbWF0Y2hNZWRpYSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXRjaE1lZGlhIG5vdCBwcmVzZW50LCBsZWdhY3kgYnJvd3NlcnMgcmVxdWlyZSBhIHBvbHlmaWxsJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB7fTtcbiAgICAgICAgdGhpcy5icm93c2VySXNJbmNhcGFibGUgPSAhbWF0Y2hNZWRpYSgnb25seSBhbGwnKS5tYXRjaGVzO1xuICAgIH1cblxuICAgIE1lZGlhUXVlcnlEaXNwYXRjaC5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZ2lzdGVycyBhIGhhbmRsZXIgZm9yIHRoZSBnaXZlbiBtZWRpYSBxdWVyeVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcSB0aGUgbWVkaWEgcXVlcnlcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3QgfHwgQXJyYXkgfHwgRnVuY3Rpb259IG9wdGlvbnMgZWl0aGVyIGEgc2luZ2xlIHF1ZXJ5IGhhbmRsZXIgb2JqZWN0LCBhIGZ1bmN0aW9uLCBvciBhbiBhcnJheSBvZiBxdWVyeSBoYW5kbGVyc1xuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBvcHRpb25zLm1hdGNoIGZpcmVkIHdoZW4gcXVlcnkgbWF0Y2hlZFxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBbb3B0aW9ucy51bm1hdGNoXSBmaXJlZCB3aGVuIGEgcXVlcnkgaXMgbm8gbG9uZ2VyIG1hdGNoZWRcbiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gW29wdGlvbnMuc2V0dXBdIGZpcmVkIHdoZW4gaGFuZGxlciBmaXJzdCB0cmlnZ2VyZWRcbiAgICAgICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kZWZlclNldHVwPWZhbHNlXSB3aGV0aGVyIHNldHVwIHNob3VsZCBiZSBydW4gaW1tZWRpYXRlbHkgb3IgZGVmZXJyZWQgdW50aWwgcXVlcnkgaXMgZmlyc3QgbWF0Y2hlZFxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzaG91bGREZWdyYWRlPWZhbHNlXSB3aGV0aGVyIHRoaXMgcGFydGljdWxhciBtZWRpYSBxdWVyeSBzaG91bGQgYWx3YXlzIHJ1biBvbiBpbmNhcGFibGUgYnJvd3NlcnNcbiAgICAgICAgICovXG4gICAgICAgIHJlZ2lzdGVyIDogZnVuY3Rpb24ocSwgb3B0aW9ucywgc2hvdWxkRGVncmFkZSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJpZXMgICAgICAgICA9IHRoaXMucXVlcmllcyxcbiAgICAgICAgICAgICAgICBpc1VuY29uZGl0aW9uYWwgPSBzaG91bGREZWdyYWRlICYmIHRoaXMuYnJvd3NlcklzSW5jYXBhYmxlO1xuXG4gICAgICAgICAgICBpZighcXVlcmllc1txXSkge1xuICAgICAgICAgICAgICAgIHF1ZXJpZXNbcV0gPSBuZXcgTWVkaWFRdWVyeShxLCBpc1VuY29uZGl0aW9uYWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL25vcm1hbGlzZSB0byBvYmplY3QgaW4gYW4gYXJyYXlcbiAgICAgICAgICAgIGlmKGlzRnVuY3Rpb24ob3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0geyBtYXRjaCA6IG9wdGlvbnMgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCFpc0FycmF5KG9wdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IFtvcHRpb25zXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVhY2gob3B0aW9ucywgZnVuY3Rpb24oaGFuZGxlcikge1xuICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSB7IG1hdGNoIDogaGFuZGxlciB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBxdWVyaWVzW3FdLmFkZEhhbmRsZXIoaGFuZGxlcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHVucmVnaXN0ZXJzIGEgcXVlcnkgYW5kIGFsbCBpdCdzIGhhbmRsZXJzLCBvciBhIHNwZWNpZmljIGhhbmRsZXIgZm9yIGEgcXVlcnlcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHEgdGhlIG1lZGlhIHF1ZXJ5IHRvIHRhcmdldFxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdCB8fCBmdW5jdGlvbn0gW2hhbmRsZXJdIHNwZWNpZmljIGhhbmRsZXIgdG8gdW5yZWdpc3RlclxuICAgICAgICAgKi9cbiAgICAgICAgdW5yZWdpc3RlciA6IGZ1bmN0aW9uKHEsIGhhbmRsZXIpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IHRoaXMucXVlcmllc1txXTtcblxuICAgICAgICAgICAgaWYocXVlcnkpIHtcbiAgICAgICAgICAgICAgICBpZihoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnJlbW92ZUhhbmRsZXIoaGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeS5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5xdWVyaWVzW3FdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9O1xuXG5cdHJldHVybiBuZXcgTWVkaWFRdWVyeURpc3BhdGNoKCk7XG5cbn0pKTsiLCIvKiEgalF1ZXJ5IFVJIC0gdjEuMTIuMSAtIDIwMTgtMDQtMjRcbiogaHR0cDovL2pxdWVyeXVpLmNvbVxuKiBJbmNsdWRlczogd2lkZ2V0LmpzLCBkYXRhLmpzLCBqcXVlcnktMS03LmpzLCBrZXljb2RlLmpzLCBzY3JvbGwtcGFyZW50LmpzLCB3aWRnZXRzL3NvcnRhYmxlLmpzLCB3aWRnZXRzL2RhdGVwaWNrZXIuanMsIHdpZGdldHMvbW91c2UuanMsIHdpZGdldHMvc2xpZGVyLmpzXG4qIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzOyBMaWNlbnNlZCBNSVQgKi9cblxuKGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHQvLyBpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vXG5cdC8vIFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHQvLyBcdGRlZmluZShbIFwianF1ZXJ5XCIgXSwgZmFjdG9yeSApO1xuXHQvLyB9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdC8vfVxufShmdW5jdGlvbiggJCApIHtcblxuJC51aSA9ICQudWkgfHwge307XG5cbnZhciB2ZXJzaW9uID0gJC51aS52ZXJzaW9uID0gXCIxLjEyLjFcIjtcblxuXG4vKiFcbiAqIGpRdWVyeSBVSSBXaWRnZXQgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IFdpZGdldFxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFByb3ZpZGVzIGEgZmFjdG9yeSBmb3IgY3JlYXRpbmcgc3RhdGVmdWwgd2lkZ2V0cyB3aXRoIGEgY29tbW9uIEFQSS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkud2lkZ2V0L1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3dpZGdldC9cblxuXG5cbnZhciB3aWRnZXRVdWlkID0gMDtcbnZhciB3aWRnZXRTbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuJC5jbGVhbkRhdGEgPSAoIGZ1bmN0aW9uKCBvcmlnICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oIGVsZW1zICkge1xuXHRcdHZhciBldmVudHMsIGVsZW0sIGk7XG5cdFx0Zm9yICggaSA9IDA7ICggZWxlbSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHR0cnkge1xuXG5cdFx0XHRcdC8vIE9ubHkgdHJpZ2dlciByZW1vdmUgd2hlbiBuZWNlc3NhcnkgdG8gc2F2ZSB0aW1lXG5cdFx0XHRcdGV2ZW50cyA9ICQuX2RhdGEoIGVsZW0sIFwiZXZlbnRzXCIgKTtcblx0XHRcdFx0aWYgKCBldmVudHMgJiYgZXZlbnRzLnJlbW92ZSApIHtcblx0XHRcdFx0XHQkKCBlbGVtICkudHJpZ2dlckhhbmRsZXIoIFwicmVtb3ZlXCIgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBIdHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC84MjM1XG5cdFx0XHR9IGNhdGNoICggZSApIHt9XG5cdFx0fVxuXHRcdG9yaWcoIGVsZW1zICk7XG5cdH07XG59ICkoICQuY2xlYW5EYXRhICk7XG5cbiQud2lkZ2V0ID0gZnVuY3Rpb24oIG5hbWUsIGJhc2UsIHByb3RvdHlwZSApIHtcblx0dmFyIGV4aXN0aW5nQ29uc3RydWN0b3IsIGNvbnN0cnVjdG9yLCBiYXNlUHJvdG90eXBlO1xuXG5cdC8vIFByb3hpZWRQcm90b3R5cGUgYWxsb3dzIHRoZSBwcm92aWRlZCBwcm90b3R5cGUgdG8gcmVtYWluIHVubW9kaWZpZWRcblx0Ly8gc28gdGhhdCBpdCBjYW4gYmUgdXNlZCBhcyBhIG1peGluIGZvciBtdWx0aXBsZSB3aWRnZXRzICgjODg3Nilcblx0dmFyIHByb3hpZWRQcm90b3R5cGUgPSB7fTtcblxuXHR2YXIgbmFtZXNwYWNlID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMCBdO1xuXHRuYW1lID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMSBdO1xuXHR2YXIgZnVsbE5hbWUgPSBuYW1lc3BhY2UgKyBcIi1cIiArIG5hbWU7XG5cblx0aWYgKCAhcHJvdG90eXBlICkge1xuXHRcdHByb3RvdHlwZSA9IGJhc2U7XG5cdFx0YmFzZSA9ICQuV2lkZ2V0O1xuXHR9XG5cblx0aWYgKCAkLmlzQXJyYXkoIHByb3RvdHlwZSApICkge1xuXHRcdHByb3RvdHlwZSA9ICQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIHt9IF0uY29uY2F0KCBwcm90b3R5cGUgKSApO1xuXHR9XG5cblx0Ly8gQ3JlYXRlIHNlbGVjdG9yIGZvciBwbHVnaW5cblx0JC5leHByWyBcIjpcIiBdWyBmdWxsTmFtZS50b0xvd2VyQ2FzZSgpIF0gPSBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGZ1bGxOYW1lICk7XG5cdH07XG5cblx0JFsgbmFtZXNwYWNlIF0gPSAkWyBuYW1lc3BhY2UgXSB8fCB7fTtcblx0ZXhpc3RpbmdDb25zdHJ1Y3RvciA9ICRbIG5hbWVzcGFjZSBdWyBuYW1lIF07XG5cdGNvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkge1xuXG5cdFx0Ly8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IFwibmV3XCIga2V5d29yZFxuXHRcdGlmICggIXRoaXMuX2NyZWF0ZVdpZGdldCApIHtcblx0XHRcdHJldHVybiBuZXcgY29uc3RydWN0b3IoIG9wdGlvbnMsIGVsZW1lbnQgKTtcblx0XHR9XG5cblx0XHQvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgaW5pdGlhbGl6aW5nIGZvciBzaW1wbGUgaW5oZXJpdGFuY2Vcblx0XHQvLyBtdXN0IHVzZSBcIm5ld1wiIGtleXdvcmQgKHRoZSBjb2RlIGFib3ZlIGFsd2F5cyBwYXNzZXMgYXJncylcblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVXaWRnZXQoIG9wdGlvbnMsIGVsZW1lbnQgKTtcblx0XHR9XG5cdH07XG5cblx0Ly8gRXh0ZW5kIHdpdGggdGhlIGV4aXN0aW5nIGNvbnN0cnVjdG9yIHRvIGNhcnJ5IG92ZXIgYW55IHN0YXRpYyBwcm9wZXJ0aWVzXG5cdCQuZXh0ZW5kKCBjb25zdHJ1Y3RvciwgZXhpc3RpbmdDb25zdHJ1Y3Rvciwge1xuXHRcdHZlcnNpb246IHByb3RvdHlwZS52ZXJzaW9uLFxuXG5cdFx0Ly8gQ29weSB0aGUgb2JqZWN0IHVzZWQgdG8gY3JlYXRlIHRoZSBwcm90b3R5cGUgaW4gY2FzZSB3ZSBuZWVkIHRvXG5cdFx0Ly8gcmVkZWZpbmUgdGhlIHdpZGdldCBsYXRlclxuXHRcdF9wcm90bzogJC5leHRlbmQoIHt9LCBwcm90b3R5cGUgKSxcblxuXHRcdC8vIFRyYWNrIHdpZGdldHMgdGhhdCBpbmhlcml0IGZyb20gdGhpcyB3aWRnZXQgaW4gY2FzZSB0aGlzIHdpZGdldCBpc1xuXHRcdC8vIHJlZGVmaW5lZCBhZnRlciBhIHdpZGdldCBpbmhlcml0cyBmcm9tIGl0XG5cdFx0X2NoaWxkQ29uc3RydWN0b3JzOiBbXVxuXHR9ICk7XG5cblx0YmFzZVByb3RvdHlwZSA9IG5ldyBiYXNlKCk7XG5cblx0Ly8gV2UgbmVlZCB0byBtYWtlIHRoZSBvcHRpb25zIGhhc2ggYSBwcm9wZXJ0eSBkaXJlY3RseSBvbiB0aGUgbmV3IGluc3RhbmNlXG5cdC8vIG90aGVyd2lzZSB3ZSdsbCBtb2RpZnkgdGhlIG9wdGlvbnMgaGFzaCBvbiB0aGUgcHJvdG90eXBlIHRoYXQgd2UncmVcblx0Ly8gaW5oZXJpdGluZyBmcm9tXG5cdGJhc2VQcm90b3R5cGUub3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZCgge30sIGJhc2VQcm90b3R5cGUub3B0aW9ucyApO1xuXHQkLmVhY2goIHByb3RvdHlwZSwgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkge1xuXHRcdGlmICggISQuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHByb3hpZWRQcm90b3R5cGVbIHByb3AgXSA9IHZhbHVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRwcm94aWVkUHJvdG90eXBlWyBwcm9wIF0gPSAoIGZ1bmN0aW9uKCkge1xuXHRcdFx0ZnVuY3Rpb24gX3N1cGVyKCkge1xuXHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIF9zdXBlckFwcGx5KCBhcmdzICkge1xuXHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJncyApO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfX3N1cGVyID0gdGhpcy5fc3VwZXI7XG5cdFx0XHRcdHZhciBfX3N1cGVyQXBwbHkgPSB0aGlzLl9zdXBlckFwcGx5O1xuXHRcdFx0XHR2YXIgcmV0dXJuVmFsdWU7XG5cblx0XHRcdFx0dGhpcy5fc3VwZXIgPSBfc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfc3VwZXJBcHBseTtcblxuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHZhbHVlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9fc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfX3N1cGVyQXBwbHk7XG5cblx0XHRcdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHRcdFx0fTtcblx0XHR9ICkoKTtcblx0fSApO1xuXHRjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAkLndpZGdldC5leHRlbmQoIGJhc2VQcm90b3R5cGUsIHtcblxuXHRcdC8vIFRPRE86IHJlbW92ZSBzdXBwb3J0IGZvciB3aWRnZXRFdmVudFByZWZpeFxuXHRcdC8vIGFsd2F5cyB1c2UgdGhlIG5hbWUgKyBhIGNvbG9uIGFzIHRoZSBwcmVmaXgsIGUuZy4sIGRyYWdnYWJsZTpzdGFydFxuXHRcdC8vIGRvbid0IHByZWZpeCBmb3Igd2lkZ2V0cyB0aGF0IGFyZW4ndCBET00tYmFzZWRcblx0XHR3aWRnZXRFdmVudFByZWZpeDogZXhpc3RpbmdDb25zdHJ1Y3RvciA/ICggYmFzZVByb3RvdHlwZS53aWRnZXRFdmVudFByZWZpeCB8fCBuYW1lICkgOiBuYW1lXG5cdH0sIHByb3hpZWRQcm90b3R5cGUsIHtcblx0XHRjb25zdHJ1Y3RvcjogY29uc3RydWN0b3IsXG5cdFx0bmFtZXNwYWNlOiBuYW1lc3BhY2UsXG5cdFx0d2lkZ2V0TmFtZTogbmFtZSxcblx0XHR3aWRnZXRGdWxsTmFtZTogZnVsbE5hbWVcblx0fSApO1xuXG5cdC8vIElmIHRoaXMgd2lkZ2V0IGlzIGJlaW5nIHJlZGVmaW5lZCB0aGVuIHdlIG5lZWQgdG8gZmluZCBhbGwgd2lkZ2V0cyB0aGF0XG5cdC8vIGFyZSBpbmhlcml0aW5nIGZyb20gaXQgYW5kIHJlZGVmaW5lIGFsbCBvZiB0aGVtIHNvIHRoYXQgdGhleSBpbmhlcml0IGZyb21cblx0Ly8gdGhlIG5ldyB2ZXJzaW9uIG9mIHRoaXMgd2lkZ2V0LiBXZSdyZSBlc3NlbnRpYWxseSB0cnlpbmcgdG8gcmVwbGFjZSBvbmVcblx0Ly8gbGV2ZWwgaW4gdGhlIHByb3RvdHlwZSBjaGFpbi5cblx0aWYgKCBleGlzdGluZ0NvbnN0cnVjdG9yICkge1xuXHRcdCQuZWFjaCggZXhpc3RpbmdDb25zdHJ1Y3Rvci5fY2hpbGRDb25zdHJ1Y3RvcnMsIGZ1bmN0aW9uKCBpLCBjaGlsZCApIHtcblx0XHRcdHZhciBjaGlsZFByb3RvdHlwZSA9IGNoaWxkLnByb3RvdHlwZTtcblxuXHRcdFx0Ly8gUmVkZWZpbmUgdGhlIGNoaWxkIHdpZGdldCB1c2luZyB0aGUgc2FtZSBwcm90b3R5cGUgdGhhdCB3YXNcblx0XHRcdC8vIG9yaWdpbmFsbHkgdXNlZCwgYnV0IGluaGVyaXQgZnJvbSB0aGUgbmV3IHZlcnNpb24gb2YgdGhlIGJhc2Vcblx0XHRcdCQud2lkZ2V0KCBjaGlsZFByb3RvdHlwZS5uYW1lc3BhY2UgKyBcIi5cIiArIGNoaWxkUHJvdG90eXBlLndpZGdldE5hbWUsIGNvbnN0cnVjdG9yLFxuXHRcdFx0XHRjaGlsZC5fcHJvdG8gKTtcblx0XHR9ICk7XG5cblx0XHQvLyBSZW1vdmUgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgY2hpbGQgY29uc3RydWN0b3JzIGZyb20gdGhlIG9sZCBjb25zdHJ1Y3RvclxuXHRcdC8vIHNvIHRoZSBvbGQgY2hpbGQgY29uc3RydWN0b3JzIGNhbiBiZSBnYXJiYWdlIGNvbGxlY3RlZFxuXHRcdGRlbGV0ZSBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycztcblx0fSBlbHNlIHtcblx0XHRiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKCBjb25zdHJ1Y3RvciApO1xuXHR9XG5cblx0JC53aWRnZXQuYnJpZGdlKCBuYW1lLCBjb25zdHJ1Y3RvciApO1xuXG5cdHJldHVybiBjb25zdHJ1Y3Rvcjtcbn07XG5cbiQud2lkZ2V0LmV4dGVuZCA9IGZ1bmN0aW9uKCB0YXJnZXQgKSB7XG5cdHZhciBpbnB1dCA9IHdpZGdldFNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApO1xuXHR2YXIgaW5wdXRJbmRleCA9IDA7XG5cdHZhciBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblx0dmFyIGtleTtcblx0dmFyIHZhbHVlO1xuXG5cdGZvciAoIDsgaW5wdXRJbmRleCA8IGlucHV0TGVuZ3RoOyBpbnB1dEluZGV4KysgKSB7XG5cdFx0Zm9yICgga2V5IGluIGlucHV0WyBpbnB1dEluZGV4IF0gKSB7XG5cdFx0XHR2YWx1ZSA9IGlucHV0WyBpbnB1dEluZGV4IF1bIGtleSBdO1xuXHRcdFx0aWYgKCBpbnB1dFsgaW5wdXRJbmRleCBdLmhhc093blByb3BlcnR5KCBrZXkgKSAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdC8vIENsb25lIG9iamVjdHNcblx0XHRcdFx0aWYgKCAkLmlzUGxhaW5PYmplY3QoIHZhbHVlICkgKSB7XG5cdFx0XHRcdFx0dGFyZ2V0WyBrZXkgXSA9ICQuaXNQbGFpbk9iamVjdCggdGFyZ2V0WyBrZXkgXSApID9cblx0XHRcdFx0XHRcdCQud2lkZ2V0LmV4dGVuZCgge30sIHRhcmdldFsga2V5IF0sIHZhbHVlICkgOlxuXG5cdFx0XHRcdFx0XHQvLyBEb24ndCBleHRlbmQgc3RyaW5ncywgYXJyYXlzLCBldGMuIHdpdGggb2JqZWN0c1xuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdmFsdWUgKTtcblxuXHRcdFx0XHQvLyBDb3B5IGV2ZXJ5dGhpbmcgZWxzZSBieSByZWZlcmVuY2Vcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0YXJnZXRbIGtleSBdID0gdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHRhcmdldDtcbn07XG5cbiQud2lkZ2V0LmJyaWRnZSA9IGZ1bmN0aW9uKCBuYW1lLCBvYmplY3QgKSB7XG5cdHZhciBmdWxsTmFtZSA9IG9iamVjdC5wcm90b3R5cGUud2lkZ2V0RnVsbE5hbWUgfHwgbmFtZTtcblx0JC5mblsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0dmFyIGlzTWV0aG9kQ2FsbCA9IHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiO1xuXHRcdHZhciBhcmdzID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG5cdFx0dmFyIHJldHVyblZhbHVlID0gdGhpcztcblxuXHRcdGlmICggaXNNZXRob2RDYWxsICkge1xuXG5cdFx0XHQvLyBJZiB0aGlzIGlzIGFuIGVtcHR5IGNvbGxlY3Rpb24sIHdlIG5lZWQgdG8gaGF2ZSB0aGUgaW5zdGFuY2UgbWV0aG9kXG5cdFx0XHQvLyByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIGpRdWVyeSBpbnN0YW5jZVxuXHRcdFx0aWYgKCAhdGhpcy5sZW5ndGggJiYgb3B0aW9ucyA9PT0gXCJpbnN0YW5jZVwiICkge1xuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIG1ldGhvZFZhbHVlO1xuXHRcdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcblxuXHRcdFx0XHRcdGlmICggb3B0aW9ucyA9PT0gXCJpbnN0YW5jZVwiICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBpbnN0YW5jZTtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoICFpbnN0YW5jZSApIHtcblx0XHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gXCIgKyBuYW1lICtcblx0XHRcdFx0XHRcdFx0XCIgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb247IFwiICtcblx0XHRcdFx0XHRcdFx0XCJhdHRlbXB0ZWQgdG8gY2FsbCBtZXRob2QgJ1wiICsgb3B0aW9ucyArIFwiJ1wiICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCBpbnN0YW5jZVsgb3B0aW9ucyBdICkgfHwgb3B0aW9ucy5jaGFyQXQoIDAgKSA9PT0gXCJfXCIgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gJC5lcnJvciggXCJubyBzdWNoIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInIGZvciBcIiArIG5hbWUgK1xuXHRcdFx0XHRcdFx0XHRcIiB3aWRnZXQgaW5zdGFuY2VcIiApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG1ldGhvZFZhbHVlID0gaW5zdGFuY2VbIG9wdGlvbnMgXS5hcHBseSggaW5zdGFuY2UsIGFyZ3MgKTtcblxuXHRcdFx0XHRcdGlmICggbWV0aG9kVmFsdWUgIT09IGluc3RhbmNlICYmIG1ldGhvZFZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm5WYWx1ZSA9IG1ldGhvZFZhbHVlICYmIG1ldGhvZFZhbHVlLmpxdWVyeSA/XG5cdFx0XHRcdFx0XHRcdHJldHVyblZhbHVlLnB1c2hTdGFjayggbWV0aG9kVmFsdWUuZ2V0KCkgKSA6XG5cdFx0XHRcdFx0XHRcdG1ldGhvZFZhbHVlO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIEFsbG93IG11bHRpcGxlIGhhc2hlcyB0byBiZSBwYXNzZWQgb24gaW5pdFxuXHRcdFx0aWYgKCBhcmdzLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KCBhcmdzICkgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xuXHRcdFx0XHRpZiAoIGluc3RhbmNlICkge1xuXHRcdFx0XHRcdGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyB8fCB7fSApO1xuXHRcdFx0XHRcdGlmICggaW5zdGFuY2UuX2luaXQgKSB7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5faW5pdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lLCBuZXcgb2JqZWN0KCBvcHRpb25zLCB0aGlzICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXR1cm5WYWx1ZTtcblx0fTtcbn07XG5cbiQuV2lkZ2V0ID0gZnVuY3Rpb24oIC8qIG9wdGlvbnMsIGVsZW1lbnQgKi8gKSB7fTtcbiQuV2lkZ2V0Ll9jaGlsZENvbnN0cnVjdG9ycyA9IFtdO1xuXG4kLldpZGdldC5wcm90b3R5cGUgPSB7XG5cdHdpZGdldE5hbWU6IFwid2lkZ2V0XCIsXG5cdHdpZGdldEV2ZW50UHJlZml4OiBcIlwiLFxuXHRkZWZhdWx0RWxlbWVudDogXCI8ZGl2PlwiLFxuXG5cdG9wdGlvbnM6IHtcblx0XHRjbGFzc2VzOiB7fSxcblx0XHRkaXNhYmxlZDogZmFsc2UsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRjcmVhdGU6IG51bGxcblx0fSxcblxuXHRfY3JlYXRlV2lkZ2V0OiBmdW5jdGlvbiggb3B0aW9ucywgZWxlbWVudCApIHtcblx0XHRlbGVtZW50ID0gJCggZWxlbWVudCB8fCB0aGlzLmRlZmF1bHRFbGVtZW50IHx8IHRoaXMgKVsgMCBdO1xuXHRcdHRoaXMuZWxlbWVudCA9ICQoIGVsZW1lbnQgKTtcblx0XHR0aGlzLnV1aWQgPSB3aWRnZXRVdWlkKys7XG5cdFx0dGhpcy5ldmVudE5hbWVzcGFjZSA9IFwiLlwiICsgdGhpcy53aWRnZXROYW1lICsgdGhpcy51dWlkO1xuXG5cdFx0dGhpcy5iaW5kaW5ncyA9ICQoKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoKTtcblx0XHR0aGlzLmZvY3VzYWJsZSA9ICQoKTtcblx0XHR0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwID0ge307XG5cblx0XHRpZiAoIGVsZW1lbnQgIT09IHRoaXMgKSB7XG5cdFx0XHQkLmRhdGEoIGVsZW1lbnQsIHRoaXMud2lkZ2V0RnVsbE5hbWUsIHRoaXMgKTtcblx0XHRcdHRoaXMuX29uKCB0cnVlLCB0aGlzLmVsZW1lbnQsIHtcblx0XHRcdFx0cmVtb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdFx0aWYgKCBldmVudC50YXJnZXQgPT09IGVsZW1lbnQgKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHRcdHRoaXMuZG9jdW1lbnQgPSAkKCBlbGVtZW50LnN0eWxlID9cblxuXHRcdFx0XHQvLyBFbGVtZW50IHdpdGhpbiB0aGUgZG9jdW1lbnRcblx0XHRcdFx0ZWxlbWVudC5vd25lckRvY3VtZW50IDpcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIHdpbmRvdyBvciBkb2N1bWVudFxuXHRcdFx0XHRlbGVtZW50LmRvY3VtZW50IHx8IGVsZW1lbnQgKTtcblx0XHRcdHRoaXMud2luZG93ID0gJCggdGhpcy5kb2N1bWVudFsgMCBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbIDAgXS5wYXJlbnRXaW5kb3cgKTtcblx0XHR9XG5cblx0XHR0aGlzLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LFxuXHRcdFx0dGhpcy5vcHRpb25zLFxuXHRcdFx0dGhpcy5fZ2V0Q3JlYXRlT3B0aW9ucygpLFxuXHRcdFx0b3B0aW9ucyApO1xuXG5cdFx0dGhpcy5fY3JlYXRlKCk7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTtcblx0XHR9XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImNyZWF0ZVwiLCBudWxsLCB0aGlzLl9nZXRDcmVhdGVFdmVudERhdGEoKSApO1xuXHRcdHRoaXMuX2luaXQoKTtcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHt9O1xuXHR9LFxuXG5cdF9nZXRDcmVhdGVFdmVudERhdGE6ICQubm9vcCxcblxuXHRfY3JlYXRlOiAkLm5vb3AsXG5cblx0X2luaXQ6ICQubm9vcCxcblxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHR0aGlzLl9kZXN0cm95KCk7XG5cdFx0JC5lYWNoKCB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdHRoYXQuX3JlbW92ZUNsYXNzKCB2YWx1ZSwga2V5ICk7XG5cdFx0fSApO1xuXG5cdFx0Ly8gV2UgY2FuIHByb2JhYmx5IHJlbW92ZSB0aGUgdW5iaW5kIGNhbGxzIGluIDIuMFxuXHRcdC8vIGFsbCBldmVudCBiaW5kaW5ncyBzaG91bGQgZ28gdGhyb3VnaCB0aGlzLl9vbigpXG5cdFx0dGhpcy5lbGVtZW50XG5cdFx0XHQub2ZmKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcblx0XHRcdC5yZW1vdmVEYXRhKCB0aGlzLndpZGdldEZ1bGxOYW1lICk7XG5cdFx0dGhpcy53aWRnZXQoKVxuXHRcdFx0Lm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApXG5cdFx0XHQucmVtb3ZlQXR0ciggXCJhcmlhLWRpc2FibGVkXCIgKTtcblxuXHRcdC8vIENsZWFuIHVwIGV2ZW50cyBhbmQgc3RhdGVzXG5cdFx0dGhpcy5iaW5kaW5ncy5vZmYoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTtcblx0fSxcblxuXHRfZGVzdHJveTogJC5ub29wLFxuXG5cdHdpZGdldDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fSxcblxuXHRvcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdHZhciBvcHRpb25zID0ga2V5O1xuXHRcdHZhciBwYXJ0cztcblx0XHR2YXIgY3VyT3B0aW9uO1xuXHRcdHZhciBpO1xuXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHQvLyBEb24ndCByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGludGVybmFsIGhhc2hcblx0XHRcdHJldHVybiAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnMgKTtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIgKSB7XG5cblx0XHRcdC8vIEhhbmRsZSBuZXN0ZWQga2V5cywgZS5nLiwgXCJmb28uYmFyXCIgPT4geyBmb286IHsgYmFyOiBfX18gfSB9XG5cdFx0XHRvcHRpb25zID0ge307XG5cdFx0XHRwYXJ0cyA9IGtleS5zcGxpdCggXCIuXCIgKTtcblx0XHRcdGtleSA9IHBhcnRzLnNoaWZ0KCk7XG5cdFx0XHRpZiAoIHBhcnRzLmxlbmd0aCApIHtcblx0XHRcdFx0Y3VyT3B0aW9uID0gb3B0aW9uc1sga2V5IF0gPSAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnNbIGtleSBdICk7XG5cdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoIC0gMTsgaSsrICkge1xuXHRcdFx0XHRcdGN1ck9wdGlvblsgcGFydHNbIGkgXSBdID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gfHwge307XG5cdFx0XHRcdFx0Y3VyT3B0aW9uID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF07XG5cdFx0XHRcdH1cblx0XHRcdFx0a2V5ID0gcGFydHMucG9wKCk7XG5cdFx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSApIHtcblx0XHRcdFx0XHRyZXR1cm4gY3VyT3B0aW9uWyBrZXkgXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGN1ck9wdGlvblsga2V5IF07XG5cdFx0XHRcdH1cblx0XHRcdFx0Y3VyT3B0aW9uWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnNbIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogdGhpcy5vcHRpb25zWyBrZXkgXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRvcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuX3NldE9wdGlvbnMoIG9wdGlvbnMgKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIga2V5O1xuXG5cdFx0Zm9yICgga2V5IGluIG9wdGlvbnMgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb24oIGtleSwgb3B0aW9uc1sga2V5IF0gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJjbGFzc2VzXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25DbGFzc2VzKCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdHRoaXMub3B0aW9uc1sga2V5IF0gPSB2YWx1ZTtcblxuXHRcdGlmICgga2V5ID09PSBcImRpc2FibGVkXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25EaXNhYmxlZCggdmFsdWUgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uQ2xhc3NlczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc0tleSwgZWxlbWVudHMsIGN1cnJlbnRFbGVtZW50cztcblxuXHRcdGZvciAoIGNsYXNzS2V5IGluIHZhbHVlICkge1xuXHRcdFx0Y3VycmVudEVsZW1lbnRzID0gdGhpcy5jbGFzc2VzRWxlbWVudExvb2t1cFsgY2xhc3NLZXkgXTtcblx0XHRcdGlmICggdmFsdWVbIGNsYXNzS2V5IF0gPT09IHRoaXMub3B0aW9ucy5jbGFzc2VzWyBjbGFzc0tleSBdIHx8XG5cdFx0XHRcdFx0IWN1cnJlbnRFbGVtZW50cyB8fFxuXHRcdFx0XHRcdCFjdXJyZW50RWxlbWVudHMubGVuZ3RoICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gV2UgYXJlIGRvaW5nIHRoaXMgdG8gY3JlYXRlIGEgbmV3IGpRdWVyeSBvYmplY3QgYmVjYXVzZSB0aGUgX3JlbW92ZUNsYXNzKCkgY2FsbFxuXHRcdFx0Ly8gb24gdGhlIG5leHQgbGluZSBpcyBnb2luZyB0byBkZXN0cm95IHRoZSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgZWxlbWVudHMgYmVpbmdcblx0XHRcdC8vIHRyYWNrZWQuIFdlIG5lZWQgdG8gc2F2ZSBhIGNvcHkgb2YgdGhpcyBjb2xsZWN0aW9uIHNvIHRoYXQgd2UgY2FuIGFkZCB0aGUgbmV3IGNsYXNzZXNcblx0XHRcdC8vIGJlbG93LlxuXHRcdFx0ZWxlbWVudHMgPSAkKCBjdXJyZW50RWxlbWVudHMuZ2V0KCkgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCBjdXJyZW50RWxlbWVudHMsIGNsYXNzS2V5ICk7XG5cblx0XHRcdC8vIFdlIGRvbid0IHVzZSBfYWRkQ2xhc3MoKSBoZXJlLCBiZWNhdXNlIHRoYXQgdXNlcyB0aGlzLm9wdGlvbnMuY2xhc3Nlc1xuXHRcdFx0Ly8gZm9yIGdlbmVyYXRpbmcgdGhlIHN0cmluZyBvZiBjbGFzc2VzLiBXZSB3YW50IHRvIHVzZSB0aGUgdmFsdWUgcGFzc2VkIGluIGZyb21cblx0XHRcdC8vIF9zZXRPcHRpb24oKSwgdGhpcyBpcyB0aGUgbmV3IHZhbHVlIG9mIHRoZSBjbGFzc2VzIG9wdGlvbiB3aGljaCB3YXMgcGFzc2VkIHRvXG5cdFx0XHQvLyBfc2V0T3B0aW9uKCkuIFdlIHBhc3MgdGhpcyB2YWx1ZSBkaXJlY3RseSB0byBfY2xhc3NlcygpLlxuXHRcdFx0ZWxlbWVudHMuYWRkQ2xhc3MoIHRoaXMuX2NsYXNzZXMoIHtcblx0XHRcdFx0ZWxlbWVudDogZWxlbWVudHMsXG5cdFx0XHRcdGtleXM6IGNsYXNzS2V5LFxuXHRcdFx0XHRjbGFzc2VzOiB2YWx1ZSxcblx0XHRcdFx0YWRkOiB0cnVlXG5cdFx0XHR9ICkgKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIHRoaXMud2lkZ2V0KCksIHRoaXMud2lkZ2V0RnVsbE5hbWUgKyBcIi1kaXNhYmxlZFwiLCBudWxsLCAhIXZhbHVlICk7XG5cblx0XHQvLyBJZiB0aGUgd2lkZ2V0IGlzIGJlY29taW5nIGRpc2FibGVkLCB0aGVuIG5vdGhpbmcgaXMgaW50ZXJhY3RpdmVcblx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaG92ZXJhYmxlLCBudWxsLCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmZvY3VzYWJsZSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0fVxuXHR9LFxuXG5cdGVuYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IGZhbHNlIH0gKTtcblx0fSxcblxuXHRkaXNhYmxlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogdHJ1ZSB9ICk7XG5cdH0sXG5cblx0X2NsYXNzZXM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciBmdWxsID0gW107XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0b3B0aW9ucyA9ICQuZXh0ZW5kKCB7XG5cdFx0XHRlbGVtZW50OiB0aGlzLmVsZW1lbnQsXG5cdFx0XHRjbGFzc2VzOiB0aGlzLm9wdGlvbnMuY2xhc3NlcyB8fCB7fVxuXHRcdH0sIG9wdGlvbnMgKTtcblxuXHRcdGZ1bmN0aW9uIHByb2Nlc3NDbGFzc1N0cmluZyggY2xhc3NlcywgY2hlY2tPcHRpb24gKSB7XG5cdFx0XHR2YXIgY3VycmVudCwgaTtcblx0XHRcdGZvciAoIGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0Y3VycmVudCA9IHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdIHx8ICQoKTtcblx0XHRcdFx0aWYgKCBvcHRpb25zLmFkZCApIHtcblx0XHRcdFx0XHRjdXJyZW50ID0gJCggJC51bmlxdWUoIGN1cnJlbnQuZ2V0KCkuY29uY2F0KCBvcHRpb25zLmVsZW1lbnQuZ2V0KCkgKSApICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y3VycmVudCA9ICQoIGN1cnJlbnQubm90KCBvcHRpb25zLmVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdID0gY3VycmVudDtcblx0XHRcdFx0ZnVsbC5wdXNoKCBjbGFzc2VzWyBpIF0gKTtcblx0XHRcdFx0aWYgKCBjaGVja09wdGlvbiAmJiBvcHRpb25zLmNsYXNzZXNbIGNsYXNzZXNbIGkgXSBdICkge1xuXHRcdFx0XHRcdGZ1bGwucHVzaCggb3B0aW9ucy5jbGFzc2VzWyBjbGFzc2VzWyBpIF0gXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fb24oIG9wdGlvbnMuZWxlbWVudCwge1xuXHRcdFx0XCJyZW1vdmVcIjogXCJfdW50cmFja0NsYXNzZXNFbGVtZW50XCJcblx0XHR9ICk7XG5cblx0XHRpZiAoIG9wdGlvbnMua2V5cyApIHtcblx0XHRcdHByb2Nlc3NDbGFzc1N0cmluZyggb3B0aW9ucy5rZXlzLm1hdGNoKCAvXFxTKy9nICkgfHwgW10sIHRydWUgKTtcblx0XHR9XG5cdFx0aWYgKCBvcHRpb25zLmV4dHJhICkge1xuXHRcdFx0cHJvY2Vzc0NsYXNzU3RyaW5nKCBvcHRpb25zLmV4dHJhLm1hdGNoKCAvXFxTKy9nICkgfHwgW10gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZnVsbC5qb2luKCBcIiBcIiApO1xuXHR9LFxuXG5cdF91bnRyYWNrQ2xhc3Nlc0VsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cdFx0JC5lYWNoKCB0aGF0LmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdGlmICggJC5pbkFycmF5KCBldmVudC50YXJnZXQsIHZhbHVlICkgIT09IC0xICkge1xuXHRcdFx0XHR0aGF0LmNsYXNzZXNFbGVtZW50TG9va3VwWyBrZXkgXSA9ICQoIHZhbHVlLm5vdCggZXZlbnQudGFyZ2V0ICkuZ2V0KCkgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X3JlbW92ZUNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEgKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3RvZ2dsZUNsYXNzKCBlbGVtZW50LCBrZXlzLCBleHRyYSwgZmFsc2UgKTtcblx0fSxcblxuXHRfYWRkQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSApIHtcblx0XHRyZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3MoIGVsZW1lbnQsIGtleXMsIGV4dHJhLCB0cnVlICk7XG5cdH0sXG5cblx0X3RvZ2dsZUNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEsIGFkZCApIHtcblx0XHRhZGQgPSAoIHR5cGVvZiBhZGQgPT09IFwiYm9vbGVhblwiICkgPyBhZGQgOiBleHRyYTtcblx0XHR2YXIgc2hpZnQgPSAoIHR5cGVvZiBlbGVtZW50ID09PSBcInN0cmluZ1wiIHx8IGVsZW1lbnQgPT09IG51bGwgKSxcblx0XHRcdG9wdGlvbnMgPSB7XG5cdFx0XHRcdGV4dHJhOiBzaGlmdCA/IGtleXMgOiBleHRyYSxcblx0XHRcdFx0a2V5czogc2hpZnQgPyBlbGVtZW50IDoga2V5cyxcblx0XHRcdFx0ZWxlbWVudDogc2hpZnQgPyB0aGlzLmVsZW1lbnQgOiBlbGVtZW50LFxuXHRcdFx0XHRhZGQ6IGFkZFxuXHRcdFx0fTtcblx0XHRvcHRpb25zLmVsZW1lbnQudG9nZ2xlQ2xhc3MoIHRoaXMuX2NsYXNzZXMoIG9wdGlvbnMgKSwgYWRkICk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X29uOiBmdW5jdGlvbiggc3VwcHJlc3NEaXNhYmxlZENoZWNrLCBlbGVtZW50LCBoYW5kbGVycyApIHtcblx0XHR2YXIgZGVsZWdhdGVFbGVtZW50O1xuXHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cblx0XHQvLyBObyBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgZmxhZywgc2h1ZmZsZSBhcmd1bWVudHNcblx0XHRpZiAoIHR5cGVvZiBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgIT09IFwiYm9vbGVhblwiICkge1xuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xuXHRcdFx0ZWxlbWVudCA9IHN1cHByZXNzRGlzYWJsZWRDaGVjaztcblx0XHRcdHN1cHByZXNzRGlzYWJsZWRDaGVjayA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8vIE5vIGVsZW1lbnQgYXJndW1lbnQsIHNodWZmbGUgYW5kIHVzZSB0aGlzLmVsZW1lbnRcblx0XHRpZiAoICFoYW5kbGVycyApIHtcblx0XHRcdGhhbmRsZXJzID0gZWxlbWVudDtcblx0XHRcdGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG5cdFx0XHRkZWxlZ2F0ZUVsZW1lbnQgPSB0aGlzLndpZGdldCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbGVtZW50ID0gZGVsZWdhdGVFbGVtZW50ID0gJCggZWxlbWVudCApO1xuXHRcdFx0dGhpcy5iaW5kaW5ncyA9IHRoaXMuYmluZGluZ3MuYWRkKCBlbGVtZW50ICk7XG5cdFx0fVxuXG5cdFx0JC5lYWNoKCBoYW5kbGVycywgZnVuY3Rpb24oIGV2ZW50LCBoYW5kbGVyICkge1xuXHRcdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xuXG5cdFx0XHRcdC8vIEFsbG93IHdpZGdldHMgdG8gY3VzdG9taXplIHRoZSBkaXNhYmxlZCBoYW5kbGluZ1xuXHRcdFx0XHQvLyAtIGRpc2FibGVkIGFzIGFuIGFycmF5IGluc3RlYWQgb2YgYm9vbGVhblxuXHRcdFx0XHQvLyAtIGRpc2FibGVkIGNsYXNzIGFzIG1ldGhvZCBmb3IgZGlzYWJsaW5nIGluZGl2aWR1YWwgcGFydHNcblx0XHRcdFx0aWYgKCAhc3VwcHJlc3NEaXNhYmxlZENoZWNrICYmXG5cdFx0XHRcdFx0XHQoIGluc3RhbmNlLm9wdGlvbnMuZGlzYWJsZWQgPT09IHRydWUgfHxcblx0XHRcdFx0XHRcdCQoIHRoaXMgKS5oYXNDbGFzcyggXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiICkgKSApIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXG5cdFx0XHRcdFx0LmFwcGx5KCBpbnN0YW5jZSwgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENvcHkgdGhlIGd1aWQgc28gZGlyZWN0IHVuYmluZGluZyB3b3Jrc1xuXHRcdFx0aWYgKCB0eXBlb2YgaGFuZGxlciAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0aGFuZGxlclByb3h5Lmd1aWQgPSBoYW5kbGVyLmd1aWQgPVxuXHRcdFx0XHRcdGhhbmRsZXIuZ3VpZCB8fCBoYW5kbGVyUHJveHkuZ3VpZCB8fCAkLmd1aWQrKztcblx0XHRcdH1cblxuXHRcdFx0dmFyIG1hdGNoID0gZXZlbnQubWF0Y2goIC9eKFtcXHc6LV0qKVxccyooLiopJC8gKTtcblx0XHRcdHZhciBldmVudE5hbWUgPSBtYXRjaFsgMSBdICsgaW5zdGFuY2UuZXZlbnROYW1lc3BhY2U7XG5cdFx0XHR2YXIgc2VsZWN0b3IgPSBtYXRjaFsgMiBdO1xuXG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xuXHRcdFx0XHRkZWxlZ2F0ZUVsZW1lbnQub24oIGV2ZW50TmFtZSwgc2VsZWN0b3IsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudC5vbiggZXZlbnROYW1lLCBoYW5kbGVyUHJveHkgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X29mZjogZnVuY3Rpb24oIGVsZW1lbnQsIGV2ZW50TmFtZSApIHtcblx0XHRldmVudE5hbWUgPSAoIGV2ZW50TmFtZSB8fCBcIlwiICkuc3BsaXQoIFwiIFwiICkuam9pbiggdGhpcy5ldmVudE5hbWVzcGFjZSArIFwiIFwiICkgK1xuXHRcdFx0dGhpcy5ldmVudE5hbWVzcGFjZTtcblx0XHRlbGVtZW50Lm9mZiggZXZlbnROYW1lICkub2ZmKCBldmVudE5hbWUgKTtcblxuXHRcdC8vIENsZWFyIHRoZSBzdGFjayB0byBhdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1Nilcblx0XHR0aGlzLmJpbmRpbmdzID0gJCggdGhpcy5iaW5kaW5ncy5ub3QoIGVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCggdGhpcy5mb2N1c2FibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoIHRoaXMuaG92ZXJhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7XG5cdH0sXG5cblx0X2RlbGF5OiBmdW5jdGlvbiggaGFuZGxlciwgZGVsYXkgKSB7XG5cdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xuXHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXG5cdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdHJldHVybiBzZXRUaW1lb3V0KCBoYW5kbGVyUHJveHksIGRlbGF5IHx8IDAgKTtcblx0fSxcblxuXHRfaG92ZXJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR0aGlzLmhvdmVyYWJsZSA9IHRoaXMuaG92ZXJhYmxlLmFkZCggZWxlbWVudCApO1xuXHRcdHRoaXMuX29uKCBlbGVtZW50LCB7XG5cdFx0XHRtb3VzZWVudGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX2FkZENsYXNzKCAkKCBldmVudC5jdXJyZW50VGFyZ2V0ICksIG51bGwsIFwidWktc3RhdGUtaG92ZXJcIiApO1xuXHRcdFx0fSxcblx0XHRcdG1vdXNlbGVhdmU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9mb2N1c2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gdGhpcy5mb2N1c2FibGUuYWRkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcblx0XHRcdGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fYWRkQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0XHR9LFxuXHRcdFx0Zm9jdXNvdXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF90cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZXZlbnQsIGRhdGEgKSB7XG5cdFx0dmFyIHByb3AsIG9yaWc7XG5cdFx0dmFyIGNhbGxiYWNrID0gdGhpcy5vcHRpb25zWyB0eXBlIF07XG5cblx0XHRkYXRhID0gZGF0YSB8fCB7fTtcblx0XHRldmVudCA9ICQuRXZlbnQoIGV2ZW50ICk7XG5cdFx0ZXZlbnQudHlwZSA9ICggdHlwZSA9PT0gdGhpcy53aWRnZXRFdmVudFByZWZpeCA/XG5cdFx0XHR0eXBlIDpcblx0XHRcdHRoaXMud2lkZ2V0RXZlbnRQcmVmaXggKyB0eXBlICkudG9Mb3dlckNhc2UoKTtcblxuXHRcdC8vIFRoZSBvcmlnaW5hbCBldmVudCBtYXkgY29tZSBmcm9tIGFueSBlbGVtZW50XG5cdFx0Ly8gc28gd2UgbmVlZCB0byByZXNldCB0aGUgdGFyZ2V0IG9uIHRoZSBuZXcgZXZlbnRcblx0XHRldmVudC50YXJnZXQgPSB0aGlzLmVsZW1lbnRbIDAgXTtcblxuXHRcdC8vIENvcHkgb3JpZ2luYWwgZXZlbnQgcHJvcGVydGllcyBvdmVyIHRvIHRoZSBuZXcgZXZlbnRcblx0XHRvcmlnID0gZXZlbnQub3JpZ2luYWxFdmVudDtcblx0XHRpZiAoIG9yaWcgKSB7XG5cdFx0XHRmb3IgKCBwcm9wIGluIG9yaWcgKSB7XG5cdFx0XHRcdGlmICggISggcHJvcCBpbiBldmVudCApICkge1xuXHRcdFx0XHRcdGV2ZW50WyBwcm9wIF0gPSBvcmlnWyBwcm9wIF07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggZXZlbnQsIGRhdGEgKTtcblx0XHRyZXR1cm4gISggJC5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICYmXG5cdFx0XHRjYWxsYmFjay5hcHBseSggdGhpcy5lbGVtZW50WyAwIF0sIFsgZXZlbnQgXS5jb25jYXQoIGRhdGEgKSApID09PSBmYWxzZSB8fFxuXHRcdFx0ZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKTtcblx0fVxufTtcblxuJC5lYWNoKCB7IHNob3c6IFwiZmFkZUluXCIsIGhpZGU6IFwiZmFkZU91dFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIGRlZmF1bHRFZmZlY3QgKSB7XG5cdCQuV2lkZ2V0LnByb3RvdHlwZVsgXCJfXCIgKyBtZXRob2QgXSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zLCBjYWxsYmFjayApIHtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZWZmZWN0OiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0dmFyIGhhc09wdGlvbnM7XG5cdFx0dmFyIGVmZmVjdE5hbWUgPSAhb3B0aW9ucyA/XG5cdFx0XHRtZXRob2QgOlxuXHRcdFx0b3B0aW9ucyA9PT0gdHJ1ZSB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiA/XG5cdFx0XHRcdGRlZmF1bHRFZmZlY3QgOlxuXHRcdFx0XHRvcHRpb25zLmVmZmVjdCB8fCBkZWZhdWx0RWZmZWN0O1xuXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0aWYgKCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiApIHtcblx0XHRcdG9wdGlvbnMgPSB7IGR1cmF0aW9uOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0aGFzT3B0aW9ucyA9ICEkLmlzRW1wdHlPYmplY3QoIG9wdGlvbnMgKTtcblx0XHRvcHRpb25zLmNvbXBsZXRlID0gY2FsbGJhY2s7XG5cblx0XHRpZiAoIG9wdGlvbnMuZGVsYXkgKSB7XG5cdFx0XHRlbGVtZW50LmRlbGF5KCBvcHRpb25zLmRlbGF5ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBoYXNPcHRpb25zICYmICQuZWZmZWN0cyAmJiAkLmVmZmVjdHMuZWZmZWN0WyBlZmZlY3ROYW1lIF0gKSB7XG5cdFx0XHRlbGVtZW50WyBtZXRob2QgXSggb3B0aW9ucyApO1xuXHRcdH0gZWxzZSBpZiAoIGVmZmVjdE5hbWUgIT09IG1ldGhvZCAmJiBlbGVtZW50WyBlZmZlY3ROYW1lIF0gKSB7XG5cdFx0XHRlbGVtZW50WyBlZmZlY3ROYW1lIF0oIG9wdGlvbnMuZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nLCBjYWxsYmFjayApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbGVtZW50LnF1ZXVlKCBmdW5jdGlvbiggbmV4dCApIHtcblx0XHRcdFx0JCggdGhpcyApWyBtZXRob2QgXSgpO1xuXHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoIGVsZW1lbnRbIDAgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG5leHQoKTtcblx0XHRcdH0gKTtcblx0XHR9XG5cdH07XG59ICk7XG5cbnZhciB3aWRnZXQgPSAkLndpZGdldDtcblxuXG4vKiFcbiAqIGpRdWVyeSBVSSA6ZGF0YSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogOmRhdGEgU2VsZWN0b3Jcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBTZWxlY3RzIGVsZW1lbnRzIHdoaWNoIGhhdmUgZGF0YSBzdG9yZWQgdW5kZXIgdGhlIHNwZWNpZmllZCBrZXkuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGF0YS1zZWxlY3Rvci9cblxuXG52YXIgZGF0YSA9ICQuZXh0ZW5kKCAkLmV4cHJbIFwiOlwiIF0sIHtcblx0ZGF0YTogJC5leHByLmNyZWF0ZVBzZXVkbyA/XG5cdFx0JC5leHByLmNyZWF0ZVBzZXVkbyggZnVuY3Rpb24oIGRhdGFOYW1lICkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGRhdGFOYW1lICk7XG5cdFx0XHR9O1xuXHRcdH0gKSA6XG5cblx0XHQvLyBTdXBwb3J0OiBqUXVlcnkgPDEuOFxuXHRcdGZ1bmN0aW9uKCBlbGVtLCBpLCBtYXRjaCApIHtcblx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgbWF0Y2hbIDMgXSApO1xuXHRcdH1cbn0gKTtcblxuLyohXG4gKiBqUXVlcnkgVUkgU3VwcG9ydCBmb3IgalF1ZXJ5IGNvcmUgMS43LnggMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKi9cblxuLy8+PmxhYmVsOiBqUXVlcnkgMS43IFN1cHBvcnRcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBTdXBwb3J0IHZlcnNpb24gMS43Lnggb2YgalF1ZXJ5IGNvcmVcblxuXG5cbi8vIFN1cHBvcnQ6IGpRdWVyeSAxLjcgb25seVxuLy8gTm90IGEgZ3JlYXQgd2F5IHRvIGNoZWNrIHZlcnNpb25zLCBidXQgc2luY2Ugd2Ugb25seSBzdXBwb3J0IDEuNysgYW5kIG9ubHlcbi8vIG5lZWQgdG8gZGV0ZWN0IDwxLjgsIHRoaXMgaXMgYSBzaW1wbGUgY2hlY2sgdGhhdCBzaG91bGQgc3VmZmljZS4gQ2hlY2tpbmdcbi8vIGZvciBcIjEuNy5cIiB3b3VsZCBiZSBhIGJpdCBzYWZlciwgYnV0IHRoZSB2ZXJzaW9uIHN0cmluZyBpcyAxLjcsIG5vdCAxLjcuMFxuLy8gYW5kIHdlJ2xsIG5ldmVyIHJlYWNoIDEuNzAuMCAoaWYgd2UgZG8sIHdlIGNlcnRhaW5seSB3b24ndCBiZSBzdXBwb3J0aW5nXG4vLyAxLjcgYW55bW9yZSkuIFNlZSAjMTExOTcgZm9yIHdoeSB3ZSdyZSBub3QgdXNpbmcgZmVhdHVyZSBkZXRlY3Rpb24uXG5pZiAoICQuZm4uanF1ZXJ5LnN1YnN0cmluZyggMCwgMyApID09PSBcIjEuN1wiICkge1xuXG5cdC8vIFNldHRlcnMgZm9yIC5pbm5lcldpZHRoKCksIC5pbm5lckhlaWdodCgpLCAub3V0ZXJXaWR0aCgpLCAub3V0ZXJIZWlnaHQoKVxuXHQvLyBVbmxpa2UgalF1ZXJ5IENvcmUgMS44KywgdGhlc2Ugb25seSBzdXBwb3J0IG51bWVyaWMgdmFsdWVzIHRvIHNldCB0aGVcblx0Ly8gZGltZW5zaW9ucyBpbiBwaXhlbHNcblx0JC5lYWNoKCBbIFwiV2lkdGhcIiwgXCJIZWlnaHRcIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHtcblx0XHR2YXIgc2lkZSA9IG5hbWUgPT09IFwiV2lkdGhcIiA/IFsgXCJMZWZ0XCIsIFwiUmlnaHRcIiBdIDogWyBcIlRvcFwiLCBcIkJvdHRvbVwiIF0sXG5cdFx0XHR0eXBlID0gbmFtZS50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0b3JpZyA9IHtcblx0XHRcdFx0aW5uZXJXaWR0aDogJC5mbi5pbm5lcldpZHRoLFxuXHRcdFx0XHRpbm5lckhlaWdodDogJC5mbi5pbm5lckhlaWdodCxcblx0XHRcdFx0b3V0ZXJXaWR0aDogJC5mbi5vdXRlcldpZHRoLFxuXHRcdFx0XHRvdXRlckhlaWdodDogJC5mbi5vdXRlckhlaWdodFxuXHRcdFx0fTtcblxuXHRcdGZ1bmN0aW9uIHJlZHVjZSggZWxlbSwgc2l6ZSwgYm9yZGVyLCBtYXJnaW4gKSB7XG5cdFx0XHQkLmVhY2goIHNpZGUsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzaXplIC09IHBhcnNlRmxvYXQoICQuY3NzKCBlbGVtLCBcInBhZGRpbmdcIiArIHRoaXMgKSApIHx8IDA7XG5cdFx0XHRcdGlmICggYm9yZGVyICkge1xuXHRcdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwiYm9yZGVyXCIgKyB0aGlzICsgXCJXaWR0aFwiICkgKSB8fCAwO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggbWFyZ2luICkge1xuXHRcdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwibWFyZ2luXCIgKyB0aGlzICkgKSB8fCAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0XHRyZXR1cm4gc2l6ZTtcblx0XHR9XG5cblx0XHQkLmZuWyBcImlubmVyXCIgKyBuYW1lIF0gPSBmdW5jdGlvbiggc2l6ZSApIHtcblx0XHRcdGlmICggc2l6ZSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gb3JpZ1sgXCJpbm5lclwiICsgbmFtZSBdLmNhbGwoIHRoaXMgKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5jc3MoIHR5cGUsIHJlZHVjZSggdGhpcywgc2l6ZSApICsgXCJweFwiICk7XG5cdFx0XHR9ICk7XG5cdFx0fTtcblxuXHRcdCQuZm5bIFwib3V0ZXJcIiArIG5hbWUgXSA9IGZ1bmN0aW9uKCBzaXplLCBtYXJnaW4gKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBzaXplICE9PSBcIm51bWJlclwiICkge1xuXHRcdFx0XHRyZXR1cm4gb3JpZ1sgXCJvdXRlclwiICsgbmFtZSBdLmNhbGwoIHRoaXMsIHNpemUgKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5jc3MoIHR5cGUsIHJlZHVjZSggdGhpcywgc2l6ZSwgdHJ1ZSwgbWFyZ2luICkgKyBcInB4XCIgKTtcblx0XHRcdH0gKTtcblx0XHR9O1xuXHR9ICk7XG5cblx0JC5mbi5hZGRCYWNrID0gZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiB0aGlzLmFkZCggc2VsZWN0b3IgPT0gbnVsbCA/XG5cdFx0XHR0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKCBzZWxlY3RvciApXG5cdFx0KTtcblx0fTtcbn1cblxuO1xuLyohXG4gKiBqUXVlcnkgVUkgS2V5Y29kZSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogS2V5Y29kZVxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFByb3ZpZGUga2V5Y29kZXMgYXMga2V5bmFtZXNcbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkudWkua2V5Q29kZS9cblxuXG52YXIga2V5Y29kZSA9ICQudWkua2V5Q29kZSA9IHtcblx0QkFDS1NQQUNFOiA4LFxuXHRDT01NQTogMTg4LFxuXHRERUxFVEU6IDQ2LFxuXHRET1dOOiA0MCxcblx0RU5EOiAzNSxcblx0RU5URVI6IDEzLFxuXHRFU0NBUEU6IDI3LFxuXHRIT01FOiAzNixcblx0TEVGVDogMzcsXG5cdFBBR0VfRE9XTjogMzQsXG5cdFBBR0VfVVA6IDMzLFxuXHRQRVJJT0Q6IDE5MCxcblx0UklHSFQ6IDM5LFxuXHRTUEFDRTogMzIsXG5cdFRBQjogOSxcblx0VVA6IDM4XG59O1xuXG5cbi8qIVxuICogalF1ZXJ5IFVJIFNjcm9sbCBQYXJlbnQgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IHNjcm9sbFBhcmVudFxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IEdldCB0aGUgY2xvc2VzdCBhbmNlc3RvciBlbGVtZW50IHRoYXQgaXMgc2Nyb2xsYWJsZS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zY3JvbGxQYXJlbnQvXG5cblxuXG52YXIgc2Nyb2xsUGFyZW50ID0gJC5mbi5zY3JvbGxQYXJlbnQgPSBmdW5jdGlvbiggaW5jbHVkZUhpZGRlbiApIHtcblx0dmFyIHBvc2l0aW9uID0gdGhpcy5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdGV4Y2x1ZGVTdGF0aWNQYXJlbnQgPSBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiLFxuXHRcdG92ZXJmbG93UmVnZXggPSBpbmNsdWRlSGlkZGVuID8gLyhhdXRvfHNjcm9sbHxoaWRkZW4pLyA6IC8oYXV0b3xzY3JvbGwpLyxcblx0XHRzY3JvbGxQYXJlbnQgPSB0aGlzLnBhcmVudHMoKS5maWx0ZXIoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHBhcmVudCA9ICQoIHRoaXMgKTtcblx0XHRcdGlmICggZXhjbHVkZVN0YXRpY1BhcmVudCAmJiBwYXJlbnQuY3NzKCBcInBvc2l0aW9uXCIgKSA9PT0gXCJzdGF0aWNcIiApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG92ZXJmbG93UmVnZXgudGVzdCggcGFyZW50LmNzcyggXCJvdmVyZmxvd1wiICkgKyBwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXlcIiApICtcblx0XHRcdFx0cGFyZW50LmNzcyggXCJvdmVyZmxvdy14XCIgKSApO1xuXHRcdH0gKS5lcSggMCApO1xuXG5cdHJldHVybiBwb3NpdGlvbiA9PT0gXCJmaXhlZFwiIHx8ICFzY3JvbGxQYXJlbnQubGVuZ3RoID9cblx0XHQkKCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApIDpcblx0XHRzY3JvbGxQYXJlbnQ7XG59O1xuXG5cblxuXG4vLyBUaGlzIGZpbGUgaXMgZGVwcmVjYXRlZFxudmFyIGllID0gJC51aS5pZSA9ICEhL21zaWUgW1xcdy5dKy8uZXhlYyggbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpICk7XG5cbi8qIVxuICogalF1ZXJ5IFVJIE1vdXNlIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBNb3VzZVxuLy8+Pmdyb3VwOiBXaWRnZXRzXG4vLz4+ZGVzY3JpcHRpb246IEFic3RyYWN0cyBtb3VzZS1iYXNlZCBpbnRlcmFjdGlvbnMgdG8gYXNzaXN0IGluIGNyZWF0aW5nIGNlcnRhaW4gd2lkZ2V0cy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9tb3VzZS9cblxuXG5cbnZhciBtb3VzZUhhbmRsZWQgPSBmYWxzZTtcbiQoIGRvY3VtZW50ICkub24oIFwibW91c2V1cFwiLCBmdW5jdGlvbigpIHtcblx0bW91c2VIYW5kbGVkID0gZmFsc2U7XG59ICk7XG5cbnZhciB3aWRnZXRzTW91c2UgPSAkLndpZGdldCggXCJ1aS5tb3VzZVwiLCB7XG5cdHZlcnNpb246IFwiMS4xMi4xXCIsXG5cdG9wdGlvbnM6IHtcblx0XHRjYW5jZWw6IFwiaW5wdXQsIHRleHRhcmVhLCBidXR0b24sIHNlbGVjdCwgb3B0aW9uXCIsXG5cdFx0ZGlzdGFuY2U6IDEsXG5cdFx0ZGVsYXk6IDBcblx0fSxcblx0X21vdXNlSW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0dGhpcy5lbGVtZW50XG5cdFx0XHQub24oIFwibW91c2Vkb3duLlwiICsgdGhpcy53aWRnZXROYW1lLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZURvd24oIGV2ZW50ICk7XG5cdFx0XHR9IClcblx0XHRcdC5vbiggXCJjbGljay5cIiArIHRoaXMud2lkZ2V0TmFtZSwgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRpZiAoIHRydWUgPT09ICQuZGF0YSggZXZlbnQudGFyZ2V0LCB0aGF0LndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiICkgKSB7XG5cdFx0XHRcdFx0JC5yZW1vdmVEYXRhKCBldmVudC50YXJnZXQsIHRoYXQud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKTtcblx0XHRcdFx0XHRldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblxuXHRcdHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuXHR9LFxuXG5cdC8vIFRPRE86IG1ha2Ugc3VyZSBkZXN0cm95aW5nIG9uZSBpbnN0YW5jZSBvZiBtb3VzZSBkb2Vzbid0IG1lc3Mgd2l0aFxuXHQvLyBvdGhlciBpbnN0YW5jZXMgb2YgbW91c2Vcblx0X21vdXNlRGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbGVtZW50Lm9mZiggXCIuXCIgKyB0aGlzLndpZGdldE5hbWUgKTtcblx0XHRpZiAoIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlICkge1xuXHRcdFx0dGhpcy5kb2N1bWVudFxuXHRcdFx0XHQub2ZmKCBcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKVxuXHRcdFx0XHQub2ZmKCBcIm1vdXNldXAuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSApO1xuXHRcdH1cblx0fSxcblxuXHRfbW91c2VEb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBkb24ndCBsZXQgbW9yZSB0aGFuIG9uZSB3aWRnZXQgaGFuZGxlIG1vdXNlU3RhcnRcblx0XHRpZiAoIG1vdXNlSGFuZGxlZCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9tb3VzZU1vdmVkID0gZmFsc2U7XG5cblx0XHQvLyBXZSBtYXkgaGF2ZSBtaXNzZWQgbW91c2V1cCAob3V0IG9mIHdpbmRvdylcblx0XHQoIHRoaXMuX21vdXNlU3RhcnRlZCAmJiB0aGlzLl9tb3VzZVVwKCBldmVudCApICk7XG5cblx0XHR0aGlzLl9tb3VzZURvd25FdmVudCA9IGV2ZW50O1xuXG5cdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0YnRuSXNMZWZ0ID0gKCBldmVudC53aGljaCA9PT0gMSApLFxuXG5cdFx0XHQvLyBldmVudC50YXJnZXQubm9kZU5hbWUgd29ya3MgYXJvdW5kIGEgYnVnIGluIElFIDggd2l0aFxuXHRcdFx0Ly8gZGlzYWJsZWQgaW5wdXRzICgjNzYyMClcblx0XHRcdGVsSXNDYW5jZWwgPSAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuY2FuY2VsID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnRhcmdldC5ub2RlTmFtZSA/XG5cdFx0XHRcdCQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIHRoaXMub3B0aW9ucy5jYW5jZWwgKS5sZW5ndGggOiBmYWxzZSApO1xuXHRcdGlmICggIWJ0bklzTGVmdCB8fCBlbElzQ2FuY2VsIHx8ICF0aGlzLl9tb3VzZUNhcHR1cmUoIGV2ZW50ICkgKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHR0aGlzLm1vdXNlRGVsYXlNZXQgPSAhdGhpcy5vcHRpb25zLmRlbGF5O1xuXHRcdGlmICggIXRoaXMubW91c2VEZWxheU1ldCApIHtcblx0XHRcdHRoaXMuX21vdXNlRGVsYXlUaW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGF0Lm1vdXNlRGVsYXlNZXQgPSB0cnVlO1xuXHRcdFx0fSwgdGhpcy5vcHRpb25zLmRlbGF5ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLl9tb3VzZURpc3RhbmNlTWV0KCBldmVudCApICYmIHRoaXMuX21vdXNlRGVsYXlNZXQoIGV2ZW50ICkgKSB7XG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPSAoIHRoaXMuX21vdXNlU3RhcnQoIGV2ZW50ICkgIT09IGZhbHNlICk7XG5cdFx0XHRpZiAoICF0aGlzLl9tb3VzZVN0YXJ0ZWQgKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENsaWNrIGV2ZW50IG1heSBuZXZlciBoYXZlIGZpcmVkIChHZWNrbyAmIE9wZXJhKVxuXHRcdGlmICggdHJ1ZSA9PT0gJC5kYXRhKCBldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKSApIHtcblx0XHRcdCQucmVtb3ZlRGF0YSggZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiICk7XG5cdFx0fVxuXG5cdFx0Ly8gVGhlc2UgZGVsZWdhdGVzIGFyZSByZXF1aXJlZCB0byBrZWVwIGNvbnRleHRcblx0XHR0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZU1vdmUoIGV2ZW50ICk7XG5cdFx0fTtcblx0XHR0aGlzLl9tb3VzZVVwRGVsZWdhdGUgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRyZXR1cm4gdGhhdC5fbW91c2VVcCggZXZlbnQgKTtcblx0XHR9O1xuXG5cdFx0dGhpcy5kb2N1bWVudFxuXHRcdFx0Lm9uKCBcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKVxuXHRcdFx0Lm9uKCBcIm1vdXNldXAuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSApO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHRcdG1vdXNlSGFuZGxlZCA9IHRydWU7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X21vdXNlTW92ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0Ly8gT25seSBjaGVjayBmb3IgbW91c2V1cHMgb3V0c2lkZSB0aGUgZG9jdW1lbnQgaWYgeW91J3ZlIG1vdmVkIGluc2lkZSB0aGUgZG9jdW1lbnRcblx0XHQvLyBhdCBsZWFzdCBvbmNlLiBUaGlzIHByZXZlbnRzIHRoZSBmaXJpbmcgb2YgbW91c2V1cCBpbiB0aGUgY2FzZSBvZiBJRTw5LCB3aGljaCB3aWxsXG5cdFx0Ly8gZmlyZSBhIG1vdXNlbW92ZSBldmVudCBpZiBjb250ZW50IGlzIHBsYWNlZCB1bmRlciB0aGUgY3Vyc29yLiBTZWUgIzc3Nzhcblx0XHQvLyBTdXBwb3J0OiBJRSA8OVxuXHRcdGlmICggdGhpcy5fbW91c2VNb3ZlZCApIHtcblxuXHRcdFx0Ly8gSUUgbW91c2V1cCBjaGVjayAtIG1vdXNldXAgaGFwcGVuZWQgd2hlbiBtb3VzZSB3YXMgb3V0IG9mIHdpbmRvd1xuXHRcdFx0aWYgKCAkLnVpLmllICYmICggIWRvY3VtZW50LmRvY3VtZW50TW9kZSB8fCBkb2N1bWVudC5kb2N1bWVudE1vZGUgPCA5ICkgJiZcblx0XHRcdFx0XHQhZXZlbnQuYnV0dG9uICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbW91c2VVcCggZXZlbnQgKTtcblxuXHRcdFx0Ly8gSWZyYW1lIG1vdXNldXAgY2hlY2sgLSBtb3VzZXVwIG9jY3VycmVkIGluIGFub3RoZXIgZG9jdW1lbnRcblx0XHRcdH0gZWxzZSBpZiAoICFldmVudC53aGljaCApIHtcblxuXHRcdFx0XHQvLyBTdXBwb3J0OiBTYWZhcmkgPD04IC0gOVxuXHRcdFx0XHQvLyBTYWZhcmkgc2V0cyB3aGljaCB0byAwIGlmIHlvdSBwcmVzcyBhbnkgb2YgdGhlIGZvbGxvd2luZyBrZXlzXG5cdFx0XHRcdC8vIGR1cmluZyBhIGRyYWcgKCMxNDQ2MSlcblx0XHRcdFx0aWYgKCBldmVudC5vcmlnaW5hbEV2ZW50LmFsdEtleSB8fCBldmVudC5vcmlnaW5hbEV2ZW50LmN0cmxLZXkgfHxcblx0XHRcdFx0XHRcdGV2ZW50Lm9yaWdpbmFsRXZlbnQubWV0YUtleSB8fCBldmVudC5vcmlnaW5hbEV2ZW50LnNoaWZ0S2V5ICkge1xuXHRcdFx0XHRcdHRoaXMuaWdub3JlTWlzc2luZ1doaWNoID0gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIGlmICggIXRoaXMuaWdub3JlTWlzc2luZ1doaWNoICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCBldmVudC53aGljaCB8fCBldmVudC5idXR0b24gKSB7XG5cdFx0XHR0aGlzLl9tb3VzZU1vdmVkID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlU3RhcnRlZCApIHtcblx0XHRcdHRoaXMuX21vdXNlRHJhZyggZXZlbnQgKTtcblx0XHRcdHJldHVybiBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5fbW91c2VEaXN0YW5jZU1ldCggZXZlbnQgKSAmJiB0aGlzLl9tb3VzZURlbGF5TWV0KCBldmVudCApICkge1xuXHRcdFx0dGhpcy5fbW91c2VTdGFydGVkID1cblx0XHRcdFx0KCB0aGlzLl9tb3VzZVN0YXJ0KCB0aGlzLl9tb3VzZURvd25FdmVudCwgZXZlbnQgKSAhPT0gZmFsc2UgKTtcblx0XHRcdCggdGhpcy5fbW91c2VTdGFydGVkID8gdGhpcy5fbW91c2VEcmFnKCBldmVudCApIDogdGhpcy5fbW91c2VVcCggZXZlbnQgKSApO1xuXHRcdH1cblxuXHRcdHJldHVybiAhdGhpcy5fbW91c2VTdGFydGVkO1xuXHR9LFxuXG5cdF9tb3VzZVVwOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5kb2N1bWVudFxuXHRcdFx0Lm9mZiggXCJtb3VzZW1vdmUuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlIClcblx0XHRcdC5vZmYoIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlU3RhcnRlZCApIHtcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9IGZhbHNlO1xuXG5cdFx0XHRpZiAoIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fbW91c2VEb3duRXZlbnQudGFyZ2V0ICkge1xuXHRcdFx0XHQkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiwgdHJ1ZSApO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9tb3VzZVN0b3AoIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLl9tb3VzZURlbGF5VGltZXIgKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoIHRoaXMuX21vdXNlRGVsYXlUaW1lciApO1xuXHRcdFx0ZGVsZXRlIHRoaXMuX21vdXNlRGVsYXlUaW1lcjtcblx0XHR9XG5cblx0XHR0aGlzLmlnbm9yZU1pc3NpbmdXaGljaCA9IGZhbHNlO1xuXHRcdG1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdH0sXG5cblx0X21vdXNlRGlzdGFuY2VNZXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRyZXR1cm4gKCBNYXRoLm1heChcblx0XHRcdFx0TWF0aC5hYnMoIHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VYIC0gZXZlbnQucGFnZVggKSxcblx0XHRcdFx0TWF0aC5hYnMoIHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VZIC0gZXZlbnQucGFnZVkgKVxuXHRcdFx0KSA+PSB0aGlzLm9wdGlvbnMuZGlzdGFuY2Vcblx0XHQpO1xuXHR9LFxuXG5cdF9tb3VzZURlbGF5TWV0OiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7XG5cdFx0cmV0dXJuIHRoaXMubW91c2VEZWxheU1ldDtcblx0fSxcblxuXHQvLyBUaGVzZSBhcmUgcGxhY2Vob2xkZXIgbWV0aG9kcywgdG8gYmUgb3ZlcnJpZGVuIGJ5IGV4dGVuZGluZyBwbHVnaW5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHt9LFxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7fSxcblx0X21vdXNlU3RvcDogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkge30sXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHsgcmV0dXJuIHRydWU7IH1cbn0gKTtcblxuXG4vKiFcbiAqIGpRdWVyeSBVSSBTb3J0YWJsZSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogU29ydGFibGVcbi8vPj5ncm91cDogSW50ZXJhY3Rpb25zXG4vLz4+ZGVzY3JpcHRpb246IEVuYWJsZXMgaXRlbXMgaW4gYSBsaXN0IHRvIGJlIHNvcnRlZCB1c2luZyB0aGUgbW91c2UuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc29ydGFibGUvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vc29ydGFibGUvXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2Uvc29ydGFibGUuY3NzXG5cblxuXG52YXIgd2lkZ2V0c1NvcnRhYmxlID0gJC53aWRnZXQoIFwidWkuc29ydGFibGVcIiwgJC51aS5tb3VzZSwge1xuXHR2ZXJzaW9uOiBcIjEuMTIuMVwiLFxuXHR3aWRnZXRFdmVudFByZWZpeDogXCJzb3J0XCIsXG5cdHJlYWR5OiBmYWxzZSxcblx0b3B0aW9uczoge1xuXHRcdGFwcGVuZFRvOiBcInBhcmVudFwiLFxuXHRcdGF4aXM6IGZhbHNlLFxuXHRcdGNvbm5lY3RXaXRoOiBmYWxzZSxcblx0XHRjb250YWlubWVudDogZmFsc2UsXG5cdFx0Y3Vyc29yOiBcImF1dG9cIixcblx0XHRjdXJzb3JBdDogZmFsc2UsXG5cdFx0ZHJvcE9uRW1wdHk6IHRydWUsXG5cdFx0Zm9yY2VQbGFjZWhvbGRlclNpemU6IGZhbHNlLFxuXHRcdGZvcmNlSGVscGVyU2l6ZTogZmFsc2UsXG5cdFx0Z3JpZDogZmFsc2UsXG5cdFx0aGFuZGxlOiBmYWxzZSxcblx0XHRoZWxwZXI6IFwib3JpZ2luYWxcIixcblx0XHRpdGVtczogXCI+ICpcIixcblx0XHRvcGFjaXR5OiBmYWxzZSxcblx0XHRwbGFjZWhvbGRlcjogZmFsc2UsXG5cdFx0cmV2ZXJ0OiBmYWxzZSxcblx0XHRzY3JvbGw6IHRydWUsXG5cdFx0c2Nyb2xsU2Vuc2l0aXZpdHk6IDIwLFxuXHRcdHNjcm9sbFNwZWVkOiAyMCxcblx0XHRzY29wZTogXCJkZWZhdWx0XCIsXG5cdFx0dG9sZXJhbmNlOiBcImludGVyc2VjdFwiLFxuXHRcdHpJbmRleDogMTAwMCxcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGFjdGl2YXRlOiBudWxsLFxuXHRcdGJlZm9yZVN0b3A6IG51bGwsXG5cdFx0Y2hhbmdlOiBudWxsLFxuXHRcdGRlYWN0aXZhdGU6IG51bGwsXG5cdFx0b3V0OiBudWxsLFxuXHRcdG92ZXI6IG51bGwsXG5cdFx0cmVjZWl2ZTogbnVsbCxcblx0XHRyZW1vdmU6IG51bGwsXG5cdFx0c29ydDogbnVsbCxcblx0XHRzdGFydDogbnVsbCxcblx0XHRzdG9wOiBudWxsLFxuXHRcdHVwZGF0ZTogbnVsbFxuXHR9LFxuXG5cdF9pc092ZXJBeGlzOiBmdW5jdGlvbiggeCwgcmVmZXJlbmNlLCBzaXplICkge1xuXHRcdHJldHVybiAoIHggPj0gcmVmZXJlbmNlICkgJiYgKCB4IDwgKCByZWZlcmVuY2UgKyBzaXplICkgKTtcblx0fSxcblxuXHRfaXNGbG9hdGluZzogZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0cmV0dXJuICggL2xlZnR8cmlnaHQvICkudGVzdCggaXRlbS5jc3MoIFwiZmxvYXRcIiApICkgfHxcblx0XHRcdCggL2lubGluZXx0YWJsZS1jZWxsLyApLnRlc3QoIGl0ZW0uY3NzKCBcImRpc3BsYXlcIiApICk7XG5cdH0sXG5cblx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5jb250YWluZXJDYWNoZSA9IHt9O1xuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLXNvcnRhYmxlXCIgKTtcblxuXHRcdC8vR2V0IHRoZSBpdGVtc1xuXHRcdHRoaXMucmVmcmVzaCgpO1xuXG5cdFx0Ly9MZXQncyBkZXRlcm1pbmUgdGhlIHBhcmVudCdzIG9mZnNldFxuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5lbGVtZW50Lm9mZnNldCgpO1xuXG5cdFx0Ly9Jbml0aWFsaXplIG1vdXNlIGV2ZW50cyBmb3IgaW50ZXJhY3Rpb25cblx0XHR0aGlzLl9tb3VzZUluaXQoKTtcblxuXHRcdHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpO1xuXG5cdFx0Ly9XZSdyZSByZWFkeSB0byBnb1xuXHRcdHRoaXMucmVhZHkgPSB0cnVlO1xuXG5cdH0sXG5cblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblxuXHRcdGlmICgga2V5ID09PSBcImhhbmRsZVwiICkge1xuXHRcdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLXNvcnRhYmxlLWhhbmRsZVwiICksIFwidWktc29ydGFibGUtaGFuZGxlXCIgKTtcblx0XHQkLmVhY2goIHRoaXMuaXRlbXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhhdC5fYWRkQ2xhc3MoXG5cdFx0XHRcdHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUgP1xuXHRcdFx0XHRcdHRoaXMuaXRlbS5maW5kKCB0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGFuZGxlICkgOlxuXHRcdFx0XHRcdHRoaXMuaXRlbSxcblx0XHRcdFx0XCJ1aS1zb3J0YWJsZS1oYW5kbGVcIlxuXHRcdFx0KTtcblx0XHR9ICk7XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xuXG5cdFx0Zm9yICggdmFyIGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXHRcdFx0dGhpcy5pdGVtc1sgaSBdLml0ZW0ucmVtb3ZlRGF0YSggdGhpcy53aWRnZXROYW1lICsgXCItaXRlbVwiICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oIGV2ZW50LCBvdmVycmlkZUhhbmRsZSApIHtcblx0XHR2YXIgY3VycmVudEl0ZW0gPSBudWxsLFxuXHRcdFx0dmFsaWRIYW5kbGUgPSBmYWxzZSxcblx0XHRcdHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKCB0aGlzLnJldmVydGluZyApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gXCJzdGF0aWNcIiApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvL1dlIGhhdmUgdG8gcmVmcmVzaCB0aGUgaXRlbXMgZGF0YSBvbmNlIGZpcnN0XG5cdFx0dGhpcy5fcmVmcmVzaEl0ZW1zKCBldmVudCApO1xuXG5cdFx0Ly9GaW5kIG91dCBpZiB0aGUgY2xpY2tlZCBub2RlIChvciBvbmUgb2YgaXRzIHBhcmVudHMpIGlzIGEgYWN0dWFsIGl0ZW0gaW4gdGhpcy5pdGVtc1xuXHRcdCQoIGV2ZW50LnRhcmdldCApLnBhcmVudHMoKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICggJC5kYXRhKCB0aGlzLCB0aGF0LndpZGdldE5hbWUgKyBcIi1pdGVtXCIgKSA9PT0gdGhhdCApIHtcblx0XHRcdFx0Y3VycmVudEl0ZW0gPSAkKCB0aGlzICk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdFx0aWYgKCAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCItaXRlbVwiICkgPT09IHRoYXQgKSB7XG5cdFx0XHRjdXJyZW50SXRlbSA9ICQoIGV2ZW50LnRhcmdldCApO1xuXHRcdH1cblxuXHRcdGlmICggIWN1cnJlbnRJdGVtICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5oYW5kbGUgJiYgIW92ZXJyaWRlSGFuZGxlICkge1xuXHRcdFx0JCggdGhpcy5vcHRpb25zLmhhbmRsZSwgY3VycmVudEl0ZW0gKS5maW5kKCBcIipcIiApLmFkZEJhY2soKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCB0aGlzID09PSBldmVudC50YXJnZXQgKSB7XG5cdFx0XHRcdFx0dmFsaWRIYW5kbGUgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0XHRpZiAoICF2YWxpZEhhbmRsZSApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuY3VycmVudEl0ZW0gPSBjdXJyZW50SXRlbTtcblx0XHR0aGlzLl9yZW1vdmVDdXJyZW50c0Zyb21JdGVtcygpO1xuXHRcdHJldHVybiB0cnVlO1xuXG5cdH0sXG5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgb3ZlcnJpZGVIYW5kbGUsIG5vQWN0aXZhdGlvbiApIHtcblxuXHRcdHZhciBpLCBib2R5LFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucztcblxuXHRcdHRoaXMuY3VycmVudENvbnRhaW5lciA9IHRoaXM7XG5cblx0XHQvL1dlIG9ubHkgbmVlZCB0byBjYWxsIHJlZnJlc2hQb3NpdGlvbnMsIGJlY2F1c2UgdGhlIHJlZnJlc2hJdGVtcyBjYWxsIGhhcyBiZWVuIG1vdmVkIHRvXG5cdFx0Ly8gbW91c2VDYXB0dXJlXG5cdFx0dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XG5cblx0XHQvL0NyZWF0ZSBhbmQgYXBwZW5kIHRoZSB2aXNpYmxlIGhlbHBlclxuXHRcdHRoaXMuaGVscGVyID0gdGhpcy5fY3JlYXRlSGVscGVyKCBldmVudCApO1xuXG5cdFx0Ly9DYWNoZSB0aGUgaGVscGVyIHNpemVcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XG5cblx0XHQvKlxuXHRcdCAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtXG5cdFx0ICogVGhpcyBibG9jayBnZW5lcmF0ZXMgZXZlcnl0aGluZyBwb3NpdGlvbiByZWxhdGVkIC0gaXQncyB0aGUgY29yZSBvZiBkcmFnZ2FibGVzLlxuXHRcdCAqL1xuXG5cdFx0Ly9DYWNoZSB0aGUgbWFyZ2lucyBvZiB0aGUgb3JpZ2luYWwgZWxlbWVudFxuXHRcdHRoaXMuX2NhY2hlTWFyZ2lucygpO1xuXG5cdFx0Ly9HZXQgdGhlIG5leHQgc2Nyb2xsaW5nIHBhcmVudFxuXHRcdHRoaXMuc2Nyb2xsUGFyZW50ID0gdGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCk7XG5cblx0XHQvL1RoZSBlbGVtZW50J3MgYWJzb2x1dGUgcG9zaXRpb24gb24gdGhlIHBhZ2UgbWludXMgbWFyZ2luc1xuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5jdXJyZW50SXRlbS5vZmZzZXQoKTtcblx0XHR0aGlzLm9mZnNldCA9IHtcblx0XHRcdHRvcDogdGhpcy5vZmZzZXQudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCxcblx0XHRcdGxlZnQ6IHRoaXMub2Zmc2V0LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdFxuXHRcdH07XG5cblx0XHQkLmV4dGVuZCggdGhpcy5vZmZzZXQsIHtcblx0XHRcdGNsaWNrOiB7IC8vV2hlcmUgdGhlIGNsaWNrIGhhcHBlbmVkLCByZWxhdGl2ZSB0byB0aGUgZWxlbWVudFxuXHRcdFx0XHRsZWZ0OiBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmxlZnQsXG5cdFx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3Bcblx0XHRcdH0sXG5cdFx0XHRwYXJlbnQ6IHRoaXMuX2dldFBhcmVudE9mZnNldCgpLFxuXG5cdFx0XHQvLyBUaGlzIGlzIGEgcmVsYXRpdmUgdG8gYWJzb2x1dGUgcG9zaXRpb24gbWludXMgdGhlIGFjdHVhbCBwb3NpdGlvbiBjYWxjdWxhdGlvbiAtXG5cdFx0XHQvLyBvbmx5IHVzZWQgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgaGVscGVyXG5cdFx0XHRyZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKVxuXHRcdH0gKTtcblxuXHRcdC8vIE9ubHkgYWZ0ZXIgd2UgZ290IHRoZSBvZmZzZXQsIHdlIGNhbiBjaGFuZ2UgdGhlIGhlbHBlcidzIHBvc2l0aW9uIHRvIGFic29sdXRlXG5cdFx0Ly8gVE9ETzogU3RpbGwgbmVlZCB0byBmaWd1cmUgb3V0IGEgd2F5IHRvIG1ha2UgcmVsYXRpdmUgc29ydGluZyBwb3NzaWJsZVxuXHRcdHRoaXMuaGVscGVyLmNzcyggXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIgKTtcblx0XHR0aGlzLmNzc1Bvc2l0aW9uID0gdGhpcy5oZWxwZXIuY3NzKCBcInBvc2l0aW9uXCIgKTtcblxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQgKTtcblx0XHR0aGlzLm9yaWdpbmFsUGFnZVggPSBldmVudC5wYWdlWDtcblx0XHR0aGlzLm9yaWdpbmFsUGFnZVkgPSBldmVudC5wYWdlWTtcblxuXHRcdC8vQWRqdXN0IHRoZSBtb3VzZSBvZmZzZXQgcmVsYXRpdmUgdG8gdGhlIGhlbHBlciBpZiBcImN1cnNvckF0XCIgaXMgc3VwcGxpZWRcblx0XHQoIG8uY3Vyc29yQXQgJiYgdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlciggby5jdXJzb3JBdCApICk7XG5cblx0XHQvL0NhY2hlIHRoZSBmb3JtZXIgRE9NIHBvc2l0aW9uXG5cdFx0dGhpcy5kb21Qb3NpdGlvbiA9IHtcblx0XHRcdHByZXY6IHRoaXMuY3VycmVudEl0ZW0ucHJldigpWyAwIF0sXG5cdFx0XHRwYXJlbnQ6IHRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbIDAgXVxuXHRcdH07XG5cblx0XHQvLyBJZiB0aGUgaGVscGVyIGlzIG5vdCB0aGUgb3JpZ2luYWwsIGhpZGUgdGhlIG9yaWdpbmFsIHNvIGl0J3Mgbm90IHBsYXlpbmcgYW55IHJvbGUgZHVyaW5nXG5cdFx0Ly8gdGhlIGRyYWcsIHdvbid0IGNhdXNlIGFueXRoaW5nIGJhZCB0aGlzIHdheVxuXHRcdGlmICggdGhpcy5oZWxwZXJbIDAgXSAhPT0gdGhpcy5jdXJyZW50SXRlbVsgMCBdICkge1xuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5oaWRlKCk7XG5cdFx0fVxuXG5cdFx0Ly9DcmVhdGUgdGhlIHBsYWNlaG9sZGVyXG5cdFx0dGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoKTtcblxuXHRcdC8vU2V0IGEgY29udGFpbm1lbnQgaWYgZ2l2ZW4gaW4gdGhlIG9wdGlvbnNcblx0XHRpZiAoIG8uY29udGFpbm1lbnQgKSB7XG5cdFx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xuXHRcdH1cblxuXHRcdGlmICggby5jdXJzb3IgJiYgby5jdXJzb3IgIT09IFwiYXV0b1wiICkgeyAvLyBjdXJzb3Igb3B0aW9uXG5cdFx0XHRib2R5ID0gdGhpcy5kb2N1bWVudC5maW5kKCBcImJvZHlcIiApO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRVxuXHRcdFx0dGhpcy5zdG9yZWRDdXJzb3IgPSBib2R5LmNzcyggXCJjdXJzb3JcIiApO1xuXHRcdFx0Ym9keS5jc3MoIFwiY3Vyc29yXCIsIG8uY3Vyc29yICk7XG5cblx0XHRcdHRoaXMuc3RvcmVkU3R5bGVzaGVldCA9XG5cdFx0XHRcdCQoIFwiPHN0eWxlPip7IGN1cnNvcjogXCIgKyBvLmN1cnNvciArIFwiICFpbXBvcnRhbnQ7IH08L3N0eWxlPlwiICkuYXBwZW5kVG8oIGJvZHkgKTtcblx0XHR9XG5cblx0XHRpZiAoIG8ub3BhY2l0eSApIHsgLy8gb3BhY2l0eSBvcHRpb25cblx0XHRcdGlmICggdGhpcy5oZWxwZXIuY3NzKCBcIm9wYWNpdHlcIiApICkge1xuXHRcdFx0XHR0aGlzLl9zdG9yZWRPcGFjaXR5ID0gdGhpcy5oZWxwZXIuY3NzKCBcIm9wYWNpdHlcIiApO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKCBcIm9wYWNpdHlcIiwgby5vcGFjaXR5ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBvLnpJbmRleCApIHsgLy8gekluZGV4IG9wdGlvblxuXHRcdFx0aWYgKCB0aGlzLmhlbHBlci5jc3MoIFwiekluZGV4XCIgKSApIHtcblx0XHRcdFx0dGhpcy5fc3RvcmVkWkluZGV4ID0gdGhpcy5oZWxwZXIuY3NzKCBcInpJbmRleFwiICk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoIFwiekluZGV4XCIsIG8uekluZGV4ICk7XG5cdFx0fVxuXG5cdFx0Ly9QcmVwYXJlIHNjcm9sbGluZ1xuXHRcdGlmICggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSAhPT0gdGhpcy5kb2N1bWVudFsgMCBdICYmXG5cdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0udGFnTmFtZSAhPT0gXCJIVE1MXCIgKSB7XG5cdFx0XHR0aGlzLm92ZXJmbG93T2Zmc2V0ID0gdGhpcy5zY3JvbGxQYXJlbnQub2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0Ly9DYWxsIGNhbGxiYWNrc1xuXHRcdHRoaXMuX3RyaWdnZXIoIFwic3RhcnRcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpICk7XG5cblx0XHQvL1JlY2FjaGUgdGhlIGhlbHBlciBzaXplXG5cdFx0aWYgKCAhdGhpcy5fcHJlc2VydmVIZWxwZXJQcm9wb3J0aW9ucyApIHtcblx0XHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcblx0XHR9XG5cblx0XHQvL1Bvc3QgXCJhY3RpdmF0ZVwiIGV2ZW50cyB0byBwb3NzaWJsZSBjb250YWluZXJzXG5cdFx0aWYgKCAhbm9BY3RpdmF0aW9uICkge1xuXHRcdFx0Zm9yICggaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpIF0uX3RyaWdnZXIoIFwiYWN0aXZhdGVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9QcmVwYXJlIHBvc3NpYmxlIGRyb3BwYWJsZXNcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7XG5cdFx0fVxuXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciAmJiAhby5kcm9wQmVoYXZpb3VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5kcmFnZ2luZyA9IHRydWU7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5oZWxwZXIsIFwidWktc29ydGFibGUtaGVscGVyXCIgKTtcblxuXHRcdC8vIEV4ZWN1dGUgdGhlIGRyYWcgb25jZSAtIHRoaXMgY2F1c2VzIHRoZSBoZWxwZXIgbm90IHRvIGJlIHZpc2libGViZWZvcmUgZ2V0dGluZyBpdHNcblx0XHQvLyBjb3JyZWN0IHBvc2l0aW9uXG5cdFx0dGhpcy5fbW91c2VEcmFnKCBldmVudCApO1xuXHRcdHJldHVybiB0cnVlO1xuXG5cdH0sXG5cblx0X21vdXNlRHJhZzogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciBpLCBpdGVtLCBpdGVtRWxlbWVudCwgaW50ZXJzZWN0aW9uLFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcblx0XHRcdHNjcm9sbGVkID0gZmFsc2U7XG5cblx0XHQvL0NvbXB1dGUgdGhlIGhlbHBlcnMgcG9zaXRpb25cblx0XHR0aGlzLnBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQgKTtcblx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5fY29udmVydFBvc2l0aW9uVG8oIFwiYWJzb2x1dGVcIiApO1xuXG5cdFx0aWYgKCAhdGhpcy5sYXN0UG9zaXRpb25BYnMgKSB7XG5cdFx0XHR0aGlzLmxhc3RQb3NpdGlvbkFicyA9IHRoaXMucG9zaXRpb25BYnM7XG5cdFx0fVxuXG5cdFx0Ly9EbyBzY3JvbGxpbmdcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5zY3JvbGwgKSB7XG5cdFx0XHRpZiAoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMuZG9jdW1lbnRbIDAgXSAmJlxuXHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0udGFnTmFtZSAhPT0gXCJIVE1MXCIgKSB7XG5cblx0XHRcdFx0aWYgKCAoIHRoaXMub3ZlcmZsb3dPZmZzZXQudG9wICsgdGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5vZmZzZXRIZWlnaHQgKSAtXG5cdFx0XHRcdFx0XHRldmVudC5wYWdlWSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5zY3JvbGxUb3AgPVxuXHRcdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5vdmVyZmxvd09mZnNldC50b3AgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsVG9wID1cblx0XHRcdFx0XHRcdHNjcm9sbGVkID0gdGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5zY3JvbGxUb3AgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCAoIHRoaXMub3ZlcmZsb3dPZmZzZXQubGVmdCArIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0ub2Zmc2V0V2lkdGggKSAtXG5cdFx0XHRcdFx0XHRldmVudC5wYWdlWCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPVxuXHRcdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5zY3JvbGxMZWZ0ICsgby5zY3JvbGxTcGVlZDtcblx0XHRcdFx0fSBlbHNlIGlmICggZXZlbnQucGFnZVggLSB0aGlzLm92ZXJmbG93T2Zmc2V0LmxlZnQgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID1cblx0XHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsTGVmdCAtIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRpZiAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCggdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSAtIG8uc2Nyb2xsU3BlZWQgKTtcblx0XHRcdFx0fSBlbHNlIGlmICggdGhpcy53aW5kb3cuaGVpZ2h0KCkgLSAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSApIDxcblx0XHRcdFx0XHRcdG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCggdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSArIG8uc2Nyb2xsU3BlZWQgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVggLSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoXG5cdFx0XHRcdFx0XHR0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCB0aGlzLndpbmRvdy53aWR0aCgpIC0gKCBldmVudC5wYWdlWCAtIHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpICkgPFxuXHRcdFx0XHRcdFx0by5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdChcblx0XHRcdFx0XHRcdHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHNjcm9sbGVkICE9PSBmYWxzZSAmJiAkLnVpLmRkbWFuYWdlciAmJiAhby5kcm9wQmVoYXZpb3VyICkge1xuXHRcdFx0XHQkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggdGhpcywgZXZlbnQgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL1JlZ2VuZXJhdGUgdGhlIGFic29sdXRlIHBvc2l0aW9uIHVzZWQgZm9yIHBvc2l0aW9uIGNoZWNrc1xuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cblx0XHQvL1NldCB0aGUgaGVscGVyIHBvc2l0aW9uXG5cdFx0aWYgKCAhdGhpcy5vcHRpb25zLmF4aXMgfHwgdGhpcy5vcHRpb25zLmF4aXMgIT09IFwieVwiICkge1xuXHRcdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgXCJweFwiO1xuXHRcdH1cblx0XHRpZiAoICF0aGlzLm9wdGlvbnMuYXhpcyB8fCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ4XCIgKSB7XG5cdFx0XHR0aGlzLmhlbHBlclsgMCBdLnN0eWxlLnRvcCA9IHRoaXMucG9zaXRpb24udG9wICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdC8vUmVhcnJhbmdlXG5cdFx0Zm9yICggaSA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cblx0XHRcdC8vQ2FjaGUgdmFyaWFibGVzIGFuZCBpbnRlcnNlY3Rpb24sIGNvbnRpbnVlIGlmIG5vIGludGVyc2VjdGlvblxuXHRcdFx0aXRlbSA9IHRoaXMuaXRlbXNbIGkgXTtcblx0XHRcdGl0ZW1FbGVtZW50ID0gaXRlbS5pdGVtWyAwIF07XG5cdFx0XHRpbnRlcnNlY3Rpb24gPSB0aGlzLl9pbnRlcnNlY3RzV2l0aFBvaW50ZXIoIGl0ZW0gKTtcblx0XHRcdGlmICggIWludGVyc2VjdGlvbiApIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE9ubHkgcHV0IHRoZSBwbGFjZWhvbGRlciBpbnNpZGUgdGhlIGN1cnJlbnQgQ29udGFpbmVyLCBza2lwIGFsbFxuXHRcdFx0Ly8gaXRlbXMgZnJvbSBvdGhlciBjb250YWluZXJzLiBUaGlzIHdvcmtzIGJlY2F1c2Ugd2hlbiBtb3Zpbmdcblx0XHRcdC8vIGFuIGl0ZW0gZnJvbSBvbmUgY29udGFpbmVyIHRvIGFub3RoZXIgdGhlXG5cdFx0XHQvLyBjdXJyZW50Q29udGFpbmVyIGlzIHN3aXRjaGVkIGJlZm9yZSB0aGUgcGxhY2Vob2xkZXIgaXMgbW92ZWQuXG5cdFx0XHQvL1xuXHRcdFx0Ly8gV2l0aG91dCB0aGlzLCBtb3ZpbmcgaXRlbXMgaW4gXCJzdWItc29ydGFibGVzXCIgY2FuIGNhdXNlXG5cdFx0XHQvLyB0aGUgcGxhY2Vob2xkZXIgdG8gaml0dGVyIGJldHdlZW4gdGhlIG91dGVyIGFuZCBpbm5lciBjb250YWluZXIuXG5cdFx0XHRpZiAoIGl0ZW0uaW5zdGFuY2UgIT09IHRoaXMuY3VycmVudENvbnRhaW5lciApIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhbm5vdCBpbnRlcnNlY3Qgd2l0aCBpdHNlbGZcblx0XHRcdC8vIG5vIHVzZWxlc3MgYWN0aW9ucyB0aGF0IGhhdmUgYmVlbiBkb25lIGJlZm9yZVxuXHRcdFx0Ly8gbm8gYWN0aW9uIGlmIHRoZSBpdGVtIG1vdmVkIGlzIHRoZSBwYXJlbnQgb2YgdGhlIGl0ZW0gY2hlY2tlZFxuXHRcdFx0aWYgKCBpdGVtRWxlbWVudCAhPT0gdGhpcy5jdXJyZW50SXRlbVsgMCBdICYmXG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXJbIGludGVyc2VjdGlvbiA9PT0gMSA/IFwibmV4dFwiIDogXCJwcmV2XCIgXSgpWyAwIF0gIT09IGl0ZW1FbGVtZW50ICYmXG5cdFx0XHRcdCEkLmNvbnRhaW5zKCB0aGlzLnBsYWNlaG9sZGVyWyAwIF0sIGl0ZW1FbGVtZW50ICkgJiZcblx0XHRcdFx0KCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gXCJzZW1pLWR5bmFtaWNcIiA/XG5cdFx0XHRcdFx0ISQuY29udGFpbnMoIHRoaXMuZWxlbWVudFsgMCBdLCBpdGVtRWxlbWVudCApIDpcblx0XHRcdFx0XHR0cnVlXG5cdFx0XHRcdClcblx0XHRcdCkge1xuXG5cdFx0XHRcdHRoaXMuZGlyZWN0aW9uID0gaW50ZXJzZWN0aW9uID09PSAxID8gXCJkb3duXCIgOiBcInVwXCI7XG5cblx0XHRcdFx0aWYgKCB0aGlzLm9wdGlvbnMudG9sZXJhbmNlID09PSBcInBvaW50ZXJcIiB8fCB0aGlzLl9pbnRlcnNlY3RzV2l0aFNpZGVzKCBpdGVtICkgKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVhcnJhbmdlKCBldmVudCwgaXRlbSApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5fdHJpZ2dlciggXCJjaGFuZ2VcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpICk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVyc1xuXHRcdHRoaXMuX2NvbnRhY3RDb250YWluZXJzKCBldmVudCApO1xuXG5cdFx0Ly9JbnRlcmNvbm5lY3Qgd2l0aCBkcm9wcGFibGVzXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWcoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0Ly9DYWxsIGNhbGxiYWNrc1xuXHRcdHRoaXMuX3RyaWdnZXIoIFwic29ydFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkgKTtcblxuXHRcdHRoaXMubGFzdFBvc2l0aW9uQWJzID0gdGhpcy5wb3NpdGlvbkFicztcblx0XHRyZXR1cm4gZmFsc2U7XG5cblx0fSxcblxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQsIG5vUHJvcGFnYXRpb24gKSB7XG5cblx0XHRpZiAoICFldmVudCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvL0lmIHdlIGFyZSB1c2luZyBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgYWJvdXQgdGhlIGRyb3Bcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICYmICF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91ciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyb3AoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMucmV2ZXJ0ICkge1xuXHRcdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0XHRjdXIgPSB0aGlzLnBsYWNlaG9sZGVyLm9mZnNldCgpLFxuXHRcdFx0XHRheGlzID0gdGhpcy5vcHRpb25zLmF4aXMsXG5cdFx0XHRcdGFuaW1hdGlvbiA9IHt9O1xuXG5cdFx0XHRpZiAoICFheGlzIHx8IGF4aXMgPT09IFwieFwiICkge1xuXHRcdFx0XHRhbmltYXRpb24ubGVmdCA9IGN1ci5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdCArXG5cdFx0XHRcdFx0KCB0aGlzLm9mZnNldFBhcmVudFsgMCBdID09PSB0aGlzLmRvY3VtZW50WyAwIF0uYm9keSA/XG5cdFx0XHRcdFx0XHQwIDpcblx0XHRcdFx0XHRcdHRoaXMub2Zmc2V0UGFyZW50WyAwIF0uc2Nyb2xsTGVmdFxuXHRcdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICFheGlzIHx8IGF4aXMgPT09IFwieVwiICkge1xuXHRcdFx0XHRhbmltYXRpb24udG9wID0gY3VyLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AgLSB0aGlzLm1hcmdpbnMudG9wICtcblx0XHRcdFx0XHQoIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gPT09IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5ID9cblx0XHRcdFx0XHRcdDAgOlxuXHRcdFx0XHRcdFx0dGhpcy5vZmZzZXRQYXJlbnRbIDAgXS5zY3JvbGxUb3Bcblx0XHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5yZXZlcnRpbmcgPSB0cnVlO1xuXHRcdFx0JCggdGhpcy5oZWxwZXIgKS5hbmltYXRlKFxuXHRcdFx0XHRhbmltYXRpb24sXG5cdFx0XHRcdHBhcnNlSW50KCB0aGlzLm9wdGlvbnMucmV2ZXJ0LCAxMCApIHx8IDUwMCxcblx0XHRcdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dGhhdC5fY2xlYXIoIGV2ZW50ICk7XG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2NsZWFyKCBldmVudCwgbm9Qcm9wYWdhdGlvbiApO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblxuXHR9LFxuXG5cdGNhbmNlbDogZnVuY3Rpb24oKSB7XG5cblx0XHRpZiAoIHRoaXMuZHJhZ2dpbmcgKSB7XG5cblx0XHRcdHRoaXMuX21vdXNlVXAoIG5ldyAkLkV2ZW50KCBcIm1vdXNldXBcIiwgeyB0YXJnZXQ6IG51bGwgfSApICk7XG5cblx0XHRcdGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gXCJvcmlnaW5hbFwiICkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRJdGVtLmNzcyggdGhpcy5fc3RvcmVkQ1NTICk7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmN1cnJlbnRJdGVtLCBcInVpLXNvcnRhYmxlLWhlbHBlclwiICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRJdGVtLnNob3coKTtcblx0XHRcdH1cblxuXHRcdFx0Ly9Qb3N0IGRlYWN0aXZhdGluZyBldmVudHMgdG8gY29udGFpbmVyc1xuXHRcdFx0Zm9yICggdmFyIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCBcImRlYWN0aXZhdGVcIiwgbnVsbCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTtcblx0XHRcdFx0aWYgKCB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZS5vdmVyICkge1xuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCBcIm91dFwiLCBudWxsLCB0aGlzLl91aUhhc2goIHRoaXMgKSApO1xuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRpZiAoIHRoaXMucGxhY2Vob2xkZXIgKSB7XG5cblx0XHRcdC8vJCh0aGlzLnBsYWNlaG9sZGVyWzBdKS5yZW1vdmUoKTsgd291bGQgaGF2ZSBiZWVuIHRoZSBqUXVlcnkgd2F5IC0gdW5mb3J0dW5hdGVseSxcblx0XHRcdC8vIGl0IHVuYmluZHMgQUxMIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBub2RlIVxuXHRcdFx0aWYgKCB0aGlzLnBsYWNlaG9sZGVyWyAwIF0ucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0dGhpcy5wbGFjZWhvbGRlclsgMCBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMucGxhY2Vob2xkZXJbIDAgXSApO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCB0aGlzLm9wdGlvbnMuaGVscGVyICE9PSBcIm9yaWdpbmFsXCIgJiYgdGhpcy5oZWxwZXIgJiZcblx0XHRcdFx0XHR0aGlzLmhlbHBlclsgMCBdLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHRoaXMuaGVscGVyLnJlbW92ZSgpO1xuXHRcdFx0fVxuXG5cdFx0XHQkLmV4dGVuZCggdGhpcywge1xuXHRcdFx0XHRoZWxwZXI6IG51bGwsXG5cdFx0XHRcdGRyYWdnaW5nOiBmYWxzZSxcblx0XHRcdFx0cmV2ZXJ0aW5nOiBmYWxzZSxcblx0XHRcdFx0X25vRmluYWxTb3J0OiBudWxsXG5cdFx0XHR9ICk7XG5cblx0XHRcdGlmICggdGhpcy5kb21Qb3NpdGlvbi5wcmV2ICkge1xuXHRcdFx0XHQkKCB0aGlzLmRvbVBvc2l0aW9uLnByZXYgKS5hZnRlciggdGhpcy5jdXJyZW50SXRlbSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JCggdGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQgKS5wcmVwZW5kKCB0aGlzLmN1cnJlbnRJdGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRzZXJpYWxpemU6IGZ1bmN0aW9uKCBvICkge1xuXG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fZ2V0SXRlbXNBc2pRdWVyeSggbyAmJiBvLmNvbm5lY3RlZCApLFxuXHRcdFx0c3RyID0gW107XG5cdFx0byA9IG8gfHwge307XG5cblx0XHQkKCBpdGVtcyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHJlcyA9ICggJCggby5pdGVtIHx8IHRoaXMgKS5hdHRyKCBvLmF0dHJpYnV0ZSB8fCBcImlkXCIgKSB8fCBcIlwiIClcblx0XHRcdFx0Lm1hdGNoKCBvLmV4cHJlc3Npb24gfHwgKCAvKC4rKVtcXC09X10oLispLyApICk7XG5cdFx0XHRpZiAoIHJlcyApIHtcblx0XHRcdFx0c3RyLnB1c2goXG5cdFx0XHRcdFx0KCBvLmtleSB8fCByZXNbIDEgXSArIFwiW11cIiApICtcblx0XHRcdFx0XHRcIj1cIiArICggby5rZXkgJiYgby5leHByZXNzaW9uID8gcmVzWyAxIF0gOiByZXNbIDIgXSApICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0aWYgKCAhc3RyLmxlbmd0aCAmJiBvLmtleSApIHtcblx0XHRcdHN0ci5wdXNoKCBvLmtleSArIFwiPVwiICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHN0ci5qb2luKCBcIiZcIiApO1xuXG5cdH0sXG5cblx0dG9BcnJheTogZnVuY3Rpb24oIG8gKSB7XG5cblx0XHR2YXIgaXRlbXMgPSB0aGlzLl9nZXRJdGVtc0FzalF1ZXJ5KCBvICYmIG8uY29ubmVjdGVkICksXG5cdFx0XHRyZXQgPSBbXTtcblxuXHRcdG8gPSBvIHx8IHt9O1xuXG5cdFx0aXRlbXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXQucHVzaCggJCggby5pdGVtIHx8IHRoaXMgKS5hdHRyKCBvLmF0dHJpYnV0ZSB8fCBcImlkXCIgKSB8fCBcIlwiICk7XG5cdFx0fSApO1xuXHRcdHJldHVybiByZXQ7XG5cblx0fSxcblxuXHQvKiBCZSBjYXJlZnVsIHdpdGggdGhlIGZvbGxvd2luZyBjb3JlIGZ1bmN0aW9ucyAqL1xuXHRfaW50ZXJzZWN0c1dpdGg6IGZ1bmN0aW9uKCBpdGVtICkge1xuXG5cdFx0dmFyIHgxID0gdGhpcy5wb3NpdGlvbkFicy5sZWZ0LFxuXHRcdFx0eDIgPSB4MSArIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsXG5cdFx0XHR5MSA9IHRoaXMucG9zaXRpb25BYnMudG9wLFxuXHRcdFx0eTIgPSB5MSArIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LFxuXHRcdFx0bCA9IGl0ZW0ubGVmdCxcblx0XHRcdHIgPSBsICsgaXRlbS53aWR0aCxcblx0XHRcdHQgPSBpdGVtLnRvcCxcblx0XHRcdGIgPSB0ICsgaXRlbS5oZWlnaHQsXG5cdFx0XHRkeUNsaWNrID0gdGhpcy5vZmZzZXQuY2xpY2sudG9wLFxuXHRcdFx0ZHhDbGljayA9IHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsXG5cdFx0XHRpc092ZXJFbGVtZW50SGVpZ2h0ID0gKCB0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ4XCIgKSB8fCAoICggeTEgKyBkeUNsaWNrICkgPiB0ICYmXG5cdFx0XHRcdCggeTEgKyBkeUNsaWNrICkgPCBiICksXG5cdFx0XHRpc092ZXJFbGVtZW50V2lkdGggPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSBcInlcIiApIHx8ICggKCB4MSArIGR4Q2xpY2sgKSA+IGwgJiZcblx0XHRcdFx0KCB4MSArIGR4Q2xpY2sgKSA8IHIgKSxcblx0XHRcdGlzT3ZlckVsZW1lbnQgPSBpc092ZXJFbGVtZW50SGVpZ2h0ICYmIGlzT3ZlckVsZW1lbnRXaWR0aDtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLnRvbGVyYW5jZSA9PT0gXCJwb2ludGVyXCIgfHxcblx0XHRcdHRoaXMub3B0aW9ucy5mb3JjZVBvaW50ZXJGb3JDb250YWluZXJzIHx8XG5cdFx0XHQoIHRoaXMub3B0aW9ucy50b2xlcmFuY2UgIT09IFwicG9pbnRlclwiICYmXG5cdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnNbIHRoaXMuZmxvYXRpbmcgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiIF0gPlxuXHRcdFx0XHRpdGVtWyB0aGlzLmZsb2F0aW5nID8gXCJ3aWR0aFwiIDogXCJoZWlnaHRcIiBdIClcblx0XHQpIHtcblx0XHRcdHJldHVybiBpc092ZXJFbGVtZW50O1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHJldHVybiAoIGwgPCB4MSArICggdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIgKSAmJiAvLyBSaWdodCBIYWxmXG5cdFx0XHRcdHgyIC0gKCB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC8gMiApIDwgciAmJiAvLyBMZWZ0IEhhbGZcblx0XHRcdFx0dCA8IHkxICsgKCB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAvIDIgKSAmJiAvLyBCb3R0b20gSGFsZlxuXHRcdFx0XHR5MiAtICggdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLyAyICkgPCBiICk7IC8vIFRvcCBIYWxmXG5cblx0XHR9XG5cdH0sXG5cblx0X2ludGVyc2VjdHNXaXRoUG9pbnRlcjogZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0dmFyIHZlcnRpY2FsRGlyZWN0aW9uLCBob3Jpem9udGFsRGlyZWN0aW9uLFxuXHRcdFx0aXNPdmVyRWxlbWVudEhlaWdodCA9ICggdGhpcy5vcHRpb25zLmF4aXMgPT09IFwieFwiICkgfHxcblx0XHRcdFx0dGhpcy5faXNPdmVyQXhpcyhcblx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQWJzLnRvcCArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCwgaXRlbS50b3AsIGl0ZW0uaGVpZ2h0ICksXG5cdFx0XHRpc092ZXJFbGVtZW50V2lkdGggPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSBcInlcIiApIHx8XG5cdFx0XHRcdHRoaXMuX2lzT3ZlckF4aXMoXG5cdFx0XHRcdFx0dGhpcy5wb3NpdGlvbkFicy5sZWZ0ICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0LCBpdGVtLndpZHRoICksXG5cdFx0XHRpc092ZXJFbGVtZW50ID0gaXNPdmVyRWxlbWVudEhlaWdodCAmJiBpc092ZXJFbGVtZW50V2lkdGg7XG5cblx0XHRpZiAoICFpc092ZXJFbGVtZW50ICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHZlcnRpY2FsRGlyZWN0aW9uID0gdGhpcy5fZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uKCk7XG5cdFx0aG9yaXpvbnRhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7XG5cblx0XHRyZXR1cm4gdGhpcy5mbG9hdGluZyA/XG5cdFx0XHQoICggaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJyaWdodFwiIHx8IHZlcnRpY2FsRGlyZWN0aW9uID09PSBcImRvd25cIiApID8gMiA6IDEgKVxuXHRcdFx0OiAoIHZlcnRpY2FsRGlyZWN0aW9uICYmICggdmVydGljYWxEaXJlY3Rpb24gPT09IFwiZG93blwiID8gMiA6IDEgKSApO1xuXG5cdH0sXG5cblx0X2ludGVyc2VjdHNXaXRoU2lkZXM6IGZ1bmN0aW9uKCBpdGVtICkge1xuXG5cdFx0dmFyIGlzT3ZlckJvdHRvbUhhbGYgPSB0aGlzLl9pc092ZXJBeGlzKCB0aGlzLnBvc2l0aW9uQWJzLnRvcCArXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCwgaXRlbS50b3AgKyAoIGl0ZW0uaGVpZ2h0IC8gMiApLCBpdGVtLmhlaWdodCApLFxuXHRcdFx0aXNPdmVyUmlnaHRIYWxmID0gdGhpcy5faXNPdmVyQXhpcyggdGhpcy5wb3NpdGlvbkFicy5sZWZ0ICtcblx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0ICsgKCBpdGVtLndpZHRoIC8gMiApLCBpdGVtLndpZHRoICksXG5cdFx0XHR2ZXJ0aWNhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLFxuXHRcdFx0aG9yaXpvbnRhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7XG5cblx0XHRpZiAoIHRoaXMuZmxvYXRpbmcgJiYgaG9yaXpvbnRhbERpcmVjdGlvbiApIHtcblx0XHRcdHJldHVybiAoICggaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJyaWdodFwiICYmIGlzT3ZlclJpZ2h0SGFsZiApIHx8XG5cdFx0XHRcdCggaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJsZWZ0XCIgJiYgIWlzT3ZlclJpZ2h0SGFsZiApICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB2ZXJ0aWNhbERpcmVjdGlvbiAmJiAoICggdmVydGljYWxEaXJlY3Rpb24gPT09IFwiZG93blwiICYmIGlzT3ZlckJvdHRvbUhhbGYgKSB8fFxuXHRcdFx0XHQoIHZlcnRpY2FsRGlyZWN0aW9uID09PSBcInVwXCIgJiYgIWlzT3ZlckJvdHRvbUhhbGYgKSApO1xuXHRcdH1cblxuXHR9LFxuXG5cdF9nZXREcmFnVmVydGljYWxEaXJlY3Rpb246IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBkZWx0YSA9IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5sYXN0UG9zaXRpb25BYnMudG9wO1xuXHRcdHJldHVybiBkZWx0YSAhPT0gMCAmJiAoIGRlbHRhID4gMCA/IFwiZG93blwiIDogXCJ1cFwiICk7XG5cdH0sXG5cblx0X2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZGVsdGEgPSB0aGlzLnBvc2l0aW9uQWJzLmxlZnQgLSB0aGlzLmxhc3RQb3NpdGlvbkFicy5sZWZ0O1xuXHRcdHJldHVybiBkZWx0YSAhPT0gMCAmJiAoIGRlbHRhID4gMCA/IFwicmlnaHRcIiA6IFwibGVmdFwiICk7XG5cdH0sXG5cblx0cmVmcmVzaDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHRoaXMuX3JlZnJlc2hJdGVtcyggZXZlbnQgKTtcblx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfY29ubmVjdFdpdGg6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXHRcdHJldHVybiBvcHRpb25zLmNvbm5lY3RXaXRoLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgP1xuXHRcdFx0WyBvcHRpb25zLmNvbm5lY3RXaXRoIF0gOlxuXHRcdFx0b3B0aW9ucy5jb25uZWN0V2l0aDtcblx0fSxcblxuXHRfZ2V0SXRlbXNBc2pRdWVyeTogZnVuY3Rpb24oIGNvbm5lY3RlZCApIHtcblxuXHRcdHZhciBpLCBqLCBjdXIsIGluc3QsXG5cdFx0XHRpdGVtcyA9IFtdLFxuXHRcdFx0cXVlcmllcyA9IFtdLFxuXHRcdFx0Y29ubmVjdFdpdGggPSB0aGlzLl9jb25uZWN0V2l0aCgpO1xuXG5cdFx0aWYgKCBjb25uZWN0V2l0aCAmJiBjb25uZWN0ZWQgKSB7XG5cdFx0XHRmb3IgKCBpID0gY29ubmVjdFdpdGgubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cdFx0XHRcdGN1ciA9ICQoIGNvbm5lY3RXaXRoWyBpIF0sIHRoaXMuZG9jdW1lbnRbIDAgXSApO1xuXHRcdFx0XHRmb3IgKCBqID0gY3VyLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tICkge1xuXHRcdFx0XHRcdGluc3QgPSAkLmRhdGEoIGN1clsgaiBdLCB0aGlzLndpZGdldEZ1bGxOYW1lICk7XG5cdFx0XHRcdFx0aWYgKCBpbnN0ICYmIGluc3QgIT09IHRoaXMgJiYgIWluc3Qub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdFx0XHRcdHF1ZXJpZXMucHVzaCggWyAkLmlzRnVuY3Rpb24oIGluc3Qub3B0aW9ucy5pdGVtcyApID9cblx0XHRcdFx0XHRcdFx0aW5zdC5vcHRpb25zLml0ZW1zLmNhbGwoIGluc3QuZWxlbWVudCApIDpcblx0XHRcdFx0XHRcdFx0JCggaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQgKVxuXHRcdFx0XHRcdFx0XHRcdC5ub3QoIFwiLnVpLXNvcnRhYmxlLWhlbHBlclwiIClcblx0XHRcdFx0XHRcdFx0XHQubm90KCBcIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiICksIGluc3QgXSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHF1ZXJpZXMucHVzaCggWyAkLmlzRnVuY3Rpb24oIHRoaXMub3B0aW9ucy5pdGVtcyApID9cblx0XHRcdHRoaXMub3B0aW9ucy5pdGVtc1xuXHRcdFx0XHQuY2FsbCggdGhpcy5lbGVtZW50LCBudWxsLCB7IG9wdGlvbnM6IHRoaXMub3B0aW9ucywgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9ICkgOlxuXHRcdFx0JCggdGhpcy5vcHRpb25zLml0ZW1zLCB0aGlzLmVsZW1lbnQgKVxuXHRcdFx0XHQubm90KCBcIi51aS1zb3J0YWJsZS1oZWxwZXJcIiApXG5cdFx0XHRcdC5ub3QoIFwiLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyXCIgKSwgdGhpcyBdICk7XG5cblx0XHRmdW5jdGlvbiBhZGRJdGVtcygpIHtcblx0XHRcdGl0ZW1zLnB1c2goIHRoaXMgKTtcblx0XHR9XG5cdFx0Zm9yICggaSA9IHF1ZXJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cdFx0XHRxdWVyaWVzWyBpIF1bIDAgXS5lYWNoKCBhZGRJdGVtcyApO1xuXHRcdH1cblxuXHRcdHJldHVybiAkKCBpdGVtcyApO1xuXG5cdH0sXG5cblx0X3JlbW92ZUN1cnJlbnRzRnJvbUl0ZW1zOiBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBsaXN0ID0gdGhpcy5jdXJyZW50SXRlbS5maW5kKCBcIjpkYXRhKFwiICsgdGhpcy53aWRnZXROYW1lICsgXCItaXRlbSlcIiApO1xuXG5cdFx0dGhpcy5pdGVtcyA9ICQuZ3JlcCggdGhpcy5pdGVtcywgZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0XHRmb3IgKCB2YXIgaiA9IDA7IGogPCBsaXN0Lmxlbmd0aDsgaisrICkge1xuXHRcdFx0XHRpZiAoIGxpc3RbIGogXSA9PT0gaXRlbS5pdGVtWyAwIF0gKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9ICk7XG5cblx0fSxcblxuXHRfcmVmcmVzaEl0ZW1zOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHR0aGlzLml0ZW1zID0gW107XG5cdFx0dGhpcy5jb250YWluZXJzID0gWyB0aGlzIF07XG5cblx0XHR2YXIgaSwgaiwgY3VyLCBpbnN0LCB0YXJnZXREYXRhLCBfcXVlcmllcywgaXRlbSwgcXVlcmllc0xlbmd0aCxcblx0XHRcdGl0ZW1zID0gdGhpcy5pdGVtcyxcblx0XHRcdHF1ZXJpZXMgPSBbIFsgJC5pc0Z1bmN0aW9uKCB0aGlzLm9wdGlvbnMuaXRlbXMgKSA/XG5cdFx0XHRcdHRoaXMub3B0aW9ucy5pdGVtcy5jYWxsKCB0aGlzLmVsZW1lbnRbIDAgXSwgZXZlbnQsIHsgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9ICkgOlxuXHRcdFx0XHQkKCB0aGlzLm9wdGlvbnMuaXRlbXMsIHRoaXMuZWxlbWVudCApLCB0aGlzIF0gXSxcblx0XHRcdGNvbm5lY3RXaXRoID0gdGhpcy5fY29ubmVjdFdpdGgoKTtcblxuXHRcdC8vU2hvdWxkbid0IGJlIHJ1biB0aGUgZmlyc3QgdGltZSB0aHJvdWdoIGR1ZSB0byBtYXNzaXZlIHNsb3ctZG93blxuXHRcdGlmICggY29ubmVjdFdpdGggJiYgdGhpcy5yZWFkeSApIHtcblx0XHRcdGZvciAoIGkgPSBjb25uZWN0V2l0aC5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHtcblx0XHRcdFx0Y3VyID0gJCggY29ubmVjdFdpdGhbIGkgXSwgdGhpcy5kb2N1bWVudFsgMCBdICk7XG5cdFx0XHRcdGZvciAoIGogPSBjdXIubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0gKSB7XG5cdFx0XHRcdFx0aW5zdCA9ICQuZGF0YSggY3VyWyBqIF0sIHRoaXMud2lkZ2V0RnVsbE5hbWUgKTtcblx0XHRcdFx0XHRpZiAoIGluc3QgJiYgaW5zdCAhPT0gdGhpcyAmJiAhaW5zdC5vcHRpb25zLmRpc2FibGVkICkge1xuXHRcdFx0XHRcdFx0cXVlcmllcy5wdXNoKCBbICQuaXNGdW5jdGlvbiggaW5zdC5vcHRpb25zLml0ZW1zICkgP1xuXHRcdFx0XHRcdFx0XHRpbnN0Lm9wdGlvbnMuaXRlbXNcblx0XHRcdFx0XHRcdFx0XHQuY2FsbCggaW5zdC5lbGVtZW50WyAwIF0sIGV2ZW50LCB7IGl0ZW06IHRoaXMuY3VycmVudEl0ZW0gfSApIDpcblx0XHRcdFx0XHRcdFx0JCggaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQgKSwgaW5zdCBdICk7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnMucHVzaCggaW5zdCApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZvciAoIGkgPSBxdWVyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXHRcdFx0dGFyZ2V0RGF0YSA9IHF1ZXJpZXNbIGkgXVsgMSBdO1xuXHRcdFx0X3F1ZXJpZXMgPSBxdWVyaWVzWyBpIF1bIDAgXTtcblxuXHRcdFx0Zm9yICggaiA9IDAsIHF1ZXJpZXNMZW5ndGggPSBfcXVlcmllcy5sZW5ndGg7IGogPCBxdWVyaWVzTGVuZ3RoOyBqKysgKSB7XG5cdFx0XHRcdGl0ZW0gPSAkKCBfcXVlcmllc1sgaiBdICk7XG5cblx0XHRcdFx0Ly8gRGF0YSBmb3IgdGFyZ2V0IGNoZWNraW5nIChtb3VzZSBtYW5hZ2VyKVxuXHRcdFx0XHRpdGVtLmRhdGEoIHRoaXMud2lkZ2V0TmFtZSArIFwiLWl0ZW1cIiwgdGFyZ2V0RGF0YSApO1xuXG5cdFx0XHRcdGl0ZW1zLnB1c2goIHtcblx0XHRcdFx0XHRpdGVtOiBpdGVtLFxuXHRcdFx0XHRcdGluc3RhbmNlOiB0YXJnZXREYXRhLFxuXHRcdFx0XHRcdHdpZHRoOiAwLCBoZWlnaHQ6IDAsXG5cdFx0XHRcdFx0bGVmdDogMCwgdG9wOiAwXG5cdFx0XHRcdH0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0fSxcblxuXHRyZWZyZXNoUG9zaXRpb25zOiBmdW5jdGlvbiggZmFzdCApIHtcblxuXHRcdC8vIERldGVybWluZSB3aGV0aGVyIGl0ZW1zIGFyZSBiZWluZyBkaXNwbGF5ZWQgaG9yaXpvbnRhbGx5XG5cdFx0dGhpcy5mbG9hdGluZyA9IHRoaXMuaXRlbXMubGVuZ3RoID9cblx0XHRcdHRoaXMub3B0aW9ucy5heGlzID09PSBcInhcIiB8fCB0aGlzLl9pc0Zsb2F0aW5nKCB0aGlzLml0ZW1zWyAwIF0uaXRlbSApIDpcblx0XHRcdGZhbHNlO1xuXG5cdFx0Ly9UaGlzIGhhcyB0byBiZSByZWRvbmUgYmVjYXVzZSBkdWUgdG8gdGhlIGl0ZW0gYmVpbmcgbW92ZWQgb3V0L2ludG8gdGhlIG9mZnNldFBhcmVudCxcblx0XHQvLyB0aGUgb2Zmc2V0UGFyZW50J3MgcG9zaXRpb24gd2lsbCBjaGFuZ2Vcblx0XHRpZiAoIHRoaXMub2Zmc2V0UGFyZW50ICYmIHRoaXMuaGVscGVyICkge1xuXHRcdFx0dGhpcy5vZmZzZXQucGFyZW50ID0gdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0dmFyIGksIGl0ZW0sIHQsIHA7XG5cblx0XHRmb3IgKCBpID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHtcblx0XHRcdGl0ZW0gPSB0aGlzLml0ZW1zWyBpIF07XG5cblx0XHRcdC8vV2UgaWdub3JlIGNhbGN1bGF0aW5nIHBvc2l0aW9ucyBvZiBhbGwgY29ubmVjdGVkIGNvbnRhaW5lcnMgd2hlbiB3ZSdyZSBub3Qgb3ZlciB0aGVtXG5cdFx0XHRpZiAoIGl0ZW0uaW5zdGFuY2UgIT09IHRoaXMuY3VycmVudENvbnRhaW5lciAmJiB0aGlzLmN1cnJlbnRDb250YWluZXIgJiZcblx0XHRcdFx0XHRpdGVtLml0ZW1bIDAgXSAhPT0gdGhpcy5jdXJyZW50SXRlbVsgMCBdICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0dCA9IHRoaXMub3B0aW9ucy50b2xlcmFuY2VFbGVtZW50ID9cblx0XHRcdFx0JCggdGhpcy5vcHRpb25zLnRvbGVyYW5jZUVsZW1lbnQsIGl0ZW0uaXRlbSApIDpcblx0XHRcdFx0aXRlbS5pdGVtO1xuXG5cdFx0XHRpZiAoICFmYXN0ICkge1xuXHRcdFx0XHRpdGVtLndpZHRoID0gdC5vdXRlcldpZHRoKCk7XG5cdFx0XHRcdGl0ZW0uaGVpZ2h0ID0gdC5vdXRlckhlaWdodCgpO1xuXHRcdFx0fVxuXG5cdFx0XHRwID0gdC5vZmZzZXQoKTtcblx0XHRcdGl0ZW0ubGVmdCA9IHAubGVmdDtcblx0XHRcdGl0ZW0udG9wID0gcC50b3A7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuY3VzdG9tICYmIHRoaXMub3B0aW9ucy5jdXN0b20ucmVmcmVzaENvbnRhaW5lcnMgKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzLmNhbGwoIHRoaXMgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm9yICggaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHtcblx0XHRcdFx0cCA9IHRoaXMuY29udGFpbmVyc1sgaSBdLmVsZW1lbnQub2Zmc2V0KCk7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLmxlZnQgPSBwLmxlZnQ7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLnRvcCA9IHAudG9wO1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZS53aWR0aCA9XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpIF0uZWxlbWVudC5vdXRlcldpZHRoKCk7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLmhlaWdodCA9XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpIF0uZWxlbWVudC5vdXRlckhlaWdodCgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9jcmVhdGVQbGFjZWhvbGRlcjogZnVuY3Rpb24oIHRoYXQgKSB7XG5cdFx0dGhhdCA9IHRoYXQgfHwgdGhpcztcblx0XHR2YXIgY2xhc3NOYW1lLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucztcblxuXHRcdGlmICggIW8ucGxhY2Vob2xkZXIgfHwgby5wbGFjZWhvbGRlci5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICkge1xuXHRcdFx0Y2xhc3NOYW1lID0gby5wbGFjZWhvbGRlcjtcblx0XHRcdG8ucGxhY2Vob2xkZXIgPSB7XG5cdFx0XHRcdGVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0dmFyIG5vZGVOYW1lID0gdGhhdC5jdXJyZW50SXRlbVsgMCBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRcdFx0XHRlbGVtZW50ID0gJCggXCI8XCIgKyBub2RlTmFtZSArIFwiPlwiLCB0aGF0LmRvY3VtZW50WyAwIF0gKTtcblxuXHRcdFx0XHRcdFx0dGhhdC5fYWRkQ2xhc3MoIGVsZW1lbnQsIFwidWktc29ydGFibGUtcGxhY2Vob2xkZXJcIixcblx0XHRcdFx0XHRcdFx0XHRjbGFzc05hbWUgfHwgdGhhdC5jdXJyZW50SXRlbVsgMCBdLmNsYXNzTmFtZSApXG5cdFx0XHRcdFx0XHRcdC5fcmVtb3ZlQ2xhc3MoIGVsZW1lbnQsIFwidWktc29ydGFibGUtaGVscGVyXCIgKTtcblxuXHRcdFx0XHRcdGlmICggbm9kZU5hbWUgPT09IFwidGJvZHlcIiApIHtcblx0XHRcdFx0XHRcdHRoYXQuX2NyZWF0ZVRyUGxhY2Vob2xkZXIoXG5cdFx0XHRcdFx0XHRcdHRoYXQuY3VycmVudEl0ZW0uZmluZCggXCJ0clwiICkuZXEoIDAgKSxcblx0XHRcdFx0XHRcdFx0JCggXCI8dHI+XCIsIHRoYXQuZG9jdW1lbnRbIDAgXSApLmFwcGVuZFRvKCBlbGVtZW50IClcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggbm9kZU5hbWUgPT09IFwidHJcIiApIHtcblx0XHRcdFx0XHRcdHRoYXQuX2NyZWF0ZVRyUGxhY2Vob2xkZXIoIHRoYXQuY3VycmVudEl0ZW0sIGVsZW1lbnQgKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gXCJpbWdcIiApIHtcblx0XHRcdFx0XHRcdGVsZW1lbnQuYXR0ciggXCJzcmNcIiwgdGhhdC5jdXJyZW50SXRlbS5hdHRyKCBcInNyY1wiICkgKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoICFjbGFzc05hbWUgKSB7XG5cdFx0XHRcdFx0XHRlbGVtZW50LmNzcyggXCJ2aXNpYmlsaXR5XCIsIFwiaGlkZGVuXCIgKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gZWxlbWVudDtcblx0XHRcdFx0fSxcblx0XHRcdFx0dXBkYXRlOiBmdW5jdGlvbiggY29udGFpbmVyLCBwICkge1xuXG5cdFx0XHRcdFx0Ly8gMS4gSWYgYSBjbGFzc05hbWUgaXMgc2V0IGFzICdwbGFjZWhvbGRlciBvcHRpb24sIHdlIGRvbid0IGZvcmNlIHNpemVzIC1cblx0XHRcdFx0XHQvLyB0aGUgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIHRoYXRcblx0XHRcdFx0XHQvLyAyLiBUaGUgb3B0aW9uICdmb3JjZVBsYWNlaG9sZGVyU2l6ZSBjYW4gYmUgZW5hYmxlZCB0byBmb3JjZSBpdCBldmVuIGlmIGFcblx0XHRcdFx0XHQvLyBjbGFzcyBuYW1lIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRcdGlmICggY2xhc3NOYW1lICYmICFvLmZvcmNlUGxhY2Vob2xkZXJTaXplICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vSWYgdGhlIGVsZW1lbnQgZG9lc24ndCBoYXZlIGEgYWN0dWFsIGhlaWdodCBieSBpdHNlbGYgKHdpdGhvdXQgc3R5bGVzIGNvbWluZ1xuXHRcdFx0XHRcdC8vIGZyb20gYSBzdHlsZXNoZWV0KSwgaXQgcmVjZWl2ZXMgdGhlIGlubGluZSBoZWlnaHQgZnJvbSB0aGUgZHJhZ2dlZCBpdGVtXG5cdFx0XHRcdFx0aWYgKCAhcC5oZWlnaHQoKSApIHtcblx0XHRcdFx0XHRcdHAuaGVpZ2h0KFxuXHRcdFx0XHRcdFx0XHR0aGF0LmN1cnJlbnRJdGVtLmlubmVySGVpZ2h0KCkgLVxuXHRcdFx0XHRcdFx0XHRwYXJzZUludCggdGhhdC5jdXJyZW50SXRlbS5jc3MoIFwicGFkZGluZ1RvcFwiICkgfHwgMCwgMTAgKSAtXG5cdFx0XHRcdFx0XHRcdHBhcnNlSW50KCB0aGF0LmN1cnJlbnRJdGVtLmNzcyggXCJwYWRkaW5nQm90dG9tXCIgKSB8fCAwLCAxMCApICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggIXAud2lkdGgoKSApIHtcblx0XHRcdFx0XHRcdHAud2lkdGgoXG5cdFx0XHRcdFx0XHRcdHRoYXQuY3VycmVudEl0ZW0uaW5uZXJXaWR0aCgpIC1cblx0XHRcdFx0XHRcdFx0cGFyc2VJbnQoIHRoYXQuY3VycmVudEl0ZW0uY3NzKCBcInBhZGRpbmdMZWZ0XCIgKSB8fCAwLCAxMCApIC1cblx0XHRcdFx0XHRcdFx0cGFyc2VJbnQoIHRoYXQuY3VycmVudEl0ZW0uY3NzKCBcInBhZGRpbmdSaWdodFwiICkgfHwgMCwgMTAgKSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHQvL0NyZWF0ZSB0aGUgcGxhY2Vob2xkZXJcblx0XHR0aGF0LnBsYWNlaG9sZGVyID0gJCggby5wbGFjZWhvbGRlci5lbGVtZW50LmNhbGwoIHRoYXQuZWxlbWVudCwgdGhhdC5jdXJyZW50SXRlbSApICk7XG5cblx0XHQvL0FwcGVuZCBpdCBhZnRlciB0aGUgYWN0dWFsIGN1cnJlbnQgaXRlbVxuXHRcdHRoYXQuY3VycmVudEl0ZW0uYWZ0ZXIoIHRoYXQucGxhY2Vob2xkZXIgKTtcblxuXHRcdC8vVXBkYXRlIHRoZSBzaXplIG9mIHRoZSBwbGFjZWhvbGRlciAoVE9ETzogTG9naWMgdG8gZnV6enksIHNlZSBsaW5lIDMxNi8zMTcpXG5cdFx0by5wbGFjZWhvbGRlci51cGRhdGUoIHRoYXQsIHRoYXQucGxhY2Vob2xkZXIgKTtcblxuXHR9LFxuXG5cdF9jcmVhdGVUclBsYWNlaG9sZGVyOiBmdW5jdGlvbiggc291cmNlVHIsIHRhcmdldFRyICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblxuXHRcdHNvdXJjZVRyLmNoaWxkcmVuKCkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCBcIjx0ZD4mIzE2MDs8L3RkPlwiLCB0aGF0LmRvY3VtZW50WyAwIF0gKVxuXHRcdFx0XHQuYXR0ciggXCJjb2xzcGFuXCIsICQoIHRoaXMgKS5hdHRyKCBcImNvbHNwYW5cIiApIHx8IDEgKVxuXHRcdFx0XHQuYXBwZW5kVG8oIHRhcmdldFRyICk7XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9jb250YWN0Q29udGFpbmVyczogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciBpLCBqLCBkaXN0LCBpdGVtV2l0aExlYXN0RGlzdGFuY2UsIHBvc1Byb3BlcnR5LCBzaXplUHJvcGVydHksIGN1ciwgbmVhckJvdHRvbSxcblx0XHRcdGZsb2F0aW5nLCBheGlzLFxuXHRcdFx0aW5uZXJtb3N0Q29udGFpbmVyID0gbnVsbCxcblx0XHRcdGlubmVybW9zdEluZGV4ID0gbnVsbDtcblxuXHRcdC8vIEdldCBpbm5lcm1vc3QgY29udGFpbmVyIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGl0ZW1cblx0XHRmb3IgKCBpID0gdGhpcy5jb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXG5cdFx0XHQvLyBOZXZlciBjb25zaWRlciBhIGNvbnRhaW5lciB0aGF0J3MgbG9jYXRlZCB3aXRoaW4gdGhlIGl0ZW0gaXRzZWxmXG5cdFx0XHRpZiAoICQuY29udGFpbnMoIHRoaXMuY3VycmVudEl0ZW1bIDAgXSwgdGhpcy5jb250YWluZXJzWyBpIF0uZWxlbWVudFsgMCBdICkgKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRoaXMuX2ludGVyc2VjdHNXaXRoKCB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZSApICkge1xuXG5cdFx0XHRcdC8vIElmIHdlJ3ZlIGFscmVhZHkgZm91bmQgYSBjb250YWluZXIgYW5kIGl0J3MgbW9yZSBcImlubmVyXCIgdGhhbiB0aGlzLCB0aGVuIGNvbnRpbnVlXG5cdFx0XHRcdGlmICggaW5uZXJtb3N0Q29udGFpbmVyICYmXG5cdFx0XHRcdFx0XHQkLmNvbnRhaW5zKFxuXHRcdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGkgXS5lbGVtZW50WyAwIF0sXG5cdFx0XHRcdFx0XHRcdGlubmVybW9zdENvbnRhaW5lci5lbGVtZW50WyAwIF0gKSApIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlubmVybW9zdENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyc1sgaSBdO1xuXHRcdFx0XHRpbm5lcm1vc3RJbmRleCA9IGk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gY29udGFpbmVyIGRvZXNuJ3QgaW50ZXJzZWN0LiB0cmlnZ2VyIFwib3V0XCIgZXZlbnQgaWYgbmVjZXNzYXJ5XG5cdFx0XHRcdGlmICggdGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUub3ZlciApIHtcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGkgXS5fdHJpZ2dlciggXCJvdXRcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUub3ZlciA9IDA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdC8vIElmIG5vIGludGVyc2VjdGluZyBjb250YWluZXJzIGZvdW5kLCByZXR1cm5cblx0XHRpZiAoICFpbm5lcm1vc3RDb250YWluZXIgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gTW92ZSB0aGUgaXRlbSBpbnRvIHRoZSBjb250YWluZXIgaWYgaXQncyBub3QgdGhlcmUgYWxyZWFkeVxuXHRcdGlmICggdGhpcy5jb250YWluZXJzLmxlbmd0aCA9PT0gMSApIHtcblx0XHRcdGlmICggIXRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5jb250YWluZXJDYWNoZS5vdmVyICkge1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0uX3RyaWdnZXIoIFwib3ZlclwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIFdoZW4gZW50ZXJpbmcgYSBuZXcgY29udGFpbmVyLCB3ZSB3aWxsIGZpbmQgdGhlIGl0ZW0gd2l0aCB0aGUgbGVhc3QgZGlzdGFuY2UgYW5kXG5cdFx0XHQvLyBhcHBlbmQgb3VyIGl0ZW0gbmVhciBpdFxuXHRcdFx0ZGlzdCA9IDEwMDAwO1xuXHRcdFx0aXRlbVdpdGhMZWFzdERpc3RhbmNlID0gbnVsbDtcblx0XHRcdGZsb2F0aW5nID0gaW5uZXJtb3N0Q29udGFpbmVyLmZsb2F0aW5nIHx8IHRoaXMuX2lzRmxvYXRpbmcoIHRoaXMuY3VycmVudEl0ZW0gKTtcblx0XHRcdHBvc1Byb3BlcnR5ID0gZmxvYXRpbmcgPyBcImxlZnRcIiA6IFwidG9wXCI7XG5cdFx0XHRzaXplUHJvcGVydHkgPSBmbG9hdGluZyA/IFwid2lkdGhcIiA6IFwiaGVpZ2h0XCI7XG5cdFx0XHRheGlzID0gZmxvYXRpbmcgPyBcInBhZ2VYXCIgOiBcInBhZ2VZXCI7XG5cblx0XHRcdGZvciAoIGogPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tICkge1xuXHRcdFx0XHRpZiAoICEkLmNvbnRhaW5zKFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdLmVsZW1lbnRbIDAgXSwgdGhpcy5pdGVtc1sgaiBdLml0ZW1bIDAgXSApXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggdGhpcy5pdGVtc1sgaiBdLml0ZW1bIDAgXSA9PT0gdGhpcy5jdXJyZW50SXRlbVsgMCBdICkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y3VyID0gdGhpcy5pdGVtc1sgaiBdLml0ZW0ub2Zmc2V0KClbIHBvc1Byb3BlcnR5IF07XG5cdFx0XHRcdG5lYXJCb3R0b20gPSBmYWxzZTtcblx0XHRcdFx0aWYgKCBldmVudFsgYXhpcyBdIC0gY3VyID4gdGhpcy5pdGVtc1sgaiBdWyBzaXplUHJvcGVydHkgXSAvIDIgKSB7XG5cdFx0XHRcdFx0bmVhckJvdHRvbSA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICkgPCBkaXN0ICkge1xuXHRcdFx0XHRcdGRpc3QgPSBNYXRoLmFicyggZXZlbnRbIGF4aXMgXSAtIGN1ciApO1xuXHRcdFx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA9IHRoaXMuaXRlbXNbIGogXTtcblx0XHRcdFx0XHR0aGlzLmRpcmVjdGlvbiA9IG5lYXJCb3R0b20gPyBcInVwXCIgOiBcImRvd25cIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL0NoZWNrIGlmIGRyb3BPbkVtcHR5IGlzIGVuYWJsZWRcblx0XHRcdGlmICggIWl0ZW1XaXRoTGVhc3REaXN0YW5jZSAmJiAhdGhpcy5vcHRpb25zLmRyb3BPbkVtcHR5ICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmICggdGhpcy5jdXJyZW50Q29udGFpbmVyID09PSB0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0gKSB7XG5cdFx0XHRcdGlmICggIXRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyICkge1xuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggXCJvdmVyXCIsIGV2ZW50LCB0aGlzLl91aUhhc2g